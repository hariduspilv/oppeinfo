"use strict";function SharedPropertiesService(){function a(){return b}var b={};this.getProperties=a}function calculateSumsForFamilyBlock(a){angular.isArray(a)&&a.forEach(function(a){a.sum=[a.netSalary,a.pension,a.stateBenefit,a.otherIncome,a.unemployedBenefit].reduce(function(a,b){return isNaN(b)?a:a+b},0)})}angular.module("hitsaOis",["ngAnimate","ngAria","ngMessages","ngResource","ngRoute","ngSanitize","ngMaterial","pascalprecht.translate","md.data.table","lfNgMdFileInput","ngStorage","angular-cache","color.picker","chart.js"]).config(["$routeProvider",function(a){a.otherwise({redirectTo:"/"})}]).config(["$locationProvider",function(a){a.hashPrefix("")}]).config(["$translateProvider",function(a){a.useStaticFilesLoader({prefix:"i18n/",suffix:".json"}),a.preferredLanguage("et"),a.fallbackLanguage("et"),a.useSanitizeValueStrategy("escapeParameters")}]).config(["$compileProvider",function(a){a.aHrefSanitizationWhitelist(/^\s*(https?|ftp|mailto|tel|file|blob|data):/),a.debugInfoEnabled(!1)}]).config(["$httpProvider",function(a){a.defaults.withCredentials=!0,a.defaults.headers.common["X-Requested-With"]="XMLHttpRequest",a.defaults.xsrfCookieName="XSRF-TOKEN",a.defaults.xsrfHeaderName="X-XSRF-TOKEN"}]).config(["$resourceProvider",function(a){a.defaults.actions.update={method:"PUT",params:{id:"@id"}},a.defaults.actions["delete"]={method:"DELETE",params:{id:"@id",version:"@version"}}}]).config(["$mdThemingProvider",function(a){a.theme("default").primaryPalette("blue",{"default":"900"}).accentPalette("pink").backgroundPalette("grey")}]).config(["$httpProvider",function(a){a.interceptors.push(["$injector",function(a){return a.get("AuthInterceptor")}]),a.interceptors.push(["Session","$rootScope",function(a,b){return{response:function(a){var c=a.config.url;return void 0!==c.indexOf&&-1===c.indexOf("session.timing.out.dialog.html")&&-1===c.indexOf("session.timed.out.dialog.html")&&-1===c.indexOf("/logout")&&b.restartTimeoutDialogCounter(),a}}}]),a.interceptors.push(["$q","$rootScope","$timeout",function(a,b,c){function d(a,d){function f(){b.$emit("backendBusy",{busy:d})}-1===e.indexOf(a.method)||angular.isDefined(a.loading)||(d?f():c(f,200))}var e=["POST","PUT","DELETE"];return{request:function(a){return angular.isDefined(a.loading)?d(a,a.loading):d(a,!0),a},response:function(a){return d(a.config,!1),a},responseError:function(b){return d(b.config,!1),a.reject(b)}}}])}]).config(["CacheFactoryProvider",function(a){angular.extend(a.defaults,{maxAge:36e5,deleteOnExpire:"passive"})}]).run(["$rootScope","busyHandler",function(a,b){a.$on("backendBusy",function(a,c){c.value?b.handleWithProgress(c):b.handle(c)})}]).config(["$provide",function(a){a.decorator("ColorPickerOptions",["$delegate",function(a){var b=angular.copy(a);return b.placeholder="Vali värv",b.format="hex",b["case"]="upper",b.hue=!0,b.saturation=!1,b.lightness=!1,b.alpha=!1,b.restrictToForma=!0,b.preserveInputFormat=!0,b.swatch=!0,b.swatchOnly=!0,b.round=!1,b}])}]),angular.module("hitsaOis").controller("SimpleListController",["$q","$route","$scope","Classifier","QueryUtils",function(a,b,c,d,e){c.auth=b.current.locals.auth;var f=b.current.locals.clMapping,g=f?d.valuemapper(f):void 0;e.createQueryForm(c,b.current.locals.url,b.current.locals.params,g?g.objectmapper:void 0),g?a.all(g.promises).then(c.loadData):c.loadData(),c.directiveControllers=[];var h=c.clearCriteria;c.clearCriteria=function(){h(),c.directiveControllers.forEach(function(a){a.clear()})}}]),angular.module("hitsaOis").controller("MainController",["$window","$scope","$translate","$location","Menu","AuthService","$mdSidenav","$mdMedia","$mdUtil","$rootScope","$mdDateLocale","$filter","$timeout","USER_ROLES","dialogService","config","$httpParamSerializer","Session","$mdDialog","ArrayUtils",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){function u(){m(function(){g("left").close()})}function v(){m(function(){g("left").open()})}function w(){return d.path()}function x(){i.animateScrollTo(P,0,200)}function y(){e.selectPage(null,null),d.path("/")}function z(){M.autoFocusContent&&(A(),M.autoFocusContent=!1)}function A(a){a&&a.preventDefault(),m(function(){O.focus()},90)}function B(a){return e.isPageSelected(a)}function C(){var a=i.debounce(function(){g("left").isOpen()?g("left").close():g("left").open()},300);return a}function D(a){var b=!1,c=e.openedSection;return c===a?b=!0:a.children&&a.children.forEach(function(a){a===c&&(b=!0)}),b}function E(a){return e.isSectionSelected(a)}function F(a){e.toggleSelectSection(a)}function G(a){var b=a.substring(a.indexOf("#"),a.length);Q.push(b)}function H(b){for(var c=Q.pop();angular.isDefined(c)&&(c===a.location.hash||a.location.hash.endsWith("?_noback")&&a.location.hash.slice(0,-8)===c);)c=Q.pop();var d=c||b;R=!0,a.location.href=d}function I(){s.show({controller:["$scope","$http",function(a,b){a.refresh=function(){b.get(p.apiUrl+"/refresh"),s.hide()}}],templateUrl:"login/session.timing.out.dialog.html",parent:angular.element(document.body),clickOutsideToClose:!1})}function J(){s.show({controller:["$scope","$location",function(a,b){a.ok=function(){j.loggedOut(),f.postLogout(),b.path("/"),s.hide()}}],templateUrl:"login/session.timed.out.dialog.html",parent:angular.element(document.body),clickOutsideToClose:!1})}function K(){angular.isObject(r.timeoutDialog)&&m.cancel(r.timeoutDialog),angular.isObject(r.timeout)&&m.cancel(r.timeout)}function L(a,b){return function(){Date.now()-a<b&&I()}}j.state={};var M=this;b.windowWidth=a.innerWidth,a.onresize=function(){m(function(){b.windowWidth=a.innerWidth})},b.$mdMedia=h,b.toggleLeft=C("left"),b.lockLeft=!0,b.isLeftOpen=function(){return window.innerWidth>800?g("left").isOpen():!1},b.shouldLeftBeOpen=h("gt-sm"),b.changeLanguage=function(a){c.use(a)},j.currentLanguage=function(){return b.currentLanguage()},b.currentLanguage=function(){return c.use()},j.currentLanguageNameVariable=function(){switch(b.currentLanguage()){case"en":return"nameEn";case"et":return"nameEt";case"ru":return"nameRu";default:return"nameEt"}};var N=function(a,b){return angular.isObject(b)?b[a]||b.nameEt:void 0};b.currentLanguageNameField=function(a){var c=b.currentLanguageNameVariable();return 0===arguments.length?c:angular.isArray(a)?a.map(function(a){return N(c,a)}).join("; "):N(c,a)},j.currentLanguageNameField=b.currentLanguageNameField,b.leftSideNavToggle=function(){g("left").toggle()},b.leftSideNavSelect=function(a){d.path(a),g("left").close()},b.Menu=e,b.path=w,b.goHome=y,b.openMenu=v,b.closeMenu=u,b.isSectionSelected=D,b.scrollTop=x,j.$on("$locationChangeSuccess",z),b.openTerms=function(){o.showDialog("components/terms."+b.currentLanguage()+".dialog.html")};var O=document.querySelector("[role='main']"),P=O.querySelector("md-content[md-scroll-y]");b.focusMainContent=A,Object.defineProperty(j,"relatedPage",{get:function(){return null},set:angular.noop,enumerable:!0,configurable:!0}),j.redirectToUrl=function(a){d.path(a),m(function(){j.relatedPage=null},100)},this.isOpen=E,this.isSelected=B,this.toggleOpen=F,this.autoFocusContent=!1,j.state.userRoles=n,j.isAuthorized=f.isAuthorized,j.setCurrentUser=function(a){j.state.currentUser=a},j.$on("$translateChangeSuccess",function(a,b){"et"===b.language?(k.months=["jaanuar","veebruar","märts","aprill","mai","juuni","juuli","august","september","oktoober","november","detsember"],k.shortMonths=["jaan","veebr","märts","apr","mai","juuni","juuli","aug","sept","okt","nov","dets"],k.days=["pühapäev","esmaspäev","teisipäev","kolmapäev","neljapäev","reede","laupäev"],k.shortDays=["P","E","T","K","N","R","L"],k.firstDayOfWeek=1,k.formatDate=function(a){if(angular.isDefined(a)){var b=moment(a);if(b.isValid())return b.format("DD.MM.YYYY")}return null},k.parseDate=function(a){if(angular.isDefined(a)){var b=moment(a,"DD.MM.YYYY");if(b.isValid())return b.toDate()}return new Date(NaN)}):(k.months=["January","February","March","April","May","June","July","August","September","October","November","December"],k.shortMonths=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],k.days=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],k.shortDays=["S","M","T","W","T","F","S"],k.firstDayOfWeek=0,k.formatDate=function(a){if(angular.isDefined(a)){var b=moment(a);return b.isValid()?b.format("M/D/YYYY"):null}return null},k.parseDate=function(a){if(angular.isDefined(a)){var b=moment(a,"M/D/YYYY");return b.isValid()?b.toDate():new Date(NaN)}return new Date(NaN)})});var Q=[],R=!1;j.replaceLastUrl=function(a,b){var c=Q.pop();return angular.isDefined(b)&&b(c)===!1?void Q.push(c):void Q.push(a)},j.removeLastUrlFromHistory=function(a){var b=Q.pop();angular.isDefined(a)&&!a(b)&&Q.push(b)},j.previosFormIsNewForm=function(){if(t.isEmpty(Q))return!1;var a=Q[Q.length-1];return a?a.indexOf("new")===a.length-3:!1},j.$on("$locationChangeSuccess",function(a,b,c){b===c||R||-1!==b.indexOf("_noback")||G(c.replace(/(\?_menu)$/,"")),R=!1}),j.back=function(a,b,c){angular.isDefined(b)&&b.$dirty===!0?o.confirmDialog({prompt:c||"main.messages.confirmFormDataNotSaved"},function(){H(a)}):H(a)},j.excel=function(a,b){return p.apiUrl+"/"+a+(b?"?"+q(b):"")},j.restartTimeoutDialogCounter=function(){if(K(),f.isAuthenticated()){var b=1e3*r.timeoutInSeconds,c=b-1e3*p.timeoutDialogBeforeTimeoutInSeconds;if(c>0){var d=Date.now();r.timeoutDialog=m(function(){a.requestAnimationFrame(L(d,b))},c),r.timeout=m(function(){s.hide(),J()},b)}}}}]).filter("nospace",function(){return function(a){return a?a.replace(/ /g,""):""}}).filter("encodeURIComponent",function(){return function(a){return window.encodeURIComponent(a)}}),angular.module("hitsaOis").controller("ApplicationController",["$http","$location","$q","$route","$scope","$timeout","ArrayUtils","AuthService","Classifier","Curriculum","DataUtils","FormUtils","QueryUtils","USER_ROLES","config","dialogService","message","oisFileService",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){function s(a){k.convertStringToDates(a,["startDate","endDate"]),angular.isArray(a.plannedSubjects)&&a.plannedSubjects.forEach(function(a){angular.isArray(a.equivalents)&&(a.subjectsSelected=a.equivalents.map(function(a){return a.subject}))}),angular.extend(e.application,a),e.canChange=t(e.application),e.canSave=u(e.application)}function t(a){var b=!1,c=!1,d=!1;return"AVALDUS_STAATUS_KOOST"===a.status?b=e.auth.isAdmin()&&h.isAuthorized(n.ROLE_OIGUS_M_TEEMAOIGUS_AVALDUS)||e.auth.isStudent()||(e.auth.isParent()||e.auth.isTeacher())&&"AVALDUS_LIIK_TUGI"===a.type:"AVALDUS_STAATUS_YLEVAAT"===a.status?c=e.auth.isAdmin()&&h.isAuthorized(n.ROLE_OIGUS_M_TEEMAOIGUS_AVALDUS):"AVALDUS_STAATUS_KINNITATUD"===a.status&&(d="AVALDUS_LIIK_RAKKAVA"===a.type&&a.canChangeThemeReplacements),a.canEditStudent&&(b||c||d)}function u(a){var b="AVALDUS_STAATUS_KOOST"===a.status,c=!1,d=!1;return"AVALDUS_STAATUS_YLEVAAT"===a.status?c="AVALDUS_STAATUS_YLEVAAT"===a.status&&e.auth.isAdmin():"AVALDUS_STAATUS_KINNITATUD"===a.status&&(d="AVALDUS_LIIK_RAKKAVA"===a.type&&a.canChangeThemeReplacements),(!e.application.id||e.application.canEditStudent)&&(b||c||d)}function v(a){return e.currentLanguageNameField(a.studyYear)+" "+e.currentLanguageNameField(a)}function w(a,b){e.isCreate&&(e.application.oldFin=a.fin,e.application.oldFinSpecific=a.finSpecific),e.application.newFin="FINALLIKAS_RE"===a.fin?"FINALLIKAS_REV":"FINALLIKAS_RE",b.resolve()}function x(a,b){e.isCreate&&(e.application.oldStudyForm=a.studyForm),b.resolve()}function y(a,b){function c(){var a,b=e.application.newCurriculumVersion,c=b?d.find(function(a){return a.id===b.id}):void 0,g=angular.isObject(c)?!c.isVocational:e.auth.school.higher,h=angular.isObject(c)?c.isVocational:e.auth.school.vocational;a=c&&angular.isString(c.studyForm)?[c.studyForm]:f.filter(function(a){return g&&a.higher||h&&a.vocational}).map(function(a){return a.code}),e.allowedStudyForms=a}var d=j.queryVersions({valid:!0});e.isCreate&&(e.application.oldStudyForm=a.studyForm,e.application.oldCurriculumVersion=a.curriculumVersion);var f=i.queryForDropdown({mainClassCode:"OPPEVORM"});e.newCurriculumVersionSelected=function(){var a=d.find(function(a){return a.id===e.application.newCurriculumVersion.id});angular.isObject(a)&&f.$promise.then(function(){e.application.newStudyForm=a.studyForm,c()})},d.$promise.then(function(d){e.curriculumVersions=d.filter(function(b){return b.id!==a.curriculumVersion.id}),f.$promise.then(function(){c(),b.resolve()})})}function z(a,b){e.isCreate&&(e.application.isPeriod=!0),e.studyPeriods=m.endpoint("/autocomplete/studyPeriodsWithYear").query({},function(a){a.forEach(function(a){a.display=v(a)}),b.resolve()}),e.curriculumVersion=a.curriculumVersion}function A(a){k.convertStringToDates(e.application.validAcademicLeave,["startDate","endDate"]),e.studyPeriods=m.endpoint("/autocomplete/studyPeriods").query({},a.resolve)}function B(a){e.isAbroadChanged=function(){e.application.isAbroad?e.application.ehisSchool=void 0:(e.application.abroadSchool=void 0,e.application.country=void 0)},e.plannedSubjectLength=function(){return angular.isArray(e.application.plannedSubjects)?e.application.plannedSubjects.length:0},e.addPlannedSubjectRow=function(){angular.isArray(e.application.plannedSubjects)||(e.application.plannedSubjects=[]),e.application.plannedSubjects.push({equivalents:[]})},e.subjectsSelected=function(a){if(angular.isArray(a.subjectsSelected)){var b=[];a.subjectsSelected.forEach(function(c){for(var d=!1,e=0;e<a.equivalents.length&&!d;e++){var f=a.equivalents[e];f.subject===c&&(b.push(f),d=!0)}d||b.push({subject:c})}),a.equivalents=b}else a.equivalents=[]},e.studentEhisSchool=d.current.locals.auth.school.ehisSchool,e.isCreate&&(e.application.isPeriod=!0,e.application.isAbroad=!1),e.studentSubjects=m.endpoint("/students/"+e.application.student.id+"/subjects").query(),e.studyPeriods=m.endpoint("/autocomplete/studyPeriodsWithYear").query({},function(a){a.forEach(function(a){a.display=e.currentLanguageNameField(a.studyYear)+" "+e.currentLanguageNameField(a)})}),c.all([e.studentSubjects.$promise,e.studyPeriods.$promise]).then(a.resolve)}function C(a,b){e.application.id||(e.application.oldCurriculumVersion=a.curriculumVersion),e.formState={curriculum:a.curriculum,curriculumVersions:m.endpoint("/autocomplete/curriculumversions").query({valid:!0,higher:!0,curriculumId:a.curriculum},function(a){e.formState.curriculumVersions=a.filter(function(a){return a.id!==e.application.oldCurriculumVersion.id}),0===e.formState.curriculumVersions.length&&(e.formState.curriculumsEmpty=!0)}),studentGroups:m.endpoint("/autocomplete/studentgroups").query({valid:!0,higher:!0,curriculumId:a.curriculum,studyForm:a.studyForm})},c.all(e.formState.curriculumVersions,e.formState.studentGroups).then(b.resolve)}function D(a,b){function d(){m.endpoint("/applications/curriculumVersionThemeReplacements/:id").search({id:e.application.student.id,applicationId:e.application.id,curriculumVersionId:e.application.newCurriculumVersion.id}).$promise.then(function(a){e.application.themeReplacement=a})}e.application.id||(e.application.oldCurriculumVersion=a.curriculumVersion),e.formState={curriculum:a.curriculum,curriculumVersions:m.endpoint("/autocomplete/curriculumversions").query({valid:!0,higher:!1,curriculumId:a.curriculum,hasGroup:!0,studyForm:a.studyForm},function(a){e.formState.curriculumVersions=a.filter(function(a){return a.id!==e.application.oldCurriculumVersion.id}),0===e.formState.curriculumVersions.length&&(e.formState.curriculumsEmpty=!0)}),studentGroups:m.endpoint("/autocomplete/studentgroups").query({valid:!0,higher:!1,curriculumId:a.curriculum,studyForm:a.studyForm})},c.all(e.formState.curriculumVersions,e.formState.studentGroups).then(b.resolve),e.isView&&d(),e.newCurriculumVersionSelected=function(){d()}}function E(a){a.resolve()}function F(a){a.resolve()}function G(a){e.application.selectedModules=[],e.onTugiClChange=function(){if(e.formState.supportService){var a=void 0===e.application.supportServices.find(function(a){return a.code===e.formState.supportService.code});a&&e.application.supportServices.push(e.formState.supportService),e.formState.supportService=void 0}},e.deleteService=function(a){for(var b=0;b<e.application.supportServices.length;b++)e.application.supportServices[b].code===a.code&&e.application.supportServices.splice(b,1)},e.tugiIndivCurriculum=void 0!==(e.application.supportServices||[]).find(function(a){return"TUGITEENUS_1"===a.code}),!e.isView&&e.auth.isAdmin()?(e.$watchCollection("application.supportServices",function(a,b){a!==b&&(e.tugiIndivCurriculum=void 0!==(a||[]).find(function(a){return"TUGITEENUS_1"===a.code}))}),e.formState={committees:m.endpoint("/autocomplete/committeesList").query({type:"KOMISJON_A",valid:!0},function(a){if(e.application.id&&e.application.committee){for(var b=0;b<a.length;b++)if(a[b].id===e.application.committee.id)return void angular.extend(a[b],e.application.committee);a.push(e.application.committee)}}),modules:m.endpoint("/applications/studentIndividualCurriculumModules/:id").query({id:e.application.student.id}).$promise.then(function(a){e.curriculumVersionModules=a,e.application.supportModules&&e.application.supportModules.forEach(function(a){var b=(e.curriculumVersionModules||[]).find(function(b){return b.module.id===a.module.id});b&&(e.application.selectedModules.push(b),b.id=a.id,b.addInfo=a.addInfo)})}),supportServices:i.queryForDropdown({mainClassCode:"TUGITEENUS",higher:e.auth.school.higher?!0:void 0,vocational:e.auth.school.vocational?!0:void 0})},c.all(e.formState.committees,e.formState.modules,e.formState.supportServices).then(a.resolve)):a.resolve()}function H(a,b){var d=c.defer();-1!==["AVALDUS_LIIK_AKAD","AVALDUS_LIIK_FINM","AVALDUS_LIIK_OVORM","AVALDUS_LIIK_OKAVA","AVALDUS_LIIK_OVERSKAVA","AVALDUS_LIIK_RAKKAVA"].indexOf(a)?m.endpoint("/students").get({id:b},function(b){switch(a){case"AVALDUS_LIIK_AKAD":z(b,d);break;case"AVALDUS_LIIK_FINM":w(b,d);break;case"AVALDUS_LIIK_OVORM":x(b,d);break;case"AVALDUS_LIIK_OKAVA":y(b,d);break;case"AVALDUS_LIIK_OVERSKAVA":C(b,d);break;case"AVALDUS_LIIK_RAKKAVA":D(b,d)}}):"AVALDUS_LIIK_AKADK"===a?e.isCreate?m.endpoint("/applications/student/"+b+"/validAcademicLeave").search(function(a){angular.isObject(a)&&angular.isNumber(a.id)?(e.application.validAcademicLeave=a,A(d)):d.reject("application.messages.academicLeaveApplicationNotfound")}):A(d):"AVALDUS_LIIK_VALIS"===a?B(d):"AVALDUS_LIIK_EKSMAT"===a?E(d):"AVALDUS_LIIK_MUU"===a?F(d):"AVALDUS_LIIK_TUGI"===a&&G(d),d.promise.then(function(){e.applicationEditView=!0;var a=e.application.type.substring(e.application.type.lastIndexOf("_")+1).toLowerCase();e.templateUrlByType="application/templates/application.type."+a+"."+(e.isView?"view":"edit")+".html",f(I)},function(a){q.error(a),e.applicationEditView=!1})}function I(){a.pendingRequests.length>0?f(I):e.applicationForm&&e.applicationForm.$setPristine()}function J(){m.endpoint("/applications/"+e.application.id+"/submit/").put().$promise.then(function(a){q.info("application.messages.submitted"),e.auth.isAdmin()||e.isView?(s(a),e.applicationForm.$setPristine()):b.url("/applications/"+e.application.id+"/view?_noback")})["catch"](angular.noop)}function K(a){"AVALDUS_LIIK_TUGI"!==e.application.type||e.application.hasSpecialNeed?a():p.confirmDialog({prompt:"application.messages.studentHasNoSpecialNeedConfirm"},function(){a()})}function L(){m.endpoint("/applications/"+e.application.id+"/confirm/").put().$promise.then(function(a){q.info("application.messages.confirmed"),e.isView?(s(a),e.applicationForm.$setPristine()):b.url("/applications/"+e.application.id+"/view?_noback")})["catch"](angular.noop)}function M(){if("AVALDUS_LIIK_RAKKAVA"===e.application.type){var a=[];e.application.themeReplacement.modules.forEach(function(b){b.newThemes.forEach(function(b){b.covering&&a.push(b)}),b.oldThemes.forEach(function(b){a.push(b)})}),e.application.themeReplacements=a}}var N=m.endpoint("/applications");e.removeFromArray=g.remove,e.auth=d.current.locals.auth,e.isCreate=d.current.locals.isCreate,e.isView=d.current.locals.isView,e.now=new Date,e.applicationEditView=!1,e.application={files:[],status:"AVALDUS_STAATUS_KOOST"},e.canChange=t(e.application),e.canSave=u(e.application);var O=d.current.locals.entity;angular.isDefined(O)&&O.$promise.then(function(a){e.isView||t(a)||(q.error("main.messages.error.nopermission"),e.back("#/"))}),e.showOnlyTypes=!angular.isDefined(O)&&e.auth.isTeacher()?["AVALDUS_LIIK_TUGI"]:!0,angular.isDefined(O)&&(O.hasBeenSeenByAdmin===!0&&O.version++,s(O)),angular.isDefined(d.current.params.student)&&angular.isDefined(d.current.params.type)&&(e.application.type=d.current.params.type,m.endpoint("/autocomplete/students?id="+d.current.params.student).get({},function(a){a&&1===a.totalElements&&(e.application.student=a.content[0])})),e.studyPeriodView=function(a){if(angular.isArray(e.studyPeriods)&&angular.isNumber(a))for(var b=0;b<e.studyPeriods.length;b++)if(e.studyPeriods[b].id===a)return v(e.studyPeriods[b])},e.subjectsListView=function(a){if(angular.isDefined(a)&&angular.isArray(a.subjectsSelected)&&angular.isArray(e.studentSubjects)){var b=[];return e.studentSubjects.forEach(function(c){-1!==a.subjectsSelected.indexOf(c.id)&&b.push(e.currentLanguageNameField(c))}),b.join(", ")}return""},e.applicationTypeChange=function(){switch(e.application.student=void 0,e.application.type){case"AVALDUS_LIIK_AKAD":e.studentSearchCriteria={active:!0,nominalStudy:!0};break;case"AVALDUS_LIIK_AKADK":e.studentSearchCriteria={active:!0,academicLeave:!0};break;case"AVALDUS_LIIK_VALIS":case"AVALDUS_LIIK_OVORM":case"AVALDUS_LIIK_OVERSKAVA":e.studentSearchCriteria={studying:!0,higher:!0};break;case"AVALDUS_LIIK_RAKKAVA":case"AVALDUS_LIIK_TUGI":e.studentSearchCriteria={studying:!0,higher:!1};break;default:e.studentSearchCriteria={studying:!0}}e.auth.isTeacher()&&angular.extend(e.studentSearchCriteria,{studentGroup:e.auth.teacherGroupIds})},e.$watch("application.student",function(a){angular.isObject(a)&&(e.isCreate?m.endpoint("/applications/student/"+a.id+"/applicable").search(function(b){angular.isObject(b[e.application.type])&&b[e.application.type].isAllowed===!0?H(e.application.type,a.id):q.error(b[e.application.type].reason)},function(){e.back("#/")}):H(e.application.type,a.id))}),e.openAddFileDialog=function(){p.showDialog("application/file.add.dialog.html",function(a){a.addedFiles=e.application.files},function(a){var b=a.data;r.getFromLfFile(b.file[0],function(a){b.oisFile=a,e.application.files.push(b)})})},e.onOisFileChange=function(){e.applicationForm.fileData&&e.applicationForm.fileData.$modelValue&&e.applicationForm.fileData.$modelValue[0]?r.getFromLfFile(e.applicationForm.fileData.$modelValue[0],function(a){e.application.oisFile=a}):e.application.oisFile=void 0},e.getUrl=r.getUrl,e.isStudentRepresentative=function(){return angular.isObject(e.auth)&&angular.isObject(e.application.student)&&e.auth.student===e.application.student.id&&e.auth.isParent()},e.submit=function(){e.strictRequired=!1,f(function(){l.withValidForm(e.applicationForm,function(){angular.isDefined(e.applicationForm)&&e.applicationForm.$dirty===!0?p.confirmDialog({prompt:"application.messages.confirmSaveAndSubmit"},function(){var a=new N(e.application);a.$update().then(function(a){s(a),J()})["catch"](angular.noop)}):p.confirmDialog({prompt:"application.messages.confirmSubmit"},function(){J()})})})},e.getStar=function(a){return e.strictRequired||angular.isDefined(a)&&!a?"":" *"},e.confirm=function(){e.strictRequired=!0,f(function(){l.withValidForm(e.applicationForm,function(){K(function(){angular.isDefined(e.applicationForm)&&e.applicationForm.$dirty===!0?p.confirmDialog({prompt:"application.messages.confirmSaveAndConfirm"},function(){var a=new N(e.application);a.$update().then(function(a){e.strictRequired=!1,s(a),L()})["catch"](angular.noop)}):p.confirmDialog({prompt:"application.messages.confirmConfirm"},function(){L()})})})})},e.confirmConfirmation=function(){l.withValidForm(e.applicationForm,function(){m.endpoint("/applications/"+e.application.id+"/confirmConfirmation").put({confirm:e.application.agreeWithDecision,oisFile:e.application.oisFile,representativeDecisionAddInfo:e.application.representativeDecisionAddInfo}).$promise.then(function(a){q.info("application.messages.confirmed"),e.isView?(s(a),e.applicationForm.$setPristine()):b.url("/applications/"+e.application.id+"/view?_noback")})["catch"](angular.noop)})},e.removeConfirmation=function(){p.confirmDialog({prompt:e.application.representativeConfirmed?"application.messages.confirmRemovingFinalConfirmation":"application.messages.confirmRemovingConfirmation"},function(){m.endpoint("/applications/"+e.application.id+"/removeConfirmation").put().$promise.then(function(a){q.info("application.messages.removeConfirmationSuccess"),e.isView?(s(a),e.applicationForm.$setPristine()):b.url("/applications/"+e.application.id+"/view?_noback")})["catch"](angular.noop)})},e.pdfUrl=function(){return o.apiUrl+"/applications/print/"+e.application.id+"/application.pdf"},e.reject=function(){e.strictRequired=!1,f(function(){p.showDialog("application/reject.dialog.html",null,function(a){m.endpoint("/applications/"+e.application.id+"/reject/").put({reason:a.rejectReason}).$promise.then(function(a){q.info("application.messages.rejected"),e.isView?(s(a),e.applicationForm.$setPristine()):b.url("/applications/"+e.application.id+"/view?_noback")})["catch"](angular.noop)})})},e.save=function(){e.strictRequired=!1,f(function(){l.withValidForm(e.applicationForm,function(){M();var a=new N(e.application);angular.isDefined(e.application.id)?a.$update().then(function(){q.info("main.messages.update.success"),s(a),e.applicationForm.$setPristine()})["catch"](angular.noop):a.$save().then(function(){q.info("main.messages.create.success"),b.url("/applications/"+a.id+"/edit?_noback")})["catch"](angular.noop)})})},e["delete"]=function(){p.confirmDialog({prompt:"application.deleteconfirm"},function(){var a=new N(e.application);a.$delete().then(function(){q.info("main.messages.delete.success"),e.auth.isStudent()?e.back("#/applications/student"):e.back("#/applications")})["catch"](angular.noop)})},e.periodTypeChanged=function(){e.application.startDate=void 0,e.application.endDate=void 0,e.application.studyPeriodStart=void 0,e.application.studyPeriodEnd=void 0},e.isValid=function(){return function(a){return i.isValid(a)}}}]),angular.module("hitsaOis").config(["$routeProvider","USER_ROLES",function(a,b){a.when("/applications",{templateUrl:"application/application.list.html",controller:"SimpleListController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],clMapping:function(){return{type:"AVALDUS_LIIK",status:"AVALDUS_STAATUS"}},params:function(){return{order:"-inserted"}},url:function(){return"/applications"}},data:{authorizedRoles:function(a,c){return"ROLL_A"===a.roleCode&&-1!==c.indexOf(b.ROLE_OIGUS_V_TEEMAOIGUS_AVALDUS)||-1!==a.committees.indexOf("KOMISJON_T")&&-1!==["ROLL_A","ROLL_O"].indexOf(a.roleCode)||(a.teacherGroupIds||[]).length>0&&"ROLL_O"===a.roleCode&&-1!==c.indexOf(b.ROLE_OIGUS_V_TEEMAOIGUS_AVALDUS)}}}).when("/applications/new",{templateUrl:"application/application.html",controller:"ApplicationController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],isCreate:function(){return!0}},data:{authorizedRoles:function(a,c){return("ROLL_A"===a.roleCode||"ROLL_T"===a.roleCode||"ROLL_O"===a.roleCode)&&-1!==c.indexOf(b.ROLE_OIGUS_M_TEEMAOIGUS_AVALDUS)}}}).when("/applications/:id/:action",{templateUrl:function(a){return"edit"===a.action?"application/application.html":"application/application.view.html"},controller:"ApplicationController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],entity:["QueryUtils","$route",function(a,b){return a.endpoint("/applications").get({id:b.current.params.id}).$promise}],isView:["$route",function(a){return"view"===a.current.params.action}]},data:{authorizedRoles:function(a,c){return-1!==a.committees.indexOf("KOMISJON_T")&&-1!==["ROLL_A","ROLL_O"].indexOf(a.roleCode)||-1!==c.indexOf(b.ROLE_OIGUS_V_TEEMAOIGUS_AVALDUS)}}})}]),angular.module("hitsaOis").controller("ApplicationStudentController",["$scope","$route","QueryUtils",function(a,b,c){a.auth=b.current.locals.auth;var d=b.current.locals.auth.student;a.studentApplication={type:b.current.params.type,student:{id:d},files:[],status:"AVALDUS_STAATUS_KOOST"},a.auth.isParent()&&c.endpoint("/students").get({id:d},function(b){a.student={nameEt:b.person.fullname+" ("+b.person.idcode+")"}})}]),angular.module("hitsaOis").controller("ApplicationStudentListController",["$scope","$location","$route","$q","QueryUtils","Classifier",function(a,b,c,d,e,f){a.auth=c.current.locals.auth;var g=c.current.locals.auth.student,h=f.valuemapper({type:"AVALDUS_LIIK",status:"AVALDUS_STAATUS"});e.createQueryForm(a,"/students/"+g+"/applications",{order:"type."+a.currentLanguageNameField()},h.objectmapper),d.all(h.promises).then(a.loadData),a.applicationTypesApplicable=e.endpoint("/applications/student/"+g+"/applicable").search(),a.applicationTypes=f.queryForDropdown({mainClassCode:"AVALDUS_LIIK"})}]),angular.module("hitsaOis").config(["$routeProvider","USER_ROLES",function(a,b){a.when("/applications/student",{templateUrl:"application/student/application.student.list.html",controller:"ApplicationStudentListController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_AVALDUS]}}).when("/applications/student/new/:type",{templateUrl:"application/student/application.student.new.html",controller:"ApplicationStudentController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],isCreate:function(){return!0}},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_AVALDUS]}})}]),angular.module("hitsaOis").controller("AcademicCalendarController",["$scope","$route","QueryUtils",function(a,b,c){a.auth=b.current.locals.auth,a.schoolId=void 0!==a.auth&&a.auth.school?a.auth.school.id:b.current.params.schoolId,a.data=c.endpoint("/academicCalendar/"+a.schoolId).search()}]).controller("AcademicCalendarSchoolListController",["$scope","School","$location",function(a,b,c){a.schools=b.getSchoolsWithLogo(),a.openSchoolAcademicCalendar=function(a){c.path("academicCalendar/"+a)}}]),angular.module("hitsaOis").config(["$routeProvider",function(a){a.when("/academicCalendar/:schoolId?",{templateUrl:"academicCalendar/academic.calendar.view.html",controller:"AcademicCalendarController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]}}).when("/academicCalendars",{templateUrl:"academicCalendar/academic.calendar.school.list.html",controller:"AcademicCalendarSchoolListController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}]}})}]),angular.module("hitsaOis").controller("BuildingEditController",["$route","$scope","FormUtils","QueryUtils",function(a,b,c,d){var e=a.current.params.id,f="/buildings",g=d.endpoint(f);e?b.record=g.get({id:e}):b.record=new g({}),b.buildingUniqueQuery={url:f+"/unique",id:e},b.update=function(){c.saveRecord(b.buildingForm,b.record,f),b.buildingForm.$setPristine()},b["delete"]=function(){c.deleteRecord(b.record,"/rooms/search?_noback",{prompt:"building.deleteconfirm"})}}]),angular.module("hitsaOis").config(["$routeProvider","USER_ROLES",function(a,b){a.when("/buildings/new",{templateUrl:"building/building.edit.html",controller:"BuildingEditController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]
},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_HOONERUUM]}}).when("/buildings/:id/edit",{templateUrl:"building/building.edit.html",controller:"BuildingEditController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_HOONERUUM]}})}]),angular.module("hitsaOis").controller("BaseModuleListController",["$scope","QueryUtils","$route","USER_ROLES","AuthService",function(a,b,c,d,e){b.createQueryForm(a,"/basemodule"),a.auth=c.current.locals.auth;var f=b.endpoint("/autocomplete/curriculumsauto"),g=b.endpoint("/autocomplete/curriculumversions");a.formState={canCreate:a.auth.isAdmin()&&e.isAuthorized(d.ROLE_OIGUS_M_TEEMAOIGUS_BAASMOODUL)},a.clearFields=function(){a.criteria.curriculumVersion=void 0,a.criteria.curriculum=void 0,a.queryC="",a.queryCV="",a.clearCriteria()},a.searchCurriculums=function(a){return f.query({name:a}).$promise},a.searchCurriculumVersions=function(a){return g.query({name:a}).$promise},a.criteria.order="b."+a.currentLanguageNameField(),a.loadData()}]).controller("BaseModuleEditController",["$scope","QueryUtils","$route","message","ArrayUtils","dialogService","$location","$rootScope","$q","USER_ROLES","AuthService",function(a,b,c,d,e,f,g,h,i,j,k){function l(){a.baseModuleId?(a.baseModule=u.get({id:a.baseModuleId}),a.baseModule.$promise.then(function(){r()})):a.baseModule=new u(x)}function m(){a.baseModule.$save().then(function(a){d.info("main.messages.create.success"),g.url("/basemodule/"+a.id+"/edit")})}function n(){a.baseModule.$update().then(function(){r(),d.info("main.messages.update.success"),a.baseModuleForm.$setPristine()})["catch"](function(a){"basemodule.errors.outcomehasconnections"===a.data._errors[0].code&&l()})}function o(b){angular.isDefined(b)?g.url("/basemodule/"+a.baseModuleId+"/"+b.id+"/edit"):g.url("/basemodule/"+a.baseModuleId+"/new")}function p(){return a.baseModuleForm.$setSubmitted(),a.baseModuleForm.$valid?!0:(d.error("main.messages.form-has-errors"),!1)}function q(){a.baseModule.outcomes.forEach(function(b){b.orderNr=a.baseModule.outcomes.indexOf(b)})}function r(){a.baseModule.outcomes?a.baseModule.outcomes.sort(function(a,b){return a.orderNr-b.orderNr}):a.baseModule.outcomes=[],a.baseModule.validFrom=new Date(a.baseModule.validFrom),a.baseModule.validThru&&(a.baseModule.validThru=new Date(a.baseModule.validThru)),w.promise.then(function(){a.baseModule.capacities?a.baseModule.capacities=s(a.baseModule.capacities.concat(a.capacities)):a.baseModule.capacities=a.capacities})}function s(a){for(var b=a.concat(),c=0;c<b.length;++c)for(var d=c+1;d<b.length;++d)b[c].capacityType===b[d].capacityType&&b.splice(d--,1);return b}var t="/basemodule",u=b.endpoint(t),v=b.endpoint(t+"/teachers"),w=i.defer();a.canEdit=k.isAuthorized(j.ROLE_OIGUS_M_TEEMAOIGUS_BAASMOODUL),a.auth=c.current.locals.auth,a.baseModuleId=c.current.params.baseModuleId,a.capacities=b.endpoint("/autocomplete/schoolCapacityTypes").query({isHigher:!1}),a.capacities.$promise.then(function(a){a=a.map(function(a){a.capacityType=a.code}),w.resolve(a)})["catch"](function(a){w.reject(a)}),h.removeLastUrlFromHistory(function(a){return a&&-1!==a.indexOf("new")});var x={cvAssessment:"KUTSEHINDAMISVIIS_E",outcomes:[],capacities:a.capacities,themes:[]};a.isEditingOutcome=!1,a.editedOutcome=null,a.addOutcome=function(){angular.isString(a.outcomeEt)&&""!==a.outcomeEt&&(a.baseModule.outcomes.push({outcomeEt:a.outcomeEt,outcomeEn:a.outcomeEn,orderNr:a.baseModule.outcomes.length}),a.outcomeEt=void 0,a.outcomeEn=void 0)},a.editOutcome=function(b){a.isEditingOutcome=!0,a.editedOutcome=b,a.outcomeEt=b.outcomeEt,a.outcomeEn=b.outcomeEn},a.swap=function(b,c){var d=a.baseModule.outcomes[b];a.baseModule.outcomes[b]=a.baseModule.outcomes[c],a.baseModule.outcomes[c]=d,a.baseModuleForm.$setDirty()},a.saveOutcome=function(){angular.isString(a.outcomeEt)&&""!==a.outcomeEt&&(a.isEditingOutcome=!1,a.editedOutcome.outcomeEt=a.outcomeEt,a.editedOutcome.outcomeEn=a.outcomeEn,a.outcomeEt=void 0,a.outcomeEn=void 0)},a.removeFromArray=function(b,c){f.confirmDialog({prompt:"curriculum.itemDeleteConfirm"},function(){e.remove(b,c),a.baseModuleForm.$setDirty()})},a.hasThemes=function(){return a.baseModule&&a.baseModule.themes&&a.baseModule.themes.length>0},a.editTheme=function(b){angular.isDefined(a.baseModuleForm)&&a.baseModuleForm.$dirty===!0?f.confirmDialog({prompt:"main.messages.confirmFormDataNotSaved"},function(){o(b)}):o(b)},a.viewTheme=function(b){angular.isDefined(b)&&a.baseModuleId&&g.url("/basemodule/"+a.baseModuleId+"/"+b.id+"/view")},a.searchTeacher=function(a){return v.query({name:a}).$promise},a.edit=function(){g.url("/basemodule/"+a.baseModule.id+"/edit")},a["delete"]=function(){f.confirmDialog({prompt:"curriculum.prompt.deleteModule"},function(){a.baseModule.$delete().then(function(){d.info("main.messages.delete.success"),g.url("/basemodule")})})},a.save=function(){p()&&(q(),a.baseModule.id?n():m())},l()}]),angular.module("hitsaOis").config(["$routeProvider","USER_ROLES",function(a,b){function c(a,c){return a.vocational&&-1!==c.indexOf(b.ROLE_OIGUS_M_TEEMAOIGUS_BAASMOODUL)}function d(a,c){return a.vocational&&-1!==c.indexOf(b.ROLE_OIGUS_V_TEEMAOIGUS_BAASMOODUL)}a.when("/basemodule",{templateUrl:"baseModule/basemodule.list.html",controller:"BaseModuleListController",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:d}}).when("/basemodule/new",{templateUrl:"baseModule/basemodule.edit.html",controller:"BaseModuleEditController",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:c}}).when("/basemodule/:baseModuleId/edit",{templateUrl:"baseModule/basemodule.edit.html",controller:"BaseModuleEditController",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:c}}).when("/basemodule/:baseModuleId/view",{templateUrl:"baseModule/basemodule.view.html",controller:"BaseModuleEditController",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:d}})}]),angular.module("hitsaOis").controller("baseModuleThemeEditController",["$scope","QueryUtils","$route","message","Classifier","$location","$rootScope","dialogService","$q","$timeout",function(a,b,c,d,e,f,g,h,i,j){function k(a){for(var b=a.concat(),c=0;c<b.length;++c)for(var d=c+1;d<b.length;++d)b[c].capacityType===b[d].capacityType&&b.splice(d--,1);return b}function l(){return a.themeForm.$setSubmitted(),a.themeForm.$valid?a.theme.hours!==Math.round(r*a.theme.credits)&&a.theme.credits!==Math.round(a.theme.hours/r*10)/10?(d.error("curriculum.error.themeCreditsAndHoursMismatch"),!1):m()?!0:(d.error("curriculum.error.themeCapacitiesAndHoursMismatch"),!1):(d.error("main.messages.form-has-errors"),!1)}function m(){return a.theme.hours===a.theme.capacities.reduce(function(a,b){return angular.isDefined(b.hours)?a+=b.hours:a},0)}a.auth=c.current.locals.auth,a.baseModuleId=c.current.params.baseModuleId,a.themeId=c.current.params.baseModuleThemeId;var n="/basemodule/theme",o=b.endpoint(n),p=b.endpoint(n+"/basemodule"),q=i.defer(),r=26;a.capacities=b.endpoint("/autocomplete/schoolCapacityTypes").query({isHigher:!1}),a.capacities.$promise.then(function(a){a=a.map(function(a){a.capacityType=a.code}),q.resolve(a)})["catch"](function(a){q.reject(a)}),g.removeLastUrlFromHistory(function(a){return a&&-1!==a.indexOf("new")}),a.themeId?(a.theme=o.get({id:a.themeId}),a.theme.$promise.then(function(b){q.promise.then(function(){b.capacities?b.capacities=k(b.capacities.concat(a.capacities)):b.capacities=a.capacities}),j(function(){a.themeForm.$setPristine()})})):(a.theme=p.get({id:a.baseModuleId}),a.theme.$promise.then(function(b){b.capacities=a.capacities,b.assessment="KUTSEHINDAMISVIIS_E",b.outcomes=[],a.theme=new o(a.theme)})),a.setDefaultHours=function(){angular.isNumber(a.theme.credits)&&(a.theme.hours=Math.round(r*a.theme.credits),a.themeForm.hours.$setDirty())},a.assessments=e.queryForDropdown({mainClassCode:"KUTSEHINDAMISVIIS"}),a.setDefaultCredits=function(){a.theme.credits=Math.round(a.theme.hours/r*10)/10,a.themeForm.credits.$setDirty()},a.getDefaultUrl=function(){return"#/basemodule/"+a.baseModuleId+"/view"},a.joinOutcomes=function(b,c){return!b||angular.isUndefined(c)?"":b.map(function(b){return"en"===a.currentLanguage()?b.outcomeEn:b.outcomeEt}).join(c)},a.save=function(){l()&&(angular.isDefined(a.themeId)?a.theme.$update().then(function(b){b.capacities=k(b.capacities.concat(a.capacities)),d.info("main.messages.update.success"),j(function(){a.themeForm.$setPristine()})}):a.theme.$save().then(function(b){d.info("main.messages.create.success"),f.url("/basemodule/"+a.baseModuleId+"/"+b.id+"/edit")}))},a.edit=function(){f.url("/basemodule/"+a.baseModuleId+"/"+a.themeId+"/edit")},a["delete"]=function(){h.confirmDialog({prompt:"curriculum.prompt.deleteTheme"},function(){a.theme.$delete().then(function(){d.info("main.messages.delete.success"),f.url("/basemodule/"+a.baseModuleId+"/edit?_noback")})})}}]),angular.module("hitsaOis").config(["$routeProvider","USER_ROLES",function(a){function b(a,b,c,d,e){d.resolve().then(function(d){c.includes(d.authorizedRoles,e.ROLE_OIGUS_M_TEEMAOIGUS_BAASMOODUL)&&d.vocational||(a.error("main.messages.error.nopermission"),b.path("/"))})}function c(a,b,c,d,e){d.resolve().then(function(d){c.includes(d.authorizedRoles,e.ROLE_OIGUS_V_TEEMAOIGUS_BAASMOODUL)&&d.vocational||(a.error("main.messages.error.nopermission"),b.path("/"))})}b.$inject=["message","$location","ArrayUtils","AuthResolver","USER_ROLES"],c.$inject=["message","$location","ArrayUtils","AuthResolver","USER_ROLES"],a.when("/basemodule/:baseModuleId/new",{templateUrl:"baseModule/theme/basemodule.theme.edit.html",controller:"baseModuleThemeEditController",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],checkAccess:b}}).when("/basemodule/:baseModuleId/:baseModuleThemeId/edit",{templateUrl:"baseModule/theme/basemodule.theme.edit.html",controller:"baseModuleThemeEditController",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],checkAccess:b}}).when("/basemodule/:baseModuleId/:baseModuleThemeId/view",{templateUrl:"baseModule/theme/basemodule.theme.view.html",controller:"baseModuleThemeEditController",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],checkAccess:c}})}]),angular.module("hitsaOis").controller("BoardingSchoolSearchController",["$scope","QueryUtils",function(a,b){a.currentNavItem="boarding.school.search";var c="/boardingSchools";a.formState={xlsUrl:"boardingSchools/search.xlsx"},b.createQueryForm(a,c,{order:"p.lastname, p.firstname",showValid:!0},function(){a.showNeighbours=a.criteria.showNeighbours}),a.loadData()}]).controller("BoardingSchoolManagementController",["$scope","$timeout","$window","$q","ArrayUtils","DataUtils","FormUtils","QueryUtils","dialogService","message",function(a,b,c,d,e,f,g,h,i,j){function k(){h.endpoint(l).save(a.tabledata.content).$promise.then(function(){j.info("main.messages.update.success"),a.loadData()})}a.currentNavItem="boarding.school.management";var l="/boardingSchools/management";a.rooms=h.endpoint("/autocomplete/roomsAsList").query({isDormitory:!0}),h.createQueryForm(a,l,{order:"p.lastname, p.firstname"},function(b){angular.isDefined(a.boardingSchools)&&a.boardingSchools.$dirty===!0&&a.boardingSchools.$setPristine(),b.forEach(function(a){a.latestDorm&&(f.convertStringToDates(a.latestDorm,["validFrom","validThru"]),a.latestDormCopy=angular.copy(a.latestDorm))})},!0),a.criteria.dormitory||(a.criteria.dormitory=["YHISELAMU_L"]),a.copiedCriteria={};var m=a.loadData;a.loadData=function(){g.withValidForm(a.searchForm,function(){angular.copy(a.criteria,a.copiedCriteria),a.$broadcast("refreshFixedColumns"),m()})},d.all().then(a.loadData);var n=!1;a.changePage=function(){n||(angular.isDefined(a.boardingSchools)&&a.boardingSchools.$dirty===!0?i.confirmDialog({prompt:"main.messages.confirmFormDataNotSaved"},function(){a.loadData()},function(){n=!0,angular.copy(a.copiedCriteria,a.criteria),b(function(){n=!1},50)}):a.loadData())},a.roomChanged=function(a){""===a.latestDorm.room&&(a.latestDorm={})},a.addNew=function(b){b.previousDorms.splice(0,0,b.latestDormCopy),b.latestDorm={},b.addedToPrevious=!0,a.boardingSchools.$setDirty()},a.restorePreviousDorm=function(a){a.latestDorm=angular.copy(a.latestDormCopy),a.previousDorms.splice(0,1),a.addedToPrevious=!1,b(function(){a.latestDorm.validFrom=angular.copy(a.latestDormCopy.validFrom),a.latestDorm.validThru=angular.copy(a.latestDormCopy.validThru)})},a.previousDormsDialog=function(b){i.showDialog("boardingSchool/boarding.school.previous.places.dialog.html",function(c){c.student=b,c.removePreviousDorm=function(b){e.remove(c.student.previousDorms,b),a.boardingSchools.$setDirty()}})},a.save=function(){g.withValidForm(a.boardingSchools,function(){h.endpoint(l+"/check").post(a.tabledata.content).$promise.then(function(a){var b=a.filter(function(a){return a.occupied||a.duplicateStudents});0===b.length?k():i.showDialog("boardingSchool/boarding.school.check.dialog.html",function(a){a.content=b,a.save=function(){k()}})})})}}]).controller("BoardingSchoolRoomsController",["$scope","QueryUtils",function(a,b){a.currentNavItem="boarding.school.rooms";var c="/boardingSchools/rooms";b.createQueryForm(a,c,{order:"b_code, r_code",showValid:!0},function(){a.showResidents=a.criteria.showResidents}),a.loadData()}]),angular.module("hitsaOis").config(["$routeProvider","USER_ROLES",function(a,b){a.when("/boardingSchools",{templateUrl:"boardingSchool/boarding.school.search.html",controller:"BoardingSchoolSearchController",controllerAs:"controller",data:{authorizedRoles:function(a,c){return"ROLL_A"===a.roleCode&&-1!==c.indexOf(b.ROLE_OIGUS_V_TEEMAOIGUS_OPILASKODU)}},resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]}}).when("/boardingSchools/management",{templateUrl:"boardingSchool/boarding.school.management.html",controller:"BoardingSchoolManagementController",controllerAs:"controller",data:{authorizedRoles:function(a,c){return"ROLL_A"===a.roleCode&&-1!==c.indexOf(b.ROLE_OIGUS_M_TEEMAOIGUS_OPILASKODU)}},resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]}}).when("/boardingSchools/rooms",{templateUrl:"boardingSchool/boarding.school.rooms.html",controller:"BoardingSchoolRoomsController",controllerAs:"controller",data:{authorizedRoles:function(a,c){return"ROLL_A"===a.roleCode&&-1!==c.indexOf(b.ROLE_OIGUS_V_TEEMAOIGUS_OPILASKODU)}},resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]}})}]),angular.module("hitsaOis").controller("HomeController",["$scope","School","$location","QueryUtils","busyHandler",function(a,b,c,d,e){function f(a){var b,c;return c=/(\b(https?|ftp):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gim,b=a.replace(c,'<a href="$1" target="_blank">$1</a>')}a.schools=b.getSchoolsWithLogo(),a.linkify=f,a.openSchoolCurriculumSearch=function(a){c.path("curriculums/"+a)},a.siteMessages=d.endpoint("/generalmessages/showsitemessages").query()}]).controller("AuthenticatedHomeController",["$rootScope","$scope","$timeout","AUTH_EVENTS","AuthService","USER_ROLES","ArrayUtils","QueryUtils","$resource","config","Session","$filter","$mdDialog","message","dialogService","oisFileService","FormUtils","Classifier","$q",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){function t(a){this.promises={},this.lock=!0,this.finishEvent=a,this.addPromise=function(a,b,c,d){var e="function"==typeof b.then;e&&(b.then(c),null!==d||void 0!==d?(b["catch"](function(b){throw this.setFinish(a),b}),b["catch"](d)):b["catch"](function(){this.setFinish(a)}),this.promises[a]=b)},this.setFinish=function(a){a in this.promises&&delete this.promises[a],this.finish()},this.enable=function(){this.lock=!1,this.finish()},this.reset=function(){this.lock=!0,this.promises={}},this.finish=function(){!this.lock&&angular.equals(this.promises,{})&&(this.finishEvent(),this.lock=!0)}}function u(a){for(var b=0;b<a.length;b++)for(var c=0;c<a[b].questions.length;c++){var d=a[b].questions[c].files.filter(function(a){return-1!==a.ftype.indexOf("image")});a[b].questions[c].pictures=d}}function v(){b.pageLoadingHandler.reset(),b.isAdmin="ROLL_A"===k.roleCode,b.loadGeneralMessages(),b.loadUnreadMessages(),b.loadPolls(),y(),z(),B(),A(),C(),D(),E(),F(),x(),G(),H(),w(),b.pageLoadingHandler.enable()}function w(){k.studentId?(b.sessionStudentId=k.studentId,I()):(b.sessionStudentId=null,b.tasks=[],b.studentAbsences=[],b.absenceGroups=[],b.lastResults=[],b.remarks=[])}function x(){"ROLL_A"===k.roleCode&&g.includes(k.authorizedRoles,f.ROLE_OIGUS_V_TEEMAOIGUS_RR)&&h.endpoint("/logs/rr/hasrecentchangelogs").get({},function(a){b.rrHasRecentChangeLogs=a.hasRecentChangeLogs})}function y(){b.canCreateAbsence=!1,b.studentName=void 0,b.studentGroup=void 0,-1!==["ROLL_L","ROLL_T"].indexOf(k.roleCode)&&k.vocational&&h.endpoint("/students/"+k.studentId+"/canCreateAbsence").get({},function(a){b.canCreateAbsence=a.canCreate,b.studentName=a.studentName,b.studentGroup=a.studentGroup})}function z(){b.canApplyForPractice=!1,-1!==["ROLL_T"].indexOf(k.roleCode)&&h.endpoint("/practiceApplication/canApply").get({},function(a){b.canApplyForPractice=a.canApply})}function A(){-1!==["ROLL_A"].indexOf(k.roleCode)&&k.school.withoutEkis?b.hasOrderedCertificates=h.endpoint("/certificate/hasorderedcertificates").get():b.hasOrderedCertificates=void 0}function B(){-1!==["ROLL_O","ROLL_A"].indexOf(k.roleCode)&&k.higher?("ROLL_O"===k.roleCode&&(b.hasUncompletedPrograms=h.endpoint("/subject/subjectProgram/hasuncompleted").get()),b.hasUnconfirmedPrograms=h.endpoint("/subject/subjectProgram/hasunconfirmed").get()):(b.hasUncompletedPrograms=void 0,b.hasUnconfirmedPrograms=void 0)}function C(){-1!==["ROLL_A"].indexOf(k.roleCode)&&g.includes(k.authorizedRoles,f.ROLE_OIGUS_M_TEEMAOIGUS_BAASMOODUL)?b.hasExpiredBaseModules=h.endpoint("/basemodule/expiredhascurriculums").query():b.hasExpiredBaseModules=void 0}function D(){-1!==["ROLL_A","ROLL_O"].indexOf(k.roleCode)?h.endpoint("/absences/hasUnaccepted").search().$promise.then(function(a){b.hasUnacceptedAbsences=a.hasUnaccepted}):b.hasUnacceptedAbsences=void 0}function E(){-1!==["ROLL_O"].indexOf(k.roleCode)?h.endpoint("/groupAbsences/teacherHasTodaysAbsences").search().$promise.then(function(a){b.hasTodaysAbsences=a.hasTodaysAbsences}):b.hasTodaysAbsences=void 0}function F(){-1!==["ROLL_A","ROLL_O"].indexOf(k.roleCode)?h.endpoint("/journals/unconfirmedJournalsInfo").search().$promise.then(function(a){b.unconfirmedJournals={count:a.unconfirmedJournalCount,anyFinished:a.hasEndedUnconfirmedJournals}}):b.unconfirmedJournals=void 0}function G(){-1!==["ROLL_A"].indexOf(k.roleCode)?b.pageLoadingHandler.addPromise("expiringOccupationStandards",h.endpoint("/curriculumOccupation/expiringOccupationStandards").query().$promise,function(a){b.expiringOccupationStandards=a,0===a.length&&b.pageLoadingHandler.setFinish("expiringOccupationStandards")}):b.expiringOccupationStandards=void 0}function H(){-1!==["ROLL_O"].indexOf(k.roleCode)?b.pageLoadingHandler.addPromise("studentGroupRemarks",h.endpoint("/remarks/studentGroupRemarks").query().$promise,function(a){b.studentGroupRemarks=a,0===a.length&&b.pageLoadingHandler.setFinish("studentGroupRemarks")}):b.studentGroupRemarks=void 0}function I(){b.pageLoadingHandler.addPromise("studentTasks",h.endpoint("/journals/studentJournalTasks/").search({studentId:k.studentId}).$promise,function(a){b.tasks={todayTasks:[],tomorrowTasks:[],laterTasks:[]},angular.isDefined(a.tasks)&&a.tasks.length>0?(J(),K(a.tasks.reverse()),b.tasks.todayTasks.length>0||b.tasks.tomorrowTasks.length>0||b.tasks.laterTasks.length>0||b.pageLoadingHandler.setFinish("studentTasks")):b.pageLoadingHandler.setFinish("studentTasks")}),b.testTaskTypes=["SISSEKANNE_H","SISSEKANNE_L","SISSEKANNE_E","SISSEKANNE_I","SISSEKANNE_P","SISSEKANNE_R"],b.pageLoadingHandler.addPromise("studentAbsences",h.endpoint("/journals/studentJournalAbsences/").query({studentId:k.studentId}).$promise,function(a){b.studentAbsences=a,b.absenceGroups=b.getGroupedValues(b.studentAbsences,"entryDate","hoisDate");for(var c in b.absenceGroups){var d=0,e=0;for(var f in b.absenceGroups[c])"PUUDUMINE_H"===b.absenceGroups[c][f].absenceCode?d++:"PUUDUMINE_P"===b.absenceGroups[c][f].absenceCode&&e++;b.absenceGroups[c].PUUDUMINE_H=d>0?d:null,b.absenceGroups[c].PUUDUMINE_P=e>0?e:null}0===a.length&&b.pageLoadingHandler.setFinish("studentAbsences")}),b.pageLoadingHandler.addPromise("lastResults",h.endpoint("/journals/studentJournalLastResults/").query({studentId:k.studentId}).$promise,function(a){b.lastResults=a,0===a.length&&b.pageLoadingHandler.setFinish("lastResults")}),b.pageLoadingHandler.addPromise("remarks",h.endpoint("/remarks/student/recent/"+k.studentId).query().$promise,function(a){b.remarks=a,0===a.length&&b.pageLoadingHandler.setFinish("remarks")}),b.declaration=void 0,"ROLL_L"!==k.roleCode&&b.pageLoadingHandler.addPromise("declaration",h.endpoint("/declarations/current").get().$promise,function(a){b.declaration=a,(angular.isUndefined(a.subjects)||0===a.subjects.length)&&b.pageLoadingHandler.setFinish("declaration")})}function J(){var a,c;a=new Date,a.setHours(0,0,0,0),c=new Date,c.setDate(a.getDate()+1),c.setHours(0,0,0,0),b.todaysDate=a,b.tomorrowsDate=c}function K(a){b.tasks={todayTasks:[],tomorrowTasks:[],laterTasks:[]};for(var c=0;c<a.length;c++){var d=new Date(a[c].date);d.setHours(0,0,0,0),d.getTime()===b.todaysDate.getTime()?b.tasks.todayTasks.push(a[c]):d.getTime()===b.tomorrowsDate.getTime()?b.tasks.tomorrowTasks.push(a[c]):d>b.tomorrowsDate&&b.tasks.laterTasks.push(a[c])}}function L(a,b){0===b.children.length?b.appendChild(a):b.insertBefore(a,b.children[0])}function M(a){for(var b=0,c=0;c<a.children.length;c++)b+=a.children[c].clientHeight;return b}b.finish=function(){return c(function(){b.balance()},100),!1},b.pageLoadingHandler=new t(b.finish),b.criteria={size:5,page:1},b.generalmessages={},b.loadGeneralMessages=function(){if(b.showGeneralMessages=-1===["ROLL_P","ROLL_V"].indexOf(k.roleCode),b.showGeneralMessages){var a=h.getQueryParams(b.criteria);b.generalmessages.$promise=h.endpoint("/generalmessages/show").search(a),b.pageLoadingHandler.addPromise("generalMessages",b.generalmessages.$promise.$promise,function(a){b.generalmessages.content=a.content,b.generalmessages.totalElements=a.totalElements,0===a.totalElements&&b.pageLoadingHandler.setFinish("generalMessages")})}},b.unreadMessageCriteria={size:5,page:1,order:"-inserted"},b.unreadMessages={},b.loadUnreadMessages=function(){var a=["ROLL_P","ROLL_L","ROLL_O","ROLL_T","ROLL_A"];if(b.showUnreadMessages=-1!==a.indexOf(k.roleCode),b.showUnreadMessages){var c=h.getQueryParams(b.unreadMessageCriteria);b.unreadMessages.$promise=h.endpoint("/message/received/mainPage").search(c),b.pageLoadingHandler.addPromise("unreadMessages",b.unreadMessages.$promise.$promise,function(a){b.unreadMessages.content=a.content,b.unreadMessages.totalElements=a.totalElements,0===a.totalElements&&b.pageLoadingHandler.setFinish("unreadMessages")})}},b.loadPolls=function(){var a=r.valuemapper({status:"KYSITVASTUSSTAATUS",type:"KYSITLUS"}),c=["ROLL_V","ROLL_L","ROLL_O","ROLL_T","ROLL_A"];b.displayPoll=!1,b.canAnswerPoll=-1!==c.indexOf(k.roleCode),b.canAnswerPoll&&h.endpoint("/poll/polls").query({},function(c){b.polls=c,void 0!==b.polls&&0!==b.polls.length&&(b.displayPoll=!0,s.all(a.promises).then(function(){a.objectmapper(b.polls)}))})},b.openPoll=function(){if(1===b.polls.length){var a;a="KYSITLUS_O"===b.polls[0].type.code?h.endpoint("/poll/withAnswers/journalOrSubject"):h.endpoint("/poll/withAnswers"),h.loadingWheel(b,!0),a.get({id:b.polls[0].id}).$promise.then(function(a){h.loadingWheel(b,!1),u(a.themes),b.openResponse(b.polls[0],a)})}else b.polls.length>1&&b.openResponseList(b.polls)},b.openResponseList=function(a){o.showDialog("poll/poll.response.list.dialog.html",function(b){b.polls=a,b.openResponse=function(a){b.row=a,b.submit()}},function(a){var c;c="KYSITLUS_O"===a.row.type.code?h.endpoint("/poll/withAnswers/journalOrSubject"):h.endpoint("/poll/withAnswers"),h.loadingWheel(b,!0,!0,void 0,!1,function(){c.get({id:a.row.id}).$promise.then(function(c){u(c.themes),h.loadingWheel(b,!1,!0),b.openResponse(a.row,c)})})},null,!0)},b.openResponse=function(a,c){o.showDialog(a.isThemePageable?"poll/poll.response.by.theme.dialog.html":"KYSITLUS_O"===c.type?"poll/poll.response.by.subjectOrJournal.dialog.html":"poll/poll.response.dialog.html",function(d){function e(a,b){null===b.journal||a.includes(b.journal.nameEt+": "+b.nameEt)?null===b.subject||a.includes(b.subject.nameEt+": "+b.nameEt)?a.includes(b.nameEt)||a.push(b.nameEt):a.push(b.subject.nameEt+": "+b.nameEt):a.push(b.journal.nameEt+": "+b.nameEt)}d.formState={},d.formState.isThemePageable=a.isThemePageable,d.formState.name=c.name;var f=c.themes.filter(function(a){return null!==a.journal||null!==a.subject});d.hasSubjectOrJournal=0!==f.length,d.criteria=c,d.getUrl=function(a){return p.getUrl(a,"pollThemeQuestionFile")},a.isThemePageable||"KYSITLUS_O"!==c.type?d.criteria.themes[0].show=!0:(d.formState.themeBySubjectOrJournalId={},d.criteria.themes.forEach(function(a){null!==a.journal&&a.isRepetitive?(void 0===d.formState.themeBySubjectOrJournalId[a.journal.id]&&(d.formState.themeBySubjectOrJournalId[a.journal.id]=[]),d.formState.themeBySubjectOrJournalId[a.journal.id].push(a)):null!==a.subject&&a.isRepetitive?(void 0===d.formState.themeBySubjectOrJournalId[a.subject.id]&&(d.formState.themeBySubjectOrJournalId[a.subject.id]=[]),d.formState.themeBySubjectOrJournalId[a.subject.id].push(a)):a.isRepetitive||(void 0===d.formState.themeBySubjectOrJournalId[null]&&(d.formState.themeBySubjectOrJournalId[null]=[]),d.formState.themeBySubjectOrJournalId[null].push(a))}),Object.values(d.formState.themeBySubjectOrJournalId)[0].show=!0),d.previousSubjectOrJournal=function(a){Object.values(d.formState.themeBySubjectOrJournalId)[a].show=!1,Object.values(d.formState.themeBySubjectOrJournalId)[a-1].show=!0},d.last=function(a){return a===Object.values(d.formState.themeBySubjectOrJournalId).length-1},d.first=function(a){return 0===a},d.nextSubjectOrJournal=function(a){Object.values(d.formState.themeBySubjectOrJournalId)[a].show=!1,Object.values(d.formState.themeBySubjectOrJournalId)[a+1].show=!0},d.previousTheme=function(a){d.criteria.themes[a].show=!1,d.criteria.themes[a-1].show=!0},d.nextTheme=function(a){d.criteria.themes[a].show=!1,d.criteria.themes[a+1].show=!0},d.checkErrors=function(){var a=!1,b=[];return d.criteria.themes.forEach(function(c){c.questions.forEach(function(d){if("VASTUS_M"!==d.type&&"VASTUS_S"!==d.type||!d.isRequired)"VASTUS_R"!==d.type&&"VASTUS_T"!==d.type&&"VASTUS_V"!==d.type||!d.isRequired||void 0!==d.answerTxt&&null!==d.answerTxt?d.requiredError=!1:(d.requiredError=!0,a=!0,e(b,c));else{var f=!0;d.answers.forEach(function(a){a.chosen===!0&&(f=!1)}),f?(d.requiredError=!0,a=!0,e(b,c)):d.requiredError=!1}})}),[a,b]},d.confirm=function(){var c=d.checkErrors(),e=c[0];q.withValidForm(d.responseForm,function(){e?d.formState.isThemePageable?n.error("poll.messages.required",{themes:c[1].join(", ")}):n.error("main.messages.form-has-errors"):o.confirmDialog({prompt:"poll.answer.confirm"},function(){var c=h.endpoint("/poll/"+a.id+"/saveAnswer/final"),e=new c;e.$update().then(function(){o.messageDialog({prompt:"poll.answer.confirmed"},function(){b.loadPolls(),d.cancel()})})})})},d.save=function(a){var b=h.endpoint("/poll/"+d.criteria.responseId+"/saveAnswer"),c=new b(a);c.$putWithoutLoad()},d.clearRadio=function(a){a.answerTxt=null,d.save(a)},d.close=function(){b.loadPolls(),d.cancel()}},null,null,!0)},b.readMessage=function(b){b.clicked=!b.clicked,b.isRead||i(j.apiUrl+"/message/"+b.id).update(null).$promise.then(function(){b.isRead=!0,h.endpoint("/message/received/new").get().$promise.then(function(b){a.unreadMessages=b.unread})})},b.openCloseDetails=function(a){a.clicked=!a.clicked},e.isAuthenticated()&&v(),b.$on(d.loginSuccess,v),b.$on(d.userChanged,v);var N=3;b.numberOfOccupationStandards=N,b.toggleNumberOfOccupationStandards=function(){b.numberOfOccupationStandards=b.numberOfOccupationStandards?void 0:N},b.addAbsence=function(){var a=h.endpoint("/students/"+k.studentId+"/absences"),c={};c.studentName=b.studentName,c.studentGroup=b.studentGroup,m.show({controller:["$scope",function(b){b.record=new a(c||{}),b.cancel=m.hide,b.update=function(){function a(){n.info("main.messages.create.success"),m.hide()}return b.studentAbsenceForm.$setSubmitted(),b.studentAbsenceForm.$valid?void b.record.$save().then(a):void n.error("main.messages.form-has-errors")}}],templateUrl:"student/absence.edit.dialog.html",clickOutsideToClose:!1})},b.getGroupedValues=function(a,b,c){for(var d={},e=0;e<a.length;e++){var f=null===c?a[e][b]:l(c)(a[e][b]);null===f&&(f=""),f in d?d[f].push(a[e]):d[f]=[a[e]]}return d},b.translateObjectToArray=function(a){var b=[];for(var c in a)for(var d in a[c])b.push(a[c][d]);return b},b.balance=function(){var a=document.getElementById("column-1"),b=document.getElementById("column-2");if(null!==a&&null!==b){if(0!==b.children.length)for(var c=b.children.length,d=0;c>d;d++)a.appendChild(b.children[0]);for(var e=a.children.length,f=M(a),g=f/2,h=e-1;h>=0;h--){var i=M(b);if(!(i+a.children[h].clientHeight<g)){var j=Math.abs(i-g),k=Math.abs(i+a.children[h].clientHeight-g);j>k&&L(a.children[h],b);break}L(a.children[h],b)}}return!1}}]),angular.module("hitsaOis").config(["$routeProvider",function(a){a.when("/",{templateUrl:"home/home.html",controller:"HomeController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}]}})}]),angular.module("hitsaOis").controller("LoginController",["message","$rootScope","$scope","AuthService","AUTH_EVENTS","$location","config","$mdDialog","$timeout","ArrayUtils","PUBLIC_ROUTES","$route","QueryUtils",function(a,b,c,d,e,f,g,h,i,j,k,l,m){function n(a){angular.isObject(a)&&-1===["ROLL_V","ROLL_X"].indexOf(a.roleCode)&&m.endpoint("/message/received/new").get().$promise.then(function(a){b.unreadMessages=a.unread}),angular.isObject(a)&&angular.isObject(a.school)&&a.school.logo?b.state.logo="data:image/JPEG;base64,"+a.school.logo:b.state.logo="",angular.isObject(a)&&angular.isNumber(a.user)?b.state.userWorkplace=a.user:b.state.userWorkplace=null}function o(a){c.hideDialog&&h.hide(),a?(b.$broadcast(e.loginSuccess),b.setCurrentUser(a),n(a)):(b.setCurrentUser(null),n(null),l.current&&j.contains(k,l.current.originalPath)||f.path("/"))}function p(){b.$broadcast(e.loginFailed),f.path("/"),a.error("main.login.error")}function q(a){c.jwt=a.jwt,a.data.errorCode===t?(p(),c.showMessage("main.login.mobileid.notMobileIdUser")):a.data.errorCode?p():a.data.challengeID?(c.showMobileId(a.data.challengeID),c.mobileIdPolls=0,i(s,g.mobileIdInitialDelay)):p()}function r(a){"USER_AUTHENTICATED"===a.status?(c.hideDialog=!1,h.hide(),d.login().then(o,p)):"OUTSTANDING_TRANSACTION"===a.status?(c.mobileIdPolls++,c.mobileIdPolls<g.mobileIdMaxPolls&&i(s,g.mobileIdPollInterval)):(console.log("mobileIdStatus: "+a.status),h.hide(),p())}function s(){d.pollMobileIdStatus(c.jwt).then(r,p)}var t=301;b.loggedOut=function(){b.setCurrentUser(null),n(null)};var u=function(){c.hideDialog=!1;var a=f.search()._code;a?d.login({Authorization:"Bearer "+a}).then(o,p):d.login().then(o,p)},v=function(a){c.hideDialog=!1,d.loginLdap(a).then(o,p)},w=function(a){d.loginMobileId(a).then(q,p);
};u(),b.$on(e.reAuthenticate,function(){u()}),c.logout=function(){d.logout()["finally"](function(){b.loggedOut(),f.path("/")})},c.changeUser=function(){d.changeUser(b.state.userWorkplace).then(function(a){angular.isObject(a)?(n(a),b.setCurrentUser(a),f.path("/"),b.$broadcast(e.userChanged)):(b.loggedOut(),f.path("/"))})},c.showLogin=function(){h.show({controller:["$scope","School","$localStorage","config",function(a,c,d,e){c.getLdap().$promise.then(function(c){a.schools=c,a.schools.sort(function(a,c){return b.currentLanguageNameField(a).localeCompare(b.currentLanguageNameField(c))})}),a.credentials={},d.ldapschool&&(a.credentials.school=d.ldapschool),a.mobilenumber="372",a.cancel=function(){h.hide()},a.currentLanguageNameField=b.currentLanguageNameField,a.login=function(){a.userLoginForm.$setSubmitted(),a.userLoginForm.$valid&&a.credentials.school&&a.credentials.username&&a.credentials.password&&(d.ldapschool=a.credentials.school,v(a.credentials))},a.idCardLoginUrl=e.idCardLoginUrl,a.mIdLogin=function(){a.mobilenumber&&w(a.mobilenumber)},a.taraLoginUrl=e.apiUrl+"/taraLogin"+("en"===b.currentLanguage()?"?lang=EN":""),a.haridLoginUrl=e.apiUrl+"/haridLogin"}],templateUrl:"login/login.dialog.html",parent:angular.element(document.body),clickOutsideToClose:!0})},c.showMobileId=function(a){h.show({controller:["$scope",function(b){b.challengeID=a}],templateUrl:"login/m-id.login.dialog.html",parent:angular.element(document.body),clickOutsideToClose:!1})},c.showMessage=function(a){h.show({controller:["$scope",function(b){b.message=a}],templateUrl:"login/message.login.dialog.html",parent:angular.element(document.body),clickOutsideToClose:!0})}}]),angular.module("hitsaOis").controller("CertificateSearchController",["$scope","$sessionStorage","Classifier","DataUtils","QueryUtils","$q","$route","CertificateType","CertificateUtil",function(a,b,c,d,e,f,g,h,i){a.auth=g.current.locals.auth;var j=c.valuemapper({type:"TOEND_LIIK",status:"TOEND_STAATUS"});e.createQueryForm(a,"/certificate",{order:"-c.inserted"},j.objectmapper),d.convertStringToDates(a.criteria,["insertedFrom","insertedThru"]),g.current.params.ordered&&(a.criteria.status="TOEND_STAATUS_T"),a.auth.isStudent()&&(a.afterLoadData=function(b){a.tabledata.content=b.content,a.tabledata.totalElements=b.totalElements,j.objectmapper(b.content)},a.certificateTypes=c.queryForDropdown({mainClassCode:"TOEND_LIIK",filterValues:[h.TOEND_LIIK_MUU]}),e.endpoint("/certificate/student/status").get({id:a.auth.student}).$promise.then(function(b){a.certificateTypes.$promise.then(function(){var c=i.getForbiddenTypes(b.status);a.certificateTypes=a.certificateTypes.filter(function(a){return-1===c.indexOf(a.code)})})})["catch"](angular.noop)),f.all(j.promises).then(a.loadData)}]).controller("CertificateStudentOrderController",["$scope","Classifier","QueryUtils","$route","$location","dialogService","message","$rootScope",function(a,b,c,d,e,f,g,h){function i(a){var b=document.getElementById("content");b&&(b.innerHTML=a)}function j(){c.endpoint(l+"/content").search({type:a.record.type,addOutcomes:a.record.addOutcomes}).$promise.then(function(b){a.record.content=b.content,i(a.record.content)})["catch"](angular.noop)}function k(){f.confirmDialog({prompt:"certificate.ekisconfirm"},function(){a.record.$save().then(function(){g.info("main.messages.create.success"),e.url(l+"/"+a.record.id+"/view?_noback")})["catch"](function(a){a&&a.data&&a.data.data&&a.data.data.id&&e.url(l+"/"+a.data.data.id+"/view?_noback")})})}var l="/certificate",m=c.endpoint(l+"/order"),n=d.current.params.id;h.removeLastUrlFromHistory(function(a){return a&&(-1!==a.indexOf("certificate/"+n+"/view")||-1!==a.indexOf("certificate/new"))}),a.record=new m({type:d.current.params.typeCode}),b.queryForDropdown({mainClassCode:"TOEND_LIIK"}).$promise.then(function(b){var c=a.record.type,d=b.find(function(a){return a.code===c});a.record.headline=d?d.nameEt:""}),a.record.type&&j(),a.addOutcomesChanged=function(){a.record.type&&j()},a.save=function(){return a.certificateEditForm.$setSubmitted(),a.certificateEditForm.$valid||a.record.signatoryIdcode?void(d.current.locals.auth.school.withoutEkis||a.record.whom?k():f.confirmDialog({prompt:"certificate.emptyWhom"},function(){k()})):void g.error("main.messages.form-has-errors")}}]).controller("CertificateEditController",["$scope","QueryUtils","$route","$location","dialogService","message","$q","CertificateUtil","$rootScope","$timeout","resourceErrorHandler","config",function(a,b,c,d,e,f,g,h,i,j,k,l){function m(){a.record.student&&o().then(function(b){var c=b.fullname;a.student={id:b.id,nameEt:c,nameEn:c}}),a.contentEditable()||n(a.record.content),a.otherFound=!0,a.certificateEditForm&&a.certificateEditForm.$setPristine()}function n(a){var b=document.getElementById("content");b&&(b.innerHTML=a)}function o(){return b.endpoint(w+"/otherStudent").search({id:a.record.student}).$promise.then(function(b){return a.record.otherName=b.fullname,a.record.otherIdcode=b.idcode,a.otherFound=!0,a.forbiddenTypes=h.getForbiddenTypes(b.status),b})["catch"](angular.noop)}function p(){a.record.id||(a.record.content=null,a.record.type&&(a.record.student||a.record.otherIdcode&&a.isOtherCertificate())&&b.endpoint(w+"/content").search({student:a.record.student,type:a.record.type,otherIdcode:a.record.otherIdcode,otherName:a.record.otherName,addOutcomes:a.record.addOutcomes}).$promise.then(function(b){a.record.content=b.content,a.contentEditable()||n(a.record.content)})["catch"](angular.noop))}function q(){return a.certificateEditForm.$setSubmitted(),a.certificateEditForm.$valid?!0:(f.error("main.messages.form-has-errors"),!1)}function r(a){f.info("main.messages.create.success"),d.url(w+"/"+a.id+"/edit?_noback")}function s(){a.record.signatoryName=a.signatories.filter(function(b){return b.idcode===a.record.signatoryIdcode})[0].name}function t(b){k.responseError(b,a.certificateEditForm)["catch"](angular.noop)}function u(){a.certificateEditForm.$setSubmitted(),e.confirmDialog({prompt:a.certificateEditForm.$dirty?"certificate.operation.complete.messageSave":"certificate.operation.complete.message"},function(){function b(a){d.url(w+"/"+a.id+"/view?_noback")}var c=new z(a.record);c.$update2(b).then(function(){f.info("certificate.operation.complete.success")})["catch"](t)})}function v(){e.confirmDialog({prompt:"certificate.ekisconfirm"},function(){function b(a){d.url(w+"/"+a.id+"/view?_noback")}s();var c=new y(a.record);a.record.id?c.$update(b).then(f.updateSuccess)["catch"](angular.noop):c.$save(b).then(function(){f.info("main.messages.create.success")})["catch"](function(a){a&&a.data&&a.data.data&&a.data.data.id&&d.url(w+"/"+a.data.data.id+"/edit?_noback")})})}var w="/certificate",x=b.endpoint(w),y=b.endpoint(w+"/order"),z=b.endpoint(w+"/complete"),A=c.current.params.id,B=!1;a.forbiddenTypes=[],a.auth=c.current.locals.auth,i.removeLastUrlFromHistory(function(a){return a&&(-1!==a.indexOf("certificate/"+A+"/view")||-1!==a.indexOf("certificate/new"))}),a.contentEditable=function(){return h.contentEditable(a.record)},a.isOtherCertificate=function(){return h.isOtherCertificate(a.record)},A?(a.record=x.get({id:A},m),a.record.$promise.then(function(b){b.canBeChanged===!1&&(f.error("main.messages.error.nopermission"),a.back("#/"))})):(a.record=new x,m()),a.signatories=b.endpoint(w+"/signatories").query(),a.$watch("record.type",p),a.$watch("record.student",function(){a.record.student||(a.forbiddenTypes=[]),p()}),a.$watch("record.otherIdcode",function(){a.record.otherIdcode&&j(p,1e3),a.record&&a.record.otherIdcode&&a.certificateEditForm.idcode&&a.certificateEditForm.idcode.$valid&&a.getNameByIdcode()}),a.$watch("record.otherName",function(){a.record.otherName&&a.record.otherIdcode&&j(p,1e3)}),a.addOutcomesChanged=function(){a.record.student&&j(p,1e3)};var C=b.endpoint("/autocomplete/students");a.querySearch=function(b){if(b.length>=3){var c=g.defer();return C.search({name:b,active:h.onlyActiveStudents(a.record.type),finished:h.onlyFinishedStudents(a.record.type)},function(a){c.resolve(a.content)}),c.promise}return{}},a.studentChanged=function(){a.student&&a.record.student!==a.student.id?(a.record.student=a.student.id,o()):a.student||(a.record.student=null,a.otherFound=!1,B||(a.record.otherName=null,a.record.otherIdcode=null),B=!1)},a.save=function(){a.certificateEditForm.certificateNr&&(a.certificateEditForm.certificateNr.$setValidity("required",!0),delete a.certificateEditForm.certificateNr.$validators.required),q()&&(c.current.locals.auth.school.withoutEkis||a.record.whom||a.record.id?(s(),a.record.id?a.record.$update(m).then(f.updateSuccess)["catch"](angular.noop):a.record.$save().then(r)["catch"](angular.noop)):e.confirmDialog({prompt:"certificate.emptyWhom"},function(){s(),a.record.id?a.record.$update(m).then(f.updateSuccess)["catch"](angular.noop):a.record.$save().then(r)["catch"](angular.noop)}))},a.changedCertificateNr=function(){delete a.certificateEditForm.certificateNr.$validators.required},a.printUrl=function(){return l.apiUrl+w+"/print/"+a.record.id+"/certificate.rtf?lang="+a.currentLanguage().toUpperCase()},a.complete=u,a.saveAndOrder=function(){q()&&(c.current.locals.auth.school.withoutEkis||a.record.whom||a.record.id?v():e.confirmDialog({prompt:"certificate.emptyWhom"},function(){v()}))},a["delete"]=function(){e.confirmDialog({prompt:"certificate.deleteconfirm"},function(){a.record.$delete().then(function(){f.info("main.messages.delete.success"),i.back("#"+w+"?_noback")})["catch"](angular.noop)})},a.otherFound=!1,a.idcodePattern="^[1-6][0-9]{2}[0-1][0-9][0-3][0-9][0-9]{4}",a.getNameByIdcode=function(){b.endpoint(w+"/otherStudent",{get:{method:"GET"}}).get({idcode:a.record.otherIdcode}).$promise.then(function(b){b.id?(a.record.student=b.id,a.record.otherName=b.fullname,a.otherFound=!0,a.student={id:b.id,nameEt:b.fullname,nameEn:b.fullname,status:b.status},a.forbiddenTypes=h.getForbiddenTypes(b.status)):(B=!0,a.student=null,a.forbiddenTypes=[],b&&b.fullname?(a.record.otherName=b.fullname,a.otherFound=!0):a.otherFound=!1)})}}]).controller("CertificateViewController",["$location","$route","$scope","dialogService","ekisService","message","CertificateUtil","QueryUtils","config",function(a,b,c,d,e,f,g,h,i){function j(){c.record.student&&h.endpoint(k+"/otherStudent").search({id:c.record.student}).$promise.then(function(a){var b=a.fullname;c.record.otherName=b,c.record.otherIdcode=a.idcode,c.student={id:a.id,nameEt:b,nameEn:b}});var a=document.getElementById("content");a&&(a.innerHTML=c.record.content)}var k="/certificate",l=h.endpoint(k),m=b.current.params.id;c.auth=b.current.locals.auth,c.getCertificateUrl=e.getCertificateUrl,c.isOtherCertificate=function(){return g.isOtherCertificate(c.record)},c.printUrl=function(){return i.apiUrl+k+"/print/"+c.record.id+"/certificate.rtf?lang="+c.currentLanguage().toUpperCase()},c.order=function(){d.confirmDialog({prompt:"certificate.ekisconfirm"},function(){h.endpoint(k+"/orderFromEkis").update({id:m}).$promise.then(function(){b.reload()})["catch"](angular.noop)})},c["delete"]=function(){d.confirmDialog({prompt:"certificate.deleteconfirm"},function(){c.record.$delete().then(function(){f.info("main.messages.delete.success"),c.back("#"+k+"?_noback")})})},c.contentEditable=function(){return g.contentEditable(c.record)},c.record=l.get({id:m},j)}]).constant("CertificateType",{TOEND_LIIK_SOOR:"TOEND_LIIK_SOOR",TOEND_LIIK_OPI:"TOEND_LIIK_OPI",TOEND_LIIK_SESS:"TOEND_LIIK_SESS",TOEND_LIIK_KONTAKT:"TOEND_LIIK_KONTAKT",TOEND_LIIK_LOPET:"TOEND_LIIK_LOPET",TOEND_LIIK_MUU:"TOEND_LIIK_MUU"}).factory("CertificateUtil",["CertificateType","StudentUtil",function(a,b){return{isOtherCertificate:function(b){return b&&b.type===a.TOEND_LIIK_MUU},contentEditable:function(b){return b&&(b.type===a.TOEND_LIIK_MUU||b.type===a.TOEND_LIIK_KONTAKT||b.type===a.TOEND_LIIK_SESS)},onlyActiveStudents:function(b){return a.TOEND_LIIK_KONTAKT===b||a.TOEND_LIIK_SESS===b||a.TOEND_LIIK_OPI===b},onlyFinishedStudents:function(b){return a.TOEND_LIIK_LOPET===b},getForbiddenTypes:function(c){return b.isActive(c)?[a.TOEND_LIIK_LOPET]:b.hasFinished(c)?[a.TOEND_LIIK_OPI,a.TOEND_LIIK_KONTAKT]:[a.TOEND_LIIK_OPI,a.TOEND_LIIK_KONTAKT,a.TOEND_LIIK_LOPET]}}}]),angular.module("hitsaOis").config(["$routeProvider","USER_ROLES",function(a,b){a.when("/certificate",{templateUrl:"certificate/certificate.search.html",controller:"CertificateSearchController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_TOEND]}}).when("/certificate/new",{templateUrl:"certificate/certificate.edit.html",controller:"CertificateEditController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:function(a,c){return"ROLL_A"===a.roleCode&&-1!==c.indexOf(b.ROLE_OIGUS_M_TEEMAOIGUS_TOEND)}}}).when("/certificate/:typeCode/new",{templateUrl:"certificate/certificate.student.new.html",controller:"CertificateStudentOrderController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:function(a){return"ROLL_T"===a.roleCode}}}).when("/certificate/:id/edit",{templateUrl:"certificate/certificate.edit.html",controller:"CertificateEditController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_TOEND]}}).when("/certificate/:id/view",{templateUrl:"certificate/certificate.view.html",controller:"CertificateViewController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_TOEND]}})}]),angular.module("hitsaOis").factory("Classifier",["$q","$resource","config","CacheFactory","QueryUtils",function(a,b,c,d,e){function f(){}return new d("classifierCache"),f.get=function(a){var d=b(c.apiUrl+"/classifier/:code");return d.get({code:a})},f.query=function(a,d){var f=b(c.apiUrl+"/classifier"),g=e.getQueryParams(a);return f.get(g,d)},f.queryForAutocomplete=function(a,d){var f=b(c.apiUrl+"/classifier/getPossibleParentClassifiers"),g=e.getQueryParams(a);return f.query(g,d)},f.queryForDropdown=function(e,f){function g(a){for(var b=0,c=a.length;c>b;b++)(void 0===e.higher||void 0!==e.vocational||e.higher===a[b].higher)&&(void 0===e.vocational||void 0!==e.higher||e.vocational===a[b].vocational)&&(void 0===e.vocational||void 0===e.higher||e.vocational===a[b].vocational||e.higher===a[b].higher)&&(void 0===e.filterValues||-1===e.filterValues.indexOf(a[b].code))&&l.push(angular.copy(a[b]));var d=e.order;d&&l.sort(function(a,b){var c=a[d],e=b[d];return e>c?-1:c>e?1:0}),m.resolve(l),l.$resolved=!0,angular.isFunction(f)&&m.promise.then(function(){f(l)})}var h=b(c.apiUrl+"/autocomplete/classifiers"),i={mainClassCode:e.mainClassCode};angular.isDefined(e.mainClassCodes)&&(i={mainClassCodes:e.mainClassCodes});var j=d.get("classifierCache"),k=i.mainClassCodes||i.mainClassCode,l=[],m=a.defer();l.$promise=m.promise;var n=j.get(k);return n&&n.$resolved?g(n):(l.$resolved=!1,n||(n=h.query(i),j.put(k,n)),n.$promise.then(function(){g(n)})),l},f.getChildren=function(a){return b(c.apiUrl+"/classifier/children/:code").query({code:a})},f.getPossibleConnections=function(a){var d=b(c.apiUrl+"/classifier/connections/:code");return d.query({code:a})},f.getParents=function(a){var d=b(c.apiUrl+"/classifier/parents/:code");return d.query({code:a})},f.getParentsWithMainClass=function(a,d){var e=b(c.apiUrl+"/classifier/parents/:parentsMainClassCode/:code");return e.query({parentsMainClassCode:a,code:d})},f.toMap=function(a){return a.reduce(function(a,b){return a[b.code]=b,a},{})},f.getSelectedCodes=function(a){for(var b=[],c=0,d=a.length;d>c;c++){var e=a[c];e._selected&&b.push(e.code)}return b},f.setSelectedCodes=function(a,b){for(var c=0,d=a.length;d>c;c++){var e=a[c];e._selected=-1!==b.indexOf(e.code)}},f.valuemapper=function(a){function b(a){return function(b){d[a]=f.toMap(b)}}function c(a,b){var c=d[a];return angular.isArray(b)?b.map(function(a){return c[a]}):c[b]}var d={},e=[];for(var g in a){var h=a[g];d[h]=f.queryForDropdown({mainClassCode:h}),e.push(d[h].$promise.then(b(h)))}var i=function(b){if(Array.isArray(b))return b.map(i);for(var d in a)b.hasOwnProperty(d)&&(b[d]=c(a[d],b[d]));return b};return{promises:e,objectmapper:i}},f.isValid=function(a){var b=new Date;return b.setUTCHours(0,0,0,0),(!a.validFrom||new Date(a.validFrom)<=b)&&(!a.validThru||new Date(a.validThru)>=b)},f}]),angular.module("hitsaOis").factory("classifierAutocomplete",["$translate","config","$resource",function(a,b,c){var d={},e=c(b.apiUrl+"/classifier/getPossibleParentClassifiers");return d.searchByName=function(b,c){if(!b||b.length<3)return[];var d={mainClassCode:c,name:b,language:"en"===a.use()?"EN":"ET"};return e.query(d).$promise},d}]),angular.module("hitsaOis").factory("ClassifierConnect",["QueryUtils",function(a){function b(a){this.classifierCode=a.classifierCode,this.connectClassifierCode=a.connectClassifierCode}return b.query=function(b,c){var d=a.getQueryParams(b);return a.endpoint("/classifierConnect").search(d,c)},b.queryAll=function(b,c){var d=a.getQueryParams(b);return a.endpoint("/classifierConnect/all").query(d,c)},b.sendListOfParents=function(b,c){return a.endpoint("/classifierConnect/changeParents/"+b.code).save(c)},b}]),angular.module("hitsaOis").controller("ClassifierContentEditController",["$scope","$route","Classifier","classifierAutocomplete","$location","message","ClassifierConnect","dialogService","QueryUtils","DataUtils",function(a,b,c,d,e,f,g,h,i,j){function k(){a.parents=[],s&&(a.classifier=t.get({id:s},function(){j.convertStringToDates(a.classifier,["validFrom","validThru"]),l(a.classifier.code),m(a.classifier.code)})),n()}function l(b){c.getParents(b).$promise.then(function(b){a.parents=b})}function m(b){c.getChildren(b).$promise.then(function(b){a.children=b,a.hasChildren=b.length>0})}function n(){a.mainClassCode=b.current.params.mainClassCode,a.mainClass=c.get(a.mainClassCode).$promise.then(function(b){a.mainClass=b,o()})}function o(){c.getPossibleConnections(a.mainClassCode).$promise.then(function(b){a.possibleConnections=b})}function p(){g.sendListOfParents(a.classifier,a.parents),a.classifier.id=a.classifier.code,a.classifier.$update().then(function(){f.info("main.messages.create.success"),a.classifierForm.$setPristine()})}function q(){a.classifier.value=a.classifier.value.toUpperCase(),a.classifier.mainClassCode=a.mainClassCode,a.classifier.code=a.classifier.mainClassCode+"_"+a.classifier.value,a.classifier.valid=!0,a.classifier.id=a.classifier.code,new t(a.classifier).$save().then(function(b){g.sendListOfParents(b,a.parents),f.info("main.messages.create.success"),e.url("/classifier/"+a.mainClassCode+"/"+b.code+"/edit?_noback")})}function r(b){return 0===a.parents.filter(function(a){return a.code===b.code}).length}var s=b.current.params.codeThis,t=i.endpoint("/classifier");k(),a.save=function(){a.classifierForm.$setSubmitted(),a.classifierForm.$valid?a.classifier.code?p():q():f.error("main.messages.form-has-errors")},a["delete"]=function(){h.confirmDialog({prompt:"classifier.deleteconfirm"},function(){a.classifier.id=a.classifier.code,a.classifier.$delete().then(function(){f.info("main.messages.delete.success"),e.path("/classifier/"+a.mainClassCode)})})},a.querySearch=function(a,b){return d.searchByName(a,b)},a.addParent=function(b){b&&r(b)&&(a.parents.push(b),a.classifierForm.$setDirty())},a.removeParent=function(b){h.confirmDialog({prompt:"classifier.prompt.deleteParent"},function(){a.parents.splice(a.parents.indexOf(b),1),a.classifierForm.$setDirty()})}}]),angular.module("hitsaOis").controller("ClassifierContentListController",["$route","$scope","Classifier","QueryUtils",function(a,b,c,d){b.mainClassCode=a.current.params.code,d.createQueryForm(b,"classifier.list",{order:"value"}),b.mainClass=c.get(b.mainClassCode),b.loadData=function(){var a=angular.extend({},b.criteria,{mainClassCode:b.mainClassCode});b.toStorage("classifier.list",d.getQueryParams(a)),b.tabledata.$promise=c.query(a,b.afterLoadData).$promise},b.isValid=c.isValid,b.loadData()}]),angular.module("hitsaOis").config(["$routeProvider","USER_ROLES",function(a,b){a.when("/classifier",{templateUrl:"classifier/classifier.list.html",controller:"SimpleListController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],params:["$translate",function(a){return{order:"en"===a.use()?"nameEn":"nameEt"}}],url:function(){return"/classifier/heads"}},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_KLASSIFIKAATOR]}}).when("/classifier/:code",{templateUrl:"classifier/classifier.content.list.html",controller:"ClassifierContentListController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_KLASSIFIKAATOR]}}).when("/classifier/:mainClassCode/new",{templateUrl:"classifier/classifier.content.edit.html",controller:"ClassifierContentEditController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_KLASSIFIKAATOR]}}).when("/classifier/:mainClassCode/:codeThis/edit",{templateUrl:"classifier/classifier.content.edit.html",controller:"ClassifierContentEditController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_KLASSIFIKAATOR]}})}]),angular.module("hitsaOis").controller("SaisClassifierListController",["$scope","message","QueryUtils",function(a,b,c){a.saisImport=function(){c.endpoint("/saisClassifier/saisImport").save().$promise.then(function(){b.info("saisClassifier.importFinished")})},c.createQueryForm(a,"/saisClassifier",{order:"en"===a.currentLanguage()?"nameEn":"nameEt"}),a.loadData()}]),angular.module("hitsaOis").config(["$routeProvider","USER_ROLES",function(a,b){a.when("/saisClassifier",{templateUrl:"saisClassifier/saisClassifier.list.html",controller:"SaisClassifierListController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:function(a,c){var d=c||[];return-1!==d.indexOf(b.ROLE_OIGUS_V_TEEMAOIGUS_KLASSIFIKAATOR)&&-1!==d.indexOf(b.ROLE_OIGUS_V_TEEMAOIGUS_ANDMEVAHETUS_SAIS)}}}).when("/saisClassifier/:code",{templateUrl:"saisClassifier/saisClassifier.content.list.html",controller:"SimpleListController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],params:function(){return{order:"value"}},url:["$route",function(a){return"/saisClassifier/"+a.current.params.code}]},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_KLASSIFIKAATOR]}})}]),angular.module("hitsaOis").config(["$routeProvider","USER_ROLES",function(a,b){a.when("/committees/:type",{templateUrl:"committee/committee.search.html",controller:"CommitteeSearchController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_KOMISJON]}}).when("/committees/:type/new",{templateUrl:"committee/committee.edit.html",controller:"CommitteeEditViewController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_KOMISJON]}}).when("/committees/:type/:id/edit",{templateUrl:"committee/committee.edit.html",controller:"CommitteeEditViewController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_KOMISJON]}}).when("/committees/:type/:id/view",{templateUrl:"committee/committee.view.html",controller:"CommitteeEditViewController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_KOMISJON]}})}]),angular.module("hitsaOis").controller("CommitteeSearchController",["$scope","$route","QueryUtils","USER_ROLES","AuthService","FormUtils",function(a,b,c,d,e,f){a.canEdit=e.isAuthorized(d.ROLE_OIGUS_M_TEEMAOIGUS_KOMISJON);var g="/committees";a.committeeType=b.current.params.type,a.showName=-1!==["KOMISJON_T","KOMISJON_V","KOMISJON_A"].indexOf(a.committeeType),a.showPersonSearch=-1!==["KOMISJON_T","KOMISJON_V","KOMISJON_A"].indexOf(a.committeeType),c.createQueryForm(a,g,{type:a.committeeType,order:"c.id"});var h=a.clearCriteria;a.clearCriteria=function(){h(),a.criteria.type=a.committeeType};var i=a.loadData;a.loadData=function(){a.searchForm?f.withValidForm(a.searchForm,i):i()},a.loadData();var j;a.criteria&&(j=a.criteria.member),a.members=c.endpoint(g+"/members").query(function(){j&&(a.criteria.member=a.members.find(function(a){return a.id===j.id&&a.nameEt===j.nameEt}))}),a.$watch("criteria.member",function(){a.criteria.member?a.criteria.member.id?(a.criteria.teacher=a.criteria.member.id,a.criteria.memberName=null):(a.criteria.teacher=null,a.criteria.memberName=a.criteria.member.nameEt):(a.criteria.teacher=null,a.criteria.memberName=null)})}]),angular.module("hitsaOis").controller("CommitteeEditViewController",["$scope","dialogService","QueryUtils","message","ArrayUtils","$route","$location","orderByFilter","DataUtils","$rootScope","$q","Classifier","ScholarshipUtils",function(a,b,c,d,e,f,g,h,i,j,k,l,m){function n(){i.convertStringToDates(a.record,["validFrom","validThru"]),a.record.members=h(a.record.members,["memberName"]),k.all(u.promises).then(function(){a.record.scholarshipDecisions&&u.objectmapper(a.record.scholarshipDecisions)}),a.committeeEditForm&&a.committeeEditForm.$setPristine()}function o(){return 1===a.record.members.filter(p).length}function p(a){return a.isChairman}function q(){return a.committeeEditForm.$setSubmitted(),a.committeeEditForm.$valid?o()?!0:(d.error("committee.error.chairman"),!1):(d.error("main.messages.form-has-errors"),!1)}var r="/committees",s=f.current.params.id;a.committeeType=f.current.params.type,a.showName=-1!==["KOMISJON_T","KOMISJON_V","KOMISJON_A"].indexOf(a.committeeType),a.showPersonSearch=-1!==["KOMISJON_T","KOMISJON_V","KOMISJON_A"].indexOf(a.committeeType),a.allowExternalPerson=-1!==["KOMISJON_A","KOMISJON_K"].indexOf(a.committeeType),a.formState={};var t=c.endpoint(r),u=l.valuemapper({scholarshipType:"STIPTOETUS"});j.removeLastUrlFromHistory(function(a){return a&&(-1!==a.indexOf("committees/"+s+"/view")||-1!==a.indexOf("committees/new"))}),s?a.record=t.get({id:s},n):a.record=new t({type:a.committeeType,members:[]}),a.clearMember=function(a){a.memberName=void 0,a.person=void 0,a.teacher=void 0},a.addMember=function(){a.record.members.push({isExternal:!1,isChairman:!1}),a.committeeEditForm.$setDirty()},a.removeMember=function(b){e.remove(a.record.members,b),a.committeeEditForm.$setDirty()},a.assingChairman=function(b){b.isChairman&&a.record.members.forEach(function(a){a!==b&&(a.isChairman=!1)})},a.save=function(){q()&&(a.record.id?a.record.$update().then(function(b){d.info("main.messages.update.success"),a.record=b,n()})["catch"](angular.noop):a.record.$save().then(function(b){d.info("main.messages.create.success"),g.url(r+"/"+a.committeeType+"/"+b.id+"/edit?_noback")})["catch"](angular.noop))},a["delete"]=function(){b.confirmDialog({prompt:"committee.prompt.deleteconfirm"},function(){a.record.$delete().then(function(){d.info("committee.message.deleted"),g.path(r+"/"+a.committeeType)})})},a.curriculumSelected=function(){if(a.formState.curriculum){if(angular.isArray(a.record.curriculums)||(a.record.curriculums=[]),a.record.curriculums.some(function(b){return b.id===a.formState.curriculum.id}))return d.error("committee.error.duplicateCurriculum"),void(a.formState.curriculum=void 0);a.record.curriculums.push(a.formState.curriculum),a.formState.curriculum=void 0}},a.deleteCurriculum=function(b){var c=a.record.curriculums.indexOf(b);-1!==c&&a.record.curriculums.splice(c,1)},a.getScholarshipTypeForUrl=m.getScholarshipTypeGroup}]),angular.module("hitsaOis").directive("oisDrag",function(){return{restrict:"A",link:function(a,b,c){c.$observe("oisDrag",function(a){b.prop("draggable","true"===a)}),b.on("dragstart",function(a){null!==a.target.attributes.getNamedItem("old-event-id")&&a.dataTransfer.setData("oldEventId",a.target.attributes.getNamedItem("old-event-id").value),null!==a.target.attributes.getNamedItem("capacity-type")&&a.dataTransfer.setData("capacityType",a.target.attributes.getNamedItem("capacity-type").value),null!==a.target.attributes.getNamedItem("journal-id")&&a.dataTransfer.setData("journalId",a.target.attributes.getNamedItem("journal-id").value),a.dataTransfer.setData("elementId",a.target.id)})}}}),angular.module("hitsaOis").directive("oisDrop",function(){return{restrict:"A",scope:{dropFn:"&",indexValue:"@"},link:function(a,b,c){b.on("dragover",function(a){"true"===c.oisDrop&&a.preventDefault()}),b.on("drop",function(b){if("true"===c.oisDrop){b.preventDefault();var d={};d.id=b.dataTransfer.getData("elementId"),d.journalId=b.dataTransfer.getData("journalId"),d.oldEventId=b.dataTransfer.getData("oldEventId"),d.capacityType=b.dataTransfer.getData("capacityType"),d.index=a.indexValue,b.target.appendChild(document.getElementById(d.id)),a.dropFn({data:d})}}),b.on("dragenter",function(){"true"===c.oisDrop&&this.classList.add("highlight-drop-area")}),b.on("dragleave",function(){"true"===c.oisDrop&&this.classList.remove("highlight-drop-area")}),b.bind("error",function(){""===c.onErrorSrc?c.ngHide=!0:c.src!==c.onErrorSrc&&c.$set("src",c.onErrorSrc)})}}}),angular.module("hitsaOis").directive("oisHigherDrop",function(){return{restrict:"A",scope:{dropFn:"&"},link:function(a,b,c){b.on("dragover",function(a){"true"===c.oisHigherDrop&&a.preventDefault()}),b.on("drop",function(b){if("true"===c.oisHigherDrop){b.preventDefault();var d={};d.id=b.dataTransfer.getData("elementId"),d.journalId=b.dataTransfer.getData("journalId"),d.oldEventId=b.dataTransfer.getData("oldEventId"),d.capacityType=b.dataTransfer.getData("capacityType"),b.target.appendChild(document.getElementById(d.id).cloneNode(!0)),a.dropFn({data:d})}}),b.on("dragenter",function(){"true"===c.oisHigherDrop&&this.classList.add("highlight-drop-area")}),b.on("dragleave",function(){"true"===c.oisHigherDrop&&this.classList.remove("highlight-drop-area")}),b.bind("error",function(){""===c.onErrorSrc?c.ngHide=!0:c.src!==c.onErrorSrc&&c.$set("src",c.onErrorSrc)})}}}),angular.module("hitsaOis").directive("onErrorSrc",function(){return{restrict:"A",scope:{},link:function(a,b,c){b.bind("error",function(){""===c.onErrorSrc?c.ngHide=!0:c.src!==c.onErrorSrc&&c.$set("src",c.onErrorSrc)})}}}),angular.module("hitsaOis").directive("disallowSameFile",function(){return{restrict:"A",require:"ngModel",link:function(a,b,c,d){var e=a[c.disallowSameFile];a.$watchCollection(c.lfFiles,function(a){if(angular.isArray(e)&&angular.isArray(a)){var b=!1;e.forEach(function(c){if(angular.isObject(c.oisFile)){var d=c.oisFile.fname;a.forEach(function(a){a.lfFileName===d&&(b=!0)})}}),d.$setValidity("samefile",!b)}})}}}),angular.module("hitsaOis").directive("unique",["config","$http",function(a,b){
return{restrict:"A",scope:{unique:"="},require:"ngModel",link:function(c,d,e,f){f.$asyncValidators.unique=function(d,e){return c.unique.paramValue=e,b({url:a.apiUrl+c.unique.url,method:"GET",params:c.unique}).then(function(a){return f.$setValidity("notUnique",a.data),a.data})}}}}]),angular.module("hitsaOis").directive("menuLink",function(){return{restrict:"E",scope:{section:"="},templateUrl:"components/menu-link.tmpl.html",link:function(a,b){var c=b.parent().controller();a.isSelected=function(){return c.isSelected(a.section)},a.focusSection=function(){c.autoFocusContent=!0}}}}).directive("menuToggle",["$mdUtil","$animateCss","$$rAF",function(a,b,c){return{restrict:"E",scope:{section:"="},templateUrl:"components/menu-toggle.tmpl.html",link:function(d,e){var f=e.parent().controller();d.renderContent=!1,d.isOpen=function(){return f.isOpen(d.section)},d.toggle=function(){f.toggleOpen(d.section)},a.nextTick(function(){d.$watch(function(){return f.isOpen(d.section)},function(f){var g=e.find("ul");f&&(d.renderContent=!0),c(function(){var c=f?g[0].scrollHeight:0;b(g,{easing:"cubic-bezier(0.35, 0, 0.25, 1)",to:{height:c+"px"},duration:.75}).start().then(function(){var b=g[0].querySelector("a.active");if(d.renderContent=f,f&&b&&0===g[0].scrollTop){var c=b.scrollHeight,e=b.offsetTop,h=b.offsetParent,i=h?h.offsetTop:0,j=2*c,k=e+i-j;a.animateScrollTo(document.querySelector(".docs-menu").parentNode,k)}})})})});var g=e[0].parentNode.parentNode.parentNode;if(g.classList.contains("parent-list-item")){var h=g.querySelector("h2");e[0].firstChild.setAttribute("aria-describedby",h.id)}}}}]),function(){angular.module("hitsaOis").directive("hoisAdsAdapter",["inAadressService","$document",function(a,b){return{restrict:"E",replace:!0,scope:{value:"=ngModel",adsOid:"=adsOidModel",address:"=addressModel",ov:"=?ovModel",required:"@",ngRequired:"="},link:function(c,d){function e(){a.getInAds().setAddress(c.address)}var f=d[0];a.append(f),a.isLoaded()&&a.getInAds().hideResult(),c.$watch("address",e),b.on("inaadressLoaded",e),b.on("addressSelected",function(b){var d=b.detail[0];c.$apply(function(a){a.value=d.koodaadress,a.adsOid=d.ads_oid,a.address=d.aadress,a.ov=d.ehakov}),a.getInAds().hideResult()})}}}])}(),angular.module("hitsaOis").directive("hoisAutocomplete",["$rootScope","$translate","$q","QueryUtils","DataUtils",function(a,b,c,d,e){return{templateUrl:function(a,b){return angular.isDefined(b.multiple)?"components/hois.chip.autocomplete.html":angular.isDefined(b.label)&&b.label.length>0?"components/hois.autocomplete.html":"components/hois.autocomplete.nolabel.html"},restrict:"E",require:"ngModel",scope:{maxChips:"@",ngModel:"=",ngSearchText:"=?",label:"@",method:"@",haAttribute:"@",haSearch:"=?",display:"@",mdMinLength:"@",haIgnored:"@",multiple:"@",ngRequired:"=",required:"@",ngDisabled:"=",disabled:"@",mdSelectedItemChange:"&?",readonly:"=",additionalQueryParams:"=",warningParam:"@",noPaging:"@",url:"@",haController:"=?"},link:{post:function(f,g,h){function i(a,b,c){var d=a.filter(function(a){return c?a[c]===b:a===b});return d.length>0?d[0]:null}function j(a,b,c){return a.filter(function(a){for(var d=0;d<b.length;d++)if(c&&a[c]===b[d]||angular.isUndefined(c)&&a===b[d])return!0;return!1})}function k(a,b){return angular.isDefined(f.multiple)?angular.isDefined(f.haAttribute)?angular.isArray(a)&&angular.isArray(b)?a.length!==b.length?!1:0===b.filter(function(b,c){return b[f.haAttribute]!==a[c]}).length:a===b:angular.equals(a,b):angular.isDefined(f.haAttribute)?angular.isDefined(a)&&angular.isDefined(b)&&null!==a&&null!==b?b[f.haAttribute]===a:a===b:angular.equals(a,b)}if(angular.isUndefined(f.haSearch))var l=f.url?f.url:"/autocomplete/"+f.method,m=d.endpoint(l);var n={};if(angular.isDefined(f.haIgnored)&&"true"===f.haIgnored&&(f.haSearch=[]),angular.isUndefined(f.haSearch)&&(f.haSearch=function(a){var d=c.defer(),e={lang:b.use().toUpperCase(),name:a};return f.additionalQueryParams&&angular.extend(e,f.additionalQueryParams),"/autocomplete/curriculumversions"===l?m.query(e,function(a){d.resolve(a)}):"/autocomplete/studentgroups"===l?m.query(e,function(a){d.resolve(a)}):"/autocomplete/curriculumversionomodules"===l?m.query(e,function(a){d.resolve(a)}):"/autocomplete/enterprises"===l?m.query(e,function(a){d.resolve(a)}):"/autocomplete/activeEnterprises"===l?m.query(e,function(a){d.resolve(a)}):"/autocomplete/journals"===l?m.query(e,function(a){d.resolve(a)}):"/autocomplete/journalsAndStudentGroups"===l?m.query(e,function(a){d.resolve(a)}):"true"===f.noPaging?m.query(e,function(a){d.resolve(a)}):m.search(e,function(a){d.resolve(a.content)}),d.promise}),f.isRequired=angular.isDefined(f.required),g.attr("required",f.isRequired),f.isDisabled=angular.isDefined(f.disabled),g.attr("disabled",f.isDisabled),angular.isUndefined(f.mdMinLength)&&(f.mdMinLength=1),angular.isDefined(f.haAttribute)){var o=f.haSearch();angular.isObject(f.ngModel)&&f.ngModel.hasOwnProperty(f.haAttribute)?f.ngHolder=f.ngModel:o&&angular.isFunction(o.then)?o.then(function(a){f.ngHolder=angular.isDefined(f.multiple)?j(a,f.ngHolder?f.ngHolder:f.ngModel,f.haAttribute):i(a,f.ngHolder?f.ngHolder:f.ngModel,f.haAttribute)}):o&&angular.isArray(o)?f.ngHolder=angular.isDefined(f.multiple)?j(o,f.ngModel,f.haAttribute):i(o,f.ngModel,f.haAttribute):f.ngHolder=f.ngModel}else f.ngHolder=f.ngModel;angular.isDefined(h.multiple)&&!angular.isArray(f.ngHolder)&&(f.ngHolder=[]),angular.isDefined(f.multiple)?(f.$watchCollection("ngHolder",function(a,b){a===b||k(f.ngModel,a)||(angular.isDefined(f.haAttribute)?(f.ngModel=[],angular.isArray(a)&&a.forEach(function(a){f.ngModel.push(angular.isObject(a)?a[f.haAttribute]:a)})):f.ngModel=a||[])}),f.$watchCollection("ngModel",function(a){k(a,f.ngHolder)||(a&&a.length>0?f.ngHolder=a:f.ngHolder=a||[])})):(f.$watch("ngHolder",function(a,b){a===b||k(f.ngModel,a)||(angular.isDefined(f.haAttribute)?f.ngModel=a?a[f.haAttribute]:null:f.ngModel=a)}),f.$watch("ngModel",function(a,b){a===b||k(a,f.ngHolder)||(angular.isDefined(f.haAttribute)?void 0===a||null===a?f.ngHolder=a:a.hasOwnProperty(f.haAttribute)&&(f.ngHolder=a):f.ngHolder=a)})),n.clear=function(){angular.isUndefined(f.multiple)?f.ngHolder=null:(f.ngHolder=[],angular.isDefined(e.get(f,"$$childHead.$mdChipsCtrl.autocompleteCtrl.scope.searchText"))&&(f.$$childHead.$mdChipsCtrl.autocompleteCtrl.scope.searchText=null)),f.ngSearchText=null},angular.isDefined(f.haController)&&(angular.isArray(f.haController)?f.haController.push(n):f.haController=[n]),f.transformChip=function(a){return angular.isObject(a)?a:void 0},f.getChipText=function(b){return f.display?b[f.display]:a.currentLanguageNameField(b)},f.selectedItemChange=function(){angular.isFunction(f.mdSelectedItemChange)&&(angular.isFunction(f.mdSelectedItemChange())?f.$$postDigest(f.mdSelectedItemChange()):f.$$postDigest(f.mdSelectedItemChange))}}}}}]),angular.module("hitsaOis").directive("hoisButton",["QueryUtils","$q",function(a,b){return{template:'<md-button class="{{hbClass}}" ng-click="click()">{{hbLabel}}</md-button>',restrict:"E",scope:{hbClick:"&?",hbLabel:"@",hbClass:"@",hbLoading:"@",hbPromise:"@"},link:function(c,d,e){angular.isUndefined(c.hbClass)&&(c.hbClass=e["class"]),angular.isDefined(c.hbLoading)&&angular.isDefined(c.hbClick)?c.click=function(){a.loadingWheel(c,!0);var d=b.defer(),e=c.hbClick();angular.isDefined(c.hbPromise)?e.then(function(a){d.resolve(a)})["catch"](function(a){d.resolve(a)}):d.resolve(),d.promise.then(function(){a.loadingWheel(c,!1)})}:c.click=c.hbClick}}}]),angular.module("hitsaOis").directive("hoisCreatedModified",function(){return{restrict:"E",scope:{object:"="},templateUrl:"components/hois.created.modified.html"}}),angular.module("hitsaOis").directive("hoisClassifierAutocomplete",["$rootScope","$translate","$q","Classifier",function(a,b,c,d){return{templateUrl:"components/hois.chip.autocomplete.html",restrict:"E",require:"ngModel",scope:{maxChips:"@",ngModel:"=",label:"@",mainClassCode:"@"},link:function(b){angular.isArray(b.ngModel)||(b.ngModel=[]);var e={};b.transformChip=function(a){return angular.isObject(a)?(e[a.code]=a,a.code):void 0},b.getChipText=function(b){return a.currentLanguageNameField(e[b])},b.search=function(e){var f=c.defer(),g=a.currentLanguageNameVariable(),h=function(a){var b=a.filter(function(a){return a[g].includes(e)});f.resolve(b)};return d.queryForDropdown({mainClassCode:b.mainClassCode,sort:g},h),f.promise}}}}]),function(){function a(a,b,c){var d={},e={order:a.$root.currentLanguageNameField()};if(angular.isDefined(a.mainClassifierCode))e.mainClassCode=a.mainClassifierCode;else{if(!angular.isString(a.mainClassifierCodes))return;e.mainClassCodes=a.mainClassifierCodes.replace(/\s/g,"")}angular.isObject(a.criteria)&&angular.extend(e,a.criteria);var f=function(){function e(){for(var b in a.optionsByCode)a.optionsByCode[b].hide=!1}function f(b){if(!angular.isDefined(b)||null===b||""===b||angular.isArray(b)&&0===b.length)a.value=void 0,e();else{var f={mainClassifierCode:a.connectMainClassifierCode},h=b;angular.isArray(b)?h=b.join(","):angular.isObject(b)&&(h=b.code),angular.isDefined(a.searchFromConnect)?f.connectClassifierCode=h:f.classifierCode=h,c.queryAll(f,function(b){var c=[];if(b.forEach(function(b){var d=angular.isDefined(a.searchFromConnect)?b.classifier.code:b.connectClassifier.code;c.push(d)}),angular.isDefined(a.showOnlyValues)||angular.isDefined(a.filterValues))for(var e in a.optionsByCode)a.optionsByCode[e].hide=-1===c.indexOf(e);if(angular.isDefined(a.selectFirstValue)){var f=c.length>0?c[0]:angular.isDefined(a.defaultValue)?a.defaultValue:null;null!==f&&(angular.isDefined(a.modelValueAttr)?a.value=d[f][a.modelValueAttr]:a.value=d[f])}g()})}!angular.isDefined(a.value)&&angular.isDefined(a.defaultValue)&&(a.value=a.defaultValue)}var g=function(){angular.isUndefined(a.ignorePreselected)&&(angular.isArray(a.value)?a.value.forEach(function(b,c,d){!angular.isString(b)||angular.isDefined(a.optionsByCode[b])&&!a.optionsByCode[b].hide||d.splice(c,1)}):angular.isObject(a.value)&&angular.isString(a.value.code)&&(!angular.isDefined(a.optionsByCode[a.value.code])||a.optionsByCode[a.value.code].hide)?a.value=void 0:"code"!==a.modelValueAttr||!angular.isString(a.value)||angular.isDefined(a.optionsByCode[a.value])&&!a.optionsByCode[a.value].hide||(a.value=void 0))},h=function(){if(angular.isDefined(a.showOnlyValues)&&a.$parent.$watchCollection(a.showOnlyValues,function(c){var d=[];angular.isArray(c)&&c.forEach(function(b){var c=b;angular.isDefined(a.byProperty)&&angular.isObject(b)&&(c=b[a.byProperty]),angular.isString(c)?d.push(c):angular.isObject(c)&&angular.isString(c.code)&&d.push(c.code)});for(var e in a.optionsByCode){var f=a.optionsByCode[e];f.hide=c!==!0&&-1===d.indexOf(e),angular.isDefined(a.onlyValid)&&f.hide===!1&&!b.isValid(f)&&(f.hide=!0)}g()}),angular.isDefined(a.filterValues)&&a.$parent.$watchCollection(a.filterValues,function(c){var d=[];angular.isArray(c)&&c.forEach(function(b){var c=b;angular.isDefined(a.byProperty)&&angular.isObject(b)&&(c=b[a.byProperty]),angular.isString(c)?d.push(c):angular.isObject(c)&&angular.isString(c.code)&&d.push(c.code)});for(var e in a.optionsByCode){var f=a.optionsByCode[e];f.hide=-1!==d.indexOf(e),angular.isDefined(a.onlyValid)&&f.hide===!1&&!b.isValid(f)&&(f.hide=!0)}g()}),angular.isDefined(a.onlyValid))for(var c in a.optionsByCode){var d=a.optionsByCode[c];angular.isDefined(a.ignoreCodeValidation)&&a.ignoreCodeValidation===d.code||(d.hide=!b.isValid(d))}g()};h(),angular.isDefined(a.watchMultiple)?a.$parent.$watchCollection(a.watchModel,f):angular.isDefined(a.watchModel)&&a.$parent.$watch(a.watchModel,f)};if(e.mainClassCode||e.mainClassCodes){var g=b.queryForDropdown(e,function(b){b.forEach(function(a){var b={code:a.code,nameEt:a.nameEt,nameEn:a.nameEn,labelRu:a.labelRu,validFrom:a.validFrom,validThru:a.validThru};d[b.code]=b}),a.optionsByCode=d,f()});a.queryPromise=g.$promise}}angular.module("hitsaOis").directive("hoisClassifierSelect",["Classifier","ClassifierConnect","hoisValidDatesFilter",function(b,c,d){return{template:'<md-select ng-model-options="{ trackBy: !!modelValueAttr ? \'$value\' : \'$value.code\' }" ><md-option ng-if="!isHideEmpty && !isMultiple && ((!isRequired && !ngRequired) || isShowEmpty)" md-option-empty></md-option><md-option ng-repeat="(code, option) in optionsByCode" ng-value="!!modelValueAttr ? option[modelValueAttr] : option" ng-if="!option.hide || isSelected(option)" aria-label="{{getLabel(option)}}">{{getLabel(option)}}</md-option></md-select>',restrict:"E",require:["ngModel"],replace:!0,scope:{value:"=ngModel",required:"@",ngRequired:"=",multiple:"@",modelValueAttr:"@",mainClassifierCode:"@",mainClassifierCodes:"@",connectMainClassifierCode:"@",criteria:"=",filterValues:"@",ignorePreselected:"@",byProperty:"@",hideEmpty:"@",showEmpty:"@",showOnlyValues:"@",watchModel:"@",watchMultiple:"@",searchFromConnect:"@",selectFirstValue:"@",defaultValue:"@",onlyValid:"@",ignoreCodeValidation:"<"},link:function(e,f){e.isMultiple=angular.isDefined(e.multiple),e.isRequired=angular.isDefined(e.required),e.isHideEmpty=angular.isDefined(e.hideEmpty),e.isShowEmpty=angular.isDefined(e.showEmpty),f.attr("required",e.isRequired),e.isSelected=function(a){return angular.isUndefined(e.value)?!1:e.isMultiple?angular.isDefined(e.modelValueAttr)?angular.isArray(e.value)?e.value.filter(function(b){return b===a[e.modelValueAttr]}).length>0:!1:angular.isArray(e.value)?e.value.filter(function(b){return b.code===a.code}).length>0:!1:angular.isDefined(e.modelValueAttr)?e.value===a[e.modelValueAttr]:e.value.code===a.code},e.getLabel=angular.isDefined(e.onlyValid)?d:e.$root.currentLanguageNameField,a(e,b,c)}}}]).directive("hoisClassifierRadio",["Classifier","ClassifierConnect",function(b,c){return{template:'<md-radio-group ng-model-options="{ trackBy: !!modelValueAttr ? \'$value\' : \'$value.code\' }"><md-radio-button ng-repeat="(code, option) in optionsByCode" ng-value="!!modelValueAttr ? option[modelValueAttr] : option" ng-hide="option.hide" aria-label="{{$root.currentLanguageNameField(option)}}">{{$root.currentLanguageNameField(option)}}</md-radio-button></md-radio-group>',restrict:"E",require:["ngModel","^form"],replace:!0,scope:{value:"=ngModel",required:"@",disabled:"@",modelValueAttr:"@",mainClassifierCode:"@",watchModel:"@",connectMainClassifierCode:"@",searchFromConnect:"@",selectFirstValue:"@",defaultValue:"@"},link:function(d,e,f,g){d.isRequired=angular.isDefined(d.required),e.attr("required",d.isRequired),d.isDisabled=angular.isDefined(d.disabled),e.attr("disabled",d.isDisabled);var h=g[0],i=g[1],j=e[0].parentElement,k=j.querySelector("label");"MD-INPUT-CONTAINER"===j.tagName&&null!==j.querySelector("label")&&(e[0].style.marginTop="0.5em",j.style.marginTop="1em",j.style.marginBottom="0.5em",k.style.marginBottom="2em",d.isRequired&&k.classList.add("md-required"),h.$viewChangeListeners.push(function(){angular.isDefined(h.$viewValue)&&null!==h.$viewValue?(k.style.marginBottom="0",j.classList.add("md-input-has-value")):(j.classList.remove("md-input-has-value"),k.style.marginBottom="2em")}),d.form=i,d.$watch("form.$submitted",function(a){h.$valid||a===!1?j.classList.remove("md-input-invalid"):j.classList.add("md-input-invalid")})),a(d,b,c)}}}])}(),angular.module("hitsaOis").directive("hoisClassifierValue",["Classifier","ArrayUtils","hoisValidDatesFilter",function(a,b,c){return{template:'<div class="hois-classifier-value">{{value}}</div>',restrict:"E",replace:!0,scope:{ngModel:"=?",ngValue:"=?",mainClassifierCode:"@",mainClassifierCodes:"@",showDate:"@"},link:function(d,e){angular.isDefined(d.ngValue)&&(d.ngModel=d.ngValue),e[0].parentElement.classList.add("md-input-has-value");var f;d.getLabel=angular.isDefined(d.showDate)?c:d.$root.currentLanguageNameField,d.$watch("ngModel",function(c){var e=null;if(angular.isObject(c))if(angular.isString(c[d.$root.currentLanguageNameField()]))d.value=c[d.$root.currentLanguageNameField()];else if(angular.isArray(c)&&c.length>0)if(angular.isString(c[0]))e={codes:c};else{var g=c.map(function(a){return a.code});e={codes:g}}else e={code:c.code};else angular.isString(c)?e={code:c}:d.value=void 0;if(null!==e){var h=function(a){var c=a.filter(function(a){return e.code?a.code===e.code:e.codes?b.includes(e.codes,a.code):!1});if(c.length>0){var f=c.map(d.getLabel);d.value=f.join(", ")}};void 0===f?a.queryForDropdown({mainClassCode:d.mainClassifierCode,mainClassCodes:d.mainClassifierCodes},function(a){f=a,h(a)}):h(f)}})}}}]),angular.module("hitsaOis").directive("hoisCollapsable",function(){return{template:'<div class="hois-collapse-parent"><div layout="row" class="hois-collapse" ng-style="{background: headerBackgroundColor}"><div flex layout="row" layout-align="start center"><div class="hois-collapse-header" flex ng-transclude="header">{{label}}&nbsp;<a class="md-primary" style="font-size: 13px; font-weight: normal;" ng-click="action()" ng-if="ngif()">{{link}}</a></div></div><div flex="15" flex-sm="20" flex-xs="30"><md-button ng-click="expandCollapse()" class="hois-collapse-button"><md-icon ng-hide="hideCollapseButton" md-font-set="material-icons md-dark">{{expanded ? "keyboard_arrow_up" : "keyboard_arrow_down"}}</md-icon></md-button></div></div><div ng-show="expanded" ng-transclude></div></div>',replace:!0,transclude:{header:"?hoisCollapsableHeader"},scope:{label:"=",link:"=",action:"&",expandCollapseAction:"&",ngif:"&",expanded:"<",headerBackgroundColor:"<",hideCollapseButton:"@"},link:function(a){a.expanded=angular.isDefined(a.expanded)?a.expanded:!0,a.expandCollapse=function(){angular.isFunction(a.expandCollapseAction)&&a.expandCollapseAction(),a.expanded=!a.expanded}}}}),angular.module("hitsaOis").directive("copyToClipboard",["$window","message",function(a,b){return{restrict:"A",link:function(c,d,e){d.on("click",function(){var c=e.copyToClipboard,d=angular.element(a.document.body),f=angular.element("<textarea/>"),g=function(){f.val(c),d.append(f),f[0].select();var a=document.execCommand("copy");a&&b.info("main.copied"),f.remove()};g(c)})}}}]),angular.module("hitsaOis").directive("hoisDatepickerExtension",function(){return{restrict:"A",require:["^mdDatepicker"],link:{post:function(a,b,c,d){var e=d[0];if(e){var f={clear:function(){e.date instanceof Date&&!isNaN(e.date)||e.ngModelCtrl.$$setModelValue(void 0)}},g=void 0;c.$observe("hdController",function(b){g!==b&&b&&(g=b,angular.isDefined(a[b])&&angular.isArray(a[b])?a[b].push(f):a[b]=[f])})}}}}}),angular.module("hitsaOis").directive("fixedColumnTable",["$timeout","$window",function(a,b){return{restrict:"A",scope:{fixedColumns:"@",resizeTable:"@",maxTableHeight:"@",searchCriteriaHeight:"@"},link:function(c,d){function e(){var a=angular.isDefined(c.searchCriteriaHeight)?c.searchCriteriaHeight:0,e=0;e=c.maxTableHeight?c.maxTableHeight-a:b.innerHeight-a;var f=h.querySelectorAll("table"),g=f[0].offsetHeight,i=g>0&&e>g?g:e;i+=17,d.css("height",i+"px")}function f(a,b,d){var e,f,g,i=[].concat.apply([],h.querySelectorAll(a));i.forEach(function(a){g=angular.element(a);for(var h=c.fixedColumns,i=0;h>i;i++)e=angular.element(a).find(d)[i],void 0!==e&&(!g.hasClass("fix")||g.hasClass("fix")&&e.classList.contains("fix"))&&(e.classList.add(b),e.hasAttribute("colspan")&&(f=e.getAttribute("colspan"),h-=parseInt(f)-1))})}function g(){function a(){var a=h.scrollLeft,c=h.scrollTop,d=[].concat.apply([],h.querySelectorAll("tbody td.fixed-cell")),e=[].concat.apply([],h.querySelectorAll("thead th.cross")),f=[].concat.apply([],h.querySelectorAll("thead th"));d.forEach(function(c){c.style.transform=b(a,0)}),f.forEach(function(a){a.style.transform=b(0,c)}),e.forEach(function(d){d.style.transform=b(a,c)})}function b(a,b){return"translate("+a+"px, "+b+"px)"}f("thead tr","cross","th"),f("tbody tr","fixed-cell","td"),a(),h.addEventListener("scroll",function(){a()})}var h=d[0];if(angular.isDefined(c.resizeTable)){var i=new MutationObserver(function(){e()});i.observe(h,{childList:!0,subtree:!0});var j;angular.element(b).on("resize",function(){clearTimeout(j),j=setTimeout(e,500)})}a(function(){g()},0),c.$on("refreshFixedColumns",function(){a(function(){g(),h.scrollLeft=0},0)}),c.$on("refreshFixedTableHeight",function(){a(function(){e()},0)})}}}]),angular.module("hitsaOis").directive("hoisFreeForms",function(){return{template:'<span class="middle-text label"><span ng-if="value && value.length > 0">{{value.join(", ")}}</span><span class="invalid" ng-if="!(value && value.length > 0)">{{"document.noFreeForms" | translate}}</span></span>',restrict:"E",replace:!0,scope:{value:"="}}}),angular.module("hitsaOis").directive("hoisIdcodeLookup",["$q","QueryUtils","message",function(a,b,c){return{template:'<input type="text" ng-blur="lookupPerson()" ng-minlength="11" md-maxlength="11">',restrict:"E",replace:!0,require:"ngModel",scope:{afterFailedLookup:"&",afterLookup:"&",noLookup:"&",ngModel:"=",ngReadonly:"=",role:"@"},link:function(d,e,f,g){function h(){g.$setValidity("estonianIdcode",!0)}function i(){g.$setValidity("estonianIdcode",!1),c.error("main.messages.error.estonianIdcode")}d.lookupPerson=function(){var c=d.ngModel;!d.ngReadonly&&c&&c!==d.idcode?11===c.length?b.endpoint("/autocomplete/persons",{search:{method:"GET"}}).search({idcode:c,role:d.role}).$promise.then(function(a){h(),d.idcode=c,d.afterLookup({response:a})})["catch"](function(b){return 404===b.status&&(h(),d.idcode=void 0),412===b.status&&(i(),d.idcode=void 0),angular.isDefined(d.afterFailedLookup)&&d.afterFailedLookup({response:b}),a.reject(b)}):i():angular.isDefined(d.noLookup)&&d.noLookup()}}}}]),angular.module("hitsaOis").directive("oisInputFile",function(){return{template:'<input type="file" />',restrict:"E",require:["ngModel"],replace:!0,scope:{},link:function(a,b,c,d){var e=d[0];b.bind("change",function(){var a=b[0].files[0],c=new FileReader;c.addEventListener("load",function(){var b="base64,";a.data=c.result.substring(c.result.indexOf(b)+b.length),e.$setViewValue(a)},!1),c.readAsDataURL(a)})}}}),angular.module("hitsaOis").directive("oisMultiText",function(){return{template:'<div layout="column"><div layout="row" flex><div layout="row" flex><input type="text" ng-model="itemValue"></div><div layout="row"><a href="" ng-click="add()"><md-icon md-font-set="material-icons">playlist_add</md-icon></a></div></div><div layout="column"><div layout="row" ng-repeat="item in items" flex><div layout="row" layout-align="start center" flex>{{item}}</div><div layout="row"><md-button style="left:10px;" class="md-icon-button" ng-click="remove(item)"><md-icon ng-class="\'md-warn md-hue-2\'" md-font-set="material-icons">close</md-icon></md-button></div></div></div></div>',restrict:"E",require:["ngModel"],replace:!0,scope:{},link:function(a,b,c,d){a.items=[],a.$parent.$watch(c.initialValues,function(b){angular.isArray(b)&&(a.items=b)}),a.add=function(){a.itemValue&&-1===a.items.indexOf(a.itemValue)&&(a.items.push(a.itemValue),a.itemValue="",d[0].$setViewValue(a.items),d[0].$render())},a.remove=function(b){a.items.splice(a.items.indexOf(b),1),d[0].$setViewValue(a.items),d[0].$render()}}}}),angular.module("hitsaOis").directive("hoisNavbarOverflowed",function(){return{restrict:"A",require:["^mdNavBar"],link:{post:function(a,b,c,d){var e=d[0];e&&(e._moveFocus=function(a,b){a&&a.setFocused(!1),b.setFocused(!0)},e._updateTabs=function(a,b){var c=this,d=this._getTabs(),e=a===b;if(d){var f=-1,g=-1,h=this._getTabByName(a),i=this._getTabByName(b);i&&(i.setSelected(!1),f=d.indexOf(i)),h&&(h.setSelected(!0),g=d.indexOf(h)),this._$timeout(function(){c._updateInkBarStyles(h,g,f),h&&!e&&c._moveFocus(i,h)})}},"MD-CONTENT"===e._navBarEl.parentNode.nodeName&&e._$timeout(function(){var a=e._getSelectedTab();a&&(e._navBarEl.parentNode.scrollLeft=a._$element[0].offsetLeft)},200),e._$timeout(function(){e._getTabs().forEach(function(a){angular.element(a.getButtonEl()).off("blur")})},300))}}}}),angular.module("hitsaOis").filter("hoisNumber",["$filter",function(a){return function(b,c){var d=b%1?a("number")(b,c):a("number")(b,0);return d.split(",").join("")}}]),angular.module("hitsaOis").directive("hoisSchoolDepartmentSelect",["QueryUtils",function(a){return{template:'<md-select><md-option ng-if="!isMultiple && !isRequired && !ngRequired" md-option-empty></md-option><md-option ng-repeat="option in options" ng-value="option.id"aria-label="{{$root.currentLanguageNameField(option)}}">{{$root.currentLanguageNameField(option)}}</md-option></md-select>',restrict:"E",replace:!0,scope:{excludedId:"@",multiple:"@",ngRequired:"=",required:"@",value:"=ngModel"},link:function(b,c){b.isMultiple=angular.isDefined(b.multiple),b.isRequired=angular.isDefined(b.required),c.attr("required",b.isRequired);var d=function(){b.excludedIdValue?b.options=b.optionValues.filter(function(a){return a.id!==b.excludedIdValue}):b.options=b.optionValues};a.endpoint("/autocomplete/schooldepartments").query(function(a){b.optionValues=a.sort(function(a,b){var c=a.nameEt,d=b.nameEt;return d>c?-1:c>d?1:0}),d()}),angular.isDefined(b.excludedId)&&b.$parent.$watch(b.excludedId,function(a){b.excludedIdValue=a,void 0!==b.optionValues&&d()})}}}]),angular.module("hitsaOis").directive("hoisSelect",["$rootScope","Curriculum","School","QueryUtils","DataUtils",function(a,b,c,d,e){return{templateUrl:"components/hois.select.html",restrict:"E",replace:!0,scope:{ngModel:"=",criteria:"=",filterValues:"@",multiple:"@",ngRequired:"=",required:"@",values:"@",valueProperty:"@",orderByProperty:"@",showProperty:"@",preselectCurrent:"@",selectCurrentStudyYear:"@",loadAfterDefer:"=",warningParam:"@",sortedQuery:"=",hideValues:"&?"},link:function(f,g,h){function i(){f.filteredOptions=(f.options||[]).filter(function(a){return!(-1!==f.hideOptions.indexOf(a[f.valueProperty])||f.hideValues&&angular.isFunction(f.hideValues())&&f.hideValues()(a)&&a[f.valueProperty]!==f.ngModel)})}function j(a){f.options=a.content,i()}function k(){if(!f.ngModel){var a=e.getCurrentStudyYearOrPeriod(f.options);a&&(f.ngModel=a.id)}}function l(){angular.isDefined(f.selectCurrentStudyYear)&&k()}function m(){f.options.forEach(function(a){a.display=f.$root.currentLanguageNameField(a.studyYear)+" "+f.$root.currentLanguageNameField(a)}),angular.isDefined(f.preselectCurrent)&&k()}function n(){if(angular.isDefined(h.type)){var a;switch(h.type){case"school":f.options=c.getAll();break;case"curriculumversion":f.options=b.queryVersions(f.criteria);break;case"studyyear":f.options=d.endpoint("/autocomplete/studyYears").query({},l);break;case"building":a=a||"/autocomplete/buildings";case"curriculum":a=a||"/autocomplete/curriculumsauto";case"directivecoordinator":a=a||"/autocomplete/directivecoordinators";case"journal":a=a||"/autocomplete/journals";case"studentgroup":a=a||"/autocomplete/studentgroups";case"teacher":a=a||"/autocomplete/teachersList";case"enterpriseLocations":a=a||"/autocomplete/enterpriseLocations";case"supervisors":a=a||"/autocomplete/supervisors";case"contacts":a=a||"/autocomplete/contacts";case"practiceEvaluation":a=a||"/autocomplete/practiceEvaluation";case"subject":a=a||"/autocomplete/subjectsList";case"committee":a=a||"/autocomplete/committeesList",f.options=d.endpoint(a).query(f.criteria);break;case"enterprise":a=a||"/autocomplete/enterprises";case"saisadmissioncode":a=a||"/autocomplete/saisAdmissionCodes";case"saisCurriculumClassifiers":a=a||"/autocomplete/saisCurriculumClassifiers";case"saisadmissioncodearchived":a=a||"/autocomplete/saisAdmissionCodesArchived";case"apelschool":a=a||"/autocomplete/apelschools";case"studyperiod":a=a||"/autocomplete/studyPeriods",f.options=d.endpoint(a).query();break;case"studyperiodyear":f.showProperty||(f.showProperty="display"),f.options=d.endpoint("/autocomplete/studyPeriodsWithYear").query(m)}angular.isDefined(f.options)&&angular.isDefined(f.options.$promise)&&(f.queryPromise=f.options.$promise,f.options.$promise.then(i))}else angular.isDefined(f.values)&&f.$parent.$watchCollection(f.values,function(a){j({content:a})})}f.isMultiple=angular.isDefined(f.multiple),f.isRequired=angular.isDefined(f.required),f.valueProperty=angular.isString(f.valueProperty)?f.valueProperty:"id",g.attr("required",f.isRequired),f.options=[],f.filteredOptions=[],f.hideOptions=[],f.orderBy=f.sortedQuery?f.orderByProperty:f.showProperty?f.showProperty:a.currentLanguageNameField(),angular.isDefined(f.filterValues)&&f.$parent.$watchCollection(f.filterValues,function(a){f.hideOptions=[],angular.isArray(a)&&a.forEach(function(a){var b=angular.isObject(a)?a[f.valueProperty]:a;angular.isDefined(b)&&f.hideOptions.push(b)}),i()}),angular.isDefined(f.loadAfterDefer)?f.loadAfterDefer.promise.then(n):n()}}}]),angular.module("hitsaOis").directive("hoisValue",function(){return{template:'<div class="md-body-1 hois-value"><a ng-if="hrefValue" ng-href="{{hrefValue}}">{{value}}</a><span ng-if="!hrefValue"><div ng-if="value.split" ng-repeat="row in value.split(\'\n\') track by $index">{{row.length > 0 ? row : \'&nbsp;\'}}</div><div ng-if="!value.split">{{value}}</div></span></div>',restrict:"E",replace:!0,scope:{value:"=",hrefValue:"="},link:function(a,b){b[0].parentElement.classList.add("md-input-has-value")}}}),angular.module("hitsaOis").directive("hoisTime",function(){return{template:'<input style="min-width:3em;" class="md-input" type="text">',restrict:"E",require:"ngModel",replace:!0,scope:{ngModel:"="},link:{post:function(a,b,c,d){function e(a){var b=moment(a,angular.isDate(a)?null:h,!0),c=b.format(h);f(b.isValid()?c:a)}function f(a){b.val(a)}function g(b){var c=b.target.value,e=moment(c,h,!0);if(e.isValid())if(a.ngModel){var f=moment(a.ngModel,"string"==typeof a.ngModel&&5===a.ngModel.length?h:void 0);f.hours(e.hours()),f.minutes(e.minutes()),a.ngModel=f.toDate()}else a.ngModel=e.toDate();d.$setValidity("time",c?e.isValid():!0)}var h="HH:mm";a.$watch("ngModel",function(){e(a.ngModel)}),b.unbind("input").unbind("keydown").unbind("change"),b.bind("blur",function(b){a.$apply(function(){g(b)})})}}}}),angular.module("hitsaOis").filter("hoisUrl",function(){var a=/^((http|https|ftp):\/\/)/;return function(b){return a.test(b)?b:"http://"+b}}),angular.module("hitsaOis").filter("hoisDate",["$filter",function(a){return function(b){return a("date")(b,"dd.MM.yyyy")}}]).filter("hoisDateTime",["$filter",function(a){return function(b){return a("date")(b,"dd.MM.yyyy HH:mm:ss")}}]).filter("hoisDateTimeMin",["$filter",function(a){return function(b){return a("date")(b,"dd.MM.yyyy HH:mm")}}]).filter("hoisTime",["$filter",function(a){return function(b){return a("date")(b,"HH:mm:ss")}}]).filter("hoisDayMonth",["$filter",function(a){return function(b){return a("date")(b,"dd.MM")}}]).filter("hoisDayMonthTimeMin",["$filter",function(a){return function(b){return a("date")(b,"dd.MM HH:mm")}}]).filter("hoisTimestamp",["$filter",function(a){return function(b){var c=a("date"),d=c(b,"dd.MM.yyyy HH:mm");return void 0!==d&&null!==d&&-1===d.lastIndexOf("00:00")?d:c(b,"dd.MM.yyyy")}}]).filter("hoisTimeMin",["$filter",function(a){return function(b){return a("date")(b,"HH:mm")}}]).filter("hoisYear",["$filter",function(a){return function(b){return a("date")(b,"yyyy")}}]),angular.module("hitsaOis").filter("hoisValidDates",["$rootScope","hoisDateFilter",function(a,b){return function(c){function d(a){return a?b(a):"..."}var e=a.currentLanguageNameField(c);if(!c)return e;var f=c.validFrom,g=c.validThru;return f||g?e+" ("+d(f)+" - "+d(g)+")":e}}]),angular.module("hitsaOis").filter("hoisStudyPeriod",["$rootScope",function(a){return function(b){var c="";return angular.isObject(b)?(c=a.currentLanguageNameField(b),angular.isObject(b.studyYear)?a.currentLanguageNameField(b.studyYear)+" "+c:c):c}}]),angular.module("hitsaOis").filter("hoisLimitTo",["$filter",function(a){return function(b,c,d){return angular.isDefined(d)?b&&b.length>c&&d?a("limitTo")(b,c)+"...":b:b&&b.length>c?a("limitTo")(b,c)+"...":b}}]),angular.module("hitsaOis").directive("mdMaxlength",function(){return{restrict:"A",require:["ngModel","^mdInputContainer"],link:{post:function(a,b,c){var d=c.$set;c.$set=function(a,b,e,f){"ngTrim"!==a&&d.call(c,a,b,e,f)}}}}}),angular.module("hitsaOis").controller("ContractEditController",["$location","$scope","$route","dialogService","message","Classifier","DataUtils","QueryUtils","$q","ArrayUtils","config",function(a,b,c,d,e,f,g,h,i,j,k){
function l(a){b.formState.isHigher=a.isHigher,g.convertObjectToIdentifier(a,["contractCoordinator","practiceEvaluation","studentPracticeEvaluation"]),a.moduleSubjects.forEach(function(a){g.convertObjectToIdentifier(a,["module","theme","subject"])}),b.contract=a;var c=f.valuemapper({status:"LEPING_STAATUS"});i.all(c.promises).then(function(){b.contract&&c.objectmapper(b.contract)})}function m(a){h.endpoint("/contracts/studentPracticeModules/"+a.id).query(function(a){b.formState.modulesById={},b.formState.themesById={},b.formState.themesByModuleId={},a.forEach(function(a){b.formState.modulesById[a.module.id]=a,a.themes.forEach(function(a){b.formState.themesById[a.theme.id]=a}),b.formState.themesByModuleId[a.module.id]=a.themes.map(function(a){return a.theme})}),b.formState.modules=a.map(function(a){return a.module}),n()})}function n(){for(var a=b.formState.modules.map(function(a){return a.id}),c=b.contract.moduleSubjects.length-1;c>=0;c--)b.contract.moduleSubjects[c].module&&-1===a.indexOf(b.contract.moduleSubjects[c].module)&&j.remove(b.contract.moduleSubjects,b.contract.moduleSubjects[c])}function o(a){h.endpoint("/contracts/studentPracticeSubjects/"+a.id).query(function(a){b.formState.subjectsById={},a.forEach(function(a){b.formState.subjectsById[a.id]=a}),b.formState.subjects=a,p()})}function p(){for(var a=b.formState.subjects.map(function(a){return a.id}),c=b.contract.moduleSubjects.length-1;c>=0;c--)b.contract.moduleSubjects[c].subject&&-1===a.indexOf(b.contract.moduleSubjects[c].subject)&&j.remove(b.contract.moduleSubjects,b.contract.moduleSubjects[c])}function q(a){a.module&&!a.theme&&(a.credits=b.formState.modulesById[a.module].credits,a.hours=g.creditsToHours(a.credits))}function r(a,b){var c=a.manually?a.supervisorFirstname+" "+a.supervisorLastname:a.supervisorName,d=b.manually?b.supervisorFirstname+" "+b.supervisorLastname:b.supervisorName;return c===d}function s(){return b.contractForm.$setSubmitted(),b.contractForm.$valid?0===b.contract.moduleSubjects.length?(e.error(b.formState.isHigher?"contract.messages.atleastOneSubjectRequired":"contract.messages.atleastOneModuleRequired"),!1):!0:(e.error("main.messages.form-has-errors"),!1)}b.auth=c.current.locals.auth,b.contract={moduleSubjects:[{}]},b.formState={},c.current.params.studentGroupId&&(b.studentGroup=c.current.params.studentGroupId,b.studentGroupList=[],b.studentGroupList.push(b.studentGroup),h.endpoint("/autocomplete/studentgroups").query({id:b.studentGroup},function(a){b.studentGroup=a[0]})),b.addAllStudents=function(){h.endpoint("/autocomplete/students").search({active:!0,studentGroup:b.studentGroupList},function(a){void 0===b.contract&&(b.contract={}),b.contract.students=a.content,b.formState.isHigher?o(b.contract.students[0]):m(b.contract.students[0])})},b.addStudent=function(){return angular.isArray(b.contract.students)||(b.contract.students=[]),b.contract.students.some(function(a){return a.id===b.contract.student.id})?(b.contract.student=void 0,void e.error("timetable.timetableEvent.error.duplicateStudentGroup")):(b.contract.students.push(b.contract.student),void(b.contract.student=void 0))},b.deleteStudent=function(a){var c=b.contract.students.indexOf(a);-1!==c&&(b.contract.students.splice(c,1),b.contractForm.$setDirty())},c.current.params.studentId&&h.endpoint("/autocomplete/students?id="+c.current.params.studentId).get({},function(a){a&&1===a.totalElements&&(b.contract.student=a.content[0])});var t=function(a){if(angular.isString(a))if(void 0===b.contract.practicePlan||null===b.contract.practicePlan)b.contract.practicePlan=a;else if((b.contract.practicePlan+"\n"+a).length<=2e4)b.contract.practicePlan+="\n"+a;else{var c=2e4-(b.contract.practicePlan.length+2);c>0&&(b.contract.practicePlan+="\n"+a.substring(0,c))}},u=c.current.locals.entity;if(angular.isDefined(u)&&u.$promise.then(function(a){a.canEdit===!1&&(e.error("main.messages.error.nopermission"),b.back("#/"))}),angular.isDefined(u))l(u);else{if(c.current.params.practiceApplication){var v=parseInt(c.current.params.practiceApplication,10);h.endpoint("/practiceApplication/contractData/"+v).get(function(a){b.formState.isHigher=a.isHigher,b.contract.student=a.student,b.contract.enterprise=a.enterprise,b.contract.contactPersonName=a.contactPersonName,b.contract.contactPersonPhone=a.contactPersonPhone,b.contract.contactPersonEmail=a.contactPersonEmail,b.contract.supervisorName=a.supervisorName,b.contract.supervisorPhone=a.supervisorPhone,b.contract.supervisorEmail=a.supervisorEmail,b.contract.practiceApplication=v})}else b.formState.isHigher=b.auth.school.higher===!0&&(b.auth.school.vocational===!0&&c.current.params.higher===!0||b.auth.school.vocational===!1);b.contract.isPracticeSchool=!0}var w=f.valuemapper({studyForm:"OPPEVORM"});b.$watch("contract.student",function(a){angular.isDefined(b.contract)&&angular.isDefined(b.contract.student)&&null!==b.contract.student&&b.studentGroup&&b.addStudent(),angular.isObject(a)&&(h.endpoint("/students/"+a.id).search(function(a){b.formState.student=w.objectmapper(a)}),b.formState.isHigher?o(a):m(a))}),b.$watch("contract.enterprise",function(a){angular.isObject(a)&&(h.endpoint("/practiceEnterprise/enterpriseContacts/"+a.id).query(function(a){b.formState.contactsByName={},a.forEach(function(a){b.formState.contactsByName[a.contactPersonName]=a}),b.formState.contacts=a,void 0===b.contract.contactPersonName&&(b.formState.contacts.length>=1?(b.contract.contactPersonName=b.formState.contacts[0].contactPersonName,b.contract.contactPersonEmail=b.formState.contacts[0].contactPersonEmail,b.contract.contactPersonPhone=b.formState.contacts[0].contactPersonPhone):void 0===b.contract.contactPersonName||null===b.contract.contactPersonName||b.formState.contactsByName[b.contract.contactPersonName]||(b.contract.contactPersonEmail=void 0,b.contract.contactPersonPhone=void 0,b.contract.contactPersonName=void 0))}),h.endpoint("/autocomplete/supervisors").query({id:a.id}).$promise.then(function(a){b.supervisors=a,1!==a.length||void 0!==b.contract.supervisors&&0!==b.contract.supervisors.length||(b.contract.supervisor=a[0])}))}),b.$watch("contract.enterprise",function(a){a&&h.endpoint("/autocomplete/enterpriseLocations").query({id:b.contract.enterprise.id}).$promise.then(function(a){b.formState.enterpriseLocations=a,1===a.length&&null===b.contract.practicePlace&&(b.contract.practicePlace=a[0].nameEt)})}),b.contactChanged=function(a){b.formState.contactsByName[a]&&(b.contract.contactPersonEmail=b.formState.contactsByName[a].contactPersonEmail,b.contract.contactPersonPhone=b.formState.contactsByName[a].contactPersonPhone)},b.addModuleSubject=function(){b.contract.moduleSubjects.push({})},b.removeModuleSubject=function(a){j.remove(b.contract.moduleSubjects,a)},b.getAstronomicalHours=g.getAstronomicalHours,b.moduleChanged=function(a,c){var d=b.formState.modulesById[a];if(d){var e=d.themes.map(function(a){return a.theme.id});-1===e.indexOf(c.theme)&&(c.theme=null),q(c),angular.isString(d.assessmentMethodsEt)&&t(d.assessmentMethodsEt)}},b.themeChanged=function(a,c){b.formState.themesById[a]?(c.credits=b.formState.themesById[a].credits,c.hours=g.creditsToHours(c.credits),angular.isString(b.formState.themesById[a].subthemes)&&t(b.formState.themesById[a].subthemes)):q(c)},b.$watch("contract.supervisor",function(a){angular.isDefined(b.contract)&&angular.isDefined(a)&&null!==a&&(b.addSupervisor(a),b.contract.supervisor=void 0)}),b.addSupervisor=function(a){return angular.isArray(b.contract.supervisors)||(b.contract.supervisors=[]),b.contract.supervisors.some(function(b){return r(b,a)})?void e.error("timetable.timetableEvent.error.duplicateSupervisor"):void b.contract.supervisors.push(a)},b.addEmptySupervisor=function(){b.addSupervisor({manually:!0})},b.deleteSupervisor=function(a){var c=b.contract.supervisors.indexOf(a);-1!==c&&(b.contract.supervisors.splice(c,1),b.contractForm.$setDirty())},b.subjectChanged=function(a,c){b.formState.subjectsById[a]&&(c.credits=b.formState.subjectsById[a].credits,c.hours=g.creditsToHours(c.credits),angular.isString(b.formState.subjectsById[a].outcomesEt)&&t(b.formState.subjectsById[a].outcomesEt))},b.updateHours=function(a,c){angular.isNumber(a.credits)&&(a.hours=g.creditsToHours(a.credits),b.contractForm["hours["+c+"]"].$setDirty())},b.updateCredits=function(a,c){a.credits=g.hoursToCredits(a.hours),b.contractForm["credits["+c+"]"].$setDirty()},b.isPracticeAbsenceChanged=function(){b.contract.isPracticeHidden=!1},b.isPracticeHiddenChanged=function(){b.contract.isPracticeAbsence=!1};var x=h.endpoint("/contracts");b.save=function(c){if(!s())return!1;b.contract.isHigher=b.formState.isHigher;var d=new x(b.contract);angular.isDefined(b.contract.id)?d.$update().then(function(){e.updateSuccess(),l(d),angular.isFunction(c)&&c(),b.contractForm.$setPristine()})["catch"](angular.noop):d.$save().then(function(){e.info("main.messages.create.success"),b.studentGroup?a.url("/practice/studentgroup/contracts/"+b.studentGroup.id+"?_noback"):a.url("/contracts/"+d.id+"/edit?_noback")})["catch"](angular.noop)},b["delete"]=function(){d.confirmDialog({prompt:"contract.deleteconfirm"},function(){var a=new x(b.contract);a.$delete().then(function(){e.info("main.messages.delete.success"),b.back("/#/contracts")})["catch"](angular.noop)})},b.sendToEkis=function(){return s()?void h.endpoint("/contracts/checkForEkis").get({id:b.contract.id}).$promise.then(function(c){d.confirmDialog({prompt:c.templateExists?"contract.ekisconfirm":"contract.ekisconfirmTemplateMissing",template:c.templateName},function(){b.save(function(){var c=h.endpoint("/contracts/sendToEkis/"+b.contract.id);(new c).$save().then(function(b){e.info("contract.messages.sendToEkis.success"),a.url("/contracts/"+b.id+"/view?_noback")})["catch"](angular.noop)})})}):!1},b.confirmWithoutEkis=function(){return s()?void h.endpoint("/contracts/checkForEkis").get({id:b.contract.id}).$promise.then(function(c){d.confirmDialog({prompt:c.templateExists?"contract.withoutEkisConfirm":"contract.confirmTemplateMissing",template:c.templateName},function(){b.save(function(){var c=h.endpoint("/contracts/checkout/"+b.contract.id);(new c).$save().then(function(b){a.url("/contracts/"+b.id+"/view?_noback"),e.info("contract.messages.contractReadyForConfirmation")})["catch"](angular.noop)})})}):!1},b.printUrl=function(){return k.apiUrl+"/contracts/print/"+b.contract.id+"/contract.rtf?lang="+b.currentLanguage().toUpperCase()},b.copyContract=function(){d.showDialog("contract/contract.select.dialog.html",function(a){var c=f.valuemapper({status:"LEPING_STAATUS"});h.createQueryForm(a,"/contracts/all",{order:"student_person.lastname,student_person.firstname"},c.objectmapper),a.setStudentGroup=function(b){a.criteria.studentGroup=b.id},a.setStudent=function(b){a.criteria.student=b.id},a.deselect=function(b){a.tabledata.content.forEach(function(a){a.id!==b.id&&(a.checked=!1)})},a.$watch("student",function(b){angular.isDefined(a.student)&&angular.isDefined(b)&&null!==b?a.setStudent(b):a.criteria.student=void 0}),a.$watch("studentGroup",function(b){angular.isDefined(a.studentGroup)&&angular.isDefined(b)&&null!==b?a.setStudentGroup(b):a.criteria.studentGroup=void 0}),angular.isDefined(b.contract.student)?(a.student=b.contract.student,a.setStudent(b.contract.student)):angular.isDefined(b.formState.student)&&(a.student=b.formState.student,a.setStudent(b.formState.student)),angular.isDefined(b.studentGroup)?(a.studentGroup=b.studentGroup,a.setStudentGroup(b.studentGroup)):angular.isDefined(b.formState.student)&&(a.studentGroup=b.formState.student.studentGroup,a.setStudentGroup(b.formState.student.studentGroup)),a.checkChecked=function(){return a.checked=a.tabledata.content.filter(function(a){return a.checked}),0===a.checked.length?(e.error("contract.atleastOne"),!1):void a.submit()},i.all(c.promises).then(a.loadData())},function(a){var c=a.checked[0];h.endpoint("/contracts").get({id:c.id}).$promise.then(function(a){a.students=b.contract.students,a.practiceApplication=b.contract.practiceApplication,a.student=b.contract.student,a.isHigher?o(a.student):m(a.student),a.id=b.contract.id,a.status=b.contract.status,a.version=b.contract.version,a.subject=b.contract.subject,void 0!==b.contract.practiceApplication&&null!==b.contract.practiceApplication&&(a.enterprise=b.contract.enterprise,a.contactPersonName=b.contract.contactPersonName,a.contactPersonEmail=b.contract.contactPersonEmail,a.contactPersonPhone=b.contract.contactPersonPhone,a.supervisors=b.contract.supervisors,a.isPracticeSchool=b.contract.isPracticeSchool,a.isPracticeTelework=b.contract.isPracticeTelework,a.isPracticeOther=b.contract.isPracticeOther,a.practicePlace=b.contract.practicePlace,a.isPracticeEnterprise=b.contract.isPracticeEnterprise),a.moduleSubjects.forEach(function(a){a.id=void 0,g.convertObjectToIdentifier(a,["module","theme","subject"])}),b.formState.isHigher=a.isHigher,g.convertObjectToIdentifier(a,["contractCoordinator","practiceEvaluation","studentPracticeEvaluation"]),b.contract=a})})}}]),angular.module("hitsaOis").controller("ContractViewController",["$scope","$location","$route","QueryUtils","dialogService","ekisService","message","FormUtils","DataUtils","Classifier","$q","$window","config",function(a,b,c,d,e,f,g,h,i,j,k,l,m){function n(b){i.convertObjectToIdentifier(b,["module","theme","subject"]),a.contract=b,a.contract.canceled=new Date,a.formState.isHigher=b.isHigher}a.auth=c.current.locals.auth,a.getEkisContractUrl=f.getContractUrl,a.formState={};var o=c.current.locals.entity;angular.isDefined(o)&&n(o);var p=j.valuemapper({status:"LEPING_STAATUS"});k.all(p.promises).then(function(){a.contract&&p.objectmapper(a.contract)}),a.getAstronomicalHours=i.getAstronomicalHours,a.showCancel=function(){void 0===a.showCancelBoolean||a.showCancelBoolean===!1?a.showCancelBoolean=!0:a.showCancelBoolean===!0&&(a.showCancelBoolean=!1)},a.openInNewTab=function(a){d.endpoint("/practiceJournals/supervisor").get({id:a}).$promise.then(function(){l.open("#/practiceJournals/supervisor/"+a,"_blank")})["catch"](angular.noop)},a.sendEmailAgain=function(a,b){d.endpoint("/practiceJournals/supervisor").get({id:b}).$promise.then(function(){var b=d.endpoint("/contracts/sendEmail"),c=new b({id:a});c.$update().then(function(){g.info("contract.emailSent")})["catch"](angular.noop)})["catch"](angular.noop)},a["delete"]=function(){e.confirmDialog({prompt:"contract.deleteconfirm"},function(){var b=d.endpoint("/contracts"),c=new b(a.contract);c.$delete().then(function(){g.info("main.messages.delete.success"),a.back("/#/contracts")})})},a.disableSave=function(){a.disablesave=!0};var q=d.endpoint("/contracts/cancel");a.save=function(b){h.withValidForm(a.contractForm,function(){var d=new q(a.contract);angular.isDefined(a.contract.id)&&d.$update().then(function(d){g.updateSuccess(),n(d),angular.isFunction(b)&&b(),a.contractForm.$setPristine(),c.reload()})["catch"](angular.noop)})},a.changeContractNr=function(){h.withValidForm(a.contractForm,function(){var b=d.endpoint("/contracts/changeContractNr/"+a.contract.id),c=new b({contractNr:a.contract.contractNr});c.$update().then(function(b){b.cancelReason=a.contract.cancelReason,b.cancelDesc=a.contract.cancelDesc,b.canceled=a.contract.canceled,g.updateSuccess(),a.disablesave=!1,n(b),p.objectmapper(a.contract)})})},a.printUrl=function(){return m.apiUrl+"/contracts/print/"+a.contract.id+"/contract.rtf?lang="+a.currentLanguage().toUpperCase()},a.confirm=function(){h.withValidForm(a.contractForm,function(){e.confirmDialog({prompt:"contract.withoutEkisConfirm"},function(){var b=d.endpoint("/contracts/confirm/"+a.contract.id);(new b).$save().then(function(b){n(b),p.objectmapper(a.contract),g.info("contract.messages.confirmed")})["catch"](angular.noop)})})}}]),angular.module("hitsaOis").controller("ContractListController",["$scope","$route","QueryUtils","Classifier","$q","dialogService","$location",function(a,b,c,d,e,f,g){a.auth=b.current.locals.auth;var h=d.valuemapper({status:"LEPING_STAATUS"});c.createQueryForm(a,"/contracts",{order:"student_person.lastname,student_person.firstname"},h.objectmapper),a.formState={},a.auth.isStudent()&&(a.afterLoadData=function(b){a.tabledata.content=b.content,a.tabledata.totalElements=b.totalElements,h.objectmapper(b.content)}),a.loadAndSave=function(){a.loadData(),a.formState.studentGroup=a.criteria.studentGroup,a.formState.studentName=a.criteria.studentName},a.sendToEkis=function(){g.path("/practice/studentgroup/ekis").search({_menu:!0,studentGroup:a.formState.studentGroup,studentName:a.formState.studentName})},a.directiveControllers=[];var i=a.clearCriteria;a.clearCriteria=function(){i(),a.directiveControllers.forEach(function(a){a.clear()})},e.all(h.promises).then(a.loadAndSave()),a.newContract=function(){a.auth.school.higher&&a.auth.school.vocational?f.showDialog("contract/vocational.higher.select.dialog.html",function(){},function(a){a.higher===!0?g.path("/contracts/new").search({higher:!0}):g.path("/contracts/new")}):g.path("/contracts/new")}}]),angular.module("hitsaOis").config(["$routeProvider","USER_ROLES",function(a,b){function c(a,c){return-1!==c.indexOf(b.ROLE_OIGUS_V_TEEMAOIGUS_LEPING)||"ROLL_L"===a.roleCode||"ROLL_O"===a.roleCode}a.when("/contracts",{templateUrl:"contract/contract.list.html",controller:"ContractListController",controllerAs:"contractListController",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_LEPING]}}).when("/contracts/new",{templateUrl:"contract/contract.edit.html",controller:"ContractEditController",controllerAs:"contractEditController",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],isCreate:function(){return!0}},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_LEPING]}}).when("/contracts/:studentId/new",{templateUrl:"contract/contract.edit.html",controller:"ContractEditController",controllerAs:"contractEditController",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],isCreate:function(){return!0}},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_LEPING]}}).when("/contracts/new/:studentGroupId",{templateUrl:"contract/contract.edit.html",controller:"ContractEditController",controllerAs:"contractEditController",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],isCreate:function(){return!0}},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_LEPING]}}).when("/contracts/:id/edit",{templateUrl:"contract/contract.edit.html",controller:"ContractEditController",controllerAs:"contractEditController",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],entity:["QueryUtils","$route",function(a,b){return a.endpoint("/contracts").get({id:b.current.params.id}).$promise}]},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_LEPING]}}).when("/contracts/:id/view",{templateUrl:"contract/contract.view.html",controller:"ContractViewController",controllerAs:"contractViewController",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],entity:["QueryUtils","$route",function(a,b){return a.endpoint("/contracts").get({id:b.current.params.id}).$promise}]},data:{authorizedRoles:c}})}]),angular.module("hitsaOis").factory("Curriculum",["$resource","config","QueryUtils",function(a,b,c){function d(){}return d.STATUS={ENTERING:"OPPEKAVA_STAATUS_S",PROCEEDING:"OPPEKAVA_STAATUS_M",VERIFIED:"OPPEKAVA_STAATUS_K",CLOSED:"OPPEKAVA_STAATUS_C"},d.VERSION_STATUS={S:"OPPEKAVA_VERSIOON_STAATUS_S",K:"OPPEKAVA_VERSIOON_STAATUS_K",C:"OPPEKAVA_VERSIOON_STAATUS_C"},d.query=function(d,e){var f=a(b.apiUrl+"/curriculum"),g=c.getQueryParams(d);return f.get(g,e)},d.getAreasOfStudyByGroupOfStudy=function(c,d){var e=a(b.apiUrl+"/curriculum/areasOfStudyByGroupOfStudy/"+c);return e.query(d)},d.modulesViewData=function(a){var b={},c={};return a.forEach(function(a){angular.isArray(a.occupations)&&a.occupations.length>0?a.occupations.forEach(function(c){angular.isObject(b[c.code])||(b[c.code]={occupation:c,moduleTypes:{}}),angular.isObject(b[c.code].moduleTypes[a.module.code])||(b[c.code].moduleTypes[a.module.code]={moduleType:a.module,modules:[]}),b[c.code].moduleTypes[a.module.code].modules.push(a)}):(angular.isObject(c[a.module.code])||(c[a.module.code]={moduleType:a.module,modules:[]}),c[a.module.code].modules.push(a))}),{occupationModuleTypesModules:b,modulesWithOutOccupation:c}},d.queryVersions=function(a){return c.endpoint("/autocomplete/curriculumversions").query(a)},d}]),angular.module("hitsaOis").controller("CurriculumListController",["$scope","$sessionStorage","Classifier","DataUtils","QueryUtils","$q","$rootScope","AuthService","$location","$route","Curriculum",function(a,b,c,d,e,f,g,h,i,j,k){function l(){if(a.auth.school){var b=a.criteria.studyLevel;e.endpoint("/school/studyLevels").search().$promise.then(function(c){a.criteria.studyLevel=b,a.studyLevelOptions=c.studyLevels,a.school={higher:a.auth.school.higher,vocational:a.auth.school.vocational}})}else a.school={higher:!0,vocational:!0}}a.auth=j.current.locals.auth;var m=c.valuemapper({origStudyLevel:"OPPEASTE",status:"OPPEKAVA_STAATUS"});e.createQueryForm(a,"/curriculum",{order:a.currentLanguageNameField()},m.objectmapper),f.all(m.promises).then(a.loadData),d.convertStringToDates(a.criteria,["validFrom","validThru"]),a.criteria.status||(a.criteria.status=["OPPEKAVA_STAATUS_M","OPPEKAVA_STAATUS_S","OPPEKAVA_STAATUS_K"]),l(),e.endpoint("/curriculum/canView").search().$promise.then(function(b){a.canView=b.canView}),e.endpoint("/curriculum/canCreate").search().$promise.then(function(b){a.canCreate=b.canCreate}),a.areasOfStudy=!0,a.$watch("criteria.curriculumGroup",function(){a.criteria.curriculumGroup?k.getAreasOfStudyByGroupOfStudy(a.criteria.curriculumGroup,function(b){a.areasOfStudy=b}):a.areasOfStudy=!0}),a.edit=function(a){a.higher?i.path("/higherCurriculum/"+a.id+"/edit"):i.path("/vocationalCurriculum/"+a.id+"/edit")},a.view=function(a){a.higher?i.path("/higherCurriculum/"+a.id+"/view"):i.path("/vocationalCurriculum/"+a.id+"/view")},a.$watch("criteria.iscedClassCode",function(){a.criteria.iscedClassCode&&!a.criteria.iscedSuun&&a.criteria.iscedVald&&(a.criteria.iscedVald=void 0)}),a.$watch("criteria.iscedSuun",function(){a.criteria.iscedSuun&&!a.criteria.iscedVald&&a.criteria.curriculumGroup&&(a.criteria.curriculumGroup=void 0)})}]),angular.module("hitsaOis").controller("CurriculumPublicListController",["$scope","Classifier","DataUtils","QueryUtils","$q","$route",function(a,b,c,d,e,f){var g=f.current.params.schoolId,h=b.valuemapper({origStudyLevel:"OPPEASTE",status:"OPPEKAVA_STAATUS"});d.createQueryForm(a,"/public/curriculumsearch",{schoolId:g,order:a.currentLanguageNameField()},h.objectmapper),e.all(h.promises).then(a.loadData),c.convertStringToDates(a.criteria,["validFrom","validThru"]),g&&(a.criteria.school=g)}]).controller("CurriculumPublicController",["$scope","QueryUtils","$route","config",function(a,b,c,d){function e(b){a.curriculum=b,a.curriculum.studyPeriodMonths=b.studyPeriod%12,a.curriculum.studyPeriodYears=Math.floor(b.studyPeriod/12)}var f=c.current.locals.entity;angular.isDefined(f)&&(a.publicUrl=d.apiUrl+"/public/curriculum/"+f.id+"?format=json",e(f))}]).controller("CurriculumPublicVersionController",["$scope","$route","config",function(a,b,c){a.version=b.current.locals.curriculumVersion,a.curriculum=b.current.locals.curriculum,a.years=[],a.mappedSubjects={},a.version.$promise.then(function(b){a.publicUrl=c.apiUrl+"/public/curriculum/"+a.curriculum.id+"/"+a.version.id+"?format=json",a.years=[],a.mappedSubjects={},b.modules.forEach(function(b){for(var c=0;c<b.subjects.length;c++)null!==b.subjects[c].studyYearNumber&&(a.mappedSubjects[b.subjects[c].studyYearNumber]||(a.years.push(b.subjects[c].studyYearNumber),a.mappedSubjects[b.subjects[c].studyYearNumber]=[]),a.mappedSubjects[b.subjects[c].studyYearNumber].push(b.subjects[c]))})})}]),angular.module("hitsaOis").config(["$routeProvider","USER_ROLES",function(a,b){a.when("/curriculum",{templateUrl:"curriculum/curriculum.list.html",controller:"CurriculumListController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_OPPEKAVA]}}).when("/curriculums/:schoolId?",{templateUrl:"curriculum/curriculum.public.list.html",controller:"CurriculumPublicListController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}]}}).when("/curriculum/:id",{templateUrl:"curriculum/curriculum.public.view.html",controller:"CurriculumPublicController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],entity:["QueryUtils","$route",function(a,b){return a.endpoint("/public/curriculum").get({id:b.current.params.id}).$promise}]}}).when("/curriculum/:curriculumId/version/:id",{templateUrl:"curriculum/curriculum.public.version.html",controller:"CurriculumPublicVersionController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],curriculum:["QueryUtils","$route",function(a,b){return a.endpoint("/public/curriculum").get({id:b.current.params.curriculumId}).$promise}],curriculumVersion:["QueryUtils","$route",function(a,b){return a.endpoint("/public/curriculum/"+b.current.params.curriculumId).get({id:b.current.params.id}).$promise}]}})}]),angular.module("hitsaOis").controller("DeclarationEditController",["$scope","dialogService","QueryUtils","message","ArrayUtils","$route","$location",function(a,b,c,d,e,f,g){function h(){a.subjects=c.endpoint("/declarations/subjects/extracurriculum/"+k).query()}var i=c.endpoint("/declarations/subject"),j=c.endpoint("/declarations/confirm"),k=f.current.params.id;a.formState={},a.auth=f.current.locals.auth,a.addCurriculumSubjectForm=!1,a.addExtraCurriculumSubjectFrom=!1,a.auth.isStudent()&&!angular.isDefined(k)&&c.endpoint("/declarations/hasPrevious").search().$promise.then(function(b){a.currentNavItem="current",a.formState.showNavBar=b.hasPrevious}),k?a.declaration=c.endpoint("/declarations").get({id:k}):a.declaration=c.endpoint("/declarations/current").get(),a.confirm=function(){b.confirmDialog({prompt:"declaration.prompt.confirm"},function(){new j(a.declaration).$update().then(function(a){d.info("declaration.message.confirmed"),g.path("/declarations/"+a.id+"/view")})})},a.removeConfirmation=function(){b.confirmDialog({prompt:"declaration.prompt.removeConfirmation"},function(){var b=c.endpoint("/declarations/removeConfirm");new b(a.declaration).$update().then(function(b){d.info("declaration.message.confirmationRemoved"),a.declaration=b})})},a.removeSubject=function(b){new i(b).$delete().then(function(){d.info("declaration.message.subjectRemoved"),e.remove(a.declaration.subjects,b),a.addCurriculumSubjectForm?a.loadData():h()})},c.createQueryForm(a,"/declarations/subjects/"+k),a.afterLoadData=function(b){a.tabledata.content=b.content,a.tabledata.totalElements=b.totalElements},a.criteria={order:"cvhm."+a.currentLanguageNameField(),size:10,page:1},a.openAddCurriculumSubject=function(){a.addCurriculumSubject=!0,a.addExtraCurriculumSubject=!1,a.loadData()},a.addCurriculumSubject=function(b){var c=new i({subjectStudyPeriod:b.subjectStudyPeriod,declaration:a.declaration.id,curriculumVersionHigherModule:b.module.id,isOptional:b.isOptional});c.$save().then(function(b){d.info("declaration.message.subjectAdded"),b.newlyAdded=!0,a.declaration.subjects.push(b),a.loadData()})},a.openAddCurriculumSubject=function(){a.addCurriculumSubjectForm=!0,a.addExtraCurriculumSubjectForm=!1,a.loadData()},a.openAddExtraCurriculumSubject=function(){a.addCurriculumSubjectForm=!1,a.addExtraCurriculumSubjectForm=!0,h()},a.addExtraCurriculumSubject=function(){if(a.extraCurriculumForm.$setSubmitted(),a.subject){var b=new i({subjectStudyPeriod:a.subject.subjectStudyPeriod,declaration:a.declaration.id,curriculumVersionHigherModule:null!==a.subject.module?a.subject.module.id:null,isOptional:!0});b.$save().then(function(b){d.info("declaration.message.subjectAdded"),b.newlyAdded=!0,a.declaration.subjects.push(b),h(),a.subject=void 0})}},a.hasPrerequisites=function(a){return!e.isEmpty(a.mandatoryPrerequisiteSubjects)||!e.isEmpty(a.recommendedPrerequisiteSubjects)},a.seePrerequisites=function(a){var c=function(b){b.subject=a};b.showDialog("declaration/declaration.subject.prerequisites.html",c,function(){})}}]).controller("DeclarationViewController",["$scope","dialogService","QueryUtils","message","ArrayUtils","$route","$location",function(a,b,c,d,e,f,g){var h=f.current.params.id;a.currentDeclarationPage="/declaration/current/view"===g.path(),a.auth=f.current.locals.auth;var i=c.endpoint("/declarations/confirm");a.formState={},a.auth.isStudent()&&!angular.isDefined(h)&&c.endpoint("/declarations/hasPrevious").search().$promise.then(function(b){a.currentNavItem="current",a.formState.showNavBar=b.hasPrevious}),h?a.declaration=c.endpoint("/declarations").get({id:h},function(){a.formState.declaration=!0}):c.endpoint("/declarations/current").get().$promise.then(function(b){b.id?(a.declaration=b,a.formState.declaration=!0):(a.formState.noDeclaration=!0,c.endpoint("/declarations/isDeclarationPeriod").search().$promise.then(function(b){a.formState.isDeclarationPeriod=b.isDeclarationPeriod,b.declarationPeriodStart?a.formState.declarationPeriodStart=b.declarationPeriodStart:b.declarationPeriodEnd&&(a.formState.declarationPeriodEnd=b.declarationPeriodEnd),a.formState.isDeclarationPeriod&&c.endpoint("/declarations/canCreate").search().$promise.then(function(b){a.formState.canCreateDeclaration=b.canCreate})}))}),a.addDeclaration=function(){var a=c.endpoint("/declarations/create");(new a).$save().then(function(a){g.path("/declarations/"+a.id+"/edit")})},a.confirm=function(){b.confirmDialog({prompt:"declaration.prompt.confirm"},function(){new i(a.declaration).$update().then(function(b){d.info("declaration.message.confirmed"),a.declaration=b})})},a.removeConfirmation=function(){b.confirmDialog({prompt:"declaration.prompt.removeConfirmation"},function(){var b=c.endpoint("/declarations/removeConfirm");new b(a.declaration).$update().then(function(b){d.info("declaration.message.confirmationRemoved"),a.declaration=b})})},a.hasPrerequisites=function(a){return!e.isEmpty(a.mandatoryPrerequisiteSubjects)||!e.isEmpty(a.recommendedPrerequisiteSubjects)},a.seePrerequisites=function(a){var c=function(b){b.subject=a};b.showDialog("declaration/declaration.subject.prerequisites.html",c,function(){})}}]).controller("DeclarationSearchController",["$scope","$route","$q","$timeout","Classifier","DataUtils","QueryUtils","message","dialogService","USER_ROLES","AuthService",function(a,b,c,d,e,f,g,h,i,j,k){var l=b.current.locals.auth;a.canConfirm=k.isAuthorized(j.ROLE_OIGUS_K_TEEMAOIGUS_OPINGUKAVA);var m=e.valuemapper({status:"OPINGUKAVA_STAATUS"});g.createQueryForm(a,"/declarations",{order:"dId"},m.objectmapper),f.convertStringToDates(a.criteria,["inserted","confirmDate"]),a.studyPeriods=g.endpoint("/autocomplete/studyPeriodsWithYear").query(),a.studyPeriods.$promise.then(function(b){b.forEach(function(b){b[a.currentLanguageNameField()]=a.currentLanguageNameField(b.studyYear)+" "+a.currentLanguageNameField(b)})}),a.curriculumVersions=g.endpoint("/autocomplete/curriculumversions").query({higher:!0,valid:!0});var n=m.promises;n.push(a.studyPeriods.$promise),n.push(a.curriculumVersions.$promise),a.formState={canCreate:-1!==l.authorizedRoles.indexOf("ROLE_OIGUS_M_TEEMAOIGUS_OPINGUKAVA")},a.searchCurriculumVersions=function(b){return f.filterArrayByText(a.curriculumVersions,b,function(b,c){return c.test(a.currentLanguageNameField(b).toUpperCase())})};var o=a.loadData;a.loadData=function(){a.declarationSearchForm.$setSubmitted(),
a.declarationSearchForm.$valid?o():h.error("main.messages.form-has-errors")},c.all(n).then(function(){if(a.studyPeriods.length>0&&!a.criteria.studyPeriod){var b=f.getCurrentStudyYearOrPeriod(a.studyPeriods);a.criteria.studyPeriod=b?b.id:void 0}a.criteria.studyPeriod?d(a.loadData):0===a.studyPeriods.length&&(a.formState.canCreate=!1,h.error("studyYear.studyPeriod.missing"))}),a.confirmAll=function(){i.confirmDialog({prompt:"declaration.prompt.confirmAll"},function(){g.endpoint("/declarations/confirm/all").put().$promise.then(function(b){h.info("declaration.message.allConfirmed",{numberOfNewlyConfirmedDeclarations:b.numberOfNewlyConfirmedDeclarations}),a.loadData()})})},a.showUncomposed=function(){var a=function(a){g.createQueryForm(a,"/declarations/withoutDeclaration/",{order:"p.lastname,p.firstname"}),a.clearCriteria(),a.loadData()};i.showDialog("declaration/uncomposed.declarations.html",a,function(){})}}]).controller("DeclarationStudentSearchController",["$scope","$q","Classifier","QueryUtils",function(a,b,c,d){a.currentNavItem="previous";var e=c.valuemapper({status:"OPINGUKAVA_STAATUS"});d.createQueryForm(a,"/declarations/previous",{order:"dId"},e.objectmapper),b.all(e.promises).then(a.loadData)}]).controller("DeclarationNewController",["$scope","$location","FormUtils","QueryUtils","message",function(a,b,c,d,e){function f(){var b=!!a.studyPeriod.id;return b||e.error("studyYear.studyPeriod.missingCurrent"),b}a.studyPeriod=d.endpoint("/declarations/currentStudyPeriod").search(),a.studyPeriod.$promise.then(f),a.save=function(){c.withValidForm(a.declarationNewForm,function(){if(f()){var c=d.endpoint("/declarations/create/"+a.student.id);(new c).$save().then(function(a){e.info("main.messages.create.success"),b.url("/declarations/"+a.id+"/edit?_noback")})["catch"](angular.noop)}})}}]),angular.module("hitsaOis").config(["$routeProvider","USER_ROLES",function(a,b){a.when("/declarations",{templateUrl:"declaration/declaration.search.html",controller:"DeclarationSearchController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:function(a,c){return"ROLL_A"===a.roleCode&&-1!==c.indexOf(b.ROLE_OIGUS_V_TEEMAOIGUS_OPINGUKAVA)}}}).when("/declarations/:id/view",{templateUrl:"declaration/declaration.view.html",controller:"DeclarationViewController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_OPINGUKAVA]}}).when("/declaration/current/edit",{templateUrl:"declaration/declaration.edit.html",controller:"DeclarationEditController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_OPINGUKAVA]}}).when("/declarations/:id/edit",{templateUrl:"declaration/declaration.edit.html",controller:"DeclarationEditController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_OPINGUKAVA]}}).when("/declaration/current/view",{templateUrl:"declaration/declaration.view.html",controller:"DeclarationViewController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_OPINGUKAVA]}}).when("/declarations/previous",{templateUrl:"declaration/declaration.student.search.html",controller:"DeclarationStudentSearchController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_OPINGUKAVA]}}).when("/declarations/new",{templateUrl:"declaration/declaration.new.html",controller:"DeclarationNewController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:function(a,c){return"ROLL_A"===a.roleCode&&-1!==c.indexOf(b.ROLE_OIGUS_M_TEEMAOIGUS_OPINGUKAVA)}}})}]),angular.module("hitsaOis").controller("DirectiveEditController",["$location","$mdDialog","$q","$route","$scope","dialogService","message","resourceErrorHandler","Classifier","Curriculum","DataUtils","FormUtils","QueryUtils","Session","$rootScope",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){function p(){e.formState.scholarshipEditable=-1!==["STIPTOETUS_ERI","STIPTOETUS_SOIDU","STIPTOETUS_DOKTOR"].indexOf(e.record.scholarshipType)}function q(){var a=e.record.type?e.record.type.substr(9).toLowerCase():"unknown";e.formState.templateUrl="directive/directive.type."+a+".edit.html"}function r(a){a.occupations&&(a.occupations=a.occupations.map(function(a){return I[a]}))}function s(a){a.specialities&&Object.keys(a.specialities).forEach(function(b){a.specialities[b]=a.specialities[b].map(function(a){return J[a]})})}function t(a){var b=k.convertStringToDates(a,["startDate","endDate","studentNominalStudyEnd"]);return angular.isArray(b)?(I&&(b.forEach(r),b.forEach(s)),b.forEach(u)):(I&&(r(b),s(b)),u(b)),b}function u(a){switch(e.record.type){case"KASKKIRI_INDOKLOP":!a.directiveStudent&&a.existingDirectiveStudents&&1===a.existingDirectiveStudents.length&&(a.directiveStudent=a.existingDirectiveStudents[0].id);break;case"KASKKIRI_STIPTOET":!a.scholarshipApplication&&a.scholarshipApplications&&1===a.scholarshipApplications.length&&(a.scholarshipApplication=a.scholarshipApplications[0].id,e.scholarshipApplicationChanged(a));break;case"KASKKIRI_STIPTOETL":!a.directiveStudent&&a.existingDirectiveStudents&&1===a.existingDirectiveStudents.length&&(a.directiveStudent=a.existingDirectiveStudents[0].id,e.scholarshipDirectiveChanged(a));break;case"KASKKIRI_TUGILOPP":e.mapStudentDirective(a),!a.directiveStudent&&a.existingDirectiveStudents&&1===a.existingDirectiveStudents.length&&(a.directiveStudent=a.existingDirectiveStudents[0].id)}}function v(a){if(E=new Date,angular.isDefined(a)&&a.canEditDirective===!1&&(g.error("main.messages.error.nopermission"),o.back("#/directives/"+a.id+"/view")),e.formState.cancelSelect=a&&"KASKKIRI_TYHIST"===a.type,e.formState.cancelSelect){var b=a.canceledDirectiveType?a.canceledDirectiveType.substr(9).toLowerCase():"unknown";e.formState.templateUrl="directive/directive.type."+b+".view.html",e.formState.canceledDirective=a.canceledDirectiveData,e.formState.changedStudents=a.changedStudents||[];var c=a.selectedStudents||[];e.record.students=(a.canceledStudents||[]).map(function(a){return a.selectable=-1===e.formState.changedStudents.indexOf(a.student),a}),e.formState.selectedStudents=e.record.students.filter(function(a){return-1!==c.indexOf(a.student)}),delete a.canceledDirectiveType,delete a.canceledDirectiveData,delete a.changedStudents,delete a.canceledStudents,delete a.selectedStudents,e.cancelTypeChanged()}else if(q(),p(),e.record.students=t(e.record.students),a&&"KASKKIRI_IMMAT"===a.type)for(var d=0,f=e.record.students.length;f>d;d++)e.record.students[d]._found=!0,e.record.students[d]._idcode=e.record.students[d].idcode,e.record.students[d]._foreign=!e.record.students[d].idcode}function w(){var a=e.record.type;-1!==["KASKKIRI_ENNIST","KASKKIRI_IMMAT","KASKKIRI_IMMATV","KASKKIRI_OKAVA","KASKKIRI_OVORM"].indexOf(a)&&(e.formState.studentGroups=m.endpoint("/autocomplete/studentgroups").query({valid:!0}),e.formState.curriculumVersions&&c.all([e.formState.studentGroups.$promise,e.formState.curriculumVersions.$promise]).then(function(){function a(a){return a.curriculumVersion?[a.curriculumVersion]:e.formState.curriculumVersions.filter(function(b){return b.curriculum===a.curriculum}).map(function(a){return a.id})}var b=e.formState.studentGroups;e.formState.studentGroupMap={};for(var c=0;c<b.length;c++)for(var d=b[c],f=a(d),g=0;g<f.length;g++){var h=f[g],i=e.formState.studentGroupMap[h];i||(i=[],e.formState.studentGroupMap[h]=i),i.push(d)}})),("KASKKIRI_AKAD"===a||"KASKKIRI_VALIS"===a)&&(e.formState.studyPeriods=m.endpoint("/autocomplete/studyPeriods").query())}function x(a,b,c){var d={id:e.record.id,type:e.record.type,scholarshipType:e.record.scholarshipType,canceledDirective:G,curriculumVersion:e.formState.curriculumVersion,studyLevel:e.formState.studyLevel,students:a.map(function(a){return a.id}),isHigher:e.record.isHigher};"KASKKIRI_TUGI"===e.record.type&&(b||(b={}),d.studentApplication={},a.forEach(function(a){d.studentApplication[a.id]=b[a.id]})),m.endpoint(H+"/directivedata").save(d,c)}function y(a){h.responseError(a,e.directiveForm)["catch"](angular.noop)}function z(){"KASKKIRI_TYHIST"===e.record.type&&(e.record.selectedStudents=e.formState.selectedStudents.map(function(a){return a.student}))}function A(a,b){a.$serverError=void 0,a.$setValidity(b,null)}function B(){var a=e.directiveForm.$error;a&&Object.keys(a).forEach(function(b){var c=a[b].slice();c.forEach(function(a){A(a,b)})})}function C(a,b){x(a,b,function(a){for(var b=0,c=a.students.length;c>b;b++)e.record.students.push(t(a.students[b]))})}function D(a){return a instanceof Date&&!isNaN(a)&&a>E?a:E}var E,F=d.current.params.id,G=d.current.params.canceledDirective,H="/directives";e.getMinDate=D,e.formState={state:F||G?"EDIT":"CHOOSETYPE",students:void 0,changedStudents:[],selectedStudents:[],excludedTypes:["KASKKIRI_KYLALIS"],school:n.school||{},higherStudyForms:i.queryForDropdown({mainClassCode:"OPPEVORM",higher:!0}),scholarshipEditable:!1},e.withoutInitialSelection=["KASKKIRI_IMMAT","KASKKIRI_IMMATV","KASKKIRI_KIITUS","KASKKIRI_NOOMI","KASKKIRI_OTEGEVUS","KASKKIRI_PRAKTIK","KASKKIRI_INDOK"],G||e.formState.excludedTypes.push("KASKKIRI_TYHIST");var I,J;if(!e.formState.school.higher){e.formState.excludedTypes.push("KASKKIRI_OKOORM"),e.formState.excludedTypes.push("KASKKIRI_OVORM"),e.formState.excludedTypes.push("KASKKIRI_VALIS");var K=i.queryForDropdown({mainClassCodes:"KUTSE,OSAKUTSE"});K.$promise.then(function(){I=i.toMap(K)});var L=i.queryForDropdown({mainClassCodes:"SPETSKUTSE"});L.$promise.then(function(){J=i.toMap(L)})}e.formState.school.vocational||(e.formState.excludedTypes.push("KASKKIRI_INDOK"),e.formState.excludedTypes.push("KASKKIRI_INDOKLOP"),e.formState.excludedTypes.push("KASKKIRI_KIITUS"),e.formState.excludedTypes.push("KASKKIRI_NOOMI"),e.formState.excludedTypes.push("KASKKIRI_OTEGEVUS"),e.formState.excludedTypes.push("KASKKIRI_TUGI"),e.formState.excludedTypes.push("KASKKIRI_TUGILOPP")),e.formState.curriculumVersionMap={},e.formState.languageMap={},e.formState.curriculumVersions=j.queryVersions({languages:!0}),e.formState.curriculumVersions.$promise.then(function(a){e.formState.curriculumVersionMap=a.reduce(function(a,b){return a[b.id]=b,a},{});for(var b=0;b<a.length;b++){var c=a[b];e.formState.languageMap[c.id]=c.studyLang||[]}}),e.$watchCollection("formState.selectedStudents",function(a){e.formState.selectedStudentIds=(a||[]).reduce(function(a,b){return a[b.id]=b,a},{})});var M=m.endpoint(H);F?e.formState.curriculumVersions.$promise.then(function(){e.record=M.get({id:F}),e.record.$promise.then(v).then(w)["catch"](function(){e.back("#/")})}):(e.record=new M({students:[]}),G?(e.record.type="KASKKIRI_TYHIST",x([],{},function(a){var b=a.toJSON();angular.copy(b,e.record),v(b)})):v()),e.update=function(){B(),l.withValidForm(e.directiveForm,function(){z(),e.record.id?e.record.$update2().then(function(a){v(a),e.directiveForm.$setPristine(),g.updateSuccess()})["catch"](y):e.record.$save2().then(function(){g.info("main.messages.create.success"),a.url(H+"/"+e.record.id+"/edit?_noback")})["catch"](y)})},e["delete"]=function(){l.deleteRecord(e.record,H+"?_noback",{prompt:"directive.deleteconfirm"})},e.directiveTypeChanged=function(){e.formState.students=[],e.formState.selectedStudents=[];var a={type:e.record.type};if("KASKKIRI_EKSMAT"===a.type)a.application=!0;else if("KASKKIRI_LOPET"===a.type){if(!angular.isDefined(e.record.isHigher)){var b=e.formState.school;if(b.higher&&b.vocational)return;e.record.isHigher=b.higher}a.isHigher=e.record.isHigher}var c="KASKKIRI_STIPTOET"===a.type||"KASKKIRI_STIPTOETL"===a.type;c&&(a.scholarshipType=e.record.scholarshipType),-1===e.withoutInitialSelection.indexOf(a.type)?(!c||a.scholarshipType)&&m.endpoint(H+"/findstudents").search(a,function(a){e.formState.students=a.content,e.formState.students.length||g.info("directive.nostudentsfound")}):"KASKKIRI_IMMATV"!==a.type||e.formState.saisCurriculumVersions||(e.formState.saisCurriculumVersions=j.queryVersions({sais:!0})),q()},e.scholarshipTypeChanged=function(){p(),e.record.scholarshipType&&e.directiveTypeChanged()},e.addDirective=function(){return"KASKKIRI_TUGI"!==e.record.type||(e.directiveForm.$setSubmitted(),e.directiveForm.$valid)?(e.formState.state="EDIT",x(e.formState.selectedStudents,e.formState.studentApplicationRelationship,function(a){angular.copy(a.toJSON(),e.record),e.record.students=t(a.students)}),void w()):void g.error("main.messages.form-has-errors")},e.deleteStudent=function(a){for(var b=e.record.students,c=0,d=b.length;d>c;c++)if(b[c]===a){b.splice(c,1);break}},e.addStudents=function(){var a=e.record.type,c=e.record.students;if("KASKKIRI_IMMAT"===a)return void c.push({startDate:null});var d={type:a,directive:F};("KASKKIRI_STIPTOET"===a||"KASKKIRI_STIPTOETL"===a)&&(d.scholarshipType=e.record.scholarshipType),"KASKKIRI_LOPET"===a&&(d.isHigher=e.record.isHigher),b.show({controller:["$scope",function(a){var e="/directives/findstudents";a.formState={selectedStudents:[],type:d.type,studentApplicationRelationship:{}},m.createQueryForm(a,e),a.$watch("criteria.studentGroupObject",function(){a.criteria.studentGroup=a.criteria.studentGroupObject?a.criteria.studentGroupObject.id:null}),a.$watchCollection("formState.selectedStudents",function(b){a.formState.selectedStudentIds=(b||[]).reduce(function(a,b){return a[b.id]=b,a},{})}),a.cancel=b.hide,a.select=function(){C(a.formState.selectedStudents,a.formState.studentApplicationRelationship),b.hide()},c=c.map(function(a){return a.student}),a.loadData=function(){var b=angular.extend(m.getQueryParams(a.criteria),d);a.tabledata.$promise=m.endpoint(e).search(b,function(b){b.content=b.content.filter(function(a){return-1===c.indexOf(a.id)}),a.afterLoadData(b)})},a.loadData()}],templateUrl:"directive/student.select.dialog.html",clickOutsideToClose:!1})},e.foreignChanged=function(a){a._foreign?(a.foreignIdcode=a.idcode,a.idcode=void 0):(a.idcode=a.foreignIdcode,a.foreignIdcode=void 0),a._idcode=void 0,e.lookupStudent(a)},e.lookupStudent=function(a){var b="students["+e.record.students.indexOf(a)+"].idcode",c=e.directiveForm[b];c&&A(c,"serverside");var d=a._foreign?a.foreignIdcode:a.idcode;d&&(11===d.length||a._foreign)&&d!==a._idcode?(a._idcode=d,m.endpoint("/autocomplete/persons",{search:{method:"GET"}}).search(a._foreign?{foreignIdcode:d,role:"foreignidcode"}:{idcode:d,role:"person"}).$promise.then(function(b){a._found=!0,a.firstname=b.firstname,a.lastname=b.lastname,a.birthdate=b.birthdate||k.birthdayFromIdcode(d),a.sex=b.sex||k.sexFromIdcode(d),a.citizenship=b.citizenship})["catch"](function(b){404===b.status?g.info("directive.newperson"):412===b.status?(c.$serverError=c.$serverError||[],c.$serverError.push({code:"InvalidEstonianIdCode"}),c.$setValidity("serverside",!1)):y(b),a._found=!1,a.firstname=void 0,a.lastname=void 0,a._foreign||404!==b.status?(a.birthdate=void 0,a.sex=void 0,a.citizenship=void 0):(a.birthdate=k.birthdayFromIdcode(d),a.sex=k.sexFromIdcode(d),a.citizenship="RIIK_EST")})):d!==a._idcode&&(a._found=!1,!a._foreign&&d&&c&&(a.birthdate=void 0,a.sex=void 0,c.$serverError=c.$serverError||[],c.$serverError.push({code:"InvalidEstonianIdCode"}),c.$setValidity("serverside",!1)))},e.abroadChanged=function(a){var b="RIIK_EST";a.isAbroad?a.country===b&&(a.country=null):a.country=b},e.curriculumVersionChanged=function(a){var b=e.formState.curriculumVersionMap[a.curriculumVersion];b&&b.isVocational?(a.studyForm=b.studyForm,a.dormitory=a.dormitory?a.dormitory:"YHISELAMU_E",a.studyLoad=null):a.dormitory=null,a.curriculumVersionObject=b},e.visibleStudyForms=function(a){return a?(a=e.formState.curriculumVersionMap[a],a&&a.isVocational?[a.studyForm]:e.formState.higherStudyForms):void 0},e.cancelTypeChanged=function(){if("KASKKIRI_TYHISTAMISE_VIIS_T"===e.record.cancelType){var a=[];e.record.students.forEach(function(b){b.selectable=!1,a.push(b)}),e.formState.selectedStudents=a}else"KASKKIRI_TYHISTAMISE_VIIS_O"===e.record.cancelType&&e.record.students.forEach(function(a){a.selectable=-1===e.formState.changedStudents.indexOf(a.student)})},e.sendToConfirm=function(b){B(),e.directiveForm.directiveCoordinator.$setValidity("required",!!e.record.directiveCoordinator),l.withValidForm(e.directiveForm,function(){function c(){z(),e.record.$update2().then(function(h){v(h),e.directiveForm.$setPristine(),m.endpoint(H+"/sendtoconfirm/"+e.record.id+"?ekis="+b,{put:{method:"PUT"}}).put().$promise.then(function(b){var h=b?b.invalidStudents:void 0;h&&h.length>0?d||f.showDialog("directive/invalid.student.delete.dialog.html",function(a){a.students=h},function(){h.forEach(function(a){var b=e.record.students.find(function(b){return b.student===a.student});b&&e.deleteStudent(b)}),d=!0,c()}):(g.info("directive.sentToConfirm"),a.url(H+"/"+e.record.id+"/view?_noback"))})["catch"](y)})["catch"](y)}var d=!1;m.endpoint(H+"/checkForConfirm").get({id:e.record.id}).$promise.then(function(a){var b=(a.templateName||[]).join('", "');f.confirmDialog({prompt:a.templateExists?"directive.ekisconfirm":"directive.ekisconfirmTemplateMissing",template:b},c)})["catch"](angular.noop)})},e.allStudyActivityChange=function(a,b){"isAbsence"!==a&&(e.record.studyActivityStartDate&&e.record.studyActivityEndDate||(e.record.studyActivityIsAbsence=!1,e.allStudyActivityChange("isAbsence",!1))),b&&e.record.students.forEach(function(c){c[a]=b})},e.studyActivityDateChange=function(a){a.startDate&&a.endDate||(a.isAbsence=!1)},e.scholarshipApplicationChanged=function(a){if(a.scholarshipApplication){var b=a.scholarshipApplications.filter(function(b){return a.scholarshipApplication===b.id})[0];a.startDate=b.startDate,a.endDate=b.endDate,a.bankAccount=b.bankAccount,a.amountPaid=b.amountPaid}else a.startDate=null,a.endDate=null,a.bankAccount=null,a.amountPaid=null},e.scholarshipDirectiveChanged=function(a){if(a.directiveStudent){var b=a.existingDirectiveStudents.filter(function(b){return a.directiveStudent===b.id})[0];a.startDate=b.startDate,a.endDate=b.endDate,a.scholarshipApplication=b.scholarshipApplicationId}else a.startDate=null,a.endDate=null,a.scholarshipApplication=null},e.mapStudentDirective=function(a){a.directiveStudentObject=(a.existingDirectiveStudents||[]).find(function(b){return b.id===a.directiveStudent}),a.directiveStudentObject&&"string"==typeof a.directiveStudentObject.endDate&&(a.directiveStudentObject=k.convertStringToDates(a.directiveStudentObject,["startDate","endDate"]))},e.individualCurriculumModules=function(a,b){f.showDialog("directive/indok.modules.dialog.html",function(b){var c=a.student;b.formState={viewForm:"KASKKIRI_TYHIST"===e.record.type,selectedModules:[]},b.student=a,b.existingIndividualCurriculums=!1,m.endpoint(H+"/studentIndividualCurriculumModules/:id").query({id:c,directiveId:F}).$promise.then(function(a){b.curriculumVersionModules=a,(b.curriculumVersionModules||[]).forEach(function(a){var c=!0;if(a.existingModules){b.existingIndividualCurriculums=!0;for(var d=0;d<a.existingModules.length;d++){var e=new Date(a.existingModules[d].startDate);e.setHours(0,0,0,0);var f=new Date(a.existingModules[d].endDate);if(f.setHours(0,0,0,0),k.isValidObject(b.student.startDate,b.student.endDate,e,f)){c=!1;break}}}a.valid=c}),b.student.modules&&b.student.modules.forEach(function(a){var c=(b.curriculumVersionModules||[]).filter(function(b){return b.id===a.curriculumVersionOmodule})[0];c&&(c.valid&&b.formState.selectedModules.push(a.curriculumVersionOmodule),c.directiveStudentModuleId=a.id,c.addInfo=a.addInfo)})}),b.changeModules=function(){b.submit()}},function(a){var c=[];a.curriculumVersionModules.forEach(function(b){-1!==a.formState.selectedModules.indexOf(b.id)&&c.push({id:b.directiveStudentModuleId,curriculumVersionOmodule:b.id,module:{id:b.id,nameEt:b.nameEt,nameEn:b.nameEn},addInfo:b.addInfo})}),e.record.students[b].modules=c})}}]).controller("DirectiveViewController",["$location","$route","$scope","dialogService","message","Classifier","QueryUtils","FormUtils","Session",function(a,b,c,d,e,f,g,h,i){function j(a){a.occupations&&(a.occupations=a.occupations.map(function(a){return o[a]}))}function k(a){a.specialities&&Object.keys(a.specialities).forEach(function(b){a.specialities[b]=a.specialities[b].map(function(a){return p[a]})})}var l=b.current.params.id,m="/directives",n=f.valuemapper({status:"KASKKIRI_STAATUS"});c.formState={school:i.school||{}};var o,p;if(!c.formState.school.higher){var q=f.queryForDropdown({mainClassCodes:"KUTSE,OSAKUTSE"});q.$promise.then(function(){o=f.toMap(q)});var r=f.queryForDropdown({mainClassCodes:"SPETSKUTSE"});r.$promise.then(function(){p=f.toMap(r)})}c.record=g.endpoint(m+"/:id/view").search({id:l}),c.record.$promise.then(function(){var a="KASKKIRI_TYHIST"===c.record.type?c.record.canceledDirectiveType.substr(9).toLowerCase():c.record.type?c.record.type.substr(9).toLowerCase():"unknown";c.formState.templateUrl="directive/directive.type."+a+".view.html",n.objectmapper(c.record.cancelingDirectives||[]),c.record.students.forEach(function(a){a._foreign=!a.idcode,j(a),k(a)})}),c.cancelDirective=function(){d.confirmDialog({prompt:"directive.cancelconfirm"},function(){a.url("/directives/new?canceledDirective="+c.record.id+"&_noback")})},c.userCanConfirm=function(){return"KASKKIRI_STAATUS_KINNITAMISEL"===c.record.status&&c.record.userCanConfirm},c.confirmDirective=function(){h.withValidForm(c.directiveForm,function(){g.endpoint(m+"/checkForConfirm").get({id:c.record.id}).$promise.then(function(a){var f=(a.templateName||[]).join('", "');(a.validationError||[]).length>0?e.error(a.validationError[0].code,a.validationError[0].params):d.confirmDialog({prompt:a.templateExists?"directive.confirmconfirm":"directive.confirmconfirmTemplateMissing",template:f},function(){g.endpoint(m+"/confirm/"+c.record.id).update(c.confirmRecord).$promise.then(function(){e.info("directive.confirmed"),b.reload()})["catch"](angular.noop)})})["catch"](angular.noop)})},c.individualCurriculumModules=function(a){d.showDialog("directive/indok.modules.dialog.html",function(b){var c=a.student;b.formState={viewForm:!0,selectedModules:[]},b.student=a,g.endpoint(m+"/studentIndividualCurriculumModules/:id").query({id:c,directiveId:l}).$promise.then(function(a){b.curriculumVersionModules=a,b.student.modules&&b.student.modules.forEach(function(a){b.formState.selectedModules.push(a.curriculumVersionOmodule);var c=(b.curriculumVersionModules||[]).filter(function(b){return b.id===a.curriculumVersionOmodule})[0];c&&(c.directiveStudentModuleId=a.id,c.addInfo=a.addInfo)})})})}}]).controller("DirectiveListController",["$q","$scope","Classifier","QueryUtils","Session",function(a,b,c,d,e){b.formState={excludedTypes:["KASKKIRI_KYLALIS"],school:e.school||{}},b.formState.school.higher||(b.formState.excludedTypes.push("KASKKIRI_OKOORM"),b.formState.excludedTypes.push("KASKKIRI_OVORM"),b.formState.excludedTypes.push("KASKKIRI_VALIS")),b.formState.school.vocational||(b.formState.excludedTypes.push("KASKKIRI_INDOK"),b.formState.excludedTypes.push("KASKKIRI_INDOKLOP"),b.formState.excludedTypes.push("KASKKIRI_KIITUS"),b.formState.excludedTypes.push("KASKKIRI_NOOMI"),b.formState.excludedTypes.push("KASKKIRI_OTEGEVUS"),b.formState.excludedTypes.push("KASKKIRI_TUGI"),b.formState.excludedTypes.push("KASKKIRI_TUGILOPP"));var f=c.valuemapper({type:"KASKKIRI",status:"KASKKIRI_STAATUS"});d.createQueryForm(b,"/directives",{order:"-inserted"},f.objectmapper),a.all(f.promises).then(b.loadData)}]),angular.module("hitsaOis").controller("DirectiveCoordinatorEditController",["$location","$route","$scope","dialogService","message","QueryUtils",function(a,b,c,d,e,f){var g=b.current.params.id,h="/directives/coordinators",i=f.endpoint(h);g?c.record=i.get({id:g}):c.record=new i,c.update=function(){return c.directiveCoordinatorForm.$setSubmitted(),c.directiveCoordinatorForm.$valid?void(c.record.id?c.record.$update().then(e.updateSuccess)["catch"](angular.noop):c.record.$save().then(function(){e.info("main.messages.create.success"),a.url(h+"/"+c.record.id+"/edit?_noback")})["catch"](angular.noop)):void e.error("main.messages.form-has-errors")},c["delete"]=function(){d.confirmDialog({prompt:"directive.coordinator.deleteconfirm"},function(){c.record.$delete().then(function(){e.info("main.messages.delete.success"),a.url(h+"?_noback")})["catch"](angular.noop)})}}]),angular.module("hitsaOis").config(["$routeProvider","USER_ROLES",function(a,b){a.when("/directives/coordinators",{templateUrl:"directive/coordinator.search.html",controller:"SimpleListController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],params:function(){return{order:"name"}},url:function(){return"/directives/coordinators"}},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_DOKALLKIRI]}}).when("/directives",{templateUrl:"directive/list.html",controller:"DirectiveListController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_KASKKIRI]}}).when("/directives/new",{templateUrl:"directive/directive.edit.html",controller:"DirectiveEditController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:function(a,c){return"ROLL_A"===a.roleCode&&-1!==c.indexOf(b.ROLE_OIGUS_M_TEEMAOIGUS_KASKKIRI)}}}).when("/directives/:id/edit",{templateUrl:"directive/directive.edit.html",controller:"DirectiveEditController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_KASKKIRI]}}).when("/directives/:id/view",{templateUrl:"directive/directive.view.html",controller:"DirectiveViewController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:function(a,c){return"ROLL_T"===a.roleCode||"ROLL_L"===a.roleCode||("ROLL_A"===a.roleCode||"ROLL_O"===a.roleCode)&&-1!==(c||[]).indexOf(b.ROLE_OIGUS_V_TEEMAOIGUS_KASKKIRI)}}}).when("/directives/coordinators/new",{templateUrl:"directive/coordinator.edit.html",controller:"DirectiveCoordinatorEditController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_DOKALLKIRI]}}).when("/directives/coordinators/:id/edit",{templateUrl:"directive/coordinator.edit.html",controller:"DirectiveCoordinatorEditController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_DOKALLKIRI]}})}]),angular.module("hitsaOis").controller("DiplomaSearchController",["$scope","$route","$q","Classifier","QueryUtils","config",function(a,b,c,d,e,f){var g="/documents";a.auth=b.current.locals.auth,a.formState={xlsUrl:"documents/documents.xls",pdfBaseUrl:f.apiUrl+g+"/view"};var h=d.valuemapper({type:"LOPUBLANKETT",diplomaStatus:"LOPUDOK_STAATUS",supplementStatus:"LOPUDOK_STAATUS",supplementStatusEn:"LOPUDOK_STAATUS"});e.createQueryForm(a,g,{order:"p.lastname",isHigher:a.auth.higher},function(a){c.all(h.promises).then(function(){h.objectmapper(a)})});var i=a.clearCriteria;a.clearCriteria=function(){i(),a.criteria.isHigher=a.auth.higher},a.loadData()}]).controller("DiplomaController",["$scope","$route","$q","$httpParamSerializer","$window","Classifier","config","QueryUtils","DataUtils","DocumentUtils","dialogService","message",function(a,b,c,d,e,f,g,h,i,j,k,l){function m(){h.endpoint(t+"/signers").query(function(b){j.mapSignerDisplay(b),a.formState.signers=b,a.formState.firstsigners=b.filter(function(a){return a.isFirst}),1===a.formState.firstsigners.length&&(a.criteria.signer1Id=a.formState.firstsigners[0].id)})}function n(a){return a.fullCode}function o(){h.endpoint(t+"/diploma/forms").query({formType:a.criteria.formType},function(b){b&&b.length>0&&(a.criteria.numeral=b.shift().numeral,a.formState.freeForms=b.map(n))})}function p(){return a.formState.students.filter(function(a){return a.selected}).map(function(a){return a.id})}function q(){return 0===a.criteria.studentIds.length?!1:a.criteria.signer1Id&&a.criteria.signer2Id?a.isHigher&&!a.criteria.city?!1:!0:!1}function r(){return a.criteria.studentIds=p(),g.apiUrl+t+"/diploma/print.pdf?"+d(a.criteria)}function s(){var b=a.formState.directives.filter(function(b){return b.id===a.criteria.directiveId});return b.length>0?b[0]:void 0}var t="/documents";a.isHigher=b.current.locals.params.isHigher,a.currentNavItem="document.diplomas"+(a.isHigher?"":".vocational"),a.criteria={};var u=f.valuemapper({status:"KASKKIRI_STAATUS"});a.formState={directives:h.endpoint(t+"/diploma/directives").query({isHigher:a.isHigher},function(a){i.convertStringToDates(a,["date"]),c.all(u.promises).then(function(){u.objectmapper(a),j.mapDirectiveDisplay(a)})}),students:[]},a.directiveChanged=function(){a.formState.students=[],a.updatePdfUrl(),h.endpoint(t+"/formtypes").query(a.criteria,function(b){a.formState.formTypes=b,1===b.length&&(a.criteria.formType=b[0],a.formTypeChanged())})},a.formTypeChanged=function(){h.endpoint(t+"/diploma/students").query(a.criteria,function(b){i.convertStringToDates(b,["birthdate"]),a.formState.students=b,a.updatePdfUrl(),b.length>0&&(m(),o())})},a.selectAllStudents=function(b){a.formState.students.forEach(function(a){a.selected=b}),a.updatePdfUrl()},a.updatePdfUrl=function(){return a.criteria.studentIds=p(),q()?void(a.viewPdfUrl=g.apiUrl+t+"/diploma/print/view.pdf?"+d(a.criteria)):void(a.viewPdfUrl=void 0)},a.canPrintConfirm=function(){var b=s();return a.viewPdfUrl&&"KASKKIRI_STAATUS_KINNITATUD"===b.status.code},a.print=function(){a.criteria.studentIds=p(),h.endpoint(t+"/diploma/calculate").query(a.criteria,function(b){e.location=r(),k.showDialog("document/templates/diploma.confirm.dialog.html",function(c){c.forms=b,a.formState.students.filter(function(a){return a.selected}).forEach(function(a,b){c.forms[b].fullname=a.fullname})},function(){h.endpoint(t+"/diploma/confirm").save({directiveId:a.criteria.directiveId,formType:a.criteria.formType,studentIds:a.criteria.studentIds,numerals:b.map(function(a){return a.numeral})},function(){l.updateSuccess(),a.formTypeChanged()}).$promise["catch"](angular.noop)})}).$promise["catch"](angular.noop)}}]).controller("SupplementSearchController",["$scope","$route","$q","Classifier","QueryUtils","DataUtils","DocumentUtils",function(a,b,c,d,e,f,g){var h="/documents";a.isHigher=b.current.locals.params.isHigher,a.currentNavItem="document.supplements"+(a.isHigher?"":".vocational");var i=d.valuemapper({status:"KASKKIRI_STAATUS",diplomaStatus:"LOPUDOK_STAATUS",supplementStatus:"LOPUDOK_STAATUS",supplementStatusEn:"LOPUDOK_STAATUS"});a.formState={directives:e.endpoint(h+"/supplement/directives").query({isHigher:a.isHigher},function(a){f.convertStringToDates(a,["date"]),c.all(i.promises).then(function(){i.objectmapper(a),g.mapDirectiveDisplay(a)})})},a.autocomplete={},e.createQueryForm(a,h+"/supplement/students",{isHigher:a.isHigher,
order:"p.lastname, p.firstname"},i.objectmapper);var j=a.clearCriteria;a.clearCriteria=function(){j(),a.autocomplete={},a.criteria.isHigher=a.isHigher},c.all(i.promises).then(a.loadData),a.$watch("autocomplete.student",function(){a.criteria.studentId=a.autocomplete.student?a.autocomplete.student.id:null}),a.$watch("autocomplete.curriculumVersion",function(){a.criteria.curriculumVersionId=a.autocomplete.curriculumVersion?a.autocomplete.curriculumVersion.id:null})}]).controller("SupplementController",["$scope","$route","$httpParamSerializer","$window","config","QueryUtils","DocumentUtils","dialogService","message",function(a,b,c,d,e,f,g,h,i){function j(a){return a.fullCode}function k(b){return"EN"===b?a.record.supplementStatusEn&&"LOPUDOK_STAATUS_K"!==a.record.supplementStatusEn:a.record.supplementStatus&&"LOPUDOK_STAATUS_K"!==a.record.supplementStatus}function l(){return!a.contentData.signer1Id||a.isHigher&&!a.contentData.signer2Id?!1:!0}function m(b){var c=angular.extend({},a.contentData,"EN"===b?a.formDataEn:a.formData);return b&&angular.extend(c,{lang:b}),c}function n(a){return e.apiUrl+p+"/supplement/"+q+"/print.pdf?"+c(m(a))}function o(a,b){return angular.isUndefined(a)?!1:angular.isUndefined(a.numeral)||null===a.numeral?(i.error(b?b:"main.messages.form-has-errors"),!1):!0}var p="/documents",q=b.current.params.id;a.isHigher=b.current.locals.params.isHigher,a.contentData={showSubjectCode:!0,showTeacher:!0},a.formData={},a.formDataEn={},a.formState={signers:f.endpoint(p+"/signers").query(function(a){g.mapSignerDisplay(a)})},a.record=f.endpoint(p+"/supplement").get({id:q},function(b){if(b.forms&&b.forms.length>0&&("LOPUDOK_STAATUS_T"!==b.supplementStatus&&(a.formData.numeral=b.forms.shift().numeral),b.forms=b.forms.map(j)),b.formsEn&&b.formsEn.length>0&&("LOPUDOK_STAATUS_T"!==b.supplementStatusEn&&(a.formDataEn.numeral=b.formsEn.shift().numeral),b.formsEn=b.formsEn.map(j)),b.freeExtraForms&&b.freeExtraForms.length>0){var c=b.freeExtraForms.shift().numeral;a.formData.additionalNumeral=c,a.formDataEn.additionalNumeral=c,b.freeExtraForms=b.freeExtraForms.map(j)}}),a.updatePdfUrl=function(){if(!l())return a.viewPdfUrl=void 0,void(a.viewPdfUrlEn=void 0);var b=e.apiUrl+p+"/supplement/"+q+"/print/view.pdf?"+c(a.contentData);a.viewPdfUrl=k("ET")?void 0:b,a.viewPdfUrlEn=k("EN")?void 0:b+"&lang=EN"},a.print=function(b){if(angular.isDefined(b)){if(!o(a.formDataEn,"document.error.emptyFreeForms"))return}else if(!o(a.formData,"document.error.emptyFreeForms"))return;f.endpoint(p+"/supplement/"+q+"/calculate").query(m(b),function(c){d.location=n(b),h.confirmDialog({prompt:"document.confirm.print",forms:c.map(j).join(", "),accept:"document.confirm.yes",cancel:"document.confirm.no"},function(){f.endpoint(p+"/supplement/"+q+"/confirm"+(b?"?lang="+b:"")).save(c.map(function(a){return a.id}),function(){i.updateSuccess(),d.location.href="#/documents/supplements"+(a.isHigher?"":"/vocational")})})}).$promise["catch"](angular.noop)}}]).factory("DocumentUtils",["$rootScope","$filter",function(a,b){return{mapDirectiveDisplay:function(c){var d=b("hoisDate");c.forEach(function(b){b.display=(b.number||"-")+"/"+d(b.date)+"/"+a.currentLanguageNameField(b.status)})},mapSignerDisplay:function(a){a.forEach(function(a){a.display=a.name+", "+a.position})}}}]),angular.module("hitsaOis").config(["$routeProvider","USER_ROLES",function(a,b){a.when("/documents",{templateUrl:"document/diploma.search.html",controller:"DiplomaSearchController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_LOPTUNNISTUS_TRUKKIMINE]}}).when("/documents/diplomas",{templateUrl:"document/diploma.html",controller:"DiplomaController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],params:function(){return{isHigher:!0}}},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_LOPTUNNISTUS_TRUKKIMINE]}}).when("/documents/diplomas/vocational",{templateUrl:"document/diploma.html",controller:"DiplomaController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],params:function(){return{isHigher:!1}}},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_LOPTUNNISTUS_TRUKKIMINE]}}).when("/documents/supplements",{templateUrl:"document/supplement.search.html",controller:"SupplementSearchController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],params:function(){return{isHigher:!0}}},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_HINNETELEHT_TRUKKIMINE]}}).when("/documents/supplements/vocational",{templateUrl:"document/supplement.search.html",controller:"SupplementSearchController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],params:function(){return{isHigher:!1}}},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_HINNETELEHT_TRUKKIMINE]}}).when("/documents/supplements/:id",{templateUrl:"document/supplement.html",controller:"SupplementController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],params:function(){return{isHigher:!0}}},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_HINNETELEHT_TRUKKIMINE]}}).when("/documents/supplements/vocational/:id",{templateUrl:"document/supplement.vocational.html",controller:"SupplementController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],params:function(){return{isHigher:!1}}},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_HINNETELEHT_TRUKKIMINE]}})}]),angular.module("hitsaOis").controller("ExamSearchController",["$q","$route","$scope","$timeout","message","Classifier","DataUtils","QueryUtils","USER_ROLES",function(a,b,c,d,e,f,g,h,i){c.auth=b.current.locals.auth;var j=f.valuemapper({type:"SOORITUS"});h.createQueryForm(c,"/exams",{order:"te.start"},j.objectmapper),c.formState={studyPeriods:h.endpoint("/autocomplete/studyPeriodsWithYear").query(),canAdd:-1!==c.auth.authorizedRoles.indexOf(i.ROLE_OIGUS_M_TEEMAOIGUS_EKSAM)};var k=j.promises;k.push(c.formState.studyPeriods.$promise),a.all(k).then(function(){if(c.formState.studyPeriods.forEach(function(a){a[c.currentLanguageNameField()]=c.currentLanguageNameField(a.studyYear)+" "+c.currentLanguageNameField(a)}),c.formState.studyPeriods.length>0&&!c.criteria.studyPeriod){var a=g.getCurrentStudyYearOrPeriod(c.formState.studyPeriods);c.criteria.studyPeriod=a?a.id:void 0}c.criteria.studyPeriod?d(c.loadData):0===c.formState.studyPeriods.length&&e.error("studyYear.studyPeriod.missing")})}]).controller("ExamStudentRegistrationController",["$q","$rootScope","$scope","$timeout","dialogService","message","Classifier","DataUtils","QueryUtils",function(a,b,c,d,e,f,g,h,i){var j="/exams",k=g.valuemapper({assessment:"HINDAMISVIIS",type:"SOORITUS"});i.createQueryForm(c,j+"/forregistration",{order:"te.start"}),c.afterLoadData=function(a){c.tabledata.content=a.content,c.tabledata.totalElements=a.totalElements,k.objectmapper(a.content)},c.formState={studyPeriods:i.endpoint("/autocomplete/studyPeriods").query()};var l=k.promises;l.push(c.formState.studyPeriods.$promise),a.all(l).then(function(){if(c.formState.studyPeriods.length>0&&!c.criteria.studyPeriod){var a=h.getCurrentStudyYearOrPeriod(c.formState.studyPeriods);c.criteria.studyPeriod=a?a.id:void 0}c.criteria.studyPeriod&&d(c.loadData)}),c.studyPeriodChanged=function(){c.criteria.studyPeriod&&c.loadData()},c.register=function(a){e.confirmDialog({prompt:"exam.message.registerconfirmation",exam:b.currentLanguageNameField(a.subject)},function(){i.endpoint(j+"/register").update({id:a.id}).$promise.then(function(){f.info("exam.message.registered"),c.loadData()})["catch"](angular.noop)})},c.unregister=function(a){e.confirmDialog({prompt:"exam.message.unregisterconfirmation",exam:b.currentLanguageNameField(a.subject)},function(){i.endpoint(j+"/unregister").update({id:a.id}).$promise.then(function(){f.info("exam.message.unregistered"),c.loadData()})["catch"](angular.noop)})}}]).controller("ExamEditController",["$location","$route","$scope","dialogService","message","Classifier","DataUtils","FormUtils","QueryUtils",function(a,b,c,d,e,f,g,h,i){function j(){var a=c.formState.subjectStudyPeriod;a&&c.record.type?s.$promise.then(function(){c.record.name=a.subject.nameEt+" "+(o[c.record.type].nameEt||"").toLowerCase()}):c.record.name=""}function k(){c.formState.allEditable=!c.record.id||!c.record.students||!c.record.students.length,c.formState.canDelete=!c.record.students||!c.record.students.length}function l(){var a=c.record.studentRecords||[];a.forEach(function(a,b){a.rowno=b+1}),c.formState.students=a,delete c.record.studentRecords,c.formState.subjectStudyPeriod=c.record.subjectStudyPeriodDto,delete c.record.subjectStudyPeriodDto,k()}function m(){var a={rooms:c.record.room.id,subjectStudyPeriod:c.record.subjectStudyPeriod,exam:c.record.id},b=moment(c.record.startDate),d=moment(c.record.startTime,"HH:mm"),e=moment(c.record.endTime,"HH:mm");return a.startTime=new Date(b.year(),b.month(),b.date(),d.hours(),d.minutes()),a.endTime=new Date(b.year(),b.month(),b.date(),e.hours(),e.minutes()),a}function n(){c.record.id?(c.record.$update().then(e.updateSuccess).then(l)["catch"](angular.noop),c.examForm.$setPristine()):c.record.$save().then(function(){e.info("main.messages.create.success"),a.url(q+"/"+c.record.id+"/edit?_noback")})["catch"](angular.noop)}c.auth=b.current.locals.auth;var o,p=b.current.params.id,q="/exams",r=i.endpoint(q),s=f.queryForDropdown({mainClassCode:"SOORITUS"});if(s.$promise.then(function(){o=f.toMap(s)}),c.formState={minDate:moment().subtract(1,"days").startOf("day").toDate()},c.examTypeChanged=function(){var a=c.record.type;c.record.id&&a?c.formState.availableStudents=i.endpoint(q+"/studentsforregistration/"+p).query({type:a}):c.formState.availableStudents=[],j()},p?(c.record=r.get({id:p},l),c.record.$promise.then(c.examTypeChanged)):(c.record=new r({students:[],studentRecords:[]}),l()),c.update=function(){h.withValidForm(c.examForm,function(){var a=m();i.endpoint("/timetableevents/timetableTimeOccupied").get(a).$promise.then(function(a){a.occupied?d.confirmDialog(g.occupiedEventTimePrompts(c,c.auth.higher,a),function(){n()}):n()})})},c.getLocalDateTime=function(a){var b=moment(c.record.startDate);return a=moment(a,"HH:mm"),new Date(b.year(),b.month(),b.date(),a.hours(),a.minutes())},c["delete"]=function(){h.deleteRecord(c.record,"/examTimes?_noback",{prompt:"exam.message.deleteconfirm"})},c.lookupStudents=function(a){return a=(a||"").toUpperCase(),c.formState.availableStudents.filter(function(b){return-1!==b.fullname.toUpperCase().indexOf(a)&&-1===c.record.students.indexOf(b.id)})},c.addStudent=function(){var a=c.formState.selectedStudent?c.formState.selectedStudent.id:void 0;if(a){var b=c.formState.availableStudents.find(function(b){return b.id===a});b.rowno=c.formState.students.length+1,c.formState.students.push(b),c.record.students.push(b.id)}c.formState.selectedStudent=void 0,k()},c.deleteStudent=function(a){d.confirmDialog({prompt:"exam.message.deletestudentconfirm"},function(){for(var b=c.formState.students,d=0,e=b.length;e>d;d++)if(b[d]===a){b.splice(d,1);var f=c.record.students.indexOf(a.id);-1!==f&&c.record.students.splice(f,1),c.examForm.$setDirty();break}k()})},!p){var t=i.endpoint("/autocomplete/studyPeriodsWithYear").query({},function(a){a.forEach(function(a){a[c.currentLanguageNameField()]=c.currentLanguageNameField(a.studyYear)+" "+c.currentLanguageNameField(a)})}),u=i.endpoint(q+"/subjectstudyperiods");c.formState.studyPeriods=t,c.formState.subjectStudyPeriods=[],c.studyPeriodChanged=function(){if(c.formState.studyPeriod){var a={studyPeriod:c.formState.studyPeriod};c.formState.subjectStudyPeriods=u.query(a)}else c.formState.subjectStudyPeriods=[];c.formState.subjectStudyPeriodId=void 0,c.formState.subjectStudyPeriod=void 0,c.record.subjectStudyPeriod=void 0,c.subjectStudyPeriodChanged()},t.$promise.then(function(){if(t.length>0){var a=g.getCurrentStudyYearOrPeriod(t);c.formState.studyPeriod=a?a.id:void 0}c.studyPeriodChanged()}),c.subjectStudyPeriodChanged=function(){if(c.formState.subjectStudyPeriodId){var a=c.formState.subjectStudyPeriods.find(function(a){return a.id===c.formState.subjectStudyPeriodId});c.formState.subjectStudyPeriod=a,c.record.subjectStudyPeriod=a.id}j()}}}]).controller("ExamViewController",["$route","$scope","QueryUtils",function(a,b,c){var d=c.endpoint("/exams"),e=a.current.params.id;b.formState={},b.record=d.get({id:e},function(){b.record.studentRecords.forEach(function(a,b){a.rowno=b+1})})}]),angular.module("hitsaOis").config(["$routeProvider","USER_ROLES",function(a,b){a.when("/examTimes",{templateUrl:"exam/search.html",controller:"ExamSearchController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:function(a,c){return("ROLL_A"===a.roleCode||"ROLL_O"===a.roleCode)&&a.higher&&-1!==c.indexOf(b.ROLE_OIGUS_V_TEEMAOIGUS_EKSAM)}}}).when("/examRegistration",{templateUrl:"exam/registration.student.html",controller:"ExamStudentRegistrationController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:function(a){return"ROLL_T"===a.roleCode&&a.higher}}}).when("/exams/new",{templateUrl:"exam/edit.html",controller:"ExamEditController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:function(a,c){return("ROLL_A"===a.roleCode||"ROLL_O"===a.roleCode)&&-1!==c.indexOf(b.ROLE_OIGUS_M_TEEMAOIGUS_EKSAM)}}}).when("/exams/:id/edit",{templateUrl:"exam/edit.html",controller:"ExamEditController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_EKSAM]}}).when("/exams/:id/view",{templateUrl:"exam/view.html",controller:"ExamViewController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_EKSAM]}})}]),angular.module("hitsaOis").config(["$routeProvider","USER_ROLES",function(a,b){a.when("/thesisProtocols",{templateUrl:"fakePages/fake.html",controller:"fakeController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_LOPPROTOKOLL]}}).when("/viewTimetable",{templateUrl:"fakePages/fake.html",controller:"fakeController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_TUNNIPLAAN]}}).when("/thesisTopicInput",{templateUrl:"fakePages/fake.html",controller:"fakeController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_LOPTEEMA]}}).when("/myData",{templateUrl:"fakePages/fake.html",controller:"fakeController",controllerAs:"controller",resolve:{translationLoaDed:["$translate",function(a){return a.onReady()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_OPETAJA,b.ROLE_OIGUS_V_TEEMAOIGUS_OPPUR]}}).when("/timetable",{templateUrl:"fakePages/fake.html",controller:"fakeController",controllerAs:"controller",resolve:{translationLoaDed:["$translate",function(a){return a.onReady()}]},data:{authorizedRoles:[]}}).when("/myTimetable",{templateUrl:"fakePages/fake.html",controller:"fakeController",controllerAs:"controller",resolve:{translationLoaDed:["$translate",function(a){return a.onReady()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_TUNNIPLAAN]}}).when("/loads",{templateUrl:"fakePages/fake.html",controller:"fakeController",controllerAs:"controller",resolve:{translationLoaDed:["$translate",function(a){return a.onReady()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_KOORMUS]}}).when("/studentInfo",{templateUrl:"fakePages/fake.html",controller:"fakeController",controllerAs:"controller",resolve:{translationLoaDed:["$translate",function(a){return a.onReady()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_A]}})}]).controller("fakeController",["$scope","QueryUtils",function(a,b){b.endpoint("/fake/get505Error").search()}]),angular.module("hitsaOis").controller("FormSearchController",["$q","$route","$scope","Classifier","QueryUtils","USER_ROLES","message",function(a,b,c,d,e,f,g){var h="/forms",i=b.current.locals.auth;c.canEdit=-1!==i.authorizedRoles.indexOf(f.ROLE_OIGUS_M_TEEMAOIGUS_LOPBLANKETT);var j=d.valuemapper({type:"LOPUBLANKETT",status:"LOPUBLANKETT_STAATUS"});e.createQueryForm(c,h,{},j.objectmapper),c.criteria={},c.afterLoadData=function(a){c.tabledata.content=a,0===a.length&&g.info("main.messages.error.notFound"),j.objectmapper(a)},c.loadData=function(){var a=c.getCriteria();c.toStorage(h,a),c.tabledata.$promise=e.endpoint(h).query(a,c.afterLoadData)},c.formState={xlsUrl:"forms/forms.xls"},a.all(j.promises).then(function(){c.loadData()})}]).controller("FormEditController",["$route","$scope","message","Classifier","FormUtils","QueryUtils","dialogService",function(a,b,c,d,e,f,g){var h="/forms";b.auth=a.current.locals.auth,b.actionType=a.current.params.action,b.getButtonLabelKey=function(){return"delete"===b.actionType?"main.button.delete":"defected"===b.actionType?"form.button.defected":"main.button.save"},b.formState={},b.update=function(){e.withValidForm(b.formForm,function(){"delete"===b.actionType||"defected"===b.actionType?g.confirmDialog({prompt:"form.confirm."+b.actionType,from:b.formState.from,thru:b.formState.thru},function(){f.endpoint(h+"/"+b.actionType).save(b.formState,function(){"delete"===b.actionType?c.info("main.messages.delete.success"):"defected"===b.actionType&&c.updateSuccess(),b.formForm.$setPristine()}).$promise["catch"](angular.noop)}):f.endpoint(h+"/"+b.actionType).save(b.formState,function(){c.updateSuccess(),b.formForm.$setPristine()}).$promise["catch"](angular.noop)})}}]),angular.module("hitsaOis").config(["$routeProvider","USER_ROLES",function(a,b){a.when("/forms",{templateUrl:"form/form.list.html",controller:"FormSearchController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_LOPBLANKETT]}}).when("/forms/:action",{templateUrl:"form/form.edit.html",controller:"FormEditController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_LOPBLANKETT]}})}]),angular.module("hitsaOis").controller("GeneralMessageSearchController",["$scope","$sessionStorage","Classifier","DataUtils","QueryUtils","USER_ROLES","AuthService","$route",function(a,b,c,d,e,f,g,h){a.auth=h.current.locals.auth,a.canEdit=g.isAuthorized(f.ROLE_OIGUS_M_TEEMAOIGUS_YLDTEADE)||a.auth.isMainAdmin(),a.roleDefs=c.queryForDropdown({mainClassCode:"ROLL"}),a.fromStorage=function(a){var c=JSON.parse(b[a]||"{}");return d.convertStringToDates(c,["validFrom","validThru"]),c};var i=new Date;i.setHours(0,0,0,0),e.createQueryForm(a,"/generalmessages"+(a.auth.isMainAdmin()?"/site":""),{validFrom:a.auth.isMainAdmin()?void 0:i,order:a.auth.isMainAdmin()?"-validFrom":"validFrom"},function(b){for(var c=function(b){return a.roleDefs[b]},d=0;d<b.length;d++){var e=b[d];e.targets=(e.targets||[]).map(c)}}),a.roleDefs.$promise.then(function(){a.roleDefs=c.toMap(a.roleDefs),a.loadData()})}]).controller("GeneralMessageEditController",["$location","$route","$scope","dialogService","message","Classifier","DataUtils","QueryUtils",function(a,b,c,d,e,f,g,h){function i(){f.setSelectedCodes(c.roleDefs,c.record.targets||[]),g.convertStringToDates(c.record,["validFrom","validThru"])}var j=b.current.params.id,k="/generalmessages";c.auth=b.current.locals.auth,f.queryForDropdown({mainClassCode:"ROLL",filterValues:["ROLL_H","ROLL_P","ROLL_V"]}).$promise.then(function(a){c.roleDefs=a;var b=h.endpoint(k);if(j)c.record=b.get({id:j},i);else{var d=new Date;d.setHours(0,0,0,0),c.record=new b({validFrom:d,validThru:null}),i()}}),c.targetChanged=function(){c.generalMessageForm.$submitted&&c.generalMessageForm.$setPristine()},c.isFormValid=function(){return c.generalMessageForm.$valid},c.update=function(){return c.generalMessageForm.$setSubmitted(),c.record.targets=f.getSelectedCodes(c.roleDefs),!c.isFormValid()||0===c.record.targets.length&&!c.auth.isMainAdmin()?void e.error("main.messages.form-has-errors"):void(c.record.id?(c.record.$update(i).then(e.updateSuccess),c.generalMessageForm.$setPristine()):c.record.$save(i).then(function(){e.info("main.messages.create.success"),a.url(k+"/"+c.record.id+"/edit?_noback")}))},c["delete"]=function(){d.confirmDialog({prompt:"generalmessage.deleteconfirm"},function(){c.record.$delete().then(function(){e.info("main.messages.delete.success"),a.url(k)})})}}]).controller("GeneralMessageViewController",["$route","$scope","QueryUtils","USER_ROLES","AuthService",function(a,b,c,d,e){var f=a.current.params.id;b.auth=a.current.locals.auth,b.canEdit=e.isAuthorized(d.ROLE_OIGUS_M_TEEMAOIGUS_YLDTEADE)||b.auth.isMainAdmin(),b.record=c.endpoint("/generalmessages").get({id:f})}]),angular.module("hitsaOis").config(["$routeProvider","USER_ROLES",function(a,b){function c(a,c){return c.indexOf(b.ROLE_OIGUS_M_TEEMAOIGUS_YLDTEADE)||"ROLL_P"===a.roleCode}function d(a,c){return c.indexOf(b.ROLE_OIGUS_M_TEEMAOIGUS_YLDTEADE)||"ROLL_P"===a.roleCode}a.when("/generalmessages",{templateUrl:"generalMessage/general.message.list.html",controller:"GeneralMessageSearchController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:d}}).when("/generalmessages/new",{templateUrl:"generalMessage/general.message.edit.html",controller:"GeneralMessageEditController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:c}}).when("/generalmessages/:id/edit",{templateUrl:"generalMessage/general.message.edit.html",controller:"GeneralMessageEditController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:c}}).when("/generalmessages/:id/view",{templateUrl:"generalMessage/general.message.view.html",controller:"GeneralMessageViewController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:d}})}]),angular.module("hitsaOis").controller("HigherCurriculumController",["$scope","Classifier","Curriculum","dialogService","ArrayUtils","message","$route","$location","QueryUtils","oisFileService","DataUtils","$rootScope","config","Session",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){function o(){M?i.endpoint("/curriculum/schoolDepartments/"+M).query().$promise.then(function(b){a.schoolDepartments=b}):C()}function p(){i.endpoint("/curriculum/studyLevels").query({curriculum:M,isHigher:!0}).$promise.then(function(b){a.studyLevels=b})}function q(){a.jointPartnersEhisSchools=[],a.myEhisSchool=a.curriculum.id?a.curriculum.ehisSchool:n.school.ehisSchool,a.jointPartnersEhisSchools.push(a.myEhisSchool),a.curriculum.jointPartners.forEach(function(b){b.ehisSchool&&a.jointPartnersEhisSchools.push(b.ehisSchool)})}function r(){k.convertStringToDates(a.curriculum,["validFrom","validThru","approval","ehisChanged","accreditationDate","accreditationValidDate","merRegDate"]),s(),a.getAreasOfStudy(),G(),E(),a.formState.jointDisabled=D(),q(),a.curriculum.abroad=!1,a.formState.notEditableBasicData=a.curriculum.status===c.STATUS.VERIFIED,a.formState.sentToEhis="OPPEKAVA_EHIS_STAATUS_A"===a.curriculum.ehisStatus||"OPPEKAVA_EHIS_STAATUS_M"===a.curriculum.ehisStatus,a.formState.strictValidation=!1}function s(){var b=12;a.curriculum.studyPeriodYears=Math.floor(a.curriculum.studyPeriod/b),a.curriculum.studyPeriodMonths=a.curriculum.studyPeriod%b}function t(){return a.higherCurriculumForm.$valid&&(!a.strictValidation()||a.curriculum.specialities.length>0&&a.jointPartnersAdded())}function u(){if(a.curriculum.joint){if(P(),w()){var b={abroad:a.curriculum.abroad,supervisor:a.curriculum.supervisor,contractEt:a.curriculum.contractEt,contractEn:a.curriculum.contractEn};a.curriculum.jointPartners.push(b)}}else v()}function v(){a.curriculum.abroad=!1,a.curriculum.jointPartners=[],a.curriculum.supervisor=void 0,a.curriculum.jointMentor=void 0,a.curriculum.contractEt=void 0,a.curriculum.contractEn=void 0}function w(){return e.isEmpty(a.curriculum.jointPartners)&&(angular.isDefined(a.curriculum.supervisor)||angular.isDefined(a.curriculum.contractEt)||angular.isDefined(a.curriculum.contractEn))}function x(b){if(a.higherCurriculumForm.$setSubmitted(),!t()){var c=b&&b.errorMessage?b.errorMessage:"main.messages.form-has-errors";return f.error(c),!1}if(a.strictValidation()){if(!a.hasRequiredFiles())return f.error("curriculum.error.noSummaryFile"),!1;if(!a.hasVerifiedVersions())return f.error("curriculum.error.noVersion"),!1}return!0}function y(){a.formState.readOnly||h.path("/higherCurriculum/"+a.curriculum.id+"/view")}function z(){u(),B(),a.curriculum.studyPeriodMonths=a.curriculum.studyPeriodMonths?a.curriculum.studyPeriodMonths:0,a.curriculum.studyPeriod=a.curriculum.studyPeriodMonths+12*a.curriculum.studyPeriodYears}function A(b){x(b)&&(z(),a.curriculum.id?a.curriculum.$update().then(function(){var c=b&&b.updateSuccess?b.updateSuccess:"main.messages.create.success";f.info(c),r(),a.higherCurriculumForm.$setPristine()}):(a.curriculum.newFiles=a.curriculum.files,a.curriculum.files=void 0,a.curriculum.$save().then(function(a){f.info("main.messages.create.success"),h.path("/higherCurriculum/"+a.id+"/edit")})))}function B(){a.gradeRequired()||(a.curriculum.grades=[])}function C(){i.endpoint("/curriculum/schoolDepartments").query({ehisShools:a.jointPartnersEhisSchools,curriculum:M}).$promise.then(function(b){if(a.schoolDepartments=b,a.curriculum.schoolDepartments){var c=b.map(function(a){return a.id});a.curriculum.schoolDepartments=a.curriculum.schoolDepartments.filter(function(a){return e.includes(c,a)})}})}function D(){return!a.curriculum.joint||e.isEmpty(a.curriculum.jointPartners)?!1:a.curriculum.jointPartners.some(function(a){return a.hasSubjects})}function E(){a.curriculum.jointPartners&&a.curriculum.jointPartners.length>0&&(a.curriculum.abroad=!1,a.curriculum.contractEt=a.curriculum.jointPartners[0].contractEt,a.curriculum.contractEn=a.curriculum.jointPartners[0].contractEn,a.curriculum.supervisor=a.curriculum.jointPartners[0].supervisor,1!==a.curriculum.jointPartners.length||a.curriculum.jointPartners[0].ehisSchool||a.curriculum.jointPartners[0].nameEt||a.curriculum.jointPartners[0].nameEn||(a.curriculum.jointPartners=[]))}function F(b){return e.contains(a.curriculum.addresses.map(function(a){return a.addressOv}),b.addressOv)}function G(){angular.isArray(a.curriculum.addresses)&&(a.validation.addressesLength=a.curriculum.addresses.length)}function H(b,c,g,h){d.confirmDialog({prompt:"curriculum.itemDeleteConfirm"},function(){c.data.id?new h(c.data).$delete().then(function(){f.info("main.messages.delete.success"),e.remove(b,g)}):(e.remove(b,g),a.higherCurriculumForm.$setDirty()),c.cancel()})}function I(b,c,d,e){if(a.curriculum.id){var g=new b(c);c.id?g.$update().then(function(a){f.info("main.messages.update.success"),angular.extend(e,a)}):g.$save().then(function(a){f.info("main.messages.create.success"),d.push(a)})}else e?angular.extend(e,c):d.push(c),a.higherCurriculumForm.$setDirty()}function J(b,c){new b(a.curriculum).$update().then(function(b){a.curriculum=b,f.info(c.updateSuccess),r(),y(),a.higherCurriculumForm.$setPristine()})}a.auth=g.current.locals.auth,a.STATUS=c.STATUS,a.maxStydyYears={max:100};var K,L="/curriculum",M=g.current.params.id;a.publicUrl=m.apiUrl+"/public/curriculum/"+M+"?format=json",a.formState={readOnly:-1!==g.current.$$route.originalPath.indexOf("view"),curriculumXmlUrl:m.apiUrl+L+"/xml/"+M+"/curriculum.xml",strictValidation:!1},o(),a.removeFromArray=function(a,b){d.confirmDialog({prompt:"curriculum.itemDeleteConfirm"},function(){e.remove(a,b)})};var N=i.endpoint(L),O={files:[],specialities:[],grades:[],studyLanguages:[],departments:[],versions:[],addresses:[],jointPartners:[],higher:!0,status:c.STATUS.ENTERING,consecution:"OPPEKAVA_TYPE_E",draft:"OPPEKAVA_LOOMISE_VIIS_PUUDUB",joint:!1,abroad:!1,studyPeriodMonths:0,validFrom:new Date};a.validation={addressesLength:0},a.studyLevels=[],p(),a.areasOfStudy=[],a.getAreasOfStudy=function(b){b&&(a.curriculum.areaOfStudy=void 0),a.curriculum.group&&c.getAreasOfStudyByGroupOfStudy(a.curriculum.group,function(b){a.areasOfStudy=b})},M?N.get({id:M}).$promise.then(function(b){K=i.endpoint(L+"/"+M+"/file"),a.curriculum=b,r(),l.removeLastUrlFromHistory(function(b){return b==="#/higherCurriculum/"+a.curriculum.id+"/view"||b==="#/higherCurriculum/"+a.curriculum.id+"/edit"||"#/higherCurriculum/new"===b})}):(a.curriculum=new N(O),q(),a.formState.curriculum={status:a.curriculum.status}),a.gradeRequired=function(){return!a.curriculum||!a.curriculum.origStudyLevel||"OPPEASTE_514"!==a.curriculum.origStudyLevel},a.jointPartnersAdded=function(){return!a.curriculum.joint||a.curriculum.jointPartners.length>0},a.codeUniqueQuery={id:M,url:L+"/unique/code"},a.merCodeUniqueQuery={id:M,url:L+"/unique/merCode"},a.hasRequiredFiles=function(){var b=a.curriculum.files;return e.isEmpty(b)?!1:!e.isEmpty(b.filter(function(a){return"EHIS_FAIL_15773"===a.ehisFile&&a.sendEhis===!0&&a.oisFile&&"application/pdf"===a.oisFile.ftype}))},a.hasVerifiedVersions=function(){var b=a.curriculum.versions;return e.isEmpty(b)?!1:!e.isEmpty(b.filter(function(a){return a.status===c.VERSION_STATUS.K}))},a.save=function(){a.formState.strictValidation=!1,setTimeout(A,0)},a.getStar=function(){return a.strictValidation()?"":" *"},a.strictValidation=function(){return a.curriculum&&(a.curriculum.status===c.STATUS.VERIFIED||a.curriculum.status===c.STATUS.PROCEEDING||a.formState.strictValidation)},a.changeJointMentors=function(){a.curriculum.abroad&&(a.jointPartnersEhisSchools=[])},a["delete"]=function(){d.confirmDialog({prompt:"curriculum.deleteconfirmHigher"},function(){a.curriculum.$delete().then(function(){f.info("main.messages.delete.success"),h.path(L)})})},a.$watch("curriculum.joint",function(a,b){b&&!a&&(v(),q(),C())}),a.removejointPartner=function(b){d.confirmDialog({prompt:"curriculum.itemDeleteConfirm"},function(){e.remove(a.curriculum.jointPartners,b),b.abroad||(e.remove(a.jointPartnersEhisSchools,b.ehisSchool),a.curriculum.jointMentor===b.ehisSchool&&(a.curriculum.jointMentor=void 0)),a.higherCurriculumForm.$setDirty(),C()})},a.addJointPartner=function(){var b={abroad:a.curriculum.abroad};if(b.abroad)b.nameEt=a.curriculum.jointPartnerForeignNameEt,b.nameEn=a.curriculum.jointPartnerForeignNameEn;else{for(var c=0;c<a.jointPartnersEhisSchools.length;c++)if(-1!==a.jointPartnersEhisSchools.indexOf(a.curriculum.jointPartnerEhisSchool))return void a.clearJointPartnersFields();b.ehisSchool=a.curriculum.jointPartnerEhisSchool,
a.jointPartnersEhisSchools.push(b.ehisSchool)}a.curriculum.jointPartners.push(b),a.clearJointPartnersFields(),C()};var P=function(){a.curriculum.jointPartners.forEach(function(b){b.contractEt=a.curriculum.contractEt,b.contractEn=a.curriculum.contractEn,b.supervisor=a.curriculum.supervisor})};a.clearJointPartnersFields=function(){a.curriculum.jointPartnerForeignNameEt=void 0,a.curriculum.jointPartnerForeignNameEn=void 0,a.curriculum.jointPartnerEhisSchool=void 0},a.filterEmptyJointPartners=function(a){return a.ehisSchool||a.nameEt||a.nameEn},a.addAddress=function(){return F(a.formState.address)?void f.error("curriculum.error.addressAlreadyAdded"):(a.curriculum.addresses.push(a.formState.address),a.formState.address={},void G())},a.removeAddress=function(b){d.confirmDialog({prompt:"curriculum.itemDeleteConfirm"},function(){e.remove(a.curriculum.addresses,b),a.higherCurriculumForm.$setDirty(),G()})},a.openAddSpecialtyDialog=function(b){var c=function(c){b&&(c.data=angular.extend({},b)),c.maxCredits=a.curriculum.credits?a.curriculum.credits:0,c.formState={isNew:!angular.isDefined(b)},c["delete"]=function(){return c.data.addedToVersion?void f.error("curriculum.error.specAddedToVersion"):(H(a.curriculum.specialities,c,b,i.endpoint("/curriculum/"+a.curriculum.id+"/speciality")),void a.higherCurriculumForm.$setDirty())}};d.showDialog("higherCurriculum/higher.curriculum.specialty.add.dialog.html",c,function(c){var d=c.data;d.occupation||(d.occupationEt=void 0,d.occupationEn=void 0),I(i.endpoint("/curriculum/"+a.curriculum.id+"/speciality"),d,a.curriculum.specialities,b)})},a.openViewSpecialtyDialog=function(a){var b=function(b){b.data=angular.extend({},a)};d.showDialog("higherCurriculum/higher.curriculum.specialty.view.dialog.html",b,null)},a.openAddGradeDialog=function(b){var c=null;b&&(c=function(c){c.data=angular.extend({},b),c.editing=angular.isDefined(b),c["delete"]=function(){H(a.curriculum.grades,c,b,i.endpoint("/curriculum/"+a.curriculum.id+"/grade"))}}),d.showDialog("higherCurriculum/higher.curriculum.grade.add.dialog.html",c,function(c){var d=c.data;I(i.endpoint("/curriculum/"+a.curriculum.id+"/grade"),d,a.curriculum.grades,b)})},a.openViewGradeDialog=function(a){var b=function(b){b.data=angular.extend({},a)};d.showDialog("higherCurriculum/higher.curriculum.grade.view.dialog.html",b,null)},a.openAddFileDialog=function(){d.showDialog("curriculum/dialog/file.add.dialog.html",function(a){a.fileTypeCriteria={higher:!0}},function(b){var c=b.data;c.sendEhis=!1,c.ehis=!1,c.oisFile=j.getFromLfFile(c.file[0],function(b){c.oisFile=b;var d=new K(c);d.$save().then(function(b){f.info("main.messages.create.success"),a.curriculum.files.push(b)})})})},a.deleteFile=function(b){d.confirmDialog({prompt:"curriculum.itemDeleteConfirm"},function(){e.remove(a.curriculum.files,b);var c=new K(b);c.$delete().then(function(){f.info("main.messages.delete.success")})})},a.getUrl=j.getUrl,a.saveAndProceed=function(){var b={prompt:"curriculum.statuschange.higher.proceed",errorMessage:"curriculum.error.inputFieldsNotFilledOnProcede",updateSuccess:"curriculum.success.proceed"};a.formState.strictValidation=!0,d.confirmDialog({prompt:b.prompt},function(){setTimeout(function(){if(x(b)){z();var a=i.endpoint("/curriculum/saveAndProceed");J(a,b)}},0)})},a.changeStatusUnderRevision=function(){var a={updateSuccess:"curriculum.success.opened"};d.confirmDialog({prompt:"curriculum.prompt.setStatusUnderRevision"},function(){setTimeout(function(){var b=i.endpoint(L+"/underrevision");J(b,a)})})},a.setStatusClosed=function(){var b={prompt:a.formState.readOnly?"curriculum.statuschangeReadOnly.higher.close":"curriculum.statuschange.higher.close",updateSuccess:"curriculum.success.closed"};d.confirmDialog({prompt:b.prompt},function(){var a=i.endpoint("/curriculum/close");J(a,b)})},a.sendToEhis=function(a){d.confirmDialog({prompt:"curriculum.ehisconfirm"},function(){var b=i.endpoint("/curriculum/sendToEhis"+(a?"/test":""));J(b,{updateSuccess:"curriculum.sentToEhis"})})},a.updateFromEhis=function(a){var b=i.endpoint("/curriculum/updateFromEhis"+(a?"/test":""));J(b,{updateSuccess:"curriculum.message.ehisStatusUpdated"})},a.goToEditForm=function(){a.curriculum&&(a.curriculum.status===c.STATUS.VERIFIED?d.confirmDialog({prompt:"curriculum.prompt.editAccepted"},function(){h.path("/higherCurriculum/"+a.curriculum.id+"/edit")}):h.path("/higherCurriculum/"+a.curriculum.id+"/edit"))},a.canBeEdited=function(){var b=a.curriculum?a.curriculum.status:null;return a.formState.readOnly&&(b===c.STATUS.ENTERING||b===c.STATUS.PROCEEDING||b===c.STATUS.VERIFIED)},a.goToVersionNewForm=function(){var b="/higherCurriculum/"+a.curriculum.id+"/version/new";!a.formState.readOnly&&a.higherCurriculumForm.$dirty?d.confirmDialog({prompt:"main.messages.confirmFormDataNotSaved"},function(){h.path(b)}):h.path(b)},a.goToVersionForm=function(b){var e=a.formState.readOnly||b.status!==c.VERSION_STATUS.S?"/higherCurriculum/"+a.curriculum.id+"/version/"+b.id+"/view":"/higherCurriculum/"+a.curriculum.id+"/version/"+b.id+"/edit";!a.formState.readOnly&&a.higherCurriculumForm.$dirty?d.confirmDialog({prompt:"main.messages.confirmFormDataNotSaved"},function(){h.path(e)}):h.path(e)},a.versionCanBeAdded=function(){return a.curriculum&&a.curriculum.canChange&&(a.curriculum.status===c.STATUS.ENTERING&&!a.formState.readOnly||a.curriculum.status===c.STATUS.PROCEEDING||a.curriculum.status===c.STATUS.VERIFIED)},a.searchTeacher=function(a){return i.endpoint("/curriculum/teachers").query({name:a}).$promise}}]),angular.module("hitsaOis").config(["$routeProvider","USER_ROLES",function(a,b){function c(a,b,c,d,e){d.resolve().then(function(d){d.isAdmin()&&c.includes(d.authorizedRoles,e.ROLE_OIGUS_M_TEEMAOIGUS_OPPEKAVA)||(a.error("main.messages.error.nopermission"),b.path(""))})}c.$inject=["message","$location","ArrayUtils","AuthResolver","USER_ROLES"],a.when("/higherCurriculum/new",{templateUrl:"higherCurriculum/higher.curriculum.html",controller:"HigherCurriculumController",controllerAs:"controller",resolve:{auth:["AuthResolver",function(a){return a.resolve()}],translationLoaded:["$translate",function(a){return a.onReady()}],checkAccess:c},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_OPPEKAVA]}}).when("/higherCurriculum/:id/edit",{templateUrl:"higherCurriculum/higher.curriculum.html",controller:"HigherCurriculumController",controllerAs:"controller",resolve:{auth:["AuthResolver",function(a){return a.resolve()}],translationLoaded:["$translate",function(a){return a.onReady()}],checkAccess:c},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_OPPEKAVA]}}).when("/higherCurriculum/:id/view",{templateUrl:"higherCurriculum/higher.curriculum.view.html",controller:"HigherCurriculumController",controllerAs:"controller",resolve:{auth:["AuthResolver",function(a){return a.resolve()}],translationLoaded:["$translate",function(a){return a.onReady()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_OPPEKAVA]}}).when("/higherCurriculum/:id/version/new",{templateUrl:"higherCurriculum/higher.curriculum.version.html",controller:"HigherCurriculumVersionController",controllerAs:"controller",resolve:{auth:["AuthResolver",function(a){return a.resolve()}],translationLoaded:["$translate",function(a){return a.onReady()}],curriculum:["QueryUtils","$route",function(a,b){return a.endpoint("/curriculumVersion/curriculum").get({id:b.current.params.id}).$promise}],checkAccess:c},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_OPPEKAVA]}}).when("/higherCurriculum/:id/version/:versionId/edit",{templateUrl:"higherCurriculum/higher.curriculum.version.html",controller:"HigherCurriculumVersionController",controllerAs:"controller",resolve:{auth:["AuthResolver",function(a){return a.resolve()}],translationLoaded:["$translate",function(a){return a.onReady()}],curriculum:["QueryUtils","$route",function(a,b){return a.endpoint("/curriculumVersion/curriculum").get({id:b.current.params.id}).$promise}],checkAccess:c},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_OPPEKAVA]}}).when("/higherCurriculum/:id/version/:versionId/view",{templateUrl:"higherCurriculum/higher.curriculum.version.view.html",controller:"HigherCurriculumVersionController",controllerAs:"controller",resolve:{auth:["AuthResolver",function(a){return a.resolve()}],translationLoaded:["$translate",function(a){return a.onReady()}],curriculum:["QueryUtils","$route",function(a,b){return a.endpoint("/curriculumVersion/curriculum").get({id:b.current.params.id}).$promise}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_OPPEKAVA]}}).when("/higherCurriculum/:curriculumId/version/:versionId/module/new",{templateUrl:"higherCurriculum/version/higher.module.edit.html",controller:"HigherModuleController",controllerAs:"controller",resolve:{auth:["AuthResolver",function(a){return a.resolve()}],translationLoaded:["$translate",function(a){return a.onReady()}],checkAccess:c},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_OPPEKAVA]}}).when("/higherCurriculum/:curriculumId/version/:versionId/module/:id/edit",{templateUrl:"higherCurriculum/version/higher.module.edit.html",controller:"HigherModuleController",controllerAs:"controller",resolve:{auth:["AuthResolver",function(a){return a.resolve()}],translationLoaded:["$translate",function(a){return a.onReady()}],checkAccess:c},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_OPPEKAVA]}}).when("/higherCurriculum/:curriculumId/version/:versionId/module/:id/view",{templateUrl:"higherCurriculum/version/higher.module.view.html",controller:"HigherModuleController",controllerAs:"controller",resolve:{auth:["AuthResolver",function(a){return a.resolve()}],translationLoaded:["$translate",function(a){return a.onReady()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_OPPEKAVA]}}).when("/higherCurriculum/:curriculumId/version/:versionId/minorSpeciality/new",{templateUrl:"higherCurriculum/version/minor.speciality.edit.html",controller:"MinorSpecialityController",controllerAs:"controller",resolve:{auth:["AuthResolver",function(a){return a.resolve()}],translationLoaded:["$translate",function(a){return a.onReady()}],checkAccess:c},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_OPPEKAVA]}}).when("/higherCurriculum/:curriculumId/version/:versionId/minorSpeciality/:id/edit",{templateUrl:"higherCurriculum/version/minor.speciality.edit.html",controller:"MinorSpecialityController",controllerAs:"controller",resolve:{auth:["AuthResolver",function(a){return a.resolve()}],translationLoaded:["$translate",function(a){return a.onReady()}],checkAccess:c},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_OPPEKAVA]}}).when("/higherCurriculum/:curriculumId/version/:versionId/minorSpeciality/:id/view",{templateUrl:"higherCurriculum/version/minor.speciality.view.html",controller:"MinorSpecialityController",controllerAs:"controller",resolve:{auth:["AuthResolver",function(a){return a.resolve()}],translationLoaded:["$translate",function(a){return a.onReady()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_OPPEKAVA]}})}]),angular.module("hitsaOis").controller("HigherCurriculumVersionController",["$scope","Curriculum","dialogService","ArrayUtils","message","$route","$location","QueryUtils","$translate","$rootScope","$routeParams","DataUtils","config",function(a,b,c,d,e,f,g,h,i,j,k,l,m){function n(){l.convertStringToDates(a.version,["validFrom","validThru"]),a.years=[],a.mappedSubjects={},a.version.modules.forEach(function(b){for(var c=0;c<b.subjects.length;c++)null!==b.subjects[c].studyYearNumber&&(a.mappedSubjects[b.subjects[c].studyYearNumber]||(a.years.push(b.subjects[c].studyYearNumber),a.mappedSubjects[b.subjects[c].studyYearNumber]=[]),a.mappedSubjects[b.subjects[c].studyYearNumber].push(b.subjects[c]))}),a.formState.curriculumPdfUrl=m.apiUrl+A+"/print/"+a.version.id+"/curriculum.pdf",a.formState.curriculumXmlUrl=m.apiUrl+A+"/xml/"+a.version.id+"/curriculum.version.xml"}function o(){a.admissionYears=[null];for(var b=(new Date).getFullYear(),c=b-10;b+2>=c;c++)a.admissionYears.push(c)}function p(b){if(a.higherCurriculumVersionForm.$setSubmitted(),!t()){var c=b&&b.errorMessage?b.errorMessage:"main.messages.form-has-errors";return e.error(c),!1}return!0}function q(b){if(p(b)){var c=new E(a.version);angular.isDefined(a.version.id)?c.$update().then(function(c){var d=b&&b.updateSuccess?b.updateSuccess:"main.messages.create.success";e.info(d),a.version=c,l.convertStringToDates(a.version,["validFrom","validThru"]),a.higherCurriculumVersionForm.$setPristine()}):c.$save().then(function(b){e.info("main.messages.create.success"),g.path("/higherCurriculum/"+a.version.curriculum+"/version/"+b.id+"/edit")})}}function r(b,d){p(d)&&setTimeout(function(){c.confirmDialog({prompt:d.prompt},function(){new b(a.version).$update().then(function(b){var c=d&&d.updateSuccess?d.updateSuccess:"main.messages.create.success";e.info(c),a.version=b,l.convertStringToDates(a.version,["validFrom","validThru"]),a.version.curriculum=a.curriculum.id,a.formState.strictValidation=!1,s(b),a.higherCurriculumVersionForm.$setPristine()})})},0)}function s(b){a.formState.readOnly||g.path("/higherCurriculum/"+a.version.curriculum+"/version/"+b.id+"/view")}function t(){return a.higherCurriculumVersionForm.$valid&&(a.versionIsValid()||!a.strictValidation())}function u(b){return a.version.modules.filter(function(a){return!a.minorSpeciality&&d.includes(a.curriculumSpecialities,b)})}function v(a){D.get({id:a.id}).$promise.then(function(b){a.totalCredits=b.totalCredits,a.compulsoryStudyCredits=b.compulsoryStudyCredits})}function w(a,b){return!angular.isDefined(a)&&angular.isDefined(b)||angular.isDefined(a)&&angular.isDefined(b)&&a.length<b.length}function x(a,b){if(!angular.isDefined(a))return b;for(var c=[],e=0;e<b.length;e++)d.contains(a,b[e])||c.push(b[e]);return c}function y(b){var c="";c=b?a.formState.readOnly||!a.version.canChange?"/higherCurriculum/"+a.curriculum.id+"/version/"+a.version.id+"/module/"+b.id+"/view":"/higherCurriculum/"+a.curriculum.id+"/version/"+a.version.id+"/module/"+b.id+"/edit":"/higherCurriculum/"+a.curriculum.id+"/version/"+a.version.id+"/module/new",g.path(c)}function z(b){var c="";c=b?a.formState.readOnly||!a.version.canChange?"/higherCurriculum/"+a.curriculum.id+"/version/"+a.version.id+"/minorSpeciality/"+b.id+"/view":"/higherCurriculum/"+a.curriculum.id+"/version/"+a.version.id+"/minorSpeciality/"+b.id+"/edit":"/higherCurriculum/"+a.curriculum.id+"/version/"+a.version.id+"/minorSpeciality/new",g.path(c)}a.auth=f.current.locals.auth;var A="/curriculum";a.curriculum=f.current.locals.curriculum,a.formState={readOnly:-1!==f.current.$$route.originalPath.indexOf("view"),strictValidation:!1};var B=h.endpoint("/curriculum/"+a.curriculum.id+"/speciality"),C=h.endpoint("/higherModule/subject"),D=h.endpoint("/higherModule/credits"),E=h.endpoint("/curriculumVersion"),F=f.current.params.versionId;a.STATUS=b.STATUS,a.VERSION_STATUS=b.VERSION_STATUS;var G={status:a.VERSION_STATUS.S,validFrom:new Date,code:a.curriculum.code+"/"+(new Date).getFullYear(),curriculum:a.curriculum.id,modules:[],canChange:!0};a.years=[],a.mappedSubjects={},F?(a.version=E.get({id:F}).$promise.then(function(b){a.version=b,n(),j.removeLastUrlFromHistory(function(b){return b&&-1!==b.indexOf("#/higherCurriculum/"+a.version.curriculum+"/version/")})}),a.publicUrl=m.apiUrl+"/public/curriculum/"+a.curriculum.id+"/"+F+"?format=json"):a.version=angular.extend(G),a.openAddSpecialtyDialog=function(){var b=function(b){b.maxCredits=a.curriculum.credits?a.curriculum.credits:0,b.isNew=!0};c.showDialog("higherCurriculum/higher.curriculum.specialty.add.dialog.html",b,function(b){var c=b.data;c.occupation||(c.occupationEt=void 0,c.occupationEn=void 0);var d=new B(c);d.curriculum=a.curriculum.id,d.$save().then(function(b){e.info("main.messages.create.success"),a.curriculum.specialities.push(b)})})},o(),a.curriculumVersionCodeUniqueQuery={id:f.current.params.versionId,url:"/curriculumVersion/unique/code"},a.save=function(){a.formState.strictValidation=!1,setTimeout(q,0)},a.changeStatusUnderRevision=function(){var a={prompt:"curriculum.statuschange.version.prompt.setStatusUnderRevision",updateSuccess:"curriculum.statuschange.version.success.opened"},b=h.endpoint("/curriculumVersion/underrevision");r(b,a)},a.saveAndConfirm=function(){var b={prompt:a.formState.readOnly?"curriculum.statuschangeReadOnly.version.prompt.verify":"curriculum.statuschange.version.prompt.verify",updateSuccess:"curriculum.statuschange.version.success.verified"},c=h.endpoint("/curriculumVersion/saveAndConfirm");a.formState.strictValidation=!0,r(c,b)},a.confirm=function(){var b={prompt:a.formState.readOnly?"curriculum.statuschangeReadOnly.version.prompt.verify":"curriculum.statuschange.version.prompt.verify",updateSuccess:"curriculum.statuschange.version.success.verified"},c=h.endpoint("/curriculumVersion/confirm");a.formState.strictValidation=!0,r(c,b)},a.setStatusClosed=function(){var b={prompt:a.formState.readOnly?"curriculum.statuschangeReadOnly.version.prompt.close":"curriculum.statuschange.version.prompt.close",updateSuccess:"curriculum.statuschange.version.success.closed"},c=h.endpoint("/curriculumVersion/close");a.formState.strictValidation=!1,r(c,b)},a.goToEditForm=function(){a.curriculum&&(a.version.status===b.VERSION_STATUS.K?c.confirmDialog({prompt:"curriculum.statuschange.version.prompt.editAccepted"},function(){g.path("/higherCurriculum/"+a.version.curriculum+"/version/"+a.version.id+"/edit")}):g.path("/higherCurriculum/"+a.version.curriculum+"/version/"+a.version.id+"/edit"))},a.strictValidation=function(){return a.version.status===b.VERSION_STATUS.K||a.formState.strictValidation},a["delete"]=function(){c.confirmDialog({prompt:"curriculum.version.deleteconfirm"},function(){var b=new E(a.version);b.$delete().then(function(){e.info("main.messages.delete.success"),j.back("#/higherCurriculum/"+a.version.curriculum+"/view")})})},a.copy=function(){var b=h.endpoint("/curriculumVersion/copy");new b({id:F}).$update().then(function(b){e.info("main.messages.create.success"),g.path("/higherCurriculum/"+a.version.curriculum+"/version/"+b.id+"/edit")})},a.versionIsValid=function(){return a.allSpecialitiesValid()&&a.allMinorSpecialitiesValid()},a.allMinorSpecialitiesValid=function(){for(var b=a.version.modules.filter(function(a){return a.minorSpeciality}),c=0;c<b.length;c++)if(!a.moduleValid(b[c]))return!1;return!0},a.allSpecialitiesValid=function(){if(d.isEmpty(a.version.specialitiesReferenceNumbers)||d.isEmpty(a.version.modules))return!1;for(var b=a.version.specialitiesReferenceNumbers,c=0;c<b.length;c++)if(!a.specialityValid(b[c]))return!1;return!0},a.specialityValid=function(b){var c=u(b);if(d.isEmpty(c))return!1;for(var e=0;e<c.length;e++)if(!a.moduleValid(c[e]))return!1;return!0},a.moduleValid=function(b){return a.moduleHasSubjects(b)},a.anyModuleAdded=function(a){return a.modules.filter(function(a){return!a.minorSpeciality}).length>0},a.moduleMustHaveSubjects=function(a){return"KORGMOODUL_V"!==a.type},a.moduleHasSubjects=function(b){return b.minorSpeciality?b.subjects&&b.subjects.length>0:!a.moduleMustHaveSubjects(b)||b.subjects&&b.subjects.length>0},a.filterModulesBySpeciality=function(a){return function(b){return d.includes(b.curriculumSpecialities,a.referenceNumber)}},a.filterSpecialities=function(b){return a.curriculum&&a.version&&a.version.specialitiesReferenceNumbers?d.includes(a.version.specialitiesReferenceNumbers,b.referenceNumber):!1},a.deleteSubject=function(a,b){c.confirmDialog({prompt:"curriculum.itemDeleteConfirm"},function(){new C(b).$delete().then(function(){e.info("main.messages.delete.success"),d.remove(a.subjects,b),v(a)})})},a.$watchCollection("version.specialitiesReferenceNumbers",function(b,c){if(w(b,c))for(var d=x(b,c),f=0;f<d.length;f++)if(u(d[f]).length>0)return e.error("curriculum.error.specAddedToModule"),void(a.version.specialitiesReferenceNumbers=c)}),a.openAddModuleDialog=function(b){a.higherCurriculumVersionForm.$dirty?c.confirmDialog({prompt:"main.messages.confirmFormDataNotSaved"},function(){y(b)}):y(b)},a.openAddMinorSpecialtyDialog=function(b){a.higherCurriculumVersionForm.$dirty?c.confirmDialog({prompt:"main.messages.confirmFormDataNotSaved"},function(){z(b)}):z(b)},a.showPrintButton=function(){return angular.isDefined(a.version.id)&&(a.auth.isAdmin()||a.curriculum.status===a.STATUS.VERIFIED&&a.version.status===a.VERSION_STATUS.K)}}]),angular.module("hitsaOis").controller("HigherModuleController",["$scope","$route","QueryUtils","dialogService","message","ArrayUtils","$location","$rootScope",function(a,b,c,d,e,f,g,h){function i(a){return"KORGMOODUL_V"!==a.type}function j(b){a.data=new u(b),k(b.studyYears),l(),a.getSubjects()}function k(b){if(a.studyYears=[],"number"==typeof b)for(var c=0;b>c;c++)a.studyYears.push(c+1)}function l(){var b=t+"/versionHmoduleTypes/"+r+(a.data.id?"/"+a.data.id:"");c.endpoint(b).query().$promise.then(function(b){a.moduleTypes=b,a.data.typeObject=a.moduleTypes.find(function(b){return"KORGMOODUL_M"!==a.data.type?b.code===a.data.type:null===b.code&&b.nameEn===a.data.typeNameEn&&b.nameEt===a.data.typeNameEt}),a.higherModuleForm&&a.higherModuleForm.$setPristine()})}function m(){a.data.subjects=[],a.data.electiveModules=[],a.data.compulsoryStudyCredits=0,a.data.electiveModulesNumber=0,a.data.totalCredits=a.data.optionalStudyCredits}function n(){return a.higherModuleForm.$setSubmitted(),a.higherModuleForm.$valid?a.subjectsValid()?!0:(e.error("curriculum.error.noSubject"),!1):(e.error("main.messages.form-has-errors"),!1)}function o(){var b=a.data;"KORGMOODUL_M"!==b.typeObject.code&&null!==b.typeObject.code?(b.typeNameEt=null,b.typeNameEn=null,b.type=b.typeObject.code):null===b.typeObject.code?(b.type="KORGMOODUL_M",b.typeNameEt=b.typeObject.nameEt,b.typeNameEn=b.typeObject.nameEn):b.type="KORGMOODUL_M"}function p(a){for(var b,c=a.map(function(a){return a.referenceNumber});;)if(b=-Math.floor(1e3*Math.random()+1),!f.includes(c,b))break;return b}var q=b.current.params.id,r=b.current.params.versionId,s=b.current.params.curriculumId,t="/higherModule",u=c.endpoint(t);h.removeLastUrlFromHistory(function(a){return a&&-1!==a.indexOf("new")}),a.studyYears=[],a.backToEditForm="#/higherCurriculum/"+s+"/version/"+r+"/edit",a.backToViewForm="#/higherCurriculum/"+s+"/version/"+r+"/view",a.formState={moduleMustHaveSubjects:!a.data||i(scope.data),readOnly:-1!==b.current.$$route.originalPath.indexOf("view")};var v={electiveModules:[],specialitiesReferenceNumbers:[],subjects:[],minorSpeciality:!1,optionalStudyCredits:0,totalCredits:0,compulsoryStudyCredits:0,electiveModulesNumber:0,curriculumVersion:r};q?u.get({id:q}).$promise.then(j):(c.endpoint(t+"/curriculumYears").get({id:s},function(a){k(a.years)}),a.data=new u(angular.extend({},v)),l()),c.endpoint(t+"/version/"+r+"/specialities").query().$promise.then(function(b){a.specialities=b}),a.getSubjects=function(){return f.isEmpty(a.data.specialitiesReferenceNumbers)?void(a.subjects=[]):void c.endpoint(t+"/possibleSubjects").query({module:q,curriculumVersion:r,specialities:a.data.specialitiesReferenceNumbers}).$promise.then(function(b){a.subjects=b})},a.searchSubjects=function(b){if(!b)return[];var c=new RegExp("^.*"+b.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&").replace("%",".*").toUpperCase()+".*$");return(a.subjects||[]).filter(function(b){return a.subjectNotAdded(b)&&c.test(b.code+" - "+a.currentLanguageNameField(b).toUpperCase())})},a.$watch("data.typeObject",function(b){b&&"KORGMOODUL_V"===b.code?(a.formState.moduleMustHaveSubjects=!1,m()):b&&(a.formState.moduleMustHaveSubjects=!0)}),a.addElectiveModule=function(){var b={nameEt:a.optionalNameEt,nameEn:a.optionalNameEn,referenceNumber:p(a.data.electiveModules)};a.data.electiveModules.push(b),a.optionalNameEt=void 0,a.optionalNameEn=void 0},a.editingElectiveModule=!1;var w=null;a.editElectiveModule=function(b){w=b,a.editingElectiveModule=!0,a.optionalNameEt=b.nameEt,a.optionalNameEn=b.nameEn},a.finishEditElectiveModule=function(){a.editingElectiveModule=!1,w.nameEt=a.optionalNameEt,w.nameEn=a.optionalNameEn,a.optionalNameEt=void 0,a.optionalNameEn=void 0},a.deleteElectiveModule=function(b){a.data.subjects.forEach(function(a){a.electiveModule===b.referenceNumber&&(a.electiveModule=void 0)}),f.remove(a.data.electiveModules,b),a.higherModuleForm.$setDirty()},a.subjectsValid=function(){return!a.formState.moduleMustHaveSubjects||a.data.subjects&&a.data.subjects.length>0},a.removeSubject=function(b){f.remove(a.data.subjects,b),a.setCompulsoryStudyCredits(),a.higherModuleForm.$setDirty()},a.addSubject=function(){var b=angular.copy(a.data.selectedSubject);b.optional=!1,a.data.subjects.push(b),a.data.selectedSubject=void 0,a.setCompulsoryStudyCredits(),a.higherModuleForm.$setDirty()},a.setCompulsoryStudyCredits=function(b){a.setCompulsoryAndTotalStudyCredits(a.data),b&&!b.optional&&(b.electiveModule=void 0)},a.setCompulsoryAndTotalStudyCredits=function(a){a.compulsoryStudyCredits=0,a.subjects.forEach(function(b){b.optional||(a.compulsoryStudyCredits+=b.credits)}),a.totalCredits=a.compulsoryStudyCredits+a.optionalStudyCredits},a.save=function(b){n()&&(o(),q?a.data.$update().then(function(b){e.info("main.messages.update.success"),a.higherModuleForm.$setPristine(),j(b)}):a.data.$save().then(function(a){e.info("main.messages.create.success"),g.path("/higherCurriculum/"+s+"/version/"+r+"/module/"+a.id+"/edit")}))},a["delete"]=function(){d.confirmDialog({prompt:"curriculum.moduleDeleteConfirm"},function(){new u(a.data).$delete().then(function(){e.info("main.messages.delete.success"),g.url("/higherCurriculum/"+s+"/version/"+r+"/edit?_noback")})})},a.subjectNotAdded=function(b){if(!a.data||f.isEmpty(a.data.subjects))return!0;var c=a.data.subjects.map(function(a){return a.subjectId});return!f.includes(c,b.subjectId)}}]),angular.module("hitsaOis").controller("MinorSpecialityController",["$scope","$route","QueryUtils","dialogService","message","ArrayUtils","$location","$rootScope",function(a,b,c,d,e,f,g,h){function i(b){a.data=new s(b),j(b.studyYears)}function j(b){if(a.studyYears=[],"number"==typeof b)for(var c=0;b>c;c++)a.studyYears.push(c+1)}function k(){c.endpoint(r+"/minorSpeciality/possibleSubjects").query({curriculumVersion:p}).$promise.then(function(b){a.subjects=b})}function l(){return a.data.subjects.length>0}function m(){return a.minorSpecialityForm.$setSubmitted(),a.minorSpecialityForm.$valid?l()?!0:(e.error("curriculum.error.noSubject"),!1):(e.error("main.messages.form-has-errors"),!1)}function n(a){for(var b,c=a.map(function(a){return a.referenceNumber});;)if(b=-Math.floor(1e3*Math.random()+1),!f.includes(c,b))break;return b}var o=b.current.params.id,p=b.current.params.versionId,q=b.current.params.curriculumId,r="/higherModule",s=c.endpoint(r);h.removeLastUrlFromHistory(function(a){return a&&-1!==a.indexOf("new")}),a.studyYears=[],a.backToEditForm="#/higherCurriculum/"+q+"/version/"+p+"/edit",a.backToViewForm="#/higherCurriculum/"+q+"/version/"+p+"/view",a.formState={readOnly:-1!==b.current.$$route.originalPath.indexOf("view")};var t={electiveModules:[],specialitiesReferenceNumbers:[],subjects:[],minorSpeciality:!0,optionalStudyCredits:0,totalCredits:0,compulsoryStudyCredits:0,electiveModulesNumber:0,type:"KORGMOODUL_M",curriculumVersion:p};o?s.get({id:o}).$promise.then(i):(c.endpoint(r+"/curriculumYears").get({id:q},function(a){j(a.years)}),a.data=new s(angular.extend({},t))),a.searchSubjects=function(b){if(!b)return[];var c=new RegExp("^.*"+b.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&").replace("%",".*").toUpperCase()+".*$");return(a.subjects||[]).filter(function(b){return a.subjectNotAdded(b)&&c.test(b.code+" - "+a.currentLanguageNameField(b).toUpperCase())})},k(),a.addElectiveModule=function(){var b={nameEt:a.optionalNameEt,nameEn:a.optionalNameEn,referenceNumber:n(a.data.electiveModules)};a.data.electiveModules.push(b),a.optionalNameEt=void 0,a.optionalNameEn=void 0},a.editingElectiveModule=!1;var u=null;a.editElectiveModule=function(b){u=b,a.editingElectiveModule=!0,a.optionalNameEt=b.nameEt,a.optionalNameEn=b.nameEn},a.finishEditElectiveModule=function(){a.editingElectiveModule=!1,u.nameEt=a.optionalNameEt,u.nameEn=a.optionalNameEn,a.optionalNameEt=void 0,a.optionalNameEn=void 0},a.deleteElectiveModule=function(b){a.data.subjects.forEach(function(a){a.electiveModule===b.referenceNumber&&(a.electiveModule=void 0)}),f.remove(a.data.electiveModules,b),a.minorSpecialityForm.$setDirty()},a.removeSubject=function(b){f.remove(a.data.subjects,b),a.setCompulsoryStudyCredits(),a.minorSpecialityForm.$setDirty()},a.addSubject=function(){var b=angular.copy(a.data.selectedSubject);b.optional=!1,a.data.subjects.push(b),a.data.selectedSubject=void 0,a.setCompulsoryStudyCredits(),a.minorSpecialityForm.$setDirty()},a.setCompulsoryStudyCredits=function(b){a.setCompulsoryAndTotalStudyCredits(a.data),b&&!b.optional&&(b.electiveModule=void 0)},a.setCompulsoryAndTotalStudyCredits=function(a){a.compulsoryStudyCredits=0,a.subjects.forEach(function(b){b.optional||(a.compulsoryStudyCredits+=b.credits)}),a.totalCredits=a.compulsoryStudyCredits+a.optionalStudyCredits},a.save=function(b){m()&&(o?a.data.$update().then(function(b){e.info("main.messages.update.success"),a.minorSpecialityForm.$setPristine(),i(b)}):a.data.$save().then(function(a){e.info("main.messages.create.success"),g.path("/higherCurriculum/"+q+"/version/"+p+"/minorSpeciality/"+a.id+"/edit")}))},a["delete"]=function(){d.confirmDialog({prompt:"curriculum.minorSpecialtyDeleteConfirm"},function(){new s(a.data).$delete().then(function(){e.info("main.messages.delete.success"),g.url("/higherCurriculum/"+q+"/version/"+p+"/edit?_noback")})})},a.subjectNotAdded=function(b){if(!a.data||f.isEmpty(a.data.subjects))return!0;var c=a.data.subjects.map(function(a){return a.subjectId});return!f.includes(c,b.subjectId)}}]),angular.module("hitsaOis").config(["$routeProvider","USER_ROLES",function(a,b){a.when("/higherProtocols",{templateUrl:"higherProtocol/higher.protocol.search.html",controller:"HigherProtocolSearchController",controllerAs:"HigherProtocolSearchController",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_PROTOKOLL]}}).when("/higherProtocols/new",{templateUrl:"higherProtocol/higher.protocol.new.html",controller:"HigherProtocolNewController",controllerAs:"higherProtocolNewController",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],isCreate:function(){return!0}},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_PROTOKOLL]}}).when("/higherProtocols/:id/edit",{templateUrl:"higherProtocol/higher.protocol.edit.html",controller:"HigherProtocolEditViewController",controllerAs:"HigherProtocolEditViewController",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],entity:["QueryUtils","$route",function(a,b){return a.endpoint("/higherProtocols").get({id:b.current.params.id}).$promise}],isView:function(){return!1}},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_PROTOKOLL]}}).when("/higherProtocols/:id/view",{templateUrl:"higherProtocol/higher.protocol.view.html",controller:"HigherProtocolEditViewController",controllerAs:"HigherProtocolEditViewController",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],entity:["QueryUtils","$route",function(a,b){return a.endpoint("/higherProtocols").get({id:b.current.params.id}).$promise}],isView:function(){return!0}},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_PROTOKOLL]}})}]),angular.module("hitsaOis").controller("HigherProtocolSearchController",["$scope","$route","$q","$timeout","QueryUtils","DataUtils","Classifier","message","USER_ROLES",function(a,b,c,d,e,f,g,h,i){a.auth=b.current.locals.auth,a.search={},a.criteria={};var j="/higherProtocols",k=g.valuemapper({status:"PROTOKOLL_STAATUS",protocolType:"PROTOKOLLI_LIIK"});e.createQueryForm(a,j,{order:"id"},k.objectmapper),f.convertStringToDates(a.criteria,["inserted","confirmDate"]),
a.studyPeriods=e.endpoint("/autocomplete/studyPeriodsWithYear").query({},function(b){b.forEach(function(b){b[a.currentLanguageNameField()]=a.currentLanguageNameField(b.studyYear)+" "+a.currentLanguageNameField(b)})});var l=k.promises;l.push(a.studyPeriods.$promise),a.formState={canCreate:-1!==a.auth.authorizedRoles.indexOf(i.ROLE_OIGUS_M_TEEMAOIGUS_PROTOKOLL)};var m=a.loadData;a.loadData=function(){a.higherProtocolSearchForm.$setSubmitted(),a.higherProtocolSearchForm.$valid?m():h.error("main.messages.form-has-errors")},c.all(l).then(function(){if(a.studyPeriods.length>0&&!a.criteria.studyPeriod){var b=f.getCurrentStudyYearOrPeriod(a.studyPeriods);a.criteria.studyPeriod=b?b.id:void 0}a.criteria.studyPeriod?d(a.loadData):0===a.studyPeriods.length&&(a.canCreate=!1,h.error("studyYear.studyPeriod.missing"))})}]),angular.module("hitsaOis").controller("HigherProtocolNewController",["$scope","$route","$location","QueryUtils","DataUtils","Classifier","message","ArrayUtils",function(a,b,c,d,e,f,g,h){function i(){a.record.protocolType&&a.record.subjectStudyPeriod&&d.endpoint(j+"/students").query(a.record).$promise.then(function(b){a.record.students=[],a.students=b})}a.auth=b.current.locals.auth;var j="/higherProtocols";a.record={protocolType:"PROTOKOLLI_LIIK_P",students:[]},a.subjectStudyPeriods=d.endpoint(j+"/subjectStudyPeriods").query(),a.$watch("record.subjectStudyPeriod",i),a.$watch("record.protocolType",i);var k=d.endpoint(j);a.submit=function(){return a.higherProtocolNewForm.$valid?h.isEmpty(a.record.students)?void g.error("higherProtocol.error.noStudents"):void new k(a.record).$save().then(function(a){g.info("main.messages.create.success"),c.url(j+"/"+a.id+"/edit?_noback")}):(g.error("main.messages.form-has-errors"),a.higherProtocolNewForm.$setSubmitted(),!1)}}]),angular.module("hitsaOis").controller("HigherProtocolEditViewController",["$scope","$filter","$q","QueryUtils","$route","message","config","MidtermTaskUtil","Classifier","ProtocolUtils","oisFileService","HigherGradeUtil",function(a,b,c,d,e,f,g,h,i,j,k,l){function m(a,b){return{midtermTask:b.id,declarationSubject:a.declarationSubject,maxPoints:b.maxPoints,canBeChanged:a.studentResultCanBeChanged,isText:b.studentResultIsText,studentId:a.student.id}}function n(){angular.isDefined(v)&&0===v.promise.$$state.status&&v.resolve()}function o(b){c.all(z.promises).then(function(){a.higherProtocolForm.$setPristine(),a.record=z.objectmapper(b),a.savedStudents=angular.copy(a.record.protocolStudents),a.record.subjectStudyPeriodMidtermTaskDto.midtermTasks=y.getSortedMidtermTasks(a.record.subjectStudyPeriodMidtermTaskDto.midtermTasks),q(),y.sortStudentResults(a.record.subjectStudyPeriodMidtermTaskDto.studentResults,a.record.subjectStudyPeriodMidtermTaskDto.midtermTasks),a.getUrl=k.getUrl,a.formState={},a.formState.protocolPdfUrl=g.apiUrl+w+"/print/"+a.record.id+"/protocol.pdf",a.formState.canEditProtocol=j.canEditProtocol(a.auth,a.record),a.formState.canChangeConfirmedProtocolGrade=j.canChangeConfirmedProtocolGrade(a.auth,a.record),a.formState.canConfirm=j.canConfirm(a.auth,a.record),a.formState.canCalculate="PROTOKOLLI_LIIK_P"===a.record.protocolType&&a.formState.canEditProtocol&&!a.record.subjectStudyPeriodMidtermTaskDto.subjectStudyPeriod.isPracticeSubject&&a.record.subjectStudyPeriodMidtermTaskDto.midtermTasks.length>0,a.formState.isConfirmed="PROTOKOLL_STAATUS_K"===a.record.status,n()})["catch"](function(){n()})}function p(b,c){var d=a.record.subjectStudyPeriodMidtermTaskDto.studentResults.find(function(a){return a.midtermTask===c.id&&a.studentId===b.student.id});return angular.isDefined(d)}function q(){a.record.protocolStudents.forEach(function(b){for(var c=[],d=0;d<a.record.subjectStudyPeriodMidtermTaskDto.midtermTasks.length;d++)p(b,a.record.subjectStudyPeriodMidtermTaskDto.midtermTasks[d])||c.push(m(b,a.record.subjectStudyPeriodMidtermTaskDto.midtermTasks[d]));a.record.subjectStudyPeriodMidtermTaskDto.studentResults=a.record.subjectStudyPeriodMidtermTaskDto.studentResults.concat(c)})}function r(){return a.higherProtocolForm.$setSubmitted(),a.higherProtocolForm.$valid?!0:(f.error("main.messages.form-has-errors"),!1)}function s(){new x(a.record).$update().then(function(a){f.updateSuccess(),o(a)})}function t(b){var c=a.record.protocolStudents.find(function(a){return a.id===b.protocolStudent});c.grade=b.grade,a.gradeChanged(c)}function u(a){a.forEach(t)}a.auth=e.current.locals.auth,a.gradeUtil=l;var v,w="/higherProtocols",x=d.endpoint(w),y=new h,z=i.valuemapper({status:"PROTOKOLL_STAATUS",grade:"KORGHINDAMINE"});a.calculateGrades={protocolStudents:[]},a.gradeChanged=function(c){if(c){var d=b("filter")(a.savedStudents,{id:c.id},!0)[0];d.grade!==c.grade?(a.higherProtocolForm.$setSubmitted(),c.gradeHasChanged=!0):(c.gradeHasChanged=!1,d.addInfo?c.addInfo=d.addInfo:c.addInfo=null)}a.formState.canConfirm=j.canConfirm(a.auth,a.record)},a.gradeValue=function(b){var c=z.objectmapper({grade:b}).grade;return c?a.auth.school.letterGrades?c.value2:c.value:void 0},a.addInfoChanged=function(){a.formState.canConfirm=j.canConfirm(a.auth,a.record)},e.current.locals.entity&&o(e.current.locals.entity),a.filterStudentResults=function(a){return function(b){return a.student.id===b.studentId}},a.save=function(){r()&&s()},a.grades=i.queryForDropdown({mainClassCode:"KORGHINDAMINE"}),a.hideInvalid=function(a){return!i.isValid(a)},a.calculate=function(){d.endpoint(w+"/"+a.record.id+"/calculate").query(a.calculateGrades).$promise.then(function(b){a.calculateGrades.protocolStudents=[],u(b),f.info("higherProtocol.message.calculated")})},a.confirm=function(){return v=c.defer(),r()?(j.signBeforeConfirm(a.auth,w+"/"+a.record.id,a.record,"higherProtocol.message.confirmed",o,n),v.promise):(n(),v.promise)},a.getMidtermTaskHeader=y.getMidtermTaskHeader}]),angular.module("hitsaOis").controller("JournalController",["$scope","$route","Classifier","DataUtils","QueryUtils","message","$location",function(a,b,c,d,e,f,g){function h(a){"edit"!==b.current.params.action||a.canEdit||(f.error("main.messages.error.nopermission"),g.path(""))}function i(b){h(b),d.convertStringToDates(b,["studyYearStartDate","studyYearEndDate"]),a.journal=b,angular.isString(b.endDate)||(a.journal.endDate=b.studyYearEndDate)}a.auth=b.current.locals.auth,a.capacityTypes={},c.queryForDropdown({mainClassCode:"MAHT"},function(b){a.capacityTypes=c.toMap(b)});var j=b.current.locals.entity;angular.isDefined(j)&&i(j),a.showModuleNames=function(b){return b.map(function(b){return a.currentLanguageNameField(b)}).join(", ")},a.saveEndDate=function(){a.journalForm.$setSubmitted(),a.journalForm.$valid?e.endpoint("/journals/"+j.id+"/saveEndDate").save({endDate:a.journal.endDate},function(){f.info("main.messages.create.success"),a.journalForm.$setPristine()}):f.error("main.messages.form-has-errors")},a.saveMoodleCourseId=function(){e.endpoint("/journals/"+j.id+"/moodle/courseLink").update(a.journal.moodleCourseId,function(){f.info("main.messages.create.success"),a.journalForm.$setPristine(),a.moodleCourseId=a.journal.moodleCourseId}).$promise["catch"](angular.noop)},a.saveReview=function(){a.journalForm.$setSubmitted(),a.journalForm.$valid?e.endpoint("/journals/"+j.id+"/journalReview").save({isReviewOk:a.journal.isReviewOk,reviewInfo:a.journal.reviewInfo},function(b){f.info("main.messages.create.success"),a.journalForm.$setPristine(),i(b)}):f.error("main.messages.form-has-errors")}}]),angular.module("hitsaOis").controller("JournalListController",["$scope","$route","QueryUtils","Classifier","$q","dialogService","message",function(a,b,c,d,e,f,g){a.auth=b.current.locals.auth,a.search={};var h=d.valuemapper({status:"PAEVIK_STAATUS"}),i=h.promises;a.formState={},a.directiveControllers=[],a.load=function(){return a.searchForm.$valid?void a.loadData():(g.error("main.messages.form-has-errors"),!1)},c.endpoint("/journals/canConfirmAll").search().$promise.then(function(b){a.formState.canConfirmAll=b.canConfirmAll}),a.confirmAll=function(){f.confirmDialog({prompt:"journal.prompt.confirmAll"},function(){c.endpoint("/journals/confirmAll").put().$promise.then(function(b){g.info("journal.messages.allConfirmed",{numberOfConfirmedJournals:b.numberOfConfirmedJournals}),a.loadData()})})};var j="et"===a.currentLanguage()?"2, 5, 3":"2, 6, 3";c.createQueryForm(a,"/journals",{order:j},h.objectmapper),a.$watch("criteria.studyYear",function(b){angular.isNumber(b)&&e.all(i).then(function(){a.loadData()})}),a.auth.isTeacher()&&(a.criteria.onlyMyJournals=!0),a.$watch("criteria.teacherObject",function(b){a.criteria.teacher=angular.isObject(b)?b.id:b}),a.$watch("criteria.moduleObject",function(){a.criteria.module=a.criteria.moduleObject?a.criteria.moduleObject.id:null}),a.clearSearch=function(){a.clearCriteria(),a.search={module:[]},a.directiveControllers.forEach(function(a){a.clear()})}}]),angular.module("hitsaOis").controller("JournalStudentSelectionController",["$scope","$route","QueryUtils","ArrayUtils","message","dialogService",function(a,b,c,d,e,f){var g=b.current.locals.entity;a.selectedStudents=[],a.addSelectedStudents=function(){a.selectedStudents.length>0?c.endpoint("/journals/"+g.id+"/addStudentsToJournal").save({students:a.selectedStudents},b.reload):e.error("journal.messages.noStudentsSelected")},c.endpoint("/journals/"+g.id+"/suitedStudents").query({},function(b){a.tabledata={content:b},b.forEach(function(b){a.selectedStudents.push(b.studentId)})}),a.searchStudent=function(){f.showDialog("journal/journal.searchStudent.dialog.html",function(d){function e(){for(var a=0;a<d.tabledata.content.length;a++){for(var b=!1,c=0;c<d.searchedStudents.length;c++)if(d.tabledata.content[a].studentId===d.searchedStudents[c].studentId){b=!0;break}b||d.searchedStudents.push(d.tabledata.content[a])}}d.selectedStudents=[],d.searchedStudents=[];var f=[];a.tabledata.content&&(f=a.tabledata.content.map(function(a){return a.studentId})),b.current.params._menu=!0,d.$watch("criteria.studentGroupObject",function(){d.criteria.studentGroupId=d.criteria.studentGroupObject?d.criteria.studentGroupObject.id:null}),c.createQueryForm(d,"/journals/"+g.id+"/otherStudents",{studentId:f},e),d.loadData()},function(b){b.selectedStudents.forEach(function(c){var d=b.searchedStudents.filter(function(a){return c===a.studentId})[0];a.tabledata.content.push(d),a.selectedStudents.push(d.studentId)})})},a.removeStudent=function(b){d.remove(a.selectedStudents,b.studentId),d.remove(a.tabledata.content,b)}}]),angular.module("hitsaOis").controller("JournalEditController",["$scope","$route","$filter","$window","QueryUtils","ArrayUtils","DataUtils","Classifier","StudentUtil","message","dialogService","VocationalGradeUtil","$q","oisFileService","stateStorageService",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){function p(){e.endpoint("/journals/"+M.id+"/usedHours").get().$promise.then(function(b){a.journal.lessonHours=b})}function q(b){var c=e.endpoint("/journals/"+M.id+"/journalStudents").query({allStudents:!!b}).$promise;e.endpoint("/journals/"+M.id+"/journalEntriesByDate").query({allStudents:!!b},function(b){var e=b;F.objectmapper(e),e.forEach(function(a){for(var b in a.journalStudentResults)a.journalStudentResults.hasOwnProperty(b)&&s(a.journalStudentResults[b])}),a.journal.journalEntriesByDate=e,c.then(function(b){a.journal.journalStudents=b,a.journal.journalStudents.forEach(function(a){for(var b in a.apelResults)a.apelResults.hasOwnProperty(b)&&F.objectmapper(a.apelResults[b]);r(a)}),a.$broadcast("refreshFixedColumns"),a.windowHeight=d.innerHeight})})}function r(a){if(a.apelResults){var b=a.apelResults.filter(function(a){return a.isModule});b.length>0&&(a.apelTransferredFinalResult=1===b.length?b[0].grade.code:"KUTSEHINDAMINE_A")}}function s(a){F.objectmapper(a),a[0].lessonAbsences.forEach(function(a){F.objectmapper(a)}),a[0].journalEntryStudentHistories.forEach(function(a){F.objectmapper(a)})}function t(b){a.journal=b,a.$parent.$parent.moodleCourseId=b.moodleCourseId,u(),q(a.formState.showAllStudentsModel)}function u(){a.journalEntriesCriteria={size:20,page:1},angular.isDefined(a.journalEntries)||(a.journalEntries={}),a.loadJournalEntries=function(){var b=e.getQueryParams(a.journalEntriesCriteria);a.journalEntries.$promise=e.endpoint("/journals/"+M.id+"/journalEntry").search(b,a.afterLoadJournalEntries)},a.afterLoadJournalEntries=function(b){a.journalEntriesCriteria.size=b.size,a.journalEntriesCriteria.page=b.number+1,a.journalEntries.content=b.content,a.journalEntries.totalElements=b.totalElements},a.loadJournalEntries()}function v(){t(M)}function w(b){var c=Object.values(a.journalEntryTypes);b||(b=c.map(function(a){return a.code})),c.forEach(function(a){a._selected=-1!==b.indexOf(a.code)})}function x(b){b.journalStudents=M.journalStudents,b.journalEntryStudents=[],b.journalStudents.forEach(function(a){b.journalEntryStudents[a.id]={isLessonAbsence:!1,lessonAbsences:{}}}),b.absenceOptions={},b.capacityTypes=e.endpoint("/autocomplete/schoolCapacityTypes").query({journalId:b.journal.id,entryTypes:!0}),b.lessonPlanDates=a.formState.lessonInfo.lessonPlanDates.map(function(a){var b=c("hoisDate")(a);return{nameEt:b,nameEn:b,id:a}}),b.journalEntry.startLessonNr=a.formState.lessonInfo.startLessonNr,b.lessons=I.map(function(a){return{nameEt:a,nameEn:a,id:a}}),b.journalEntry.lessons=a.formState.lessonInfo.lessons,h.queryForDropdown({mainClassCode:"PUUDUMINE"},function(a){b.absenceOptions=h.toMap(a)})}function y(a,b){var c=[];if(angular.isObject(a)){for(var d in a)a.hasOwnProperty(d)&&a[d]===!0&&c.push(d);b.journalEntryCapacityTypes=c}}function z(a,b){e.endpoint("/journals/"+M.id+"/hasFinalEntry").search().$promise.then(function(c){c.hasFinalEntry&&(b?"SISSEKANNE_L"!==b.entryType&&a.forbiddenEntryTypes.push("SISSEKANNE_L"):a.forbiddenEntryTypes.push("SISSEKANNE_L"))}),a.forbiddenEntryTypes.push("SISSEKANNE_O")}function A(b){k.showDialog("journal/journal.addEntry.dialog.html",function(c){function d(a){return c.journalEntry.entryDate?void e.endpoint("/journals/"+M.id+"/studentsWithAcceptedAbsences").query({entryDate:c.journalEntry.entryDate}).$promise.then(function(b){c.acceptedAbsences=b,c.previousEntryDate=c.journalEntry.entryDate,f(a)}):(c.acceptedAbsences=null,void f(a))}function f(a){c.journalStudents.forEach(function(b){if(i.isActive(b.status)){var d=w(b.id);angular.isObject(d)?(d.wholeDay&&(c.journalEntryStudents[b.id].hasWholeDayAcceptedAbsence=!0,c.journalEntryStudents[b.id].wholeDayAbsenceCode=d.practice?"PUUDUMINE_PR":"PUUDUMINE_V"),d.lessons&&d.lessons.forEach(function(a){var e=n(a);if(e>0&&angular.isObject(c.journalEntryStudents[b.id].lessonAbsences[e])){var f=c.journalEntryStudents[b.id].lessonAbsences[e].absence,g=A(d,a);c.journalEntryStudents[b.id].lessonAbsences[e].accepted=f===g}})):(c.journalEntryStudents[b.id].hasWholeDayAcceptedAbsence=!1,c.journalEntryStudents[b.id].wholeDayAbsenceCode=null),a&&(h(b,d),m(b,d))}})}function h(a,b){var d=angular.isObject(b)&&b.wholeDay;d?b.practice?(c.journalEntryStudents[a.id].practice=!0,c.journalEntryStudentAbsenceChanged(a,!0,"PUUDUMINE_PR")):(c.journalEntryStudents[a.id].excused=!0,c.journalEntryStudentAbsenceChanged(a,!0,"PUUDUMINE_V")):(c.journalEntryStudents[a.id].practice=!1,c.journalEntryStudents[a.id].excused=!1,("PUUDUMINE_V"===c.journalEntryStudents[a.id].absence||"PUUDUMINE_PR"===c.journalEntryStudents[a.id].absence)&&c.journalEntryStudentAbsenceChanged(a,null,null))}function m(a,b){var d=angular.isObject(b)?b.lessons:null,e=angular.isObject(b)&&b.wholeDay;angular.forEach(c.journalEntryStudents[a.id].lessonAbsences,function(b){b.accepted&&(b.accepted=!1,b.absence=null,c.journalEntryStudentAbsenceChanged(a,null,null,b.lessonNr)),!e||"PUUDUMINE_H"!==b.absence&&"PUUDUMINE_P"!==b.absence?e||"PUUDUMINE_V"!==b.absence&&"PUUDUMINE_PR"!==b.absence||(b.absence=null,c.journalEntryStudentAbsenceChanged(a,null,null,b.lessonNr)):(b.absence=null,c.journalEntryStudentAbsenceChanged(a,null,null,b.lessonNr))}),d&&d.forEach(function(b){var d=n(b);d>0&&(angular.isObject(c.journalEntryStudents[a.id].lessonAbsences[d])||(c.journalEntryStudents[a.id].lessonAbsences[d]={}),c.journalEntryStudents[a.id].lessonAbsences[d].accepted=!0,c.journalEntryStudents[a.id].lessonAbsences[d].lessonNr=d,c.journalEntryStudents[a.id].lessonAbsences[d].excused=!0,c.journalEntryStudentAbsenceChanged(a,!0,"PUUDUMINE_V",d))})}function n(a){return c.journalEntry.startLessonNr&&c.journalEntry.startLessonNr>1?a+(1-c.journalEntry.startLessonNr):a}function o(a){return c.journalEntry.startLessonNr&&c.journalEntry.startLessonNr>1?a+(c.journalEntry.startLessonNr-1):a}function r(a){a.isLessonAbsence?angular.forEach(a.lessonAbsences,function(a){s(a)}):s(a)}function s(a){switch(a.absence){case"PUUDUMINE_PR":a.practice=!0;break;case"PUUDUMINE_V":a.excused=!0;break;case"PUUDUMINE_H":a.late=!0;break;case"PUUDUMINE_P":a.withoutReason=!0}}function t(){return"SISSEKANNE_O"!==c.journalEntry.entryType}function v(a,b,c){switch(b){case"PUUDUMINE_PR":a.practice=c,a.withoutReason=!1,a.late=!1,a.excused=!1;break;case"PUUDUMINE_V":a.excused=c,a.withoutReason=!1,a.late=!1,a.practice=!1;break;case"PUUDUMINE_H":a.late=c,a.excused=!1,a.withoutReason=!1,a.practice=!1;break;case"PUUDUMINE_P":a.withoutReason=c,a.excused=!1,a.late=!1,a.practice=!1;break;default:a.practice=!1,a.withoutReason=!1,a.late=!1,a.excused=!1}}function w(a){var b=c.acceptedAbsences?c.acceptedAbsences.filter(function(b){return b.journalStudent===a}):null;return b=null!==b?b[0]:null}function y(a,b){var c=o(b);return a&&a.lessons&&-1!==a.lessons.indexOf(c)}function A(a,b){if(b){var c=o(b);return a.lessons&&-1!==a.lessons.indexOf(c)?a.practice?"PUUDUMINE_PR":"PUUDUMINE_V":"PUUDUMINE_P"}return a.wholeDay?a.practice?"PUUDUMINE_PR":"PUUDUMINE_V":"PUUDUMINE_P"}function B(a){var b={entryType:a};F.objectmapper(b),c.journalEntry.nameEt=b.entryType.nameEt}function C(){c.journalStudents.forEach(function(a){a.apelTransferredFinalResult&&(c.journalEntryStudents[a.id].grade=a.apelTransferredFinalResult,c.journalEntryStudentChanged(a))})}c.journal=a.journal,c.gradeInputAsSelect=a.formState.gradeInputAsSelect,c.grades=a.grades,c.gradeInputRegex=a.gradeInputRegex,c.hideInvalid=a.hideInvalid,c.entryDateChanged=function(){d(!0)},c.lessonsChanged=function(){c.journalStudents.forEach(function(a){if(i.isActive(a.status)){var b=c.journalEntryStudents[a.id];c.journalEntry.lessons&&1!==c.journalEntry.lessons||!b.isLessonAbsence||(c.journalEntryStudents[a.id].isLessonAbsence=!1),c.journalEntryStudentChanged(a)}})},c.startLessonNrChanged=function(){f(!0)},c.hasSavedWholeDayAcceptedAbsence=function(a){var b=c.journalEntryStudents[a.id];return b&&b.hasWholeDayAcceptedAbsence&&("PUUDUMINE_V"===b.absence||"PUUDUMINE_PR"===b.absence)},c.hasAcceptedLessonAbsence=function(a,b){var d=c.journalEntryStudents[a.id];return d&&d.lessonAbsences[b]&&angular.isDefined(d.lessonAbsences[b].accepted)&&d.lessonAbsences[b].accepted},c.journalEntry={},c.selectedCapacityTypes={},c.journalEntryStudents={},c.forbiddenEntryTypes=[],x(c),angular.isDefined(b)&&(angular.extend(c.journalEntry,b),c.entryDateCalendar=c.journalEntry.entryDate,b.journalEntryStudents.forEach(function(a){a.gradeValue=a.grade?l.removePrefix(a.grade):null,c.journalEntryStudents[a.journalStudent]=a,g.convertStringToDates(a.journalEntryStudentHistories,["gradeInserted"]),F.objectmapper(a.journalEntryStudentHistories),r(a)}),d(!1),c.savedJournalEntryStudents=angular.copy(c.journalEntryStudents),b.journalEntryCapacityTypes.forEach(function(a){c.selectedCapacityTypes[a]=!0}),c.canDeleteEntries=t()),z(c,b),c.changedJournalEntryStudents=[],c.journalEntryStudentChanged=function(a){c.gradeInputAsSelect||(c.journalEntryStudents[a.id].gradeValue?c.journalEntryStudents[a.id].grade=l.addPrefix(c.journalEntryStudents[a.id].gradeValue):c.journalEntryStudents[a.id].grade=null),c.journalEntryStudents[a.id].journalStudent=a.id,-1===c.changedJournalEntryStudents.indexOf(c.journalEntryStudents[a.id])&&c.changedJournalEntryStudents.push(c.journalEntryStudents[a.id])},c.journalEntryStudentAbsenceChanged=function(a,b,d,e){var f=w(a.id);c.journalEntryStudents[a.id].journalStudent=a.id,"PUUDUMINE_P"===d&&angular.isObject(f)&&(d=A(f,e)),e?(angular.isObject(c.journalEntryStudents[a.id].lessonAbsences[e])||(c.journalEntryStudents[a.id].lessonAbsences[e]={}),c.journalEntryStudents[a.id].lessonAbsences[e].lessonNr=e,c.journalEntryStudents[a.id].lessonAbsences[e].absence=b?d:null,c.journalEntryStudents[a.id].lessonAbsences[e].accepted=b?y(f,e):!1):c.journalEntryStudents[a.id].absence=b?d:null,-1===c.changedJournalEntryStudents.indexOf(c.journalEntryStudents[a.id])&&c.changedJournalEntryStudents.push(c.journalEntryStudents[a.id]);var g=e?c.journalEntryStudents[a.id].lessonAbsences[e]:c.journalEntryStudents[a.id];v(g,d,b)},c.setJournalEntryTypeChanged=function(a){B(a),"SISSEKANNE_L"===a&&C()},c.removeStudentHistory=function(a){c.journalEntryStudents[a.id].journalStudent=a.id,c.journalEntryStudents[a.id].removeStudentHistory=!0,c.journalEntryStudents[a.id].grade=null,c.journalEntryStudents[a.id].gradeValue=null,-1===c.changedJournalEntryStudents.indexOf(c.journalEntryStudents[a.id])&&c.changedJournalEntryStudents.push(c.journalEntryStudents[a.id])},c["delete"]=function(){k.confirmDialog({prompt:"journal.entryDeleteConfirm"},function(){new N(c.journalEntry).$delete().then(function(){j.info("main.messages.delete.success"),p(),u(),q(a.formState.showAllStudentsModel)})["catch"](angular.noop)})}},function(b){var c=angular.extend({},b.journalEntry);c.journalEntryStudents=b.changedJournalEntryStudents,y(b.selectedCapacityTypes,c),c.entryDate||delete c.entryDate;var d=new N(c);angular.isDefined(c.id)?d.$update().then(function(){j.info("main.messages.create.success"),p(),u(),q(a.formState.showAllStudentsModel)}):d.$save().then(function(){j.info("main.messages.create.success"),p(),u(),q(a.formState.showAllStudentsModel)})})}function B(b){var c=!0;return a.formState.gradeInputAsSelect||b.forEach(function(a){a.gradeValue&&!a.grade&&(c=!1)}),c}function C(){var b=!1;a.journal.journalEntriesByDate.forEach(function(a){a.quickUpdate&&(b=!0)}),b||a.finished(!1)}function D(){(new O).$update({id:a.journal.id}).then(function(b){j.info("journal.messages.confirmed"),"ROLL_A"!==a.auth.roleCode?a.back("#/journal/"+b.id+"/view"):(a.journal.canBeConfirmed=b.canBeConfirmed,a.journal.canBeUnconfirmed=b.canBeUnconfirmed,a.$parent.journal.status=b.status)})}function E(){a.materials=e.endpoint("/studyMaterial/journal/"+a.journal.id+"/materials").query(),a.materials.$promise.then(function(a){m.all(R.promises).then(function(){R.objectmapper(a)})})}a.auth=b.current.locals.auth,a.gradeUtil=l;var F=h.valuemapper({entryType:"SISSEKANNE",grade:"KUTSEHINDAMINE",absence:"PUUDUMINE"}),G="journal",H=b.current.locals.auth.school.id;a.grades=h.queryForDropdown({mainClassCode:"KUTSEHINDAMINE"}),a.gradeInputRegex="^X$|^A$|^MA$|^1$|^2$|^3$|^4$|^5$";var I=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17],J=33,K=49;a.formState={gradeInputAsSelect:!0,showAllStudentsModel:!1};var L=o.loadState(H,G);a.hideInvalid=function(a){return!h.isValid(a)},a.finished=function(b){var c=b?K:J;angular.element(document.getElementsByClassName("container")).css("height",Math.min(10,a.journal.journalStudents.length)*c+40+18+"px")},angular.element(d).bind("resize",function(){a.windowHeight=d.innerHeight});var M=b.current.locals.entity;angular.isDefined(M)&&(a.formState.lessonInfo=e.endpoint("/journals/"+M.id+"/journalEntry/lessonInfo").get(),a.formState.xlsUrl="journals/"+M.id+"/journal.xls",t(M)),a.searchStudent=function(){k.showDialog("journal/journal.searchStudent.dialog.html",function(a){a.selectedStudents=[],a.$watch("criteria.studentGroupObject",function(){a.criteria.studentGroupId=a.criteria.studentGroupObject?a.criteria.studentGroupObject.id:null}),e.createQueryForm(a,"/journals/"+M.id+"/otherStudents",{}),a.loadData()},function(b){e.endpoint("/journals/"+M.id+"/addStudentsToJournal").save({students:b.selectedStudents},function(){j.info("journal.messages.studentSuccesfullyAdded"),q(a.formState.showAllStudentsModel)})})},a.enrollStudents=function(){e.endpoint("/journals/"+M.id+"/moodle/enrollStudents").save(null,function(a){k.showDialog("components/moodle.enroll.dialog.html",function(b){b.moodleResponse=a},v,v)})},a.importGradeItems=function(){e.endpoint("/journals/"+M.id+"/moodle/importGradeItems").save(null,function(){j.info("moodle.messages.gradeItemsImported"),v()})},a.importAllGrades=function(){e.endpoint("/journals/"+M.id+"/moodle/importAllGrades").save(null,function(){j.info("moodle.messages.allGradesImported"),v()})},a.importMissingGrades=function(){e.endpoint("/journals/"+M.id+"/moodle/importMissingGrades").save(null,function(){j.info("moodle.messages.missingGradesImported"),v()})},a.removeStudentFromJournal=function(b){k.confirmDialog({prompt:"journal.studentDeleteconfirm"},function(){e.endpoint("/journals/"+M.id+"/removeStudentsFromJournal").save({students:[b]},function(){j.info("journal.messages.studentSuccesfullyRemoved"),q(a.formState.showAllStudentsModel)})})},a.journalEntryTypeColors={SISSEKANNE_T:"grey-50",SISSEKANNE_E:"amber-100",SISSEKANNE_I:"lime-100",SISSEKANNE_H:"pink-50",SISSEKANNE_L:"pink-300",SISSEKANNE_O:"light-blue-50",SISSEKANNE_P:"teal-100",SISSEKANNE_R:"indigo-100"},a.journalEntryTypes={},h.queryForDropdown({mainClassCode:"SISSEKANNE"},function(b){a.journalEntryTypes=h.toMap(b),angular.equals({},L)?w():w(L.selectedEntryTypes)}),a.updateSelectedEntryTypes=function(){var b=Object.values(a.journalEntryTypes).filter(function(a){return a._selected}).map(function(a){return a.code});o.changeState(H,G,{selectedEntryTypes:b}),a.$broadcast("refreshFixedColumns")},a.getEntryColor=function(b){return a.journalEntryTypeColors[b]};var N=e.endpoint("/journals/"+M.id+"/journalEntry");a.addNewEntry=function(){A()},a.editJournalEntry=function(a){N.get({id:a},function(a){A(a)})},a.quickUpdate=function(b){a.finished(!0),b.quickUpdate=!0,b.quickUpdateStudents=[];for(var c in b.journalStudentResults)if(b.journalStudentResults.hasOwnProperty(c)){var d=b.journalStudentResults[c][0];angular.isObject(b.quickUpdateStudents[c])||(b.quickUpdateStudents[c]={}),b.quickUpdateStudents[c]={id:d.journalEntryStudentId,journalStudent:d.journalStudentId,grade:d.grade?d.grade.code:null,gradeValue:d.grade?l.removePrefix(d.grade.code):null,isRemark:d.isRemark,addInfo:d.addInfo}}},a.saveQuickUpdate=function(b){var c=Object.values(b.quickUpdateStudents),d=B(c);return d?void e.endpoint("/journals/"+a.journal.id+"/journalEntry/quickUpdate").save({journalEntryId:b.id,journalEntryStudents:c,allStudents:a.formState.showAllStudentsModel}).$promise.then(function(c){var d=[];for(var e in c)c.hasOwnProperty(e)&&!isNaN(e)&&(d[e]=c[e]);for(var f=0;f<a.journal.journalEntriesByDate.length;f++){var g=a.journal.journalEntriesByDate[f];if(b.id===g.id){g.journalStudentResults=d;for(var h in g.journalStudentResults)g.journalStudentResults.hasOwnProperty(h)&&s(g.journalStudentResults[h]);g.quickUpdate=!1,C();break}}}):void j.error("main.messages.form-has-errors")},a.cancelQuickUpdate=function(a){a.quickUpdate=!1,C()},a.quickUpdateGradeChanged=function(b,c){var d=b.quickUpdateStudents[c];angular.isDefined(d.journalStudent)||(d.journalStudent=c),a.formState.gradeInputAsSelect||(d.gradeValue&&new RegExp(a.gradeInputRegex).test(d.gradeValue)?d.grade=l.addPrefix(d.gradeValue):d.grade=null)},a.quickUpdateAddInfoChanged=function(a,b){var c=a.quickUpdateStudents[b];angular.isDefined(c.journalStudent)||(c.journalStudent=b)},a.moduleDescriptionDialog=function(a){k.showDialog("journal/journal.moduleDescription.dialog.html",function(b){b.moduleDescription=a,b.isDistinctiveAssessment="KUTSEHINDAMISVIIS_E"===a.assessment?!0:!1})},a.individualCurriculumDialog=function(a){k.showDialog("journal/journal.individualCurriculum.dialog.html",function(b){b.individualCurriculum=a})},a.showAllStudents=function(){q(a.formState.showAllStudentsModel)};var O=e.endpoint("/journals/confirm"),P=e.endpoint("/journals/unconfirm");a.confirm=function(){k.confirmDialog({prompt:"journal.prompt.confirm"},function(){e.endpoint("/journals/"+a.journal.id+"/withoutFinalResult/").query().$promise.then(function(a){if(f.isEmpty(a))D();else{var b=a.map(function(a){return a.fullname}).join(", ");k.confirmDialog({prompt:"journal.prompt.someStudentsDoNotHaveFinalResult",students:b},D)}})})},a.unconfirm=function(){k.confirmDialog({prompt:"journal.prompt.unconfirm"},function(){(new P).$update({id:a.journal.id}).then(function(b){j.info("journal.messages.unconfirmed"),a.journal.canBeConfirmed=b.canBeConfirmed,a.journal.canBeUnconfirmed=b.canBeUnconfirmed,a.$parent.journal.status=b.status})})},a.getFileUrl=n.getUrl;var Q=e.endpoint("/studyMaterial/connect"),R=h.valuemapper({typeCode:"OPPEMATERJAL"});E(),a.deleteConnection=function(a,b){k.confirmDialog({prompt:b>1?"studyMaterial.deleteconfirm":"studyMaterial.deletelastconfirm"},function(){var b=new Q(a);b.$delete().then(function(){j.info("main.messages.delete.success"),E()})["catch"](angular.noop)})},a.addExisting=function(){if(!a.existingMaterial)return void j.error("main.messages.form-has-errors");var b=new Q;b.studyMaterial=a.existingMaterial.id,b.journal=a.journal.id,b.$save().then(function(){a.existingMaterial=void 0,E()})},a.openApelResultsDialog=function(a){k.showDialog("journal/journal.apel.results.dialog.html",function(b){b.journalStudent=a})},a.openRemarkDialog=function(a){k.showDialog("journal/journal.remarks.dialog.html",function(b){b.journalStudent=a})}}]),angular.module("hitsaOis").config(["$routeProvider","USER_ROLES",function(a,b){a.when("/journals",{templateUrl:"journal/journal.list.html",controller:"JournalListController",controllerAs:"journalListController",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:function(a,c){return("ROLL_A"===a.roleCode||"ROLL_O"===a.roleCode)&&a.vocational&&c.indexOf(b.ROLE_OIGUS_V_TEEMAOIGUS_PAEVIK)}}}).when("/journal/:id/:action",{templateUrl:function(a){return"edit"===a.action?"journal/journal.html":"journal/journal.view.html"},controller:"JournalController",controllerAs:"journalController",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],entity:["QueryUtils","$route",function(a,b){return a.endpoint("/journals").get({id:b.current.params.id}).$promise}],isView:["$route",function(a){return"view"===a.current.params.action}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_PAEVIK,b.ROLE_OIGUS_M_TEEMAOIGUS_PAEVIK]}})}]),function(){function a(a){return a.reduce(function(a,b){return null!==b&&isFinite(b)&&b>0&&(a+=b),a},0)}function b(a){for(var b=[],c=0,d=a.formState.weekNrs.length;d>c;c++)b[c]=0;return b}function c(a){for(var b=[],c=0,d=a.formState.studyPeriods.length;d>c;c++)b[c]=0;return b}function d(b,c,d){var e=a(c.hours[d]);b.formState.journalTotals[c.id][d]=e}function e(b,c,d){var e=c.hours[d];b.formState.studyPeriods.forEach(function(b){c.spHours[d][b.arrayIndex]=a(e.slice(b.weekIndex[0],b.weekIndex[1]))})}function f(a,b){angular.isObject(a.formState.journalTotals[b.id]._spTotals)||(a.formState.journalTotals[b.id]._spTotals={}),a.formState.studyPeriods.forEach(function(c,d){a.formState.journalTotals[b.id]._spTotals[d]=Object.values(b.spHours).reduce(function(a,b){return angular.isObject(b)&&!isNaN(b[d])&&(a+=b[d]),a},0)})}function g(b,c){angular.isObject(b.formState.capGrandTotalsSp)||(b.formState.capGrandTotalsSp={},b.formState.grandTotalsSp={}),angular.isObject(b.formState.capGrandTotalsSp[c])||(b.formState.capGrandTotalsSp[c]={}),b.formState.studyPeriods.forEach(function(d){angular.isArray(b.formState.grandTotals[c])&&(b.formState.capGrandTotalsSp[c][d.arrayIndex]=a(b.formState.grandTotals[c].slice(d.weekIndex[0],d.weekIndex[1])),b.formState.grandTotalsSp[d.arrayIndex]=a(b.formState.grandTotals._._.slice(d.weekIndex[0],d.weekIndex[1])))})}function h(b,c,d){var e=b.formState.capacityTypes.reduce(function(a,b){var e=c.hours[b.code];if(void 0!==e){var f=e[d];null!==f&&isFinite(f)&&f>0&&(a+=f)}return a},0),f=b.formState.journalTotals[c.id];
f._[d]=e,f.__=a(f._)}function i(b,c,d,e){c._[d]=a(c[d]);var f=b.formState.capacityTypes.reduce(function(a,b){var d=c[b.code];return void 0!==d&&(a+=d[e]),a},0);c._._[e]=f,c.__=a(c._._)}function j(a,b,c,d,e){var f=a.formState.studyPeriods[d],g=b.spHours[c][d],h=g/f.weekNrs.length;h%1!==0&&(h=Math.ceil(h));for(var i=0,j=f.weekIndex[0],k=0;k<f.weekNrs.length;k++)b.hours[c][j]=h,i+=h,e&&a.updateTotals(b,c,j),i===Number(g)&&(h=0),(g-i)/(f.weekNrs.length-k-1)%1===0&&(h=(g-i)/(f.weekNrs.length-k-1)),j+=1}angular.module("hitsaOis").controller("LessonplanSearchController",["$location","$mdDialog","$route","$scope","USER_ROLES","DataUtils","QueryUtils","Session","message",function(a,b,c,d,e,f,g,h,i){function j(a,b){for(var c=[],d=a.startDate,e=a.endDate,g=0;g<b.length;g++)f.isValidObject(d,e,b[g].validFrom,b[g].validThru)&&-1===c.indexOf(b[g].id)&&c.push(b[g].id);return c}function k(a,b){return function(c){return-1===a.indexOf(c.id)&&-1!==b.indexOf(c.id)}}d.auth=c.current.locals.auth,d.canView=-1!==d.auth.authorizedRoles.indexOf(e.ROLE_OIGUS_V_TEEMAOIGUS_TUNNIJAOTUSPLAAN),d.canEdit=-1!==d.auth.authorizedRoles.indexOf(e.ROLE_OIGUS_M_TEEMAOIGUS_TUNNIJAOTUSPLAAN);var l=h.school||{};d.formState={higher:l.higher,vocational:l.vocational},d.currentNavItem=c.current.$$route.data.currentNavItem;var m="/lessonplans";g.createQueryForm(d,m,{order:"sg.code"}),d.load=function(){return d.vocationalSearchForm.$valid?void d.loadData():(i.error("main.messages.form-has-errors"),!1)},d.directiveControllers=[];var n=d.clearCriteria;d.clearCriteria=function(){n(),d.directiveControllers.forEach(function(a){a.clear()})},d.newLessonplan=function(){var c=d.formState,e=d.criteria.studyYear;b.show({controller:["$scope",function(d){d.formState=c,d.record={studyYear:e},d.$watchGroup(["record.studyYear","record.studentGroup"],function(){if(d.formState.previousLessonplans=[],angular.isDefined(d.record.studyYear)&&angular.isDefined(d.record.studentGroup)){var a=d.formState.studyYears.find(function(a){return a.id===d.record.studyYear}),b=d.formState.studentGroups.find(function(a){return a.id===d.record.studentGroup}),c=b?d.formState.curriculumLessonPlans[b.curriculum]:null;c&&(d.formState.previousLessonplans=c.filter(function(b){return new Date(b.studyYearEndDate).getTime()<=new Date(a.endDate).getTime()}))}if(angular.isDefined(d.record.studentGroup)){var e=angular.isDefined(d.formState.studentGroupMap[d.record.studyYear].find(function(a){return a.id===d.record.studentGroup}));e||(d.record.studentGroup=null)}if(angular.isDefined(d.record.previousLessonplan)){var f=angular.isDefined(d.formState.previousLessonplans.find(function(a){return a.lessonplan===d.record.previousLessonplan}));f||(d.record.previousLessonplan=null)}}),d.search=function(a){if(!a)return[];var b=new RegExp("^.*"+a.replace("%",".*").toUpperCase()+".*$");return d.formState.studentGroups.filter(function(a){return b.test(d.$parent.currentLanguageNameField(a).toUpperCase())}).filter(function(a){return angular.isDefined(d.formState.studentGroupMap[d.record.studyYear].find(function(b){return b.id===a.id}))})},d.create=function(){return d.newLessonPlanForm.$valid?void g.endpoint(m).save(d.record).$promise.then(function(c){b.hide(),a.url(m+"/vocational/"+c.id+"/edit")}):void i.error("main.messages.form-has-errors")},d.cancel=b.hide}],templateUrl:"lessonplan/new.lessonplan.dialog.html",clickOutsideToClose:!0})},g.endpoint(m+"/searchFormData").search().$promise.then(function(a){var b=a.studyYears;if(d.formState.studyYears=b,!d.criteria.studyYear){var c=f.getCurrentStudyYearOrPeriod(d.formState.studyYears);c&&(d.criteria.studyYear=c.id)}d.criteria.studyYear&&d.loadData();for(var e=a.studentGroups,g=a.studentGroupMapping,h={},i=0,l=b.length;l>i;i++){var m=b[i].id,n=g[m]||[],o=j(b[i],e);h[m]=e.filter(k(n,o))}d.formState.studentGroups=e,d.formState.studentGroupMap=h,d.formState.curriculumVersions=a.curriculumVersions,d.formState.curriculumLessonPlans=a.curriculumLessonPlans}),d.$watch("criteria.teacherObject",function(a){d.criteria.teacher=angular.isObject(a)?a.id:a})}]).controller("LessonplanTeacherSearchController",["$route","$scope","DataUtils","QueryUtils","Session","message",function(a,b,c,d,e,f){b.auth=a.current.locals.auth;var g=e.school||{};b.formState={higher:g.higher,vocational:g.vocational},b.currentNavItem=a.current.$$route.data.currentNavItem;var h="/lessonplans/byteacher";b.load=function(){return b.vocationalTeacherSearchForm.$valid?void b.loadData():(f.error("main.messages.form-has-errors"),!1)},b.formState.studyYears=d.endpoint("/autocomplete/studyYears").query(),b.formState.studyYears.$promise.then(function(){if(!b.criteria.studyYear){var a=c.getCurrentStudyYearOrPeriod(b.formState.studyYears);a&&(b.criteria.studyYear=a.id)}b.criteria.studyYear&&b.loadData()}),d.createQueryForm(b,h,{})}]).controller("LessonplanController",["$rootScope","$route","$scope","$timeout","$window","USER_ROLES","Classifier","LessonPlanTableService","QueryUtils","dialogService","message","stateStorageService",function(k,l,m,n,o,p,q,r,s,t,u,v){function w(a){M=!1,N[0].scrollTop=a,n(function(){M=!0},1e3)}function x(){m.formState.shownWeeksCount=m.formState.weekNrs.filter(function(a){return a.show}).length}function y(){for(var a=0;a<m.formState.studyPeriods.length;a++)if(m.formState.studyPeriods[a]._selected)return!0;return!1}function z(a,b,c){var d=m.formState.moduleTotals[a.id],e=a.journals.reduce(function(a,d){var e=d.hours[b];return void 0!==e&&void 0!==e[c]&&(a+=e[c]*(1/d.groupProportion.value)),a},0);d[b][c]=e,i(m,d,b,c)}function A(a,b,c){var d=m.formState.spModuleTotals[a.id],e=a.journals.reduce(function(a,d){var e=d.spHours[b];return void 0!==e&&void 0!==e[c]&&(a+=e[c]*(1/d.groupProportion.value)),a},0);d[b][c]=e,i(m,d,b,c)}function B(a,b){var c=Object.keys(m.formState.moduleMap).reduce(function(c,d){var e=m.formState.moduleTotals[d],f=e[a];return void 0!==f&&(c+=f[b]),c},0),d=m.formState.grandTotals;d[a][b]=c,i(m,d,a,b)}function C(a){a||(a=m.formState.studyPeriods.map(function(a){return a.id})),m.formState.studyPeriods.forEach(function(b){b._selected=-1!==a.indexOf(b.id)})}function D(i){m.formState.capacityTypes=i.lessonPlanCapacities,m.formState.teachers=i.teachers,i.modules.forEach(function(a){m.formState.moduleMap[a.id]=a,m.formState.spModuleTotals[a.id]={_:{_:c(m)}},m.formState.moduleTotals[a.id]={_:{_:b(m)}},a.journals.forEach(function(g){K.objectmapper(g),g.spHours={},g.spTotals={},g.lessonPlanModule=a.id,m.formState.journalTotals[g.id]={_:b(m)},m.formState.capacityTypes.forEach(function(f){var h=f.code;g.spHours[h]={};var i=g.hours[h];if(void 0!==i){d(m,g,h),e(m,g,h);var j=m.formState.moduleTotals[a.id];void 0===j[h]&&(j[h]=b(m));var k=m.formState.spModuleTotals[a.id];void 0===k[h]&&(k[h]=c(m));var l=m.formState.grandTotals;void 0===l[h]&&(l[h]=b(m))}});for(var i=0,j=m.formState.weekNrs.length;j>i;i++)h(m,g,i);f(m,g),g.requiredLessons={},g.themes.forEach(function(a){for(var b in a.hours)angular.isUndefined(g.requiredLessons[b])&&(g.requiredLessons[b]=0),g.requiredLessons[b]+=a.hours[b]})}),m.formState.capacityTypes.forEach(function(b){var c=b.code,d=m.formState.moduleTotals[a.id];if(void 0!==d[c]){for(var e=0,f=m.formState.weekNrs.length;f>e;e++)z(a,c,e);for(var g=0,h=m.formState.studyPeriods.length;h>g;g++)A(a,c,g)}})}),m.formState.capacityTypes.forEach(function(a){var b=a.code,c=m.formState.grandTotals;if(void 0!==c[b])for(var d=0,e=m.formState.weekNrs.length;e>d;d++)B(b,d);g(m,b)}),i.teachers.forEach(function(b){b.studyLoadByPeriod={},b.studyLoadByPeriodAndCapacity={},m.formState.studyPeriods.forEach(function(c){b.studyLoadByWeek&&(b.studyLoadByPeriod[c.arrayIndex]=a(b.studyLoadByWeek.slice(c.weekIndex[0],c.weekIndex[1]))),b.studyLoadByWeekAndCapacity&&m.formState.capacityTypes.forEach(function(d){var e=d.code,f=b.studyLoadByWeekAndCapacity[e];void 0!==f&&(void 0===b.studyLoadByPeriodAndCapacity[e]&&(b.studyLoadByPeriodAndCapacity[e]={}),b.studyLoadByPeriodAndCapacity[e][c.arrayIndex]=a(f.slice(c.weekIndex[0],c.weekIndex[1])))})})}),m.record=i,E(),m.updateStudyPeriods(),w(m.formState.scrollPosition)}function E(){O=angular.toJson(m.record)}function F(){k.back("#/lessonplans/vocational")}m.auth=l.current.locals.auth;var G=l.current.params.id,H=m.auth.school.id,I="lessonplan",J="/lessonplans",K=q.valuemapper({groupProportion:"PAEVIK_GRUPI_JAOTUS"}),L=s.endpoint(J);if(m.isView=l.current.locals.isView,m.canEdit=-1!==m.auth.authorizedRoles.indexOf(p.ROLE_OIGUS_M_TEEMAOIGUS_TUNNIJAOTUSPLAAN),m.lessonPlanId=G,!m.isView&&!m.canEdit)return u.error("main.messages.error.nopermission"),void k.back("#/lessonplans/vocational/"+G+"/view");m.formState={showWeeks:!0,scrollPosition:0};var M=!0,N=angular.element(document.getElementById("lessonplan-container"));N.bind("scroll",function(){M&&(m.formState.scrollPosition=N[0].scrollTop)}),m.$on("$locationChangeStart",function(a,b){if(-1!==b.indexOf("journal")){var c={};c[G]=m.formState.scrollPosition,v.changeState(H,I,{scrollPosition:c})}}),m.showWeeksChanged=function(){v.changeState(H,I,{showWeeks:m.formState.showWeeks}),r.generateLessonPlan(m,m.isView)},m.showTotalsChanged=function(){v.changeState(H,I,{showTotals:m.formState.showTotals}),r.generateLessonPlan(m,m.isView)},m.updateStudyPeriods=function(){var a=m.formState.studyPeriods.filter(function(a){return a._selected}).map(function(a){return a.id});m.formState.weekNrs.forEach(function(b){b.show=-1!==a.indexOf(b.spId)}),m.atLeastOneShownPeriod=y(),v.changeState(H,I,{showWeeks:m.formState.showWeeks,showTotals:m.formState.showTotals,selectedStudyPeriods:a}),x(),r.generateLessonPlan(m,m.isView)};var O;s.loadingWheel(m,!0),s.endpoint(J).get({id:G}).$promise.then(function(a){m.formState.studyPeriods=a.studyPeriods;var c=0;m.formState.studyPeriods.forEach(function(a,b){a.weekIndex=[c,c+a.weekNrs.length],a.arrayIndex=b,c+=a.weekNrs.length}),m.formState.weekNrs=[],a.studyPeriods.forEach(function(a,b){for(var c=0;c<a.weekNrs.length;c++)m.formState.weekNrs.push({spId:a.id,spIndex:b,nr:a.weekNrs[c],endOfPeriod:c===a.weekNrs.length-1,shown:!0})}),m.formState.weekBeginningDates=a.weekBeginningDates,m.formState.legends=a.legends.reduce(function(a,b){return a[b.weekNr]=b.color,a},{}),delete a.studyPeriods,delete a.weekNrs,delete a.weekBeginningDates,delete a.legends,m.formState.moduleMap={},m.formState.rowTotals={},m.formState.journalTotals={},m.formState.moduleTotals={},m.formState.spModuleTotals={},m.formState.grandTotals={_:{_:b(m)}},m.formState.studyPeriodMonths=a.studyPeriod%12,m.formState.studyPeriodYears=Math.floor(a.studyPeriod/12),m.formState.xlsUrl="lessonplans/"+G+"/lessonplan.xls";var d=v.loadState(H,I);angular.equals({},d)?C():(m.formState.showWeeks=d.showWeeks,m.formState.showTotals=d.showTotals,m.formState.scrollPosition=d.scrollPosition&&d.scrollPosition[G]?d.scrollPosition[G]:0,C(d.selectedStudyPeriods)),D(a),s.loadingWheel(m,!1),m.windowWidth=o.innerWidth,angular.element(angular.element(document.getElementById("lessonplan-container"))).css("height",o.innerHeight-340+"px")}),angular.element(o).bind("resize",function(){angular.element(angular.element(document.getElementById("lessonplan-container"))).css("height",o.innerHeight-340+"px")}),m.updateTotals=function(a,b,c){var e=a.hours[b],g=parseInt(e[c],10);(isNaN(g)||0>g)&&(g=void 0),g!==e[c]&&(e[c]=g),d(m,a,b),h(m,a,c),z(m.formState.moduleMap[a.lessonPlanModule],b,c),B(b,c),m.updateSpRowByWeek(a,b,c),f(m,a),A(m.formState.moduleMap[a.lessonPlanModule],b,m.formState.weekNrs[c].spIndex),m.updateSpGrandTotals(b,c)},m.getCapacityByCode=function(a){return m.formState.capacityTypes?m.formState.capacityTypes.find(function(b){return b.code===a}):void 0},m.getLegendByWeek=function(a){return r.getLegendByWeek(m,a)},m.updateLessonCountByStudyPeriod=function(a,b,c){j(m,a,b,c,!0)},m.updateSpGrandTotals=function(b,c){angular.isObject(m.formState.capGrandTotalsSp)||(m.formState.capGrandTotalsSp={},m.formState.grandTotalsSp={}),angular.isObject(m.formState.capGrandTotalsSp[b])||(m.formState.capGrandTotalsSp[b]={});var d=m.formState.studyPeriods.find(function(a){return a.weekIndex[0]<=c&&a.weekIndex[1]>=c});m.formState.capGrandTotalsSp[b][d.arrayIndex]=a(m.formState.grandTotals[b].slice(d.weekIndex[0],d.weekIndex[1])),m.formState.grandTotalsSp[d.arrayIndex]=a(m.formState.grandTotals._._.slice(d.weekIndex[0],d.weekIndex[1]))},m.updateSpRowByWeek=function(b,c,d){var e=b.hours[c],f=m.formState.studyPeriods.find(function(a){return a.weekIndex[0]<=d&&a.weekIndex[1]>=d});b.spHours[c][f.arrayIndex]=a(e.slice(f.weekIndex[0],f.weekIndex[1]))},m.update=function(){var a=new L(m.record);a.$update().then(function(a){u.updateSuccess(),D(a),E(),m.$broadcast("refreshFixedColumns")})},m.teacherCapacities=function(b){t.showDialog("lessonplan/teacher.capacities.dialog.html",function(c){c.isView=m.isView,c.formState=m.formState,c.formState.teacherTotals={},c.atLeastOneShownPeriod=m.atLeastOneShownPeriod,c.teachers=m.record.teachers,c.journal=b,c.journalCapacities=r.getCapacityTypes(c.formState.capacityTypes,b.hours),n(function(){c.$broadcast("refreshFixedTableHeight")},0),c.journal.teachers.forEach(function(b){c.formState.teacherTotals[b.id]={},b.spHours={},c.journalCapacities.forEach(function(d){var e=d.code;b.spHours[e]={};var f=b.hours[e];void 0!==f&&c.formState.studyPeriods.forEach(function(c){b.spHours[e][c.arrayIndex]=a(f.slice(c.weekIndex[0],c.weekIndex[1]))});var g=a(f);c.formState.teacherTotals[b.id][e]=g})}),c.updateTotals=function(b,d,e){var f=b.hours[d],g=parseInt(f[e],10);(isNaN(g)||0>g)&&(g=void 0),g!==f[e]&&(f[e]=g);var h=a(b.hours[d]);c.formState.teacherTotals[b.id][d]=h},c.getLegendByWeek=function(a){return r.getLegendByWeek(c,a)},c.updateLessonCountByStudyPeriod=function(a,b,d){j(c,a,b,d,!1)},c.getTeacherStudyLoad=function(a){return r.getTeacherStudyLoad(c.teachers,a)},c.getTeacherLoad=function(a){return r.getTeacherLoad(c.formState.studyPeriods,c.formState.teachers,a)},c.getPlannedLessonsTitle=function(a){return r.getPlannedLessonsTitle(a,c.formState.teachers,c.formState.capacityTypes)},c.getStudyLoadTitle=function(a,b){return r.getStudyLoadTitle(a,c.formState.teachers,c.formState.capacityTypes,b)},c.getStudyLoadSpTitle=function(a,b){return r.getStudyLoadSpTitle(a,c.formState.teachers,c.formState.capacityTypes,b)}},function(){m.update()})},m["delete"]=function(){t.confirmDialog({prompt:"lessonplan.prompt.deleteLessonplan"},function(){var a=new L(m.record);a.$delete().then(function(){u.info("main.messages.delete.success"),F()})["catch"](angular.noop)})},m.back=function(){O===angular.toJson(m.record)?F():t.confirmDialog({prompt:"lessonplan.changed.save",accept:"main.yes",cancel:"main.no"},function(){var a=new L(m.record);a.$update().then(u.updateSuccess).then(F)},function(){F()})}}]).controller("LessonplanTeacherViewController",["$route","$scope","LessonPlanTableService","QueryUtils",function(a,c,j,k){c.auth=a.current.locals.auth;var l=a.current.params.id,m=a.current.params.studyYear,n="/lessonplans/byteacher";c.formState={showWeeks:!0,showCapacityTypes:!0,xlsUrl:"lessonplans/byteacher/"+l+"/"+m+"/lessonplanbyteacher.xls"},c.keys=Object.keys,c.getCapacityTypes=function(a){return c.formState.capacityTypes?c.formState.capacityTypes.filter(function(b){return void 0!==a&&void 0!==a[b.code]}):void 0},c.getCapacityByCode=function(a){return j.getCapacityByCode(c.formState.capacityTypes,a)},c.getUniqueJournalThemes=function(a){return j.getUniqueJournalThemes(a)},c.sumSubjectHours=function(a){return angular.isDefined(c.formState.subjectCapacityTypes)?c.formState.subjectCapacityTypes.reduce(function(b,c){var d=a[c.studyPeriod];if(d){var e=d[c.code];e&&(b+=e)}return b},0):void 0},k.endpoint(n+"/:id/:studyYear").search({id:l,studyYear:m}).$promise.then(function(a){function j(b,c){return a.journals.reduce(function(a,d){var e=d.hours[c];return void 0!==e&&(a+=e[b]),a},0)}c.formState.capacityTypes=a.lessonPlanCapacities,c.formState.studyPeriods=a.studyPeriods;var k=0;c.formState.studyPeriods.forEach(function(a,b){a.weekIndex=[k,k+a.weekNrs.length],a.arrayIndex=b,k+=a.weekNrs.length}),c.formState.weekNrs=[],a.studyPeriods.forEach(function(a){for(var b=0;b<a.weekNrs.length;b++)c.formState.weekNrs.push({nr:a.weekNrs[b],endOfPeriod:b===a.weekNrs.length-1})}),c.formState.weekBeginningDates=a.weekBeginningDates,c.formState.rowTotals={},c.formState.journalTotals={},c.formState.grandTotals={_:{_:b(c)}},a.journals.forEach(function(a){a.spHours={},a.spTotals={},c.formState.journalTotals[a.id]={_:b(c)},c.formState.capacityTypes.forEach(function(f){var g=f.code;a.spHours[g]={};var h=a.hours[g];if(void 0!==h){d(c,a,g),e(c,a,g);var i=c.formState.grandTotals;void 0===i[g]&&(i[g]=b(c))}});for(var g=0,i=c.formState.weekNrs.length;i>g;g++)h(c,a,g);f(c,a)}),c.formState.capacityTypes.forEach(function(a){var b=a.code,d=c.formState.grandTotals;if(void 0!==d[b])for(var e=0,f=c.formState.weekNrs.length;f>e;e++)d[b][e]=j(e,b),i(c,d,b,e);g(c,b)}),c.formState.subjectCapacityTypes=[],c.formState.studyPeriods.forEach(function(a){for(var b=0;b<c.formState.capacityTypes.length;b++){var d=c.formState.capacityTypes[b];c.formState.subjectCapacityTypes.push({studyPeriod:a.id,code:d.code,value:d.value,endOfPeriod:b===c.formState.capacityTypes.length-1})}}),c.record=a})}])}(),angular.module("hitsaOis").controller("LessonplanJournalEditController",["$location","$route","$scope","$timeout","dialogService","message","Classifier","QueryUtils","$http",function(a,b,c,d,e,f,g,h,i){function j(){i.pendingRequests.length>0?d(j):c.journalForm.$setPristine()}function k(){var a=c.record.journalOccupationModuleThemes;return c.journalForm.theme.$setValidity("required",a&&a.length>0),c.journalForm.$setSubmitted(),c.journalForm.$valid?!0:(f.error("main.messages.form-has-errors"),!1)}function l(){c.record.id?c.record.$update().then(function(a){f.updateSuccess(),c.removedJournalTeacherIds={};for(var b=0;a.groups.length>b;b++)a.groups[b].group.modules=h.endpoint("/autocomplete/curriculumversionomodules").query({curriculumVersion:a.groups[b].curriculumVersion}),a.groups[b].group.themes=h.endpoint("/autocomplete/curriculumversionomodulethemes").query({addStudyYearToName:!0,existInOtherJournals:!0,journalId:o,studentGroupId:a.groups[b].studentGroup,curriculumVersionOmoduleId:a.groups[b].curriculumVersionOccupationModule});d(j)})["catch"](angular.noop):c.record.$save().then(function(){f.info("main.messages.create.success"),c.journalForm.$setPristine(),c.removedJournalTeacherIds={},a.url(s+"/"+c.record.id+"/edit?_noback&lessonPlanModule="+c.record.lessonPlanModuleId)})["catch"](angular.noop)}function m(){var a=[];if(c.record.journalOccupationModuleThemes.forEach(function(b){var d=c.formState.themeMap[b];d.existsInOtherJournals&&a.push(c.currentLanguageNameField(d))}),null!==c.record.groups)for(var b=0;b<c.record.groups.length;b++){var d=c.record.groups[b];d.curriculumVersionOccupationModuleThemes.forEach(function(b){var e=d.group.themes.filter(function(a){return a.id===b})[0];e.existsInOtherJournals&&a.push(c.currentLanguageNameField(e))})}return a}function n(){var a={};c.record.journalOccupationModuleThemes.forEach(function(b){var d=c.formState.themes.find(function(a){return a.id===b});for(var e in d.capacities)angular.isDefined(a[e])?a[e]+=d.capacities[e]:a[e]=d.capacities[e]});var b=c.formState.capacityTypes;b.forEach(function(b){angular.isDefined(a[b.code])?(b._selected=!0,angular.isDefined(b.hours)?b.hours=a[b.code]:b.hours=a[b.code]):(b._selected=!1,b.hours=0)})}c.auth=b.current.locals.auth;var o=b.current.params.id,p=b.current.params.lessonPlan,q=b.current.params.occupationModule,r=b.current.params.lessonPlanModule,s="/lessonplans/journals";c.formState={capacityTypes:h.endpoint("/autocomplete/schoolCapacityTypes").query({journalId:o,isHigher:!1,isTimetable:!0})},c.record=h.endpoint(s).get({id:o||"new",lessonPlan:p,occupationModule:q,lessonPlanModule:r?r:void 0}),c.record.$promise.then(function(a){if(c.formState.capacityTypes.$promise.then(function(){g.setSelectedCodes(c.formState.capacityTypes,c.record.journalCapacityTypes)}),h.endpoint("/autocomplete/studentgroups").query({valid:!0,higher:!1}).$promise.then(function(b){c.formState.studentGroups=b.filter(function(b){return b.id!==a.studentGroupId})}),c.formState.themes=a.themes,delete a.themes,c.formState.themeMap=c.formState.themes.reduce(function(a,b){return a[b.id]=b,a},{}),angular.isArray(a.groups))for(var b=0;a.groups.length>b;b++)a.groups[b].group.modules=h.endpoint("/autocomplete/curriculumversionomodules").query({curriculumVersion:a.groups[b].curriculumVersion}),a.groups[b].group.themes=h.endpoint("/autocomplete/curriculumversionomodulethemes").query({addStudyYearToName:!0,existInOtherJournals:!0,journalId:o,studentGroupId:a.groups[b].studentGroup,curriculumVersionOmoduleId:a.groups[b].curriculumVersionOccupationModule}),d(j);n(),c.record.lessonPlan=a.lessonPlan}),c.lessonPlanModule=b.current.params.lessonPlanModule,c.searchStudentGroups=function(a){if(!a)return[];var b=new RegExp("^.*"+a.replace("%",".*").toUpperCase()+".*$");return c.formState.studentGroups.filter(function(a){return b.test(c.$parent.currentLanguageNameField(a).toUpperCase())})},c.orderByThemeName=function(a){return c.currentLanguageNameField(c.formState.themeMap[a])},c.update=function(){if(k()){if(c.record.journalCapacityTypes=g.getSelectedCodes(c.formState.capacityTypes),0===c.record.journalCapacityTypes.length)return void f.error("lessonplan.journal.noJournalCapacityTypes");var a=m();a.length>0?e.confirmDialog({prompt:"lessonplan.journal.themeExistInOtherJournalsConfirm",themes:a.join(", ")},function(){l()}):l()}},c.filter=function(a,b){return b.filter(function(b){return b.id===a})[0]},c["delete"]=function(){e.confirmDialog({prompt:"lessonplan.journal.deleteconfirm"},function(){c.record.$delete().then(function(){f.info("main.messages.delete.success"),a.url("/lessonplans/vocational/"+c.record.lessonPlan+"/edit")})["catch"](angular.noop)})},c.addTheme=function(){var a=c.formState.theme;if(a){if(null===c.record.journalOccupationModuleThemes&&(c.record.journalOccupationModuleThemes=[]),-1!==c.record.journalOccupationModuleThemes.indexOf(a))return f.error("lessonplan.journal.duplicatetheme"),void c.journalForm.$setPristine();c.record.journalOccupationModuleThemes.push(a),n()}c.formState.theme=null},c.deleteTheme=function(a){var b=c.record.journalOccupationModuleThemes.indexOf(a);-1!==b&&c.record.journalOccupationModuleThemes.splice(b,1),n(),c.journalForm.$setDirty()},c.deleteRoom=function(a){var b=c.record.journalRooms.indexOf(a);-1!==b&&c.record.journalRooms.splice(b,1),c.journalForm.$setDirty()},c.addTeacher=function(){return null===c.record.journalTeachers&&(c.record.journalTeachers=[]),c.record.journalTeachers.some(function(a){return a.teacher.id===c.formState.teacher.id})?(f.error(c.auth.higher?"lessonplan.journal.duplicateteacherHigher":"lessonplan.journal.duplicateteacherVocational"),void c.journalForm.$setPristine()):(c.record.journalTeachers.push({id:c.removedJournalTeacherIds?c.removedJournalTeacherIds[c.formState.teacher.id]:null,teacher:c.formState.teacher}),void(c.formState.teacher=void 0))},c.deleteTeacher=function(a){var b=-1;c.record.journalTeachers.forEach(function(c,d){c.id===a.id&&(b=d)}),-1!==b&&c.record.journalTeachers.splice(b,1),c.removedJournalTeacherIds||(c.removedJournalTeacherIds={}),c.removedJournalTeacherIds[a.teacher.id]=a.id,c.journalForm.$setDirty()},c.addGroup=function(){var a=c.formState.group;return(null===c.record.groups||"undefined"==typeof c.record.groups)&&(c.record.groups=[]),c.record.groups.some(function(b){return b.group.id===a.id})?void f.error("lessonplan.journal.duplicategroup"):(h.endpoint("/autocomplete/curriculumversionomodules").query({curriculumVersion:a.curriculumVersion}).$promise.then(function(b){a.modules=b,c.record.groups.push({group:a,studentGroup:a.id})}),void(c.formState.group=void 0))},c.$watch("formState.room",function(){if(angular.isDefined(c.formState.room)&&null!==c.formState.room){if(c.record.journalRooms.some(function(a){return a.id===c.formState.room.id}))return f.error("lessonplan.journal.duplicateroom"),c.formState.room=void 0,void c.journalForm.$setPristine();c.record.journalRooms.push(c.formState.room),c.formState.room=void 0}}),c.$watch("formState.theme",function(){angular.isDefined(c.formState.theme)&&null!==c.formState.theme&&c.addTheme()}),c.$watch("formState.teacher",function(){angular.isDefined(c.formState.teacher)&&null!==c.formState.teacher&&c.addTeacher()}),c.$watch("formState.group",function(){angular.isDefined(c.formState.group)&&null!==c.formState.group&&c.addGroup()}),c.newSelectedModule=function(a){null!==a.curriculumVersionOccupationModule&&""!==a.curriculumVersionOccupationModule?(a.curriculumVersionOccupationModuleThemes=null,h.endpoint("/autocomplete/curriculumversionomodulethemes").query({addStudyYearToName:!0,existInOtherJournals:!0,journalId:o,studentGroupId:a.studentGroup,curriculumVersionOmoduleId:a.curriculumVersionOccupationModule}).$promise.then(function(b){a.group.themes=b})):a.group.themes=null},c.deleteGroup=function(a){var b=-1;c.record.groups.forEach(function(c,d){c.studentGroup===a.studentGroup&&(b=d)}),-1!==b&&c.record.groups.splice(b,1),c.journalForm.$setDirty()}}]),angular.module("hitsaOis").config(["$routeProvider","USER_ROLES",function(a,b){a.when("/lessonplans/vocational",{templateUrl:"lessonplan/vocational.search.html",controller:"LessonplanSearchController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:function(a,c,d){return"ROLL_A"===a.roleCode&&d.intersect(c,[b.ROLE_OIGUS_V_TEEMAOIGUS_TUNNIJAOTUSPLAAN,b.ROLE_OIGUS_V_TEEMAOIGUS_KOORM])},currentNavItem:"lessonplan.vocational"}}).when("/lessonplans/vocational/byteacher",{templateUrl:"lessonplan/vocational.teacher.search.html",controller:"LessonplanTeacherSearchController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_TUNNIJAOTUSPLAAN,b.ROLE_OIGUS_V_TEEMAOIGUS_KOORM],currentNavItem:"lessonplan.vocational-byteacher"}}).when("/lessonplans/vocational/:id/:action",{templateUrl:"lessonplan/vocational.edit.html",controller:"LessonplanController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],isView:["$route",function(a){return"view"===a.current.params.action}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_TUNNIJAOTUSPLAAN,b.ROLE_OIGUS_M_TEEMAOIGUS_TUNNIJAOTUSPLAAN],currentNavItem:"lessonplan.vocational"}}).when("/lessonplans/vocational/byteacher/:id/:studyYear",{templateUrl:"lessonplan/vocational.teacher.view.html",controller:"LessonplanTeacherViewController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_TUNNIJAOTUSPLAAN,b.ROLE_OIGUS_V_TEEMAOIGUS_KOORM]}}).when("/lessonplans/journals/new",{templateUrl:"lessonplan/journal.edit.html",controller:"LessonplanJournalEditController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_TUNNIJAOTUSPLAAN]}}).when("/lessonplans/journals/:id/edit",{templateUrl:"lessonplan/journal.edit.html",controller:"LessonplanJournalEditController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_TUNNIJAOTUSPLAAN]}}).when("/lessonplans/events",{templateUrl:"lessonplan/event.search.html",controller:"LessonplanEventSearchController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_SYNDMUS]}})}]),angular.module("hitsaOis").controller("LessonplanEventSearchController",["$scope","$route","message","QueryUtils","USER_ROLES","AuthService",function(a,b,c,d,e,f){a.auth=b.current.locals.auth,a.canEdit=f.isAuthorized(e.ROLE_OIGUS_M_TEEMAOIGUS_SYNDMUS),a.formState={};var g="/timetableevents";d.endpoint(g+"/searchFormData").search().$promise.then(function(b){a.formState.studyPeriods=b.studyPeriods,a.formState.studyPeriods.forEach(function(b){b[a.currentLanguageNameField()]=a.currentLanguageNameField(b.studyYear)+" "+a.currentLanguageNameField(b)}),a.formState.teachers=b.teachers,angular.isDefined(a.criteria.singleEvent)||(a.criteria.singleEvent=!0),angular.isDefined(a.criteria.from)||(a.criteria.from=new Date),a.loadData()}),a.$watch("criteria.roomObject",function(){a.criteria.room=a.criteria.roomObject?a.criteria.roomObject.id:null}),d.createQueryForm(a,g,{order:"4 desc"});var h=a.clearCriteria;a.directiveControllers=[],a.clearEventCriteria=function(){h(),a.criteria.singleEvent=!1,a.directiveControllers.forEach(function(a){a.clear()})},a.afterNow=function(a,b){a=new Date(a);var c=a.getFullYear(),d=a.getMonth()+1,e=a.getDate(),f=""+c+"-"+d+"-"+e;return new Date(f+" "+b)>new Date},a.allowedToEdit=function(b){if(a.auth.isAdmin())return!0;if(a.auth.isTeacher()){if(!b.teachers)return!1;for(var c=0;c<b.teachers.length;c++)if(b.teachers[c].id===a.auth.teacher)return!0}return!1}}]),angular.module("hitsaOis").config(["$routeProvider","USER_ROLES",function(a,b){a.when("/ekis/logs",{templateUrl:"logs/logs.view.html",controller:"LogsController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],logType:function(){return"ekis"}},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_ANDMEVAHETUS_EKIS]}}).when("/kutseregister/logs",{templateUrl:"logs/logs.view.html",controller:"LogsController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],logType:function(){return"kutseregister"}},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_ANDMEVAHETUS_KUTSEREGISTER]}}).when("/rtip/logs",{templateUrl:"logs/logs.view.html",controller:"LogsController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],logType:function(){return"rtip"}},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_ANDMEVAHETUS_RTIP]}}).when("/sais/logs",{templateUrl:"logs/logs.view.html",controller:"LogsController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],logType:function(){return"sais"}},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_ANDMEVAHETUS_SAIS]}}).when("/rr/logs",{templateUrl:"logs/logs.view.html",controller:"LogsController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],logType:function(){return"rr"}},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_RR]}})}]),angular.module("hitsaOis").controller("LogsController",["$mdDialog","$route","$scope","QueryUtils",function(a,b,c,d){c.auth=b.current.locals.auth;var e={ekis:["registerDirective","deleteDirective","registerCertificate","registerPracticeContract","enforceContract","enforceDirective","rejectDirective"],kutseregister:["ROLL_P"===c.auth.roleCode?"kutseregister.muutunudKutsestandardid":"kutseregister.kutsetunnistus"],rtip:["sap.Z_EMPLOEES","sap.tootajaPohiandmed"],sais:["sais2.AllAdmissionsExport","sais2.AllApplicationsExport"],rr:["rr.RR434"]},f=b.current.locals.logType,g="logs."+f+".";c.logType=f,c.messagePrefix=g,c.messageTypes=e[f];var h="/logs/"+f;d.createQueryForm(c,h,{order:"-inserted"}),c.loadData(),c.logentry=function(b){
a.show({controller:["$scope",function(c){var e=1e3;c.requestLength=c.responseLength=e,c.cancel=a.hide,c.logType=f,c.messagePrefix=g,c.showAll=function(a){a?c.requestLength=void 0:c.responseLength=void 0},c.record=d.endpoint(h).get({id:b.id,messageType:b.wsName},function(a){(!a.request||a.request.length<e)&&c.showAll(!0),(!a.response||a.response.length<e)&&c.showAll(!1)})}],templateUrl:"logs/logentry.view.dialog.html",clickOutsideToClose:!0})}}]),angular.module("hitsaOis").controller("messageSentController",["$scope","QueryUtils","DataUtils","$route","USER_ROLES","AuthService",function(a,b,c,d,e,f){a.currentNavItem="message.sent",b.createQueryForm(a,"/message/sent",{order:"-inserted"}),a.loadData(),c.convertStringToDates(a.criteria,["sentFrom","sentThru"]),a.auth=d.current.locals.auth,a.canSeeAutomatic=a.auth.isAdmin()&&f.isAuthorized(e.ROLE_OIGUS_V_TEEMAOIGUS_AUTOTEADE),a.showReceivers=function(a,b){var c="";if(a.receivers){c=a.receivers.join("; ");var d=20;!b&&c.length>d&&(c=c.substring(0,d)+"...")}return c},a.formState={canSend:f.isAuthorized(d.routes["/message/new"].data.authorizedRoles)},angular.element(document).ready(function(){var a=document.getElementsByName("message.sent")[0].offsetLeft;document.getElementById("scrolling_div").scrollLeft+=a})}]).controller("messageAutomaticSentController",["$scope","QueryUtils","DataUtils","$route","USER_ROLES","AuthService",function(a,b,c,d,e,f){a.currentNavItem="message.automaticSent",b.createQueryForm(a,"/message/sent/automatic",{order:"-inserted"}),a.loadData(),c.convertStringToDates(a.criteria,["sentFrom","sentThru"]),a.auth=d.current.locals.auth,a.canSeeAutomatic=a.auth.isAdmin()&&f.isAuthorized(e.ROLE_OIGUS_V_TEEMAOIGUS_AUTOTEADE),a.showReceivers=function(a,b){var c="";if(a.receivers){c=a.receivers.join("; ");var d=20;!b&&c.length>d&&(c=c.substring(0,d)+"...")}return c},angular.element(document).ready(function(){var a=document.getElementsByName("message.automaticSent")[0].offsetLeft;document.getElementById("scrolling_div").scrollLeft+=a})}]).controller("messageReceivedController",["$scope","QueryUtils","DataUtils","$route","$rootScope","USER_ROLES","AuthService",function(a,b,c,d,e,f,g){a.currentNavItem="message.received",b.createQueryForm(a,"/message/received",{order:"-inserted"}),a.loadData(),c.convertStringToDates(a.criteria,["sentFrom","sentThru"]),a.auth=d.current.locals.auth,a.canSeeAutomatic=a.auth.isAdmin()&&g.isAuthorized(f.ROLE_OIGUS_V_TEEMAOIGUS_AUTOTEADE),b.endpoint("/message/received/new").get().$promise.then(function(a){e.unreadMessages=a.unread}),a.formState={canSend:g.isAuthorized(d.routes["/message/new"].data.authorizedRoles)}}]).controller("messageViewController",["$scope","$route","QueryUtils","DataUtils","$resource","config","$rootScope","AuthService",function(a,b,c,d,e,f,g,h){function i(){d.convertStringToDates(a.record,["inserted"]),a.record.receivers=a.record.receiversNames.join("; "),j()}function j(){a.isSent||a.record.isRead?k():c.endpoint("/message/"+a.record.id).update().$promise.then(function(){k()})}function k(){c.endpoint("/message/received/new").get().$promise.then(function(a){g.unreadMessages=a.unread})}var l="/message",m=c.endpoint(l),n=b.current.params.id,o=b.current.params.backUrl;a.canSend=h.isAuthorized(b.routes["/message/:id/respond"].data.authorizedRoles),a.isSent="received"!==o,a.record=m.get({id:n},i)}]).controller("messageRespondController",["$scope","QueryUtils","$route","message","$location",function(a,b,c,d,e){function f(){var b={subject:"Re: "+a.respondedMessage.subject,content:"\n>"+a.respondedMessage.content,receivers:[a.respondedMessage.sendersId],responseTo:i};a.record=new h(b),setTimeout(function(){var a=document.getElementById("content");a.focus(),a.selectionStart=0,a.selectionEnd=0},0)}var g="/message",h=b.endpoint(g),i=c.current.params.id,j=c.current.params.backUrl;a.formState={backUrl:j&&"home"===j?"#/":"#/messages/received"},a.respondedMessage=h.get({id:i},f),a.send=function(){function b(){d.info("message.messageSent"),e.path(a.formState.backUrl.substring(1))}return a.messageRespondForm.$setSubmitted(),a.messageRespondForm.$valid?void a.record.$save(b):void d.error("main.messages.form-has-errors")}}]).controller("messageNewController",["$scope","QueryUtils","$route","message","$location","ArrayUtils","$resource","config","$rootScope","$q","$translate",function(a,b,c,d,e,f,g,h,i,j,k){function l(){b.endpoint(G+"/studentgroups").query({curriculums:a.curriculum,studyForm:a.studyForm}).$promise.then(function(b){a.studentGroups=b.map(function(a){return{id:a.id,nameEt:a.code,nameEn:a.code,isHigher:a.higher}});var c=b.map(function(a){return a.id});a.studentGroup=a.studentGroup.filter(function(a){return-1!==c.indexOf(a)})})}function m(){b.endpoint(G+"/teacherjournals").query().$promise.then(function(b){a.journals=b.map(function(a){return{id:a.id,nameEt:a.nameEt,nameEn:a.nameEn}})})}function n(){b.endpoint(G+"/teachersubjects").query().$promise.then(function(b){a.subjects=b.map(function(a){return{id:a.id,code:a.code,nameEt:a.nameEt,nameEn:a.nameEn}})})}function o(a){g(h.apiUrl+"/message/"+a.studentId+"/parents").query().$promise.then(function(a){t(C(a,!0).filter(function(a){return!p(a.personId)}))})}function p(b){return a.receivers.filter(function(a){return a.personId===b}).length>0}function q(a){return 1===a.role.length&&"ROLL_T"===a.role[0]}function r(a,b,c){var d=c;"string"==typeof c&&(d=c.split("."));for(var e=a,f=b,g=0;g<d.length;g++){if(angular.isArray(e)){if(e.length>1){for(var h=0;h<e.length;h++)if(r(e[h],f,d.slice(g)))return!0;return!1}1===e.length&&(e=e[0])}if(angular.isArray(f)&&(f=f[0]),angular.isUndefined(e)||null===e||angular.isUndefined(f)||null===f)return e===f;e=d[g]in e?e[d[g]]:null,f=d[g]in f?f[d[g]]:null}return e===f}function s(a,b,c,d){for(var e=0;e<a.length;e++){var f=b.filter(c,a[e]);f.length>0?d(f[0],a[e]):b.push(a[e])}}function t(b){s(b,a.receivers,function(a){return a.personId===this.personId&&a.role[0]===this.role[0]},function(a,b){r(a,b,"curriculum.id")||a.curriculum.push(b.curriculum[0]),r(a,b,"studentGroup.id")||a.studentGroup.push(b.studentGroup[0]),r(a,b,"journal.id")||a.journal.push(b.journal[0]),r(a,b,"subject.id")||a.subject.push(b.subject[0])})}function u(a){a.size=1e3,g(h.apiUrl+G+"/students",a).query().$promise.then(function(a){t(v(a).filter(function(a){return a.higher&&"ROLL_L"===a.role[0]?!1:!0}))})}function v(a){var b=a.map(function(a){return{studentId:a.id,personId:a.personId,idcode:a.idcode,fullname:a.fullname,higher:a.higher,role:a.role,studyForm:a.studyForm,journal:null!==a.journal?[a.journal]:[],subject:null!==a.subject?[a.subject]:[],curriculum:[a.curriculum],studentGroup:[a.studentGroup]}});return b}function w(){a.receivers=a.receivers.filter(function(b){return(x(b)||y(b.role,a.targetGroup))&&(b.addedWithAutocomplete||y(a.curriculum,b.curriculum?b.curriculum.id:null)&&y(a.studentGroup,b.studentGroup?b.studentGroup.id:null)&&y(a.studyForm,b.studyForm)&&y(a.studyGroupStudentsParents,b.studentGroup?b.studentGroup.id:null)&&y(a.journalStudent,b.journal?b.journal.id:null)&&y(a.journalStudentParent,b.journal?b.journal.id:null)&&y(a.subjectStudent,b.subject?b.subject.id:null)&&y(a.subjectStudentParent,b.subject?b.subject.id:null))})}function x(b){return"ROLL_T"===a.targetGroup&&y(b.role,"ROLL_L")}function y(a,b){return 0===a.length||-1!==a.indexOf(b)}function z(){return a.studyForm.length>0||a.studentGroup.length>0||a.curriculum.length>0||a.studyGroupStudentsParents.length>0||a.journalStudent.length>0||a.journalStudentParent.length>0||a.subjectStudent.length>0||a.subjectStudentParent.length>0}function A(a,b){w(),z()?a(b):E()}function B(a){g(h.apiUrl+"/message/parents",a).query().$promise.then(function(a){t(C(a,!1))})}function C(a,b){var c=a.map(function(a){return{studentId:a.id,personId:a.personId,idcode:a.idcode,fullname:a.fullname,role:["ROLL_L"],journal:null!==a.journal?[a.journal]:[],subject:null!==a.subject?[a.subject]:[],studentGroup:[a.studentGroup],curriculum:[a.curriculum],addedWithAutocomplete:b}});return c}function D(){if(a.auth.isTeacher()){if(angular.isDefined(a.groupSearchType)&&null!==a.groupSearchType)switch(a.groupSearchType){case"SEARCH_STUDENT_GROUP":l();break;case"SEARCH_JOURNAL":m();break;case"SEARCH_SUBJECTS":n()}}else l()}function E(){a.receivers=a.receivers.filter(function(a){return a.addedWithAutocomplete})}function F(){return a.messageNewForm.$valid&&a.receivers.length>0}var G="/message",H=b.endpoint(G);a.record=new H,a.auth=c.current.locals.auth,a.formState={},a.auth.isAdmin()?a.targetGroups=["ROLL_O","ROLL_T","ROLL_L","ROLL_P"]:a.auth.isTeacher()?(a.targetGroups=["ROLL_T","ROLL_L"],a.groupSearchTypes=[{code:"SEARCH_STUDENT_GROUP",name:k.instant("message.searchTypeByGroups")}],a.auth.school.vocational&&a.groupSearchTypes.push({code:"SEARCH_JOURNAL",name:k.instant("message.searchTypeByJournals")}),a.auth.school.higher&&a.groupSearchTypes.push({code:"SEARCH_SUBJECTS",name:k.instant("message.searchTypeBySubjects")})):a.auth.isParent()||a.auth.isStudent()?a.targetGroups=["ROLL_O"]:a.targetGroups=[],1===a.targetGroups.length&&(a.targetGroup=a.targetGroups[0]),a.receivers=[],a.studyForm=[],a.studentGroup=[],a.curriculum=[],a.studyGroupStudentsParents=[],a.journalStudent=[],a.journalStudentParent=[],a.subjectStudent=[],a.subjectStudentParent=[],-1!==a.targetGroups.indexOf("ROLL_T")&&l(),a.addReceiver=function(b){if(b&&!p(b.personId)){var c={studentId:b.id,personId:b.personId,idcode:b.idcode,fullname:b.fullname,role:a.targetGroup?[a.targetGroup]:b.role,curriculum:b.curriculum,studentGroup:b.studentGroup,journal:b.journal,subject:b.subject,addedWithAutocomplete:!0};a.auth.isTeacher()&&(c.curriculumObject=b.curriculum,c.studentGroupObject=b.studentGroup),a.receivers.push(c),"ROLL_T"!==a.targetGroup||null!==b&&b.higher||o(c)}a.receiver=void 0},a.removeReceiver=function(b){f.remove(a.receivers,b),q(b)&&(a.receivers=a.receivers.filter(function(a){return a.studentId!==b.studentId}))},a.tarGetGroupChanged=function(){a.receivers=[],a.curriculum=[],a.studentGroup=[],a.studyForm=[],a.studyGroupStudentsParents=[],a.journalStudent=[],a.journalStudentParent=[],a.subjectStudent=[],a.subjectStudentParent=[]},a.searchTypeChanged=function(){w(),a.curriculum=[],a.studentGroup=[],a.studyForm=[],a.studyGroupStudentsParents=[],a.journalStudent=[],a.journalStudentParent=[],a.subjectStudent=[],a.subjectStudentParent=[]};var I=!1;a.$watch("curriculum",function(){I?(D(),w(),z()?u({studyForm:a.studyForm,studentGroupId:a.studentGroup,curriculum:a.curriculum}):E()):I=!0});var J=!0;a.$watch("journalStudent",function(){J?J=!1:A(u,{journalId:a.journalStudent})});var K=!0;a.$watch("journalStudentParent",function(){K?K=!1:A(B,{journalId:a.journalStudentParent})});var L=!0;a.$watch("subjectStudent",function(){L?L=!1:A(u,{subjectId:a.subjectStudent})});var M=!0;a.$watch("subjectStudentParent",function(){M?M=!1:A(B,{subjectId:a.subjectStudentParent})});var N=!0;a.$watch("studentGroup",function(){N?N=!1:A(u,{studyForm:a.studyForm,studentGroupId:a.studentGroup,curriculum:a.curriculum})});var O=!0;a.$watch("studyGroupStudentsParents",function(){O?O=!1:A(B,{studentGroupId:a.studyGroupStudentsParents})});var P=!1;a.$watch("studyForm",function(){P?(D(),w(),z()?u({studyForm:a.studyForm,studentGroupId:a.studentGroup,curriculum:a.curriculum}):E()):P=!0});var Q=b.endpoint("/message/persons");a.querySearch=function(b){var c=j.defer();return Q.query({role:a.targetGroup,name:b},function(a){for(var b=0;b<a.length;b++)a[b].curriculum=[a[b].curriculum],a[b].studentGroup=[a[b].studentGroup],a[b].journal=[a[b].journal],a[b].subject=[a[b].subject];var d=[];s(a,d,function(a){return a.personId===this.personId&&a.role[0]===this.role[0]},function(a,b){r(a,b,"curriculum.id")||a.curriculum.push(b.curriculum[0]),r(a,b,"studentGroup.id")||a.studentGroup.push(b.studentGroup[0]),r(a,b,"journal.id")||a.journal.push(b.journal[0]),r(a,b,"subject.id")||a.subject.push(b.subject[0])}),c.resolve(d)}),c.promise},a.send=function(){function b(){d.info("message.messageSent"),i.back("#/messages/sent")}return a.messageNewForm.$setSubmitted(),F()?(a.record.receivers=a.receivers.map(function(a){return a.personId}),void a.record.$save(b)):void d.error("main.messages.form-has-errors")}}]),angular.module("hitsaOis").config(["$routeProvider","USER_ROLES",function(a,b){function c(a,c){return-1!==e.indexOf(a.roleCode)||-1!==c.indexOf(b.ROLE_OIGUS_V_TEEMAOIGUS_TEADE)}function d(a,c){return-1!==e.indexOf(a.roleCode)||-1!==c.indexOf(b.ROLE_OIGUS_M_TEEMAOIGUS_TEADE)}var e=["ROLL_T","ROLL_L","ROLL_P"];a.when("/messages/sent",{templateUrl:"message/message.sent.html",controller:"messageSentController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:c}}).when("/messages/automatic/sent",{templateUrl:"message/message.sent.html",controller:"messageAutomaticSentController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_AUTOTEADE]}}).when("/messages/received",{templateUrl:"message/message.received.html",controller:"messageReceivedController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:c}}).when("/message/:id/view",{templateUrl:"message/message.view.html",controller:"messageViewController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:c}}).when("/message/:id/respond",{templateUrl:"message/message.respond.html",controller:"messageRespondController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:d}}).when("/message/new",{templateUrl:"message/message.new.html",controller:"messageNewController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:function(a,b){return"ROLL_P"!==a.roleCode&&d(a,b)}}})}]),angular.module("hitsaOis").controller("MessageTemplateListController",["$scope","Classifier","DataUtils","QueryUtils","$q",function(a,b,c,d,e){var f=b.valuemapper({type:"TEATE_LIIK"});d.createQueryForm(a,"/messageTemplate",{order:"type."+a.currentLanguageNameField()},function(a){f.objectmapper(a),c.convertStringToDates(a,["validThru","validFrom"]);for(var b=moment(),d=0;d<a.length;d++){var e=a[d];e._isValid=(!e.validFrom||moment(e.validFrom).isSameOrBefore(b,"day"))&&(!e.validThru||moment(e.validThru).isSameOrAfter(b,"day"))}}),c.convertStringToDates(a.criteria,["validFrom","validThru"]),e.all(f.promises).then(a.loadData)}]).controller("MessageTemplateEditController",["$location","$route","$scope","dialogService","message","DataUtils","QueryUtils","$rootScope",function(a,b,c,d,e,f,g,h){function i(){f.convertStringToDates(c.record,["validFrom","validThru"]),j(),c.getIsValid(),c.messageTemplateForm&&c.messageTemplateForm.$setPristine()}function j(){c.allowedTypes=g.endpoint("/messageTemplate/usedTypeCodes").query({code:c.record.type}).$promise.then(function(a){c.allowedTypes=a})}c.readOnly=-1!==b.current.$$route.originalPath.indexOf("view"),c.getIsValid=function(){c.isValid=(void 0===c.record.validFrom||null===c.record.validFrom||c.record.validFrom<=new Date)&&(void 0===c.record.validThru||null===c.record.validThru||c.record.validThru>=new Date)};var k="/messageTemplate",l=g.endpoint(k),m=b.current.params.id;h.removeLastUrlFromHistory(function(a){return a==="#/messageTemplate/"+m+"/view"||"#/messageTemplate/new"===a}),m?c.record=l.get({id:m},i):(c.record=new l,i()),c.$watch("record.validFrom",function(){c.record.validThru&&c.record.validThru<c.record.validFrom&&(c.record.validThru=null)}),c.usedTypes=[],c.save=function(){return c.messageTemplateForm.$setSubmitted(),c.messageTemplateForm.$valid?void(c.record.id?c.record.$update(i).then(e.updateSuccess):c.record.$save().then(function(){e.info("main.messages.create.success"),a.path(k+"/"+c.record.id+"/edit")})):void e.error("main.messages.form-has-errors")},c["delete"]=function(){d.confirmDialog({prompt:"messageTemplate.deleteconfirm"},function(){c.record.$delete().then(function(){e.info("main.messages.delete.success"),a.path(k)})})}}]),angular.module("hitsaOis").config(["$routeProvider","USER_ROLES",function(a,b){a.when("/messageTemplate",{templateUrl:"messageTemplate/message.template.search.html",controller:"MessageTemplateListController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_AUTOTEADE]}}).when("/messageTemplate/new",{templateUrl:"messageTemplate/message.template.edit.html",controller:"MessageTemplateEditController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_AUTOTEADE]}}).when("/messageTemplate/:id/edit",{templateUrl:"messageTemplate/message.template.edit.html",controller:"MessageTemplateEditController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_AUTOTEADE]}}).when("/messageTemplate/:id/view",{templateUrl:"messageTemplate/message.template.edit.html",controller:"MessageTemplateEditController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_AUTOTEADE]}})}]),angular.module("hitsaOis").controller("MidtermTaskStudentResultsController",["$scope","QueryUtils","$route","message","MidtermTaskUtil","ArrayUtils","dialogService",function(a,b,c,d,e,f,g){function h(b,c){var d=a.record.studentResults.find(function(a){return a.midtermTask===c.id&&a.declarationSubject===b.declarationSubject});return angular.isDefined(d)}function i(a,b){return{midtermTask:b.id,declarationSubject:a.declarationSubject,maxPoints:b.maxPoints,isText:b.studentResultIsText}}function j(){a.record.students.forEach(function(b){for(var c=[],d=0;d<a.record.midtermTasks.length;d++)h(b,a.record.midtermTasks[d])||c.push(i(b,a.record.midtermTasks[d]));a.record.studentResults=a.record.studentResults.concat(c)})}function k(){m.get({id:a.subjectStudyPeriodId}).$promise.then(function(b){a.record=b,a.moodleCourseId=b.subjectStudyPeriod.moodleCourseId,l()})}function l(){a.record.midtermTasks=n.getSortedMidtermTasks(a.record.midtermTasks),a.moodleTasks=n.getMoodleTasks(a.record.midtermTasks),j(),n.sortStudentResults(a.record.studentResults,a.record.midtermTasks)}a.auth=c.current.locals.auth,a.subjectStudyPeriodId=c.current.params.id;var m=b.endpoint("/midtermTasks/studentResults"),n=new e;k(),a.getMidtermTaskHeader=n.getMidtermTaskHeader,a.filterStudentResults=function(a){return function(b){return a.declarationSubject===b.declarationSubject}},a.save=function(){return a.midtermTaskResultForm.$setSubmitted(),a.midtermTaskResultForm.$valid?(a.record.id=a.subjectStudyPeriodId,void new m(a.record).$update().then(function(b){d.updateSuccess(),a.record=b,l()})):void d.error("main.messages.form-has-errors")},a.enrollStudents=function(){b.endpoint("/midtermTasks/"+a.subjectStudyPeriodId+"/moodle/enrollStudents").save(null,function(a){g.showDialog("components/moodle.enroll.dialog.html",function(b){b.moodleResponse=a},k,k)})},a.importGradeItems=function(){b.endpoint("/midtermTasks/"+a.subjectStudyPeriodId+"/moodle/importGradeItems").save(null,function(){d.info("moodle.messages.gradeItemsImported"),k()})},a.importAllGrades=function(){b.endpoint("/midtermTasks/"+a.subjectStudyPeriodId+"/moodle/importAllGrades").save(null,function(){d.info("moodle.messages.allGradesImported"),k()})},a.importMissingGrades=function(){b.endpoint("/midtermTasks/"+a.subjectStudyPeriodId+"/moodle/importMissingGrades").save(null,function(){d.info("moodle.messages.missingGradesImported"),k()})},a.filterProtocols=function(a){return function(b){var c=b.protocolStudents.map(function(a){return a.student.id});return f.contains(c,a.studentId)}},a.filterStudentProtocols=function(a){return function(b){return a.studentId===b.student.id}}}]).controller("MidtermTaskController",["$scope","$sessionStorage","QueryUtils","DataUtils","$route","ArrayUtils","message","dialogService","orderByFilter","$rootScope",function(a,b,c,d,e,f,g,h,i,j){function k(){a.record.midtermTasks||(a.record.midtermTasks=[]),d.convertStringToDates(a.record.midtermTasks,["taskDate"]),a.record.canBeEdited&&(a.record.midtermTasks=i(a.record.midtermTasks,["taskDate",j.currentLanguageNameField()]))}var l=c.endpoint("/midtermTasks");a.subjectStudyPeriodId=e.current.params.id,a.auth=e.current.locals.auth,a.record=l.get({id:a.subjectStudyPeriodId},k),a.addRow=function(){a.record.midtermTasks.push({maxPoints:0,canBeDeleted:!0})},a.removeRow=function(b){b.canBeDeleted?f.remove(a.record.midtermTasks,b):g.error("midtermTask.error.midtermTaskCantBeDeleted")},a.save=function(){return a.midtermTaskForm.$setSubmitted(),a.midtermTaskForm.$valid?(a.record.id=a.subjectStudyPeriodId,void new l(a.record).$update().then(function(b){g.updateSuccess(),a.record=b,k()})):void g.error("main.messages.form-has-errors")},a.getPercentageSum=function(){return a.record&&a.record.midtermTasks?a.record.midtermTasks.reduce(function(a,b){return b&&b.percentage?a+b.percentage:a},0):0},a.clearThresholdPercentage=function(a){a.threshold||(a.thresholdPercentage=null)},a.propertyName=["taskDate",j.currentLanguageNameField()],a.reverse=!1,a.sortBy=function(b){a.reverse=a.propertyName===b?!a.reverse:!1,a.propertyName=b},a.openCopyDialog=function(){var b=function(b){function e(){b.criteria&&!b.criteria.studyPeriod&&(b.criteria.studyPeriod=d.getCurrentStudyYearOrPeriod(b.studyPeriods).id)}b.subjectStudyPeriodSelected=[],b.formState={auth:a.auth},c.createQueryForm(b,"/midtermTasks/subjectStudyPeriods/"+a.subjectStudyPeriodId,{order:"subject."+a.currentLanguageNameField()}),b.clearCriteria(),c.endpoint("/autocomplete/studyPeriods").query().$promise.then(function(a){b.studyPeriods=a,e(),b.criteria.size=10,b.loadData()}),b.$watch("criteria.studyPeriod",function(){f.isEmpty(b.studyPeriods)||b.criteria.studyPeriod||e()}),b.subjectObject=null,b.$watch("criteria.subjectObject",function(){b.criteria&&(b.criteria.subject=b.criteria.subjectObject?b.criteria.subjectObject.id:null)}),b.$watch("criteria.teacherObject",function(){b.criteria&&(b.criteria.teacher=b.criteria.teacherObject?b.criteria.teacherObject.id:null)})};h.showDialog("midtermTask/midtermTask.copy.dialog.html",b,function(b){c.endpoint("/midtermTasks/"+a.subjectStudyPeriodId+"/subjectStudyPeriodCopy/"+b.subjectStudyPeriodSelected[0].id).put().$promise.then(function(b){g.info("midtermTask.message.copied"),b.midtermTasks&&(a.record.midtermTasks=a.record.midtermTasks.concat(b.midtermTasks)),k()})})}}]),angular.module("hitsaOis").factory("MidtermTaskUtil",["$rootScope","DataUtils","orderByFilter",function(a,b,c){var d=function(){function d(a){return 10>a?"0"+a:a}function e(a,b){var c=b.find(function(b){return b.id===a});return b.indexOf(c)}this.getMidtermTaskHeader=function(b){var c=b.taskDate?d(b.taskDate.getDate())+"."+d(b.taskDate.getMonth()+1):"";return a.currentLanguageNameField(b)+" "+c+" ("+b.percentage+"%), max "+b.maxPoints},this.getSortedMidtermTasks=function(d){return b.convertStringToDates(d,["taskDate"]),c(d,["taskDate",a.currentLanguageNameField()])},this.getMoodleTasks=function(a){for(var b={},c=0;c<a.length;c++){var d=a[c];d.moodleGradeItemId&&(b[d.id]=!0)}return b},this.sortStudentResults=function(a,b){a.sort(function(a,c){return e(a.midtermTask,b)-e(c.midtermTask,b)})}};return d}]),angular.module("hitsaOis").config(["$routeProvider","USER_ROLES",function(a,b){a.when("/subjectStudyPeriods/:id/midtermTasks/studentResults",{templateUrl:"midtermTask/midtermTask.studentResults.html",controller:"MidtermTaskStudentResultsController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_PAEVIK]}}).when("/subjectStudyPeriods/:id/midtermTasks",{templateUrl:"midtermTask/midtermTask.html",controller:"MidtermTaskController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_PAEVIK]}})}]),angular.module("hitsaOis").controller("OccupationCertificateImportController",["$scope","message","QueryUtils",function(a,b,c){function d(){a.criteria.studentGroups=null}a.criteria={},a.$watchCollection("criteria.curriculumVersion",d),a.directiveControllers=[];var e=a.clearCriteria;a.clearCriteria=function(){e(),a.directiveControllers.forEach(function(a){a.clear()})},a.importFromKutseregister=function(){return a.occupationCertificateForm.$setSubmitted(),a.occupationCertificateForm.$valid?void c.endpoint("/occupationcertificates/import").post(a.criteria).$promise.then(function(b){a.results=b}):(b.error("main.messages.form-has-errors"),!1)}}]),angular.module("hitsaOis").config(["$routeProvider","USER_ROLES",function(a,b){a.when("/occupationcertificate/import",{templateUrl:"occupationcertificate/import.html",controller:"OccupationCertificateImportController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_ANDMEVAHETUS_KUTSEREGISTER]}})}]),angular.module("hitsaOis").controller("KutseregisterSyncController",["$scope","message","QueryUtils",function(a,b,c){a.criteria={},a.occupationStandards=function(){return a.kutseregisterSyncForm.$setSubmitted(),a.kutseregisterSyncForm.$valid?void c.endpoint("/logs/kutseregister/sync").post(a.criteria,function(){b.info("occupationcertificate.importDone")}):(b.error("main.messages.form-has-errors"),!1)}}]),angular.module("hitsaOis").config(["$routeProvider","USER_ROLES",function(a,b){a.when("/occupationstandard",{templateUrl:"occupationstandard/occupationstandard.html",controller:"KutseregisterSyncController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_ANDMEVAHETUS_KUTSEREGISTER]}})}]),angular.module("hitsaOis").controller("ModuleProtocolController",["$filter","$scope","$route","$location","$q","Classifier","ProtocolUtils","VocationalGradeUtil","QueryUtils","config","dialogService","message","oisFileService","stateStorageService",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){function o(){b.protocolStudentJournalResults={};var a={};b.protocol.protocolStudents.forEach(function(c){c.journalResults.forEach(function(d){a[d.journalId]||(a[d.journalId]={id:d.journalId,nameEt:d.nameEt,capacity:d.capacity,hasOutcomes:d.journalHasOutcomes}),b.protocolStudentJournalResults[c.id]||(b.protocolStudentJournalResults[c.id]={}),b.protocolStudentJournalResults[c.id][d.journalId]||(b.protocolStudentJournalResults[c.id][d.journalId]=[]),b.protocolStudentJournalResults[c.id][d.journalId].push(C.objectmapper(d).grade)})});var c=[];b.formState.outcomesAsEntries=!1;for(var d in a)a.hasOwnProperty(d)&&(c.push(a[d]),!b.formState.outcomesAsEntries&&a[d].hasOutcomes&&(b.formState.outcomesAsEntries=!0));b.journals=c}function p(){b.protocolStudentOutcomeResults={},b.protocol.protocolStudents.forEach(function(a){var c=[];a.outcomeResults.forEach(function(a){c.push({id:a.curriculumModuleOutcomeId,grade:a.grade,gradeInserted:a.gradeInserted})}),c=r(c),c.forEach(function(c){b.protocolStudentOutcomeResults[a.id]||(b.protocolStudentOutcomeResults[a.id]={}),b.protocolStudentOutcomeResults[a.id][c.id]||(b.protocolStudentOutcomeResults[a.id][c.id]=C.objectmapper(c).grade)})}),q(b.protocol.protocolVdata.outcomes)}function q(a){var c=0;a.forEach(function(a){null===a.orderNr&&(a.orderNr=c++)}),b.outcomes=a}function r(a){return a.sort(function(a,b){return a=new Date(a.gradeInserted),b=new Date(b.gradeInserted),a>b?-1:b>a?1:0}),a}function s(){angular.isDefined(z)&&0===z.promise.$$state.status&&z.resolve()}function t(a){e.all(C.promises).then(function(){b.moduleProtocolForm.$setPristine(),b.protocol=C.objectmapper(a),b.savedStudents=angular.copy(b.protocol.protocolStudents),b.getUrl=m.getUrl,o(),p(),b.formState.canEditProtocol=g.canEditProtocol(b.auth,b.protocol),b.formState.canChangeConfirmedProtocolGrade=g.canChangeConfirmedProtocolGrade(b.auth,b.protocol),b.formState.canAddDeleteStudents=g.canAddDeleteStudents(b.auth,b.protocol),b.formState.canConfirm=g.canConfirm(b.auth,b.protocol),b.formState.protocolPdfUrl=j.apiUrl+y+"/"+a.id+"/print/protocol.pdf",s()})["catch"](function(){s()})}function u(){return b.moduleProtocolForm.$valid?!0:(l.error("main.messages.form-has-errors"),b.moduleProtocolForm.$setSubmitted(),!1)}function v(a){var c=b.protocol.protocolStudents.find(function(b){return b.id===a.protocolStudent});c.grade=a.grade}function w(a){a.forEach(v),b.gradeChanged()}function x(){return b.protocol&&b.protocol.protocolStudents?b.protocol.protocolStudents.filter(function(a){return b.calculateGrades.protocolStudents[a.id]}).map(function(a){return a.id}):0}var y="/moduleProtocols";b.gradeUtil=h,b.auth=c.current.locals.auth;var z,A="moduleProtocol",B=b.auth.school.id,C=f.valuemapper({grade:"KUTSEHINDAMINE",status:"PROTOKOLL_STAATUS"}),D=["KUTSEHINDAMINE_1","KUTSEHINDAMINE_X"],E=["KUTSEHINDAMINE_X"],F=f.queryForDropdown({mainClassCode:"KUTSEHINDAMINE"});b.formState={},b.formState.selectedStudentsExist=!1;var G=n.loadState(B,A);angular.equals({},G)?(b.formState.showJournals=!0,b.formState.showOutcomes=!0):(b.formState.showJournals=G.showJournals,b.formState.showOutcomes=G.showOutcomes),b.hideInvalid=function(a){return!f.isValid(a)},b.$watch("formState.showJournals",function(){n.changeState(B,A,{showJournals:b.formState.showJournals})}),b.$watch("formState.showOutcomes",function(){n.changeState(B,A,{showOutcomes:b.formState.showOutcomes})}),b.calculateGrades={protocolStudents:[]},F.$promise.then(function(a){b.grades=a.filter(function(a){return c.current.locals.isView?-1===E.indexOf(a.code):-1===D.indexOf(a.code)})}),b.protocolStudentJournalResults={},b.protocolStudentOutcomeResults={},b.gradeChanged=function(c){if(c){var d=a("filter")(b.savedStudents,{id:c.id},!0)[0];d.grade!==c.grade?(b.moduleProtocolForm.$setSubmitted(),c.gradeHasChanged=!0):(c.gradeHasChanged=!1,d.addInfo?c.addInfo=d.addInfo:c.addInfo=null)}b.formState.canConfirm=g.canConfirm(b.auth,b.protocol)},b.addInfoChanged=function(){b.formState.canConfirm=g.canConfirm(b.auth,b.protocol)},c.current.locals.entity&&t(c.current.locals.entity),b.deleteProtocolStudent=function(a){k.confirmDialog({prompt:"moduleProtocol.prompt.deleteStudent"},function(){var c=i.endpoint(y+"/"+b.protocol.id+"/removeStudent"),d=new c(a);d.$delete().then(function(a){l.info("main.messages.delete.success"),t(a)})["catch"](angular.noop)})},b.addProtocolStudents=function(){k.showDialog("protocol/module.protocol.addStudent.dialog.html",function(a){a.selectedStudents=[],i.createQueryForm(a,y+"/"+b.protocol.id+"/otherStudents",{}),a.loadData()},function(a){i.endpoint(y+"/"+b.protocol.id+"/addStudents").save({version:b.protocol.version,protocolStudents:a.selectedStudents.map(function(a){return{studentId:a}})},function(a){l.info("moduleProtocol.messages.studentSuccesfullyAdded"),t(a)})})},b.gradeValue=function(a){
var b=C.objectmapper({grade:a}).grade;return b?b.value:void 0},b.confirm=function(){if(z=e.defer(),!u())return s(),z.promise;var a={version:b.protocol.version,protocolStudents:b.protocol.protocolStudents};return g.signBeforeConfirm(b.auth,y+"/"+b.protocol.id,a,"moduleProtocol.messages.confirmed",t,s),z.promise};var H=i.endpoint(y);b.save=function(){u()&&new H({id:b.protocol.id,version:b.protocol.version,protocolStudents:b.protocol.protocolStudents}).$update().then(function(a){l.info("main.messages.create.success"),t(a)})},b.$watchCollection("calculateGrades.protocolStudents",function(){var a=x();b.formState.selectedStudentsExist=a.length>0}),b.updateAllStudentsCheckBoxes=function(a){b.protocol.protocolStudents.forEach(function(c){c.canBeDeleted?b.calculateGrades.protocolStudents[c.id]=a:b.calculateGrades.protocolStudents[c.id]=a})},b.calculate=function(){var a=x();i.endpoint(y+"/"+b.protocol.id+"/calculate").query({protocolStudents:a}).$promise.then(function(a){b.calculateGrades.protocolStudents=[],b.formState.selectAllStudents=!1,w(a),l.info("moduleProtocol.messages.calculated")})};var I=i.endpoint(y);b["delete"]=function(){k.confirmDialog({prompt:"moduleProtocol.prompt.delete"},function(){new I(b.protocol).$delete().then(function(){l.info("moduleProtocol.messages.deleted"),d.path(y)})})}}]),angular.module("hitsaOis").controller("ModuleProtocolListController",["$scope","$route","QueryUtils","DataUtils","Classifier","$q","message","dialogService","sharedProperties","$location",function(a,b,c,d,e,f,g,h,i,j){function k(){return(a.auth.isTeacher()||a.auth.isAdmin())&&-1!==a.auth.authorizedRoles.indexOf("ROLE_OIGUS_K_TEEMAOIGUS_MOODULPROTOKOLL")}function l(){function b(b){function d(a){var c={studyYear:e,curriculumVersion:a.curriculumVersion,module:a.module};i.getProperties()["module.protocol.default.fields"]=c,b.cancel(),j.url("/moduleProtocols/new")}var e=angular.copy(a.criteria.studyYear);b.loadModuleHistory=m,b.addModuleProtocol=d,c.endpoint("/autocomplete/studyYears").query({}).$promise.then(function(a){a&&a.length&&(b.studyYear=a.find(function(a){return a.id===e}))}),c.createQueryForm(b,"/moduleProtocols/myModules?studyYear="+e),b.loadData()}h.showDialog("protocol/module.protocol.myModules.dialog.html",b,void 0,void 0,!0)}function m(a){function b(b){var d=26,f=e.valuemapper({year:"OPPEAASTA"});c.endpoint("/moduleProtocols/moduleHistory/"+a).get().$promise.then(function(a){b.maxPeriods=0,b.result=a,b.result.lessonPlanModules.forEach(function(a){f.objectmapper(a.studyYear),a.mappedHoursByPeriod={},a.mappedHoursByJournal={},a.totalHours=0;for(var c in a.mappedHours){var e=0;for(var g in a.mappedHours[c])e++,a.mappedHours[c][g]&&(a.mappedHours[c][g]=Math.round(a.mappedHours[c][g]/d*10)/10,a.mappedHoursByPeriod[g]=a.mappedHoursByPeriod[g]?a.mappedHoursByPeriod[g]+a.mappedHours[c][g]:a.mappedHours[c][g],a.mappedHoursByJournal[c]=a.mappedHoursByJournal[c]?a.mappedHoursByJournal[c]+a.mappedHours[c][g]:a.mappedHours[c][g],a.totalHours+=a.mappedHours[c][g]);b.maxPeriods<e&&(b.maxPeriods=e)}})})}h.showDialog("protocol/module.protocol.module.history.dialog.html",b,void 0,void 0,!0)}a.auth=b.current.locals.auth,a.search={},a.criteria={},a.directiveControllers=[],a.myModules=l,a.load=function(){return a.searchForm.$valid?void a.loadData():(g.error("main.messages.form-has-errors"),!1)},a.formState={canCreateProtocol:k()};var n=e.valuemapper({status:"PROTOKOLL_STAATUS"});c.createQueryForm(a,"/moduleProtocols",{},n.objectmapper);var o=a.$watch("criteria.studyYear",function(b){angular.isNumber(b)&&(o(),f.all(n.promises).then(a.loadData))});a.$watch("criteria.moduleObject",function(){a.criteria.module=a.criteria.moduleObject?a.criteria.moduleObject.id:null}),a.clearSearch=function(){a.clearCriteria(),a.search={},a.directiveControllers.forEach(function(a){a.clear()})},a.curriculumVersionModule=function(b){var c="";return c+=b.curriculumVersions.map(function(b){return a.currentLanguageNameField(b)}).join("; "),c+=", ",c+=b.curriculumVersionOccupationModules.map(function(b){return a.currentLanguageNameField(b)}).join("; ")}}]),angular.module("hitsaOis").controller("ModuleProtocolNewController",["$scope","$route","$location","QueryUtils","DataUtils","Classifier","message","ArrayUtils","sharedProperties",function(a,b,c,d,e,f,g,h,i){a.auth=b.current.locals.auth,a.formState={selectedStudents:[]},a.auth.isTeacher()&&(a.formState.teacher=a.auth.teacher);var j=!1;i.getProperties()["module.protocol.default.fields"]&&(a.formState.curriculumVersionObject=i.getProperties()["module.protocol.default.fields"].curriculumVersion,j=!0,a.formState.curriculumVersionOccupationModule=i.getProperties()["module.protocol.default.fields"].module.id,a.formState.studyYear=i.getProperties()["module.protocol.default.fields"].studyYear);var k=f.valuemapper({journalResults:"KUTSEHINDAMINE",status:"OPPURSTAATUS"});a.$watch("formState.curriculumVersionObject",function(){a.formState.curriculumVersion=a.formState.curriculumVersionObject?a.formState.curriculumVersionObject.id:null,j?(j=!1,a.curriculumVersionOccupationModuleChange()):a.formState.curriculumVersionOccupationModule=void 0,a.formState.curriculumVersion&&(a.formState.curriculumVersionOccupationModules=d.endpoint("/moduleProtocols/occupationModules/"+a.formState.curriculumVersion).query())}),a.curriculumVersionOccupationModuleChange=function(){var b=d.endpoint("/moduleProtocols/occupationModule/"+a.formState.studyYear+"/"+a.formState.curriculumVersionOccupationModule).get();a.tabledata={$promise:b.$promise},b.$promise.then(function(b){a.formState.selectedStudents=[],a.tabledata.content=k.objectmapper(b.occupationModuleStudents),b.occupationModuleStudents.forEach(function(b){"OPPURSTAATUS_O"===b.status.code&&a.formState.selectedStudents.push(b.studentId)}),b.teacher&&!a.auth.isTeacher()&&(a.formState.teacher=b.teacher)})},a.journalResultsView=function(a){return a.map(function(a){return a.value}).join(" / ")};var l=d.endpoint("/moduleProtocols");a.submit=function(){if(!a.moduleProtocolNewForm.$valid)return g.error("main.messages.form-has-errors"),a.moduleProtocolNewForm.$setSubmitted(),!1;if(h.isEmpty(a.formState.selectedStudents))return void g.error("moduleProtocol.error.noStudents");var b={};b.protocolVdata={curriculumVersionOccupationModule:a.formState.curriculumVersionOccupationModule,curriculumVersion:a.formState.curriculumVersion,studyYear:a.formState.studyYear,teacher:a.formState.teacher},b.protocolStudents=a.formState.selectedStudents.map(function(a){return{studentId:a}}),new l(b).$save().then(function(a){g.info("main.messages.create.success"),c.url("/moduleProtocols/"+a.id+"/edit?_noback")})}}]),angular.module("hitsaOis").config(["$routeProvider","USER_ROLES",function(a,b){a.when("/moduleProtocols",{templateUrl:"protocol/module.protocol.list.html",controller:"ModuleProtocolListController",controllerAs:"moduleProtocolListController",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:function(a,c){return a.vocational&&-1!==c.indexOf(b.ROLE_OIGUS_V_TEEMAOIGUS_MOODULPROTOKOLL)}}}).when("/moduleProtocols/new",{templateUrl:"protocol/module.protocol.new.html",controller:"ModuleProtocolNewController",controllerAs:"moduleProtocolNewController",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],isCreate:function(){return!0}},data:{authorizedRoles:function(a,c){return a.vocational&&-1!==c.indexOf(b.ROLE_OIGUS_M_TEEMAOIGUS_MOODULPROTOKOLL)}}}).when("/moduleProtocols/:id/:action",{templateUrl:function(a){return"edit"===a.action?"protocol/module.protocol.edit.html":"protocol/module.protocol.view.html"},controller:"ModuleProtocolController",controllerAs:"moduleProtocolController",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],entity:["QueryUtils","$route",function(a,b){return a.endpoint("/moduleProtocols").get({id:b.current.params.id}).$promise}],isView:["$route",function(a){return"view"===a.current.params.action}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_MOODULPROTOKOLL,b.ROLE_OIGUS_M_TEEMAOIGUS_MOODULPROTOKOLL]}})}]),angular.module("hitsaOis").controller("PracticeApplicationStudentController",["$route","$scope","$q","Classifier","QueryUtils","dialogService","FormUtils","message",function(a,b,c,d,e,f,g,h){function i(){e.endpoint(k+"/openAdmissions").query({},function(a){l.objectmapper(a),b.openAdmissions=a})}function j(){e.endpoint(k+"/passedAdmissions").query({},function(a){l.objectmapper(a),b.passedAdmissions=a})}var k="/practiceApplication",l=d.valuemapper({status:"PR_TAOTLUS"});c.all(l.promises).then(function(){i(),j()}),b.canApply=function(a){return(!a.status||"PR_TAOTLUS_C"===a.status.code)&&(!a.isStrict||null===a.places||a.submittedApplications<a.places)},b.apply=function(a){f.showDialog("practiceApplication/practice.application.apply.dialog.html",function(){},function(b){g.withValidForm(b.dialogForm,function(){var c=e.endpoint("/practiceApplication/apply/"+a.id),d=new c(b.application);d.$save().then(function(){h.info("practiceApplication.messages.applicationSubmitted"),i()})["catch"](angular.noop)})})},b.annul=function(a){f.confirmDialog({prompt:"practiceApplication.prompt.annulConfirm"},function(){var b=e.endpoint("/practiceApplication/annul/"+a.id),c=new b;c.$save().then(function(){h.info("practiceApplication.messages.applicationAnnulled"),i()})["catch"](angular.noop)})}}]).controller("PracticeApplicationSearchController",["$q","$scope","dialogService","message","Classifier","QueryUtils","FormUtils","$route",function(a,b,c,d,e,f,g,h){var i="/practiceApplication";b.formState={status:"PR_TAOTLUS_E"},b.currentNavItem=h.current.$$route.data.currentNavItem;var j=e.valuemapper({status:"PR_TAOTLUS"});f.createQueryForm(b,i+"/applications",{order:"p.lastname,p.firstname",status:b.formState.status},j.objectmapper);var k=b.loadData;b.loadData=function(){k(),b.formState.status=b.criteria.status},b.reject=function(a){c.showDialog("practiceApplication/practice.application.reject.dialog.html",function(){},function(b){g.withValidForm(b.dialogForm,function(){var c=f.endpoint("/practiceApplication/reject/"+a.id),e=new c(b.application);e.$save().then(function(){d.info("practiceApplication.messages.applicationRejected"),k()})["catch"](angular.noop)})})},b.accept=function(a){c.confirmDialog({prompt:"practiceApplication.prompt.acceptConfirm"},function(){var b=f.endpoint("/practiceApplication/accept/"+a.id),c=new b;c.$save().then(function(){d.info("practiceApplication.messages.applicationAccepted"),k()})["catch"](angular.noop)})},a.all(j.promises).then(b.loadData)}]).controller("PracticeApplicationPeriodSearchController",["$scope","dialogService","message","QueryUtils","FormUtils","$route",function(a,b,c,d,e,f){var g="/practiceApplication";a.currentNavItem=f.current.$$route.data.currentNavItem,d.createQueryForm(a,g+"/applicationPeriods"),angular.extend(a.criteria,{order:'e."name"'}),a.criteria.validFrom||a.criteria.validThru||angular.extend(a.criteria,{opened:!0}),a.edit=function(a){a&&b.showDialog("practiceEnterprise/practice.enterprise.admission.add.dialog.html",function(e){e.header="enterprise.changePeriod",e.addAllStudentGroups=function(){d.endpoint("/autocomplete/studentgroups").query({valid:!0},function(a){angular.isArray(e.enterprise.studentGroups)||(e.enterprise.studentGroups=[]),e.enterprise.studentGroups=a})},e.$watch("enterprise.studentGroup",function(){angular.isDefined(e.enterprise)&&angular.isDefined(e.enterprise.studentGroup)&&null!==e.enterprise.studentGroup&&e.addStudentGroup()}),e.addStudentGroup=function(){return angular.isArray(e.enterprise.studentGroups)||(e.enterprise.studentGroups=[]),e.enterprise.studentGroups.some(function(a){return a.id===e.enterprise.studentGroup.id})?void c.error("timetable.timetableEvent.error.duplicateStudentGroup"):(e.enterprise.studentGroups.push(e.enterprise.studentGroup),void(e.enterprise.studentGroup=void 0))},e.deleteStudentGroup=function(a){var b=e.enterprise.studentGroups.indexOf(a);-1!==b&&(e.enterprise.studentGroups.splice(b,1),e.dialogForm.$setDirty())},e["delete"]=function(){b.confirmDialog({prompt:"enterprise.admissionTab.deleteConfirm"},function(){var b=d.endpoint("/practiceEnterprise/admission/"+a.id),e=new b;e.$delete().then(function(a){null===a.nameEt?(c.info("main.messages.delete.success"),h()):c.error(a.nameEt)})["catch"](angular.noop)})},d.endpoint("/practiceEnterprise/admission/"+a.id).search().$promise.then(function(b){e.enterprise=b,e.enterprise.validFrom=new Date(b.validFrom),e.enterprise.validThru=new Date(b.validThru),e.enterprise.name=a.enterpriseName,e.enterprise.regCode=a.enterpriseRegCode})},function(b){e.withValidForm(b.dialogForm,function(){var e=d.endpoint("/practiceEnterprise/admission/"+a.id),f=new e(b.enterprise);f.$save().then(function(){c.info("main.messages.create.success"),h()})["catch"](angular.noop)})})};var h=a.loadData;a.loadData=function(){angular.isDefined(a.searchForm)&&a.searchForm.$setSubmitted(),"string"==typeof a.criteria.validFrom&&(a.criteria.validFrom=new Date(a.criteria.validFrom)),"string"==typeof a.criteria.validThru&&(a.criteria.validThru=new Date(a.criteria.validThru));var b=!a.criteria.validFrom||!a.criteria.validThru||a.criteria.validFrom<=a.criteria.validThru;return a.searchForm&&!a.searchForm.$valid||!b?void c.error("main.messages.form-has-errors"):void h()},a.loadData()}]),angular.module("hitsaOis").config(["$routeProvider","USER_ROLES",function(a,b){a.when("/practice/application/myData",{templateUrl:"practiceApplication/practice.application.student.html",controller:"PracticeApplicationStudentController",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]}}).when("/practice/applications",{templateUrl:"practiceApplication/practice.application.list.html",controller:"PracticeApplicationSearchController",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_PRAKTIKAAVALDUS],currentNavItem:"practice.application"}}).when("/practice/applicationPeriods",{templateUrl:"practiceApplication/practice.application.period.list.html",controller:"PracticeApplicationPeriodSearchController",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_PRAKTIKAAVALDUS],currentNavItem:"practice.application-period"}})}]),angular.module("hitsaOis").controller("PracticeEnterprisePersonsEditController",["$scope","$route","QueryUtils","dialogService","message","FormUtils","Classifier","$q","$timeout",function(a,b,c,d,e,f,g,h,i){a.currentNavItem="enterprise.persons",a.auth=b.current.locals.auth,a.enterprise={},a.enterprise.id=b.current.params.id,a.enterprise.enterpriseSchoolId=b.current.params.enterpriseSchoolId,a.enterprise.application=window.localStorage.getItem("enterpriseApplication");var j=c.endpoint("/practiceEnterprise/"+a.enterprise.enterpriseSchoolId+"/persons"),k=g.valuemapper({country:"RIIK"}),l=function(){c.createQueryForm(a,"/practiceEnterprise/"+a.enterprise.enterpriseSchoolId+"/persons",{},k.objectmapper),h.all(k.promises).then(a.loadData)};l(),a.viewPerson=function(a){d.showDialog("practiceEnterprise/practice.enterprise.person.view.dialog.html",function(b){b.enterprise=a,b.enterprise.name=window.localStorage.getItem("enterpriseName"),b.enterprise.regCode=window.localStorage.getItem("enterpriseRegCode")},null)},a.addNewPerson=function(b){d.showDialog("practiceEnterprise/practice.enterprise.person.add.dialog.html",function(f){f.auth=a.auth,f.checkIdCode=function(){var b=!0,c=f.dialogForm.idcode,d=f.dialogForm.country;c.$setTouched(),d.$setTouched(),a.tabledata.content.forEach(function(a){a.id===f.enterprise.id||f.enterprise.idcode!==a.idcode||void 0===f.enterprise.idcode&&void 0===f.enterprise.county||(void 0!==a.country||void 0!==f.enterprise.country&&""!==f.enterprise.country)&&(void 0===a.country||void 0==f.enterprise.country||a.country.code!==f.enterprise.country)||(b=!1)}),c.$setValidity("idCodeDuplicate",b)},f["delete"]=function(){d.confirmDialog({prompt:"enterprise.personsTab.deleteConfirm"},function(){var a=c.endpoint("/practiceEnterprise/person/"+b.id),d=new a;d.$delete().then(function(){e.info("main.messages.delete.success"),l()})["catch"](angular.noop)})},b?(f.enterprise=angular.copy(b),void 0!==b.country&&(f.enterprise.country=b.country.code),f.enterprise.name=window.localStorage.getItem("enterpriseName"),f.enterprise.regCode=window.localStorage.getItem("enterpriseRegCode")):(f.enterprise={},f.enterprise.name=window.localStorage.getItem("enterpriseName"),f.enterprise.regCode=window.localStorage.getItem("enterpriseRegCode"),f.enterprise.supervisor=!0)},function(a){f.withValidForm(a.dialogForm,function(){if(b){var d=c.endpoint("/practiceEnterprise/person/"+b.id),f=new d(a.enterprise);f.$save().then(function(){e.info("main.messages.create.success"),l()})["catch"](angular.noop)}else{var g=new j(a.enterprise);g.$save().then(function(){e.info("main.messages.create.success"),l()})["catch"](angular.noop)}})})}}]).controller("PracticeEnterpriseLocationsEditController",["$scope","$route","QueryUtils","dialogService","message","FormUtils","Classifier","$q","$timeout",function(a,b,c,d,e,f,g,h,i){a.currentNavItem="enterprise.locations",a.auth=b.current.locals.auth,a.enterprise={},a.enterprise.id=b.current.params.id,a.enterprise.enterpriseSchoolId=b.current.params.enterpriseSchoolId,a.enterprise.application=window.localStorage.getItem("enterpriseApplication");var j=c.endpoint("/practiceEnterprise/"+a.enterprise.enterpriseSchoolId+"/locations"),k=g.valuemapper({country:"RIIK",language:"OPPEKEEL"}),l=function(){c.createQueryForm(a,"/practiceEnterprise/"+a.enterprise.enterpriseSchoolId+"/locations",{},k.objectmapper),h.all(k.promises).then(a.loadData)};l(),a.addNewLocation=function(b){d.showDialog("practiceEnterprise/practice.enterprise.location.add.dialog.html",function(f){f.auth=a.auth,f["delete"]=function(){d.confirmDialog({prompt:"enterprise.locationsTab.deleteConfirm"},function(){var a=c.endpoint("/practiceEnterprise/location/"+b.id),d=new a;d.$delete().then(function(){e.info("main.messages.delete.success"),l()})["catch"](angular.noop)})},b?(f.enterprise=angular.copy(b),void 0!==b.language&&(f.enterprise.language=b.language.code),void 0!==b.country&&(f.enterprise.country=b.country.code),f.enterprise.name=window.localStorage.getItem("enterpriseName"),f.enterprise.regCode=window.localStorage.getItem("enterpriseRegCode")):(f.enterprise={},f.enterprise.language="OPPEKEEL_E",f.enterprise.country="RIIK_EST",f.enterprise.name=window.localStorage.getItem("enterpriseName"),f.enterprise.regCode=window.localStorage.getItem("enterpriseRegCode")),f.isAddressFilled=function(a){return"RIIK_EST"===a.country?a.address&&a.addressAds&&a.addressOid:a.address},f.checkAddress=function(){return f.isAddressFilled(f.enterprise)?void f.submit():(e.error("student.error.addressRequired"),!1)}},function(a){f.withValidForm(a.dialogForm,function(){if(b){var d=c.endpoint("/practiceEnterprise/location/"+b.id),f=new d(a.enterprise);f.$save().then(function(){e.info("main.messages.create.success"),l()})["catch"](angular.noop)}else{var g=new j(a.enterprise);g.$save().then(function(){e.info("main.messages.create.success"),l()})["catch"](angular.noop)}})})}}]).controller("PracticeEnterpriseStudentGroupsEditController",["$scope","$route","QueryUtils","dialogService","message","FormUtils","Classifier","$q","$timeout",function(a,b,c,d,e,f,g,h,i){a.currentNavItem="enterprise.studentGroups",a.auth=b.current.locals.auth,a.enterprise={},a.enterprise.id=b.current.params.id,a.enterprise.enterpriseSchoolId=b.current.params.enterpriseSchoolId,a.enterprise.application=window.localStorage.getItem("enterpriseApplication");var j=c.endpoint("/practiceEnterprise/"+a.enterprise.enterpriseSchoolId+"/studentGroups"),k=g.valuemapper({iscedClass:"ISCED_RYHM"}),l=function(){c.createQueryForm(a,"/practiceEnterprise/"+a.enterprise.enterpriseSchoolId+"/studentGroups",{},k.objectmapper),h.all(k.promises).then(a.loadData)};l(),a.addNewStudentGroup=function(a){d.showDialog("practiceEnterprise/practice.enterprise.studentGroups.add.dialog.html",function(b){b["delete"]=function(){d.confirmDialog({prompt:"enterprise.studentGroupTab.deleteConfirm"},function(){var b=c.endpoint("/practiceEnterprise/studentGroup/"+a.id),d=new b;d.$delete().then(function(){e.info("main.messages.delete.success"),l()})["catch"](angular.noop)})},a?(b.enterprise=angular.copy(a),b.enterprise.iscedClass=a.iscedClass.code,b.enterprise.name=window.localStorage.getItem("enterpriseName"),b.enterprise.regCode=window.localStorage.getItem("enterpriseRegCode")):(b.enterprise={},b.enterprise.name=window.localStorage.getItem("enterpriseName"),b.enterprise.regCode=window.localStorage.getItem("enterpriseRegCode"))},function(b){f.withValidForm(b.dialogForm,function(){if(a){var d=c.endpoint("/practiceEnterprise/studentGroup/"+a.id),f=new d(b.enterprise);f.$save().then(function(){e.info("main.messages.create.success"),l()})["catch"](angular.noop)}else{var g=new j(b.enterprise);g.$save().then(function(){e.info("main.messages.create.success"),l()})["catch"](angular.noop)}})})}}]).controller("PracticeEnterpriseGradesEditController",["$scope","$route","QueryUtils","Classifier","message","$q","$location","FormUtils","$timeout",function(a,b,c,d,e,f,g,h,i){a.currentNavItem="enterprise.grades",a.auth=b.current.locals.auth,a.enterprise={},a.enterprise.id=b.current.params.id,a.enterprise.enterpriseSchoolId=b.current.params.enterpriseSchoolId,a.enterprise.application=window.localStorage.getItem("enterpriseApplication");var j=c.endpoint("/practiceEnterprise/"+a.enterprise.enterpriseSchoolId+"/grades");a.getCurrentColor=function(a,b){return"PR_HINNANG_A"===a&&new Date(b)<new Date?"#dadd88":"PR_HINNANG_T"===a||"PR_HINNANG_A"===a?"#a4dba7":"PR_HINNANG_E"===a?"#dd9d9d":"PR_HINNANG_X"===a?"#dadd88":void 0===a||"PR_HINNANG_P"===a?"#c9c9c9":"white"};var k=d.valuemapper({ratingCode:"PR_HINNANG"}),l=function(){c.endpoint("/practiceEnterprise/"+a.enterprise.enterpriseSchoolId+"/grade").search().$promise.then(function(b){a.grade=b}),c.createQueryForm(a,"/practiceEnterprise/"+a.enterprise.id+"/grades",{},k.objectmapper),f.all(k.promises).then(a.loadData)};l(),a.saveGrade=function(){var b=new j(a.grade);h.withValidForm(a.gradeForm,function(){b.$save().then(function(){e.info("main.messages.create.success"),l()})["catch"](angular.noop)})},a.deleteGrade=function(){var a=new j;a.$delete().then(function(){e.info("main.messages.delete.success"),l()})["catch"](angular.noop)}}]).controller("PracticeEnterpriseContractsViewController",["$scope","$route","$q","QueryUtils","Classifier","$timeout",function(a,b,c,d,e,f){a.currentNavItem="enterprise.contracts",a.auth=b.current.locals.auth,a.enterprise={},a.enterprise.id=b.current.params.id,a.enterprise.enterpriseSchoolId=b.current.params.enterpriseSchoolId,a.enterprise.application=window.localStorage.getItem("enterpriseApplication");var g=e.valuemapper({status:"LEPING_STAATUS"}),h=function(){d.createQueryForm(a,"/practiceEnterprise/"+a.enterprise.enterpriseSchoolId+"/contracts",{},g.objectmapper),c.all(g.promises).then(a.loadData)};h()}]).controller("PracticeEnterpriseAdmissionEditController",["$scope","$route","QueryUtils","dialogService","message","FormUtils","$q","$timeout",function(a,b,c,d,e,f,g,h){a.currentNavItem="enterprise.admission",a.auth=b.current.locals.auth,a.enterprise={},a.enterprise.id=b.current.params.id,a.enterprise.enterpriseSchoolId=b.current.params.enterpriseSchoolId,a.enterprise.application=window.localStorage.getItem("enterpriseApplication");var i=c.endpoint("/practiceEnterprise/"+a.enterprise.enterpriseSchoolId+"/admissions"),j=function(){c.createQueryForm(a,"/practiceEnterprise/"+a.enterprise.enterpriseSchoolId+"/admissions"),g.all().then(a.loadData)};j(),a.addNewAdmission=function(a){d.showDialog("practiceEnterprise/practice.enterprise.admission.add.dialog.html",function(b){b.now=new Date,b.addAllStudentGroups=function(){c.endpoint("/autocomplete/studentgroups").query({valid:!0},function(a){angular.isArray(b.enterprise.studentGroups)||(b.enterprise.studentGroups=[]),b.enterprise.studentGroups=a})},b.$watch("enterprise.studentGroup",function(){angular.isDefined(b.enterprise)&&angular.isDefined(b.enterprise.studentGroup)&&null!==b.enterprise.studentGroup&&b.addStudentGroup()}),b.addStudentGroup=function(){return angular.isArray(b.enterprise.studentGroups)||(b.enterprise.studentGroups=[]),b.enterprise.studentGroups.some(function(a){return a.id===b.enterprise.studentGroup.id})?void e.error("timetable.timetableEvent.error.duplicateStudentGroup"):(b.enterprise.studentGroups.push(b.enterprise.studentGroup),void(b.enterprise.studentGroup=void 0))},b.deleteStudentGroup=function(a){var c=b.enterprise.studentGroups.indexOf(a);-1!==c&&(b.enterprise.studentGroups.splice(c,1),b.dialogForm.$setDirty())},b["delete"]=function(){d.confirmDialog({prompt:"enterprise.admissionTab.deleteConfirm"},function(){var b=c.endpoint("/practiceEnterprise/admission/"+a.id),d=new b;d.$delete().then(function(a){null===a.nameEt?(e.info("main.messages.delete.success"),j()):e.error(a.nameEt)})["catch"](angular.noop)})},a?c.endpoint("/practiceEnterprise/admission/"+a.id).search().$promise.then(function(a){b.enterprise=a,b.enterprise.validFrom=new Date(a.validFrom),b.enterprise.validThru=new Date(a.validThru),b.enterprise.name=window.localStorage.getItem("enterpriseName"),b.enterprise.regCode=window.localStorage.getItem("enterpriseRegCode")}):(b.enterprise={},b.enterprise.name=window.localStorage.getItem("enterpriseName"),b.enterprise.regCode=window.localStorage.getItem("enterpriseRegCode"))},function(b){f.withValidForm(b.dialogForm,function(){if(a){var d=c.endpoint("/practiceEnterprise/admission/"+a.id),f=new d(b.enterprise);f.$save().then(function(){e.info("main.messages.create.success"),j()})["catch"](angular.noop)}else{var g=new i(b.enterprise);g.$save().then(function(){e.info("main.messages.create.success"),j()})["catch"](angular.noop)}})})}}]),angular.module("hitsaOis").controller("PracticeEnterpriseViewController",["$route","$scope","QueryUtils","message",function(a,b,c,d){b.currentNavItem="enterprise.data",b.auth=a.current.locals.auth,b.viewForm=!0;var e=a.current.params.id,f="/practiceEnterprise",g=c.endpoint(f);b.enterprise=g.get({id:e}),b.enterprise.$promise.then(function(a){window.localStorage.setItem("enterpriseName",a.name),null!==a.regCode?window.localStorage.setItem("enterpriseRegCode",a.regCode):window.localStorage.removeItem("enterpriseRegCode"),a.application?window.localStorage.setItem("enterpriseApplication",a.application):window.localStorage.removeItem("enterpriseApplication")}),b.update=function(){"RIIK_EST"===b.enterprise.country&&b.enterprise.regCode&&!b.enterprise.person&&(c.loadingWheel(b,!0),c.endpoint(f+"/updateRegCode").get({country:b.enterprise.country,regCode:b.enterprise.regCode,language:b.enterprise.language,active:b.enterprise.active,id:b.enterprise.enterpriseSchoolId}).$promise.then(function(a){c.loadingWheel(b,!1),void 0===a.status||null===a.status?b.enterprise=a:d.error(a.status)})["catch"](angular.noop))}}]),angular.module("hitsaOis").controller("PracticeEnterpriseEditController",["$location","$route","$scope","message","dialogService","FormUtils","QueryUtils",function(a,b,c,d,e,f,g){function h(a){angular.isDefined(a)&&null!==a?(c.enterprise=k.get({id:a}),c.enterprise.$promise.then(function(a){window.localStorage.setItem("enterpriseName",a.name),null!==a.regCode?window.localStorage.setItem("enterpriseRegCode",a.regCode):window.localStorage.removeItem("enterpriseRegCode"),a.application?window.localStorage.setItem("enterpriseApplication",a.application):window.localStorage.removeItem("enterpriseApplication"),c.enterpriseForm.$setPristine()})):c.enterprise=new k({active:!0,country:"RIIK_EST",language:"OPPEKEEL_E"})}c.currentNavItem="enterprise.data",c.auth=b.current.locals.auth;var i=b.current.params.id,j="/practiceEnterprise",k=g.endpoint(j);c.clearAddressAndRegCode=function(){c.enterprise.addressRegister=void 0,c.enterprise.regCode=void 0},c.goBack=function(){var b="/practice/enterprise";c.enterpriseForm.$dirty?e.confirmDialog({prompt:"main.messages.confirmFormDataNotSaved"},function(){a.path(b)}):a.path(b)},c.sameCountryAndCode=function(){null!==c.enterprise.country&&null!==c.enterprise.regCode&&(g.loadingWheel(c,!0),g.endpoint(j+"/sameCountryAndCode").get({country:c.enterprise.country,regCode:c.enterprise.regCode}).$promise.then(function(a){var b;a.status?(d.error(a.status),b=c.enterpriseForm.enterpriseCode,b.$setValidity("enterpriseCodeError",!1)):(b=c.enterpriseForm.enterpriseCode,b.$setValidity("enterpriseCodeError",!0)),g.loadingWheel(c,!1)})["catch"](angular.noop))},c.lookupRegNr=function(){"RIIK_EST"===c.enterprise.country&&void 0===c.enterpriseForm.enterpriseCode.$error.pattern&&void 0===c.enterpriseForm.enterpriseCode.$error.minlength&&void 0===c.enterpriseForm.enterpriseCode.$error.maxlength&&c.enterprise.regCode&&(g.loadingWheel(c,!0),g.endpoint(j+"/regCodeCheck").get({country:c.enterprise.country,regCode:c.enterprise.regCode,language:c.enterprise.language,active:c.enterprise.active}).$promise.then(function(a){var b;a.status?(d.error(a.status),b=c.enterpriseForm.enterpriseCode,b.$setValidity("enterpriseCodeError",!1)):(b=c.enterpriseForm.enterpriseCode,b.$setValidity("enterpriseCodeError",!0),void 0===c.enterprise.address||null===c.enterprise.address?c.enterprise=new k({regCode:c.enterprise.regCode,active:c.enterprise.active,language:c.enterprise.language,name:a.name,address:a.address,addressAds:a.addressAds,addressOid:a.addressOid,addressRegister:a.address,registerAddress:a.registerAddress,registerAddressAds:a.registerAddressAds,registerAddressOid:a.registerAddressOid,country:c.enterprise.country,postcode:c.enterprise.postcode,email:c.enterprise.email,phone:c.enterprise.phone,places:c.enterprise.places,placesDescr:c.enterprise.placesDescr,addInfo:c.enterprise.addInfo,person:c.enterprise.person,id:c.enterprise.id}):c.enterprise=new k({regCode:c.enterprise.regCode,active:c.enterprise.active,language:c.enterprise.language,name:a.name,address:c.enterprise.address,addressAds:c.enterprise.addressAds,addressOid:c.enterprise.addressOid,registerAddress:a.registerAddress,registerAddressAds:a.registerAddressAds,registerAddressOid:a.registerAddressOid,country:c.enterprise.country,postcode:c.enterprise.postcode,email:c.enterprise.email,phone:c.enterprise.phone,places:c.enterprise.places,placesDescr:c.enterprise.placesDescr,addInfo:c.enterprise.addInfo,person:c.enterprise.person,id:c.enterprise.id}),c.cameFromRegister=!0),g.loadingWheel(c,!1)})["catch"](angular.noop))},c.lookupRegNrForAddressOnly=function(a){"RIIK_EST"===a.country&&a.regCode&&!a.person&&g.endpoint(j+"/regCodeWithoutCheck").get({country:a.country,regCode:a.regCode,language:a.language,active:a.active}).$promise.then(function(a){null===a.status&&(c.enterprise=new k({regCode:c.enterprise.regCode,active:c.enterprise.active,application:c.enterprise.application,language:c.enterprise.language,name:c.enterprise.name,address:c.enterprise.address,addressAds:c.enterprise.addressAds,addressOid:c.enterprise.addressOid,registerAddress:a.registerAddress,registerAddressAds:a.registerAddressAds,registerAddressOid:a.registerAddressOid,country:c.enterprise.country,postcode:c.enterprise.postcode,email:c.enterprise.email,phone:c.enterprise.phone,places:c.enterprise.places,placesDescr:c.enterprise.placesDescr,addInfo:c.enterprise.addInfo,person:c.enterprise.person,ebusinessUpdated:c.enterprise.ebusinessUpdated,enterpriseSchoolId:c.enterprise.enterpriseSchoolId,id:c.enterprise.id}))})["catch"](angular.noop)},c["delete"]=function(){e.confirmDialog({prompt:"enterprise.delete"
},function(){var b=g.endpoint("/practiceEnterprise/"+c.enterprise.enterpriseSchoolId),e=new b;e.$delete().then(function(){d.info("main.messages.delete.success"),a.url("/practice/enterprise/")})["catch"](angular.noop)})},h(i),c.update=function(){f.withValidForm(c.enterpriseForm,function(){c.enterprise.$save().then(function(b){d.info("main.messages.create.success"),a.url("/practice/enterprise/"+b.id+"/edit?_noback")})["catch"](angular.noop)})}}]).directive("stringToNumber",function(){return{require:"ngModel",link:function(a,b,c,d){d.$parsers.push(function(a){return""+a}),d.$formatters.push(function(a){return parseFloat(a)})}}}),angular.module("hitsaOis").controller("PracticeEnterpriseListController",["$scope","$route","QueryUtils","dialogService","oisFileService","config","$q","Classifier",function(a,b,c,d,e,f,g,h){function i(a){c.endpoint("/practiceEnterprise/importCsv").save({file:a},function(a){d.showDialog("practiceEnterprise/practice.enterprise.csv.result.dialog.html",function(b){b.enterprise=a},null)})}a.auth=b.current.locals.auth,a.csvSampleFileUrl=f.apiUrl+"/practiceEnterprise/sample.csv";var j=h.valuemapper({ratingCode:"PR_HINNANG"});c.createQueryForm(a,"/practiceEnterprise",{enterpriseActive:!0},j.objectmapper),g.all(j.promises).then(a.loadData),a.getCurrentColor=function(a,b){return"PR_HINNANG_A"===a&&new Date(b)<new Date?"#dadd88":"PR_HINNANG_T"===a||"PR_HINNANG_A"===a?"#a4dba7":"PR_HINNANG_E"===a?"#dd9d9d":"PR_HINNANG_X"===a?"#dadd88":void 0===a||"PR_HINNANG_P"===a?"#c9c9c9":"white"},a.importEnterprise=function(){d.showDialog("practiceEnterprise/practice.enterprise.import.csv.file.dialog.html",null,function(a){var b=a.data;e.getFromLfFile(b.file[0],function(a){d.hide(),i(a)})})}}]),angular.module("hitsaOis").config(["$routeProvider","USER_ROLES",function(a,b){a.when("/practice/enterprise",{templateUrl:"practiceEnterprise/practice.enterprise.list.html",controller:"PracticeEnterpriseListController",data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_ETTEVOTE]},resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]}}).when("/practice/enterprise/new",{templateUrl:"practiceEnterprise/practice.enterprise.edit.html",controller:"PracticeEnterpriseEditController",data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_ETTEVOTE]},resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]}}).when("/practice/enterprise/:id/view",{templateUrl:"practiceEnterprise/practice.enterprise.view.html",controller:"PracticeEnterpriseViewController",data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_ETTEVOTE]},resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]}}).when("/practice/enterprise/:id/edit",{templateUrl:"practiceEnterprise/practice.enterprise.edit.html",controller:"PracticeEnterpriseEditController",data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_ETTEVOTE]},resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]}}).when("/practice/enterprise/:id/:enterpriseSchoolId/persons/view",{templateUrl:"practiceEnterprise/practice.enterprise.persons.view.html",controller:"PracticeEnterprisePersonsEditController",data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_ETTEVOTE]},resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]}}).when("/practice/enterprise/:id/:enterpriseSchoolId/persons/edit",{templateUrl:"practiceEnterprise/practice.enterprise.persons.edit.html",controller:"PracticeEnterprisePersonsEditController",data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_ETTEVOTE]},resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]}}).when("/practice/enterprise/:id/:enterpriseSchoolId/locations/edit",{templateUrl:"practiceEnterprise/practice.enterprise.locations.edit.html",controller:"PracticeEnterpriseLocationsEditController",data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_ETTEVOTE]},resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]}}).when("/practice/enterprise/:id/:enterpriseSchoolId/locations/view",{templateUrl:"practiceEnterprise/practice.enterprise.locations.view.html",controller:"PracticeEnterpriseLocationsEditController",data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_ETTEVOTE]},resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]}}).when("/practice/enterprise/:id/:enterpriseSchoolId/studentGroups/edit",{templateUrl:"practiceEnterprise/practice.enterprise.studentGroups.edit.html",controller:"PracticeEnterpriseStudentGroupsEditController",data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_ETTEVOTE]},resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]}}).when("/practice/enterprise/:id/:enterpriseSchoolId/studentGroups/view",{templateUrl:"practiceEnterprise/practice.enterprise.studentGroups.view.html",controller:"PracticeEnterpriseStudentGroupsEditController",data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_ETTEVOTE]},resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]}}).when("/practice/enterprise/:id/:enterpriseSchoolId/contracts/view",{templateUrl:"practiceEnterprise/practice.enterprise.contracts.view.html",controller:"PracticeEnterpriseContractsViewController",data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_ETTEVOTE]},resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]}}).when("/practice/enterprise/:id/:enterpriseSchoolId/contracts/edit",{templateUrl:"practiceEnterprise/practice.enterprise.contracts.edit.html",controller:"PracticeEnterpriseContractsViewController",data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_ETTEVOTE]},resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]}}).when("/practice/enterprise/:id/:enterpriseSchoolId/grades/view",{templateUrl:"practiceEnterprise/practice.enterprise.grades.view.html",controller:"PracticeEnterpriseGradesEditController",data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_ETTEVOTE]},resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]}}).when("/practice/enterprise/:id/:enterpriseSchoolId/grades/edit",{templateUrl:"practiceEnterprise/practice.enterprise.grades.edit.html",controller:"PracticeEnterpriseGradesEditController",data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_ETTEVOTE]},resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]}}).when("/practice/enterprise/:id/:enterpriseSchoolId/admission/edit",{templateUrl:"practiceEnterprise/practice.enterprise.admission.edit.html",controller:"PracticeEnterpriseAdmissionEditController",data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_ETTEVOTE]},resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]}}).when("/practice/enterprise/:id/:enterpriseSchoolId/admission/view",{templateUrl:"practiceEnterprise/practice.enterprise.admission.view.html",controller:"PracticeEnterpriseAdmissionEditController",data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_ETTEVOTE]},resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]}})}]),angular.module("hitsaOis").controller("PracticeEvaluationSearchController",["$q","$scope","dialogService","message","Classifier","QueryUtils",function(a,b,c,d,e,f){var g="/practiceEvaluation";b.criteria={isActive:!0};var h=e.valuemapper({target:"PRAKTIKA_SIHTRYHM"});f.createQueryForm(b,g,{order:"pe.name_et",isActive:b.criteria.isActive},h.objectmapper),a.all(h.promises).then(b.loadData)}]).controller("PracticeEvaluationEditController",["$scope","$route","$location","dialogService","message","QueryUtils","Classifier","FormUtils","ArrayUtils",function(a,b,c,d,e,f,g,h,i){function j(){a.record.criteria.sort(function(a,b){return a.orderNr-b.orderNr})}function k(){return a.criteria.nameEt&&a.criteria.type}var l="/practiceEvaluation",m=b.current.params.id;a.auth=b.current.locals.auth,g.queryForDropdown({mainClassCode:"PRAKTIKA_KRITEERIUM"}).$promise.then(function(b){a.criteriaMap=g.toMap(b)});var n=f.endpoint(l);m?(a.record=n.get({id:m}),a.record.$promise.then(j)):(a.record=new n({isActive:!0,criteria:[]}),j()),a.update=function(){h.withValidForm(a.practiceEvaluationForm,function(){a.record.id?a.record.$update().then(function(){e.updateSuccess(),j(),a.practiceEvaluationForm.$setPristine()})["catch"](angular.noop):a.record.$save().then(function(){e.info("main.messages.create.success"),c.url("/practice/evaluation/"+a.record.id+"/edit?_noback")})["catch"](angular.noop)})},a["delete"]=function(){d.confirmDialog({prompt:"practiceEvaluation.deleteconfirm"},function(){a.record.$delete().then(function(){e.info("main.messages.delete.success"),c.url("/practice/evaluation")})})},a.isEditingCriteria=!1,a.editedCriteria=null,a.criteria={},a.addCriteria=function(){k()&&(a.criteria.orderNr=a.record.criteria.length,a.record.criteria.push(a.criteria),a.criteria={})},a.swapCriteria=function(b,c){var d=a.record.criteria[b];a.record.criteria[b]=a.record.criteria[c],a.record.criteria[c]=d,d=a.record.criteria[b].orderNr,a.record.criteria[b].orderNr=a.record.criteria[c].orderNr,a.record.criteria[c].orderNr=d,a.practiceEvaluationForm.$setDirty()},a.editCriteria=function(b){a.isEditingCriteria=!0,a.editedCriteria=b,a.criteria.nameEt=b.nameEt,a.criteria.addInfo=b.addInfo,a.criteria.type=b.type,a.criteria.disabled=b.disabled},a.saveCriteria=function(){k()&&(a.isEditingCriteria=!1,a.editedCriteria.nameEt=a.criteria.nameEt,a.editedCriteria.addInfo=a.criteria.addInfo,a.editedCriteria.type=a.criteria.type,a.criteria={})},a.removeCriteria=function(b,c){b.length>1?d.confirmDialog({prompt:"practiceEvaluation.criteria.deleteconfirm"},function(){i.remove(b,c),a.practiceEvaluationForm.$setDirty()}):d.messageDialog({prompt:"main.messages.error.atLeastOneShouldBeAdded"})}}]).controller("PracticeEvaluationViewController",["$route","$scope","oisFileService","Classifier","QueryUtils",function(a,b,c,d,e){function f(){b.record.criteria.sort(function(a,b){return a.orderNr-b.orderNr})}var g="/practiceEvaluation",h=a.current.params.id;d.queryForDropdown({mainClassCode:"PRAKTIKA_KRITEERIUM"}).$promise.then(function(a){b.criteriaMap=d.toMap(a)}),b.record=e.endpoint(g).get({id:h},function(){f()})}]),angular.module("hitsaOis").config(["$routeProvider","USER_ROLES",function(a,b){a.when("/practice/evaluation",{templateUrl:"practiceEvaluation/practice.evaluation.list.html",controller:"PracticeEvaluationSearchController",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_PRHINDAMISVORM]}}).when("/practice/evaluation/new",{templateUrl:"practiceEvaluation/practice.evaluation.edit.html",controller:"PracticeEvaluationEditController",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_PRHINDAMISVORM]}}).when("/practice/evaluation/:id/edit",{templateUrl:"practiceEvaluation/practice.evaluation.edit.html",controller:"PracticeEvaluationEditController",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_PRHINDAMISVORM]}}).when("/practice/evaluation/:id/view",{templateUrl:"practiceEvaluation/practice.evaluation.view.html",controller:"PracticeEvaluationViewController",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_PRHINDAMISVORM]}})}]),angular.module("hitsaOis").controller("PracticeStudentListController",["$scope","$route","QueryUtils","Classifier","$q","$localStorage",function(a,b,c,d,e,f){a.currentNavItem="practice.students",a.auth=b.current.locals.auth;var g=d.valuemapper({status:"LEPING_STAATUS"});b.current.params._menu&&(f.contractStatisticsReset=!0,f.studyYearStatisticsReset=!0),f.contractStatisticsReset&&(a.contractParam="?_menu"),f.studyYearStatisticsReset&&(a.studyYearParam="?_menu"),a.formState={xlsUrl:"practiceEnterprise/practiceStudentStatistics.xls"},c.createQueryForm(a,"/practiceEnterprise/studentStatistics",{},g.objectmapper),e.all(g.promises).then(a.loadData)}]).controller("PracticeContractListController",["$scope","$route","QueryUtils","Classifier","$q","$localStorage",function(a,b,c,d,e,f){a.currentNavItem="practice.contracts",a.auth=b.current.locals.auth;var g=d.valuemapper({cancelCode:"LEPING_TYH_POHJUS"});f.studyYearStatisticsReset&&(a.studyYearParam="?_menu"),f.contractStatisticsReset=!1,a.formState={xlsUrl:"practiceEnterprise/practiceContractStatistics.xls"},c.createQueryForm(a,"/practiceEnterprise/contractStatistics",{},g.objectmapper),e.all(g.promises).then(a.loadData)}]).controller("PracticeStudyYearListController",["$scope","$route","QueryUtils","Classifier","$q","$localStorage",function(a,b,c,d,e,f){a.currentNavItem="practice.studyYear",a.auth=b.current.locals.auth;var g=d.valuemapper({status:"LEPING_STAATUS"});f.contractStatisticsReset&&(a.contractParam="?_menu"),f.studyYearStatisticsReset=!1,a.formState={xlsUrl:"practiceEnterprise/practiceStudyYearStatistics.xls"},c.createQueryForm(a,"/practiceEnterprise/studyYearStatistics",{},g.objectmapper),e.all(g.promises).then(a.loadData)}]),angular.module("hitsaOis").config(["$routeProvider","USER_ROLES",function(a,b){a.when("/practice/student/statistics",{templateUrl:"practiceStatistics/practice.student.list.html",controller:"PracticeStudentListController",data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_PRSTATISTIKA]},resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]}}).when("/practice/contract/statistics",{templateUrl:"practiceStatistics/practice.contract.list.html",controller:"PracticeContractListController",data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_PRSTATISTIKA]},resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]}}).when("/practice/studyYear/statistics",{templateUrl:"practiceStatistics/practice.studyYear.list.html",controller:"PracticeStudyYearListController",data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_PRSTATISTIKA]},resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]}})}]),angular.module("hitsaOis").controller("PracticeJournalEditController",["$scope","$rootScope","$location","$route","QueryUtils","Classifier","message","dialogService","DataUtils","USER_ROLES","ArrayUtils",function(a,b,c,d,e,f,g,h,i,j,k){function l(){g.error("main.messages.error.nopermission"),c.path("")}function m(){a.auth.isAdmin()&&-1!==a.auth.authorizedRoles.indexOf(j.ROLE_OIGUS_M_TEEMAOIGUS_PRAKTIKAPAEVIK)||l()}function n(b){b.canEdit&&a.auth.isAdmin()||l()}function o(b){n(b),b.isHigher?a.grades=f.queryForDropdown({mainClassCode:"KORGHINDAMINE"}):a.grades=f.queryForDropdown({mainClassCode:"KUTSEHINDAMINE"}),i.convertStringToDates(b,["startDate","endDate"]),a.formState.isHigher=b.isHigher,i.convertObjectToIdentifier(b,["practiceEvaluation"]),b.moduleSubjects.forEach(function(a){i.convertObjectToIdentifier(a,["module","theme","subject"])}),a.practiceJournal=b}function p(b){e.endpoint("/practiceJournals/studentPracticeModules/"+b.id).query(function(b){a.formState.modulesById={},a.formState.themesById={},a.formState.themesByModuleId={},b.forEach(function(b){a.formState.modulesById[b.module.id]=b,b.themes.forEach(function(b){a.formState.themesById[b.theme.id]=b}),a.formState.themesByModuleId[b.module.id]=b.themes.map(function(a){return a.theme})}),a.formState.modules=b.map(function(a){return a.module}),q()})}function q(){for(var b=a.formState.modules.map(function(a){return a.id}),c=a.practiceJournal.moduleSubjects.length-1;c>=0;c--)a.practiceJournal.moduleSubjects[c].module&&-1===b.indexOf(a.practiceJournal.moduleSubjects[c].module)&&k.remove(a.practiceJournal.moduleSubjects,a.practiceJournal.moduleSubjects[c])}function r(b){e.endpoint("/practiceJournals/studentPracticeSubjects/"+b.id).query(function(b){a.formState.subjectsById={},b.forEach(function(b){a.formState.subjectsById[b.id]=b}),a.formState.subjects=b,s()})}function s(){for(var b=a.formState.subjects.map(function(a){return a.id}),c=a.practiceJournal.moduleSubjects.length-1;c>=0;c--)a.practiceJournal.moduleSubjects[c].subject&&-1===b.indexOf(a.practiceJournal.moduleSubjects[c].subject)&&k.remove(a.practiceJournal.moduleSubjects,a.practiceJournal.moduleSubjects[c])}function t(b){b.module&&!b.theme&&(b.credits=a.formState.modulesById[b.module].credits,b.hours=i.creditsToHours(b.credits))}function u(){return a.practiceJournalForm.$setSubmitted(),a.practiceJournalForm.$valid?0===a.practiceJournal.moduleSubjects.length?(g.error(a.formState.isHigher?"practiceJournal.messages.atleastOneSubjectRequired":"practiceJournal.messages.atleastOneModuleRequired"),!1):!0:(g.error("main.messages.form-has-errors"),!1)}function v(a){var b=moment(),c=moment(a.endDate);return moment.duration(b.diff(c)).asDays()<=x}function w(b){e.endpoint("/practiceJournals/"+a.practiceJournal.id+"/confirm/").put(a.practiceJournal,function(d){g.info("practiceJournal.messages.confirmed"),b?c.path("/practiceJournals"):(o(d),a.practiceJournalForm.$setPristine())})}var x=30;a.auth=d.current.locals.auth,a.practiceJournal={moduleSubjects:[{}]},a.formState={};var y=d.current.locals.entity;angular.isDefined(y)?(o(y),b.removeLastUrlFromHistory(function(a){return a&&-1!==a.indexOf("/practiceJournals/new")})):(m(),a.formState.isHigher=a.auth.school.higher===!0&&(a.auth.school.vocational===!0&&d.current.params.higher===!0||a.auth.school.vocational===!1));var z=f.valuemapper({studyForm:"OPPEVORM"});a.$watch("practiceJournal.student",function(b){angular.isObject(b)&&(e.endpoint("/students/"+b.id).search(function(b){a.formState.student=z.objectmapper(b)}),a.formState.isHigher?r(b):p(b))}),a.addModuleSubject=function(){a.practiceJournal.moduleSubjects.push({})},a.removeModuleSubject=function(b){k.remove(a.practiceJournal.moduleSubjects,b)},a.getAstronomicalHours=i.getAstronomicalHours,a.moduleChanged=function(b,c){var d=a.formState.modulesById[b];if(d){var e=d.themes.map(function(a){return a.theme.id});-1===e.indexOf(c.theme)&&(c.theme=null),t(c),angular.isString(d.assessmentMethodsEt)&&A(d.assessmentMethodsEt)}},a.themeChanged=function(b,c){a.formState.themesById[b]?(c.credits=a.formState.themesById[b].credits,c.hours=i.creditsToHours(c.credits),angular.isString(a.formState.themesById[b].subthemes)&&A(a.formState.themesById[b].subthemes)):t(c)};var A=function(b){if(angular.isString(b))if(void 0===a.practiceJournal.practicePlan||null===a.practiceJournal.practicePlan)a.practiceJournal.practicePlan=b;else if((a.practiceJournal.practicePlan+"\n"+b).length<=2e4)a.practiceJournal.practicePlan+="\n"+b;else{var c=2e4-(a.practiceJournal.practicePlan.length+2);c>0&&(a.practiceJournal.practicePlan+="\n"+b.substring(0,c))}};a.subjectChanged=function(b,c){a.formState.subjectsById[b]&&(c.credits=a.formState.subjectsById[b].credits,c.hours=i.creditsToHours(c.credits),angular.isString(a.formState.subjectsById[b].outcomesEt)&&A(a.formState.subjectsById[b].outcomesEt))},a.updateHours=function(b,c){angular.isNumber(b.credits)&&(b.hours=i.creditsToHours(b.credits),a.practiceJournalForm["hours["+c+"]"].$setDirty())},a.updateCredits=function(b,c){b.credits=i.hoursToCredits(b.hours),a.practiceJournalForm["credits["+c+"]"].$setDirty()};var B=e.endpoint("/practiceJournals");a.save=function(){if(!u())return!1;v(a.practiceJournal),a.practiceJournal.isHigher=a.formState.isHigher;var b=new B(a.practiceJournal);angular.isDefined(a.practiceJournal.id)?v(a.practiceJournal)?b.$update().then(function(){g.info("main.messages.update.success"),o(b),a.practiceJournalForm.$setPristine()}):h.confirmDialog({prompt:"practiceJournal.prompt.isAfterDaysAfterCanEditSave"},function(){b.$update().then(function(){g.info("main.messages.update.success"),c.path("/practiceJournals")})}):v(a.practiceJournal)?b.$save().then(function(){g.info("main.messages.create.success"),c.path("/practiceJournals/"+b.id+"/edit")}):h.confirmDialog({prompt:"practiceJournal.prompt.isAfterDaysAfterCanEditSave"},function(){b.$save().then(function(){g.info("main.messages.create.success"),c.path("/practiceJournals")})})},a.confirm=function(){return u()?(a.practiceJournal.isHigher=a.formState.isHigher,void(v(a.practiceJournal)?h.confirmDialog({prompt:"practiceJournal.prompt.confirmConfirm"},function(){w(!1)}):h.confirmDialog({prompt:"practiceJournal.prompt.isAfterDaysAfterCanEditConfirm"},function(){w(!0)}))):!1},a["delete"]=function(){h.confirmDialog({prompt:"practiceJournal.deleteconfirm"},function(){var b=new B(a.practiceJournal);b.$delete().then(function(){g.info("main.messages.delete.success"),c.path("/practiceJournals")})})}}]),angular.module("hitsaOis").controller("PracticeJournalListController",["$scope","$route","$location","$q","QueryUtils","dialogService","ArrayUtils","USER_ROLES","Classifier","message",function(a,b,c,d,e,f,g,h,i,j){function k(){return a.auth.isAdmin()&&g.includes(a.auth.authorizedRoles,h.ROLE_OIGUS_M_TEEMAOIGUS_PRAKTIKAPAEVIK)}a.auth=b.current.locals.auth;var l=i.valuemapper({status:"PAEVIK_STAATUS"});e.createQueryForm(a,"/practiceJournals",{order:"student_person.lastname,student_person.firstname"},l.objectmapper);var m=a.$watch("criteria.studyYear",function(b){angular.isNumber(b)&&(m(),d.all(l.promises).then(a.loadData))});a.directiveControllers=[];var n=a.clearCriteria;a.clearCriteria=function(){n(),a.directiveControllers.forEach(function(a){a.clear()})},a.load=function(){return a.criteria.studyYear?void a.loadData():(j.error("main.messages.form-has-errors"),!1)},a.formState={canCreate:k()},a.newPracticeJournal=function(){a.auth.school.higher&&a.auth.school.vocational?f.showDialog("practiceJournal/vocational.higher.select.dialog.html",function(){},function(a){a.higher===!0?c.path("/practiceJournals/new").search({higher:!0}):c.path("/practiceJournals/new")}):c.path("/practiceJournals/new")},a.sendToEkis=function(){c.path("/practice/studentgroup/ekis").search({"":"_menu",studentGroup:a.criteria.studentGroup,studentName:a.criteria.studentName})}}]),angular.module("hitsaOis").controller("PracticeJournalEntryController",["$scope","$route","$location","dialogService","oisFileService","QueryUtils","message","DataUtils","ArrayUtils","Classifier",function(a,b,c,d,e,f,g,h,i,j){function k(a){b.current.locals.isEntryEdit!==!0||a.canAddEntries||(g.error("main.messages.error.nopermission"),c.path(""))}function l(b){k(b),h.convertStringToDates(b,["startDate","endDate"]),a.gradesClassCode=b.isHigher?"KORGHINDAMINE":"KUTSEHINDAMINE",a.grades=j.queryForDropdown({mainClassCode:a.gradesClassCode}),b.practiceJournalEntries.forEach(function(a){a.astroHours=h.getAcademicHoursFromDouble(a.hours),a.acadHours=h.getAcademicHours(a.hours)}),a.practiceJournal=b,a.auth.isStudent()&&(a.practiceJournal.endDateDisplay=new Date(a.practiceJournal.endDate),a.practiceJournal.endDateDisplay.setDate(a.practiceJournal.endDateDisplay.getDate()+30)),m()}function m(){var b=0,c=0;a.practiceJournal.practiceJournalEntries.forEach(function(a){void 0!==a.hours&&(b+=a.hours),void 0!==a.acadHours&&(c+=a.acadHours)}),a.totalAstro=h.getAcademicHoursFromDouble(b),a.totalAcad=Math.round(100*c)/100}function n(){return a.practiceJournalEntryForm.$setSubmitted(),a.practiceJournalEntryForm.$valid?0===a.practiceJournal.moduleSubjects.length?(g.error(a.formState.isHigher?"practiceJournal.messages.atleastOneSubjectRequired":"practiceJournal.messages.atleastOneModuleRequired"),!1):!0:(g.error("main.messages.form-has-errors"),!1)}function o(a){var b=moment(),c=moment(a.endDate);return moment.duration(b.diff(c)).asDays()<=r}function p(b){var d=angular.copy(a.practiceJournal);d.moduleSubjects.forEach(function(a){h.convertObjectToIdentifier(a,["module","theme","subject"])}),h.convertObjectToIdentifier(d,["practiceEvaluation"]),f.endpoint("/practiceJournals/"+d.id+"/confirm").put(d,function(d){g.info("practiceJournal.messages.confirmed"),b?c.path("/practiceJournals"):(l(d),a.practiceJournalEntryForm.$setPristine())})}function q(){var b=angular.copy(a.practiceJournal);b.moduleSubjects.forEach(function(a){h.convertObjectToIdentifier(a,["module","theme","subject"])}),h.convertObjectToIdentifier(b,["practiceEvaluation"]),f.endpoint("/practiceJournals/"+b.id+"/open").put(b,function(b){g.info("practiceJournal.messages.opened"),l(b),a.practiceJournalEntryForm.$setPristine()})}a.auth=b.current.locals.auth,a.removeFromArray=i.remove;var r=30;a.practiceJournal={practiceJournalEntries:[],practiceJournalFiles:[],practiceJournalStudentFiles:[]},a.formState={};var s=b.current.locals.entity;angular.isDefined(s)&&l(s),a.getAstronomicalHours=h.getAstronomicalHours,a.hideInvalid=function(a){return!j.isValid(a)},a.setAstronomicalHours=function(a,b){a.hours=h.getAstronomicalHoursAsDouble(b),a.astroHours=h.getAstronomicalHoursAsString(b),m()},a.setAcademicalHours=function(a){void 0!==a.astroHours&&(a.astroHours=a.astroHours.replace(".",":"),a.hours=h.getAcademicHoursFromString(a.astroHours),a.acadHours=h.getAcademicHours(a.hours),m())},a.addNewEntryRow=function(){a.practiceJournal.practiceJournalEntries.push({isStudentEntry:a.auth.isStudent()})},a.getEntryColor=function(b){return a.auth.isStudent()&&!b.isStudentEntry?"pink-50":void 0},a.getGrade=function(b){if(a.grades)for(var c=0;c<a.grades.length;c++)if(a.grades[c].code===b)return a.grades[c]},a.openAddFileDialog=function(b){d.showDialog("practiceJournal/practice.journal.entry.add.file.dialog.html",function(c){b?c.addedFiles=a.practiceJournal.practiceJournalStudentFiles:c.addedFiles=a.practiceJournal.practiceJournalFiles},function(c){var d=c.data;e.getFromLfFile(d.file[0],function(c){d.oisFile=c,b?(d.isStudent=!0,a.practiceJournal.practiceJournalStudentFiles.push(d)):a.practiceJournal.practiceJournalFiles.push(d)})})},a.deleteEntry=function(b){i.remove(a.practiceJournal.practiceJournalEntries,b),m()},a.getUrl=e.getUrl;var t="/practiceJournals/"+a.practiceJournal.id+"/saveEntries/";a.save=function(){if(a.practiceJournalEntryForm.$setSubmitted(),!a.practiceJournalEntryForm.$valid)return void g.error("main.messages.form-has-errors");var b,c=[];c=c.concat(a.practiceJournal.practiceJournalFiles,a.practiceJournal.practiceJournalStudentFiles);var d=[];if(d=d.concat(a.practiceJournal.supervisorPracticeEvalCriteria,a.practiceJournal.studentPracticeEvalCriteria),d=d.filter(function(a){return a.id||!a.id&&(a.valueNr||a.valueTxt||a.valueClf)}),a.auth.isStudent()){var e=f.endpoint(t+"student");b=new e({practiceJournalEntries:a.practiceJournal.practiceJournalEntries,studentPracticeEvalCriteria:d,practiceReport:a.practiceJournal.practiceReport,practiceJournalStudentFiles:c})}else{var h=f.endpoint(t+"teacher");b=new h({teacherComment:a.practiceJournal.teacherComment,teacherOpinion:a.practiceJournal.teacherOpinion,grade:a.practiceJournal.grade,practiceJournalFiles:c,practiceJournalEntries:a.practiceJournal.practiceJournalEntries})}b.$update().then(function(b){g.info("main.messages.create.success"),l(b),a.practiceJournalEntryForm.$setPristine()})};var u=f.endpoint("/practiceJournals");a["delete"]=function(){d.confirmDialog({prompt:"practiceJournal.deleteconfirm"},function(){var b=new u(a.practiceJournal);b.$delete().then(function(){g.info("main.messages.delete.success"),c.path("/practiceJournals")})})},a.getNames=function(a){return a.map(function(a){return a.supervisorName}).join(", ")},a.deleteFile=function(b){d.confirmDialog({prompt:"practiceJournal.prompt.fileDeleteConfirm"},function(){i.remove(a.practiceJournal.practiceJournalFiles,b)})},a.deleteStudentFile=function(b){d.confirmDialog({prompt:"practiceJournal.prompt.fileDeleteConfirm"},function(){i.remove(a.practiceJournal.practiceJournalStudentFiles,b)})},a.confirm=function(){return n()?(a.practiceJournal.isHigher=a.formState.isHigher,void(o(a.practiceJournal)?d.confirmDialog({prompt:"practiceJournal.prompt.confirmConfirm"},function(){p(!1)}):d.confirmDialog({prompt:"practiceJournal.prompt.isAfterDaysAfterCanEditConfirm"},function(){p(!0)}))):!1},a.open=function(){return n()?(a.practiceJournal.isHigher=a.formState.isHigher,void d.confirmDialog({prompt:"practiceJournal.prompt.confirmOpen"},function(){q()})):!1}}]),angular.module("hitsaOis").controller("PracticeJournalSupervisorEntryController",["$scope","$route","dialogService","oisFileService","QueryUtils","message","DataUtils","ArrayUtils","Classifier","$location",function(a,b,c,d,e,f,g,h,i,j){function k(a){a.canAddEntries||(f.error("main.messages.error.nopermission"),j.path(""))}function l(b){k(b),g.convertStringToDates(b,["startDate","endDate"]),a.gradesClassCode=b.isHigher?"KORGHINDAMINE":"KUTSEHINDAMINE",a.grades=i.queryForDropdown({mainClassCode:a.gradesClassCode}),b.practiceJournalEntries.forEach(function(a){a.astroHours=g.getAcademicHoursFromDouble(a.hours),a.acadHours=g.getAcademicHours(a.hours)}),a.practiceJournal=b,a.practiceJournal.endDateDisplay=new Date(a.practiceJournal.endDate),a.practiceJournal.endDateDisplay.setDate(a.practiceJournal.endDateDisplay.getDate()+30),m()}function m(){var b=0,c=0;a.practiceJournal.practiceJournalEntries.forEach(function(a){void 0!==a.hours&&(b+=a.hours),void 0!==a.acadHours&&(c+=a.acadHours)}),a.totalAstro=g.getAcademicHoursFromDouble(b),a.totalAcad=Math.round(100*c)/100}a.removeFromArray=h.remove,a.practiceJournal={practiceJournalEntries:[],practiceJournalFiles:[]},a.formState={};var n=b.current.locals.entity;angular.isDefined(n)&&l(n),a.hideInvalid=function(a){return!i.isValid(a)},a.getNames=function(a){return a.map(function(a){return a.supervisorName}).join(", ")},a.getAstronomicalHours=g.getAstronomicalHours,a.openAddFileDialog=function(){c.showDialog("practiceJournal/practice.journal.entry.add.file.dialog.html",function(b){b.addedFiles=a.practiceJournal.practiceJournalFiles},function(b){var c=b.data;d.getFromLfFile(c.file[0],function(b){c.oisFile=b,a.practiceJournal.practiceJournalFiles.push(c)})})},a.getUrl=d.getUrl;var o=e.endpoint("/practiceJournals/supervisor/"+b.current.params.uuid+"/saveEntries/");a.save=function(){var b=[];b=b.concat(a.practiceJournal.practiceJournalFiles,a.practiceJournal.practiceJournalStudentFiles);var c=[];c=c.concat(a.practiceJournal.supervisorPracticeEvalCriteria,a.practiceJournal.studentPracticeEvalCriteria);var d=new o({supervisorOpinion:a.practiceJournal.supervisorOpinion,supervisorComment:a.practiceJournal.supervisorComment,supervisorPracticeEvalCriteria:c,practiceJournalFiles:b,practiceJournalEntries:a.practiceJournal.practiceJournalEntries});d.$update().then(function(a){f.info("main.messages.create.success"),l(a)})}}]),angular.module("hitsaOis").config(["$routeProvider","USER_ROLES",function(a,b){a.when("/practiceJournals",{templateUrl:"practiceJournal/practice.journal.list.html",controller:"PracticeJournalListController",controllerAs:"PracticeJournalListController",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_PRAKTIKAPAEVIK]}}).when("/practiceJournals/new",{templateUrl:"practiceJournal/practice.journal.edit.html",
controller:"PracticeJournalEditController",controllerAs:"PracticeJournalEditController",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],isCreate:function(){return!0}},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_PRAKTIKAPAEVIK]}}).when("/practiceJournals/:id/edit",{templateUrl:"practiceJournal/practice.journal.edit.html",controller:"PracticeJournalEditController",controllerAs:"PracticeJournalEditController",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],entity:["QueryUtils","$route",function(a,b){return a.endpoint("/practiceJournals").get({id:b.current.params.id}).$promise}]},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_PRAKTIKAPAEVIK]}}).when("/practiceJournals/:id/view",{templateUrl:"practiceJournal/practice.journal.view.html",controller:"PracticeJournalEntryController",controllerAs:"PracticeJournalViewController",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],entity:["QueryUtils","$route",function(a,b){return a.endpoint("/practiceJournals").get({id:b.current.params.id}).$promise}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_PRAKTIKAPAEVIK]}}).when("/practiceJournals/:id/entries/edit",{templateUrl:"practiceJournal/practice.journal.entry.html",controller:"PracticeJournalEntryController",controllerAs:"PracticeJournalEntryController",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],entity:["QueryUtils","$route",function(a,b){return a.endpoint("/practiceJournals").get({id:b.current.params.id}).$promise}],isEntryEdit:function(){return!0}},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_PRAKTIKAPAEVIK]}}).when("/practiceJournals/supervisor/:uuid",{templateUrl:"practiceJournal/practice.journal.supervisor.entry.html",controller:"PracticeJournalSupervisorEntryController",controllerAs:"PracticeJournalSupervisorEntryController",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],entity:["QueryUtils","$route",function(a,b){return a.endpoint("/practiceJournals/supervisor").get({id:b.current.params.uuid}).$promise}]}}).when("/practiceJournals/student",{templateUrl:"practiceJournal/practice.journal.student.list.html",controller:"SimpleListController",controllerAs:"PracticeJournalStudentListController",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],url:function(){return"/practiceJournals"}},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_PRAKTIKAPAEVIK]}})}]),function(){function a(a,b,c,d){c.showDialog(a.isThemePageable?"poll/poll.response.by.theme.dialog.html":"KYSITLUS_O"===b.type?"poll/poll.response.by.subjectOrJournal.dialog.html":"poll/poll.response.dialog.html",function(c){c.formState={},c.formState.viewOnly=!0,c.formState.isThemePageable=a.isThemePageable,c.formState.name=a.name;var e=b.themes.filter(function(a){return null!==a.journal||null!==a.subject});c.hasSubjectOrJournal=0!==e.length,c.criteria=b,c.getUrl=function(a){return d.getUrl(a,"pollThemeQuestionFile")},a.isThemePageable||"KYSITLUS_O"!==b.type?c.criteria.themes[0].show=!0:(c.formState.themeBySubjectOrJournalId={},c.criteria.themes.forEach(function(a){null!==a.journal&&a.isRepetitive?(void 0===c.formState.themeBySubjectOrJournalId[a.journal.id]&&(c.formState.themeBySubjectOrJournalId[a.journal.id]=[]),c.formState.themeBySubjectOrJournalId[a.journal.id].push(a)):null!==a.subject&&a.isRepetitive?(void 0===c.formState.themeBySubjectOrJournalId[a.subject.id]&&(c.formState.themeBySubjectOrJournalId[a.subject.id]=[]),c.formState.themeBySubjectOrJournalId[a.subject.id].push(a)):a.isRepetitive||(void 0===c.formState.themeBySubjectOrJournalId[null]&&(c.formState.themeBySubjectOrJournalId[null]=[]),c.formState.themeBySubjectOrJournalId[null].push(a))}),Object.values(c.formState.themeBySubjectOrJournalId)[0].show=!0),c.previousSubjectOrJournal=function(a){Object.values(c.formState.themeBySubjectOrJournalId)[a].show=!1,Object.values(c.formState.themeBySubjectOrJournalId)[a-1].show=!0},c.last=function(a){return a===Object.values(c.formState.themeBySubjectOrJournalId).length-1},c.first=function(a){return 0===a},c.firstPage=function(a){return Object.values(c.formState.themeBySubjectOrJournalId)[0]===a},c.nextSubjectOrJournal=function(a){Object.values(c.formState.themeBySubjectOrJournalId)[a].show=!1,Object.values(c.formState.themeBySubjectOrJournalId)[a+1].show=!0},c.previousTheme=function(a){c.criteria.themes[a].show=!1,c.criteria.themes[a-1].show=!0},c.nextTheme=function(a){c.criteria.themes[a].show=!1,c.criteria.themes[a+1].show=!0},c.close=function(){c.cancel()}},null,null,!0)}function b(a,b){var d=window.innerWidth/4,e=5,f=d/e;return c(b.currentLanguageNameField(a),f)}function c(a,b){for(var c=Math.ceil(a.length/b),d=[],e=0,f=0;c>e;++e,f+=b)d.push(a.substr(f,b));return d}function d(a){for(var b=0;b<a.length;b++)for(var c=0;c<a[b].questions.length;c++){var d=a[b].questions[c].files.filter(function(a){return-1!==a.ftype.indexOf("image")});a[b].questions[c].pictures=d}}function e(a,b){null===b.journal||a.includes(b.journal.nameEt+": "+b.nameEt)?null===b.subject||a.includes(b.subject.nameEt+": "+b.nameEt)?a.includes(b.nameEt)||a.push(b.nameEt):a.push(b.subject.nameEt+": "+b.nameEt):a.push(b.journal.nameEt+": "+b.nameEt)}function f(a,b,c,e,f){a.showDialog(b.isThemePageable?"poll/poll.test.by.theme.dialog.html":"KYSITLUS_O"===b.type||void 0!==f&&"KYSITLUS_O"===f.type?"poll/poll.test.by.subjectOrJournal.dialog.html":"poll/poll.test.dialog.html",function(a){function f(a,b,c,d){return b.forEach(function(b){void 0===a[b.id]&&(a[b.id]=[],d?a[b.id].journal=b:a[b.id].subject=b),a[b.id].push.apply(a[b.id],angular.copy(c))}),a}a.formState={},a.criteria={},a.criteria.id=b.id,a.criteria.foreword=b.foreword,a.criteria.afterword=b.afterword,a.previousSubjectOrJournal=function(b){Object.values(a.formState.themeBySubjectOrJournalId)[b].show=!1,Object.values(a.formState.themeBySubjectOrJournalId)[b-1].show=!0},a.last=function(b){return b===Object.values(a.formState.themeBySubjectOrJournalId).length-1},a.first=function(a){return 0===a},a.firstPage=function(b){return Object.values(a.formState.themeBySubjectOrJournalId)[0]===b},a.nextSubjectOrJournal=function(b){Object.values(a.formState.themeBySubjectOrJournalId)[b].show=!1,Object.values(a.formState.themeBySubjectOrJournalId)[b+1].show=!0},a.refresh=function(){c.loadingWheel(a,!0,!0),c.endpoint("/poll/themes").get({id:a.criteria.id}).$promise.then(function(e){angular.extend(a.criteria,e),b.higher?(a.criteria.subjects=[{id:-1,nameEt:"õppaine kood - Õppeaine nimetus (X EAP)",nameEn:"subject code - subject name (X EAP)"}],a.criteria.journals=[]):(a.criteria.subjects=[],a.criteria.journals=[{id:-1,nameEt:"päevik (õpperühm)",nameEn:"journal (student group)"}]),d(a.criteria.themes),c.loadingWheel(a,!1,!0);var g=a.criteria.themes.filter(function(a){return a.isRepetitive});if(a.hasSubjectOrJournal=null!==a.criteria.subjects&&0!==a.criteria.subjects.length||null!==a.criteria.journals&&0!==a.criteria.journals.length,a.formState.themeBySubjectOrJournalId={},e.isThemePageable||"KYSITLUS_O"!==e.type)if(e.isThemePageable&&"KYSITLUS_O"===e.type){var h=[];a.criteria.journals.forEach(function(a){g.forEach(function(b){b.journal=angular.copy(a)}),h.push.apply(h,angular.copy(g))}),g.forEach(function(a){a.journal=null}),null!==a.criteria.subjects&&a.criteria.subjects.forEach(function(a){g.forEach(function(b){b.subject=angular.copy(a)}),h.push.apply(h,angular.copy(g))}),h.push.apply(h,a.criteria.themes.filter(function(a){return!a.isRepetitive})),a.criteria.themes=h,0!==a.criteria.themes.length&&(a.criteria.themes[0].show=!0)}else 0!==a.criteria.themes.length&&(a.criteria.themes[0].show=!0);else angular.isDefined(a.criteria.journals)&&0!==a.criteria.journals.length&&(a.formState.themeBySubjectOrJournalId=f(a.formState.themeBySubjectOrJournalId,a.criteria.journals,g,!0)),angular.isDefined(a.criteria.subjects)&&0!==a.criteria.subjects.length&&(a.formState.themeBySubjectOrJournalId=f(a.formState.themeBySubjectOrJournalId,a.criteria.subjects,g,!1)),a.criteria.themes.forEach(function(b){b.isRepetitive||(void 0===a.formState.themeBySubjectOrJournalId[null]&&(a.formState.themeBySubjectOrJournalId[null]=[]),a.formState.themeBySubjectOrJournalId[null].push(b))}),Object.values(a.formState.themeBySubjectOrJournalId)[0].show=!0})},a.previousTheme=function(b){a.criteria.themes[b].show=!1,a.criteria.themes[b-1].show=!0},a.nextTheme=function(b){a.criteria.themes[b].show=!1,a.criteria.themes[b+1].show=!0},a.clearRadio=function(a){a.radio1=null},a.refresh(),a.getUrl=function(a){return e.getUrl(a,"pollThemeQuestionFile")}},null,null,!0)}function g(a){var b=!1,c=[];return a.forEach(function(a){a.questions.forEach(function(d){if("VASTUS_M"!==d.type&&"VASTUS_S"!==d.type||!d.isRequired)"VASTUS_R"!==d.type&&"VASTUS_T"!==d.type&&"VASTUS_V"!==d.type||!d.isRequired||void 0!==d.answerTxt&&null!==d.answerTxt?d.requiredError=!1:(d.requiredError=!0,b=!0,e(c,a));else{var f=!0;d.answers.forEach(function(a){a.chosen===!0&&(f=!1)}),f?(d.requiredError=!0,b=!0,e(c,a)):d.requiredError=!1}})}),[b,c]}var h=function(a){function b(a){return a.lines}var c=document.getElementById("chartjs-tooltip");if(c||(c=document.createElement("div"),c.id="chartjs-tooltip",c.innerHTML='<table style="table-layout: fixed"></table>',this._chart.canvas.parentNode.appendChild(c)),0===a.opacity)return void(c.style.opacity=0);if(c.classList.remove("above","below","no-transform"),a.yAlign?c.classList.add(a.yAlign):c.classList.add("no-transform"),a.body){var d=a.title||[],e=a.body.map(b),f="<thead>";d.forEach(function(a){f+='<tr><th style="width: 100%; word-break: break-all">'+a+"</th></tr>"}),f+="</thead><tbody>",a.beforeBody.forEach(function(a){f+='<tr><td style="width: 100%; word-break: break-all">'+a+"</td></tr>"}),e.forEach(function(b,c){var d=a.labelColors[c],e="background:"+d.backgroundColor.replace(.2,1);e+="; border-color:"+d.borderColor.replace(.2,1),e+="; border-width: 2px;";var g='<span class="chartjs-tooltip-key" style="'+e+'"></span>';f+="<tr><td>"+g+b+"</td></tr>"}),f+="</tbody>";var g=c.querySelector("table");g.innerHTML=f}var h=this._chart.canvas.offsetTop,i=this._chart.canvas.offsetLeft,j=c.offsetParent.offsetHeight;c.style.opacity=1,c.style.left=i+100+"px",h+a.caretY+c.offsetHeight>j?h=j-c.offsetHeight-10:h+=a.caretY,c.style.top=h+"px",c.style.fontFamily=a._bodyFontFamily,c.style.fontSize=a.bodyFontSize+"px",c.style.fontStyle=a._bodyFontStyle,c.style.padding=a.yPadding+"px "+a.xPadding+"px"},i={callbacks:{beforeBody:function(a,b){return b.datasets[0].pointBorderColor[a[0].index]}},enabled:!1,mode:"index",position:"nearest",custom:h};angular.module("hitsaOis").controller("PollListController",["$scope","$route","QueryUtils","Classifier","$q","message",function(a,b,c,d,e,f){a.auth=b.current.locals.auth;var g=d.valuemapper({typeCode:"KYSITLUS",status:"KYSITLUS_STAATUS",targetCodes:"KYSITLUS_SIHT"});a.testEmail=function(){c.endpoint("/poll/testEmailService").put({},function(){f.info("email saadetud")})},c.createQueryForm(a,"/poll",{order:"p.validFrom desc, p.inserted desc"},g.objectmapper),e.all(g.promises).then(a.loadData)}]).controller("PollQuestionEditController",["$scope","$route","QueryUtils","Classifier","$q","dialogService","oisFileService","message","FormUtils",function(a,b,c,d,e,g,h,i,j){a.auth=b.current.locals.auth,a.questionId=b.current.params.id,a.formState={};var k=d.valuemapper({typeCode:"KYSITLUS",status:"KYSITLUS_STAATUS",targetCodes:"KYSITLUS_SIHT",type:"VASTUS"});a.saveQuestion=function(){j.withValidForm(a.searchForm,function(){var b=c.endpoint("/poll/updateQuestion");a.formState.question.type=void 0,b=new b(a.formState.question),b.$update().then(function(b){i.info("main.messages.create.success"),k.objectmapper(b),a.formState.question=b,a.searchForm.$setPristine()})["catch"](angular.noop)})},a.checkAnswer=function(){for(var b=[],c=0;c<a.formState.question.answers.length;c++)for(var d=a.searchForm[c],e=0;e<a.formState.question.answers.length;e++){var f=a.searchForm[e];if(c!==e){var g=a.formState.question.answers[c],h=a.formState.question.answers[e],i=void 0!==g.nameEt&&void 0!==h.nameEt&&g.nameEt===h.nameEt;i&&(b.includes(d)||b.push(d),b.includes(f)||b.push(f)),void 0===d||b.includes(d)||i||(d.$setValidity("answerEtError",!0),d.$setTouched()),void 0===f||b.includes(f)||i||(f.$setValidity("answerEtError",!0),f.$setTouched())}}b.forEach(function(a){void 0!==a&&(a.$setValidity("answerEtError",!1),a.$setTouched())})},a.test=function(a){f(g,a,c,h,{type:a.typeCode.code})},a.refresh=function(){var b=c.endpoint("/poll/question");c.createQueryForm(a,"/poll/questionPolls/"+a.questionId,{order:"p.validThru desc"},k.objectmapper),e.all(k.promises).then(function(){a.loadData(),b.get({id:a.questionId}).$promise.then(function(b){k.objectmapper(b),a.formState.question=b,a.searchForm.$setPristine()})})},a.refresh()}]).controller("PollQuestionsListController",["$scope","$route","QueryUtils","Classifier","$q",function(a,b,c,d,e){a.auth=b.current.locals.auth;var f=d.valuemapper({type:"VASTUS"});c.createQueryForm(a,"/poll/questionsList",{},f.objectmapper),e.all(f.promises).then(a.loadData)}]).controller("PollSubjectsController",["$scope","$route","QueryUtils","Classifier","$q","dialogService","oisFileService","$translate",function(c,e,f,g,h,j,k,l){function m(a,d){f.loadingWheel(c,!0),a.$putWithoutLoad().then(function(a){f.loadingWheel(c,!1),j.showDialog("poll/poll.answers.dialog.html",function(e){e.graphName=d.graphName,e.journal=d.journal,e.teacherViewing=d.teacherViewing,e.pollId=d.pollId,e.formState={},e.showGraph=!0,e.criteria={},e.graph=a,void 0!=a.comments&&1===a.comments.length&&e.teacherViewing&&(e.criteria.addInfo=a.comments[0].addInfo,e.commentRef=a.comments[0].commentRef),l("poll.answers.dialog.responseCount").then(function(a){e.graph.graphByTheme.forEach(function(d){var e={xAxes:[{ticks:{beginAtZero:!0,max:d.max}}],yAxes:[{ticks:{display:!1}}]},f=[];d.labels.forEach(function(a){f.push(c.currentLanguageNameField(a))});var g=[];d.labelOverride.forEach(function(b){var d="";b.pointBorderColor.forEach(function(a){d+=c.currentLanguageNameField(a.answer)+"("+a.answerNr+"): "+a.answers+"\n"}),d+=a+": "+b.sum,g.push(d)}),d.labelOverride.forEach(function(a){a.pointBorderColor=g}),d.labels=f,d.options.title.text=b(d.options.title.text,c),d.options.scales=e,d.options.tooltips=i})}),l("poll.answers.dialog.average").then(function(a){e.graph.graphByTheme.forEach(function(b){b.labelOverride[0].label=a})}),l("poll.answers.dialog.myAnswer").then(function(a){e.graph.graphByTheme.forEach(function(b){b.labelOverride[1]={label:a}})}),e.saveComment=function(a){var b=f.endpoint("/poll/comment/"+e.pollId);e.journal?(b=new b({journalId:e.graphName.id,comment:a,commentRef:e.commentRef}),b.$putWithoutLoad()):(b=new b({subjectId:e.graphName.id,comment:a,commentRef:e.commentRef}),b.$putWithoutLoad())}},null,null)})}c.auth=e.current.locals.auth,c.now=new Date,c.canViewResult=function(a){return c.now>=new Date(a)};var n=g.valuemapper({type:"KYSITLUS",status:"KYSITVASTUSSTAATUS"});c.showJournalGraph=function(a){var b={};b.graphName=a.name,b.journal=!0,b.teacherViewing=!0,b.pollId=a.poll.id;var c=f.endpoint("/poll/graphWithoutStudentAnswer");c=new c({pollId:a.poll.id,journalId:a.name.id}),m(c,b)},c.showSubjectGraph=function(a){var b={};b.graphName=a.name,b.journal=!1,b.teacherViewing=!0,b.pollId=a.poll.id;var c=f.endpoint("/poll/graphWithoutStudentAnswer");c=new c({pollId:a.poll.id,subjectId:a.name.id}),m(c,b)},c.openAnswers=function(a){c.auth.higher?c.showSubjectGraph(a):c.showJournalGraph(a)},f.createQueryForm(c,"/poll/answers/subjects",{order:"p.validThru desc"},n.objectmapper),h.all(n.promises).then(c.loadData),c.openResponse=function(b){var e;e="KYSITLUS_O"===b.type.code?f.endpoint("/poll/withAnswersForView/journalOrSubject"):f.endpoint("/poll/withAnswersForView"),f.loadingWheel(c,!0,!0),e.get({id:b.id}).$promise.then(function(e){d(e.themes),f.loadingWheel(c,!1,!0),a(b,e,j,k)})}}]).controller("PollAnswersController",["$scope","$route","QueryUtils","Classifier","$q","dialogService","oisFileService","$translate","message","$window",function(c,e,f,g,h,j,k,l,m,n){function o(a,d,e){e.loadingWheel(c,!0),e.endpoint("/poll/answers").get({id:a.id}).$promise.then(function(f){return e.loadingWheel(c,!1),0===f.journals.length&&0===f.subjects.length&&f.themes===!1?void m.info("poll.answers.dialog.allTextFields"):void d.showDialog("poll/poll.answers.dialog.html",function(d){function g(a,d){l("poll.answers.dialog.responseCount").then(function(a){d.responseCount=a}),a.$putWithoutLoad().then(function(a){d.graph=a,void 0!=a.comments&&(d.comments=a.comments),d.showGraph=!0,d.graph.graphByTheme.forEach(function(a){var e={xAxes:[{ticks:{beginAtZero:!0,max:a.max}}],yAxes:[{ticks:{display:!1}}]},f=[];a.labels.forEach(function(a){f.push(c.currentLanguageNameField(a))});var g=[];a.labelOverride.forEach(function(a){var b="";a.pointBorderColor.forEach(function(a){b+=c.currentLanguageNameField(a.answer)+"("+a.answerNr+"): "+a.answers+"\n"}),b+=d.responseCount+": "+a.sum,g.push(b)}),a.labelOverride.forEach(function(a){a.pointBorderColor=g}),a.labels=f,a.options.title.text=b(a.options.title.text,c),a.options.scales=e,a.options.tooltips=i}),l("poll.answers.dialog.average").then(function(a){d.graph.graphByTheme.forEach(function(b){b.labelOverride[0].label=a})}),l("poll.answers.dialog.myAnswer").then(function(a){d.graph.graphByTheme.forEach(function(b){b.labelOverride[1]={label:a}})})})}d.formState={},d.formState=a,d.criteria=f,d.showOtherGraph=function(){d.overall=!0;var a=e.endpoint("/poll/graph");a=new a({responseId:d.formState.id,themes:!0}),g(a,d)},d.showJournalGraph=function(a){d.graphName=a,d.journal=!0;var b=e.endpoint("/poll/graph");b=new b({responseId:d.formState.id,journalId:a.id}),g(b,d)},d.showSubjectGraph=function(a){d.graphName=a,d.journal=!1;var b=e.endpoint("/poll/graph");b=new b({responseId:d.formState.id,subjectId:a.id}),g(b,d)},d.hideGraph=function(){d.overall=!1,d.showGraph=!1}},null,null)})}c.auth=e.current.locals.auth,c.isInThePast=function(a){var b=new Date(a),c=new Date;return b.setHours(0,0,0,0),c.setHours(0,0,0,0),c>b?!0:!1};var p=g.valuemapper({type:"KYSITLUS",status:"KYSITVASTUSSTAATUS"});f.createQueryForm(c,"/poll/answers",{order:"p.validThru desc"},p.objectmapper),h.all(p.promises).then(c.loadData),c.openAnswers=function(a){o(a,j,f)},c.openResponse=function(b){var e;e="KYSITLUS_O"===b.type.code?f.endpoint("/poll/withAnswersForView/journalOrSubject"):f.endpoint("/poll/withAnswersForView"),f.loadingWheel(c,!0,!0),e.get({id:b.id}).$promise.then(function(e){d(e.themes),f.loadingWheel(c,!1,!0),a(b,e,j,k)})}}]).controller("PollQuestionsController",["$scope","$route","QueryUtils","dialogService","message","FormUtils","ArrayUtils","oisFileService","$rootScope",function(a,b,c,e,g,h,i,j,k){a.auth=b.current.locals.auth,a.currentNavItem="poll.questions",a.formState={},a.criteria={},b.current.params.id&&(a.criteria.id=b.current.params.id,"poll/poll.questions.edit.html"===b.current.templateUrl&&(a.formState.edit=!0)),a.saveThemePageable=function(){var b=c.endpoint("/poll/themes/pageable/"+a.criteria.id),d=new b({isThemePageable:a.criteria.isThemePageable});d.$update().then(function(){g.info("main.messages.create.success"),a.refresh()})["catch"](angular.noop)},a.saveThemeRepetitive=function(b){var d=c.endpoint("/poll/themes/repetitive/"+b.id),e=new d({isRepetitive:b.isRepetitive});e.$update().then(function(){g.info("main.messages.create.success"),a.refresh()})["catch"](angular.noop)},a.refresh=function(){c.loadingWheel(a,!0,!0),c.endpoint("/poll/themes").get({id:a.criteria.id}).$promise.then(function(b){b.confirmed&&a.formState.edit?(g.error("main.messages.error.nopermission"),k.back("#/poll/questions/"+a.criteria.id+"/view")):(a.formState.type=b.type,b.type=void 0,angular.extend(a.criteria,b),d(a.criteria.themes)),c.loadingWheel(a,!1,!0)})},a.refresh(),a.addNewTheme=function(b){e.showDialog("poll/poll.theme.add.dialog.html",function(c){c.criteria={},b&&(c.criteria.nameEt=angular.copy(b.nameEt)),c.checkTheme=function(){var d=c.dialogForm.nameEt,e=a.criteria.themes;if(void 0!==e&&void 0===b){var f=e.filter(function(a){return a.nameEt===c.criteria.nameEt});void 0===f||f.length>0?d.$setValidity("nameEtError",!1):d.$setValidity("nameEtError",!0)}}},function(d){h.withValidForm(d.dialogForm,function(){var e=c.endpoint("/poll/theme/"+a.criteria.id);b&&(e=c.endpoint("/poll/theme/"+b.id)),void 0===a.criteria.themes?d.criteria.orderNr=1:d.criteria.orderNr=a.criteria.themes.length+1;var f=new e(d.criteria);b?f.$update().then(function(){g.info("main.messages.create.success"),a.refresh()})["catch"](angular.noop):f.$save().then(function(){g.info("main.messages.create.success"),a.refresh()})["catch"](angular.noop)})})},a.clearRadio=function(a){a.radio=null},a.deselect=function(a,b){a.forEach(function(a){a.id!==b.id&&(a.checked=!1)})},a.addQuestion=function(b,d){e.showDialog("poll/poll.question.add.dialog.html",function(f){f.criteria={},f.themes=a.criteria.themes,f.data={},f.data.files=[],b&&(f.criteria.theme=angular.copy(b.id)),void 0===f.criteria.files&&(f.criteria.files=[]),d?angular.extend(f.criteria,angular.copy(d)):(f.criteria.isRequired=!0,f.criteria.isInRow=!0,f["new"]=!0),c.endpoint("/poll/questions").query(function(b){f.questions=b.filter(function(b){var c=!0;return a.criteria.themes.forEach(function(a){a.questions.forEach(function(a){a.question===b.id&&(c=a.id===f.criteria.id?!0:!1)})}),c})}),f.getUrl=j.getUrl,f.loadQuestion=function(a){if(void 0!==a&&""!==a){var b=c.endpoint("/poll/question");b.get({id:a},function(a){a.theme=f.criteria.theme,a.question=f.criteria.question,a.isRequired=f.criteria.isRequired,a.isInRow=f.criteria.isInRow,a.files=f.criteria.files,a.orderNr=f.criteria.orderNr,a.id=f.criteria.id,void 0!==f.criteria.isInRow?a.isInRow=f.criteria.isInRow:a.isInRow=!0,f.criteria=a,f["new"]=!0,f.checkAnswer()})}else""===a&&(f.criteria.disabled=!1)},f.$watch("criteria.nameEt",function(){f.checkName(f.criteria.theme)}),f.checkName=function(b){var c=f.dialogForm.nameEt,d=a.criteria.themes.filter(function(a){return a.id===b});if(void 0!==d&&1===d.length){var e=d[0],g=e.questions.filter(function(a){return a.nameEt===f.criteria.nameEt&&a.id!==f.criteria.id});void 0===g||g.length>0?(c.$setValidity("nameEtError",!1),void 0!==f.criteria.nameEt&&c.$setTouched()):c.$setValidity("nameEtError",!0)}},f.checkAnswer=function(){for(var a=[],b=0;b<f.criteria.answers.length;b++)for(var c=f.dialogForm[b],d=0;d<f.criteria.answers.length;d++){var e=f.dialogForm[d];if(b!==d){var g=f.criteria.answers[b],h=f.criteria.answers[d],i=void 0!==g.nameEt&&void 0!==h.nameEt&&g.nameEt===h.nameEt;i&&(a.includes(c)||a.push(c),a.includes(e)||a.push(e)),void 0===c||a.includes(c)||i||(c.$setValidity("answerEtError",!0),c.$setTouched()),void 0===e||a.includes(e)||i||(e.$setValidity("answerEtError",!0),e.$setTouched())}}a.forEach(function(a){void 0!==a&&(a.$setValidity("answerEtError",!1),a.$setTouched())})},f.getFileUrl=function(a){return j.getFileUrl(a)},f.openAddFileDialog=function(){e.showDialog("components/file.add.dialog.html",function(a){a.addedFiles=f.criteria.files},function(a){var b=a.data;j.getFromLfFile(b.file[0],function(a){b=a,f.criteria.files.push(b)})},null,!0)},f.addAnswer=function(){var a={};void 0===f.criteria.answers&&(f.criteria.answers=[]),f.criteria.answers.push(a)},f.deleteFile=function(a){e.confirmDialog({prompt:"apel.deleteFileConfirm"},function(){i.remove(f.criteria.files,a)})},f.swapCriteria=function(a,b){var c=f.criteria.answers[a];f.criteria.answers[a]=f.criteria.answers[b],f.criteria.answers[b]=c,c=f.criteria.answers[a].orderNr,f.criteria.answers[a].orderNr=f.criteria.answers[b].orderNr,f.criteria.answers[b].orderNr=c,f.checkAnswer()},f.deleteAnswer=function(a){i.remove(f.criteria.answers,a),f.checkAnswer()},f["delete"]=function(){a.deleteQuestion(f.criteria.id)},f.checkAnswers=function(){return!f.criteria.isRequired||"VASTUS_T"===f.criteria.type||void 0!==f.criteria.answers&&0!==f.criteria.answers.length?!0:(g.error("poll.questions.noAnswersError"),!1)}},function(b){h.withValidForm(b.dialogForm,function(){var e=c.endpoint("/poll/question");if(d){b.criteria.disabled||b["new"]&&b.criteria.question||(b.criteria.question=void 0);var f=new e(b.criteria);f.$update().then(function(){a.refresh()})["catch"](angular.noop)}else{var g=a.criteria.themes.filter(function(a){return a.id===b.criteria.theme})[0];g?b.criteria.orderNr=g.questions.length+1:b.criteria.orderNr=1,e=c.endpoint("/poll/question/"+b.criteria.theme);var h=new e(b.criteria);h.$save().then(function(){a.refresh()})["catch"](angular.noop)}})},null,!0)},a.getUrl=function(a){return j.getUrl(a,"pollThemeQuestionFile")},a.deleteTheme=function(b){return a.criteria.confirmed&&1===a.criteria.themes.length?void g.info("poll.questions.confirmedError"):void e.confirmDialog({prompt:"poll.questions.deleteTheme"},function(){var d=c.endpoint("/poll/theme/"+b),e=new d;e.$delete().then(function(){g.info("main.messages.delete.success"),a.refresh()})["catch"](angular.noop)})},a.deleteQuestion=function(b){e.confirmDialog({prompt:"poll.questions.deleteQuestion"},function(){var d=c.endpoint("/poll/question/"+b),e=new d;e.$delete().then(function(){g.info("main.messages.delete.success"),a.refresh()})["catch"](angular.noop)})},a.test=function(){a.criteria.higher=a.auth.higher,f(e,a.criteria,c,j,a.formState)},a.swapTheme=function(b,d){var e=a.criteria.themes[b];a.criteria.themes[b]=a.criteria.themes[d],a.criteria.themes[d]=e,e=a.criteria.themes[b].orderNr,a.criteria.themes[b].orderNr=a.criteria.themes[d].orderNr,a.criteria.themes[d].orderNr=e;var f=c.endpoint("/poll/themes"),h=new f(a.criteria);a.criteria.id&&h.$update().then(function(){g.info("main.messages.create.success")})["catch"](angular.noop)},a.swapQuestion=function(a,b,d){var e=a.questions[b];a.questions[b]=a.questions[d],a.questions[d]=e,e=a.questions[b].orderNr,a.questions[b].orderNr=a.questions[d].orderNr,a.questions[d].orderNr=e;var f=c.endpoint("/poll/questions"),h=new f(a);h.$update().then(function(){g.info("main.messages.create.success")})["catch"](angular.noop)}}]).controller("PollResultsController",["$scope","$route","QueryUtils","$translate","dialogService","$q","Classifier","$window","$rootScope",function(a,c,d,e,f,g,h,j,k){function l(c,g){d.loadingWheel(a,!0),c.$putWithoutLoad().then(function(c){d.loadingWheel(a,!1),f.showDialog("poll/poll.answers.dialog.html",function(f){f.graphName=g.graphName,f.journal=g.journal,f.adminViewing=g.adminViewing,f.pollId=g.pollId,f.enterprise=g.enterprise,f.student=g.student,f.teacher=g.teacher,f.poll=g.poll,f.formState={},f.showGraph=!0,f.criteria={},f.graph=c,void 0!=c.comments&&(f.comments=c.comments),e("poll.answers.dialog.responseCount").then(function(c){f.graph.graphByTheme.forEach(function(d){var e={xAxes:[{ticks:{beginAtZero:!0,max:d.max}}],yAxes:[{ticks:{display:!1}}]},f=[];d.labels.forEach(function(b){f.push(a.currentLanguageNameField(b))});var g=[];d.labelOverride.forEach(function(b){var d="";b.pointBorderColor.forEach(function(b){d+=a.currentLanguageNameField(b.answer)+"("+b.answerNr+"): "+b.answers+"\n"}),d+=c+": "+b.sum,g.push(d)}),d.labelOverride.forEach(function(a){a.pointBorderColor=g}),d.labels=f,d.options.title.text=b(d.options.title.text,a),d.options.scales=e,d.options.tooltips=i})}),e("poll.answers.dialog.average").then(function(a){f.graph.graphByTheme.forEach(function(b){b.labelOverride[0].label=a})}),e("poll.answers.dialog.myAnswer").then(function(a){f.graph.graphByTheme.forEach(function(b){b.labelOverride[1]={label:a}})}),f.saveComment=function(a){var b=d.endpoint("/poll/comment/"+f.pollId);f.journal?(b=new b({journalId:f.graphName.id,comment:a,commentRef:f.commentRef}),b.$putWithoutLoad()):(b=new b({subjectId:f.graphName.id,comment:a,commentRef:f.commentRef}),b.$putWithoutLoad())}})})}a.auth=c.current.locals.auth,a.currentNavItem="poll.results",a.formState={},a.criteria={},c.current.params.id&&(a.id=c.current.params.id),a.refresh=function(){d.loadingWheel(a,!0),d.endpoint("/poll/results").get({id:a.id}).$promise.then(function(b){if(a.formState=b,d.loadingWheel(a,!1),"KYSITLUS_O"===a.formState.type)d.createQueryForm(a,"/poll/results/subjects/"+a.id,{}),a.loadData();else if("KYSITLUS_P"===a.formState.type){d.createQueryForm(a,"/poll/results/enterprises/"+a.id,{}),a.loadData();var c=d.endpoint("/poll/results/enterprises/studentOrTeacher");c.get({id:a.id},function(b){a.hasStudentResponse=b.hasStudentResponse,a.hasTeacherResponse=b.hasTeacherResponse})}})},a.refresh(),a.showJournalGraph=function(b){var c={};c.graphName=b.name,c.journal=!0,c.adminViewing=!0,c.pollId=a.id;var e=d.endpoint("/poll/graphWithoutStudentAnswer");e=new e({pollId:c.pollId,journalId:b.name.id}),l(e,c)},a.enterpriseToExcel=function(b){var c={pollId:a.id,enterpriseId:b.id};j.location.href=k.excel("poll/results/exportSubject.xls",c)},a.studentToExcel=function(){var b={pollId:a.id,students:!0};j.location.href=k.excel("poll/results/exportSubject.xls",b)},a.teacherToExcel=function(){var b={pollId:a.id,teachers:!0};j.location.href=k.excel("poll/results/exportSubject.xls",b)},a.subjectToExcel=function(b){var c={pollId:a.id};a.auth.higher?c.subjectId=b.name.id:c.journalId=b.name.id,j.location.href=k.excel("poll/results/exportSubject.xls",c)},a.allToExcel=function(){j.location.href=k.excel("poll/results/exportSubject.xls",{pollId:a.id})},a.openAllAnswers=function(){var b={};b.adminViewing=!0,b.pollId=a.id,b.poll=a.formState.poll;var c=d.endpoint("/poll/graphWithoutStudentAnswer");c=new c({pollId:b.pollId}),l(c,b)},a.openEnterpriseAnswer=function(b){var c={};c.graphName=b,c.adminViewing=!0,c.enterprise=!0,c.pollId=a.id;var e=d.endpoint("/poll/graphWithoutStudentAnswer");e=new e({pollId:c.pollId,enterpriseId:b.id}),l(e,c)},a.openStudentAnswers=function(){var b={};b.adminViewing=!0,b.student=!0,b.pollId=a.id;var c=d.endpoint("/poll/graphWithoutStudentAnswer");c=new c({pollId:b.pollId,students:!0}),l(c,b)},a.openTeacherAnswers=function(){var b={};b.adminViewing=!0,b.teacher=!0,b.pollId=a.id;var c=d.endpoint("/poll/graphWithoutStudentAnswer");c=new c({pollId:b.pollId,teachers:!0}),l(c,b)},a.showSubjectGraph=function(b){var c={};c.graphName=b.name,c.journal=!1,c.adminViewing=!0,c.pollId=a.id;var e=d.endpoint("/poll/graphWithoutStudentAnswer");e=new e({pollId:c.pollId,subjectId:b.name.id}),l(e,c)},a.checkAnswer=function(b){f.showDialog("poll/poll.results.student.dialog.html",function(c){c.higher=a.auth.higher;var e=h.valuemapper({status:"KYSITVASTUSSTAATUS"});d.createQueryForm(c,"/poll/results/student",{},e.objectmapper),c.criteria.pollId=a.id,c.higher?(c.criteria.subjectId=b.name.id,c.criteria.subject=a.currentLanguageNameField(b.name),c.criteria.journalId=void 0):(c.criteria.journalId=b.name.id,c.criteria.journal=a.currentLanguageNameField(b.name),c.criteria.subjectId=void 0),c.search=function(){g.all(e.promises).then(c.loadData)}})},a.openAnswers=function(b){a.auth.higher?a.showSubjectGraph(b):a.showJournalGraph(b)}}]).controller("PollStatisticsController",["$scope","$route","QueryUtils","ArrayUtils","message","$rootScope","ExcelUtils",function(a,b,c,d,e,f,g){a.auth=b.current.locals.auth,a.criteria={},a.criteria.questions=[],a.criteria.polls=[],a.loadPolls=function(){a.polls=c.endpoint("/autocomplete/polls").query({type:a.criteria.typeCode}),a.criteria.questions=[],a.criteria.polls=[],a.criteria.poll=void 0,a.criteria.question=void 0};var h=function(){var b=a.criteria.polls.map(function(a){return a.id});0!==b.length?a.questions=c.endpoint("/autocomplete/polls/questions").query({polls:b}):a.questions=[],a.criteria.questions=[],a.criteria.question=void 0,a.criteria.allQuestions=!1};a.questionChanged=function(){angular.isDefined(a.criteria.question)&&null!==a.criteria.question&&a.addList(a.criteria.questions,a.criteria.question,"poll.statistics.duplicateQuestion");
},a.pollChanged=function(){angular.isDefined(a.criteria.poll)&&null!==a.criteria.poll&&a.addList(a.criteria.polls,a.criteria.poll,"poll.statistics.duplicatePoll",!0)},a.allToExcel=function(){var b={pollIds:a.criteria.polls.map(function(a){return a.id}),questions:a.criteria.questions.map(function(a){return a.id})};g.get(f.excel("poll/statistics/pollStatistics.xlsx",b),a,"pollStatistics.xlsx")},a.addList=function(a,b,c,d){return a.some(function(a){return void 0!==b&&null!==b&&a.id===b.id})?(b=void 0,void e.error(c)):(a.push(angular.copy(b)),d&&h(),void(b=void 0))},a.removeElement=function(a,b,c){d.remove(a,b),c&&h()},a.pickAllQuestions=function(b){b?a.criteria.questions=angular.copy(a.questions):a.criteria.questions=[]}}]).controller("PollEditController",["$scope","$route","QueryUtils","dialogService","message","FormUtils","Classifier","$location","oisFileService","$rootScope","$q","ArrayUtils",function(a,b,c,d,e,g,h,i,j,k,l,m){function n(){void 0!==a.formState.aimByCode&&("KYSITLUS_V"===a.criteria.type||"KYSITLUS_O"===a.criteria.type?a.formState.targetCodes=[angular.copy(a.formState.aimByCode.KYSITLUS_SIHT_O)]:"KYSITLUS_T"===a.criteria.type&&(a.formState.targetCodes=[angular.copy(a.formState.aimByCode.KYSITLUS_SIHT_T)]))}function o(){var b=a.formState.targetCodes.filter(function(a){return"KYSITLUS_SIHT_T"===a.code});b.length>0?(a.showOccupations=!0,(void 0===a.formState.occupations||0===a.formState.occupations.length)&&(a.formState.occupations=c.endpoint("/teachers/teacheroccupations").query())):(a.showOccupations=!1,a.criteria.teacherOccupations=[])}function p(){var b=a.formState.targetCodes.filter(function(a){return"KYSITLUS_SIHT_E"===a.code});b.length>0?a.showJournalDates=!0:a.showJournalDates=!1}function q(){var b=a.formState.targetCodes.filter(function(a){return"KYSITLUS_SIHT_V"===a.code});b.length>0?a.showExpertUrl=!0:a.showExpertUrl=!1}a.auth=b.current.locals.auth,a.currentNavItem="poll.data",a.formState={},a.criteria={},a.now=new Date,a.studentGroupAllowed=!1,a.showOccupations=!1,a.formState.names=c.endpoint("/poll/pollNames").query();var r=c.endpoint("/poll"),s=h.valuemapper({status:"KYSITLUS_STAATUS"});a.changeDisplayDates=function(){a.displayDates||(a.displayDates=!0)},a.saveDates=function(){g.withValidForm(a.pollForm,function(){var b=c.endpoint("/poll/changeDates/"+a.criteria.id),d=new b({validFrom:a.criteria.validFrom,validThru:a.criteria.validThru,reminderDt:a.criteria.reminderDt});d.$update().then(function(){e.info("main.messages.create.success"),a.displayDates=!1})})},a.$watch("formState.journal",function(){angular.isDefined(a.formState.journal)&&null!==a.formState.journal&&a.addJournal()}),a.addJournal=function(){return angular.isArray(a.criteria.journals)||(a.criteria.journals=[]),a.criteria.journals.some(function(b){return void 0!==a.formState.journal&&null!==a.formState.journal&&b.id===a.formState.journal.id})?(a.formState.journal=void 0,void e.error("poll.basicData.duplicateJournal")):(a.criteria.journals.push(angular.copy(a.formState.journal)),a.formState.journal=void 0,void a.pollForm.$setDirty())},a.removeJournal=function(b){m.remove(a.criteria.journals,b),a.pollForm.$setDirty()},a.checkNames=function(b){var c=a.formState.names.filter(function(c){return void 0!==a.criteria.id?a.criteria.id!==c.id&&b===c.nameEt:b===c.nameEt}),d=a.pollForm.nameEt;angular.isArray(c)&&c.length>0?d.$setValidity("incorrectName",!1):d.$setValidity("incorrectName",!0)},a.refresh=function(){r.get({id:a.criteria.id},function(b){"KYSITLUS_STAATUS_K"===b.status.code&&a.formState.edit&&(e.error("main.messages.error.nopermission"),k.back("#/poll/"+a.criteria.id+"/view")),a.formState.targetCodes=b.targetCodes,a.formState.studentGroups=b.studentGroups,a.formState.status=b.status,a.formState.insertedBy=b.insertedBy,a.formState.changedBy=b.changedBy,a.formState.isTeacherComment=b.isTeacherComment,a.formState.isTeacherCommentVisible=b.isTeacherCommentVisible,a.formState.responded=b.responded,b.status=void 0,b.insertedBy=void 0,b.changedBy=void 0,b.reminderDt=new Date(b.reminderDt),b.validFrom=new Date(b.validFrom),b.validThru=new Date(b.validThru),a.criteria=b,a.disabled=!0,a.checkCases(),a.pollForm.$setPristine(),l.all(s.promises).then(function(){s.objectmapper(a.formState)})})},b.current.params.id?(a.criteria.id=b.current.params.id,"poll/poll.edit.html"===b.current.templateUrl&&(a.formState.edit=!0),a.refresh()):(a.formState.isTeacherComment=!0,a.formState.isTeacherCommentVisible=!0),c.endpoint("/autocomplete/classifiers").query({mainClassCode:"KYSITLUS_SIHT"},function(b){a.formState.aim=b,a.formState.aimBackup=b,a.formState.aimByCode={},b.forEach(function(b){a.formState.aimByCode[b.code]=b}),a.checkCases()}),a.addAllTargetCodes=function(){a.formState.targetCodes=angular.copy(a.formState.aim.filter(a.targetCodeFilter)),a.checkCases(),a.pollForm.$setDirty()},a.test=function(){a.criteria.higher=a.auth.higher,f(d,a.criteria,c,j)},a.checkReminder=function(){var b=a.pollForm.reminderDt;void 0!==b&&(new Date(a.criteria.reminderDt)<new Date(a.criteria.validFrom)||new Date(a.criteria.reminderDt)>new Date(a.criteria.validThru)?b.$setValidity("incorrect",!1):b.$setValidity("incorrect",!0))},a.earlierDate=function(a,b){return void 0===a?b:void 0===b?a:new Date(a)<new Date(b)?a:b},a.laterDate=function(a,b){return void 0===a?b:void 0===b?a:new Date(a)<new Date(b)?b:a},a.targetCodeFilter=function(b){switch(a.criteria.type){case"KYSITLUS_P":return"KYSITLUS_SIHT_T"===b.code||"KYSITLUS_SIHT_O"===b.code||"KYSITLUS_SIHT_E"===b.code;default:return!0}},a.saveAndLoad=function(){if(a.criteria.id){var b=c.endpoint("/poll/copy/"+a.criteria.id),d=new b;d.$save().then(function(a){e.info("main.messages.create.success"),i.url("/poll/"+a.id+"/edit?_noback")})["catch"](angular.noop)}},a.checkCases=function(){if(n(),!angular.isArray(a.formState.targetCodes))return a.studentGroupAllowed=!1,a.showOccupations=!1,a.showJournalDates=!1,void(a.formState.studentGroups=[]);o(),p(),q();var b=a.formState.targetCodes.filter(function(a){return"KYSITLUS_SIHT_O"===a.code});if("KYSITLUS_P"===a.criteria.type&&b.length>0)return void(a.studentGroupAllowed=!0);var c=a.formState.targetCodes.filter(function(a){return"KYSITLUS_SIHT_O"===a.code||"KYSITLUS_SIHT_L"===a.code});return"KYSITLUS_Y"===a.criteria.type&&c.length>0?void(a.studentGroupAllowed=!0):(a.studentGroupAllowed=!1,void(a.formState.studentGroups=[]))},a.save=function(b){if((!angular.isArray(a.criteria.journals)||0===a.criteria.journals.length)&&"KYSITLUS_O"===a.criteria.type&&(!a.auth.higher||a.auth.higher&&a.auth.vocational&&(void 0===a.criteria.studyPeriod||null===a.criteria.studyPeriod)))return void e.error("poll.basicData.atleastOneJournal");if(!angular.isArray(a.formState.targetCodes)&&"KYSITLUS_O"!==a.criteria.type&&"KYSITLUS_T"!==a.criteria.type&&"KYSITLUS_V"!==a.criteria.type)return void e.error("poll.basicData.atleastOne");if(a.criteria.targetCodes=a.formState.targetCodes.map(function(a){return a.code}),0===a.criteria.targetCodes.length&&"KYSITLUS_O"!==a.criteria.type&&"KYSITLUS_T"!==a.criteria.type&&"KYSITLUS_V"!==a.criteria.type)return void e.error("poll.basicData.atleastOne");angular.isArray(a.formState.studentGroups)&&(a.criteria.studentGroups=a.formState.studentGroups.map(function(a){return a.id})),b&&(a.criteria.status="KYSITLUS_STAATUS_K");var c=new r(a.criteria);g.withValidForm(a.pollForm,function(){a.criteria.id?c.$update().then(function(c){e.info("main.messages.create.success"),b?i.url("/poll/"+c.id+"/view?_noback"):a.refresh()})["catch"](angular.noop):c.$save().then(function(a){e.info("main.messages.create.success"),i.url("/poll/"+a.id+"/edit?_noback")})["catch"](angular.noop)})},a.deletePoll=function(){d.confirmDialog({prompt:"poll.basicData.deleteConfirm"},function(){var b=c.endpoint("/poll/"+a.criteria.id),d=new b;d.$delete().then(function(){e.info("main.messages.delete.success"),i.url("/poll?_menu")})["catch"](angular.noop)})},a.addTargetCode=function(){if(""!==a.formState.targetCode){if(angular.isArray(a.formState.targetCodes)||(a.formState.targetCodes=[]),a.formState.targetCodes.some(function(b){return b.code===a.formState.targetCode}))return a.formState.targetCode="",void e.error("poll.basicData.duplicateTargetCode");a.formState.targetCodes.push(a.formState.aimByCode[a.formState.targetCode]),a.formState.targetCode="",a.checkCases()}},a.deleteTargetCode=function(b){var c=a.formState.targetCodes.indexOf(b);-1!==c&&(a.formState.targetCodes.splice(c,1),a.pollForm.$setDirty()),a.checkCases()},a.removeAllTargetCodes=function(){a.formState.targetCodes=[],a.checkCases(),a.pollForm.$setDirty()},a.addAllStudentgroups=function(){c.endpoint("/autocomplete/studentgroups").query({valid:!0},function(b){a.formState.studentGroups=b,a.pollForm.$setDirty()})},a.$watch("formState.studentgroup",function(){angular.isDefined(a.formState.studentgroup)&&null!==a.formState.studentgroup&&a.addStudentGroup()}),a.removeConfirm=function(){0!==a.criteria.themes?d.confirmDialog({prompt:"poll.basicData.confirmRemoveConfirm"},function(){c.endpoint("/poll/unConfirm/"+a.criteria.id).put({},function(){e.info("poll.basicData.removed"),a.refresh()})}):e.error("poll.basicData.removeConfirmError")},a.confirm=function(){0!==a.criteria.themes?d.confirmDialog({prompt:a.criteria.themeEmpty?"poll.basicData.themeEmpty":"poll.basicData.confirm"},function(){a.save(!0)}):e.error("poll.basicData.confirmError")},a.addStudentGroup=function(){return angular.isArray(a.formState.studentGroups)||(a.formState.studentGroups=[]),a.formState.studentGroups.some(function(b){return void 0!==a.formState.studentgroup&&null!==a.formState.studentgroup&&b.id===a.formState.studentgroup.id})?(a.formState.studentgroup=void 0,void e.error("poll.basicData.duplicateTargetCode")):(a.formState.studentGroups.push(angular.copy(a.formState.studentgroup)),a.formState.studentgroup=void 0,void a.pollForm.$setDirty())},a.removeAllStudentgroups=function(){a.formState.studentGroups=[],a.pollForm.$setDirty()},a.deleteStudentgroup=function(b){var c=a.formState.studentGroups.indexOf(b);-1!==c&&(a.formState.studentGroups.splice(c,1),a.pollForm.$setDirty())},a.emptyLists=function(){return a.formState.studentGroups=[],a.formState.targetCodes=[],a.formState.targetCode="",a.pollForm.$setDirty(),!0}}]).controller("PollSupervisorController",["$scope","$route","oisFileService","FormUtils","$location","message","QueryUtils","dialogService",function(a,b,c,e,f,h,i,j){a.formState={};var k;i.endpoint("/poll/supervisor").get({id:b.current.params.uuid}).$promise.then(function(b){a.criteria=b,a.criteria.themes[0].show=!0,d(a.criteria.themes),k=i.endpoint("/poll/supervisor/"+a.criteria.responseId+"/saveAnswer")})["catch"](function(a){f.url("/")}),a.getUrl=function(a){return c.getUrl(a,"pollThemeQuestionFile")},a.confirm=function(){var b=g(a.criteria.themes),c=b[0];e.withValidForm(a.responseForm,function(){c?a.criteria.isThemePageable?h.error("poll.messages.required",{themes:b[1].join(", ")}):h.error("main.messages.form-has-errors"):j.confirmDialog({prompt:"poll.answer.confirm"},function(){var b=i.endpoint("/poll/supervisor/"+a.criteria.responseId+"/saveAnswer/final"),c=new b;c.$update().then(function(){j.messageDialog({prompt:"poll.answer.confirmed"},function(){f.url("/")})})})})},a.save=function(a){var b=new k(a);b.$putWithoutLoad()},a.clearRadio=function(b){b.answerTxt=null,a.save(b)},a.previousTheme=function(b){a.criteria.themes[b].show=!1,a.criteria.themes[b-1].show=!0},a.nextTheme=function(b){a.criteria.themes[b].show=!1,a.criteria.themes[b+1].show=!0}}]).controller("PollExpertController",["$scope","$route","oisFileService","FormUtils","$location","message","QueryUtils","dialogService",function(a,b,c,e,f,h,i,j){a.formState={};var k;i.endpoint("/poll/expert").get({id:b.current.params.uuid}).$promise.then(function(b){a.criteria=b,a.criteria.themes[0].show=!0,d(a.criteria.themes),k=i.endpoint("/poll/expert/"+b.responseId+"/saveAnswer")})["catch"](function(a){f.url("/")}),a.previousTheme=function(b){a.criteria.themes[b].show=!1,a.criteria.themes[b-1].show=!0},a.nextTheme=function(b){a.criteria.themes[b].show=!1,a.criteria.themes[b+1].show=!0},a.getUrl=function(a){return c.getUrl(a,"pollThemeQuestionFile")},a.confirm=function(){var b=g(a.criteria.themes),c=b[0];e.withValidForm(a.responseForm,function(){c?a.criteria.isThemePageable?h.error("poll.messages.required",{themes:b[1].join(", ")}):h.error("main.messages.form-has-errors"):j.confirmDialog({prompt:"poll.answer.confirm"},function(){var b=i.endpoint("/poll/expert/"+a.criteria.responseId+"/saveAnswer/final"),c=new b;c.$update().then(function(){j.messageDialog({prompt:"poll.answer.confirmed"},function(){f.url("/")})})})})},a.save=function(a){var b=new k(a);b.$putWithoutLoad()},a.clearRadio=function(b){b.answerTxt=null,a.save(b)}}])}(),angular.module("hitsaOis").config(["$routeProvider","USER_ROLES",function(a,b){a.when("/poll",{templateUrl:"poll/poll.list.html",controller:"PollListController",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_KYSITLUS]}}).when("/poll/answers",{templateUrl:"poll/poll.answers.html",controller:"PollAnswersController",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]}}).when("/poll/answers/subjects",{templateUrl:"poll/poll.answers.subjects.html",controller:"PollSubjectsController",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]}}).when("/poll/statistics",{templateUrl:"poll/poll.statistics.html",controller:"PollStatisticsController",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_KYSITLUS]}}).when("/poll/new",{templateUrl:"poll/poll.edit.html",controller:"PollEditController",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_KYSITLUS]}}).when("/poll/new/:copiedId",{templateUrl:"poll/poll.edit.html",controller:"PollEditController",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_KYSITLUS]}}).when("/poll/:id/edit",{templateUrl:"poll/poll.edit.html",controller:"PollEditController",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_KYSITLUS]}}).when("/poll/questions",{templateUrl:"poll/poll.questions.list.html",controller:"PollQuestionsListController",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_KYSITLUS]}}).when("/poll/question/:id/view",{templateUrl:"poll/poll.question.view.html",controller:"PollQuestionEditController",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_KYSITLUS]}}).when("/poll/question/:id/edit",{templateUrl:"poll/poll.question.edit.html",controller:"PollQuestionEditController",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_KYSITLUS]}}).when("/poll/questions/:id/edit",{templateUrl:"poll/poll.questions.edit.html",controller:"PollQuestionsController",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_KYSITLUS]}}).when("/poll/questions/:id/view",{templateUrl:"poll/poll.questions.view.html",controller:"PollQuestionsController",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_KYSITLUS]}}).when("/poll/results/:id/view",{templateUrl:"poll/poll.results.view.html",controller:"PollResultsController",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_KYSITLUS]}}).when("/poll/results/:id/edit",{templateUrl:"poll/poll.results.edit.html",controller:"PollResultsController",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_KYSITLUS]}}).when("/poll/:id/view",{templateUrl:"poll/poll.view.html",controller:"PollEditController",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_KYSITLUS]}}).when("/poll/supervisor/:uuid",{templateUrl:"poll/poll.response.html",controller:"PollSupervisorController",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}]}}).when("/poll/expert/:uuid",{templateUrl:"poll/poll.response.html",controller:"PollExpertController",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}]}}).when("/poll/statistics",{templateUrl:"poll/poll.statistics.html",controller:"PollStatisticsController",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}]}})}]),angular.module("hitsaOis").controller("RoomSearchController",["$scope","Classifier","QueryUtils",function(a,b,c){a.equipmentDefs=b.queryForDropdown({mainClassCode:"SEADMED"}),c.createQueryForm(a,"/rooms",{order:"b.name"},function(b){b.forEach(function(b){b.equipment=(b.roomEquipment||[]).map(function(b){return{equipment:a.equipmentDefs[b.equipment],equipmentCount:b.equipmentCount}})})}),a.equipmentDefs.$promise.then(function(){a.equipmentDefs=b.toMap(a.equipmentDefs),a.loadData()})}]).controller("RoomEditController",["message","$location","$route","$scope","Classifier","FormUtils","QueryUtils",function(a,b,c,d,e,f,g){function h(){d.formState.roomUniqueQuery.url=k+"/unique/"+(d.record.building||"0")}function i(a){d.formState.roomEquipment=(a.roomEquipment||[]).map(function(a){return{equipment:d.equipmentDefs[a.equipment],equipmentCount:a.equipmentCount}}),h()}var j=c.current.params.id,k="/rooms",l=g.endpoint(k);d.equipmentDefs=e.queryForDropdown({mainClassCode:"SEADMED"}),d.formState={roomUniqueQuery:{id:j}},d.equipmentDefs.$promise.then(function(){d.equipmentDefs=e.toMap(d.equipmentDefs),j?d.record=l.get({id:j},i):(d.record=new l({roomEquipment:[],isStudy:!0}),i(d.record))}),d.addEquipment=function(){return d.formState.roomEquipment.some(function(a){return a.equipment.code===d.formState.newEquipment.code})?void a.error("room.duplicateequipment"):(d.formState.roomEquipment.push({equipment:d.formState.newEquipment,equipmentCount:1}),void(d.formState.newEquipment=null))},d.deleteEquipment=function(a){for(var b=d.formState.roomEquipment,c=0,e=b.length;e>c;c++)if(b[c].equipment.code===a){b.splice(c,1);break}},d.update=function(){f.withValidForm(d.roomForm,function(){d.record.roomEquipment=d.formState.roomEquipment.map(function(a){return{equipment:a.equipment.code,equipmentCount:a.equipmentCount}}),d.record.id?(d.record.$update().then(i).then(a.updateSuccess)["catch"](angular.noop),d.roomForm.$setPristine()):d.record.$save().then(function(){a.info("main.messages.create.success"),b.url(k+"/"+d.record.id+"/edit?_noback")})["catch"](angular.noop)})},d["delete"]=function(){f.deleteRecord(d.record,"/rooms/search?_noback",{prompt:"room.deleteconfirm"})},d.buildingChanged=function(){h(),d.roomForm.code.$validate()}}]),angular.module("hitsaOis").config(["$routeProvider","USER_ROLES",function(a,b){a.when("/rooms/new",{templateUrl:"room/room.edit.html",controller:"RoomEditController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_HOONERUUM]}}).when("/rooms/search",{templateUrl:"room/room.search.html",controller:"RoomSearchController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_HOONERUUM]}}).when("/rooms/:id/edit",{templateUrl:"room/room.edit.html",controller:"RoomEditController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_HOONERUUM]}})}]),angular.module("hitsaOis").controller("ReceptionSaisAdmissionArchiveController",["message","$route","$scope","QueryUtils","dialogService","$filter",function(a,b,c,d,e,f){c.auth=b.current.locals.auth,c.save=function(){e.showDialog("reception/reception.saisAdmission.archive.confirm.html",function(b){b.archive=f("hoisDate")(c.archive.endDate),b.submit=function(){d.endpoint("/saisAdmissions/archive").save(c.archive).$promise.then(function(){a.info("reception.archive.archivedAdmission")})}})}}]),angular.module("hitsaOis").controller("ReceptionSaisAdmissionController",["message","$scope","$route","DataUtils","QueryUtils",function(a,b,c,d,e){function f(a){d.convertStringToDates(a,["periodStart","periodEnd"]),angular.extend(b.saisAdmission,a)}b.auth=c.current.locals.auth,b.saisAdmission={};var g=c.current.locals.entity;angular.isDefined(g)&&f(g),b.revertArchived=function(){e.endpoint("/saisAdmissions/deArchive/"+c.current.params.id).save().$promise.then(function(c){c.archived?a.error("reception.archive.error"):(b.saisAdmission=c,a.info("reception.archive.revertedArchived"))})}}]).controller("ReceptionSaisAdmissionListController",["USER_ROLES","AuthService","$q","$route","$scope","Classifier","QueryUtils",function(a,b,c,d,e,f,g){e.auth=d.current.locals.auth,e.archiveButton=b.isAuthorized(a.ROLE_OIGUS_M_TEEMAOIGUS_VASTUVOTT);var h=d.current.locals.clMapping,i=h?f.valuemapper(h):void 0;g.createQueryForm(e,d.current.locals.url,d.current.locals.params,i?i.objectmapper:void 0),i?c.all(i.promises).then(e.loadData):e.loadData()}]),angular.module("hitsaOis").controller("ReceptionSaisAdmissionImportController",["$scope","message","QueryUtils","Classifier",function(a,b,c,d){a.successEmpty=!0,a.failEmpty=!0,a.importAdmissions=function(){a.successEmpty=!0,a.failEmpty=!0;var e=d.valuemapper({studyForm:"OPPEVORM",language:"OPPEKEEL"});a.admissionImportForm.$valid?c.endpoint("/saisAdmissions/saisImport").save(a.criteria).$promise.then(function(c){e.objectmapper(c.content),a.success=[],a.fail=[];for(var d=0;d<c.content.length;d++)c.content[d].failed===!0?(a.fail.push(c.content[d]),a.failEmpty=!1):(a.success.push(c.content[d]),a.successEmpty=!1);b.info("reception.admission.importFinished")}):b.error("main.messages.form-has-errors")}}]),angular.module("hitsaOis").controller("ReceptionSaisApplicationController",["message","$location","$scope","$route","DataUtils","dialogService","QueryUtils",function(a,b,c,d,e,f,g){function h(a){e.convertStringToDates(a,["submitted","saisChanged"]),angular.extend(c.saisApplication,a)}c.auth=d.current.locals.auth,c.saisApplication={},c.getAddress=e.formatAddress;var i=g.endpoint("/saisApplications"),j=d.current.locals.entity;angular.isDefined(j)&&h(j),c.confirm=function(){f.confirmDialog({prompt:"main.menu.reception.saisApplication.delete"},function(){var d=new i(c.saisApplication);d.$delete().then(function(){a.info("main.messages.delete.success"),b.url("/reception/saisApplication/search")})})}}]),angular.module("hitsaOis").controller("ReceptionSaisApplicationImportController",["$scope","Classifier","QueryUtils","message",function(a,b,c,d){a.statusList=b.queryForDropdown({mainClassCode:"SAIS_AVALDUSESTAATUS",order:"code"}),a.statusList.$promise.then(function(){b.setSelectedCodes(a.statusList,["SAIS_AVALDUSESTAATUS_T"])});var e=b.valuemapper({applicationStatus:"SAIS_AVALDUSESTAATUS"});a.importApplications=function(){if(a.applicationImportForm.$valid){var f=b.getSelectedCodes(a.statusList);a.criteria.status=f.length>0?f:void 0,c.endpoint("/saisApplications/importSais").save(a.criteria).$promise.then(function(b){e.objectmapper(b.successful),a.failed=b.failed,a.successful=b.successful,a.result=!0,d.info("reception.application.importFinished")})}else d.error("reception.application.form-has-errors")}}]),angular.module("hitsaOis").controller("ReceptionSaisApplicationListController",["$scope","QueryUtils","Classifier","dialogService","oisFileService","config","USER_ROLES","AuthService",function(a,b,c,d,e,f,g,h){function i(c){b.endpoint("/saisApplications/importCsv").save({file:c},function(b){d.showDialog("reception/reception.saisApplication.import.result.dialog.html",function(a){a.result=b},null,function(){a.loadData()},{clickOutsideToClose:!1})})}a.canEdit=h.isAuthorized(g.ROLE_OIGUS_M_TEEMAOIGUS_VASTUVOTT);var j=c.valuemapper({status:"SAIS_AVALDUSESTAATUS"});b.createQueryForm(a,"/saisApplications",{order:"applicationNr"},j.objectmapper),a.loadData(),a.importFromCsvFile=function(){d.showDialog("reception/reception.saisApplication.import.csv.file.dialog.html",null,function(a){var b=a.data;e.getFromLfFile(b.file[0],function(a){d.hide(),i(a)})})},a.csvSampleFileUrl=f.apiUrl+"/saisApplications/sample.csv",a.classifiersFileUrl=f.apiUrl+"/saisApplications/classifiers.csv"}]),angular.module("hitsaOis").config(["$routeProvider","USER_ROLES",function(a,b){a.when("/reception/saisAdmission/search",{templateUrl:"reception/reception.saisAdmission.list.html",controller:"ReceptionSaisAdmissionListController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],clMapping:function(){return{studyForm:"OPPEVORM",language:"OPPEKEEL"}},params:function(){return{order:"code"}},url:function(){return"/saisAdmissions"}},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_VASTUVOTT]}}).when("/reception/saisAdmission/:id/view",{templateUrl:"reception/reception.saisAdmission.view.html",controller:"ReceptionSaisAdmissionController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],entity:["QueryUtils","$route",function(a,b){return a.endpoint("/saisAdmissions").get({id:b.current.params.id}).$promise}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_VASTUVOTT]}}).when("/reception/saisAdmission/import",{templateUrl:"reception/reception.saisAdmission.import.html",controller:"ReceptionSaisAdmissionImportController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_ANDMEVAHETUS_SAIS]}}).when("/reception/saisApplication/search",{templateUrl:"reception/reception.saisApplication.list.html",controller:"ReceptionSaisApplicationListController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_VASTUVOTT]}}).when("/reception/saisApplication/:id/view",{templateUrl:"reception/reception.saisApplication.view.html",controller:"ReceptionSaisApplicationController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],entity:["QueryUtils","$route",function(a,b){return a.endpoint("/saisApplications").get({id:b.current.params.id}).$promise}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_VASTUVOTT]}}).when("/reception/saisApplication/import",{templateUrl:"reception/reception.saisApplication.import.html",controller:"ReceptionSaisApplicationImportController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_ANDMEVAHETUS_SAIS]}}).when("/reception/saisAdmission/archive",{templateUrl:"reception/reception.saisAdmission.archive.html",controller:"ReceptionSaisAdmissionArchiveController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_VASTUVOTT]}})}]),angular.module("hitsaOis").controller("RemarkListController",["$scope","$route","$q","Classifier","DataUtils","QueryUtils","message",function(a,b,c,d,e,f,g){a.auth=b.current.locals.auth,a.teacherId=a.auth.teacher;var h="/remarks",i=d.valuemapper({reason:"MARKUS"}),j=i.promises;f.createQueryForm(a,h,{from:moment().startOf("isoweek").toDate(),order:"-remark_time"},i.objectmapper),e.convertStringToDates(a.criteria,["from","thru"]),a.formState={},a.formState.studyYears=f.endpoint("/autocomplete/studyYears").query(),a.formState.studyYears.$promise.then(function(){if(!a.criteria.studyYear){var b=e.getCurrentStudyYearOrPeriod(a.formState.studyYears);b&&(a.criteria.studyYear=b.id)}a.criteria.studyYear&&c.all(j).then(function(){a.loadData()})}),f.endpoint("/autocomplete/studentgroups").query({higher:!1,studentGroupTeacherId:a.teacherId}).$promise.then(function(b){a.formState.studentGroups=b,a.criteria.studentGroup||(a.criteria.studentGroup=1===b.length?b[0].id:null)}),a.$watch("criteria.studyYear",function(){var b=null;a.criteria.studyYear&&(b=a.formState.studyYears.filter(function(b){return b.id===a.criteria.studyYear})[0]),a.criteria.studyYearStart=b?b.startDate:null,a.criteria.studyYearEnd=b?b.endDate:null}),a.studentGroupChanged=function(){a.criteria.studentObject=null},a.$watch("criteria.studentObject",function(){a.criteria.student=a.criteria.studentObject?a.criteria.studentObject.id:null}),a.load=function(){return a.searchForm.$valid?void a.loadData():(g.error("main.messages.form-has-errors"),!1)}}]).controller("RemarkController",["$scope","$route","FormUtils","QueryUtils",function(a,b,c,d){a.auth=b.current.locals.auth,a.teacherId=a.auth.teacher;var e="journal"===b.current.params.type,f="/remarks"+(e?"/journal":""),g=d.endpoint(f),h=b.current.params.id;h?a.record=g.get({id:h}):a.record=new g({}),a.update=function(){c.saveRecord(a.remarkForm,a.record,f),a.remarkForm.$setPristine()},a["delete"]=function(){c.deleteRecord(a.record,"/remarks?_noback",{prompt:"remark.deleteconfirm"})}}]),angular.module("hitsaOis").config(["$routeProvider","USER_ROLES",function(a,b){a.when("/remarks",{templateUrl:"remark/remark.list.html",controller:"RemarkListController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_MARKUS]}}).when("/remarks/new",{templateUrl:"remark/remark.edit.html",controller:"RemarkController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_MARKUS]}}).when("/remarks/:id/edit",{templateUrl:"remark/remark.edit.html",controller:"RemarkController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_MARKUS]}}).when("/remarks/:type?/:id/view",{templateUrl:"remark/remark.view.html",controller:"RemarkController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve();
}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_MARKUS]}})}]),function(){function a(a){for(var c=0;c<a.application.records.length;c++)if(a.application.records[c].isFormalLearning){a.application.records[c].data=[];for(var d=Math.max(a.application.records[c].formalSubjectsOrModules.length,a.application.records[c].formalReplacedSubjectsOrModules.length),e=0;d>e;e++){var f=a.application.records[c].formalSubjectsOrModules[e]?a.application.records[c].formalSubjectsOrModules[e]:{},g=a.application.records[c].formalReplacedSubjectsOrModules[e]?a.application.records[c].formalReplacedSubjectsOrModules[e]:{};b(a,c,f,g)}}}function b(a,b,d,e){a.application.isVocational?d.curriculumVersionOmodule?c(a,b,d,e,d.curriculumVersionOmodule):c(a,b,d,e,null):f(a,b,d,e)}function c(a,b,c,f,g){if(angular.equals(f,{})){var h=e(a,c,a.application.records[b].id,g,null);a.application.records[b].data.push(h)}else d(a,b,c,f,g)}function d(a,b,c,d,f){var g=null,h=d.curriculumVersionOmoduleTheme;g=h?e(a,c,a.application.records[b].id,f,d.curriculumVersionOmodule,h):e(a,c,a.application.records[b].id,f,d.curriculumVersionOmodule,null),a.application.records[b].data.push(g)}function e(a,b,c,d,e,f){var g={};return g.recordId=c,b&&!angular.equals(b,{})&&(g.subjectOrModuleId=b.id,g.school=b.apelSchool?b.apelSchool:a.school,g.moduleId=b.id,g.module=d?d:{nameEt:b.nameEt,nameEn:b.nameEn},g.credits=b.credits,g.grade=a.gradesMap[b.grade],g.gradeDate=b.gradeDate,g.teachers=b.teachers,g.transfer=b.transfer),g.replacedModule=e,g.replacedTheme=f,e&&!f?g.replacedCredits=e.credits:e&&f?g.replacedCredits=f.credits:g.replacedCredits=null,g}function f(a,b,c,d){var e={};e.recordId=a.application.records[b].id,e.subjectOrModuleId=c.id,c&&!angular.equals(c,{})&&(e.school=c.apelSchool?c.apelSchool:a.school,e.subject=c.subject?c.subject:{nameEn:c.nameEn,nameEt:c.nameEt},e.code=c.subjectCode,e.credits=c.credits,e.assessment=a.assessmentsMap[c.assessment],e.grade=a.gradesMap[c.grade],e.gradeDate=c.gradeDate,e.teachers=c.teachers,e.module=c.curriculumVersionHmodule,e.isOptional=c.isOptional,e.transfer=c.transfer),d&&!angular.equals(d,{})&&(e.replacedSubject=d.subject,e.replacedCredits=d.subject.credits),a.application.records[b].data.push(e)}function g(a){for(var b=0;b<a.application.records.length;b++)if(!a.application.records[b].isFormalLearning){a.application.records[b].data=[];for(var c=Math.max(a.application.records[b].informalExperiences.length,a.application.records[b].informalSubjectsOrModules.length),d=0;c>d;d++){var e=a.application.records[b].informalExperiences[d]?a.application.records[b].informalExperiences[d]:{},f=a.application.records[b].informalSubjectsOrModules[d]?a.application.records[b].informalSubjectsOrModules[d]:{};h(a,b,e,f)}}}function h(a,b,c,d){var e=[],f=a.application.records[b].id;d.curriculumVersionOmodule?(e=i(a,d,d.curriculumVersionOmodule,f),a.application.records[b].data.push(angular.extend({},c,e))):d.subject?(e=j(a,d,f),a.application.records[b].data.push(angular.extend({},c,e))):a.application.records[b].data.push(c)}function i(a,b,c,d){var e=[];return e.recordId=d,e.moduleId=b.id,e.module=c,e.theme=b.curriculumVersionOmoduleTheme?b.curriculumVersionOmoduleTheme:null,e.isModule=b.curriculumVersionOmoduleTheme?!1:!0,e.schoolResultHours=e.isModule?l(b.curriculumVersionOmodule.themes):b.curriculumVersionOmoduleTheme.hours,e.grade=a.gradesMap[b.grade],e.outcomes=b.outcomes,e.skills=b.skills,e.transfer=b.transfer,e.ekap=e.isModule?c.credits:b.curriculumVersionOmoduleTheme.credits,e}function j(a,b,c){var d=[];return d.recordId=c,d.subjectId=b.id,d.subject=b.subject,d.code=b.subject.code,d.module=b.curriculumVersionHmodule,d.isOptional=b.isOptional,d.credits=b.subject.credits,d.grade=a.gradesMap[b.grade],d.skills=b.skills,d.transfer=b.transfer,d}function k(a,b){for(var c=0;c<b.subjects.length;c++)if(b.subjects[c].subjectId===a)return b.subjects[c].optional}function l(a){for(var b=0,c=0;c<a.length;c++)b+=a[c].hours;return b}function m(a,b){for(var c=0;c<b.length;c++)n(a,b[c])}function n(a,b){for(var c=0;c<b.formalSubjectsOrModules.length;c++)a.convertObjectToIdentifier(b.formalSubjectsOrModules[c],["apelSchool","subject","curriculumVersionHmodule","curriculumVersionOmodule"]);for(var d=0;d<b.formalReplacedSubjectsOrModules.length;d++)a.convertObjectToIdentifier(b.formalReplacedSubjectsOrModules[d],["subject","curriculumVersionOmodule","curriculumVersionOmoduleTheme"])}function o(a){for(var b=[],c=0;c<a.length;c++)b.push(a[c].subject.id);return b}function p(a,b,c){for(var d=[],e=0;e<b.length;e++)b[e].isModule?d.push(b[e].curriculumVersionOmodule.id):d.push(b[e].curriculumVersionOmoduleTheme.module);return!a.contains(d,c)}function q(a,b,c,d){for(var e=[],f=[],g=0;g<b.length;g++)b[g].isModule?e.push(b[g].curriculumVersionOmodule.id):f.push(b[g].curriculumVersionOmoduleTheme.id);return!a.contains(f,c)&&!a.contains(e,d)}function r(a,b,c,d){return d.isVocational?(b.grades=c.queryForDropdown({mainClassCode:"KUTSEHINDAMINE"}),b.assessments=c.queryForDropdown({mainClassCode:"KUTSEHINDAMISVIIS"})):(b.grades=c.queryForDropdown({mainClassCode:"KORGHINDAMINE"}),b.assessments=c.queryForDropdown({mainClassCode:"HINDAMISVIIS"})),a.all([b.grades.$promise,b.assessments.$promise]).then(function(a){var d=a[0],e=a[1];b.gradesMap=c.toMap(d),b.assessmentsMap=c.toMap(e)})}function s(a,b){var c=0;return c=a.isVocational?b?"VOTA_STAATUS_K"===a.status?6:7:"VOTA_STAATUS_K"===a.status?a.canEdit?5:6:a.canEdit?6:7:b?"VOTA_STAATUS_K"===a.status?8:9:"VOTA_STAATUS_K"===a.status?a.canEdit?7:8:a.canEdit?8:9}function t(a,b){var c=0;return c=a.isVocational?b?"VOTA_STAATUS_K"===a.status?6:7:"VOTA_STAATUS_K"===a.status?a.canEdit?5:6:a.canEdit?6:7:"VOTA_STAATUS_K"===a.status?4:5}function u(a){a.formalLearningColspan=s(a.application,a.formState.viewForm),a.informalLearningColspan=t(a.application,a.formState.viewForm)}angular.module("hitsaOis").controller("ApelApplicationEditController",["$filter","$rootScope","$scope","$route","ArrayUtils","HigherGradeUtil","VocationalGradeUtil","QueryUtils","oisFileService","dialogService","message","$location","Classifier","DataUtils","config","$q",function(b,c,d,e,f,h,i,j,s,t,v,w,x,y,z,A){function B(b){d.application=b,d.school=b.school,"VOTA_STAATUS_E"===b.status&&d.auth.isAdmin()&&(d.committees=j.endpoint("/apelApplications/"+d.application.id+"/committees").query()),d.application.committeeId=d.application.committee?d.application.committee.id:null,d.canChangeTransferStatus=b.canChangeTransferStatus,C(),r(A,d,x,b).then(function(){g(d),a(d)}),u(d)}function C(){return j.endpoint("/students/"+d.application.student.id).search(function(a){d.application.person=a.person,d.application.curriculumVersion=a.curriculumVersion,d.application.isVocational=a.curriculumVersion.isVocational})}function D(){C().$promise.then(function(){var a=new R(d.application);a.$save().then(function(){v.info("main.messages.create.success"),w.path("/apelApplication/"+a.id+"/edit")})["catch"](angular.noop)})}function E(a){return d.application.records[F(a)]}function F(a){for(var b=0;b<d.application.records.length;b++)if(d.application.records[b].id===a)return b}function G(a,b){for(var c=0;c<a.informalSubjectsOrModules.length;c++)if(a.informalSubjectsOrModules[c].id&&b&&a.informalSubjectsOrModules[c].id===b)return c}function H(a,b){for(var c=0;c<a.formalSubjectsOrModules.length;c++)if(a.formalSubjectsOrModules[c].id&&b&&a.formalSubjectsOrModules[c].id===b)return c}function I(a){for(var b=0;b<a.length;b++){for(var c=[],d=0;d<a[b].outcomes.length;d++){var e=a[b].outcomes[d];e.acquired&&c.push(e)}a[b].outcomes=c}}function J(a){for(var b=0;b<a.length;b++)a[b].grade&&a[b].grade.code&&(a[b].grade=a[b].grade.code)}function K(a){var b=[];if(a){a=L(a);for(var c=0;c<a.length;c++){b.push({id:a[c].id,moduleId:a[c].id,themeId:null,nameEt:a[c].nameEt,nameEn:a[c].nameEn,isModule:!0});var d=L(a[c].themes);if(d)for(var e=0;e<d.length;e++)b.push({id:d[e].id,moduleId:a[c].id,themeId:d[e].id,nameEt:a[c].nameEt+"/"+d[e].nameEt,nameEn:a[c].nameEn+"/"+d[e].nameEn,isModule:!1})}return b}}function L(a){return b("orderBy")(a,d.currentLanguageNameField())}function M(a){"VOTA_STAATUS_V"===d.application.status?t.showDialog("apelApplication/templates/reason.dialog.html",function(a){a.sendToConfirm=!0,a.committee=!0},function(a){m(y,d.application.records),j.endpoint("/apelApplications/"+d.application.id+"/sendToConfirm/").put({student:d.application.student,isVocational:d.application.isVocational,records:d.application.records,committeeId:d.application.committeeId,addInfo:a.reason},function(a){v.info("apel.messages.sentToConfirm"),B(a)})}):a?t.confirmDialog({prompt:"apel.sendToConfirmConfirm"},function(){m(y,d.application.records),N()}):(m(y,d.application.records),N())}function N(){j.endpoint("/apelApplications/"+d.application.id+"/sendToConfirm/").put({student:d.application.student,isVocational:d.application.isVocational,committeeId:d.application.committeeId,records:d.application.records},function(a){v.info("apel.messages.sentToConfirm"),B(a)})}function O(a){a?t.confirmDialog({prompt:"apel.confirmConfirm"},function(){j.endpoint("/apelApplications/"+d.application.id+"/confirm/").put({},function(a){v.info("apel.messages.confirmed"),B(a)})}):j.endpoint("/apelApplications/"+d.application.id+"/confirm/").put({},function(a){v.info("apel.messages.confirmed"),B(a)})}function P(){for(var a=0;a<d.application.records.length;a++)for(var b=0;b<d.application.records[a].data.length;b++)if(d.application.records[a].data[b].transfer)return!0;return!1}function Q(){var a=!1;return d.application.records.forEach(function(b){if(b.isFormalLearning){var c=0,d=0;b.formalSubjectsOrModules.forEach(function(a){a.transfer&&(c+=a.credits)}),b.formalReplacedSubjectsOrModules.forEach(function(a){d+=a.subject.credits}),b.error=c>d,b.error&&(a=!0)}}),a}var R=j.endpoint("/apelApplications");d.auth=e.current.locals.auth,d.application={},d.formState={},d.formState.viewForm=!1;var S=e.current.locals.entity;angular.isDefined(S)?B(S):d.application.status="VOTA_STAATUS_K",d.applicationPdfUrl=z.apiUrl+"/apelApplications/print/"+d.application.id+"/application.pdf",d.auth.isStudent()&&!d.application.student&&j.endpoint("/autocomplete/students?id="+d.auth.student).get({},function(a){a&&1===a.totalElements&&(d.application.student=a.content[0])}),d.$watch("application.student",function(){d.application&&d.application.student&&!d.application.id&&D()}),d.hideInvalid=function(a){return!x.isValid(a)},d.changeInformalTransferStatus=function(a){var b=a.subjectId||a.moduleId,c=F(a.recordId),e=G(d.application.records[c],b),f=d.application.records[c].informalSubjectsOrModules[e].transfer;d.application.records[c].informalSubjectsOrModules[e].transfer=!f},d.editInformalLearning=function(a){var b="";b=d.application.curriculumVersion.isVocational?"apelApplication/templates/informal.learning.vocational.edit.dialog.html":"apelApplication/templates/informal.learning.higher.edit.dialog.html",t.showDialog(b,function(b){function c(a){for(var c=0;c<a.length;c++)A(function(){var d=a[c];d.isModule=d.curriculumVersionOmoduleTheme?!1:!0,d.grade=b.gradesMap[d.grade],d.module=d.curriculumVersionOmodule,d.hours=d.isModule?l(d.curriculumVersionOmodule.themes):d.curriculumVersionOmoduleTheme.hours,d.isModule?(d.EKAP=d.curriculumVersionOmodule.credits,g(d.curriculumVersionOmodule.curriculumModule,d.outcomes).then(function(a){d.outcomes=a})):(d.EKAP=d.curriculumVersionOmoduleTheme.credits,h(d.curriculumVersionOmoduleTheme.id,d.outcomes).then(function(a){d.outcomes=a}))})}function e(){b.record.informalExperiences.push({nameEt:null,placeTime:null,hours:null,documents:null,type:null})}function g(a,b){return j.endpoint("/curriculumModule/"+a+"/outcomes").query().$promise.then(function(a){return i(a,b)})}function h(a,b){return j.endpoint("/occupationModule/theme/"+a+"/outcomes").query().$promise.then(function(a){return i(a,b)})}function i(a,b){for(var c=[],d=0;d<a.length;d++){var e=a[d],f=b?b.filter(function(a){return e.id===a.curriculumModuleOutcomes.id})[0]:void 0;c.push({id:f?f.id:null,curriculumModuleOutcomes:e,acquired:angular.isDefined(f)})}return c}function m(a,b,c,d){a.isModule?j.endpoint("/occupationModule").get({id:a.id},function(e){n(a,null,e,b,c,d)}):j.endpoint("/occupationModule/theme").get({id:a.id},function(e){j.endpoint("/occupationModule").get({id:e.module},function(f){n(a,e,f,b,c,d)})})}function n(a,c,d,e,f,g){var h=b.gradesMap.KUTSEHINDAMINE_A,i={isModule:a.isModule,curriculumVersionOmoduleTheme:c,curriculumVersionOmodule:d,hours:e,EKAP:f,grade:h,outcomes:g,skills:null};b.record.informalSubjectsOrModules.push(i)}function r(a,c,d,e){var f=b.gradesMap.KORGHINDAMINE_A,g={subject:a,curriculumVersionHmodule:c,isOptional:d,credits:e,skills:null,grade:f};b.record.informalSubjectsOrModules.push(g)}b.formState={},b.student=d.application.student,b.curriculumVersionId=d.application.curriculumVersion.id,b.isVocational=d.application.curriculumVersion.isVocational,b.gradesMap=d.gradesMap,b.assessmentsMap=d.assessmentsMap,a?(b.record=angular.copy(E(a)),b.isVocational&&c(b.record.informalSubjectsOrModules)):(b.record={informalExperiences:[],informalSubjectsOrModules:[]},e()),b.isVocational?j.endpoint("/autocomplete/curriculumversionomodulesandthemes").query({student:b.student.id,curriculumVersion:b.curriculumVersionId}).$promise.then(function(a){b.modulesAndThemes=K(a)}):(j.endpoint("/autocomplete/subjectsList").query({student:b.student.id,curriculumSubjects:!0,curriculumVersion:b.curriculumVersionId,withCredits:!0,noFinalSubjects:!0}).$promise.then(function(a){b.subjects=a}),j.endpoint("/apelApplications/freeChoiceModule/:student").search({student:b.student.id}).$promise.then(function(a){b.freeChoiceModule=a.id?a:null})),b.selectedModuleOrThemeChanged=function(){var a=b.selectedModuleOrTheme;a&&(a.isModule?p(f,b.record.informalSubjectsOrModules,a.moduleId)?j.endpoint("/occupationModule").get({id:a.id}).$promise.then(function(b){g(b.curriculumModule,null).then(function(c){m(a,l(b.themes),b.credits,c)})}):v.error("apel.error.moduleOrItsThemeHasAlreadyBeenAdded"):q(f,b.record.informalSubjectsOrModules,a.themeId,a.moduleId)?j.endpoint("/occupationModule/theme").get({id:a.id}).$promise.then(function(b){h(a.id,null).then(function(c){m(a,b.hours,b.credits,c)})}):v.error("apel.error.themeOrParentModuleHasAlreadyBeenAdded"),b.selectedModuleOrTheme=null)},b.$watch("formState.selectedSubject",function(){if(b.formState.selectedSubject){if(f.contains(o(b.record.informalSubjectsOrModules),b.formState.selectedSubject.id))v.error("apel.error.subjectHasAlreadyBeenAdded");else{var a=b.formState.selectedSubject;-1!==b.subjects.indexOf(b.formState.selectedSubject)?j.endpoint("/apelApplications/subjectModule").search({curriculumVersionId:b.curriculumVersionId,subjectId:a.id}).$promise.then(function(b){var c=k(a.id,b);r(a,b,c,a.credits)}):r(a,b.freeChoiceModule,!0,a.credits)}b.formState.selectedSubject=null}}),b.submitInformalLearning=function(){b.record.informalExperiences.length<=0?v.error("apel.error.atLeastOneOtherInformalLearning"):b.record.informalSubjectsOrModules.length<=0?b.isVocational?v.error("apel.error.atLeastOneSubstitutableModule"):v.error("apel.error.atLeastOneSubstitutableSubject"):b.submit()},b.removeSubtitutableModuleTheme=function(a){f.remove(b.record.informalSubjectsOrModules,a)},b.addNewInformalExperienceRow=function(){e()},b.removeInformalExperienceRow=function(a){f.remove(b.record.informalExperiences,a)},b["delete"]=function(){var a=j.endpoint("/apelApplications/"+d.application.id+"/record");new a(b.record).$delete().then(function(a){v.info("apel.messages.informalLearningRemoved"),B(a)})["catch"](angular.noop),b.cancel()}},function(a){d.application.curriculumVersion.isVocational&&I(a.record.informalSubjectsOrModules),J(a.record.informalSubjectsOrModules),a.record.isFormalLearning=!1;var b=j.endpoint("/apelApplications/"+d.application.id+"/record"),c=new b(a.record);angular.isDefined(a.record.id)?c.$update().then(function(a){v.info("main.messages.create.success"),B(a)})["catch"](angular.noop):c.$save().then(function(a){v.info("main.messages.create.success"),B(a)})["catch"](angular.noop)})},d.changeFormalTransferStatus=function(a){var b=a.subjectOrModuleId,c=F(a.recordId),e=H(d.application.records[c],b),f=d.application.records[c].formalSubjectsOrModules[e].transfer;d.application.records[c].formalSubjectsOrModules[e].transfer=!f},d.editFormalLearning=function(a){var b,e="";d.application.curriculumVersion.isVocational?(e="apelApplication/templates/formal.learning.vocational.edit.dialog.html",b=x.valuemapper({grade:"KUTSEHINDAMINE"})):(e="apelApplication/templates/formal.learning.higher.edit.dialog.html",b=x.valuemapper({grade:"KORGHINDAMINE"})),t.showDialog(e,function(e){function g(){e.formState.isMySchool=!1,e.formState.isNewSchool=!1,e.grades=null,e.record.assessment=null,e.record.curriculumVersionOmodule=null,e.record.subject=null,e.record.newTransferableSubjectOrModule={isNew:!0,newApelSchool:null,type:"VOTA_AINE_LIIK_M",assessment:null},N(e.record.newTransferableSubjectOrModule.type)}function k(a){for(var b=0;b<a.length;b++)A(function(){var c=a[b];c.curriculumVersionOmodule&&(c.module=c.curriculumVersionOmodule),c.curriculumVersionHmodule&&(c.module=c.curriculumVersionHmodule),c.grade.code||(c.grade=e.gradesMap[a[b].grade])})}function l(a){for(var b=0;b<a.length;b++){var c=a[b];c.isModule=c.curriculumVersionOmoduleTheme?!1:!0}}function m(a){"VOTA_AINE_LIIK_O"===a?j.endpoint("/autocomplete/curriculumversionomodules").query({student:e.student.id,curriculumModules:!0,curriculumVersion:e.curriculumVersionId}).$promise.then(function(b){r(a,b),s()}):"VOTA_AINE_LIIK_V"===a?j.endpoint("/autocomplete/curriculumversionomodules").query({student:e.student.id,otherStudents:!0,ignoreStatuses:!0}).$promise.then(function(b){r(a,b),s()}):"VOTA_AINE_LIIK_M"===a&&e.record.newTransferableSubjectOrModule.curriculumVersionOmodule&&j.endpoint("/autocomplete/curriculumversionomodules").query({id:e.record.newTransferableSubjectOrModule.curriculumVersionOmodule.id,student:e.student.id,curriculumModules:!1,curriculumVersion:e.curriculumVersionId}).$promise.then(function(b){r(a,b),s()})}function r(a,b){e.record.newTransferableSubjectOrModule&&e.record.newTransferableSubjectOrModule.type===a&&(e.transferableModules=b)}function s(){var a=!1;if(e.record.newTransferableSubjectOrModule&&e.record.newTransferableSubjectOrModule.curriculumVersionOmodule&&null!==e.transferableModules)for(var b=0;b<e.transferableModules.length;b++)e.transferableModules[b].id===e.record.newTransferableSubjectOrModule.curriculumVersionOmodule.id&&(a=!0);!a&&e.record.newTransferableSubjectOrModule&&(e.record.newTransferableSubjectOrModule.curriculumVersionOmodule=null)}function t(a){"VOTA_AINE_LIIK_O"===a?j.endpoint("/autocomplete/subjectsList").query({student:e.student.id,curriculumSubjects:!0,curriculumVersion:e.curriculumVersionId,withCredits:!1,noFinalSubjects:!0}).$promise.then(function(b){u(a,b),w()}):"VOTA_AINE_LIIK_V"===a?j.endpoint("/autocomplete/subjectsList").query({student:e.student.id,otherStudents:!0,withCredits:!1,noFinalSubjects:!0}).$promise.then(function(b){u(a,b),w()}):"VOTA_AINE_LIIK_M"===a&&e.record.newTransferableSubjectOrModule.subject&&j.endpoint("/autocomplete/subjectsList").query({student:e.student.id,curriculumSubjects:!1,curriculumVersion:e.curriculumVersionId,withCredits:!1,noFinalSubjects:!0}).$promise.then(function(b){u(a,b),w()})}function u(a,b){e.record.newTransferableSubjectOrModule&&e.record.newTransferableSubjectOrModule.type===a&&(e.transferableSubjects=b)}function w(){var a=!1;if(e.record.newTransferableSubjectOrModule&&e.record.newTransferableSubjectOrModule.subject&&null!==e.transferableSubjects)for(var b=0;b<e.transferableSubjects.length;b++)e.transferableSubjects[b].id===e.record.newTransferableSubjectOrModule.subject.id&&(a=!0);a||(e.record.newTransferableSubjectOrModule.subject=null)}function z(a){e.record.newTransferableSubjectOrModule.subject=a,e.record.subject=a,e.record.newTransferableSubjectOrModule.subjectCode=a.code,e.record.newTransferableSubjectOrModule.credits=a.credits;var b=e.assessmentsMap[a.assessment];e.record.newTransferableSubjectOrModule.assessment!==b.code&&(e.record.assessment=b,e.record.newTransferableSubjectOrModule.assessment=b.code,e.record.newTransferableSubjectOrModule.grade=null,G(b.code))}function C(a){a&&a.gradeCode&&(e.record.newTransferableSubjectOrModule.grade=a.gradeCode,e.record.newTransferableSubjectOrModule.gradeDate=a.gradeDate,e.record.newTransferableSubjectOrModule.teachers=a.teachers)}function D(a){e.record.newTransferableSubjectOrModule.curriculumVersionOmodule=a,e.record.curriculumVersionOmodule=a,e.record.newTransferableSubjectOrModule.credits=a.credits;var b=e.assessmentsMap[a.assessment];e.record.newTransferableSubjectOrModule.assessment!==b.code&&(e.record.assessment=b,e.record.newTransferableSubjectOrModule.assessment=b.code,e.record.newTransferableSubjectOrModule.grade=null,G(b.code))}function F(a){a&&a.gradeCode&&(e.record.newTransferableSubjectOrModule.grade=a.gradeCode,e.record.newTransferableSubjectOrModule.gradeDate=a.gradeDate,e.record.newTransferableSubjectOrModule.teachers=a.teachers)}function G(a){e.isVocational?"KUTSEHINDAMISVIIS_M"===a?e.grades=d.grades.filter(function(a){return i.isPositive(a.code)&&!i.isDistinctive(a.code)}):"KUTSEHINDAMISVIIS_E"===a&&(e.grades=d.grades.filter(function(a){return i.isPositive(a.code)&&i.isDistinctive(a.code)})):"HINDAMISVIIS_H"===a||"HINDAMISVIIS_E"===a?e.grades=d.grades.filter(function(a){return h.isPositive(a.code)&&h.isDistinctive(a.code)}):"HINDAMISVIIS_A"===a&&(e.grades=d.grades.filter(function(a){return h.isPositive(a.code)&&!h.isDistinctive(a.code)}))}function H(){e.newSchoolEst=!1,e.record.newTransferableSubjectOrModule&&(e.record.newTransferableSubjectOrModule.apelSchool=null,e.record.newTransferableSubjectOrModule.newApelSchool=null)}function I(a){var b=(e.record.formalSubjectsOrModules||[]).map(function(a){return a.curriculumVersionOmodule?a.curriculumVersionOmodule.id:void 0}),c=null!==a.curriculumVersionOmodule&&angular.isDefined(a.curriculumVersionOmodule)?a.curriculumVersionOmodule.id:null;return-1!==b.indexOf(c)}function J(a){var b=(e.record.formalSubjectsOrModules||[]).map(function(a){return a.subject?a.subject.id:void 0}),c=null!==a.subject&&angular.isDefined(a.subject)?a.subject.id:null;return-1!==b.indexOf(c)}function L(a){M(a.newApelSchool)||(e.apelSchools.push(a.newApelSchool),e.apelSchools=e.apelSchools.sort(function(a,b){return c.currentLanguageNameField(a).localeCompare(c.currentLanguageNameField(b))}))}function M(a){for(var b=!1,c=0;c<e.apelSchools.length;c++)a.ehisSchool?e.apelSchools[c].ehisSchool===a.ehisSchool&&(b=!0):e.apelSchools[c].nameEt===a.nameEt&&e.apelSchools[c].country===a.country&&(b=!0);return b}function N(a){e.isVocational?m(a):t(a)}function O(a){a.isModule?j.endpoint("/occupationModule").get({id:e.selectedModuleOrTheme.id},function(b){P(a,null,b)}):j.endpoint("/occupationModule/theme").get({id:e.selectedModuleOrTheme.id},function(b){var c=b;j.endpoint("/occupationModule").get({id:c.module},function(b){P(a,c,b)})})}function P(a,b,c){var d={isModule:a.isModule,curriculumVersionOmoduleTheme:b,curriculumVersionOmodule:c};e.record.formalReplacedSubjectsOrModules.push(d)}function Q(a){var b=R(e.record.formalSubjectsOrModules),c=0;return c=a?S(e.record.formalReplacedSubjectsOrModules):T(e.record.formalReplacedSubjectsOrModules),b>=c?!0:!1}function R(a){for(var b=0,c=0;c<a.length;c++)b+=a[c].credits;return b}function S(a){for(var b=0,c=0;c<a.length;c++)b+=a[c].curriculumVersionOmoduleTheme?a[c].curriculumVersionOmoduleTheme.credits:a[c].curriculumVersionOmodule.credits;return b}function T(a){for(var b=0,c=0;c<a.length;c++)b+=a[c].subject.credits;return b}function U(){var a=(e.record.formalSubjectsOrModules||[]).filter(function(a){return"KORGMOODUL_V"!==a.curriculumVersionHmodule.type});return 0===a.length}function V(){var a=[];angular.forEach(e.record.formalSubjectsOrModules,function(b){a.push(b)}),e.record.formalSubjectsOrModules=a}e.auth=d.auth,e.formState={},e.student=d.application.student,e.currentDate=new Date,e.curriculumVersionId=d.application.curriculumVersion.id,e.isVocational=d.application.curriculumVersion.isVocational,e.apelSchools=j.endpoint("/autocomplete/apelschools").query(),e.gradesMap=d.gradesMap,e.assessmentsMap=d.assessmentsMap,e.hideInvalid=d.hideInvalid,x.queryForDropdown({mainClassCode:"RIIK"},function(a){e.countryMap=x.toMap(a)}),x.queryForDropdown({mainClassCode:"EHIS_KOOL"},function(a){e.ehisSchoolMap=x.toMap(a)}),e.isVocational?(j.endpoint("/autocomplete/curriculumversionomodulesandthemes").query({student:e.student.id,curriculumVersion:e.curriculumVersionId}).$promise.then(function(a){e.modulesAndThemes=K(a)}),e.curriculumModules=j.endpoint("/autocomplete/curriculumversionomodules").query({student:e.student.id,curriculumVersion:e.curriculumVersionId})):(j.endpoint("/autocomplete/subjectsList").query({student:e.student.id,curriculumSubjects:!0,curriculumVersion:e.curriculumVersionId,withCredits:!0,noFinalSubjects:!0}).$promise.then(function(a){e.subjects=a}),j.endpoint("/apelApplications/studentModules/:student").query({student:e.student.id}).$promise.then(function(a){e.curriculumModules=a})),a?(e.record=angular.copy(E(a)),k(e.record.formalSubjectsOrModules),e.isVocational&&l(e.record.formalReplacedSubjectsOrModules)):(e.record={formalSubjectsOrModules:[],formalReplacedSubjectsOrModules:[]},g()),e.$watch("formState.isMySchool",function(){if(e.record.school=d.school,e.record.newTransferableSubjectOrModule&&(e.record.newTransferableSubjectOrModule.isMySchool=e.formState.isMySchool),a){if(e.record.newTransferableSubjectOrModule){var b=angular.copy(e.record.newTransferableSubjectOrModule);e.formState.isNewSchool=b.isNewSchool,e.record.newTransferableSubjectOrModule={id:b.id,isNew:b.isNew,isNewSchool:b.isNewSchool,isMySchool:b.isMySchool,type:b.type,grade:b.grade,gradeDate:b.gradeDate,teachers:b.teachers,assessment:b.assessment,credits:b.credits,subjectCode:b.subjectCode,curriculumVersionHmodule:b.curriculumVersionHmodule,isOptional:b.isOptional,transferableSubjectOrModuleIndex:b.transferableSubjectOrModuleIndex,transfer:b.transfer},G(e.record.newTransferableSubjectOrModule.assessment),b.isMySchool===!0?b.subject?(t(b.type),z(b.subject)):e.record.subject?(t(b.type),z(e.record.subject)):b.curriculumVersionOmodule?(m(b.type),D(b.curriculumVersionOmodule)):e.record.curriculumVersionOmodule&&(m(b.type),D(e.record.curriculumVersionOmodule)):(b.isNewSchool?e.record.newTransferableSubjectOrModule.newApelSchool=b.newApelSchool:e.record.newTransferableSubjectOrModule.apelSchool=e.record.apelSchool,e.record.newTransferableSubjectOrModule.nameEt=e.record.nameEt,e.record.newTransferableSubjectOrModule.nameEn=e.record.nameEn,e.record.newTransferableSubjectOrModule.type="VOTA_AINE_LIIK_M")}}else e.record.newTransferableSubjectOrModule={},e.record.newTransferableSubjectOrModule.isNew=!0,e.record.newTransferableSubjectOrModule.apelSchool=null,e.formState.isMySchool?e.record.newTransferableSubjectOrModule.type="VOTA_AINE_LIIK_V":e.record.newTransferableSubjectOrModule.type="VOTA_AINE_LIIK_M",N(e.record.newTransferableSubjectOrModule.type)}),e.typeChanged=function(a){N(a)},e.gradeValue=function(a){var c=b.objectmapper({grade:a}).grade;return c?d.auth.school.letterGrades&&!e.isVocational?c.value2:c.value:void 0},e.newSchoolCountryChanged=function(a){e.newSchoolEst="RIIK_EST"===a?!0:!1,e.record.newTransferableSubjectOrModule.newApelSchool.ehisSchool=null},e.ehisSchoolChanged=function(a){var b=e.ehisSchoolMap[a];e.record.newTransferableSubjectOrModule.newApelSchool.nameEt=b.nameEt,e.record.newTransferableSubjectOrModule.newApelSchool.nameEn=b.nameEn},e.apelSchoolChanged=function(a){angular.isDefined(a.id)||(e.record.newTransferableSubjectOrModule.newApelSchool=a),e.record.newTransferableSubjectOrModule.country=e.countryMap[a.country]},e.subjectChanged=function(a){a&&(e.record.subject?a.id!==e.record.subject.id&&(z(a),C(a)):(z(a),C(a)))},e.moduleChanged=function(a){a&&(e.record.curriculumVersionOmodule?a.id!==e.record.curriculumVersionOmodule.id&&(D(a),F(a)):(D(a),F(a)))},e.assessmentTypeChanged=function(a){e.record.newTransferableSubjectOrModule.grade=null,G(a)},e.addNewSchool=function(){e.formState.isNewSchool=!0,H()},e.cancelCreatingNewSchool=function(){e.formState.isNewSchool=!1,H()},e.addNewTransferableSubjectOrModule=function(){e.dialogForm.$setPristine(),g()},e.addTransferableSubjectOrModule=function(){var a=e.record.newTransferableSubjectOrModule;if(e.isVocational){if(I(a))return void v.error("apel.error.moduleHasAlreadyBeenAdded")}else if(J(a))return void v.error("apel.error.subjectHasAlreadyBeenAdded");e.dialogForm.$setSubmitted(),e.dialogForm.$valid&&(e.record.newTransferableSubjectOrModule=null,a.isMySchool=e.formState.isMySchool,a.isNewSchool=e.formState.isNewSchool,a.isNew=!1,a.isMySchool||(a.type="VOTA_AINE_LIIK_M"),a.curriculumVersionOmodule&&(a.module=a.curriculumVersionOmodule),a.curriculumVersionHmodule&&(a.module=a.curriculumVersionHmodule),a.grade=e.gradesMap[a.grade],e.record.formalSubjectsOrModules.push(a),e.formState.isNewSchool&&L(a))},e.apelSchoolsEhisCodes=function(){return e.apelSchools.filter(function(a){return a.ehisSchool}).map(function(a){return e.record.newTransferableSubjectOrModule.newApelSchool.ehisSchool!==a.ehisSchool?a.ehisSchool:void 0})},e.addSelectedSubject=function(){f.contains(o(e.record.formalReplacedSubjectsOrModules),e.selectedSubject.id)?v.error("apel.error.subjectHasAlreadyBeenAdded"):e.record.formalReplacedSubjectsOrModules.push({subject:e.selectedSubject}),e.selectedSubject=null},e.removeSubtitutableSubject=function(a){f.remove(e.record.formalReplacedSubjectsOrModules,a)},e.editTransferableSubjectOrModule=function(a){e.record.newTransferableSubjectOrModule=angular.copy(e.record.formalSubjectsOrModules[a]),e.record.newTransferableSubjectOrModule.transferableSubjectOrModuleIndex=a,e.formState.isMySchool=e.record.formalSubjectsOrModules[a].isMySchool,e.formState.isNewSchool=e.record.formalSubjectsOrModules[a].isNewSchool,e.record.apelSchool=e.record.formalSubjectsOrModules[a].apelSchool,e.record.apelSchool&&(e.record.newTransferableSubjectOrModule.country=e.countryMap[e.record.apelSchool.country]),e.record.assessment=e.assessmentsMap[e.record.newTransferableSubjectOrModule.assessment],e.record.curriculumVersionOmodule=e.record.newTransferableSubjectOrModule.curriculumVersionOmodule,e.record.nameEt=e.record.formalSubjectsOrModules[a].nameEt,e.record.nameEn=e.record.formalSubjectsOrModules[a].nameEn,e.record.newTransferableSubjectOrModule.curriculumVersionOmodule=e.record.formalSubjectsOrModules[a].curriculumVersionOmodule,e.record.newTransferableSubjectOrModule.grade=e.record.newTransferableSubjectOrModule.grade.code,G(e.record.newTransferableSubjectOrModule.assessment),N(e.record.newTransferableSubjectOrModule.type)},e.changeTransferableSubjectOrModule=function(){var a=e.record.newTransferableSubjectOrModule;e.dialogForm.$setSubmitted(),e.dialogForm.$valid&&(e.record.formalSubjectsOrModules[a.transferableSubjectOrModuleIndex]=a,e.record.newTransferableSubjectOrModule=null,k(e.record.formalSubjectsOrModules),e.formState.isNewSchool&&L(a))},e.deleteTransferableSubjectOrModule=function(){var a=e.record.newTransferableSubjectOrModule;a&&(a.transferableSubjectOrModuleIndex>=0?e.record.formalSubjectsOrModules.splice(a.transferableSubjectOrModuleIndex,1):e.record.newTransferableSubjectOrModule=null),e.record.newTransferableSubjectOrModule=null},e.formalSelectedModuleOrThemeChanged=function(){var a=e.selectedModuleOrTheme;a&&(a.isModule?p(f,e.record.formalReplacedSubjectsOrModules,a.moduleId)?O(a):v.error("apel.error.moduleOrItsThemeHasAlreadyBeenAdded"):q(f,e.record.formalReplacedSubjectsOrModules,a.themeId,a.moduleId)?O(a):v.error("apel.error.themeOrParentModuleHasAlreadyBeenAdded"),e.selectedModuleOrTheme=null)},e.removeSubtitutableModuleTheme=function(a){f.remove(e.record.formalReplacedSubjectsOrModules,a)},e.submitVocationalFormalLearning=function(){
e.record.formalSubjectsOrModules.length<=0?v.error("apel.error.atLeastOneTransferableModule"):e.record.formalReplacedSubjectsOrModules.length<=0?v.error("apel.error.atLeastOneSubstitutableModule"):Q(!0)?(V(),n(y,e.record),e.submit()):v.error("apel.error.thereMustBeMoreTransferableCreditsThanSubstitutableCreditsVocational")},e.areReplacedSubjectsOrModulesInvalid=function(){return e.isVocational?e.dialogForm.$submitted&&(!e.record.formalReplacedSubjectsOrModules||0===e.record.formalReplacedSubjectsOrModules.length):U()?!1:e.dialogForm.$submitted&&(!e.record.formalReplacedSubjectsOrModules||0===e.record.formalReplacedSubjectsOrModules.length)},e.submitHigherFormalLearning=function(){if(e.record.formalSubjectsOrModules.length<=0)return void v.error("apel.error.atLeastOneTransferableSubject");if(!U()){if(e.record.formalReplacedSubjectsOrModules.length<=0)return void v.error("apel.error.atLeastOneSubstitutableSubject");if(!Q(!1))return void v.error("apel.error.thereMustBeMoreTransferableCreditsThanSubstitutableCreditsHigher")}V(),n(y,e.record),e.submit()},e["delete"]=function(){var a=j.endpoint("/apelApplications/"+d.application.id+"/record");new a(e.record).$delete().then(function(a){v.info("apel.messages.formalLearningRemoved"),B(a)})["catch"](angular.noop),e.cancel()}},function(a){J(a.record.formalSubjectsOrModules),a.record.isFormalLearning=!0;var b=j.endpoint("/apelApplications/"+d.application.id+"/record"),c=new b(a.record);angular.isDefined(a.record.id)?c.$update().then(function(a){v.info("main.messages.create.success"),B(a)})["catch"](angular.noop):c.$save().then(function(a){v.info("main.messages.create.success"),B(a)})["catch"](angular.noop)})};var T=j.endpoint("/apelApplications/"+d.application.id+"/file");d.openAddFileDialog=function(){t.showDialog("components/file.add.dialog.html",function(a){a.addedFiles=d.application.files},function(a){var b=a.data;s.getFromLfFile(b.file[0],function(a){b.oisFile=a;var c=new T(b);c.$save().then(function(a){v.info("main.messages.create.success"),d.application.files.push(a)})["catch"](angular.noop)})})},d.openEditCommentDialog=function(a){t.showDialog("apelApplication/templates/comment.edit.dialog.html",function(b){a&&(b.comment=angular.copy(a))},function(a){var b=j.endpoint("/apelApplications/"+d.application.id+"/comment"),c=new b(a.comment);angular.isDefined(a.comment.id)?c.$update().then(function(a){v.info("main.messages.create.success"),B(a)})["catch"](angular.noop):c.$save().then(function(a){v.info("main.messages.create.success"),B(a)})["catch"](angular.noop)})},d.deleteFile=function(a){t.confirmDialog({prompt:"apel.deleteFileConfirm"},function(){var b=new T(a);b.$delete().then(function(){v.info("main.messages.delete.success"),f.remove(d.application.files,a)})["catch"](angular.noop)})},d.getUrl=s.getUrl,d.save=function(){m(y,d.application.records);var a=new R(d.application);a.$update().then(function(){v.info("main.messages.create.success"),B(a),d.apelApplicationForm.$setPristine()})["catch"](angular.noop)},d.submit=function(){t.confirmDialog({prompt:"apel.submitConfirm"},function(){j.endpoint("/apelApplications/"+d.application.id+"/submit").put({},function(a){v.info("apel.messages.submitted"),B(a)})})},d.sendBackToCreation=function(){"VOTA_STAATUS_V"===d.application.status?t.showDialog("apelApplication/templates/reason.dialog.html",function(a){a.sendBackToCreation=!0,a.committee=!0},function(a){j.endpoint("/apelApplications/"+d.application.id+"/sendBackToCreation/").put({addInfo:a.reason},function(a){v.info("apel.messages.sentBackToCreation"),B(a)})}):t.confirmDialog({prompt:"apel.sendBackToCreationConfirm"},function(){j.endpoint("/apelApplications/"+d.application.id+"/sendBackToCreation/").put({},function(a){v.info("apel.messages.sentBackToCreation"),B(a)})})},d.sendToConfirm=function(){P()?!d.application.isVocational&&Q()?t.confirmDialog({prompt:"apel.error.transferredSubjectLargerThanSubstitutableSubject",extraPrompts:["apel.sendToConfirmConfirm"]},function(){M(!1)}):M(!0):v.error("apel.error.atLeastOneLearningMustBeTransferred")},d.sendToCommittee=function(){m(y,d.application.records),t.confirmDialog({prompt:"apel.sendToCommitteeConfirm"},function(){j.endpoint("/apelApplications/"+d.application.id+"/sendToCommittee/").put({student:d.application.student,isVocational:d.application.isVocational,records:d.application.records,committeeId:d.application.committeeId},function(a){v.info("apel.messages.sentToCommittee"),B(a)})})},d.confirm=function(){P()?!d.application.isVocational&&Q()?t.confirmDialog({prompt:"apel.error.transferredSubjectLargerThanSubstitutableSubject",extraPrompts:["apel.confirmConfirm"]},function(){O(!1)}):O(!0):v.error("apel.error.atLeastOneLearningMustBeTransferred")},d.sendBack=function(){t.confirmDialog({prompt:"apel.sendBackConfirm"},function(){j.endpoint("/apelApplications/"+d.application.id+"/sendBack/").put({},function(a){v.info("apel.messages.sentBack"),B(a)})})},d.reject=function(){t.showDialog("apelApplication/templates/reason.dialog.html",function(a){a.rejection=!0,a.committee="VOTA_STAATUS_V"===d.application.status},function(a){j.endpoint("/apelApplications/"+d.application.id+"/reject/").put({addInfo:a.reason},function(a){v.info("apel.messages.rejected"),B(a)})})},d.removeConfirmation=function(){t.confirmDialog({prompt:"apel.removeConfirmationConfirm"},function(){j.endpoint("/apelApplications/"+d.application.id+"/removeConfirmation/").put({},function(a){v.info("apel.messages.removedConfirmation"),B(a)})})},d["delete"]=function(){t.confirmDialog({prompt:"apel.deleteConfirm"},function(){var a=new R(d.application);a.$delete().then(function(){v.info("main.messages.delete.success"),w.path("/apelApplication")})["catch"](angular.noop)})}}]).controller("ApelApplicationViewController",["$scope","$route","$q","QueryUtils","oisFileService","Classifier","DataUtils","dialogService","message","config",function(b,c,d,e,f,h,i,j,k,l){function n(c){b.application=c,b.school=c.school,e.endpoint("/students/"+b.application.student.id).search(function(a){b.application.person=a.person,b.application.curriculumVersion=a.curriculumVersion,b.application.isVocational=a.curriculumVersion.isVocational,b.application.committeeId=b.application.committee?b.application.committee.id:null}),r(d,b,h,c).then(function(){g(b),a(b)}),u(b),"VOTA_STAATUS_E"===c.status&&b.auth.isAdmin()&&(b.committees=e.endpoint("/apelApplications/"+b.application.id+"/committees").query()),b.application.committeeId=b.application.committee?b.application.committee.id:null}function o(){"VOTA_STAATUS_V"===b.application.status?j.showDialog("apelApplication/templates/reason.dialog.html",function(a){a.sendToConfirm=!0,a.committee=!0},function(a){e.endpoint("/apelApplications/"+b.application.id+"/sendToConfirm/").put({student:b.application.student,isVocational:b.application.isVocational,records:b.application.records,committeeId:b.application.committeeId,addInfo:a.reason},function(a){k.info("apel.messages.sentToConfirm"),n(a)})}):j.confirmDialog({prompt:"apel.sendToConfirmConfirm"},function(){e.endpoint("/apelApplications/"+b.application.id+"/sendToConfirm/").put({student:b.application.student,isVocational:b.application.isVocational,records:b.application.records,committeeId:b.application.committeeId},function(a){k.info("apel.messages.sentToConfirm"),n(a)})})}function p(){for(var a=0;a<b.application.records.length;a++)for(var c=0;c<b.application.records[a].data.length;c++)if(b.application.records[a].data[c].transfer)return!0;return!1}b.applicationId=c.current.params.id,b.auth=c.current.locals.auth,b.application={},b.formState={},b.formState.viewForm=!0,b.getUrl=f.getUrl;var q=c.current.locals.entity;angular.isDefined(q)?n(q):(b.application.insertedBy=b.auth.fullname,b.application.inserted=new Date,b.application.status="VOTA_STAATUS_K"),b.applicationPdfUrl=l.apiUrl+"/apelApplications/print/"+b.application.id+"/application.pdf",b.hideInvalid=function(a){return!h.isValid(a)},b.removeConfirmation=function(){j.confirmDialog({prompt:"apel.removeConfirmationConfirm"},function(){e.endpoint("/apelApplications/"+b.application.id+"/removeConfirmation/").put({},function(a){k.info("apel.messages.removedConfirmation"),n(a)})})},b.sendBackToCreation=function(){"VOTA_STAATUS_V"===b.application.status?j.showDialog("apelApplication/templates/reason.dialog.html",function(a){a.sendBackToCreation=!0,a.committee=!0},function(a){e.endpoint("/apelApplications/"+b.application.id+"/sendBackToCreation/").put({addInfo:a.reason},function(a){k.info("apel.messages.sentBackToCreation"),n(a)})}):j.confirmDialog({prompt:"apel.sendBackToCreationConfirm"},function(){e.endpoint("/apelApplications/"+b.application.id+"/sendBackToCreation/").put({},function(a){k.info("apel.messages.sentBackToCreation"),n(a)})})},b.sendToConfirm=function(){p()?(m(i,b.application.records),o()):k.error("apel.error.atLeastOneLearningMustBeTransferred")},b.sendToCommittee=function(){m(i,b.application.records),j.confirmDialog({prompt:"apel.sendToCommitteeConfirm"},function(){e.endpoint("/apelApplications/"+b.application.id+"/sendToCommittee/").put({student:b.application.student,isVocational:b.application.isVocational,records:b.application.records,committeeId:b.application.committeeId},function(a){k.info("apel.messages.sentToCommittee"),n(a)})})},b.confirm=function(){p()?j.confirmDialog({prompt:"apel.confirmConfirm"},function(){e.endpoint("/apelApplications/"+b.application.id+"/confirm/").put({},function(a){k.info("apel.messages.confirmed"),n(a)})}):k.error("apel.error.atLeastOneLearningMustBeTransferred")},b.sendBack=function(){j.confirmDialog({prompt:"apel.sendBackConfirm"},function(){e.endpoint("/apelApplications/"+b.application.id+"/sendBack/").put({},function(a){k.info("apel.messages.sentBack"),n(a)})})},b.reject=function(){j.showDialog("apelApplication/templates/reason.dialog.html",function(a){a.rejection=!0,a.committee="VOTA_STAATUS_V"===b.application.status},function(a){e.endpoint("/apelApplications/"+b.application.id+"/reject/").put({addInfo:a.reason},function(a){n(a)})})},b.removeConfirmation=function(){j.confirmDialog({prompt:"apel.removeConfirmationConfirm"},function(){e.endpoint("/apelApplications/"+b.application.id+"/removeConfirmation/").put({},function(a){k.info("apel.messages.removedConfirmation"),n(a)})})}}])}(),angular.module("hitsaOis").controller("ApelApplicationListController",["$scope","$route","ArrayUtils","QueryUtils","Classifier","$q",function(a,b,c,d,e,f){a.auth=b.current.locals.auth;var g=e.valuemapper({status:"VOTA_STAATUS"});d.createQueryForm(a,"/apelApplications",{order:"student_lastname, student_firstname, inserted desc"}),a.auth.isStudent()&&(a.afterLoadData=function(b){a.tabledata.content=b.content,a.tabledata.totalElements=b.totalElements}),!a.criteria.status&&a.auth.isAdmin()&&(a.criteria.status=["VOTA_STAATUS_E"],c.contains(a.auth.authorizedRoles,"ROLE_OIGUS_M_TEEMAOIGUS_VOTAKOM")&&a.criteria.status.push("VOTA_STAATUS_V")),f.all(g.promises).then(a.loadData),a.$watch("criteria.studentObject",function(){a.criteria.student=a.criteria.studentObject?a.criteria.studentObject.id:null}),a.$watch("criteria.committeeObject",function(){a.criteria.committee=a.criteria.committeeObject?a.criteria.committeeObject.id:null})}]),angular.module("hitsaOis").controller("ApelSchoolListController",["$scope","QueryUtils","$q",function(a,b,c){b.createQueryForm(a,"/apelSchool",{order:"en"===a.currentLanguage()?"nameEn":"nameEt"}),c.all().then(a.loadData)}]).controller("ApelSchoolEditController",["$scope","$route","dialogService","message","ArrayUtils","QueryUtils","$location","Classifier",function(a,b,c,d,e,f,g,h){function i(b){f.endpoint(k+"/usedEhisSchoolCodes").query().$promise.then(function(c){e.remove(c,b),a.usedEhisSchoolCodes=c})}var j=b.current.params.id,k="/apelSchool",l=f.endpoint(k);j?(a.apelSchool=l.get({id:j}),a.apelSchool.$promise.then(function(){i(a.apelSchool.ehisSchool)})):(a.apelSchool=new l,i()),a.update=function(){return a.apelSchoolForm.$setSubmitted(),a.apelSchoolForm.$valid?void(a.apelSchool.id?a.apelSchool.$update().then(d.updateSuccess):a.apelSchool.$save().then(function(){d.info("main.messages.create.success"),g.url("apelSchools/"+a.apelSchool.id+"/edit")})):void d.error("main.messages.form-has-errors")},a.ehisSchoolChanged=function(b){h.get(b).$promise.then(function(b){a.apelSchool.nameEt=b.nameEt,a.apelSchool.nameEn=b.nameEn})},a.countryChanged=function(){a.apelSchool.ehisSchool=null},a["delete"]=function(){c.confirmDialog({prompt:"apel.apelSchool.deleteConfirm"},function(){a.apelSchool.$delete().then(function(){d.info("main.messages.delete.success"),g.url("/apelSchools")})})}}]),angular.module("hitsaOis").config(["$routeProvider","USER_ROLES",function(a,b){a.when("/apelApplication",{templateUrl:"apelApplication/apel.application.list.html",controller:"ApelApplicationListController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_VOTA,b.ROLE_OIGUS_V_TEEMAOIGUS_VOTAKOM]}}).when("/apelApplication/new",{templateUrl:"apelApplication/apel.application.edit.html",controller:"ApelApplicationEditController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],isCreate:function(){return!0}},data:{authorizedRoles:function(a,c){return-1!==c.indexOf(b.ROLE_OIGUS_M_TEEMAOIGUS_VOTA)||"ROLL_A"!==a.roleCode&&-1!==c.indexOf(b.ROLE_OIGUS_V_TEEMAOIGUS_VOTA)}}}).when("/apelApplication/:id/edit",{templateUrl:"apelApplication/apel.application.edit.html",controller:"ApelApplicationEditController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],entity:["QueryUtils","$route",function(a,b){return a.endpoint("/apelApplications").get({id:b.current.params.id}).$promise}]},data:{authorizedRoles:function(a,c){return-1!==c.indexOf(b.ROLE_OIGUS_M_TEEMAOIGUS_VOTAKOM)||-1!==c.indexOf(b.ROLE_OIGUS_M_TEEMAOIGUS_VOTA)||"ROLL_A"!==a.roleCode&&-1!==c.indexOf(b.ROLE_OIGUS_V_TEEMAOIGUS_VOTA)}}}).when("/apelApplication/:id/view",{templateUrl:"apelApplication/apel.application.view.html",controller:"ApelApplicationViewController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],entity:["QueryUtils","$route",function(a,b){return a.endpoint("/apelApplications").get({id:b.current.params.id}).$promise}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_VOTA,b.ROLE_OIGUS_V_TEEMAOIGUS_VOTAKOM]}}).when("/apelSchools",{templateUrl:"apelApplication/apel.school.list.html",controller:"ApelSchoolListController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:function(a,c){return"ROLL_A"===a.roleCode&&-1!==c.indexOf(b.ROLE_OIGUS_V_TEEMAOIGUS_VOTA)}}}).when("/apelSchools/:id/edit",{templateUrl:"apelApplication/apel.school.edit.html",controller:"ApelSchoolEditController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_VOTA]}}).when("/apelSchools/new",{templateUrl:"apelApplication/apel.school.edit.html",controller:"ApelSchoolEditController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:function(a,c){return"ROLL_A"===a.roleCode&&-1!==c.indexOf(b.ROLE_OIGUS_M_TEEMAOIGUS_VOTA)}}})}]),function(){function a(a,g,h,i){if(a.reportData=i,a.reportData.teacherCapacities=[],a.months={},a.entriesWithoutCapacity=!1,i.criteria.byCapacities&&b(a,h),a.plannedLessonsColspan=i.criteria.showPlannedLessons?a.reportData.teacherCapacities.length||1:0,a.journalOccurredLessonsColspan=0,i.criteria.isHigher||(a.journalOccurredLessonsColspan=(a.reportData.teacherCapacities.length||1)+(a.entriesWithoutCapacity?1:0)),a.timetableOccurredLessonsColspan=0,(i.criteria.isHigher||i.criteria.showTimetableLoad)&&(a.timetableOccurredLessonsColspan=(a.reportData.teacherCapacities.length||1)+(a.entriesWithoutCapacity?1:0)+(i.criteria.showSingleEvents?1:0)+1),a.periodColspan=a.plannedLessonsColspan+a.journalOccurredLessonsColspan+a.timetableOccurredLessonsColspan,a.totalsColspan=a.periodColspan+(a.reportData.criteria.byCapacities?1:0)+1,a.periodTypesRow=[],a.periodCapacitiesRow=[],i.criteria.byStudyPeriods||i.criteria.isHigher)i.criteria.studyPeriod&&(i.studyPeriods=i.studyPeriods.filter(function(a){return a.id===i.criteria.studyPeriod})),d(a,i);else if(i.criteria.byWeeks){if(i.criteria.studyPeriod){var j=i.studyPeriods=i.studyPeriods.filter(function(a){return a.id===i.criteria.studyPeriod})[0];a.weekNrs=j.weekNrs}else a.weekNrs=i.weekNrs.filter(function(a,b,c){return c.indexOf(a)===b});e(a,i)}else i.criteria.byMonths&&(c(a,g,i.months),f(a,i))}function b(a,b){var c=[];b.forEach(function(b){b.teacherCapacities&&b.teacherCapacities.forEach(function(b){b!==j&&-1===c.indexOf(b)&&c.push(b),b===j&&(a.entriesWithoutCapacity=!0)})});var d=[];c.forEach(function(b){d.push(a.capacityTypes[b])}),d.sort(function(a,b){return a=a.value.toUpperCase(),b=b.value.toUpperCase(),a>b?1:b>a?-1:0}),a.reportData.teacherCapacities=d}function c(a,b,c){var d=[];c.forEach(function(a){d.push({index:a,name:b[g(a)]})}),a.months=d}function d(a,b){b.studyPeriods.forEach(function(c){h(a,c.id,b.criteria)}),b.studyPeriods.forEach(function(c){i(a,c.id,b.criteria,b.teacherCapacities)})}function e(a,b){a.weekNrs.forEach(function(c){h(a,c,b.criteria)}),a.weekNrs.forEach(function(c){i(a,c,b.criteria,b.teacherCapacities)})}function f(a,b){a.months.forEach(function(c){h(a,c.index,b.criteria)}),a.months.forEach(function(c){i(a,c.index,b.criteria,b.teacherCapacities)})}function g(a){return 0!==a?a-1:12}function h(a,b,c){c.showPlannedLessons&&a.periodTypesRow.push({index:b,plannedLessons:!0,colspan:a.plannedLessonsColspan}),c.isHigher||a.periodTypesRow.push({index:b,journalOccurredLessons:!0,colspan:a.journalOccurredLessonsColspan,divider:!c.showTimetableLoad}),(c.isHigher||c.showTimetableLoad)&&a.periodTypesRow.push({index:b,timetableOccurredLessons:!0,colspan:a.timetableOccurredLessonsColspan,divider:!0})}function i(a,b,c,d){c.byCapacities?(c.showPlannedLessons&&(a.periodCapacitiesRow=a.periodCapacitiesRow.concat(d.map(function(a){return{index:b,plannedLessons:!0,value:a.value,code:a.code}})),0===d.length&&a.periodCapacitiesRow.push({})),c.isHigher||(0===d.length&&a.periodCapacitiesRow.push({divider:!a.entriesWithoutCapacity&&!c.showTimetableLoad}),a.periodCapacitiesRow=a.periodCapacitiesRow.concat(d.map(function(a){return{index:b,journalOccurredLessons:!0,value:a.value,code:a.code}})),a.entriesWithoutCapacity?a.periodCapacitiesRow.push({index:b,value:j,code:j,journalOccurredLessons:!0,divider:!c.showTimetableLoad}):0!==d.length&&(a.periodCapacitiesRow[a.periodCapacitiesRow.length-1].divider=!c.showTimetableLoad)),(c.isHigher||c.showTimetableLoad)&&(0===d.length&&a.periodCapacitiesRow.push({}),a.periodCapacitiesRow=a.periodCapacitiesRow.concat(d.map(function(a){return{index:b,timetableOccurredLessons:!0,value:a.value,code:a.code}})),a.entriesWithoutCapacity&&a.periodCapacitiesRow.push({index:b,value:j,code:j,timetableOccurredLessons:!0}))):(c.showPlannedLessons&&a.periodCapacitiesRow.push({index:b,name:"study",plannedLessons:!0}),c.isHigher||a.periodCapacitiesRow.push({index:b,name:"study",journalOccurredLessons:!0,divider:!c.isHigher&&!c.showTimetableLoad}),(c.isHigher||c.showTimetableLoad)&&a.periodCapacitiesRow.push({index:b,name:"study",timetableOccurredLessons:!0})),(c.isHigher||c.showTimetableLoad)&&a.periodCapacitiesRow.push({index:b,name:"substitute",substitutableEvents:!0,divider:!c.showSingleEvents}),c.showSingleEvents&&a.periodCapacitiesRow.push({index:b,name:"singleEvent",singleEvent:!0,divider:!0})}var j="?";angular.module("hitsaOis").controller("ReportTeacherDetailLoadVocationalController",["$scope","$route","Classifier","DataUtils","FormUtils","QueryUtils","dialogService","MONTH",function(b,c,d,e,f,g,h,i){function j(){b.content=b.tabledata.content,g.endpoint("/reports/teachers/detailload/data").get(b.criteria).$promise.then(function(c){e.convertStringToDates(c.criteria,["from","thru"]);var d=b.tabledata?b.tabledata.content:null;a(b,i,d,c),b.reportData.byTeachers=!0,b.$broadcast("refreshFixedColumns"),g.loadingWheel(b,!1)})}b.auth=c.current.locals.auth;var k="/reports/teachers/detailload/vocational";d.queryForDropdown({mainClassCode:"MAHT"},function(a){b.capacityTypes=d.toMap(a)}),b.formState={studyYears:g.endpoint("/autocomplete/studyYears").query(),allStudyPeriods:g.endpoint("/autocomplete/studyPeriods").query(),studyPeriods:{},xlsUrl:"reports/teachers/detailload/teachersdetailload.xlsx"},g.createQueryForm(b,k,{},j),b.$watch("criteria.studyYear",function(){var a=b.formState.studyYears.filter(function(a){return a.id===b.criteria.studyYear})[0];if(b.criteria.studyPeriod){var c=b.formState.studyPeriods[b.criteria.studyYear]||[],d=c.filter(function(a){return a.id===b.criteria.studyPeriod}).length>0;d||(b.criteria.studyPeriod=null)}b.criteria.studyYearStart=a?a.startDate:null,b.criteria.studyYearEnd=a?a.endDate:null}),b.$watch("criteria.studyPeriod",function(){var a=b.formState.allStudyPeriods.filter(function(a){return a.id===b.criteria.studyPeriod})[0];b.criteria.studyPeriodStart=a?a.startDate:null,b.criteria.studyPeriodEnd=a?a.endDate:null}),b.formState.studyYears.$promise.then(function(){if(b.formState.allStudyPeriods.$promise.then(function(a){for(var c=0;c<a.length;c++){var d=a[c],e=b.formState.studyPeriods[d.studyYear];e||(b.formState.studyPeriods[d.studyYear]=e=[]),e.push(d)}}),!b.criteria.studyYear){var a=e.getCurrentStudyYearOrPeriod(b.formState.studyYears);a&&(b.criteria.studyYear=a.id)}}),b.periodChanged=function(a){switch(a){case"byStudyPeriods":b.criteria.byWeeks=!1,b.criteria.byMonths=!1;break;case"byWeeks":b.criteria.byStudyPeriods=!1,b.criteria.byMonths=!1;break;case"byMonths":b.criteria.byStudyPeriods=!1,b.criteria.byWeeks=!1}},b.dateFromThruChange=function(){(b.criteria.from||b.criteria.thru)&&(b.criteria.byStudyPeriods=!1,b.criteria.byWeeks=!1)},b.studyPeriodChanged=function(){b.criteria.studyPeriod&&(b.criteria.byMonths=!1)},b.showTimetableLoadChanged=function(){b.criteria.showTimetableLoad||(b.criteria.showSingleEvents=!1)},b.excelUrl=function(){return b.criteria.isHigher=!1,b.excel(b.formState.xlsUrl,b.criteria)};var l=b.loadData;b.loadData=function(){b.criteria.isHigher=!1,f.withValidForm(b.searchForm,function(){g.loadingWheel(b,!0),l()})},b.teacherJournalsDialog=function(c){h.showDialog("report/teachers.detail.load.teacher.dialog.tmpl.html",function(d){d.teacher=c,d.criteria=angular.copy(b.reportData.criteria),d.criteria.showSingleEvents=!1,d.capacityTypes=b.capacityTypes,d.xlsUrl="reports/teachers/detailload/teacher/"+c.id+"/teachersdetailload.xlsx",g.endpoint(k+"/"+d.teacher.id).get(d.criteria).$promise.then(function(b){d.content=b.journalSubjects,g.endpoint("/reports/teachers/detailload/data").get(d.criteria).$promise.then(function(c){e.convertStringToDates(c.criteria,["from","thru"]);var f=[];f.push(b),a(d,i,f,c),d.reportData.byJournals=!0,d.$broadcast("refreshFixedColumns")})})})}}]).controller("ReportTeacherDetailLoadHigherController",["$scope","$route","Classifier","DataUtils","FormUtils","QueryUtils","dialogService",function(b,c,d,e,f,g,h){function i(){b.content=b.tabledata.content,g.endpoint("/reports/teachers/detailload/data").get(b.criteria).$promise.then(function(c){var d=b.tabledata?b.tabledata.content:null;a(b,null,d,c),b.reportData.byTeachers=!0,b.$broadcast("refreshFixedColumns"),g.loadingWheel(b,!1)})}b.auth=c.current.locals.auth;var j="/reports/teachers/detailload/higher";d.queryForDropdown({mainClassCode:"MAHT"},function(a){b.capacityTypes=d.toMap(a)}),b.formState={studyYears:g.endpoint("/autocomplete/studyYears").query(),allStudyPeriods:g.endpoint("/autocomplete/studyPeriods").query(),studyPeriods:{},xlsUrl:"reports/teachers/detailload/teachersdetailload.xlsx"},g.createQueryForm(b,j,{},i),b.$watch("criteria.studyYear",function(){var a=b.formState.studyYears.filter(function(a){return a.id===b.criteria.studyYear})[0];if(b.criteria.studyPeriod){var c=b.formState.studyPeriods[b.criteria.studyYear]||[],d=c.filter(function(a){return a.id===b.criteria.studyPeriod}).length>0;d||(b.criteria.studyPeriod=null)}b.criteria.studyYearStart=a?a.startDate:null,b.criteria.studyYearEnd=a?a.endDate:null}),b.$watch("criteria.studyPeriod",function(){var a=b.formState.allStudyPeriods.filter(function(a){return a.id===b.criteria.studyPeriod})[0];b.criteria.studyPeriodStart=a?a.startDate:null,b.criteria.studyPeriodEnd=a?a.endDate:null}),b.formState.studyYears.$promise.then(function(){if(b.formState.allStudyPeriods.$promise.then(function(a){for(var c=0;c<a.length;c++){var d=a[c],e=b.formState.studyPeriods[d.studyYear];e||(b.formState.studyPeriods[d.studyYear]=e=[]),e.push(d)}}),!b.criteria.studyYear){var a=e.getCurrentStudyYearOrPeriod(b.formState.studyYears);a&&(b.criteria.studyYear=a.id)}}),b.periodChanged=function(a){switch(a){case"byStudyPeriods":b.criteria.byWeeks=!1,b.criteria.byMonths=!1;break;case"byWeeks":b.criteria.byStudyPeriods=!1,b.criteria.byMonths=!1;break;case"byMonths":b.criteria.byStudyPeriods=!1,b.criteria.byWeeks=!1}},b.excelUrl=function(){return b.criteria.isHigher=!0,b.excel(b.formState.xlsUrl,b.criteria)};var k=b.loadData;b.loadData=function(){b.criteria.isHigher=!0,f.withValidForm(b.searchForm,function(){g.loadingWheel(b,!0),k()})},b.teacherSubjectsDialog=function(c){h.showDialog("report/teachers.detail.load.teacher.dialog.tmpl.html",function(d){d.teacher=c,d.criteria=angular.copy(b.reportData.criteria),d.criteria.showSingleEvents=!1,d.capacityTypes=b.capacityTypes,d.xlsUrl="reports/teachers/detailload/teacher/"+c.id+"/teachersdetailload.xlsx",g.endpoint(j+"/"+d.teacher.id).get(d.criteria).$promise.then(function(b){d.content=b.journalSubjects,g.endpoint("/reports/teachers/detailload/data").get(d.criteria).$promise.then(function(c){var e=[];e.push(b),a(d,null,e,c),d.reportData.byStudyPeriods=!0,d.$broadcast("refreshFixedColumns")})})})}}])}(),angular.module("hitsaOis").controller("ReportStudentController",["$q","$scope","$route","Classifier","QueryUtils",function(a,b,c,d,e){function f(a){return h.objectmapper(a),{certificateNr:a.certificateNr,occupation:a.specialityCode||a.partOccupationCode||a.occupationCode}}function g(a){i.objectmapper(a);for(var b=0,c=a.length;c>b;b++)a[b].occupationCertificates=(a[b].occupationCertificates||[]).map(f)}b.auth=c.current.locals.auth;var h=d.valuemapper({occupationCode:"KUTSE",partOccupationCode:"OSAKUTSE",specialityCode:"SPETSKUTSE"}),i=d.valuemapper({dormitory:"YHISELAMU",fin:"FINALLIKAS",finSpecific:"FINTAPSUSTUS",language:"OPPEKEEL",studyLevel:"OPPEASTE",studyForm:"OPPEVORM",studyLoad:"OPPEKOORMUS",status:"OPPURSTAATUS"});e.createQueryForm(b,"/reports/students",{order:"p.lastname,p.firstname",isHigher:b.auth.higher},g),b.directiveControllers=[];var j=b.clearCriteria;b.clearCriteria=function(){j(),b.criteria.isHigher=b.auth.higher,b.directiveControllers.forEach(function(a){a.clear()})},b.formState={xlsUrl:"reports/students/students.xls"},b.curriculumVersionChanged=function(){b.studentGroupName=null,b.criteria.studentGroup=null},a.all(h.promises).then(function(){a.all(i.promises).then(b.loadData)})}]).controller("ReportStudentStatisticsController",["$scope","Classifier","QueryUtils","message",function(a,b,c,d){a.formState={xlsUrl:"reports/students/statistics/studentstatistics.xls",filterValues:{OPPURSTAATUS:["OPPURSTAATUS_K","OPPURSTAATUS_L"]}},c.createQueryForm(a,"/reports/students/statistics",{order:"en"===a.currentLanguage()?"c.nameEn":"c.nameEt",result:"OPPEVORM"},function(){var c=a.criteria.result;if(a.savedCriteria=angular.copy(a.criteria),a.formState.resultType!==c)if(a.formState.resultType=c,c){var d=a.formState.filterValues[c];a.formState.resultDef=b.queryForDropdown({mainClassCode:c,filterValues:d}),"FINALLIKAS"===c&&b.queryForDropdown({mainClassCode:"FINTAPSUSTUS"},function(b){a.formState.resultDef.$promise.then(function(){Array.prototype.push.apply(a.formState.resultDef,b)})})}else a.formState.resultDef=[]}),a.criteria.date=(new Date).withoutTime();var e=a.clearCriteria;a.clearCriteria=function(){e(),a.criteria.curriculum=[]},a.load=function(){return a.searchForm.$valid?void a.loadData():(d.error("main.messages.form-has-errors"),!1)},a.loadData()}]).controller("ReportStudentStatisticsByperiodController",["$scope","$route","Classifier","QueryUtils",function(a,b,c,d){function e(b){if(a.formState.resultDef=[],a.formState.resultType!==b){a.formState.resultType=b;var d=g[b];a.resultDef=d?c.queryForDropdown({mainClassCode:d}):void 0}if(angular.isDefined(a.resultDef)){var e=f();a.resultDef.$promise.then(function(){for(var b=0;b<a.resultDef.length;b++){var c=a.resultDef[b];-1!==e.indexOf(c.code)&&a.formState.resultDef.push(c)}})}}function f(){for(var b=[],c=0;c<a.tabledata.content.length;c++)for(var d=a.tabledata.content[c],e=Object.keys(d.result),f=0;f<e.length;f++){var g=e[f];-1===b.indexOf(g)&&b.push(g)}return b}a.auth=b.current.locals.auth;var g={OPPURSTAATUS_A:"AKADPUHKUS_POHJUS",OPPURSTAATUS_K:"EKSMAT_POHJUS"};a.formState={xlsUrl:"reports/students/statistics/studentstatisticsbyperiod.xls"},d.createQueryForm(a,"/reports/students/statistics/byperiod",{order:"en"===a.currentLanguage()?"c.nameEn":"c.nameEt",result:"OPPURSTAATUS_A"},function(){e(a.criteria.result)}),a.criteria.from=(new Date).withoutTime();var h=a.clearCriteria;a.clearCriteria=function(){h(),a.criteria.curriculum=[]},a.loadData()}]).controller("ReportCurriculumsCompletionController",["$q","$scope","$route","Classifier","QueryUtils",function(a,b,c,d,e){b.auth=c.current.locals.auth;var f=d.valuemapper({studyForm:"OPPEVORM",studyLoad:"OPPEKOORMUS",status:"OPPURSTAATUS"});b.formState={xlsUrl:"reports/curriculums/completion/curriculumscompletion.xls"},b.directiveControllers=[],e.createQueryForm(b,"/reports/curriculums/completion",{order:"p.lastname,p.firstname",isHigher:b.auth.higher},f.objectmapper);var g=b.clearCriteria;b.clearCriteria=function(){g(),b.criteria.isHigher=b.auth.higher,b.directiveControllers.forEach(function(a){a.clear()})},a.all(f.promises).then(b.loadData)}]).controller("ReportTeacherLoadHigherController",["$scope","$route","$timeout","DataUtils","FormUtils","QueryUtils",function(a,b,c,d,e,f){a.auth=b.current.locals.auth,f.createQueryForm(a,"/reports/teachers/load/higher",{order:"p.lastname,p.firstname"});var g=a.loadData;a.loadData=function(){e.withValidForm(a.teacherLoadReportForm,g)},a.formState={studyYears:f.endpoint("/autocomplete/studyYears").query(),studyPeriods:{},xlsUrl:"reports/teachers/load/higher/teachersloadhigher.xls"},a.formState.allStudyPeriods=f.endpoint("/autocomplete/studyPeriods").query(),a.formState.studyYears.$promise.then(function(){if(a.formState.allStudyPeriods.$promise.then(function(b){for(var c=0;c<b.length;c++){var d=b[c],e=a.formState.studyPeriods[d.studyYear];e||(a.formState.studyPeriods[d.studyYear]=e=[]),e.push(d)}}),!a.criteria.studyYear){var b=d.getCurrentStudyYearOrPeriod(a.formState.studyYears);b&&(a.criteria.studyYear=b.id)}a.criteria.studyYear&&c(a.loadData)})}]).controller("ReportTeacherLoadVocationalController",["$scope","$route","$timeout","DataUtils","FormUtils","QueryUtils",function(a,b,c,d,e,f){a.auth=b.current.locals.auth,f.createQueryForm(a,"/reports/teachers/load/vocational",{order:"p.lastname,p.firstname"});var g=a.loadData;a.loadData=function(){e.withValidForm(a.teacherLoadReportForm,g)},a.formState={studyYears:f.endpoint("/autocomplete/studyYears").query(),studyPeriods:{},xlsUrl:"reports/teachers/load/vocational/teachersloadvocational.xls"},a.formState.allStudyPeriods=f.endpoint("/autocomplete/studyPeriods").query(),
a.formState.studyYears.$promise.then(function(){if(a.formState.allStudyPeriods.$promise.then(function(b){for(var c=0;c<b.length;c++){var d=b[c],e=a.formState.studyPeriods[d.studyYear];e||(a.formState.studyPeriods[d.studyYear]=e=[]),e.push(d)}}),!a.criteria.studyYear){var b=d.getCurrentStudyYearOrPeriod(a.formState.studyYears);b&&(a.criteria.studyYear=b.id)}a.criteria.studyYear&&c(a.loadData)})}]).controller("ReportVotaController",["$scope","$timeout","DataUtils","FormUtils","QueryUtils",function(a,b,c,d,e){e.createQueryForm(a,"/reports/vota",{order:"sy.start_date"});var f=a.loadData;a.loadData=function(){d.withValidForm(a.votaReportForm,f)},a.formState={studyYears:e.endpoint("/autocomplete/studyYears").query(),studyPeriods:{}},a.formState.allStudyPeriods=e.endpoint("/autocomplete/studyPeriods").query(),a.formState.studyYears.$promise.then(function(){a.formState.allStudyPeriods.$promise.then(function(d){for(var e,f,g=0;g<d.length;g++)e=d[g],f=a.formState.studyPeriods[e.studyYear],f||(a.formState.studyPeriods[e.studyYear]=f=[]),f.push(e);a.criteria.studyYear||(f=c.getCurrentStudyYearOrPeriod(a.formState.studyYears),f&&(a.criteria.studyYear=f.id,a.criteria.studyPeriod||(e=c.getCurrentStudyYearOrPeriod(a.formState.studyPeriods[f.id]||[]),e&&(a.criteria.studyPeriod=e.id)))),a.criteria.studyYear&&b(a.loadData)})}),a.studyPeriodRows=function(b){var c=1;if(-1!==b)for(var d=a.tabledata.content,e=d[b].studyPeriod.id,f=b+1;f<d.length&&d[f].studyPeriod.id===e;f++)c++;return c},a.studyPeriodVisible=function(b){var c=a.tabledata.content;return 0===b||c[b-1].studyPeriod.id!==c[b].studyPeriod.id}}]).controller("StudentGroupTeacherController",["$httpParamSerializer","$route","$scope","$sessionStorage","$timeout","$window","Classifier","DataUtils","VocationalGradeUtil","QueryUtils","config","dialogService","message",function(a,b,c,d,e,f,g,h,i,j,k,l,m){function n(){c.studentGroupTeacherReportForm&&c.studentGroupTeacherReportForm.$valid?c.search():e(n,200)}function o(){c.criteria.entryTypes=[],angular.forEach(c.criteria.entryType,function(a,b){a&&c.criteria.entryTypes.push(b)})}c.gradeUtil=i,c.auth=b.current.locals.auth;var p="/reports/studentgroupteacher",q=g.valuemapper({grade:"KUTSEHINDAMINE",entryType:"SISSEKANNE"}),r=g.valuemapper({absence:"PUUDUMINE",entryType:"SISSEKANNE"});c.entryTypesOrder=["SISSEKANNE_H","SISSEKANNE_R","SISSEKANNE_O","SISSEKANNE_L","SISSEKANNE_P","SISSEKANNE_T","SISSEKANNE_E","SISSEKANNE_I"],c.entryTypeColors={SISSEKANNE_H:"green-300",SISSEKANNE_R:"indigo-300",SISSEKANNE_O:"teal-300",SISSEKANNE_L:"pink-300"},c.auth.isTeacher()&&(c.teacherId=c.auth.teacher),c.directiveControllers=[],c.formState={showAllParameters:!1,studyYears:j.endpoint("/autocomplete/studyYears").query(),studyPeriods:{},xlsUrl:"reports/studentgroupteacher/studentgroupteacher.xls",pdfUrl:"reports/studentgroupteacher/studentgroupteacher.pdf",negativeResultsPdfUrl:"reports/studentgroupteacher/negativeresults.pdf",negativeResultsXlsUrl:"reports/studentgroupteacher/negativeresults.xls"},c.auth.isTeacher()&&j.endpoint("/autocomplete/studentgroups").query({valid:!0,higher:!1,studentGroupTeacherId:c.auth.teacher}).$promise.then(function(a){c.formState.studentGroups=a,c.criteria.studentGroup||(c.criteria.studentGroup=1===a.length?a[0].id:null)}),c.pdf=function(b,c){return k.apiUrl+"/"+b+"?"+a(c)},c.fromStorage=function(a){return JSON.parse(d[a]||"{}")},c.toStorage=function(a,b){d[a]=JSON.stringify(b)},"_menu"in b.current.params||(c.storedCriteria=c.fromStorage(p)),!c.storedCriteria||angular.equals({},c.storedCriteria)?(c.criteria={entryType:{SISSEKANNE_H:!0,SISSEKANNE_R:!0,SISSEKANNE_O:!0,SISSEKANNE_L:!0}},o()):(c.criteria=c.storedCriteria,c.formState.studyPeriod=c.storedCriteria.formState.studyPeriod,c.formState.studentGroup=c.storedCriteria.formState.studentGroup,c.formState.student=c.storedCriteria.formState.student,o(),c.formState.studentGroup&&(c.criteria.studyYear||c.criteria.from)&&e(n)),g.queryForDropdown({mainClassCode:"SISSEKANNE"},function(a){var b=g.toMap(a);c.entryTypes=Object.keys(b).map(function(a){return b[a]})}),c.getEntryColor=function(a){return c.entryTypeColors[a]},c.getEntryTypeOrderNr=function(a){return c.entryTypesOrder.indexOf(a.code)},c.formState.allStudyPeriods=j.endpoint("/autocomplete/studyPeriods").query(),c.formState.studyYears.$promise.then(function(){c.formState.allStudyPeriods.$promise.then(function(a){for(var b,d,e=0;e<a.length;e++)b=a[e],d=c.formState.studyPeriods[b.studyYear],d||(c.formState.studyPeriods[b.studyYear]=d=[]),d.push(b);c.criteria.studyYear||(d=h.getCurrentStudyYearOrPeriod(c.formState.studyYears),d&&(c.criteria.studyYear=d.id))})}),c.studyPeriodChanged=function(){c.criteria.studyPeriod=c.formState.studyPeriod?c.formState.studyPeriod.id:null,c.criteria.studyPeriodStart=c.formState.studyPeriod?c.formState.studyPeriod.startDate:null,c.criteria.studyPeriodEnd=c.formState.studyPeriod?c.formState.studyPeriod.endDate:null},c.studentGroupChanged=function(){c.criteria.studentGroup=c.formState.studentGroup?c.formState.studentGroup.id:null,c.criteria.curriculumVersion=c.formState.studentGroup?c.formState.studentGroup.curriculumVersion:null,c.criteria.student=null,c.formState.student=null},c.studentChanged=function(){c.criteria.student=c.formState.student?c.formState.student.id:null},c.entryTypeChanged=function(){o()},c.negativeResultsChanged=function(){c.criteria.negativeResults&&(c.criteria.journalsWithEntries=!0)},c.onlyModuleGradesChanged=function(){c.criteria.onlyModuleGrades&&(c.criteria.moduleGrade=!0)},c.toggleShowAllParameters=function(){c.formState.showAllParameters=!c.formState.showAllParameters,c.$broadcast("refreshFixedTableHeight")},c.search=function(){var a=c.studentGroupTeacherReportForm;return a.$setSubmitted(),a.$valid?c.criteria.studyYear||c.criteria.from?(j.loadingWheel(c,!0),void j.endpoint(p).get(c.criteria).$promise.then(function(a){c.record=a,c.record.students.forEach(function(a){a.resultColumns.forEach(function(a){a.journalResult&&(a.journalResult.results&&q.objectmapper(a.journalResult.results),a.journalResult.absences&&r.objectmapper(a.journalResult.absences)),a.practiceModuleThemeResult&&q.objectmapper(a.practiceModuleThemeResult),a.practiceModuleResult&&q.objectmapper(a.practiceModuleResult),a.moduleResult&&q.objectmapper(a.moduleResult)})}),c.tableTotalColumnsColspan=6+(c.record.showAverageGrade?1:0)+(c.record.showWeightedAverageGrade?1:0),j.loadingWheel(c,!1),c.criteria.formState={studyPeriod:c.formState.studyPeriod,studentGroup:c.formState.studentGroup},c.formState.showAllParameters=!1,c.toStorage(p,c.criteria),c.$broadcast("refreshFixedColumns")})):void m.error("report.studentGroupTeacher.error.studyYearOrEntriesFromRequired"):void m.error("main.messages.form-has-errors")},c.clearCriteria=function(){c.formState.showAllParameters=!0,c.formState.studyPeriod=null,c.formState.studentGroup=null,c.criteria={},c.directiveControllers.forEach(function(a){a.clear()})},c.windowHeight=function(){return f.innerHeight},c.filterOnlyModuleGrades=function(a){return c.record.showOnlyModuleGrades?a.module||a.moduleResult:!0},c.filterAbsences=function(a){return function(b){return b.absence.code===a}},c.openRemarkDialog=function(a){l.showDialog("report/studentgroup.teacher.remark.dialog.html",function(b){b.auth=c.auth,b.student=a})}}]).controller("ScholarshipStatisticsController",["$scope","Classifier","$route",function(a,b,c){var d=c.current.locals.auth;a.criteria={},a.url="reports/scholarships/statistics.xlsx",a.types=b.queryForDropdown({mainClassCode:"STIPTOETUS"}),a.types.$promise.then(function(b){a.types=b.filter(function(a){return d.vocational&&a.vocational||d.higher&&a.higher})})}]).controller("IndividualCurriculumStatisticsController",["$route","$scope","DataUtils","FormUtils","QueryUtils",function(a,b,c,d,e){b.auth=a.current.locals.auth,b.teacherId=b.auth.teacher,b.criteria={};var f="/reports/individualcurriculumstatistics";e.createQueryForm(b,f,{order:"lastname, firstname"}),b.formState={studyYears:e.endpoint("/autocomplete/studyYears").query(),xlsUrl:"reports/individualcurriculumstatistics.xls"},b.formState.studyYears.$promise.then(function(){if("_menu"in a.current.params&&!b.criteria.from&&!b.criteria.thru){var d=c.getCurrentStudyYearOrPeriod(b.formState.studyYears);c.convertStringToDates(d,["from","thru"]),d&&(b.criteria.from=d?d.startDate:null,b.criteria.thru=d?d.endDate:null)}b.loadData()}),b.auth.isTeacher()&&e.endpoint("/autocomplete/studentgroups").query({valid:!0,higher:!1,studentGroupTeacherId:b.auth.teacher}).$promise.then(function(a){b.formState.studentGroups=a,b.criteria.studentGroup||(b.criteria.studentGroup=1===a.length?a[0].id:null)}),b.$watch("criteria.studentObject",function(){b.criteria.student=b.criteria.studentObject?b.criteria.studentObject.id:null});var g=b.loadData;b.loadData=function(){d.withValidForm(b.searchForm,g)},b.directiveControllers=[];var h=b.clearCriteria;b.clearCriteria=function(){h(),b.directiveControllers.forEach(function(a){a.clear()})}}]),angular.module("hitsaOis").config(["$routeProvider","USER_ROLES",function(a,b){a.when("/reports/students/students",{templateUrl:"report/student.html",controller:"ReportStudentController",controllerAs:"controller",data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_PARING]},resolve:{auth:["AuthResolver",function(a){return a.resolve()}],translationLoaded:["$translate",function(a){return a.onReady()}]}}).when("/reports/students/statistics",{templateUrl:"report/student.statistics.html",controller:"ReportStudentStatisticsController",controllerAs:"controller",data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_PARING]},resolve:{auth:["AuthResolver",function(a){return a.resolve()}],translationLoaded:["$translate",function(a){return a.onReady()}]}}).when("/reports/students/statistics/byperiod",{templateUrl:"report/student.statistics.byperiod.html",controller:"ReportStudentStatisticsByperiodController",controllerAs:"controller",data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_PARING]},resolve:{auth:["AuthResolver",function(a){return a.resolve()}],translationLoaded:["$translate",function(a){return a.onReady()}]}}).when("/reports/curriculums/completion",{templateUrl:"report/curriculums.completion.html",controller:"ReportCurriculumsCompletionController",controllerAs:"controller",data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_PARING]},resolve:{auth:["AuthResolver",function(a){return a.resolve()}],translationLoaded:["$translate",function(a){return a.onReady()}]}}).when("/reports/teachers/load/higher",{templateUrl:"report/teachers.load.higher.html",controller:"ReportTeacherLoadHigherController",data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_PARING]},resolve:{auth:["AuthResolver",function(a){return a.resolve()}],translationLoaded:["$translate",function(a){return a.onReady()}]}}).when("/reports/teachers/load/vocational",{templateUrl:"report/teachers.load.vocational.html",controller:"ReportTeacherLoadVocationalController",controllerAs:"controller",data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_PARING]},resolve:{auth:["AuthResolver",function(a){return a.resolve()}],translationLoaded:["$translate",function(a){return a.onReady()}]}}).when("/reports/teachers/detailload/vocational",{templateUrl:"report/teachers.detail.load.vocational.html",controller:"ReportTeacherDetailLoadVocationalController",controllerAs:"controller",data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_PARING]},resolve:{auth:["AuthResolver",function(a){return a.resolve()}],translationLoaded:["$translate",function(a){return a.onReady()}]}}).when("/reports/teachers/detailload/higher",{templateUrl:"report/teachers.detail.load.higher.html",controller:"ReportTeacherDetailLoadHigherController",controllerAs:"controller",data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_PARING]},resolve:{auth:["AuthResolver",function(a){return a.resolve()}],translationLoaded:["$translate",function(a){return a.onReady()}]}}).when("/reports/vota",{templateUrl:"report/vota.html",controller:"ReportVotaController",controllerAs:"controller",data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_PARING]},resolve:{auth:["AuthResolver",function(a){return a.resolve()}],translationLoaded:["$translate",function(a){return a.onReady()}]}}).when("/reports/studentgroupteacher",{templateUrl:"report/studentgroup.teacher.html",controller:"StudentGroupTeacherController",controllerAs:"controller",data:{authorizedRoles:function(a,c){return a.vocational&&-1!==c.indexOf(b.ROLE_OIGUS_V_TEEMAOIGUS_RYHMAJUHATAJA)}},resolve:{auth:["AuthResolver",function(a){return a.resolve()}],translationLoaded:["$translate",function(a){return a.onReady()}]}}).when("/reports/scholarships",{templateUrl:"report/scholarship.statistics.html",controller:"ScholarshipStatisticsController",controllerAs:"controller",resolve:{auth:["AuthResolver",function(a){return a.resolve()}],translationLoaded:["$translate",function(a){return a.onReady()}]},data:{authorizedRoles:function(a,c){return"ROLL_A"===a.roleCode&&-1!==c.indexOf(b.ROLE_OIGUS_V_TEEMAOIGUS_PARING)}}}).when("/reports/individualcurriculum/statistics",{templateUrl:"report/individual.curriculum.statistics.html",controller:"IndividualCurriculumStatisticsController",controllerAs:"controller",data:{authorizedRoles:function(a,c){return a.vocational&&("ROLL_O"===a.roleCode&&-1!==c.indexOf(b.ROLE_OIGUS_V_TEEMAOIGUS_RYHMAJUHATAJA)||"ROLL_A"===a.roleCode&&-1!==c.indexOf(b.ROLE_OIGUS_V_TEEMAOIGUS_INDIVID))}},resolve:{auth:["AuthResolver",function(a){return a.resolve()}],translationLoaded:["$translate",function(a){return a.onReady()}]}})}]),angular.module("hitsaOis").controller("RRChangeLogsController",["$scope","QueryUtils",function(a,b){var c="/logs/rr/changelogs";b.createQueryForm(a,c),angular.extend(a.criteria,{order:"-wrcl.inserted"}),angular.isObject(a.criteria.student)||(a.criteria.student=null),a.loadData()}]),angular.module("hitsaOis").config(["$routeProvider","USER_ROLES",function(a,b){a.when("/rr/changelogs",{templateUrl:"rr/rr.changes.list.html",controller:"RRChangeLogsController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_RR]}})}]),angular.module("hitsaOis").controller("RtipSyncController",["$scope","message","QueryUtils",function(a,b,c){a.criteria={},a.rtipSync=function(){c.endpoint("/logs/rtip/sync").post()},a.rtipZemploees=function(){return a.rtipSyncForm.$setSubmitted(),a.rtipSyncForm.$valid?void c.endpoint("/logs/rtip/zemploees").post(a.criteria):(b.error("main.messages.form-has-errors"),!1)}}]),angular.module("hitsaOis").config(["$routeProvider","USER_ROLES",function(a,b){a.when("/rtip/sync",{templateUrl:"rtip/rtip.sync.html",controller:"RtipSyncController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_ANDMEVAHETUS_RTIP]}})}]),angular.module("hitsaOis").factory("ArrayUtils",function(){return{contains:function(a,b){return-1!==a.indexOf(b)},remove:function(a,b){var c=a.indexOf(b);c>-1&&a.splice(c,1)},isEmpty:function(a){return!angular.isArray(a)||0===a.length},includes:function(a,b,c){if(void 0===c){for(var d=a.length;d--;)if(a[d]===b)return!0}else for(var e=c,f=a.length;e++!==f;)if(a[e]===b)return!0;return!1},intersect:function(a,b){if(this.isEmpty(a)||this.isEmpty(b))return!1;for(var c=0;c<a.length;c++)if(this.includes(b,a[c]))return!0;return!1},intersection:function(a,b){for(var c=[],d=0;d<a.length;d++)this.includes(b,a[d])&&c.push(a[d]);return c}}}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(a){if(null===this)throw new TypeError('"this" is null or not defined');var b=Object(this),c=b.length>>>0;if("function"!=typeof a)throw new TypeError("predicate must be a function");for(var d=arguments[1],e=0;c>e;){var f=b[e];if(a.call(d,f,e,b))return f;e++}return void 0}}),angular.module("hitsaOis").factory("AuthService",["$http","$q","Session","Menu","config","Classifier","$rootScope","USER_CONFIRM_RIGHTS","ArrayUtils",function(a,b,c,d,e,f,g,h,i){var j="Authorization",k={},l=f.valuemapper({role:"ROLL"}),m=function(a){return d.setMenu(a.data),a.data&&a.data.user?(b.all(l.promises).then(function(){l.objectmapper(a.data.users);for(var b=0;b<a.data.users.length;b++){switch(a.data.users[b].nameEt=a.data.users[b].nameEt,a.data.users[b].nameEn=a.data.users[b].nameEn?a.data.users[b].nameEn:a.data.users[b].role.nameEt,a.data.users[b].nameRu=a.data.users[b].role.nameRu,a.data.users[b].role.code){case"ROLL_T":if(a.data.users[b].studentGroup){var c=a.data.users[b].studentGroup.length>12?a.data.users[b].studentGroup.slice(0,13)+"...":a.data.users[b].studentGroup;a.data.users[b].nameEn+=" ("+c+")",a.data.users[b].nameEt+=" ("+c+")",a.data.users[b].nameRu+=" ("+c+")"}break;case"ROLL_L":if(a.data.users[b].studentName){var d=a.data.users[b].studentName.length>12?a.data.users[b].studentName.slice(0,13)+"...":a.data.users[b].studentName;a.data.users[b].nameEn+=" ("+d+")",a.data.users[b].nameEt+=" ("+d+")",a.data.users[b].nameRu+=" ("+d+")"}}a.data.users[b].schoolCode&&(a.data.users[b].nameEn+=" "+a.data.users[b].schoolCode,a.data.users[b].nameEt+=" "+a.data.users[b].schoolCode,a.data.users[b].nameRu+=" "+a.data.users[b].schoolCode)}}),c.create(a.data),a.data):(c.destroy(),null)};return k.login=function(b){return a.get(e.apiUrl+"/user",{headers:b}).then(function(a){return m(a)})},k.loginMobileId=function(b){return a.post(e.apiUrl+"/mIdLogin",{mobileNumber:b}).then(function(a){return{data:a.data,jwt:a.headers(j)}})},k.pollMobileIdStatus=function(b){var c={};return c[j]=b,a.get(e.apiUrl+"/mIdStatus",{headers:c}).then(function(a){return a.data})},k.loginLdap=function(b){return a.post(e.apiUrl+"/ldap",b).then(function(){return k.login()})},k.postLogout=function(){c.destroy(),d.setMenu({}),g.restartTimeoutDialogCounter()},k.logout=function(){return a.post(e.apiUrl+"/logout",{})["finally"](function(){k.postLogout()})},k.changeUser=function(b){return a.post(e.apiUrl+"/changeUser",{id:b}).then(function(a){return m(a)})},k.isAuthenticated=function(){return!!c.userId},k.isAuthorized=function(a){if(k.isAuthenticated()){if(angular.isFunction(a))return a(c,c.authorizedRoles,i);angular.isArray(a)||(a=[a]);for(var b=a.length-1;b>-1;b--)if(-1!==c.authorizedRoles.indexOf(a[b]))return!0}return!1},k.matchesRole=function(a){if(k.isAuthenticated()){angular.isArray(a)||(a=[a]);for(var b=a.length-1;b>-1;b--)if(c.roleCode===a[b])return!0}return!1},k.isValidRolePermission=function(a,b,c){return"OIGUS_K"!==c||-1!==h.indexOf(b)},k}]).factory("AuthInterceptor",["$rootScope","$q","AUTH_EVENTS",function(a,b,c){return{responseError:function(d){return a.$broadcast({401:c.notAuthenticated,403:c.notAuthorized,419:c.sessionTimeout,440:c.sessionTimeout}[d.status],d),b.reject(d)}}}]).factory("AuthResolver",["$q","$rootScope","$route","ArrayUtils","PUBLIC_ROUTES","AUTH_EVENTS","AuthService",function(a,b,c,d,e,f,g){function h(a,b){return function(){return angular.isString(a.roleCode)&&angular.isString(b)&&a.roleCode===b}}function i(){if(!angular.isDefined(c.current.data))return!0;var a=c.current.data.authorizedRoles;return g.isAuthorized(a)}return{resolve:function(){var g=a.defer(),j=b.$watch("state.currentUser",function(a){if(angular.isDefined(a)){if(a)if(i()){var k=angular.extend({},a);k.isMainAdmin=h(a,"ROLL_P"),k.isAdmin=h(a,"ROLL_A"),k.isTeacher=h(a,"ROLL_O"),k.isStudent=h(a,"ROLL_T"),k.isParent=h(a,"ROLL_L"),k.isExternalExpert=h(a,"ROLL_V"),g.resolve(k)}else g.reject(),b.$broadcast(f.notAuthorized);else d.contains(e,c.current.originalPath)?g.resolve():g.reject();j()}});return g.promise}}}]).run(["$rootScope","AUTH_EVENTS","message",function(a,b,c){a.$on(b.notAuthorized,function(){c.error("main.messages.error.nopermission")})}]).constant("AUTH_EVENTS",{loginSuccess:"auth-login-success",loginFailed:"auth-login-failed",logoutSuccess:"auth-logout-success",sessionTimeout:"auth-session-timeout",notAuthenticated:"auth-not-authenticated",notAuthorized:"auth-not-authorized",userChanged:"auth-user-changed",reAuthenticate:"auth-re"}).constant("PUBLIC_ROUTES",["/academicCalendars","/academicCalendar/:schoolId?","/curriculums/:schoolId?","/curriculum/:id","/curriculum/:curriculumId/version/:id","/stateCurriculum/public","/stateCurriculum/public/:id/view","/subject/public","/subject/public/:id","/subjectProgram/public/:subjectProgramId/view","/timetables","/timetable/:schoolId?/generalTimetable/:type","/timetable/:schoolId?/searchGeneralTimetable","/timetable/:schoolId/:type/:typeId/:studyYearId/:weekIndex?","/studyMaterial/:schoolId/vocational/:journalId/view","/studyMaterial/:schoolId/higher/:subjectStudyPeriodId/view","/practiceJournals/supervisor/:uuid","/poll/supervisor/:uuid","/poll/expert/:uuid"]).service("Session",function(){this.school={},this.create=function(a){this.userId=a.user,this.studentId=a.student,this.teacherId=a.teacher,this.isCurriculumTeacher=a.isCurriculumTeacher,this.authorizedRoles=a.authorizedRoles,this.school=angular.extend(this.school||{},a.school),this.roleCode=a.roleCode,this.vocational=a.vocational,this.higher=a.higher,this.timeoutInSeconds=a.sessionTimeoutInSeconds,this.teacherGroupIds=a.teacherGroupIds,this.committees=a.committees||[]},this.destroy=function(){this.userId=null,this.studentId=null,this.teacherId=null,this.isCurriculumTeacher=null,this.authorizedRoles=[],this.school={},this.roleCode=null,this.vocational=void 0,this.higher=void 0,this.timeoutInSeconds=null,this.teacherGroupIds=null,this.committees=[]}}).constant("USER_ROLES",{ROLE_OIGUS_V_TEEMAOIGUS_A:"ROLE_OIGUS_V_TEEMAOIGUS_A",ROLE_OIGUS_V_TEEMAOIGUS_P:"ROLE_OIGUS_V_TEEMAOIGUS_P",ROLE_OIGUS_V_TEEMAOIGUS_AINE:"ROLE_OIGUS_V_TEEMAOIGUS_AINE",ROLE_OIGUS_V_TEEMAOIGUS_AINEOPPETAJA:"ROLE_OIGUS_V_TEEMAOIGUS_AINEOPPETAJA",ROLE_OIGUS_V_TEEMAOIGUS_AKADKALENDER:"ROLE_OIGUS_V_TEEMAOIGUS_AKADKALENDER",ROLE_OIGUS_V_TEEMAOIGUS_ANDMEVAHETUS_EHIS:"ROLE_OIGUS_V_TEEMAOIGUS_ANDMEVAHETUS_EHIS",ROLE_OIGUS_V_TEEMAOIGUS_ANDMEVAHETUS_EKIS:"ROLE_OIGUS_V_TEEMAOIGUS_ANDMEVAHETUS_EKIS",ROLE_OIGUS_V_TEEMAOIGUS_ANDMEVAHETUS_KUTSEREGISTER:"ROLE_OIGUS_V_TEEMAOIGUS_ANDMEVAHETUS_KUTSEREGISTER",ROLE_OIGUS_V_TEEMAOIGUS_ANDMEVAHETUS_RTIP:"ROLE_OIGUS_V_TEEMAOIGUS_ANDMEVAHETUS_RTIP",ROLE_OIGUS_V_TEEMAOIGUS_ANDMEVAHETUS_SAIS:"ROLE_OIGUS_V_TEEMAOIGUS_ANDMEVAHETUS_SAIS",ROLE_OIGUS_V_TEEMAOIGUS_AUTOTEADE:"ROLE_OIGUS_V_TEEMAOIGUS_AUTOTEADE",ROLE_OIGUS_V_TEEMAOIGUS_AVALDUS:"ROLE_OIGUS_V_TEEMAOIGUS_AVALDUS",ROLE_OIGUS_V_TEEMAOIGUS_BAASMOODUL:"ROLE_OIGUS_V_TEEMAOIGUS_BAASMOODUL",ROLE_OIGUS_V_TEEMAOIGUS_DIPLOM:"ROLE_OIGUS_V_TEEMAOIGUS_DIPLOM",ROLE_OIGUS_V_TEEMAOIGUS_DOKALLKIRI:"ROLE_OIGUS_V_TEEMAOIGUS_DOKALLKIRI",ROLE_OIGUS_V_TEEMAOIGUS_EKSAM:"ROLE_OIGUS_V_TEEMAOIGUS_EKSAM",ROLE_OIGUS_V_TEEMAOIGUS_ESINDAVALDUS:"ROLE_OIGUS_V_TEEMAOIGUS_ESINDAVALDUS",ROLE_OIGUS_V_TEEMAOIGUS_ETTEVOTE:"ROLE_OIGUS_V_TEEMAOIGUS_ETTEVOTE",ROLE_OIGUS_V_TEEMAOIGUS_HINNETELEHT:"ROLE_OIGUS_V_TEEMAOIGUS_HINNETELEHT",ROLE_OIGUS_V_TEEMAOIGUS_HINNETELEHT_TRUKKIMINE:"ROLE_OIGUS_V_TEEMAOIGUS_HINNETELEHT_TRUKKIMINE",ROLE_OIGUS_V_TEEMAOIGUS_HOONERUUM:"ROLE_OIGUS_V_TEEMAOIGUS_HOONERUUM",ROLE_OIGUS_V_TEEMAOIGUS_INDIVID:"ROLE_OIGUS_V_TEEMAOIGUS_INDIVID",ROLE_OIGUS_V_TEEMAOIGUS_KASKKIRI:"ROLE_OIGUS_V_TEEMAOIGUS_KASKKIRI",ROLE_OIGUS_V_TEEMAOIGUS_KASUTAJA:"ROLE_OIGUS_V_TEEMAOIGUS_KASUTAJA",ROLE_OIGUS_V_TEEMAOIGUS_KLASSIFIKAATOR:"ROLE_OIGUS_V_TEEMAOIGUS_KLASSIFIKAATOR",ROLE_OIGUS_V_TEEMAOIGUS_KOMISJON:"ROLE_OIGUS_V_TEEMAOIGUS_KOMISJON",ROLE_OIGUS_V_TEEMAOIGUS_KOORM:"ROLE_OIGUS_V_TEEMAOIGUS_KOORM",ROLE_OIGUS_V_TEEMAOIGUS_KYSITLUS:"ROLE_OIGUS_V_TEEMAOIGUS_KYSITLUS",ROLE_OIGUS_V_TEEMAOIGUS_LEPING:"ROLE_OIGUS_V_TEEMAOIGUS_LEPING",ROLE_OIGUS_V_TEEMAOIGUS_LOPBLANKETT:"ROLE_OIGUS_V_TEEMAOIGUS_LOPBLANKETT",ROLE_OIGUS_V_TEEMAOIGUS_LOPDOKALLKIRI:"ROLE_OIGUS_V_TEEMAOIGUS_LOPDOKALLKIRI",ROLE_OIGUS_V_TEEMAOIGUS_LOPMOODULPROTOKOLL:"ROLE_OIGUS_V_TEEMAOIGUS_LOPMOODULPROTOKOLL",ROLE_OIGUS_V_TEEMAOIGUS_LOPPROTOKOLL:"ROLE_OIGUS_V_TEEMAOIGUS_LOPPROTOKOLL",ROLE_OIGUS_V_TEEMAOIGUS_LOPTEEMA:"ROLE_OIGUS_V_TEEMAOIGUS_LOPTEEMA",ROLE_OIGUS_V_TEEMAOIGUS_LOPTUNNISTUS_TRUKKIMINE:"ROLE_OIGUS_V_TEEMAOIGUS_LOPTUNNISTUS_TRUKKIMINE",ROLE_OIGUS_V_TEEMAOIGUS_MARKUS:"ROLE_OIGUS_V_TEEMAOIGUS_MARKUS",ROLE_OIGUS_V_TEEMAOIGUS_MOODULPROTOKOLL:"ROLE_OIGUS_V_TEEMAOIGUS_MOODULPROTOKOLL",ROLE_OIGUS_V_TEEMAOIGUS_OPETAJA:"ROLE_OIGUS_V_TEEMAOIGUS_OPETAJA",ROLE_OIGUS_V_TEEMAOIGUS_OPETAJAAMET:"ROLE_OIGUS_V_TEEMAOIGUS_OPETAJAAMET",ROLE_OIGUS_V_TEEMAOIGUS_OPILASKODU:"ROLE_OIGUS_V_TEEMAOIGUS_OPILASKODU",ROLE_OIGUS_V_TEEMAOIGUS_OPINGUKAVA:"ROLE_OIGUS_V_TEEMAOIGUS_OPINGUKAVA",ROLE_OIGUS_V_TEEMAOIGUS_OPPEASUTUS:"ROLE_OIGUS_V_TEEMAOIGUS_OPPEASUTUS",ROLE_OIGUS_V_TEEMAOIGUS_OPPEKAVA:"ROLE_OIGUS_V_TEEMAOIGUS_OPPEKAVA",ROLE_OIGUS_V_TEEMAOIGUS_OPPEMATERJAL:"ROLE_OIGUS_V_TEEMAOIGUS_OPPEMATERJAL",ROLE_OIGUS_V_TEEMAOIGUS_OPPEPERIOOD:"ROLE_OIGUS_V_TEEMAOIGUS_OPPEPERIOOD",ROLE_OIGUS_V_TEEMAOIGUS_OPPERYHM:"ROLE_OIGUS_V_TEEMAOIGUS_OPPERYHM",ROLE_OIGUS_V_TEEMAOIGUS_OPPETASE:"ROLE_OIGUS_V_TEEMAOIGUS_OPPETASE",ROLE_OIGUS_V_TEEMAOIGUS_OPPETOOGRAAFIK:"ROLE_OIGUS_V_TEEMAOIGUS_OPPETOOGRAAFIK",ROLE_OIGUS_V_TEEMAOIGUS_OPPETOOLIIK:"ROLE_OIGUS_V_TEEMAOIGUS_OPPETOOLIIK",ROLE_OIGUS_V_TEEMAOIGUS_OPPETULEMUS:"ROLE_OIGUS_V_TEEMAOIGUS_OPPETULEMUS",ROLE_OIGUS_V_TEEMAOIGUS_OPPUR:"ROLE_OIGUS_V_TEEMAOIGUS_OPPUR",ROLE_OIGUS_V_TEEMAOIGUS_PAEVIK:"ROLE_OIGUS_V_TEEMAOIGUS_PAEVIK",ROLE_OIGUS_V_TEEMAOIGUS_PARING:"ROLE_OIGUS_V_TEEMAOIGUS_PARING",ROLE_OIGUS_V_TEEMAOIGUS_PILET:"ROLE_OIGUS_V_TEEMAOIGUS_PILET",ROLE_OIGUS_V_TEEMAOIGUS_PRAKTIKAAVALDUS:"ROLE_OIGUS_V_TEEMAOIGUS_PRAKTIKAAVALDUS",ROLE_OIGUS_V_TEEMAOIGUS_PRAKTIKAPAEVIK:"ROLE_OIGUS_V_TEEMAOIGUS_PRAKTIKAPAEVIK",ROLE_OIGUS_V_TEEMAOIGUS_PROTOKOLL:"ROLE_OIGUS_V_TEEMAOIGUS_PROTOKOLL",ROLE_OIGUS_V_TEEMAOIGUS_PRHINDAMISVORM:"ROLE_OIGUS_V_TEEMAOIGUS_PRHINDAMISVORM",ROLE_OIGUS_V_TEEMAOIGUS_PRSTATISTIKA:"ROLE_OIGUS_V_TEEMAOIGUS_PRSTATISTIKA",ROLE_OIGUS_V_TEEMAOIGUS_PUUDUMINE:"ROLE_OIGUS_V_TEEMAOIGUS_PUUDUMINE",ROLE_OIGUS_V_TEEMAOIGUS_RIIKLIKOPPEKAVA:"ROLE_OIGUS_V_TEEMAOIGUS_RIIKLIKOPPEKAVA",ROLE_OIGUS_V_TEEMAOIGUS_RR:"ROLE_OIGUS_V_TEEMAOIGUS_RR",ROLE_OIGUS_V_TEEMAOIGUS_RYHMAJUHATAJA:"ROLE_OIGUS_V_TEEMAOIGUS_RYHMAJUHATAJA",ROLE_OIGUS_V_TEEMAOIGUS_STRUKTUUR:"ROLE_OIGUS_V_TEEMAOIGUS_STRUKTUUR",ROLE_OIGUS_V_TEEMAOIGUS_SYNDMUS:"ROLE_OIGUS_V_TEEMAOIGUS_SYNDMUS",ROLE_OIGUS_V_TEEMAOIGUS_T:"ROLE_OIGUS_V_TEEMAOIGUS_T",ROLE_OIGUS_V_TEEMAOIGUS_TOEND:"ROLE_OIGUS_V_TEEMAOIGUS_TOEND",ROLE_OIGUS_V_TEEMAOIGUS_TUGITEENUS:"ROLE_OIGUS_V_TEEMAOIGUS_TUGITEENUS",ROLE_OIGUS_V_TEEMAOIGUS_TUNDAEG:"ROLE_OIGUS_V_TEEMAOIGUS_TUNDAEG",ROLE_OIGUS_V_TEEMAOIGUS_TUNNIJAOTUSPLAAN:"ROLE_OIGUS_V_TEEMAOIGUS_TUNNIJAOTUSPLAAN",ROLE_OIGUS_V_TEEMAOIGUS_TUNNIPLAAN:"ROLE_OIGUS_V_TEEMAOIGUS_TUNNIPLAAN",ROLE_OIGUS_V_TEEMAOIGUS_UUDE_AASTASSE:"ROLE_OIGUS_V_TEEMAOIGUS_UUDE_AASTASSE",ROLE_OIGUS_V_TEEMAOIGUS_VASTUVOTT:"ROLE_OIGUS_V_TEEMAOIGUS_VASTUVOTT",ROLE_OIGUS_V_TEEMAOIGUS_VOTA:"ROLE_OIGUS_V_TEEMAOIGUS_VOTA",ROLE_OIGUS_V_TEEMAOIGUS_VOTAKOM:"ROLE_OIGUS_V_TEEMAOIGUS_VOTAKOM",ROLE_OIGUS_V_TEEMAOIGUS_YLDTEADE:"ROLE_OIGUS_V_TEEMAOIGUS_YLDTEADE",ROLE_OIGUS_V_TEEMAOIGUS_TEADE:"ROLE_OIGUS_V_TEEMAOIGUS_TEADE",ROLE_OIGUS_V_TEEMAOIGUS_STIPTOETUS:"ROLE_OIGUS_V_TEEMAOIGUS_STIPTOETUS",ROLE_OIGUS_M_TEEMAOIGUS_AINE:"ROLE_OIGUS_M_TEEMAOIGUS_AINE",ROLE_OIGUS_M_TEEMAOIGUS_AINEOPPETAJA:"ROLE_OIGUS_M_TEEMAOIGUS_AINEOPPETAJA",ROLE_OIGUS_M_TEEMAOIGUS_AKADKALENDER:"ROLE_OIGUS_M_TEEMAOIGUS_AKADKALENDER",ROLE_OIGUS_M_TEEMAOIGUS_ANDMEVAHETUS_EHIS:"ROLE_OIGUS_M_TEEMAOIGUS_ANDMEVAHETUS_EHIS",ROLE_OIGUS_M_TEEMAOIGUS_ANDMEVAHETUS_EKIS:"ROLE_OIGUS_M_TEEMAOIGUS_ANDMEVAHETUS_EKIS",ROLE_OIGUS_M_TEEMAOIGUS_ANDMEVAHETUS_KUTSEREGISTER:"ROLE_OIGUS_M_TEEMAOIGUS_ANDMEVAHETUS_KUTSEREGISTER",ROLE_OIGUS_M_TEEMAOIGUS_ANDMEVAHETUS_RTIP:"ROLE_OIGUS_M_TEEMAOIGUS_ANDMEVAHETUS_RTIP",ROLE_OIGUS_M_TEEMAOIGUS_ANDMEVAHETUS_SAIS:"ROLE_OIGUS_M_TEEMAOIGUS_ANDMEVAHETUS_SAIS",ROLE_OIGUS_M_TEEMAOIGUS_AUTOTEADE:"ROLE_OIGUS_M_TEEMAOIGUS_AUTOTEADE",ROLE_OIGUS_M_TEEMAOIGUS_AVALDUS:"ROLE_OIGUS_M_TEEMAOIGUS_AVALDUS",ROLE_OIGUS_M_TEEMAOIGUS_BAASMOODUL:"ROLE_OIGUS_M_TEEMAOIGUS_BAASMOODUL",ROLE_OIGUS_M_TEEMAOIGUS_DIPLOM:"ROLE_OIGUS_M_TEEMAOIGUS_DIPLOM",ROLE_OIGUS_M_TEEMAOIGUS_DOKALLKIRI:"ROLE_OIGUS_M_TEEMAOIGUS_DOKALLKIRI",ROLE_OIGUS_M_TEEMAOIGUS_EKSAM:"ROLE_OIGUS_M_TEEMAOIGUS_EKSAM",ROLE_OIGUS_M_TEEMAOIGUS_ESINDAVALDUS:"ROLE_OIGUS_M_TEEMAOIGUS_ESINDAVALDUS",ROLE_OIGUS_M_TEEMAOIGUS_ETTEVOTE:"ROLE_OIGUS_M_TEEMAOIGUS_ETTEVOTE",ROLE_OIGUS_M_TEEMAOIGUS_HINNETELEHT:"ROLE_OIGUS_M_TEEMAOIGUS_HINNETELEHT",ROLE_OIGUS_M_TEEMAOIGUS_HINNETELEHT_TRUKKIMINE:"ROLE_OIGUS_M_TEEMAOIGUS_HINNETELEHT_TRUKKIMINE",ROLE_OIGUS_M_TEEMAOIGUS_HOONERUUM:"ROLE_OIGUS_M_TEEMAOIGUS_HOONERUUM",ROLE_OIGUS_M_TEEMAOIGUS_INDIVID:"ROLE_OIGUS_M_TEEMAOIGUS_INDIVID",ROLE_OIGUS_M_TEEMAOIGUS_KASKKIRI:"ROLE_OIGUS_M_TEEMAOIGUS_KASKKIRI",ROLE_OIGUS_M_TEEMAOIGUS_KASUTAJA:"ROLE_OIGUS_M_TEEMAOIGUS_KASUTAJA",ROLE_OIGUS_M_TEEMAOIGUS_KLASSIFIKAATOR:"ROLE_OIGUS_M_TEEMAOIGUS_KLASSIFIKAATOR",ROLE_OIGUS_M_TEEMAOIGUS_KOMISJON:"ROLE_OIGUS_M_TEEMAOIGUS_KOMISJON",ROLE_OIGUS_M_TEEMAOIGUS_KOORM:"ROLE_OIGUS_M_TEEMAOIGUS_KOORM",ROLE_OIGUS_M_TEEMAOIGUS_KYSITLUS:"ROLE_OIGUS_M_TEEMAOIGUS_KYSITLUS",ROLE_OIGUS_M_TEEMAOIGUS_LEPING:"ROLE_OIGUS_M_TEEMAOIGUS_LEPING",ROLE_OIGUS_M_TEEMAOIGUS_LOPBLANKETT:"ROLE_OIGUS_M_TEEMAOIGUS_LOPBLANKETT",ROLE_OIGUS_M_TEEMAOIGUS_LOPDOKALLKIRI:"ROLE_OIGUS_M_TEEMAOIGUS_LOPDOKALLKIRI",ROLE_OIGUS_M_TEEMAOIGUS_LOPMOODULPROTOKOLL:"ROLE_OIGUS_M_TEEMAOIGUS_LOPMOODULPROTOKOLL",ROLE_OIGUS_M_TEEMAOIGUS_LOPPROTOKOLL:"ROLE_OIGUS_M_TEEMAOIGUS_LOPPROTOKOLL",ROLE_OIGUS_M_TEEMAOIGUS_LOPTEEMA:"ROLE_OIGUS_M_TEEMAOIGUS_LOPTEEMA",ROLE_OIGUS_M_TEEMAOIGUS_LOPTUNNISTUS_TRUKKIMINE:"ROLE_OIGUS_M_TEEMAOIGUS_LOPTUNNISTUS_TRUKKIMINE",ROLE_OIGUS_M_TEEMAOIGUS_MARKUS:"ROLE_OIGUS_M_TEEMAOIGUS_MARKUS",ROLE_OIGUS_M_TEEMAOIGUS_MOODULPROTOKOLL:"ROLE_OIGUS_M_TEEMAOIGUS_MOODULPROTOKOLL",ROLE_OIGUS_M_TEEMAOIGUS_OPETAJA:"ROLE_OIGUS_M_TEEMAOIGUS_OPETAJA",ROLE_OIGUS_M_TEEMAOIGUS_OPETAJAAMET:"ROLE_OIGUS_M_TEEMAOIGUS_OPETAJAAMET",ROLE_OIGUS_M_TEEMAOIGUS_OPILASKODU:"ROLE_OIGUS_M_TEEMAOIGUS_OPILASKODU",ROLE_OIGUS_M_TEEMAOIGUS_OPINGUKAVA:"ROLE_OIGUS_M_TEEMAOIGUS_OPINGUKAVA",ROLE_OIGUS_M_TEEMAOIGUS_OPPEASUTUS:"ROLE_OIGUS_M_TEEMAOIGUS_OPPEASUTUS",ROLE_OIGUS_M_TEEMAOIGUS_OPPEKAVA:"ROLE_OIGUS_M_TEEMAOIGUS_OPPEKAVA",ROLE_OIGUS_M_TEEMAOIGUS_OPPEMATERJAL:"ROLE_OIGUS_M_TEEMAOIGUS_OPPEMATERJAL",ROLE_OIGUS_M_TEEMAOIGUS_OPPEPERIOOD:"ROLE_OIGUS_M_TEEMAOIGUS_OPPEPERIOOD",ROLE_OIGUS_M_TEEMAOIGUS_OPPERYHM:"ROLE_OIGUS_M_TEEMAOIGUS_OPPERYHM",ROLE_OIGUS_M_TEEMAOIGUS_OPPETASE:"ROLE_OIGUS_M_TEEMAOIGUS_OPPETASE",ROLE_OIGUS_M_TEEMAOIGUS_OPPETOOGRAAFIK:"ROLE_OIGUS_M_TEEMAOIGUS_OPPETOOGRAAFIK",ROLE_OIGUS_M_TEEMAOIGUS_OPPETOOLIIK:"ROLE_OIGUS_M_TEEMAOIGUS_OPPETOOLIIK",ROLE_OIGUS_M_TEEMAOIGUS_OPPETULEMUS:"ROLE_OIGUS_M_TEEMAOIGUS_OPPETULEMUS",ROLE_OIGUS_M_TEEMAOIGUS_OPPUR:"ROLE_OIGUS_M_TEEMAOIGUS_OPPUR",ROLE_OIGUS_M_TEEMAOIGUS_PAEVIK:"ROLE_OIGUS_M_TEEMAOIGUS_PAEVIK",ROLE_OIGUS_M_TEEMAOIGUS_PARING:"ROLE_OIGUS_M_TEEMAOIGUS_PARING",ROLE_OIGUS_M_TEEMAOIGUS_PILET:"ROLE_OIGUS_M_TEEMAOIGUS_PILET",ROLE_OIGUS_M_TEEMAOIGUS_PRAKTIKAAVALDUS:"ROLE_OIGUS_M_TEEMAOIGUS_PRAKTIKAAVALDUS",ROLE_OIGUS_M_TEEMAOIGUS_PRAKTIKAPAEVIK:"ROLE_OIGUS_M_TEEMAOIGUS_PRAKTIKAPAEVIK",ROLE_OIGUS_M_TEEMAOIGUS_PROTOKOLL:"ROLE_OIGUS_M_TEEMAOIGUS_PROTOKOLL",ROLE_OIGUS_M_TEEMAOIGUS_PRHINDAMISVORM:"ROLE_OIGUS_M_TEEMAOIGUS_PRHINDAMISVORM",ROLE_OIGUS_M_TEEMAOIGUS_PRSTATISTIKA:"ROLE_OIGUS_M_TEEMAOIGUS_PRSTATISTIKA",ROLE_OIGUS_M_TEEMAOIGUS_PUUDUMINE:"ROLE_OIGUS_M_TEEMAOIGUS_PUUDUMINE",ROLE_OIGUS_M_TEEMAOIGUS_RIIKLIKOPPEKAVA:"ROLE_OIGUS_M_TEEMAOIGUS_RIIKLIKOPPEKAVA",ROLE_OIGUS_M_TEEMAOIGUS_RR:"ROLE_OIGUS_M_TEEMAOIGUS_RR",ROLE_OIGUS_M_TEEMAOIGUS_RYHMAJUHATAJA:"ROLE_OIGUS_V_TEEMAOIGUS_RYHMAJUHATAJA",ROLE_OIGUS_M_TEEMAOIGUS_STRUKTUUR:"ROLE_OIGUS_M_TEEMAOIGUS_STRUKTUUR",ROLE_OIGUS_M_TEEMAOIGUS_SYNDMUS:"ROLE_OIGUS_M_TEEMAOIGUS_SYNDMUS",ROLE_OIGUS_M_TEEMAOIGUS_T:"ROLE_OIGUS_M_TEEMAOIGUS_T",ROLE_OIGUS_M_TEEMAOIGUS_TOEND:"ROLE_OIGUS_M_TEEMAOIGUS_TOEND",ROLE_OIGUS_M_TEEMAOIGUS_TUGITEENUS:"ROLE_OIGUS_V_TEEMAOIGUS_TUGITEENUS",
ROLE_OIGUS_M_TEEMAOIGUS_TUNDAEG:"ROLE_OIGUS_M_TEEMAOIGUS_TUNDAEG",ROLE_OIGUS_M_TEEMAOIGUS_TUNNIJAOTUSPLAAN:"ROLE_OIGUS_M_TEEMAOIGUS_TUNNIJAOTUSPLAAN",ROLE_OIGUS_M_TEEMAOIGUS_TUNNIPLAAN:"ROLE_OIGUS_M_TEEMAOIGUS_TUNNIPLAAN",ROLE_OIGUS_M_TEEMAOIGUS_UUDE_AASTASSE:"ROLE_OIGUS_M_TEEMAOIGUS_UUDE_AASTASSE",ROLE_OIGUS_M_TEEMAOIGUS_VASTUVOTT:"ROLE_OIGUS_M_TEEMAOIGUS_VASTUVOTT",ROLE_OIGUS_M_TEEMAOIGUS_VOTA:"ROLE_OIGUS_M_TEEMAOIGUS_VOTA",ROLE_OIGUS_M_TEEMAOIGUS_VOTAKOM:"ROLE_OIGUS_M_TEEMAOIGUS_VOTAKOM",ROLE_OIGUS_M_TEEMAOIGUS_YLDTEADE:"ROLE_OIGUS_M_TEEMAOIGUS_YLDTEADE",ROLE_OIGUS_M_TEEMAOIGUS_TEADE:"ROLE_OIGUS_M_TEEMAOIGUS_TEADE",ROLE_OIGUS_M_TEEMAOIGUS_STIPTOETUS:"ROLE_OIGUS_M_TEEMAOIGUS_STIPTOETUS",ROLE_OIGUS_K_TEEMAOIGUS_AVALDUS:"ROLE_OIGUS_K_TEEMAOIGUS_AVALDUS",ROLE_OIGUS_K_TEEMAOIGUS_OPINGUKAVA:"ROLE_OIGUS_K_TEEMAOIGUS_OPINGUKAVA",ROLE_OIGUS_K_TEEMAOIGUS_TUNNIPLAAN:"ROLE_OIGUS_K_TEEMAOIGUS_TUNNIPLAAN"}).constant("USER_CONFIRM_RIGHTS",["TEEMAOIGUS_AINE","TEEMAOIGUS_AVALDUS","TEEMAOIGUS_EKSAM","TEEMAOIGUS_ESINDAVALDUS","TEEMAOIGUS_HINNETELEHT","TEEMAOIGUS_HINNETELEHT_TRUKKIMINE","TEEMAOIGUS_KASKKIRI","TEEMAOIGUS_KASKKIRI_EKISETA","TEEMAOIGUS_KOMISJON","TEEMAOIGUS_LOPMOODULPROTOKOLL","TEEMAOIGUS_LOPPROTOKOLL","TEEMAOIGUS_LOPTEEMA","TEEMAOIGUS_LOPTUNNISTUS_TRUKKIMINE","TEEMAOIGUS_MOODULPROTOKOLL","TEEMAOIGUS_OPINGUKAVA","TEEMAOIGUS_OPPEKAVA","TEEMAOIGUS_PAEVIK","TEEMAOIGUS_PRAKTIKAPAEVIK","TEEMAOIGUS_PROTOKOLL","TEEMAOIGUS_RIIKLIKOPPEKAVA","TEEMAOIGUS_TUNNIPLAAN","TEEMAOIGUS_VOTA"]),angular.module("hitsaOis").constant("MONTH",{0:"january",1:"february",2:"march",3:"april",4:"may",5:"june",6:"july",7:"august",8:"september",9:"october",10:"november",11:"december"}).constant("WEEKDAY",{0:"sunday",1:"monday",2:"tuesday",3:"wednesday",4:"thursday",5:"friday",6:"saturday"}),angular.module("hitsaOis").factory("DataUtils",function(){function a(b,c,d){if(angular.isArray(b))return b.map(function(b){return a(b,c,d)});for(var e=0,f=c.length;f>e;e++){var g=c[e];b.hasOwnProperty(g)&&"string"==typeof b[g]&&(b[g]=moment(b[g],d).toDate())}return b}function b(b,c){return a(b,c,"YYYY-MM-DD'T'hh:mm:ss.SSS'Z'")}function c(b,c){return a(b,c,"hh:mm")}function d(a,b){angular.isArray(b)&&b.forEach(function(b){angular.isObject(a[b])&&(a[b]=a[b].id)})}function e(a){for(var c=(a||[]).slice(0),d=0;d<c.length;d++)b(c[d],["startDate","endDate"]);return c.sort(function(a,b){return a.endDate-b.endDate}),c}function f(a,b){var c=e(b);return c.find(function(b){return a<=b.endDate})}function g(a){return f((new Date).withoutTime(),a)}function h(a){return b(a,["endDate"]),(new Date).withoutTime()>a.endDate}function i(a,b){return a.startDate<=b.startDate&&a.endDate>=b.startDate||a.startDate>=b.startDate&&a.startDate<=b.endDate}function j(a,b,c){var d=c.rooms.map(function(b){return a.currentLanguageNameField(b)}).join(", "),e=c.teachers.map(function(b){return a.currentLanguageNameField(b)}).join(", "),f=c.studentGroups.map(function(b){return a.currentLanguageNameField(b)}).join(", "),g=[];return d.length>0&&g.push("timetable.roomIsOccupied"),e.length>0&&g.push(b?"timetable.teacherIsOccupiedHigher":"timetable.teacherIsOccupiedVocational"),f.length>0&&g.push("timetable.studentGroupIsOccupied"),g.push("timetable.continue"),{extraPrompts:g,rooms:d,teachers:e,studentGroups:f}}function k(a,b){return a&&b?a.endsWith(b)?a:a+", "+b:a?a:b?b:""}function l(a,b,c,d){return(!c||moment(c).isSameOrBefore(b))&&(!d||moment(d).isSameOrAfter(a))}var m=26;return{assign:function(a,b,c){return a.split(".").reduce(function(a,b,d,e){return d===e.length-1?a[b]=c:a[b]||(a[b]={}),a[b]},b||{})},convertStringToDates:b,convertStringToTime:c,convertObjectToIdentifier:d,getCurrentStudyYearOrPeriod:g,getStudyYearOrPeriodAt:f,sortStudyYearsOrPeriods:e,isPastStudyYearOrPeriod:h,periodsOverlap:i,occupiedEventTimePrompts:j,isValidObject:l,formatAddress:k,sexFromIdcode:function(a){return 11!==a.length||isNaN(a)?null:Number(a.charAt(0))%2===1?"SUGU_M":"SUGU_N"},birthdayFromIdcode:function(a){if(11!==a.length||isNaN(a))return null;var b={1:"18",2:"18",3:"19",4:"19",5:"20",6:"20",7:"21",8:"21"},c=b[a.charAt(0)]+a.substring(1,7);return moment(c).toDate()},creditsToHours:function(a){return Math.round(m*a)},get:function(a,b){return b.split(".").reduce(function(a,b){return"undefined"==typeof a||null===a?a:a[b]},a)},hoursToCredits:function(a){return Math.round(a/m*10)/10},getAcademicHoursFromString:function(a){var b=moment.duration(a).asSeconds(),c=b/60/60;return Math.round(100*c)/100},getAcademicHoursFromDouble:function(a){if(!angular.isNumber(a))return"0:00";var b=Math.floor(a),c=60*(a-b);return c=""+Math.ceil(c),b+":"+(c?1===c.length?"0"+c:c:"00")},getAcademicHours:function(a){if(!angular.isNumber(a))return 0;var b=4*a/3;return Math.round(100*b)/100},getAstronomicalHoursAsString:function(a){if(!angular.isNumber(a))return"0:00";var b=3*a/4,c=Math.floor(b),d=60*(b-c);return d=""+Math.ceil(d),c+":"+(d?1===d.length?"0"+d:d:"00")},getAstronomicalHoursAsDouble:function(a){if(!angular.isNumber(a))return 0;var b=3*a/4;return Math.round(100*b)/100},getAstronomicalHours:function(a){if(!angular.isNumber(a))return"-";var b=3*a/4,c=Math.floor(b),d=60*(b-c);return c+"t"+(d?" "+d+"min":"")},isSameDay:function(a,b){return a.getFullYear()===b.getFullYear()&&a.getMonth()===b.getMonth()&&a.getDate()===b.getDate()},isWeekend:function(a){var b=a.getDay();return 6===b||0===b},filterArrayByText:function(a,b,c){if(!b)return[];var d=new RegExp("^.*"+b.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&").replace("%",".*").toUpperCase()+".*$");return(a||[]).filter(function(a){return c(a,d)})}}}),Date.prototype.withoutTime=function(){var a=new Date(this);return a.setHours(0,0,0,0),a},angular.module("hitsaOis").service("dialogService",["$mdDialog","ArrayUtils","message",function(a,b,c){var d={accept:"main.yes",cancel:"main.no"},e={close:"main.button.close"};this.showDialog=function(d,e,f,g,h){var i=!1;a.show({controller:["$scope","$rootScope","$mdDialog",function(a,d,g){var h=!1;a.removeFromArray=b.remove,a.currentLanguageNameField=d.currentLanguageNameField,a.cancel=g.hide,a.submit=function(){var b=!0;if(a.dialogForm&&(a.dialogForm.$setSubmitted(),b=a.dialogForm.$valid),b){if(h)return;h=!0,angular.isFunction(f)&&f(a),i=!0,g.hide()}else c.error("main.messages.form-has-errors")},angular.isFunction(e)&&e(a)}],templateUrl:d,multiple:h?!0:!1,preserveScope:h?!0:!1,bindToController:h?!0:!1,clickOutsideToClose:!1,onRemoving:function(){angular.isFunction(g)&&i!==!0&&g()}})},this.hide=a.hide,this.confirmDialog=function(b,c,e){a.show({controller:["$scope",function(f){var g=!1;f.messages=angular.extend({},d,b),f.accept=function(){g||(g=!0,a.hide(),c())},f.cancel=function(){a.hide(),angular.isFunction(e)&&e()}}],templateUrl:"components/confirm.dialog.html",clickOutsideToClose:!1,multiple:!0})},this.messageDialog=function(b,c){a.show({controller:["$scope",function(d){d.messages=angular.extend({},e,b),d.close=function(){a.hide(),angular.isFunction(c)&&c()}}],templateUrl:"components/message.dialog.html",clickOutsideToClose:!1,multiple:!0})}}]),angular.module("hitsaOis").factory("ekisService",["config",function(a){var b="YYYYMMDDHHmmSS",c={};return c.getContractUrl=function(c){return a.ekisUrl+c+"%26u=3D"+moment().format(b)},c.getCertificateUrl=function(c){return a.ekisUrl+c+"%26u=3D"+moment().format(b)},c}]),angular.module("hitsaOis").factory("resourceErrorHandler",["$q","message",function(a,b){return{responseError:function(c,d){if(404===c.status)b.error("main.messages.record.notFound");else if(409===c.status)b.error("main.messages.record.modified");else if(c.data&&c.data._errors){var e=!1;angular.forEach(c.data._errors,function(a){if(a.field&&d){var c=d[a.field];if(c&&c.$setValidity&&c.$setDirty)return void("required"===a.code?(c.$validators.required||(c.$validators.required=function(a,b){return!c.$isEmpty(b)}),c.$setValidity(a.code,!1)):(c.$serverError=c.$serverError||[],c.$serverError.push(a),c.$setValidity("serverside",!1)))}e=!0,a.field&&a.field.replace&&(a.field=a.field.replace(/(\[)(\d+)(\])/,function(a,b,c,d){return b+(parseInt(c)+1)+d})),b.error(a.code+(a.field?" "+a.field:""),a.params)}),e||b.error("main.messages.form-has-errors")}else-1===[401,403,419,440].indexOf(c.status)&&b.error("main.messages.system.failure");return a.reject(c)}}}]),angular.module("hitsaOis").factory("ExcelUtils",["QueryUtils","$http",function(a,b){var c={};return c.get=function(c,d,e){a.loadingWheel(d,!0),b.get(c,{responseType:"arraybuffer"}).then(function(b){a.loadingWheel(d,!1);var c=new Blob([b.data],{type:b.headers("Content-Type")});if(window.navigator.msSaveOrOpenBlob)window.navigator.msSaveBlob(c,e);else{var f=window.URL||window.MozURL||window.webkitURL||window.MSURL||window.OURL,g=document.createElement("a");g.href=f.createObjectURL(c),g.download=e,document.body.appendChild(g),g.target="_blank",g.click(),document.body.removeChild(g)}})},c}]),angular.module("hitsaOis").factory("FormUtils",["$location","dialogService","message",function(a,b,c){function d(a,b){return a.$setSubmitted(),a.$valid?b():void c.error("main.messages.form-has-errors")}return{withValidForm:d,saveRecord:function(b,e,f,g){d(b,function(){e.id?e.$update().then(c.updateSuccess).then(g)["catch"](angular.noop):e.$save().then(function(){c.info("main.messages.create.success"),a.url(f+"/"+e.id+"/edit?_noback")})["catch"](angular.noop)})},deleteRecord:function(d,e,f){b.confirmDialog(f,function(){d.$delete().then(function(){c.info("main.messages.delete.success"),a.url(e)})["catch"](angular.noop)})}}}]),angular.module("hitsaOis").constant("HigherGrade",{KORGHINDAMINE_5:"KORGHINDAMINE_5",KORGHINDAMINE_4:"KORGHINDAMINE_4",KORGHINDAMINE_3:"KORGHINDAMINE_3",KORGHINDAMINE_2:"KORGHINDAMINE_2",KORGHINDAMINE_1:"KORGHINDAMINE_1",KORGHINDAMINE_0:"KORGHINDAMINE_0",KORGHINDAMINE_A:"KORGHINDAMINE_A",KORGHINDAMINE_M:"KORGHINDAMINE_M",KORGHINDAMINE_MI:"KORGHINDAMINE_MI"}).factory("HigherGradeUtil",["HigherGrade","ArrayUtils",function(a,b){var c=[a.KORGHINDAMINE_1,a.KORGHINDAMINE_2,a.KORGHINDAMINE_3,a.KORGHINDAMINE_4,a.KORGHINDAMINE_5,a.KORGHINDAMINE_A],d=[a.KORGHINDAMINE_0,a.KORGHINDAMINE_1,a.KORGHINDAMINE_2,a.KORGHINDAMINE_3,a.KORGHINDAMINE_4,a.KORGHINDAMINE_5],e=["1","2","3","4","5","A"],f=["E","D","C","B","A","P"],g=["0","1","2","3","4","5"],h=["F","E","D","C","B","A"];return{isPositive:function(a){return b.includes(c,a)},isDistinctive:function(a){return b.includes(d,a)},isPositiveValue:function(a,c){return c?b.includes(f,a):b.includes(e,a)},isDistinctiveValue:function(a,c){return c?b.includes(h,a):b.includes(g,a)}}}]),angular.module("hitsaOis").service("inAadressService",["$translate",function(a){var b=document.createElement("div");b.id="InAadressDiv";var c=null;this.getInAds=function(){return c||(c=new InAadress({container:"InAadressDiv",mode:"3",nocss:!0,appartment:1,ihist:"1993",lang:a.use()})),c},this.isLoaded=function(){return!!c},this.append=function(a){a.appendChild(b)}}]),angular.module("hitsaOis").factory("LessonPlanTableService",["$compile","$filter","$translate",function(a,b,c){function d(a){return a.filter(function(a,b,c){return c.map(function(a){return a.id}).indexOf(a.id)===b})}function e(a,b){return a?a.find(function(a){return a.code===b}):void 0}function f(a,b){return a.formState.legends[b]}function g(a,b){return a.filter(function(a){return a.id===b})[0]}function h(a,b){return"/#"+M+"/journals/new?lessonPlan="+a+"&occupationModule="+b.occupationModuleId+(b.id?"&lessonPlanModule="+b.id:"")}function i(a){return"/#"+M+"/journals/"+a.id+"/edit?lessonPlanModule="+a.lessonPlanModule}function j(a,b){return a?a.filter(function(a){return void 0!==b&&void 0!==b[a.code]}):void 0}function k(a,b,c){var d=b.find(function(a){return a.id===c});if(d){var e=d.isStudyPeriodScheduleLoad?d.scheduleLoad*a.length:d.scheduleLoad;return{scheduleLoad:e,unplannedLessons:e-d.plannedLessons>0?e-d.plannedLessons:0}}return null}function l(a){return a?b("hoisNumber")(a,1):0}function m(a){var b=document.createElement("td");return b.classList.add(ja),b.classList.add(ma),b.innerHTML=a.value.toUpperCase(),b}function n(a){return N.test(a)&&a>0}function o(a){var c=document.createElement("thead"),d=document.createElement("tr");d.appendChild(y()),a.atLeastOneShownPeriod||d.appendChild(H());for(var e=0;e<a.formState.studyPeriods.length;e++){var g=a.formState.studyPeriods[e];if(g._selected){var h=document.createElement("th");h.colSpan=g.weekNrs.length,h.className=la,h.innerHTML=a.currentLanguageNameField(g)+" "+b("hoisDayMonth")(g.startDate,1)+"-"+b("hoisDayMonth")(g.endDate,1),d.appendChild(h)}}if(c.appendChild(d),a.formState.showWeeks){var i=document.createElement("tr");i.appendChild(y()),a.atLeastOneShownPeriod||d.appendChild(H());for(var j=0;j<a.formState.weekNrs.length;j++){var k=a.formState.weekNrs[j];if(k.show){var l=document.createElement("th");l.title=b("hoisDate")(a.formState.weekBeginningDates[j]),l.innerHTML=k.nr,l.classList.add(ja),k.endOfPeriod&&l.classList.add(la);var m=f(a,k.nr);m&&(l.style.backgroundColor=m),i.appendChild(l)}}c.appendChild(i)}return c}function p(a,b,d,e){var f=document.createElement("tr"),g=document.createElement("td");g.id=Q+b.occupationModuleId,g.colSpan=3,g.className=la,g.style="border-top:1px solid #aaa";var i=document.createElement("span");if(i.className="hois-collapse-header",i.innerHTML=a.currentLanguageNameField(b)+"&nbsp;&nbsp;",a.record.curriculumVersion.id!==b.curriculumVersionId&&(i.style="color: red"),g.appendChild(i),!e){var j=document.createElement("a");j.innerHTML=c.instant("lessonplan.addjournal"),j.href=h(a.lessonPlanId,b),g.appendChild(j)}f.appendChild(g);var k=document.createElement("td");k.colSpan=a.formState.shownWeeksCount,k.className=la,k.style="border-top:1px solid #aaa; min-width: 300px;";var l=document.createElement("div");l.className="layout-row";var m=document.createElement("div");m.className="flex-10",m.innerHTML="&nbsp;",l.appendChild(m);var n=document.createElement("div");return n.className="flex-70",n.appendChild(q(a,d,e)),l.appendChild(n),k.appendChild(l),f.appendChild(k),f}function q(a,b,d){var e=null;if(d){e=document.createElement("div"),e.classList.add("form-readonly");var f=document.createElement("md-input-container");f.style="width: 100%;";var g=document.createElement("label");g.innerHTML=c.instant("lessonplan.responsibleformodule"),f.appendChild(g);var h=document.createElement("hois-value");h.setAttribute("value","currentLanguageNameField(record.modules["+b+"].teacher)"),f.appendChild(h);var i=document.createElement("div");i.innerHTML="&nbsp;",e.appendChild(i),e.appendChild(f)}else{e=document.createElement("hois-autocomplete"),e.setAttribute("label",c.instant("lessonplan.responsibleformodule")),e.setAttribute("ng-model","record.modules["+b+"].teacher"),e.setAttribute("method","teachers");var j="{valid: true"+(a.record.modules[b].teacher?", selectedTeacherId:"+a.record.modules[b].teacher.id:"")+"}";e.setAttribute("additional-query-params",j)}return e}function r(a,b){var d=document.createElement("tr"),e=document.createElement("td");e.className=la,e.colSpan=3,e.innerHTML=c.instant("lessonplan.modulehours")+": "+b.totalHours,d.appendChild(e);var f=document.createElement("td");return f.className=la,f.colSpan=a.formState.shownWeeksCount,d.appendChild(f),d}function s(a,b){var f=document.createElement("tr"),g=document.createElement("td");g.id=R+b.id,g.className=la,g.colSpan=3,g.style="font-weight: bold;",g.innerHTML=b.nameEt,f.appendChild(g);var h=document.createElement("td");h.className=la,h.colSpan=a.formState.shownWeeksCount;for(var i=d(b.themes),j=0;j<i.length;j++){var k=i[j],l="";j>0&&(l+=", &nbsp;");var m="";for(var n in k.hours)if(k.hours.hasOwnProperty(n)){var o=e(a.formState.capacityTypes,n);""!==m&&o&&(m+="/"),o&&(m+=o.value.toUpperCase()+k.hours[n])}var p=document.createElement("span");l+=k.nameEt+" "+k.credits+" "+c.instant("lessonplan.credits")+" ("+m+")",l+="&nbsp;",p.innerHTML=l,h.appendChild(p)}return f.appendChild(h),f}function t(a,b){var d=g(a.record.teachers,b),e=j(a.formState.capacityTypes,d.plannedLessonsByCapacity),f=document.createElement("tr");f.appendChild(document.createElement("td"));var h=document.createElement("td");if(h.colSpan=2,h.classList.add(oa),h.classList.add(ma),h.classList.add(la),h.innerHTML=c.instant("lessonplan.load")+" "+l(d.plannedLessons),h.title=I(d,e),f.appendChild(h),a.formState.showWeeks)for(var i=0;i<a.formState.weekNrs.length;i++){var k=a.formState.weekNrs[i];if(k.show){var m=d.studyLoadByWeek?d.studyLoadByWeek[i]:null,n=F(null,m,k);n.classList.add(na),n.title=J(d,e,i),f.appendChild(n)}}else for(var o=0;o<a.formState.studyPeriods.length;o++){var p=a.formState.studyPeriods[o];if(p._selected){var q=d.studyLoadByPeriod?d.studyLoadByPeriod[o]:null,r=G(null,q,p);r.classList.add(na),r.title=K(d,e,o),f.appendChild(r)}}return f}function u(a,b,d,e){for(var f=j(a.formState.capacityTypes,a.formState.moduleTotals[d.id]),g=0;g<f.length;g++){var h=f[g],i=document.createElement("tr");if(i.className=ma,0===g){var k=document.createElement("td");k.className=ma,k.rowSpan=Object.keys(f).length+1,k.innerHTML=a.currentLanguageNameField(d)+" "+c.instant("lessonplan.moduleTotal"),i.appendChild(k)}i.appendChild(m(h));var n=W+P+e+P+h.code,o=l(a.formState.moduleTotals[d.id]._[h.code]);if(i.appendChild(E(n,o)),a.atLeastOneShownPeriod||i.appendChild(H()),a.formState.showWeeks)for(var p=0;p<a.formState.weekNrs.length;p++){var q=a.formState.weekNrs[p];if(q.show){var r=X+P+e+P+h.code+P+p,s=l(a.formState.moduleTotals[d.id][h.code][p]);i.appendChild(F(r,s,q))}}else for(var t=0;t<a.formState.studyPeriods.length;t++){var u=a.formState.studyPeriods[t];if(u._selected){var w=aa+P+e+P+h.code+P+t,x=l(a.formState.spModuleTotals[d.id][h.code][t]);i.appendChild(G(w,x,u))}}b.appendChild(i)}b.appendChild(v(a,d,e,f))}function v(a,b,d,e){var f=document.createElement("tr");if(f.className=ma,0===e.length){var g=document.createElement("td");g.innerHTML="&nbsp",g.classList.add(ma),g.classList.add(ja),f.appendChild(g)}var h=document.createElement("td");h.className=ma,h.innerHTML=c.instant("lessonplan.total"),f.appendChild(h);var i=Y+P+d,j=l(a.formState.moduleTotals[b.id].__);if(f.appendChild(E(i,j)),a.atLeastOneShownPeriod||f.appendChild(H()),a.formState.showWeeks)for(var k=0;k<a.formState.weekNrs.length;k++){var m=a.formState.weekNrs[k];if(m.show){var n=Z+P+d+P+P+k,o=l(a.formState.moduleTotals[b.id]._._[k]);f.appendChild(F(n,o,m))}}else for(var p=0;p<a.formState.studyPeriods.length;p++){var q=a.formState.studyPeriods[p];if(q._selected){var r=ba+P+d+P+p,s=l(a.formState.spModuleTotals[b.id]._._[p]);f.appendChild(G(r,s,q))}}return f}function w(a,b){for(var d=j(a.formState.capacityTypes,a.formState.grandTotals),e=0;e<d.length;e++){var f=d[e],g=document.createElement("tr");if(g.classList.add(ma),g.classList.add(qa),0===e){var h=document.createElement("td");h.rowSpan=Object.keys(d).length+1,h.className=ma,h.innerHTML=c.instant("lessonplan.grandTotal"),g.appendChild(h)}g.appendChild(m(f));var i=ea+P+f.code,k=l(a.formState.grandTotals._[f.code]);if(g.appendChild(E(i,k)),a.atLeastOneShownPeriod||g.appendChild(H()),a.formState.showWeeks)for(var n=0;n<a.formState.weekNrs.length;n++){var o=a.formState.weekNrs[n];if(o.show){var p=da+P+f.code+P+n,q=l(a.formState.grandTotals[f.code][n]);g.appendChild(F(p,q,o))}}else for(var r=0;r<a.formState.studyPeriods.length;r++){var s=a.formState.studyPeriods[r];if(s._selected){var t=ca+P+f.code+P+r,u=l(a.formState.capGrandTotalsSp[f.code][r]);g.appendChild(G(t,u,s))}}b.appendChild(g)}b.appendChild(x(a))}function x(a){var b=document.createElement("tr");b.classList.add(ma),b.classList.add(qa);var d=document.createElement("td");d.className=ma,d.innerHTML=c.instant("lessonplan.total"),b.appendChild(d);var e=ha,f=l(a.formState.grandTotals.__);if(b.appendChild(E(e,f)),a.atLeastOneShownPeriod||b.appendChild(H()),a.formState.showWeeks)for(var g=0;g<a.formState.weekNrs.length;g++){var h=a.formState.weekNrs[g];if(h.show){var i=ga+P+g,j=l(a.formState.grandTotals._._[g]);b.appendChild(F(i,j,h))}}else for(var k=0;k<a.formState.studyPeriods.length;k++){var m=a.formState.studyPeriods[k];if(m._selected){var n=fa+P+k,o=l(a.formState.grandTotalsSp[k]);b.appendChild(G(n,o,m))}}return b}function y(){var a=document.createElement("th");return a.colSpan=3,a.classList.add(ka),a.classList.add(la),a}function z(a,b,c,d){var e=a.record.modules[b].journals[c],f=e.requiredLessons[d]?e.requiredLessons[d]:0;return a.formState.journalTotals[e.id][d]!==f?"red":"inherit"}function A(a,b){b.addEventListener("input",function(){var c=this.name.split(P),d=c[1],e=c[2],f=c[3],g=c[4],h=a.record.modules[d],i=h.journals[e],j=""===this.value||n(this.value);b.style=j?null:"border: 1px solid rgb(221,44,0);",b.classList.add(ja),i.hours[f][g]=j?this.value:null,a.updateTotals(i,f,g),i.hours[f][g]=this.value,a.updateTotals(i,f,g);var k=document.getElementById(T+P+i.id+P+g);if(k.innerHTML=l(a.formState.journalTotals[i.id]._[g]),a.formState.showTotals){var m=document.getElementById(X+P+d+P+f+P+g);m.innerHTML=l(a.formState.moduleTotals[h.id][f][g]);var o=document.getElementById(Z+P+d+P+P+g);o.innerHTML=l(a.formState.moduleTotals[h.id]._._[g])}var p=document.getElementById(da+P+f+P+g);p.innerHTML=l(a.formState.grandTotals[f][g]);var q=document.getElementById(ga+P+g);q.innerHTML=l(a.formState.grandTotals._._[g]),C(a,h,i,d,e,f)}),b.addEventListener("mousewheel",function(a){a.preventDefault()})}function B(a,b){b.addEventListener("input",function(){var c=this.name.split(P),d=c[1],e=c[2],f=c[3],g=c[4],h=a.record.modules[d],i=h.journals[e],j=""===this.value||n(this.value);i.spHours[f][g]=j?this.value:null,b.style=j?null:"border: 1px solid rgb(221,44,0);",a.updateLessonCountByStudyPeriod(i,f,g);var k=document.getElementById(_+P+i.id+P+g);if(k.innerHTML=l(a.formState.journalTotals[i.id]._spTotals[g]),a.formState.showTotals){var m=document.getElementById(aa+P+d+P+f+P+g);m.innerHTML=l(a.formState.spModuleTotals[h.id][f][g]);var o=document.getElementById(ba+P+d+P+g);o.innerHTML=l(a.formState.spModuleTotals[h.id]._._[g])}var p=document.getElementById(ca+P+f+P+g);p.innerHTML=l(a.formState.capGrandTotalsSp[f][g]);var q=document.getElementById(fa+P+g);q.innerHTML=l(a.formState.grandTotalsSp[g]),C(a,h,i,d,e,f)}),b.addEventListener("mousewheel",function(a){a.preventDefault()})}function C(a,b,c,d,e,f){var g=document.getElementById(U+P+d+P+e+P+f);g.style.color=z(a,d,e,f),g.innerHTML=l(a.formState.journalTotals[c.id][f]);var h=document.getElementById(V+P+c.id);if(h.innerHTML=l(a.formState.journalTotals[c.id].__),a.formState.showTotals){var i=document.getElementById(W+P+d+P+f);i.innerHTML=l(a.formState.moduleTotals[b.id]._[f]);var j=document.getElementById(Y+P+d);j.innerHTML=l(a.formState.moduleTotals[b.id].__)}var k=document.getElementById(ea+P+f);k.innerHTML=l(a.formState.grandTotals._[f]);var m=document.getElementById(ha);m.innerHTML=l(a.formState.grandTotals.__)}function D(a,b){var d=document.createElement("tr");d.className=ma;var e=document.createElement("td");e.className=ma,e.innerHTML=c.instant("lessonplan.total"),d.appendChild(e);var f=V+P+b.id,g=l(a.formState.journalTotals[b.id].__);if(d.appendChild(E(f,g)),a.atLeastOneShownPeriod||d.appendChild(H()),a.formState.showWeeks)for(var h=0;h<a.formState.weekNrs.length;h++){var i=a.formState.weekNrs[h];if(i.show){var j=T+P+b.id+P+h,k=l(a.formState.journalTotals[b.id]._[h]);d.appendChild(F(j,k,i))}}else for(var m=0;m<a.formState.studyPeriods.length;m++){var n=a.formState.studyPeriods[m];if(n._selected){var o=_+P+b.id+P+m,p=l(a.formState.journalTotals[b.id]._spTotals[m]);d.appendChild(G(o,p,n))}}return d}function E(a,b,c){var d=document.createElement("td");return d.id=a,d.innerHTML=angular.isDefined(b)?b:"",d.classList.add(ja),d.classList.add(la),d.classList.add(ma),d.style.color=c,d}function F(a,b,c,d){var e=document.createElement("td");return e.id=a,e.innerHTML=angular.isDefined(b)?b:"",e.classList.add(ja),c.endOfPeriod&&e.classList.add(la),e.style.color=d,e}function G(a,b,c,d){var e=document.createElement("td");return e.id=a,e.innerHTML=angular.isDefined(b)?b:"",e.colSpan=c.weekNrs.length,e.classList.add(ja),e.classList.add(la),e.style.color=d,e}function H(){var a=document.createElement("td");return a.colSpan=1,a.classList.add(la),a}function I(a,b){for(var c="",d=0;d<b.length;d++){var e=b[d];a.plannedLessonsByCapacity&&a.plannedLessonsByCapacity[e.code]&&(c+=e.value.toUpperCase()+": "+a.plannedLessonsByCapacity[e.code]+O)}return c}function J(a,b,c){for(var d="",e=0;e<b.length;e++){var f=b[e];a.studyLoadByWeekAndCapacity&&a.studyLoadByWeekAndCapacity[f.code]&&a.studyLoadByWeekAndCapacity[f.code][c]&&(d+=f.value.toUpperCase()+": "+a.studyLoadByWeekAndCapacity[f.code][c]+O)}return d}function K(a,b,c){for(var d="",e=0;e<b.length;e++){var f=b[e];a.studyLoadByPeriodAndCapacity&&a.studyLoadByPeriodAndCapacity[f.code]&&a.studyLoadByPeriodAndCapacity[f.code][c]&&(d+=f.value.toUpperCase()+": "+a.studyLoadByPeriodAndCapacity[f.code][c]+O)}return d}var L={},M="/lessonplans",N=/^\d+$/,O="\n",P="/",Q="module",R="journal",S="weekHour",T="weekTotal",U="capacityTotal",V="journalTotal",W="moduleCapacityTotal",X="moduleWeekHour",Y="moduleTotal",Z="moduleWeekTotal",$="periodHour",_="periodTotal",aa="modulePeriodHour",ba="modulePeriodTotal",ca="grandPeriodTotal",da="grandWeekTotal",ea="grandCapacityTotal",fa="grandPeriodTotal",ga="grandWeekTotal",ha="grandTotal",ia="md-primary change-button",ja="center",ka="cross",la="dividerBorder",ma="fix",na="lessonplan-teacher-load",oa="lessonplan-teacher-load-label",pa="material-icons pointer",qa="lessonplan-total-row";return L.generateLessonPlan=function(b,d){var e=document.getElementById("lessonplan-table");e.innerHTML="",e.appendChild(o(b));for(var f=document.createElement("tbody"),g=[],h=0;h<b.record.modules.length;h++){var n=b.record.modules[h];f.appendChild(p(b,n,h,d)),f.appendChild(r(b,n));for(var q=0;q<n.journals.length;q++){var v=n.journals[q];f.appendChild(s(b,v)),1===v.teachers.length&&f.appendChild(t(b,v.teachers[0].teacher.id));for(var x=j(b.formState.capacityTypes,v.hours),y=0;y<x.length;y++){var C=x[y],F=document.createElement("tr");if(F.className=ma,0===y){var G=document.createElement("td");G.className=ma,G.rowSpan=Object.keys(x).length+1;var I=document.createElement("div");I.setAttribute("layout","row"),I.setAttribute("layout-align","space-between stretch");for(var J=document.createElement("div"),K=document.createElement("span"),L=0;L<v.studentGroups.length;L++){var M=v.studentGroups[L];if(b.record.studentGroupCode!==M){var N=document.createElement("div");N.innerHTML=M,K.appendChild(N)}}v.studentGroups.length>1&&v.teachers.length>0&&K.appendChild(document.createElement("br"));for(var O=0;O<v.teachers.length;O++){var Q=v.teachers[O],R=document.createElement("div");R.title=c.instant("lessonplan.teacherLoad",k(b.formState.studyPeriods,b.formState.teachers,Q.teacher.id)),R.innerHTML="",R.innerHTML=Q.teacher.nameEt,K.appendChild(R)}if(J.appendChild(K),"PAEVIK_GRUPI_JAOTUS_1"!==v.groupProportion.code){J.appendChild(document.createElement("br"));var T=document.createElement("div");T.className="layout-row",T.innerHTML=c.instant("lessonplan.journal.groupProportion")+"&nbsp;"+b.currentLanguageNameField(v.groupProportion),J.appendChild(T)}I.appendChild(J);var V=document.createElement("div");if(V.setAttribute("layout","column"),V.setAttribute("layout-align","space-around center"),v.teachers.length>1||v.capacityDiff){var W=document.createElement("i");W.className=pa,W.innerHTML="*",W.title=c.instant("lessonplan.teacherSpecificLoads"),g[v.id]=b.teacherCapacities.bind(this,v),W.addEventListener("click",g[v.id]),V.appendChild(W)}if(!d){var X=document.createElement("a");X.className=ia,X.innerHTML=c.instant("main.button.change"),X.href=i(v),V.appendChild(X)}I.appendChild(V),G.appendChild(I),F.appendChild(G)}F.appendChild(m(C));var Y=U+P+h+P+q+P+C.code,Z=l(b.formState.journalTotals[v.id][C.code]),_=z(b,h,q,C.code),aa=E(Y,Z,_),ba=v.requiredLessons[C.code]?v.requiredLessons[C.code]:0;if(aa.title=c.instant("lessonplan.planned")+" "+ba,F.appendChild(aa),b.atLeastOneShownPeriod||F.appendChild(H()),b.formState.showWeeks)for(var ca=0;ca<b.formState.weekNrs.length;ca++){var da=b.formState.weekNrs[ca];if(da.show){var ea=document.createElement("td");ea.classList.add(ja),da.endOfPeriod&&ea.classList.add(la);var fa=null;d?(fa=document.createElement("div"),fa.innerHTML=v.hours[C.code][ca]):(fa=document.createElement("input"),fa.setAttribute("type","number"),fa.setAttribute("name",S+P+h+P+q+P+C.code+P+ca),fa.setAttribute("value",v.hours[C.code][ca]),A(b,fa)),ea.appendChild(fa),F.appendChild(ea)}}else for(var ga=0;ga<b.formState.studyPeriods.length;ga++){var ha=b.formState.studyPeriods[ga];if(ha._selected){var ka=document.createElement("td");ka.colSpan=ha.weekNrs.length,ka.classList.add(ja),ka.classList.add(la);var na=null;d?(na=document.createElement("div"),na.innerHTML=v.spHours[C.code][ga]):(na=document.createElement("input"),na.setAttribute("type","number"),na.setAttribute("name",$+P+h+P+q+P+C.code+P+ga),na.setAttribute("value",v.spHours[C.code][ga]),B(b,na)),ka.appendChild(na),F.appendChild(ka)}}f.appendChild(F)}f.appendChild(D(b,v))}b.formState.showTotals&&u(b,f,n,h)}w(b,f),e.appendChild(f),e=a(e)(b),b.$broadcast("refreshFixedColumns")},L.getUniqueJournalThemes=function(a){return d(a)},L.getCapacityByCode=function(a,b){return e(a,b)},L.getLegendByWeek=function(a,b){return f(a,b)},L.getCapacityTypes=function(a,b){return j(a,b)},L.getTeacherStudyLoad=function(a,b){return g(a,b)},L.getTeacherLoad=function(a,b,c){return k(a,b,c)},L.getPlannedLessonsTitle=function(a,b,c){var d=g(b,a);return d?I(d,c):""},L.getStudyLoadTitle=function(a,b,c,d){var e=g(b,a);return e?J(e,c,d):""},L.getStudyLoadSpTitle=function(a,b,c,d){var e=g(b,a);return e?K(e,c,d):""},L}]),angular.module("hitsaOis").factory("Menu",["$location","$rootScope","$route","ArrayUtils",function(a,b,c,d){function e(){x.push({name:"main.menu.academicCalendar.label",type:"link",url:"/academicCalendar",icon:"date_range"}),x.push({name:"main.menu.viewTimetable.label",type:"link",url:"/timetable/generalTimetable/group",icon:"access_time"}),x.push({name:"main.menu.curriculum.label",type:"toggle",icon:"format_list_bulleted",pages:[{name:"main.menu.basemodule.label",url:"/basemodule?_menu",icon:"format_list_bulleted",studyLevel:{vocational:!0}},{name:"main.menu.curriculum.schoolCurriculums",url:"/curriculum?_menu",icon:"format_list_bulleted"},{name:"main.menu.curriculum.subjects",url:"/subject?_menu",studyLevel:{higher:!0},icon:"subject"},{name:"main.menu.curriculum.stateCurriculums",url:"/stateCurriculum?_menu",icon:"playlist_add_check",studyLevel:{vocational:!0}}]}),x.push({name:"main.menu.student.label",type:"toggle",icon:"person",pages:[{name:"main.menu.student.studentInfo",url:"/students?_menu",icon:"person"},{name:"main.menu.student.studentGroups",url:"/studentgroups?_menu",icon:"group"},{name:"main.menu.student.absences",url:"/absences?_menu",icon:"announcement",studyLevel:{vocational:!0}},{name:"main.menu.study.groupAbsences",url:"/groupAbsences?_menu",icon:"announcement",studyLevel:{vocational:!0}},{name:"main.menu.study.remarks",url:"/remarks?_menu",icon:"warning",studyLevel:{vocational:!0}},{name:"main.menu.student.resultCard",url:"/studentResultCards?_menu",icon:"announcement",studyLevel:{vocational:!0}},{name:"main.menu.student.studentCard",url:"/studentCards?_menu",icon:"announcement",studyLevel:{vocational:!0}},{name:"main.menu.student.boardingSchool",url:"/boardingSchools?_menu",icon:"home"},{name:"main.menu.student.rrChanges",url:"/rr/changelogs?_menu",icon:"view_week"}]}),x.push({nameHigher:"main.menu.teachers.labelHigher",nameVocational:"main.menu.teachers.labelVocational",type:"link",url:"/teachers?_menu",icon:"supervisor_account"}),x.push({name:"main.menu.documents.label",type:"toggle",icon:"library_books",pages:[{name:"main.menu.documents.applications",url:"/applications?_menu",icon:"font_download"},{name:"main.menu.documents.directives",url:"/directives?_menu",icon:"description"},{name:"main.menu.documents.certificates",url:"/certificate?_menu",icon:"folder_shared"},{name:"main.menu.scholarships.grantApplications",
url:"/scholarships/applications/grants?_menu",icon:"euro_symbol",studyLevel:{vocational:!0}},{name:"main.menu.scholarships.scholarshipApplications",url:"/scholarships/applications/scholarships?_menu",icon:"euro_symbol",studyLevel:{higher:!0}},{name:"main.menu.scholarships.drGrantApplications",url:"/scholarships/applications/drGrants?_menu",icon:"functions",studyLevel:{doctoral:!0}},{name:"main.menu.documents.representativeApplications",url:"/studentrepresentatives/applications?_menu",icon:"explicit"}]}),x.push({name:"main.menu.practice.label",type:"toggle",icon:"local_parking",pages:[{name:"main.menu.practice.practiceEnterprises",url:"/practice/enterprise?_menu",icon:"search"},{name:"main.menu.practice.practiceApplications",url:"/practice/applications?_menu",icon:"font_download"},{name:"main.menu.practice.practiceEvaluations",url:"/practice/evaluation?_menu",icon:"rate_review"},{name:"main.menu.practice.practiceContracts",url:"/contracts?_menu",icon:"assignment"},{name:"main.menu.practice.statistics",url:"/practice/student/statistics?_menu",icon:"blur_circular"},{name:"main.menu.practice.studentgroupContracts",url:"/practice/studentgroup/contracts?_menu",icon:"assignment"}]}),x.push({name:"main.menu.study.label",type:"toggle",icon:"work",pages:[{name:"main.menu.study.declarations",url:"/declarations?_menu",icon:"perm_contact_calendar",studyLevel:{higher:!0}},{name:"main.menu.study.journal.journalsVocational",url:"/journals?_menu",icon:"chrome_reader_mode",studyLevel:{vocational:!0}},{name:"main.menu.study.practiceJournal.label",url:"/practiceJournals?_menu",icon:"assignment_ind"},{name:"main.menu.study.material.higher",url:"/studyMaterial/higher?_menu",icon:"attach_file",studyLevel:{higher:!0}},{name:"main.menu.study.material.vocational",url:"/studyMaterial/vocational?_menu",icon:"attach_file",studyLevel:{vocational:!0}},{name:"main.menu.study.examTimes",url:"/examTimes?_menu",icon:"watch",studyLevel:{higher:!0}},{name:"main.menu.study.moduleProtocol.label",url:"/moduleProtocols?_menu",icon:"border_color",studyLevel:{vocational:!0}},{name:"main.menu.study.protocol.search",url:"/higherProtocols?_menu",icon:"create",studyLevel:{higher:!0}},{name:"main.menu.study.apel",url:"/apelApplication?_menu",icon:"transfer_within_a_station"}]}),x.push({name:"main.menu.studyPreparation.label",type:"toggle",icon:"settings",pages:[{name:"main.menu.studyPreparation.subjectTeacher",url:"/subjectStudyPeriods?_menu",icon:"nature_people",studyLevel:{higher:!0}},{name:"main.menu.studyPreparation.studyYearSchedule.legend",url:"/studyYearScheduleLegend?_menu",icon:"event_note",studyLevel:{vocational:!0}},{name:"main.menu.studyPreparation.studyYearSchedule.edit",url:"/studyYearSchedule?_menu",icon:"event_available",studyLevel:{vocational:!0}},{name:"main.menu.studyPreparation.lessonTime",id:"timetableLessonTimeSearch",url:"/timetable/lessonTime/search?_menu",icon:"notifications_active"},{name:"main.menu.studyPreparation.lessonplans.vocational",id:"timetableLessonTimeSearch",url:"/lessonplans/vocational?_menu",icon:"zoom_out_map",studyLevel:{vocational:!0}},{name:"main.menu.studyPreparation.subjectStudyPeriods.plans",url:"/subjectStudyPeriodPlans?_menu",icon:"fitness_center",studyLevel:{higher:!0}},{name:"main.menu.studyPreparation.subjectStudyPeriods.label",url:"/subjectStudyPeriods/studentGroups?_menu",icon:"open_with",studyLevel:{higher:!0}},{name:"main.menu.studyPreparation.timetableManagement.label",url:"/timetable/timetableManagement?_menu",icon:"update"},{name:"main.menu.studyPreparation.events.label",url:"/lessonplans/events?_menu",icon:"star_border"}]}),x.push({name:"main.menu.poll.label",type:"toggle",icon:"question_answer",pages:[{name:"main.menu.poll.data",url:"/poll?_menu",icon:"search"},{name:"main.menu.poll.answers",url:"/poll/answers?_menu",icon:"reply"},{name:"main.menu.poll.questions",url:"/poll/questions?_menu",icon:"chat"},{name:"main.menu.poll.statistics",url:"/poll/statistics?_menu",icon:"blur_circular"}]}),x.push({name:"main.menu.reports.label",type:"toggle",icon:"search",pages:[{name:"main.menu.reports.students",url:"/reports/students/students?_menu",icon:"person"},{name:"main.menu.reports.studentstatistics",url:"/reports/students/statistics?_menu",icon:"blur_circular"},{name:"main.menu.reports.studentstatisticsbyperiod",url:"/reports/students/statistics/byperiod?_menu",icon:"equalizer"},{name:"main.menu.reports.curriculumscompletion",url:"/reports/curriculums/completion?_menu",icon:"perm_contact_calendar"},{nameHigher:"main.menu.reports.teachersLoadVocationalHigher",nameVocational:"main.menu.reports.teachersLoadVocational",url:"/reports/teachers/load/vocational?_menu",icon:"grain",studyLevel:{vocational:!0}},{name:"main.menu.reports.teachersLoadHigher",url:"/reports/teachers/load/higher?_menu",icon:"gradient",studyLevel:{higher:!0}},{name:"main.menu.reports.teachersLoadDetailVocational",url:"/reports/teachers/detailload/vocational?_menu",icon:"grain",studyLevel:{vocational:!0}},{name:"main.menu.reports.teachersLoadDetailHigher",url:"/reports/teachers/detailload/higher?_menu",icon:"gradient",studyLevel:{higher:!0}},{name:"main.menu.reports.vota",url:"/reports/vota?_menu",icon:"transfer_within_a_station"},{name:"main.menu.reports.individualCurriculumStatistics",url:"/reports/individualcurriculum/statistics?_menu",icon:"face",studyLevel:{vocational:!0}},{name:"main.menu.reports.studentGroupTeacher",url:"/reports/studentgroupteacher?_menu",icon:"accessibility_new",studyLevel:{vocational:!0}},{name:"main.menu.scholarshipStatistics.label",url:"/reports/scholarships?_menu",icon:"euro_symbol"}]}),x.push({name:"main.menu.graduation.label",type:"toggle",icon:"school",pages:[{name:"main.menu.graduation.committees",url:"/committees/KOMISJON_K?_menu",icon:"record_voice_over"},{name:"main.menu.graduation.finalThesis",url:"/finalThesis?_menu",icon:"receipt"},{name:"main.menu.graduation.forms",url:"/forms?_menu",icon:"format_bold"},{name:"main.menu.graduation.documentsPrintHigher",url:"/documents/diplomas?_menu",icon:"print",studyLevel:{higher:!0}},{name:"main.menu.graduation.documentsPrintVocational",url:"/documents/diplomas/vocational?_menu",icon:"print",studyLevel:{vocational:!0}},{name:"main.menu.graduation.documents",url:"/documents?_menu",icon:"print"},{name:"main.menu.graduation.finalProtocolsHigher",url:"/finalHigherProtocols?_menu",icon:"create",studyLevel:{higher:!0}},{name:"main.menu.graduation.finalProtocolsVocational",url:"/finalVocationalProtocols?_menu",icon:"border_color",studyLevel:{vocational:!0}}]}),x.push({name:"main.menu.dataexchange.label",type:"toggle",icon:"swap_vert",pages:[{name:"main.menu.dataexchange.teacherinfoExportHigher",id:"teacherinfoExport",url:"/ehis/teacher/export/higher?_menu",icon:"account_box",studyLevel:{higher:!0}},{name:"main.menu.dataexchange.teacherinfoExportVocational",id:"teacherinfoExport",url:"/ehis/teacher/export/vocational?_menu",icon:"account_circle",studyLevel:{vocational:!0}},{name:"main.menu.dataexchange.studentinfoExport",url:"/ehis/student/export?_menu",icon:"person"},{name:"main.menu.dataexchange.kutseregister",url:"/occupationcertificate/import?_menu",icon:"android"},{name:"main.menu.dataexchange.rtip",url:"/rtip/sync?_menu",icon:"weekend"},{name:"main.menu.dataexchange.ehisLogs",url:"/ehis/logs?_menu",icon:"view_list"},{name:"main.menu.dataexchange.ekisLogs",url:"/ekis/logs?_menu",icon:"view_stream"},{name:"main.menu.dataexchange.kutseregisterLogs",url:"/kutseregister/logs?_menu",icon:"view_day"},{name:"main.menu.dataexchange.rtipLogs",url:"/rtip/logs?_menu",icon:"view_array"},{name:"main.menu.dataexchange.saisLogs",url:"/sais/logs?_menu",icon:"view_module"},{name:"main.menu.dataexchange.rrLogs",url:"/rr/logs?_menu",icon:"view_week"}]}),x.push({name:"main.menu.reception.label",type:"toggle",icon:"group_add",pages:[{name:"main.menu.reception.saisAdmission.label",id:"receptionSaisAdmissionSearch",url:"/reception/saisAdmission/search?_menu",icon:"brightness_high"},{name:"main.menu.reception.saisApplication.label",id:"receptionSaisApplicationSearch",url:"/reception/saisApplication/search?_menu",icon:"spellcheck"},{name:"main.menu.reception.saisAdmission.importSais",id:"receptionSaisAdmissionImport",url:"/reception/saisAdmission/import?_menu",icon:"brightness_low"},{name:"main.menu.reception.saisApplication.importSais",id:"receptionSaisApplicationImport",url:"/reception/saisApplication/import?_menu",icon:"brightness_auto"}]}),x.push({name:"main.menu.settings.label",type:"toggle",icon:"build",pages:[{name:"main.menu.settings.studyYears",url:"/school/studyYears",icon:"format_align_center"},{name:"main.menu.settings.studyLevels",url:"/school/studyLevels",icon:"layers"},{name:"main.menu.settings.capacityTypes",url:"/school/capacityTypes",icon:"bubble_chart"},{name:"main.menu.settings.generalmessages",url:"/generalmessages?_menu",icon:"notifications_none"},{name:"main.menu.scholarships.grants",url:"/scholarships/grants?_menu",icon:"euro_symbol",studyLevel:{vocational:!0}},{name:"main.menu.scholarships.scholarships",url:"/scholarships/scholarships?_menu",icon:"euro_symbol",studyLevel:{higher:!0}},{name:"main.menu.scholarships.drGrants",url:"/scholarships?_menu",icon:"functions",studyLevel:{doctoral:!0}},{name:"main.menu.settings.scholarshipCommittees",url:"/committees/KOMISJON_T?_menu",icon:"record_voice_over"},{name:"main.menu.settings.messageTemplates",url:"/messageTemplate?_menu",icon:"blur_linear"},{name:"main.menu.settings.documentcoordinators",url:"/directives/coordinators?_menu",icon:"recent_actors"},{name:"main.menu.settings.finaldocsigners",url:"/school/finaldocsigners?_menu",icon:"recent_actors"},{nameHigher:"main.menu.settings.teacheroccupationsHigher",nameVocational:"main.menu.settings.teacheroccupationsVocational",url:"/school/teacheroccupations?_menu",icon:"business_center"},{name:"main.menu.settings.buildings",url:"/rooms/search?_menu",icon:"business"},{name:"main.menu.settings.departments",url:"/school/departments?_menu",icon:"device_hub"},{name:"main.menu.settings.users",id:"users",url:"/persons?_menu",icon:"wc"},{name:"main.menu.settings.apelSchools",url:"/apelSchools?_menu",icon:"location_city"},{name:"main.menu.settings.apelCommittees",url:"/committees/KOMISJON_V?_menu",icon:"record_voice_over"},{name:"main.menu.settings.supportCommittees",url:"/committees/KOMISJON_A?_menu",icon:"record_voice_over",studyLevel:{vocational:!0}},{name:"main.menu.settings.studentGroupYearTransfer",url:"/studentGroupYearTransfer?_menu",icon:"sync"}]})}function f(a){x.push({name:"main.menu.curriculums.label",url:"/curriculum?_menu",type:"link",icon:"format_list_bulleted"}),x.push({name:"main.menu.subjects.label",url:"/subject?_menu",type:"link",icon:"subject",studyLevel:{higher:!0}}),x.push({name:"main.menu.timetableAndEvents.label",type:"toggle",icon:"access_time",pages:[{name:"main.menu.timetableAndEvents.timetable",url:"/timetable/personalGeneralTimetable?_menu",icon:"access_time"},{name:"main.menu.timetableAndEvents.events",url:"/lessonplans/events?_menu",icon:"star_border"}]}),x.push({name:"main.menu.myData.label",url:"/teachers/myData",type:"link",icon:"person_outline"}),x.push({name:"main.menu.academicCalendar.label",type:"link",url:"/academicCalendar",icon:"date_range"}),x.push({name:"main.menu.studyPreparation.studyYearSchedule.edit",url:"/studyYearSchedule?_menu",type:"link",icon:"event_available",studyLevel:{vocational:!0}}),x.push({name:"main.menu.study.label",type:"toggle",icon:"work",pages:[{name:"main.menu.study.examTimes",url:"/examTimes?_menu",icon:"watch",studyLevel:{higher:!0}},{name:"main.menu.study.absences",url:"/absences?_menu",icon:"announcement",studyLevel:{vocational:!0}},{name:"main.menu.study.groupAbsences",url:"/groupAbsences?_menu",icon:"announcement",studyLevel:{vocational:!0}},{name:"main.menu.study.remarks",url:"/remarks?_menu",icon:"warning",studyLevel:{vocational:!0},studentGroupTeacher:!0},{name:"main.menu.study.journal.journalsVocational",url:"/journals?_menu",icon:"chrome_reader_mode",studyLevel:{vocational:!0}},{name:"main.menu.study.subjectTeacher",url:"/subjectStudyPeriods?_menu",icon:"nature_people",studyLevel:{higher:!0}},{name:"main.menu.subjectProgram.label",url:"/subjectProgram?_menu",icon:"description",studyLevel:{higher:!0}},{name:"main.menu.study.material.higher",url:"/studyMaterial/higher?_menu",icon:"attach_file",studyLevel:{higher:!0}},{name:"main.menu.study.material.vocational",url:"/studyMaterial/vocational?_menu",icon:"attach_file",studyLevel:{vocational:!0}},{name:"main.menu.study.loads",url:"/lessonplans/vocational/byteacher?_menu",icon:"zoom_out_map"},{name:"main.menu.study.students",url:"/students?_menu",icon:"person"},{name:"main.menu.study.moduleProtocol.label",url:"/moduleProtocols?_menu",icon:"border_color",studyLevel:{vocational:!0}},{name:"main.menu.study.protocol.search",url:"/higherProtocols?_menu",icon:"create",studyLevel:{higher:!0}}]}),x.push({name:"main.menu.poll.label",type:"toggle",icon:"question_answer",pages:[{name:"main.menu.poll.answers",url:"/poll/answers?_menu",icon:"reply"},{name:a.higher?"main.menu.poll.subjects":"main.menu.poll.journals",url:"/poll/answers/subjects?_menu",icon:"assignment_return"}]}),x.push({name:"main.menu.scholarships.grantApplications",url:"/scholarships/applications/grants?_menu",type:"link",icon:"euro_symbol",studyLevel:{vocational:!0}}),x.push({type:"link",name:"main.menu.documents.applications",url:"/applications?_menu",icon:"font_download"}),x.push({name:"main.menu.scholarships.scholarshipApplications",url:"/scholarships/applications/scholarships?_menu",type:"link",icon:"euro_symbol",studyLevel:{higher:!0}}),x.push({name:"main.menu.scholarships.drGrantApplications",url:"/scholarships/applications/drGrants?_menu",type:"link",icon:"functions",studyLevel:{doctoral:!0}}),x.push({name:"main.menu.practiceAndGraduation.label",type:"toggle",icon:"school",pages:[{name:"main.menu.practiceAndGraduation.practiceJournals",url:"/practiceJournals?_menu",icon:"assignment_ind"},{name:"main.menu.practiceAndGraduation.committees",url:"/committees/KOMISJON_K?_menu",icon:"record_voice_over"},{name:"main.menu.practiceAndGraduation.finalThesis",url:"/finalThesis?_menu",icon:"receipt"},{name:"main.menu.graduation.finalProtocolsHigher",url:"/finalHigherProtocols?_menu",icon:"create",studyLevel:{higher:!0}},{name:"main.menu.graduation.finalProtocolsVocational",url:"/finalVocationalProtocols?_menu",icon:"border_color",studyLevel:{vocational:!0}}]}),x.push({name:"main.menu.apel.label",type:"link",url:"/apelApplication?_menu",icon:"transfer_within_a_station"}),x.push({name:"main.menu.individualCurriculumStatistics.label",type:"link",url:"/reports/individualcurriculum/statistics?_menu",icon:"face",studyLevel:{vocational:!0},studentGroupTeacher:!0}),x.push({name:"main.menu.studentGroupTeacher.label",type:"link",url:"/reports/studentgroupteacher?_menu",icon:"accessibility_new",studyLevel:{vocational:!0},studentGroupTeacher:!0})}function g(){x.push({name:"main.menu.curriculum.label",type:"toggle",icon:"format_list_bulleted",pages:[{name:"main.menu.curriculum.stateCurriculums",url:"/stateCurriculum?_menu",icon:"playlist_add_check"}]}),x.push({name:"main.menu.mainData.label",type:"toggle",icon:"build",pages:[{name:"main.menu.mainData.schools",url:"/school?_menu",icon:"account_balance"},{name:"main.menu.mainData.classifiers",url:"/classifier?_menu",icon:"format_list_numbered"},{name:"main.menu.mainData.saisClassifiers",url:"/saisClassifier?_menu",icon:"brightness_medium"},{name:"main.menu.mainData.occupationStandards",url:"/occupationstandard?_menu",icon:"android"},{name:"main.menu.dataexchange.kutseregisterLogs",url:"/kutseregister/logs?_menu",icon:"view_module"},{name:"main.menu.mainData.users",url:"/persons?_menu",icon:"wc"}]}),x.push({name:"main.menu.mainData.generalMessages",type:"link",url:"/generalmessages?_menu",icon:"notifications_none"}),x.push({name:"main.menu.timetableLink.label",type:"link",url:"/timetables?_menu",icon:"access_time"})}function h(a){x.push({name:"main.menu.curriculums.label",url:"/curriculum?_menu",type:"link",icon:"format_list_bulleted"}),x.push({name:"main.menu.subjects.label",url:"/subject?_menu",type:"link",studyLevel:{higher:!0},icon:"subject"}),x.push({name:"main.menu.timetableLink.label",type:"link",url:"/timetable/personalGeneralTimetable?_menu",icon:"access_time"}),x.push({name:"main.menu.myData.label",url:"/students/myData",type:"link",icon:"person_outline"}),x.push({name:"main.menu.academicCalendar.label",type:"link",url:"/academicCalendar",icon:"date_range"}),x.push({name:"main.menu.studyPreparation.studyYearSchedule.edit",url:"/studyYearSchedule?_menu",type:"link",icon:"event_available",studyLevel:{vocational:!0}}),x.push({name:"main.menu.myStudyInformation.label",type:"toggle",icon:"work",pages:[{name:"main.menu.myStudyInformation.journal",url:"/students/journals",icon:"chrome_reader_mode",studyLevel:{vocational:!0}},{name:"main.menu.myStudyInformation.practiceApplications",url:"/practice/application/myData?_menu",icon:"font_download"},{name:"main.menu.myStudyInformation.practiceJournals",url:"/practiceJournals?_menu",icon:"assignment_ind"},{name:"main.menu.myStudyInformation.results",url:"/students/myResults",icon:"timeline"},{name:"main.menu.myStudyInformation.declaration",url:"/declaration/current/view",icon:"perm_contact_calendar",studyLevel:{higher:!0}},{name:"main.menu.myStudyInformation.examRegistration",url:"/examRegistration?_menu",icon:"border_color",studyLevel:{higher:!0}},{name:"main.menu.myStudyInformation.finalThesisInput",url:"/finalThesis?_menu",icon:"receipt"},{name:"main.menu.myStudyInformation.otherStudents",url:"/students?_menu",icon:"person"}]}),x.push({name:"main.menu.poll.label",type:"link",icon:"question_answer",url:"/poll/answers?_menu"}),x=x.concat(l(a)),x.push({name:"main.menu.documents.label",type:"toggle",icon:"library_books",pages:[{name:"main.menu.documents.applications",url:"/applications/student?_menu",icon:"font_download"},{name:"main.menu.documents.certificates",url:"/certificate?_menu",icon:"folder_shared"},{name:"main.menu.documents.practiceContracts",url:"/contracts?_menu",icon:"assignment"},{name:"main.menu.documents.apel",url:"/apelApplication?_menu",icon:"transfer_within_a_station"}]})}function i(){x.push({name:"main.menu.curriculum.label",type:"toggle",icon:"format_list_bulleted",pages:[{name:"main.menu.curriculum.schoolCurriculums",url:"/curriculum?_menu",icon:"format_list_bulleted"},{name:"main.menu.curriculum.stateCurriculums",url:"/stateCurriculum?_menu",icon:"playlist_add_check"}]}),x.push({name:"main.menu.teachers.labelVocational",type:"link",url:"/teachers?_menu",icon:"supervisor_account"}),x.push({name:"main.menu.timetableLink.label",type:"link",url:"/timetables?_menu",icon:"access_time"})}function j(){x.push({name:"main.menu.curriculums.label",url:"/curriculum?_menu",type:"link",icon:"format_list_bulleted"}),x.push({name:"main.menu.subjects.label",url:"/subject?_menu",type:"link",studyLevel:{higher:!0},icon:"subject"}),x.push({name:"main.menu.timetableLink.label",type:"link",url:"/timetable/personalGeneralTimetable?_menu",icon:"access_time"}),x.push({name:"main.menu.studentRepresentative.label",type:"link",url:"/students/myData",icon:"person_outline"}),x.push({name:"main.menu.academicCalendar.label",type:"link",url:"/academicCalendar",icon:"date_range"}),x.push({name:"main.menu.studyPreparation.studyYearSchedule.edit",url:"/studyYearSchedule?_menu",type:"link",icon:"event_available",studyLevel:{vocational:!0}}),x.push({name:"main.menu.studentStudyInformation.label",type:"toggle",icon:"work",pages:[{name:"main.menu.studentStudyInformation.journal",url:"/students/journals",icon:"chrome_reader_mode",studyLevel:{vocational:!0}},{name:"main.menu.studentStudyInformation.practiceJournal",url:"/practiceJournals?_menu",icon:"assignment_ind"},{name:"main.menu.studentStudyInformation.results",url:"/students/myResults",icon:"timeline"}]}),x.push({name:"main.menu.poll.label",type:"link",icon:"question_answer",url:"/poll/answers?_menu"}),x.push({name:"main.menu.documents.label",type:"toggle",icon:"library_books",pages:[{name:"main.menu.documents.applications",url:"/applications/student?_menu",icon:"font_download"},{name:"main.menu.documents.certificates",url:"/certificate?_menu",icon:"folder_shared"}]})}function k(){x.push({name:"main.menu.academicCalendar.label",type:"link",url:"/academicCalendars",icon:"date_range"}),x.push({name:"main.menu.timetableLink.label",type:"link",url:"/timetables",icon:"access_time"}),x.push({name:"main.menu.curriculum.schoolCurriculums",type:"link",url:"/curriculums?_menu",icon:"list"}),x.push({name:"main.menu.curriculum.stateCurriculums",type:"link",url:"/stateCurriculum/public?_menu",icon:"playlist_add_check"}),x.push({name:"main.menu.subjects.label",url:"/subject/public?_menu",type:"link",icon:"subject"})}function l(a){var b=[];return a.higher?(b.push({name:"main.menu.scholarships.scholarships",type:"link",url:"/scholarships/myData/scholarships?_menu",icon:"euro_symbol"}),b.push({name:"main.menu.scholarships.drGrants",type:"link",url:"/scholarships/myData/drGrants?_menu",icon:"functions",studyLevel:{doctoral:!0}})):b.push({name:"main.menu.scholarships.grants",type:"link",icon:"euro_symbol",url:"/scholarships/myData/grants?_menu"}),b}function m(){var b=a.path();if("/"===b)return w.selectSection(null),void w.selectPage(null,null);if("/messages/received"===b){var c={name:"message.messages",type:"link",url:b};return w.selectSection(c),void w.selectPage(c,c)}if("/studentrepresentatives/applications/new"===b){var c={name:"student.representative.title",type:"link",url:b};return w.selectSection(c),void w.selectPage(c,c)}for(var d=function(a,c){return c.url.replace(/(\?_menu)$/,"")===b?(w.selectSection(a),w.selectPage(a,c),!0):!1},e=!1,f=0;f<y.length&&!e;f++){var g=y[f];if(g.children)for(var h=0;h<g.children.length&&!e;h++){var i=g.children[h];if(i.pages)for(var j=0;j<i.pages.length&&!e;j++)e=d(i,i.pages[j])}else if(g.pages)for(var k=0;k<g.pages.length&&!e;k++)e=d(g,g.pages[k]);else"link"===g.type&&(e=d(g,g))}}function n(a,b,e){var f=!1,g=a.url.replace(/(\?_menu)$/,""),h=c.routes,i=null;for(var j in h)if(h.hasOwnProperty(j)&&h[j].regexp&&h[j].regexp.test(g)){i=h[j];break}if(i&&i.hasOwnProperty("data")){if(i=i.data.authorizedRoles,angular.isFunction(i))f=i(e,b,d);else if(-1!==i.lastIndexOf(""))f=!0;else for(var k=0;k<i.length;k++)if(-1!==b.indexOf(i[k])){f=!0;break}}else f=!0;return f}function o(a,b){return angular.isDefined(a.studyLevel)&&angular.isDefined(b.school)&&null!==b.school?b.higher&&a.studyLevel.higher||b.vocational&&a.studyLevel.vocational||b.doctoral&&a.studyLevel.doctoral:!0}function p(a,b){return a.studentGroupTeacher&&b.teacherGroupIds.length>0}function q(a,b,c,d){if(b.pages.length>0)for(var e=0;e<b.pages.length;e++)s(a,b.pages[e],c,d);a.length>0&&y.push({name:t(b,d),type:"toggle",pages:a,icon:b.icon})}function r(a,b,c){n(a,b,c)&&a.url&&o(a,c)&&(!angular.isDefined(a.studentGroupTeacher)||p(a,c))&&y.push({name:t(a,c),type:a.type,url:a.url,icon:a.icon})}function s(a,b,c,d){n(b,c,d)&&b.url&&o(b,d)&&(!angular.isDefined(b.studentGroupTeacher)||p(b,d))&&a.push({name:t(b,d),id:b.id,url:b.url,icon:b.icon})}function t(a,b){return b.higher&&a.nameHigher?a.nameHigher:b.vocational&&a.nameVocational?a.nameVocational:a.name}function u(a){switch(x=[],a.roleCode){case"ROLL_A":e(a);break;case"ROLL_P":g();break;case"ROLL_O":f(a);break;case"ROLL_T":h(a);break;case"ROLL_L":j();break;case"ROLL_V":i();break;default:k()}}function v(a){var b=a.authorizedRoles||[""];y=[],u(a);for(var c=0;c<x.length;c++){var d=[];"toggle"===x[c].type?q(d,x[c],b,a):"link"===x[c].type&&r(x[c],b,a)}w.sections=y,m()}var w,x=[],y=[];return b.$on("$locationChangeSuccess",m),w={sections:{},setMenu:function(a){v(a)},selectSection:function(a){w.openedSection=a},toggleSelectSection:function(a){w.openedSection=w.openedSection===a?null:a},isSectionSelected:function(a){return w.openedSection===a},selectPage:function(a,b){w.currentSection=a,w.currentPage=b},isPageSelected:function(a){return w.currentPage===a}}}]),angular.module("hitsaOis").factory("message",["$mdToast","$translate","$rootScope",function(a,b,c){function d(a){if("object"==typeof a){var b=c.currentLanguageNameField(a);if(b)return b}return a}function e(b,c){a.show(a.simple().textContent(b).hideDelay(3e3).position("top").toastClass(c))}function f(a,c,f){var g={};for(var h in f)g[h]=d(f[h]);b(a,g).then(function(a){e(a,c)})["catch"](function(){e(a,c)})}var g={};return g.info=function(a,b){f(a,"toastInfo",b)},g.warn=function(a,b){f(a,"toastWarn",b)},g.error=function(a,b){f(a,"toastError",b)},g.updateSuccess=function(){f("main.messages.update.success","toastInfo")},g}]),angular.module("hitsaOis").factory("oisFileService",["config",function(a){var b={};return b.getFromLfFile=function(a,b){var c={},d=new FileReader;return d.onloadend=function(){c.fname=a.lfFileName,c.ftype=a.lfFile.type,a.lfFile.size>0?c.fdata=d.result.replace("data:"+c.ftype+";base64,",""):c.fdata="",angular.isFunction(b)&&b(c)},d.readAsDataURL(a.lfFile),c},b.getFileUrl=function(a){return"data:"+a.ftype+";base64,"+a.fdata},b.getUrl=function(c,d){return c?c.oisFile?c.id?a.apiUrl+"/oisfile/get/"+d+"/"+c.oisFile.id:b.getFileUrl(c.oisFile):c.id?a.apiUrl+"/oisfile/get/"+d+"/"+c.id:b.getFileUrl(c):void 0},b}]),angular.module("hitsaOis").factory("ProtocolUtils",["$mdDialog","$timeout","$rootScope","$window","QueryUtils","config","dialogService","message",function(a,b,c,d,e,f,g,h){function i(d,g,j,k){e.endpoint(d+"/mobileSignStatus").get(function(l){"SIGNATURE"===l.status?(a.hide(),e.endpoint(d+"/mobileSignFinalize").save({version:c.signVersion},function(a){h.info(g),j(a)},function(a){angular.isFunction(k)&&k(a)})):"OUTSTANDING_TRANSACTION"===l.status?(c.mobileIdPolls++,c.mobileIdPolls<f.mobileIdMaxPolls&&b(function(){i(d,g,j)},f.mobileIdPollInterval)):(a.hide(),h.error("main.messages.error.mobileIdSignFailed"),angular.isFunction(k)&&k())})}function j(a){if(!angular.isDefined(a)||!angular.isArray(a.protocolStudents))return!1;for(var b=!0,c=0;c<a.protocolStudents.length;c++)if(!angular.isString(a.protocolStudents[c].grade)||0===a.protocolStudents[c].grade.trim().length){b=!1;break}return b}function k(a){if(!angular.isDefined(a)||!angular.isArray(a.protocolStudents))return!1;var b=!0;if("PROTOKOLL_STAATUS_K"===a.status.code)for(var c=0;c<a.protocolStudents.length;c++)if(a.protocolStudents[c].gradeHasChanged){var d=a.protocolStudents[c].addInfo;if(d=void 0!==d&&null!==d?d.split(" ").join(""):null,!d){b=!1;break}}return b}var l={},m=["LOGIN_TYPE_I","LOGIN_TYPE_M","LOGIN_TYPE_T","LOGIN_TYPE_H"];return l.signBeforeConfirm=function(a,b,c,d,e,f){"LOGIN_TYPE_I"===a.loginMethod?l.idcardSignBeforeConfirm(b,c,d,e,f):"LOGIN_TYPE_M"===a.loginMethod?l.mobileSignBeforeConfirm(b,c,d,e,f):("LOGIN_TYPE_T"===a.loginMethod||"LOGIN_TYPE_H"===a.loginMethod)&&g.showDialog("components/tara.protocol.confirm.dialog.html",function(a){a.signType=null,a.idcard=function(){a.signType="IDCARD",a.submit()},a.mobileid=function(){a.signType="MOBILE_ID",a.submit()}},function(a){"IDCARD"===a.signType?l.idcardSignBeforeConfirm(b,c,d,e,f):"MOBILE_ID"===a.signType&&l.mobileSignBeforeConfirm(b,c,d,e,f)},function(){h.error("main.messages.error.signingCancelled"),angular.isFunction(f)&&f()})},l.idcardSignBeforeConfirm=function(a,b,c,f,g){d.hwcrypto.getCertificate({lang:"en"}).then(function(i){b.certificate=i.hex,e.endpoint(a+"/signToConfirm").save(b,function(b){d.hwcrypto.sign(i,{type:"SHA-256",hex:b.digestToSign},{lang:"en"}).then(function(d){e.endpoint(a+"/signToConfirmFinalize").save({signature:d.hex,version:b.version},function(a){h.info(c),f(a)},function(a){angular.isFunction(g)&&g(a)})})})})["catch"](function(a){"user_cancel"===a.message?h.error("main.messages.error.signingCancelled"):h.error("main.messages.error.readingIdCardFailed"),angular.isFunction(g)&&g(a)})},l.mobileSignBeforeConfirm=function(d,g,j,k,l){e.endpoint(d+"/mobileSignToConfirm").save(g,function(e){e.challengeID?(c.signVersion=e.version,a.show({controller:["$scope",function(a){a.challengeID=e.challengeID}],templateUrl:"finalProtocol/templates/final.protocol.mobile.sign.dialog.html",parent:angular.element(document.body),clickOutsideToClose:!1}),c.mobileIdPolls=0,b(i(d,j,k,l),f.mobileIdInitialDelay)):(h.error("main.messages.error.mobileIdSignFailed"),angular.isFunction(l)&&l())})},l.canEditProtocol=function(a,b){return"PROTOKOLL_STAATUS_K"===b.status.code?l.canEditConfirmedProtocol(a,b):b.canBeEdited},l.canChangeConfirmedProtocolGrade=function(a,b){return l.canEditProtocol(a,b)&&"PROTOKOLL_STAATUS_K"===b.status.code},l.canEditConfirmedProtocol=function(a,b){return b.canBeEdited&&b.canBeConfirmed&&-1!==m.indexOf(a.loginMethod)},l.canAddDeleteStudents=function(a,b){return"PROTOKOLL_STAATUS_K"!==b.status.code&&l.canEditProtocol(a,b)},l.canConfirm=function(a,b){return b.canBeConfirmed&&j(b)&&k(b)&&-1!==m.indexOf(a.loginMethod)},l}]),angular.module("hitsaOis").service("sharedProperties",SharedPropertiesService),angular.module("hitsaOis").factory("stateStorageService",["$sessionStorage",function(a){var b={};return b.loadState=function(b,c){var d=a[c]||"{}",e=JSON.parse(d);return e[b]||{}},b.changeState=function(c,d,e){var f={};f[c]=angular.extend(b.loadState(c,d),e),a[d]=JSON.stringify(angular.extend(JSON.parse(a[d]||"{}"),f))},b}]),angular.module("hitsaOis").constant("VocationalGrade",{KUTSEHINDAMINE_5:"KUTSEHINDAMINE_5",KUTSEHINDAMINE_4:"KUTSEHINDAMINE_4",KUTSEHINDAMINE_3:"KUTSEHINDAMINE_3",KUTSEHINDAMINE_2:"KUTSEHINDAMINE_2",KUTSEHINDAMINE_1:"KUTSEHINDAMINE_1",KUTSEHINDAMINE_A:"KUTSEHINDAMINE_A",KUTSEHINDAMINE_MA:"KUTSEHINDAMINE_MA",KUTSEHINDAMINE_X:"KUTSEHINDAMINE_X"}).factory("VocationalGradeUtil",["VocationalGrade","ArrayUtils",function(a,b){var c=[a.KUTSEHINDAMINE_A,a.KUTSEHINDAMINE_3,a.KUTSEHINDAMINE_4,a.KUTSEHINDAMINE_5],d=[a.KUTSEHINDAMINE_1,a.KUTSEHINDAMINE_2,a.KUTSEHINDAMINE_3,a.KUTSEHINDAMINE_4,a.KUTSEHINDAMINE_5],e="KUTSEHINDAMINE_";return{isPositive:function(a){return b.includes(c,a)},isDistinctive:function(a){return b.includes(d,a)},removePrefix:function(a){return a.replace(e,"")},addPrefix:function(a){return e+a}}}]),angular.module("hitsaOis").factory("QueryUtils",["config","$resource","$route","$translate","message","resourceErrorHandler","$sessionStorage",function(a,b,c,d,e,f,g){var h={size:20,page:1},i=function(a){var b=angular.copy(a,{});angular.isNumber(b.page)&&(b.page=b.page-1),b.lang=d.use().toUpperCase();for(var c in b)b.hasOwnProperty(c)&&""===b[c]&&delete b[c];return b.order&&("-"===b.order[0]?b.sort=a.order.substring(1)+",desc":b.sort=a.order+",asc",delete b.order),b},j=function(a){for(var b in a)a.hasOwnProperty(b)&&"order"!==b&&"size"!==b&&"page"!==b&&delete a[b]},k=function(a,b,d,f,k,n){if(a.criteria=angular.extend({},h),a.directiveControllers=[],a.clearCriteria=function(){j(a.criteria),a.directiveControllers.forEach(function(a){a.clear()})},void 0===a.fromStorage&&(a.fromStorage=function(a){return JSON.parse(g[a]||"{}")}),a.toStorage=function(a,b){g[a]=JSON.stringify(b)},"_menu"in c.current.params||n)angular.extend(a.criteria,d);else{var o=a.fromStorage(b);angular.isNumber(o.page)&&(o.page=o.page+1),angular.extend(a.criteria,o)}a.getCriteria=function(){return i(a.criteria)},a.tabledata={};var p=function(b){try{a.afterLoadData(b)}finally{k&&m(a,!1)}};a.afterLoadData=function(b){a.tabledata.content=b.content,a.tabledata.totalElements=b.totalElements,0===b.totalElements&&e.info("main.messages.error.notFound"),angular.isFunction(f)&&f(b.content)};var q=function(){try{a.errorAfterLoadData()}finally{k&&m(a,!1)}};a.errorAfterLoadData=function(){k&&m(a,!1)},a.loadData=function(){k&&m(a,!0);var c=a.getCriteria();return n||a.toStorage(b,c),a.tabledata.$promise=l(b).search(c,p,q),a.tabledata.$promise}},l=function(c,d){var e=a.apiUrl+c,g=e+"/:id";return b(e,{},d||{save:{method:"POST",interceptor:f},save2:{method:"POST"},post:{method:"POST",isArray:!0,interceptor:f},post2:{method:"POST",isArray:!0},get:{method:"GET",url:g,interceptor:f},update:{method:"PUT",url:g,params:{
id:"@id"},interceptor:f},update2:{method:"PUT",url:g,params:{id:"@id"}},"delete":{method:"DELETE",url:g,params:{id:"@id",version:"@version"},interceptor:f},put:{method:"PUT",interceptor:f},put2:{method:"PUT"},putWithoutLoad:{method:"PUT",loading:!1,url:g,params:{id:"@id"},interceptor:f},search:{method:"GET",interceptor:f},query:{method:"GET",isArray:!0,interceptor:f}})},m=function(a,b,c,d,e,f){a.$root.$emit("backendBusy",{busy:b,isMultiple:c,text:d,value:e,onComplete:f})};return{getQueryParams:i,clearQueryParams:j,createQueryForm:k,endpoint:l,loadingWheel:m}}]).factory("busyHandler",["$mdDialog",function(a){function b(){g--,0===g&&h&&a.hide()}function c(a){i.value=a}function d(a){return{parent:angular.element(document.body),multiple:a.isMultiple?!0:!1,onComplete:a.onComplete?a.onComplete:void 0,onRemoving:function(){h=!1}}}function e(c){if(c.busy){if(g++,1===g&&!h){var e=d(c);angular.extend(e,{template:'<md-dialog style="background-color:transparent;box-shadow:none"><div layout="row" layout-sm="column" layout-align="center center" aria-label="wait" style="height:120px;"><md-progress-circular class="md-hue-2 loader" md-diameter="80px"></md-progress-circular></div>'+(c.text?'<h3 style="text-align:center; color: white; text-shadow: -1px -1px 0 #000,1px -1px 0 #000, -1px 1px 0 #000, 1px 1px 0 #000;">'+c.text+"</h3>":"")+"</md-dialog>"}),a.show(e),h=!0}}else b()}function f(c){if(c.busy){if(g++,1===g&&!h){i.value=0;var e=d(c);angular.extend(e,{controller:["$scope",function(a){a.text=c.text,a.progress=i}],templateUrl:"components/progress.wheel.dialog.html"}),a.show(e),h=!0}}else b()}var g=0,h=!1,i={value:0};return{handle:e,handleWithProgress:f,setProgress:c}}]),function(){function a(a){return 10>a?"0"+a:a}Date.prototype.toISOString=function(){return this.getFullYear()+"-"+a(this.getMonth()+1)+"-"+a(this.getDate())+"T"+a(this.getHours())+":"+a(this.getMinutes())+":"+a(this.getSeconds())+"."+(this.getMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"}}(),angular.module("hitsaOis").controller("FinalDocSignerEditController",["$location","$route","$scope","dialogService","message","QueryUtils","FormUtils","USER_ROLES",function(a,b,c,d,e,f,g,h){var i=b.current.params.id,j="/school/finaldocsigners";c.auth=b.current.locals.auth,c.canEdit=-1!==c.auth.authorizedRoles.indexOf(h.ROLE_OIGUS_M_TEEMAOIGUS_LOPDOKALLKIRI);var k=f.endpoint(j);i?c.record=k.get({id:i}):c.record=new k({isFirst:!1,isValid:!0}),c.update=function(){g.withValidForm(c.finalDocSignerForm,function(){c.record.id?c.record.$update().then(e.updateSuccess)["catch"](angular.noop):c.record.$save().then(function(){e.info("main.messages.create.success"),a.url(j+"/"+c.record.id+"/edit?_noback")})["catch"](angular.noop)})},c["delete"]=function(){d.confirmDialog({prompt:"finalDocSigner.deleteconfirm"},function(){c.record.$delete().then(function(){e.info("main.messages.delete.success"),a.url(j+"?_noback")})["catch"](angular.noop)})}}]),angular.module("hitsaOis").factory("School",["QueryUtils",function(a){function b(){}return b.getAll=function(){return a.endpoint("/autocomplete/schools").query()},b.getLdap=function(){return a.endpoint("/autocomplete/ldapschools").query()},b.getSchoolsWithLogo=function(){return a.endpoint("/autocomplete/schoolsWithLogo").query()},b}]),angular.module("hitsaOis").controller("SchoolCapacityTypeController",["$route","$q","$scope","Classifier","QueryUtils","message","USER_ROLES","AuthService","dialogService",function(a,b,c,d,e,f,g,h,i){function j(){c.capacityTypes=e.endpoint(k).query({isHigher:c.isHigher})}var k="/schoolCapacityType";c.auth=a.current.locals.auth,c.isHigher=c.auth.higher&&!c.auth.vocational,c.currentNavItem="school.capacityType"+(c.isHigher?".higher":".vocational"),c.canEdit=h.isAuthorized(g.ROLE_OIGUS_M_TEEMAOIGUS_OPPETOOLIIK),c.studyYears=e.endpoint("/autocomplete/studyYears").query(function(a){c.studyYearMap=a.reduce(function(a,b){return a[b.id]=b,a},{})}),d.queryForDropdown({mainClassCode:"MAHT",order:"code"}).$promise.then(function(a){c.capacityMap=a.reduce(function(a,b){return a[b.code]=b,a},{})}),j(),c.switchHigher=function(a){c.isHigher=a,j()},c.updateAllCheckBoxes=function(a){c.capacityTypes.forEach(function(b){b.isUsable=a})},c.isUsableChanged=function(a){a.isUsable||(a.isTimetable=!1,i.confirmDialog({prompt:c.auth.higher?"schoolCapacityType.removeUsableConfirmHigher":"schoolCapacityType.removeUsableConfirmVocational"},function(){a.loads.forEach(function(a){a.loadPercentage=null}),e.endpoint(k+"/loads").save({id:a.id,loads:a.loads},function(){c.update()})}))},c.update=function(){e.endpoint(k).save({isHigher:c.isHigher,capacities:c.capacityTypes},function(){f.updateSuccess(),j()})},c.changeLoads=function(a){i.showDialog("school/school.capacity.type.load.dialog.html",function(b){b.capacityType=c.capacityMap[a.typeCode];var d=a.loads.reduce(function(a,b){return a[b.studyYearId]=b.loadPercentage,a},{});b.studyYears=[],c.studyYears.forEach(function(a){b.studyYears.push({studyYearId:a.id,loadPercentage:d[a.id]})}),b.studyYearMap=c.studyYearMap},function(b){e.endpoint(k+"/loads").save({id:a.id,loads:b.studyYears},function(){f.updateSuccess(),j()})})}}]),angular.module("hitsaOis").controller("SchoolDepartmentEditController",["$location","$route","$scope","dialogService","message","DataUtils","QueryUtils",function(a,b,c,d,e,f,g){function h(){f.convertStringToDates(c.schoolDepartment,["validFrom","validThru"])}var i=b.current.params.id,j="/school/departments",k=g.endpoint(j);if(i)c.schoolDepartment=k.get({id:i},h);else{var l=new Date;l.setHours(0,0,0,0),c.schoolDepartment=new k({validFrom:l,validThru:null})}c.update=function(){return c.schoolDepartmentForm.$setSubmitted(),c.schoolDepartmentForm.$valid?void(c.schoolDepartment.id?(c.schoolDepartment.$update().then(e.updateSuccess),c.schoolDepartmentForm.$setPristine()):c.schoolDepartment.$save().then(function(){e.info("main.messages.create.success"),a.url(j+"/"+c.schoolDepartment.id+"/edit?_noback")})):void e.error("main.messages.form-has-errors")},c["delete"]=function(){d.confirmDialog({prompt:"school.department.deleteconfirm"},function(){c.schoolDepartment.$delete().then(function(){e.info("main.messages.delete.success"),a.url("/school/departments")})})}}]).controller("SchoolDepartmentListController",["$scope","DataUtils","QueryUtils",function(a,b,c){var d=function(){var c=function(a,b,d){for(var e=0,f=d.length;f>e;e++){var g=d[e];g.indent=b,a.push(g),c(a,b+1,g.children||[])}},d=[];c(d,0,a.tabledata.content),a.tabledata.content=d;var e=new Date;e.setUTCHours(0,0,0,0);for(var f=0,g=d.length;g>f;f++){var h=d[f];b.convertStringToDates(h,["validFrom","validThru"]),h.isValid=h.validFrom<=e&&(!h.validThru||h.validThru>=e)}};c.createQueryForm(a,"/school/departments",{order:"en"===a.currentLanguage()?"nameEn":"nameEt"},d),a.loadData()}]),angular.module("hitsaOis").controller("SchoolEditController",["$scope","$route","School","$location","dialogService","message","QueryUtils","oisFileService","Classifier","classifierAutocomplete",function(a,b,c,d,e,f,g,h,i,j){function k(){a.school.logo?a.school.imageUrl=h.getUrl(a.school.logo,"school"):a.school.imageUrl="?"+(new Date).getTime(),a.school.ehisSchool&&i.get(a.school.ehisSchool).$promise.then(function(b){a.school._ehisSchool=b}),a.schoolForm&&a.schoolForm.$setPristine()}function l(b){a.logoFiles[0]?(a.school.deleteCurrentLogo=null,a.school.logo=h.getFromLfFile(a.logoFiles[0],b)):a.school.deleteCurrentLogo?(a.school.logo=null,b()):b()}var m=b.current.params.id,n="/school",o=g.endpoint(n);m?(a.school=o.get({id:m}),a.school.$promise.then(k)):(a.school=new o,k()),a.update=function(){function b(){f.info(c),a.logoFileApi.removeAll(),k()}if(a.schoolForm.$setSubmitted(),!a.schoolForm.$valid)return void f.error("main.messages.form-has-errors");if(!a.school.ehisSchool)return void f.error("school.error.ehisSchoolMissing");var c=a.school.id?"main.messages.update.success":"main.messages.create.success";l(function(){a.school.id?a.school.$update().then(b):a.school.$save().then(b)})},a["delete"]=function(){e.confirmDialog({prompt:"school.deleteconfirm"},function(){a.school.$delete().then(function(){d.url(n)})})},a.querySearch=function(a){return j.searchByName(a,"EHIS_KOOL")},a.setEhisSchool=function(){var b=a.school._ehisSchool||{};a.school.ehisSchool=b.code,a.school.nameEt=b.nameEt,a.school.ehisId=b.value,a.school.regNr=b.value2}}]),angular.module("hitsaOis").controller("SchoolStudyLevelsController",["$q","$scope","$rootScope","Classifier","QueryUtils","AUTH_EVENTS","message","USER_ROLES","AuthService",function(a,b,c,d,e,f,g,h,i){b.studyLevelDefs=d.queryForDropdown({mainClassCode:"OPPEASTE",order:"code"}),b.studyLevels=e.endpoint("/school/studyLevels").search(),b.canEdit=i.isAuthorized(h.ROLE_OIGUS_M_TEEMAOIGUS_OPPETASE),a.all([b.studyLevelDefs.$promise,b.studyLevels.$promise]).then(function(){d.setSelectedCodes(b.studyLevelDefs,b.studyLevels.studyLevels)}),b.update=function(){b.studyLevels.studyLevels=d.getSelectedCodes(b.studyLevelDefs),b.studyLevels.$put().then(function(){g.updateSuccess(),c.$broadcast(f.reAuthenticate)})}}]),angular.module("hitsaOis").config(["$routeProvider","USER_ROLES",function(a,b){a.when("/school",{templateUrl:"school/school.list.html",controller:"SimpleListController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],params:["$translate",function(a){return{order:"en"===a.use()?"nameEn":"nameEt"}}],url:function(){return"/school"}},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_OPPEASUTUS]}}).when("/school/new",{templateUrl:"school/school.edit.html",controller:"SchoolEditController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_OPPEASUTUS]}}).when("/school/:id/edit",{templateUrl:"school/school.edit.html",controller:"SchoolEditController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_OPPEASUTUS]}}).when("/school/:id/view",{templateUrl:"school/school.view.html",controller:"SchoolViewController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_OPPEASUTUS]}}).when("/school/departments",{templateUrl:"school/school.department.list.html",controller:"SchoolDepartmentListController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_STRUKTUUR]}}).when("/school/departments/new",{templateUrl:"school/school.department.edit.html",controller:"SchoolDepartmentEditController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_STRUKTUUR]}}).when("/school/departments/:id/edit",{templateUrl:"school/school.department.edit.html",controller:"SchoolDepartmentEditController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_STRUKTUUR]}}).when("/school/departments/:id/view",{templateUrl:"school/school.department.view.html",controller:"SchoolDepartmentEditController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_STRUKTUUR]}}).when("/school/teacheroccupations",{templateUrl:"teacher/teacher.occupation.list.html",controller:"SimpleListController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],params:function(){return{order:"occupationEt"}},url:function(){return"/school/teacheroccupations"}},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_OPETAJAAMET]}}).when("/school/teacheroccupations/new",{templateUrl:"teacher/teacher.occupation.edit.html",controller:"TeacherOccupationEditController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_OPETAJAAMET]}}).when("/school/teacheroccupations/:id/edit",{templateUrl:"teacher/teacher.occupation.edit.html",controller:"TeacherOccupationEditController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_OPETAJAAMET]}}).when("/school/studyLevels",{templateUrl:"school/school.study.levels.html",controller:"SchoolStudyLevelsController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_OPPETASE]}}).when("/school/capacityTypes",{templateUrl:"school/school.capacity.type.html",controller:"SchoolCapacityTypeController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_OPPETOOLIIK]}}).when("/school/finaldocsigners",{templateUrl:"school/final.doc.signer.search.html",controller:"SimpleListController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],params:function(){return{order:"name"}},url:function(){return"/school/finaldocsigners"}},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_LOPDOKALLKIRI]}}).when("/school/finaldocsigners/new",{templateUrl:"school/final.doc.signer.edit.html",controller:"FinalDocSignerEditController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_LOPDOKALLKIRI]}}).when("/school/finaldocsigners/:id/edit",{templateUrl:"school/final.doc.signer.edit.html",controller:"FinalDocSignerEditController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_LOPDOKALLKIRI]}})}]),angular.module("hitsaOis").controller("SchoolViewController",["$route","$scope","oisFileService","Classifier","QueryUtils",function(a,b,c,d,e){var f=a.current.params.id;b.school=e.endpoint("/school").get({id:f},function(){b.school.logo?b.school.imageUrl=c.getUrl(b.school.logo,"school"):b.school.imageUrl="?"+(new Date).getTime(),b.school.ehisSchool&&d.get(b.school.ehisSchool).$promise.then(function(a){b.school.ehisSchool=a.code,b.school.nameEt=a.nameEt,b.school.ehisId=a.value,b.school.regNr=a.value2})})}]),angular.module("hitsaOis").config(["$routeProvider","USER_ROLES",function(a,b){a.when("/school/studyYears",{templateUrl:"studyYear/study.year.list.html",controller:"StudyYearsListController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_OPPEPERIOOD]}}).when("/school/studyYears/:code/new",{templateUrl:"studyYear/study.year.edit.html",controller:"StudyYearsEditController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_OPPEPERIOOD]}}).when("/school/studyYears/:id/view",{templateUrl:"studyYear/study.year.view.html",controller:"StudyYearsEditController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_OPPEPERIOOD]}}).when("/school/studyYears/:id/edit",{templateUrl:"studyYear/study.year.edit.html",controller:"StudyYearsEditController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_OPPEPERIOOD]}})}]).controller("StudyYearsListController",["$scope","QueryUtils","USER_ROLES","AuthService",function(a,b,c,d){a.endpoint=b.endpoint("/school/studyYears"),a.tabledata=a.endpoint.query(),a.canEdit=d.isAuthorized(c.ROLE_OIGUS_M_TEEMAOIGUS_OPPEPERIOOD)}]).controller("StudyYearsEditController",["$location","$mdDialog","$route","$scope","$translate","Classifier","dialogService","message","DataUtils","QueryUtils","USER_ROLES","AuthService",function(a,b,c,d,e,f,g,h,i,j,k,l){function m(){i.convertStringToDates(d.studyYear,["startDate","endDate"]),d.studyPeriods=d.studyYear.studyPeriods||[],d.studyPeriodEvents=d.studyYear.studyPeriodEvents||[],q.objectmapper(d.studyPeriods),i.convertStringToDates(d.studyPeriods,["startDate","endDate"]),i.convertStringToDates(d.studyPeriodEvents,["start","end"])}d.canEdit=l.isAuthorized(k.ROLE_OIGUS_M_TEEMAOIGUS_OPPEPERIOOD),d.auth=c.current.locals.auth;var n=c.current.params.id,o=c.current.params.code,p=j.endpoint("/school/studyYears"),q=f.valuemapper({type:"OPPEPERIOOD"});d.eventTypes={},f.queryForDropdown({mainClassCode:"SYNDMUS"},function(a){d.eventTypes=f.toMap(a)}),n?d.studyYear=p.get({id:n},m):o&&(d.studyYear=new p({year:o}),d.studyPeriods=[],d.studyPeriodEvents=[]),d.openStudyPeriodDialog=function(a){var c=j.endpoint("/school/studyYears/"+d.studyYear.id+"/studyPeriods"),e=d,f=function(d){function f(){return k.dialogForm.$setSubmitted(),!k.dialogForm.startDate.$valid&&k.dialogForm.startDate.$error.mindate||!k.dialogForm.endDate.$valid&&k.dialogForm.endDate.$error.maxdate?(h.error("studyYear.studyPeriod.error.notInsideStudyYear"),!1):j(k.studyPeriod)?(h.error("studyYear.studyPeriod.error.overlapWithOtherStudyPeriod"),!1):k.dialogForm.$valid?!0:(h.error("main.messages.form-has-errors"),!1)}function j(a){for(var b=0;b<e.studyPeriods.length;b++)if(e.studyPeriods[b].id!==a.id&&i.periodsOverlap(a,e.studyPeriods[b]))return!0;return!1}var k=d;a?(k.studyPeriod=new c(a),k.studyPeriod.type=k.studyPeriod.type.code):k.studyPeriod=new c({}),k.studyPeriod.year=e.studyYear.year,k.studyYear=e.studyYear,k.typeChange=function(){if(k.studyPeriod.type){var a=q.objectmapper({type:k.studyPeriod.type});angular.isString(k.studyPeriod.nameEt)||(k.studyPeriod.nameEt=a.type.nameEt)}},k["delete"]=function(){g.confirmDialog({prompt:"studyYear.studyPeriod.deleteconfirm"},function(){k.studyPeriod.$delete().then(function(){e.studyPeriods=e.studyPeriods.filter(function(b){return b!==a}),h.info("main.messages.delete.success"),b.hide()})})};var l=function(c){i.convertStringToDates(c,["startDate","endDate"]),q.objectmapper(c),a?angular.extend(a,c):e.studyPeriods.push(c),b.hide(),h.updateSuccess()};k.submit=function(){if(f()){var a=k.studyPeriod;a.id?a.$update().then(l):a.$save().then(l)}},d.cancel=b.hide};f.$inject=["$scope"],b.show({controller:f,templateUrl:"studyYear/study.period.dialog.html"})},d.openStudyPeriodEventDialog=function(a){var c=["SYNDMUS_AVES","SYNDMUS_DEKP","SYNDMUS_VOTA"],e=j.endpoint("/school/studyYears/"+d.studyYear.id+"/studyPeriodEvents"),f=d,k=function(d){if(d.auth=f.auth,a){if(d.studyPeriodEvent=new e(a),d.studyPeriodEvent.studyPeriod)for(var j=0;j<f.studyPeriods.length;j++)if(f.studyPeriods[j].id===d.studyPeriodEvent.studyPeriod.id){d.studyPeriodEvent.studyPeriod=f.studyPeriods[j];break}}else d.studyPeriodEvent=new e({});d.studyPeriods=f.studyPeriods,d.uniqueInStudyPeriod=!1,d.$watch("studyPeriodEvent",function(){-1!==c.indexOf(d.studyPeriodEvent.eventType)?(d.uniqueInStudyPeriod=!0,d.studyPeriodEvent.studyPeriod||(d.studyPeriodEvent.studyPeriod=i.getCurrentStudyYearOrPeriod(d.studyPeriods))):d.uniqueInStudyPeriod=!1},!0),d["delete"]=function(){g.confirmDialog({prompt:"studyYear.studyPeriodEvent.deleteconfirm"},function(){d.studyPeriodEvent.$delete().then(function(){f.studyPeriodEvents=f.studyPeriodEvents.filter(function(b){return b!==a}),h.info("main.messages.delete.success"),b.hide()})})},d.cancel=b.hide,d.submit=function(){d.dialogForm.$setSubmitted();var a=!1;if(-1!==c.indexOf(d.studyPeriodEvent.eventType)&&(angular.isUndefined(d.studyPeriodEvent.studyPeriod)&&(d.studyPeriodEvent.studyPeriod=null),d.studyPeriodEvent.studyPeriod)){var b=f.studyPeriodEvents.filter(function(a){return a.studyPeriod&&d.studyPeriodEvent.studyPeriod.id===a.studyPeriod.id&&d.studyPeriodEvent.id!==a.id&&a.eventType===d.studyPeriodEvent.eventType?!0:void 0});b.length>0&&(a=!0,h.error("studyYear.studyPeriodEvent.error.uniqueInPeriod"))}if(d.studyPeriodEvent.start&&d.studyPeriodEvent.end&&d.studyPeriodEvent.start.getTime()>d.studyPeriodEvent.end.getTime()&&(a=!0,h.error("studyYear.studyPeriod.error.startDateLaterThanEndDate")),d.studyPeriodEvent.studyPeriod){var e;if(d.studyPeriodEvent.start&&d.studyPeriodEvent.end){e=moment(d.studyPeriodEvent.start).startOf("day");var g=moment(d.studyPeriodEvent.end).endOf("day");(e.isBefore(moment(d.studyPeriodEvent.studyPeriod.startDate).startOf("day"))||g.isAfter(moment(d.studyPeriodEvent.studyPeriod.endDate).endOf("day")))&&(a=!0,h.error("studyYear.studyPeriod.error.outsideStudyPeriod"))}else d.studyPeriodEvent.start&&(e=moment(d.studyPeriodEvent.start).startOf("day"),(e.isBefore(moment(d.studyPeriodEvent.studyPeriod.startDate).startOf("day"))||e.isAfter(moment(d.studyPeriodEvent.studyPeriod.endDate).endOf("day")))&&(a=!0,h.error("studyYear.studyPeriod.error.outsideStudyPeriod")))}if(d.dialogForm.$valid&&!a){var i=d.studyPeriodEvent;i.id?i.$update().then(l):i.$save().then(l)}}};k.$inject=["$scope"];var l=function(c){i.convertStringToDates(c,["start","end"]),a?angular.extend(a,c):f.studyPeriodEvents.push(c),b.hide(),h.updateSuccess()};b.show({controller:k,templateUrl:"studyYear/study.period.event.dialog.html"})},d.update=function(){d.schoolYearForm.$setSubmitted(),d.schoolYearForm.$valid&&(n?d.studyYear.$update().then(m).then(h.updateSuccess):o&&d.studyYear.$save().then(function(b){a.path("/school/studyYears/"+b.id+"/edit"),h.info("main.messages.create.success")}))}}]),angular.module("hitsaOis").controller("StateCurriculumController",["$route","$scope","message","Classifier","$location","classifierAutocomplete","dialogService","QueryUtils","DataUtils","ArrayUtils","Curriculum","config","$rootScope",function(a,b,c,d,e,f,g,h,i,j,k,l,m){function n(){M?L.get({id:M}).$promise.then(function(a){b.stateCurriculum=a,o(),m.removeLastUrlFromHistory(function(a){return a&&-1!==a.indexOf("/stateCurriculum/"+M)})}):b.stateCurriculum=new L(J)}function o(){i.convertStringToDates(b.stateCurriculum,["validFrom","validThru"]),p(),E(),b.formState.readOnly=-1!==a.current.$$route.originalPath.indexOf("view")}function p(){var a=b.stateCurriculum.iscedClass;d.getParentsWithMainClass("ISCED_SUUN",b.stateCurriculum.iscedClass).$promise.then(function(a){return b.iscedSuun=a[0].code,a[0]}).then(function(c){d.getParentsWithMainClass("ISCED_VALD",c.code).$promise.then(function(c){b.iscedVald=c[0].code,b.stateCurriculum.iscedClass=a})})}function q(a){return b.stateCurriculumForm.$setSubmitted(),u()?!0:(c.error(a.errorMessage),!1)}function r(a){q(a)&&b.stateCurriculum.$save().then(function(){i.convertStringToDates(b.stateCurriculum,["validFrom","validThru"]),c.info("main.messages.create.success"),e.url("/stateCurriculum/"+b.stateCurriculum.id+"/edit?_noback")})}function s(a,d){setTimeout(function(){q(d)&&a.$update().then(function(a){c.info(d.updateSuccess),b.stateCurriculum=a,o(),b.stateCurriculumForm.$setPristine(),b.formState.readOnly||b.stateCurriculum.status===k.STATUS.ENTERING||e.url("/stateCurriculum/"+b.stateCurriculum.id+"/view?_noback")})},0)}function t(a,c){g.confirmDialog({prompt:c.prompt},function(){b.formState.strictValidation?b.occupationCheckBeforeSave(a,c):s(a,c)})}function u(){return b.stateCurriculumForm.$valid&&(!b.strictValidation()||b.stateCurriculum.occupations.length>0&&v()&&w())}function v(){for(var a=0;a<b.stateCurriculum.occupations.length;a++)if(b.hasNoPmodule(b.stateCurriculum.occupations[a]))return!1;return!0}function w(){for(var a=0;a<b.subOccupationsList.length;a++)if(b.hasNoPmodule(b.subOccupationsList[a].code))return!1;return!0}function x(a){for(var c=0,d=B(a,"OSAKUTSE"),e=b.stateCurriculum.modules.filter(function(a){return!a.isAdditional}),f=0;f<e.length;f++){var g=j.intersection(e[f].moduleOccupations,d);if(0!==g.length){var h=j.includes(e[f].moduleOccupations,a)?1:0;c+=e[f].credits*(g.length+h-1)}}return c}function y(){for(var a=D(b.stateCurriculum.occupations),c=0;c<a.length;c++)if(!b.isOccutationValid(a[c]))return!1;return!0}function z(){for(var a=b.stateCurriculum.occupations,c=0;c<a.length;c++)for(var d=B(a[c],"SPETSKUTSE"),e=0;e<d.length;e++)if(!b.isSpetsOccupationValid(d[e],a[c]))return!1;return!0}function A(a){var b=B(a,"OSAKUTSE");return b.reduce(function(a,b){return a+C(b)},0)}function B(a,c){return b.subOccupations[a]?b.subOccupations[a].filter(function(a){return a.mainClassCode===c}).map(function(a){return a.code}):[]}function C(a){return b.stateCurriculum.modules.filter(function(b){return j.includes(b.moduleOccupations,a)}).reduce(function(a,b){return b.isAdditional?a:a+b.credits},0)}function D(a){return a.filter(function(a){return 0===a.indexOf("KUTSE_")})}function E(){if(b.stateCurriculum.occupations)for(var a=0;a<b.stateCurriculum.occupations.length;a++)F(b.stateCurriculum.occupations[a])}function F(a){d.getChildren(a).$promise.then(function(c){b.subOccupations[a]=c.filter(function(a){return"OSAKUTSE"===a.mainClassCode||"SPETSKUTSE"===a.mainClassCode}),b.getSubOccupationsAsList()})}function G(a){return!j.includes(b.stateCurriculum.occupations,a)}function H(a){var c=b.subOccupations[a].map(function(a){return a.code});return b.stateCurriculum.modules.some(function(b){return j.includes(b.moduleOccupations,a)||j.intersect(c,b.moduleOccupations)})}function I(){b.stateCurriculum.modules=b.stateCurriculum.modules.filter(function(a){return!j.isEmpty(a.moduleOccupations)})}b.isPublic=a.current.locals.params&&a.current.locals.params.isPublic,b.STATUS=k.STATUS,b.MODULE_TYPE={BASIC:"KUTSEMOODUL_P",GENERAL:"KUTSEMOODUL_Y"};var J={status:b.STATUS.ENTERING,modules:[],occupations:[],validFrom:new Date,optionalStudyCredits:0,canChange:!0},K="/stateCurriculum",L=h.endpoint(b.isPublic?"/public/statecurriculum":K),M=a.current.params.id;b.removeFromArray=j.remove,b.subOccupations={},b.formState={strictValidation:!1,readOnly:-1!==a.current.$$route.originalPath.indexOf("view"),stateCurriculumPdfUrl:l.apiUrl+K+"/print/"+M+"/stateCurriculum.pdf"},b.getCurriculumViewUrl=function(a){return b.isPublic?"#/curriculum/"+a:"#/vocationalCurriculum/"+a+"/view"},n(),b["delete"]=function(){return j.isEmpty(b.stateCurriculum.curricula)?void g.confirmDialog({prompt:"stateCurriculum.deleteconfirm"},function(){b.stateCurriculum.$delete().then(function(){c.info("main.messages.delete.success"),e.path("/stateCurriculum")})}):void c.error("stateCurriculum.error.hasCurricula")},b.occupationCheckBeforeSave=function(a,c){y()?b.allSpetsOccupationsValidBeforeSave(a,c):g.confirmDialog({prompt:"stateCurriculum.occupationsCreditsConfirmConfirm"},function(){b.allSpetsOccupationsValidBeforeSave(a,c)},function(){return!1})},b.allSpetsOccupationsValidBeforeSave=function(a,b){z()?s(a,b):g.confirmDialog({prompt:"stateCurriculum.spetsOccupationsCredidsConfirm"},function(){s(a,b)},function(){return!1})},b.save=function(){var a={errorMessage:"main.messages.form-has-errors",updateSuccess:"main.messages.update.success"};M?(b.formState.strictValidation=!1,s(new L(b.stateCurriculum),a)):r(a)},b.confirmAndSave=function(){b.formState.strictValidation=!0;var a={prompt:"stateCurriculum.prompt.editForm.verify",updateSuccess:"stateCurriculum.statuschange.verified",errorMessage:"stateCurriculum.statuschange.fail.verify"},c=h.endpoint(K+"/confirmAndSave");t(new c(b.stateCurriculum),a)},b.close=function(){b.formState.strictValidation=!1;var a={prompt:b.formState.readOnly?"stateCurriculum.prompt.viewForm.close":"stateCurriculum.prompt.editForm.close",updateSuccess:"stateCurriculum.statuschange.closed",errorMessage:b.formState.readOnly?"stateCurriculum.statuschange.fail.closeReadOnly":"stateCurriculum.statuschange.fail.close"},c=b.formState.readOnly?K+"/close":K+"/closeAndSave",d=h.endpoint(c);t(new d(b.stateCurriculum),a)},b.getStar=function(){return b.strictValidation()?"":" *"},b.strictValidation=function(){return b.stateCurriculum&&b.stateCurriculum.status===b.STATUS.VERIFIED||b.formState.strictValidation},b.hasNoPmodule=function(a){if(!b.stateCurriculum||!b.stateCurriculum.modules)return!0;for(var c=0;c<b.stateCurriculum.modules.length;c++)if(b.stateCurriculum.modules[c].module===b.MODULE_TYPE.BASIC&&j.includes(b.stateCurriculum.modules[c].moduleOccupations,a))return!1;return!0},b.nameEtUniqueQuery={id:M,paramName:"nameEt",url:"/stateCurriculum/unique"},b.nameEnUniqueQuery={id:b.nameEtUniqueQuery.id,paramName:"nameEn",url:b.nameEtUniqueQuery.url},b.isOccutationValid=function(a){for(var c=C(a)+b.stateCurriculum.optionalStudyCredits,d=B(a,"OSAKUTSE"),e=0;e<d.length;e++)c+=C(d[e]);c-=x(a);var f=B(a,"SPETSKUTSE");return f[0]&&(c+=C(f[0])),b.stateCurriculum.credits===c},b.isSpetsOccupationValid=function(a,c){var d=C(c),e=C(a),f=A(c),g=d+e+f+b.stateCurriculum.optionalStudyCredits-x(c)===b.stateCurriculum.credits;return g},b.modulesValid=function(){return b.stateCurriculum?!b.strictValidation()||0!==b.stateCurriculum.occupations.length&&0!==b.stateCurriculum.modules.length&&y()&&z():!0},b.querySearch=function(a){return f.searchByName(a,"KUTSE")},b.addOcupation=function(a){a&&G(a.code)&&(b.stateCurriculum.occupations.push(a.code),F(a.code),b.stateCurriculumForm.$setDirty())},b.getSubOccupationsAsList=function(){b.subOccupationsList=[];for(var a in b.subOccupations)b.subOccupationsList=b.subOccupationsList.concat(b.subOccupations[a])},b.removeOcupation=function(a){var c=H(a)?"stateCurriculum.occupationWithModuleDeleteConfirm":"stateCurriculum.occupationdeleteconfirm";g.confirmDialog({prompt:c},function(){b.removeFromArray(b.stateCurriculum.occupations,a);var c=b.subOccupations[a].map(function(a){return a.code});delete b.subOccupations[a],b.getSubOccupationsAsList(),b.stateCurriculum.modules.forEach(function(c){b.removeFromArray(c.moduleOccupations,a)}),c.forEach(function(a){b.stateCurriculum.modules.forEach(function(c){b.removeFromArray(c.moduleOccupations,a)})}),I(),b.stateCurriculumForm.$setDirty()})},b.filterSubOccupations=function(a,c){return function(d){return b.subOccupations[a]&&null!==b.subOccupations[a].length&&j.includes(b.subOccupations[a],d)&&-1!==d.code.indexOf(c)}},b.filterModules=function(a,b){return function(c){return c.module===b&&j.includes(c.moduleOccupations,a)}},b.openViewModuleDialog=function(a){var c=function(c){function d(a){return j.includes(c.data.moduleOccupations,a)}c.data=angular.copy(a),c.occupations=b.stateCurriculum.occupations.map(function(a){var c=b.subOccupations[a];return c.forEach(function(a){a.selected=d(a.code)}),{code:a,selected:d(a),subOccupations:c}})};g.showDialog("stateCurriculum/state.curriculum.module.view.dialog.html",c,function(){})},b.openAddModuleDialog=function(a){var d=function(d){function e(a){return j.includes(d.data.moduleOccupations,a)}a?d.data=angular.copy(a):d.data={moduleOccupations:[],outcomes:[]},d.editing=angular.isDefined(a),d.isEditingOutcome=!1,d.editedOutcome=null,d.occupationsSelectedCorrectly=function(){if(!d.data.moduleOccupations)return!0;
for(var a=D(d.data.moduleOccupations),b=0;b<a.length;b++){var c=B(a[b],"SPETSKUTSE");if(j.intersect(c,d.data.moduleOccupations))return!1}return!0},d.addOutcome=function(){angular.isString(d.data.outcomesEt)&&""!==d.data.outcomesEt&&(d.data.outcomes.push({outcomesEt:d.data.outcomesEt,outcomesEn:d.data.outcomesEn}),d.data.outcomesEt=void 0,d.data.outcomesEn=void 0)},d.editOutcome=function(a){d.isEditingOutcome=!0,d.editedOutcome=a,d.data.outcomesEt=a.outcomesEt,d.data.outcomesEn=a.outcomesEn},d.saveOutcome=function(){angular.isString(d.data.outcomesEt)&&""!==d.data.outcomesEt&&(d.isEditingOutcome=!1,d.editedOutcome.outcomesEt=d.data.outcomesEt,d.editedOutcome.outcomesEn=d.data.outcomesEn,d.data.outcomesEt=void 0,d.data.outcomesEn=void 0)},d["delete"]=function(){g.confirmDialog({prompt:"curriculum.moduleDeleteConfirm"},function(){if(d.data.id){var e=h.endpoint("/stateCurriculum/modules"),f=new e(d.data);f.$delete().then(function(){c.info("main.messages.delete.success"),j.remove(b.stateCurriculum.modules,a)})}else j.remove(b.stateCurriculum.modules,a);d.cancel()})},d.suboccupationsSelectedCorrectly=function(){if(!d.data.moduleOccupations)return!0;for(var a=D(b.stateCurriculum.occupations),c=0;c<a.length;c++){var e=B(a[c],"SPETSKUTSE"),f=B(a[c],"OSAKUTSE");if(j.intersect(e,d.data.moduleOccupations)&&j.intersect(f,d.data.moduleOccupations))return!1}return!0},d.validateOccupations=function(){d.occupationsValid=d.occupationsSelectedCorrectly()?!0:null,d.suboccupationsValid=!0},d.validateOccupations(),d.changeOccupation=function(a){a.selected?d.data.moduleOccupations.push(a.code):j.remove(d.data.moduleOccupations,a.code),d.validateOccupations()},d.occupations=b.stateCurriculum.occupations.map(function(a){var c=b.subOccupations[a];return c.forEach(function(a){a.selected=e(a.code)}),{code:a,selected:e(a),subOccupations:c}}),d.allowedModuleTypes=[b.MODULE_TYPE.BASIC,b.MODULE_TYPE.GENERAL]};g.showDialog("stateCurriculum/state.curriculum.module.add.dialog.html",d,function(d){var e=d.data;if(b.stateCurriculum.id){var f=h.endpoint("/stateCurriculum/modules"),g=new f(e);g.stateCurriculumOccupations=b.stateCurriculum.occupations,g.stateCurriculum=b.stateCurriculum.id,e.id?g.$update().then(function(b){c.info("main.messages.update.success"),angular.extend(a,b)}):g.$save().then(function(a){c.info("main.messages.create.success"),b.stateCurriculum.modules.push(a)})}else a?angular.extend(a,e):b.stateCurriculum.modules.push(e)})},b.goToEditForm=function(){b.stateCurriculum&&(b.stateCurriculum.status===b.STATUS.VERIFIED?g.confirmDialog({prompt:"stateCurriculum.prompt.viewForm.editConfirmed"},function(){e.path("/stateCurriculum/"+b.stateCurriculum.id+"/edit")}):e.path("/stateCurriculum/"+b.stateCurriculum.id+"/edit"))}}]),angular.module("hitsaOis").controller("StateCurriculumListController",["$scope","$sessionStorage","$route","Classifier","QueryUtils","$q","DataUtils",function(a,b,c,d,e,f,g){a.isPublic=c.current.locals.params&&c.current.locals.params.isPublic;var h=d.valuemapper({status:"OPPEKAVA_STAATUS",ekrLevel:"EKR"});e.createQueryForm(a,a.isPublic?"/public/statecurriculumsearch":"/stateCurriculum",{order:a.currentLanguageNameField()},h.objectmapper),f.all(h.promises).then(a.loadData),a.filteredOutStatuses=[{code:"OPPEKAVA_STAATUS_M"}],g.convertStringToDates(a.criteria,["validFrom","validThru"]),a.isPublic?a.formState={canCreate:!1,canView:!1}:(a.formState={},e.endpoint("/stateCurriculum/canCreate").search().$promise.then(function(b){a.formState.canCreate=b.canCreate}),e.endpoint("/stateCurriculum/canView").search().$promise.then(function(b){a.formState.canView=b.canView}))}]),angular.module("hitsaOis").config(["$routeProvider","USER_ROLES",function(a,b){function c(a,c){return-1!==["ROLL_P","ROLL_V"].indexOf(a.roleCode)&&-1!==c.indexOf(b.ROLE_OIGUS_M_TEEMAOIGUS_RIIKLIKOPPEKAVA)}a.when("/stateCurriculum/new",{templateUrl:"stateCurriculum/state.curriculum.html",controller:"StateCurriculumController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:c}}).when("/stateCurriculum/:id/edit",{templateUrl:"stateCurriculum/state.curriculum.html",controller:"StateCurriculumController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:c}}).when("/stateCurriculum/:id/view",{templateUrl:"stateCurriculum/state.curriculum.view.html",controller:"StateCurriculumController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_RIIKLIKOPPEKAVA]}}).when("/stateCurriculum",{templateUrl:"stateCurriculum/state.curriculum.list.html",controller:"StateCurriculumListController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}]}}).when("/stateCurriculum/public",{templateUrl:"stateCurriculum/state.curriculum.list.html",controller:"StateCurriculumListController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],params:function(){return{isPublic:!0}}}}).when("/stateCurriculum/public/:id/view",{templateUrl:"stateCurriculum/state.curriculum.view.html",controller:"StateCurriculumController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],params:function(){return{isPublic:!0}}}})}]),angular.module("hitsaOis").controller("StudentSpecialitySearchController",["$scope","message","QueryUtils",function(a,b,c){function d(b){return angular.isArray(b.curriculumVersions)&&b.curriculumVersions.filter(function(b){return b===a.criteria.curriculumVersion}).length>0}function e(){a.specialities.$promise.then(function(b){a.availableSpecialities=b.filter(d)})}function f(){var b=!0;return a.filteredVersions=a.curriculumVersions.filter(function(c){var d=c.curriculum===a.criteria.curriculum&&c.specialities&&c.specialities.length>1;return d&&c.id===a.criteria.curriculumVersion&&(b=!1),d}),b?a.criteria.curriculumVersion=null:void 0}var g="/students/highspecialities";a.autocompletes=[],a.curriculumVersions=c.endpoint("/autocomplete/curriculumversions").query({closed:!1}),a.specialities=c.endpoint("/autocomplete/highspecialities").query(),a.availableSpecialities=[],a.filteredVersions=[],c.createQueryForm(a,g,{},e),a.$watch("criteria.curriculum",f),a.$watchCollection("curriculumVersions",f);var h=a.loadData;a.loadData=function(){a.searchForm.$setSubmitted(),a.searchForm.$valid?h():b.error("main.messages.form-has-errors")};var i=a.clearCriteria;a.clearCriteria=function(){a.autocompletes.forEach(function(a){a.clear()}),i()},a.save=function(){c.endpoint(g).post(a.tabledata.content,function(c){a.tabledata.content.forEach(function(a){var b=c.filter(function(b){return a.id===b.id});b&&b.length>0&&(a.speciality.id=b[0].speciality.id)}),b.info("main.messages.update.success")},function(a){b.error("main.messages.update.fail")})}}]),angular.module("hitsaOis").constant("StudentStatus",{OPPURSTAATUS_A:"OPPURSTAATUS_A",OPPURSTAATUS_K:"OPPURSTAATUS_K",OPPURSTAATUS_O:"OPPURSTAATUS_O",OPPURSTAATUS_V:"OPPURSTAATUS_V",OPPURSTAATUS_L:"OPPURSTAATUS_L"}).factory("StudentUtil",["StudentStatus",function(a){return{isActive:function(b){return a.OPPURSTAATUS_O===b||a.OPPURSTAATUS_A===b||a.OPPURSTAATUS_V===b},hasFinished:function(b){return a.OPPURSTAATUS_L===b}}}]),angular.module("hitsaOis").controller("StudentViewMainController",["$mdDialog","$q","$route","$scope","dialogService","message","Classifier","QueryUtils","oisFileService",function(a,b,c,d,e,f,g,h,i){function j(a){d.representatives.content=r.objectmapper(a.content),d.representatives.totalElements=a.totalElements}function k(){var a=angular.extend({},h.getQueryParams(d.representativesCriteria),{id:n});d.representatives.$promise=h.endpoint("/studentrepresentatives/:id").search(a,j)}function l(a){d.foreignstudies.content=a.content,d.foreignstudies.totalElements=a.totalElements}var m=c.current.locals.auth,n=m.isStudent()||m.isParent()?m.student:c.current.params.id,o="/students";d.auth=m,d.studentId=n,d.currentNavItem="student.main";var p=g.valuemapper({dormitory:"YHISELAMU"}),q=function(){h.endpoint(o).get({id:n},function(a){d.student=a,d.student.person.address&&d.student.person.postcode&&d.student.person.address.endsWith(d.student.person.postcode)&&(d.student.person.address=d.student.person.address.substring(0,d.student.person.address.lastIndexOf(d.student.person.postcode)),d.student.person.address.endsWith(", ")&&(d.student.person.address=d.student.person.address.slice(0,-2))),d.student.dormitoryHistory.forEach(function(a){p.objectmapper(a)}),d.student.photo?d.student.imageUrl=i.getUrl(d.student.photo,"student"):d.student.imageUrl="?"+(new Date).getTime()})};q(),d.representativesCriteria={order:"person.lastname",size:5,page:1},d.representatives={};var r=g.valuemapper({relation:"OPPURESINDAJA"});d.loadRepresentatives=k,b.all(r.promises).then(k),d.editRepresentative=function(b){var g=d.student,i=h.endpoint("/studentrepresentatives/"+n);a.show({controller:["$scope",function(d){function j(){var a=d.studentRepresentativeEditForm.idcode;a.$setValidity("notUnique",d.record.person.idcode!==d.formState.student.person.idcode)}function l(a){var b=d.studentRepresentativeEditForm.idcode;b.$setValidity("estonianIdcode",a)}d.isParent=c.current.locals.auth.isParent(),d.formState={student:g},b?d.record=i.get({id:b}):d.record=new i({person:{}}),d.cancel=a.hide,d.update=function(){function c(){f.info(b?"main.messages.update.success":"main.messages.create.success"),a.hide(),k()}return j(),d.studentRepresentativeEditForm.$setSubmitted(),d.studentRepresentativeEditForm.$valid?void(d.record.id?d.record.$update().then(c)["catch"](angular.noop):d.record.$save().then(c)["catch"](angular.noop)):void f.error("main.messages.form-has-errors")},d["delete"]=function(){e.confirmDialog({prompt:"student.representative.deleteconfirm"},function(){d.record.$delete().then(function(){f.info("main.messages.delete.success"),a.hide(),k()})["catch"](angular.noop)})},d.lookupPerson=function(){function a(a){d.record.person.firstname=a.firstname,d.record.person.lastname=a.lastname}var b=d.record.person.idcode;b&&11===b.length&&b!==d.formState.idcode?h.endpoint("/autocomplete/persons",{search:{method:"GET"}}).search({idcode:b,role:"forrepresentative"}).$promise.then(function(b){l(!0),a(b),!d.record.person.phone&&b.phone&&(d.record.person.phone=b.phone),!d.record.person.email&&b.email&&(d.record.person.email=b.email),d.formState.idcode=b.idcode})["catch"](function(b){a({}),d.formState.idcode=void 0,l(412!==b.status)}):b!==d.formState.idcode&&(a({}),d.formState.idcode=void 0,l(11===b.length)),j()}}],templateUrl:"studentRepresentative/representative.edit.dialog.html",clickOutsideToClose:!1})},d.foreignstudiesCriteria={order:"-3",size:5,page:1},d.foreignstudies={},d.loadForeignstudies=function(){var a=angular.extend({},h.getQueryParams(d.foreignstudiesCriteria),{id:n});d.foreignstudies.$promise=h.endpoint(o+"/:id/foreignstudies").search(a,l)},d.loadForeignstudies(),d.updatePersonData=function(){h.loadingWheel(d,!0),h.endpoint(o+"/"+n+"/populationRegister").get({},function(){f.info("rr.operations.updateStudentData.success"),h.loadingWheel(d,!1),q()},function(){h.loadingWheel(d,!1)})}}]).controller("StudentViewResultsController",["$route","$scope","$localStorage","QueryUtils","config","StudentUtil",function(a,b,c,d,e,f){function g(){if(c.resultsCurrentNavItems)for(var a=0;a<c.resultsCurrentNavItems.length;a++){var d=c.resultsCurrentNavItems[a];if(b.auth.school.id===d.school&&b.auth.user===d.user)return a+1}return null}function h(){b.auth.isAdmin()?b.canWatchStudentConnectedEntities=!0:b.auth.isTeacher()&&b.student.studentGroup&&b.auth.teacherGroupIds.length>0&&(b.canWatchStudentConnectedEntities=-1!==b.auth.teacherGroupIds.indexOf(b.student.studentGroup.id))}if(b.auth=a.current.locals.auth,b.studentId=b.auth.isStudent()||b.auth.isParent()?b.auth.student:a.current.params.id,d.endpoint("/students").get({id:b.studentId}).$promise.then(function(a){b.student=a,h(),f.isActive(b.student.status)&&-1!==b.auth.authorizedRoles.indexOf("ROLE_OIGUS_V_TEEMAOIGUS_HINNETELEHT_TRUKKIMINE")&&(b.supplementPreviewPdfUrl=e.apiUrl+"/documents/supplement/"+b.studentId+"/preview.pdf")}),b.currentNavItem="student.results",b.changeResultsCurrentNavItem=function(a){b.resultsCurrentNavItem=a;var d=g(),e={school:b.auth.school.id,user:b.auth.user,navItemName:a};d?c.resultsCurrentNavItems[d-1]=e:(c.resultsCurrentNavItems||(c.resultsCurrentNavItems=[]),c.resultsCurrentNavItems.push(e))},c.resultsCurrentNavItems){var i=g();i?b.resultsCurrentNavItem=c.resultsCurrentNavItems[i-1].navItemName:b.changeResultsCurrentNavItem("student.curriculumFulfillment")}else b.changeResultsCurrentNavItem("student.curriculumFulfillment");b.isStudentCurriculumFulfilled=function(a){return a&&angular.isNumber(a.credits)&&a.credits>=a.curriculumCredits}}]).controller("StudentViewResultsVocationalController",["$filter","$route","$scope","Classifier","QueryUtils","$rootScope","VocationalGradeUtil","StudentUtil",function(a,b,c,d,e,f,g,h){function i(){e.loadingWheel(c,!0),e.endpoint("/students/"+c.student.id+"/vocationalResults").get(function(a){a.results=m.objectmapper(a.results),a.curriculumModules.forEach(function(a){a.curriculumModule=n.objectmapper(a.curriculumModule)}),a.extraCurriculaModules.forEach(function(a){a.curriculumModule=n.objectmapper(a.curriculumModule)}),c.vocationalResults=a,c.loadCurriculumFulfillment(),e.loadingWheel(c,!1)})}function j(){return e.endpoint("/students/"+c.studentId+"/vocationalResultsByTime/").query(function(a){return m.objectmapper(a)})}function k(){"student.curriculumFulfillment"===c.resultsCurrentNavItem?i():"student.inOrderOfStudyYear"===c.resultsCurrentNavItem?c.loadStudyYearResults():"student.inOrderOfPassing"===c.resultsCurrentNavItem?c.loadModuleThemeResults():"student.journalsAndProtocols"===c.resultsCurrentNavItem&&(l()?c.loadJournalsAndProtocols():c.changeResultsCurrentNavItem("student.curriculumFulfillment"))}function l(){return c.auth.isAdmin()?!0:c.auth.isTeacher()&&c.student.studentGroup&&c.auth.teacherGroupIds.length>0?-1!==c.auth.teacherGroupIds.indexOf(c.student.studentGroup.id):void 0}c.auth=b.current.locals.auth,c.gradeUtil=g;var m=d.valuemapper({grade:"KUTSEHINDAMINE",studyYear:"OPPEAASTA",entryType:"SISSEKANNE"}),n=d.valuemapper({module:"KUTSEMOODUL"});c.canChangeStudentModules=c.auth.isAdmin()&&h.isActive(c.student.status)&&-1!==c.auth.authorizedRoles.indexOf("ROLE_OIGUS_M_TEEMAOIGUS_OPPUR"),c.$watch("resultsCurrentNavItem",function(){k()}),c.loadCurriculumFulfillment=function(){if(!angular.isObject(c.vocationalResultsCurriculum)){var b={};c.vocationalResults.curriculumModules.forEach(function(a){b[a.curriculumModule.id]=a});var d=[],e={};c.vocationalResults.results.forEach(function(a){angular.isObject(e[a.module.id])||(e[a.module.id]={themeResultById:{},totalSubmitted:0}),angular.isObject(a.theme)?(e[a.module.id].themeResultById[a.theme.id]=a,g.isPositive(a.grade.code)&&(e[a.module.id].totalSubmitted+=a.credits)):(angular.extend(e[a.module.id],a),a.isApelTransfer&&a.isFormalLearning&&d.push(a))}),c.moduleResultById=e,c.positiveThemeResult=function(a){return angular.isObject(a)&&angular.isObject(a.grade)&&angular.isString(a.grade.code)&&g.isPositive(a.grade.code)},c.vocationalResultsCurriculum={},c.vocationalResultsCurriculum.vocationalResultsModules=c.vocationalResults.curriculumModules.sort(function(a,b){return a.curriculumModule.orderNr-b.curriculumModule.orderNr||f.currentLanguageNameField(a.curriculumModule).localeCompare(f.currentLanguageNameField(b.curriculumModule))}),c.vocationalResultsCurriculum.extraCurriculaVocationalResultsModules=c.vocationalResults.extraCurriculaModules.sort(function(a,b){return a.curriculumModule.orderNr-b.curriculumModule.orderNr||f.currentLanguageNameField(a.curriculumModule).localeCompare(f.currentLanguageNameField(b.curriculumModule))}),d.forEach(function(a){a.replacedModules.forEach(function(a){var b=c.vocationalResultsCurriculum.vocationalResultsModules.filter(function(b){return b.curriculumModule.id===a})[0];if(angular.isObject(b)){var d=c.vocationalResultsCurriculum.vocationalResultsModules.indexOf(b);d>-1&&c.vocationalResultsCurriculum.vocationalResultsModules.splice(d,1)}var e=c.vocationalResultsCurriculum.extraCurriculaVocationalResultsModules.filter(function(b){return b.curriculumModule.id===a})[0];if(angular.isObject(e)){var f=c.vocationalResultsCurriculum.extraCurriculaVocationalResultsModules.indexOf(e);f>-1&&c.vocationalResultsCurriculum.extraCurriculaVocationalResultsModules.splice(f,1)}})});var h=a("filter")(c.vocationalResults.results,{isFormalLearning:!0,replacedModules:""});c.vocationalResultsCurriculum.replacedModuleResults=h.sort(function(a,b){return a.module.nameEt&&b.module.nameEt?f.currentLanguageNameField(a.module).localeCompare(f.currentLanguageNameField(b.module)):0});var i=[];c.vocationalResultsCurriculum.replacedModuleResults.forEach(function(a,c){for(var d=!1,e=0;e<a.replacedModules.length;e++)if(b.hasOwnProperty(a.replacedModules[e])){d=!0;break}d||i.push(c)}),c.vocationalResultsCurriculum.replacedExtraCurriculaModuleResults=c.vocationalResultsCurriculum.replacedModuleResults.filter(function(a,b){return-1!==i.indexOf(b)}),c.vocationalResultsCurriculum.replacedModuleResults=c.vocationalResultsCurriculum.replacedModuleResults.filter(function(a,b){return-1===i.indexOf(b)}),c.moduleBacklog=function(a){return(c.moduleResultById[a.curriculumModule.id]?e[a.curriculumModule.id].totalSubmitted:0)-a.curriculumModule.credits},c.filterReplacedThemes=function(a){return function(b){var d=c.moduleResultById[a.curriculumModule.id],e=d?d.themeResultById[b.id]:void 0;return-1===a.replacedThemes.indexOf(b.id)||angular.isDefined(e)}}}},c.loadStudyYearResults=function(){angular.isObject(c.vocationalResultsStudyYear)||j().$promise.then(function(a){var b={};a.forEach(function(a){angular.isObject(b[a.studyYear.code])||(b[a.studyYear.code]={studyYear:a.studyYear,studyYearStartDate:a.studyYearStartDate,results:[]}),b[a.studyYear.code].results.push(a)});var d=Object.values(b);d.sort(function(a,b){return new Date(b.studyYearStartDate).getTime()-new Date(a.studyYearStartDate).getTime()}),c.vocationalResultsStudyYear=d})},c.loadModuleThemeResults=function(){angular.isObject(c.vocationalResultsByTime)||(c.vocationalResultsPassing=j())},c.loadJournalsAndProtocols=function(){e.endpoint("/students/"+c.studentId+"/vocationalConnectedEntities/").query(function(a){c.studentConnectedEntities=a})},c.displayTeachers=function(a){return angular.isArray(a)?a.map(function(a){return a.nameEt}).sort().join(", "):void 0},c.positiveGrade=function(a){return g.isPositive(a)}}]).controller("StudentViewResultsHigherController",["$route","$scope","HigherGradeUtil","QueryUtils","StudentUtil","$rootScope","message",function(a,b,c,d,e,f,g){function h(){var c=l.isStudent()||l.isParent()?l.student:a.current.params.id;d.endpoint("/students/"+c+"/higherResults").get().$promise.then(function(a){b.higherResults=a,b.student.higherResults=b.higherResults,b.student.higherResults.modules.sort(j)})}function i(a){return"KORGMOODUL_V"===a.type}function j(a,b){return i(a)&&!i(b)?1:!i(a)&&i(b)?-1:f.currentLanguageNameField(a).localeCompare(f.currentLanguageNameField(b))}function k(a){a.forEach(function(a){a.oldCurriculumVersionModuleId=a.curriculumVersionModuleId,a.oldIsOptional=a.isOptional,b.higherCurriculumModules.forEach(function(b){b.id===a.curriculumVersionModuleId&&(a.curriculumVersionModule=b)})}),b.changeableModules=a}b.gradeUtil=c;var l=a.current.locals.auth;b.canChangeStudentModules=b.auth.isAdmin()&&e.isActive(b.student.status)&&-1!==b.auth.authorizedRoles.indexOf("ROLE_OIGUS_M_TEEMAOIGUS_OPPUR"),b.$watch("resultsCurrentNavItem",function(){"student.changeModules"===b.resultsCurrentNavItem&&(e.isActive(b.student.status)?b.loadChangeableModules():b.changeResultsCurrentNavItem("student.curriculumFulfillment"))}),angular.isDefined(b.higherResults)||h(),b.hasMandatorySubjects=function(a){return b.higherResults.subjectResults.some(function(b){return b.higherModule.id===a.id&&!b.isOptional})},b.hasOptionalSubjects=function(a){return b.higherResults.subjectResults.some(function(b){return b.higherModule.id===a.id&&b.isOptional})},b.filterSubjectResultsByModule=function(a){return function(b){return a.id===b.higherModule.id}},b.filterSubjectResultsByStudyPeriod=function(a){return function(b){return b.lastGrade&&b.lastGrade.gradeValue&&a.id===b.lastGrade.studyPeriod}},b.loadChangeableModules=function(){d.endpoint("/students/"+b.student.id+"/higherCurriculumModules/").query(function(a){b.higherCurriculumModules=a,d.endpoint("/students/"+b.student.id+"/higherChangeableModules").query(function(a){k(a)})})},b.saveChangedModules=function(){d.endpoint("/students/"+b.student.id+"/changeHigherCurriculumModules/").post({modules:b.changeableModules}).$promise.then(function(a){g.updateSuccess(),k(a),h()})}}]).controller("StudentViewDocumentsController",["$q","$route","$scope","Classifier","QueryUtils","CertificateUtil","CertificateType",function(a,b,c,d,e,f,g){function h(a){c.certificates.totalElements=a.totalElements,c.certificates.content=l.objectmapper(a.content)}c.studentId=b.current.locals.auth.isStudent()||b.current.locals.auth.isParent()?b.current.locals.auth.student:b.current.params.id,c.currentNavItem="student.documents",c.auth=b.current.locals.auth,c.applicationsCriteria={size:5,page:1,order:"-inserted",studentId:c.studentId},c.applications={};var i=d.valuemapper({type:"AVALDUS_LIIK",status:"AVALDUS_STAATUS"});c.afterApplicationsLoad=function(a){c.applications.content=i.objectmapper(a.content),c.applications.totalElements=a.totalElements},e.endpoint("/students").get({id:c.studentId}).$promise.then(function(a){c.student=a}),c.loadApplications=function(){var a=e.getQueryParams(c.applicationsCriteria);c.applications.$promise=e.endpoint("/students/:studentId/applications").search(a,c.afterApplicationsLoad)},c.auth.isStudent()&&(c.applicationTypes=d.queryForDropdown({mainClassCode:"AVALDUS_LIIK"}),c.certificateTypes=d.queryForDropdown({mainClassCode:"TOEND_LIIK",filterValues:[g.TOEND_LIIK_MUU]})),c.directivesCriteria={size:5,page:1,order:"confirm_date, headline",studentId:c.studentId},c.directives={};var j=d.valuemapper({type:"KASKKIRI",status:"KASKKIRI_STAATUS"});c.afterDirectivesLoad=function(a){c.directives.content=j.objectmapper(a.content),c.directives.totalElements=a.totalElements},c.loadDirectives=function(){var a=e.getQueryParams(c.directivesCriteria);c.directives.$promise=e.endpoint("/students/:studentId/directives").search(a,c.afterDirectivesLoad)},c.practiceContractsCriteria={size:5,page:1,order:"contract_nr",studentId:c.studentId},c.practiceContracts={};var k=d.valuemapper({status:"LEPING_STAATUS"});c.afterPracticeContractsLoad=function(a){c.practiceContracts.content=k.objectmapper(a.content),c.practiceContracts.totalElements=a.totalElements},c.loadPracticeContracts=function(){var a=e.getQueryParams(c.practiceContractsCriteria);c.practiceContracts.$promise=e.endpoint("/students/:studentId/practicecontracts").search(a,c.afterPracticeContractsLoad)},c.certificatesCriteria={size:5,page:1,order:"type."+c.currentLanguageNameField(),student:c.studentId},c.certificates={};var l=d.valuemapper({type:"TOEND_LIIK",status:"TOEND_STAATUS"});c.auth.isTeacher()||(c.loadCertificates=function(){var a=e.getQueryParams(c.certificatesCriteria);c.directives.$promise=e.endpoint("/certificate").search(a,h)},c.loadCertificates()),e.endpoint("/students/:studentId/documents").search({studentId:c.studentId},function(b){a.all(i.promises).then(function(){c.afterApplicationsLoad(b.applications)}),a.all(j.promises).then(function(){c.afterDirectivesLoad(b.directives)}),a.all(k.promises).then(function(){c.afterPracticeContractsLoad(b.practiceContracts)}),c.auth.isStudent()&&(c.applicationTypesApplicable=b.applicationTypesApplicable,c.certificateTypes.$promise.then(function(){var a=f.getForbiddenTypes(b.student.status);c.certificateTypes=c.certificateTypes.filter(function(b){return-1===a.indexOf(b.code)})}))})}]).controller("StudentViewTimetableController",["$route","$scope","GeneralTimetableUtils","QueryUtils",function(a,b,c,d){b.auth=a.current.locals.auth,b.generalTimetableUtils=new c,b.studentId=a.current.locals.auth.isStudent()?a.current.locals.auth.student:a.current.params.id,b.student=d.endpoint("/students").get({id:b.studentId}),b.typeId=b.studentId,b.currentNavItem="student.timetable",b.schoolId=b.auth.school.id,b.criteria={studentId:b.studentId},d.endpoint("/timetables/timetableStudyYears/:schoolId").query({schoolId:b.schoolId}).$promise.then(function(a){b.studyYears=a,b.criteria.studyYearId=b.generalTimetableUtils.getStudyYearId(b.schoolId,a)}),b.schoolId=b.auth.school.id,d.endpoint("/timetables/timetableStudyYears/:schoolId").query({schoolId:b.schoolId}).$promise.then(function(a){b.studyYears=a,b.criteria.studyYearId=b.generalTimetableUtils.getStudyYearId(b.schoolId,a)}),b.$watch("criteria.studyYearId",function(){angular.isDefined(b.criteria.studyYearId)&&null!==b.criteria.studyYearId&&b.showStudentWeek()}),b.changeStudyYear=function(a){b.generalTimetableUtils.changeState({studyYearId:a.id},b.schoolId),b.criteria.studyYearId=a.id},b.showStudentWeek=function(){var a={};a.studentId=b.criteria.studentId,b.generalTimetableUtils.changeState(a,b.schoolId),b.$broadcast("updateWeekTimetable",{criteria:b.criteria})}}]).controller("StudentEditController",["$location","$route","$scope","message","oisFileService","QueryUtils","DataUtils","dialogService","hoisDateFilter","$rootScope",function(a,b,c,d,e,f,g,h,i,j){function k(){c.student.status in o&&(d.error("main.messages.error.nopermission"),j.back("#/students/"+c.student.id+"/main")),c.student.photo?c.student.imageUrl=e.getUrl(c.student.photo,"student"):c.student.imageUrl="?"+(new Date).getTime(),g.convertStringToDates(c.student,["studyStart"]),c.errorParams={studyStart:i(c.student.studyStart)}}function l(a){return"RIIK_EST"===a.residenceCountry?a.address&&a.addressAds&&a.addressAdsOid:a.address}function m(a){c.studentEditForm.photoFiles&&c.studentEditForm.photoFiles.$modelValue[0]?(c.student.deleteCurrentPhoto=null,c.student.photo=e.getFromLfFile(c.studentEditForm.photoFiles.$modelValue[0],a)):c.studentEditForm.deleteCurrentPhoto&&c.studentEditForm.deleteCurrentPhoto.$modelValue?(c.student.photo=null,a()):a()}var n=b.current.params.id,o=Object.freeze({OPPURSTAATUS_K:"OPPURSTAATUS_K",OPPURSTAATUS_L:"OPPURSTAATUS_L"});c.student=f.endpoint("/students").get({id:n}),c.student.$promise.then(k),c.specialities=f.endpoint("/students/"+n+"/specialities").query(),c.update=function(){return c.studentEditForm.$setSubmitted(),l(c.student.person)?c.studentEditForm.$valid?void h.confirmDialog({prompt:"main.messages.confirmSave"},function(){m(function(){c.student.$update().then(function(){d.updateSuccess(),a.path("/students/"+n+"/main")})})}):void d.error("main.messages.form-has-errors"):void d.error("student.error.addressRequired")}}]).controller("StudentAbsencesController",["$mdDialog","$route","$scope","dialogService","message","DataUtils","QueryUtils",function(a,b,c,d,e,f,g){c.auth=b.current.locals.auth,c.studentId=b.current.params.id,c.student=g.endpoint("/students").get({id:c.studentId}),c.currentNavItem="student.absences",c.absencesCriteria={size:20,page:1,order:"validFrom, validThru"},c.loadAbsences=function(){var a=g.getQueryParams(c.absencesCriteria);g.endpoint("/students/"+c.studentId+"/absences").search(a,c.afterLoadData)},c.afterLoadData=function(a){c.tabledata=a},c.editAbsence=function(b){var h=g.endpoint("/students/"+c.studentId+"/absences"),i=c.loadAbsences;b=angular.copy(b,{}),b.studentName=c.tabledata.studentName,b.studentGroup=c.tabledata.studentGroup,a.show({controller:["$scope",function(c){c.record=new h(b||{}),f.convertStringToDates(c.record,["validFrom","validThru"]),c.cancel=a.hide,c.update=function(){function b(){e.info(d),a.hide(),i()}if(c.studentAbsenceForm.$setSubmitted(),!c.studentAbsenceForm.$valid)return void e.error("main.messages.form-has-errors");var d=c.record.id?"main.messages.update.success":"main.messages.create.success";c.record.id?c.record.$update().then(b):c.record.$save().then(b)},c["delete"]=function(){d.confirmDialog({prompt:"student.absence.deleteconfirm"},function(){c.record.$delete().then(function(){e.info("main.messages.delete.success"),a.hide(),i()})})}}],templateUrl:"student/absence.edit.dialog.html",clickOutsideToClose:!1})},c.loadAbsences()}]).controller("StudentViewRemarksController",["$q","$route","$scope","Classifier","QueryUtils",function(a,b,c,d,e){c.auth=b.current.locals.auth,c.studentId=b.current.params.id,c.student=e.endpoint("/students").get({id:c.studentId}),c.currentNavItem="student.remarks";var f=d.valuemapper({reason:"MARKUS"});c.remarksCriteria={size:20,page:1,order:"-remark_time"},c.loadRemarks=function(){var a=e.getQueryParams(c.remarksCriteria);e.endpoint("/remarks/student/"+c.studentId).search(a,c.afterLoadData)},c.afterLoadData=function(a){c.tabledata={},c.tabledata.content=f.objectmapper(a.content),c.tabledata.totalElements=a.totalElements},a.all(f.promises).then(c.loadRemarks)}]).controller("StudentViewRRController",["$route","$scope","QueryUtils",function(a,b,c){b.auth=a.current.locals.auth,b.studentId=a.current.params.id,b.student=c.endpoint("/students").get({id:b.studentId}),b.currentNavItem="student.rr",c.createQueryForm(b,"/logs/rr/changelogs",{order:"-wrcl.inserted",student:b.studentId},void 0,void 0,!0),b.loadData()}]).controller("StudentViewSupportServiceController",["$route","$scope","QueryUtils","$timeout","dialogService","oisFileService","message","config","$httpParamSerializer",function(a,b,c,d,e,f,g,h,i){function j(a){b.supportServices.content=a.content,b.supportServices.totalElements=a.totalElements,b.supportServices.content.forEach(function(a){a.isArtificial&&(a.content=a.content.split(";"))})}b.auth=a.current.locals.auth,b.studentId=a.current.params.id,b.student=c.endpoint("/students").get({id:b.studentId}),b.currentNavItem="student.supportService",b.isArray=angular.isArray,b.getUrl=f.getUrl,b.editService=function(a){e.showDialog("student/templates/edit.service.dialog.html",function(d){a?d.service=angular.copy(a,{}):d.service={entryDate:new Date,entrySubmitter:b.auth.fullname,validity:"TUGIKEHTIV_K"},d.getUrl=b.getUrl,d.update=function(){c.endpoint("/students/"+b.studentId+"/supportservice").update(d.service).$promise.then(function(){g.info("main.messages.update.success"),b.loadSupportServices()})},d.save=function(){c.endpoint("/students/"+b.studentId+"/supportservice").save(d.service,function(){g.info("main.messages.create.success"),b.loadSupportServices()})},d["delete"]=function(){e.confirmDialog({prompt:"student.supportService.operation.deleteService.message"},function(){c.endpoint("/students/"+b.studentId+"/supportservice")["delete"](d.service,function(){g.info("main.messages.delete.success"),d.cancel(),b.loadSupportServices()})})},d.close=function(){d.dialogForm.$setSubmitted(),d.dialogForm.$dirty?e.confirmDialog({prompt:"main.messages.confirmFormDataNotSaved"},function(){d.cancel()}):d.cancel()}},function(a){var b=a.data;b&&b.file[0]?f.getFromLfFile(b.file[0],function(b){a.service.file=b,a.service.id?a.update():a.save()}):a.service.id?a.update():a.save()})},b.printServices=function(){e.showDialog("student/templates/print.services.dialog.html",function(a){a.pdfUrl=function(){return h.apiUrl+"/students/"+b.studentId+"/supportservices/print.pdf?"+i({from:a.from,thru:a.thru})}})},b.supportServicesCriteria={size:10,page:1,order:"-entry_date"},b.supportServices={},b.loadSupportServices=function(){var a=angular.extend({},c.getQueryParams(b.supportServicesCriteria),{id:b.studentId});b.supportServices.$promise=c.endpoint("/students/:id/supportservices").search(a,j);
},b.loadSupportServices()}]),angular.module("hitsaOis").config(["$routeProvider","USER_ROLES",function(a,b){var c={authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_OPPUR]},d=a.$get[a.$get.length-1]({$on:function(){}});a.when("/students/:id/main",{templateUrl:"student/view.main.html",controller:"StudentViewMainController",controllerAs:"controller",data:c,resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]}}).when("/students/:id/results",{templateUrl:"student/view.results.html",controller:"StudentViewResultsController",controllerAs:"controller",data:c,resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]}}).when("/students/:id/documents",{templateUrl:"student/view.documents.html",controller:"StudentViewDocumentsController",controllerAs:"controller",data:c,resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]}}).when("/students/:id/remarks",{templateUrl:"student/view.remarks.html",controller:"StudentViewRemarksController",controllerAs:"controller",data:c,resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]}}).when("/students/:id/timetable",{templateUrl:"student/view.timetable.html",controller:"StudentViewTimetableController",controllerAs:"controller",data:c,resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]}}).when("/students/:id/edit",{templateUrl:"student/edit.main.html",controller:"StudentEditController",controllerAs:"controller",data:c,resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]}}).when("/students/:id/absences",{templateUrl:"student/view.absences.html",controller:"StudentAbsencesController",controllerAs:"controller",data:c,resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]}}).when("/students/:id/rr",{templateUrl:"student/view.rr.html",controller:"StudentViewRRController",controllerAs:"controller",data:c,resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]}}).when("/students/:id/supportService",{templateUrl:"student/view.supportservice.html",controller:"StudentViewSupportServiceController",controllerAs:"controller",data:c,resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]}}).when("/students",{templateUrl:"student/list.html",controller:"SimpleListController",controllerAs:"controller",data:{authorizedRoles:function(a){return-1!==a.authorizedRoles.indexOf(b.ROLE_OIGUS_V_TEEMAOIGUS_OPPUR)&&"ROLL_T"!==a.roleCode}},resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],clMapping:function(){return{studyForm:"OPPEVORM",status:"OPPURSTAATUS"}},params:function(){return{order:"person.lastname,person.firstname"}},url:function(){return"/students"},auth:["AuthResolver",function(a){return a.resolve()}]}}).when("/students/myData",{templateUrl:"student/view.main.html",controller:"StudentViewMainController",controllerAs:"controller",data:c,resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]}}).when("/students/myResults",{templateUrl:"student/view.results.html",controller:"StudentViewResultsController",controllerAs:"controller",data:c,resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]}}).when("/students/journals",{templateUrl:"student/student.journal.list.html",controller:"StudentJournalListController",controllerAs:"StudentJournalListController",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_OPPUR,b.ROLE_OIGUS_V_TEEMAOIGUS_PAEVIK]}}).when("/students/journals/:id",{templateUrl:"student/student.journal.html",controller:"StudentJournalViewController",controllerAs:"StudentJournalViewController",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_OPPUR,b.ROLE_OIGUS_V_TEEMAOIGUS_PAEVIK]}}).when("/students/study",{templateUrl:"student/student.journal.study.html",controller:"StudentJournalStudyController",controllerAs:"StudentJournalStudyController",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_OPPUR,b.ROLE_OIGUS_V_TEEMAOIGUS_PAEVIK]}}).when("/students/tasks",{templateUrl:"student/student.journal.tasks.html",controller:"StudentJournalTasksController",controllerAs:"StudentJournalTasksController",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_OPPUR,b.ROLE_OIGUS_V_TEEMAOIGUS_PAEVIK]}}).when("/students/specialities",{templateUrl:"student/speciality/student.speciality.list.html",controller:"StudentSpecialitySearchController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:function(a,c){return a.school.higher===!0&&"ROLL_A"===a.roleCode&&-1!==c.indexOf(b.ROLE_OIGUS_M_TEEMAOIGUS_OPPUR)}}}),d.routes["/students/:id/main"].regexp=/^\/(?:students\/(\d+))\/main$/,d.routes["/students/:id/main/"].regexp=/^\/(?:students\/(\d+))\/main\/$/,d.routes["/students/:id/edit"].regexp=/^\/(?:students\/(\d+))\/edit$/,d.routes["/students/:id/edit/"].regexp=/^\/(?:students\/(\d+))\/edit\/$/}]),function(){function a(a,b){for(var c=[],d=1,e=new Date(a),f=new Date(b);f>e;){var g={};g.weekNr=d++,g.start=e,e=new Date(e.getFullYear(),e.getMonth(),e.getDate()+(7-e.getDay())),g.end=e,g.entries=[],c.push(g),e=new Date(e.getFullYear(),e.getMonth(),e.getDate()+1)}return c}function b(b,c,d){for(var e=a(b,c),f=0;f<d.length;f++)for(var g=0;g<e.length;g++){var h=new Date(d[f].date).setHours(0,0,0,0);if(e[g].start.setHours(0,0,0,0)<h&&h<e[g].end.setHours(0,0,0,0)){e[g].entries.push(d[f]);break}}return e}function c(a){for(var b=moment().startOf("isoWeek").toDate(),c=0;c<a.length;c++)if(a[c].start.getTime()===b.getTime())return a[c]}function d(a){for(var b,c=0;c<=a.weeks.length-1;c++)a.weeks[c].weekNr===a.shownWeek.weekNr&&(b=c);a.previousWeekIndex=a.weeks[b-1]?b-1:null,a.nextWeekIndex=a.weeks[b+1]?b+1:null}angular.module("hitsaOis").controller("StudentJournalListController",["$scope","$route","QueryUtils","Classifier","DataUtils","stateStorageService",function(a,b,c,d,e,f){function g(b){for(var c=0;c<a.journalsByYears.length;c++)if(a.journalsByYears[c].yearCode===b)return c;return null}function h(a,b){for(var c=[],d=0;d<a.length;d++)c.push({yearId:a[d].id,yearCode:a[d].code,journals:[],collapsableOpen:-1!==b.indexOf(a[d].code)});return c}function i(){for(var b=[],c=0;c<a.journalsByYears.length;c++)a.journalsByYears[c].collapsableOpen&&b.push(a.journalsByYears[c].yearCode);f.changeState(l,m,{openedStudyYears:b})}a.currentNavItem="journals",a.auth=b.current.locals.auth;var j=a.auth.student,k=d.valuemapper({entryType:"SISSEKANNE"}),l=b.current.locals.auth.school.id,m="studentJournal",n=f.loadState(l,m);c.endpoint("/journals/studentJournalStudyYears/").query({studentId:j}).$promise.then(function(b){var c=[];if(n.openedStudyYears&&n.openedStudyYears.length>0)c=n.openedStudyYears;else{var d=e.getCurrentStudyYearOrPeriod(b),f=d?d.code:null;c.push(f)}a.journalsByYears=h(b.reverse(),c),c.forEach(function(b){var c=g(b);null!==c&&a.getStudyYearJournals(a.journalsByYears[c].yearId,b,!0)})}),a.getStudyYearJournals=function(b,d,e){var f=g(d),h=a.journalsByYears[f];e||(h.collapsableOpen=!h.collapsableOpen),i(),0===a.journalsByYears[f].journals.length&&(c.loadingWheel(a,!0),c.endpoint("/journals/studentJournals/").query({studentId:j,studyYearId:b}).$promise.then(function(b){b.forEach(function(b){b.journalEntries.forEach(function(a){k.objectmapper(a)}),a.journalsByYears[f].journals.push(b)}),c.loadingWheel(a,!1)}))};var o=["A","3","4","5"];a.resultIsPostive=function(a){return-1!==o.indexOf(a)};var p=["SISSEKANNE_E","SISSEKANNE_I","SISSEKANNE_H"];a.isTestButNotFinal=function(a){return-1!==p.indexOf(a)}}]).controller("StudentJournalStudyController",["$scope","$route","QueryUtils",function(a,e,f){a.currentNavItem="study",a.auth=e.current.locals.auth;var g=a.auth.student;f.endpoint("/journals/studentJournalStudy/").search({studentId:g}).$promise.then(function(e){a.weeks=b(e.studyYearStartDate,e.studyYearEndDate,e.entries),a.shownWeek=c(a.weeks),d(a)}),a.changeWeek=function(b){a.shownWeek=a.weeks[b],d(a)}}]).controller("StudentJournalTasksController",["$scope","$route","QueryUtils",function(a,e,f){a.currentNavItem="tasks",a.auth=e.current.locals.auth;var g=a.auth.student;f.endpoint("/journals/studentJournalTasks/").search({studentId:g}).$promise.then(function(e){a.weeks=b(e.studyYearStartDate,e.studyYearEndDate,e.tasks),a.shownWeek=c(a.weeks),d(a)}),a.changeWeek=function(b){a.shownWeek=a.weeks[b],d(a)}}]).controller("StudentJournalViewController",["$mdColors","$route","$scope","Classifier","QueryUtils",function(a,b,c,d,e){c.auth=b.current.locals.auth;var f=c.auth.student,g=b.current.params.id,h=d.valuemapper({entryType:"SISSEKANNE"});c.journalEntryTypeColors={SISSEKANNE_T:"default-grey-50",SISSEKANNE_E:"default-amber-100",SISSEKANNE_I:"default-lime-100",SISSEKANNE_H:"default-pink-50",SISSEKANNE_L:"default-pink-300",SISSEKANNE_O:"default-light-blue-50",SISSEKANNE_P:"default-teal-100",SISSEKANNE_R:"default-indigo-100"},c.journalEntryTypes={},d.queryForDropdown({mainClassCode:"SISSEKANNE"},function(a){c.journalEntryTypes=d.toMap(a)}),c.getEntryColor=function(a){return c.journalEntryTypeColors[a]},c.getEntryMdColor=function(b){return a.getThemeColor(c.journalEntryTypeColors[b])},e.endpoint("/journals/studentJournal/").search({studentId:f,journalId:g}).$promise.then(function(a){a.journalEntries.forEach(function(a){h.objectmapper(a)}),c.journal=a})}])}(),angular.module("hitsaOis").config(["$routeProvider","USER_ROLES",function(a,b){a.when("/absences",{templateUrl:"studentAbsence/absence.search.html",controller:"StudentAbsenceController",controllerAs:"controller",data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_PUUDUMINE]},resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]}}).when("/groupAbsences/:today?",{templateUrl:"studentAbsence/absence.group.html",controller:"StudentGroupAbsenceController",controllerAs:"controller",data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_PUUDUMINE]},resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]}})}]),angular.module("hitsaOis").controller("StudentAbsenceController",["$scope","$route","$timeout","QueryUtils","DataUtils","ArrayUtils","dialogService","message",function(a,b,c,d,e,f,g,h){var i=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17];d.createQueryForm(a,"/absences",{order:"-sa.inserted",isAccepted:!1}),e.convertStringToDates(a.criteria,["validFrom","validThru"]),a.criteria.status="isNotAccepted",a.criteria.isAccepted=!1,a.criteria.isRejected=!1;var j=a.loadData;a.loadData=function(){a.absencesSearchForm.$setSubmitted(),a.absencesSearchForm.$valid?j():h.error("main.messages.form-has-errors")},a.directiveControllers=[];var k=a.clearCriteria;a.clearCriteria=function(){k(),a.directiveControllers.forEach(function(a){a.clear()})},a.studyPeriods=d.endpoint("/autocomplete/studyPeriods").query(),a.studyYears=d.endpoint("/autocomplete/studyYears").query(),a.studyYears.$promise.then(function(){var b=e.getCurrentStudyYearOrPeriod(a.studyYears);a.criteria.studyYear=b?b.id:void 0,a.criteria.studyYear?c(a.loadData):0===a.studyYears.length&&h.error("studyYear.missing")}),a.statusChanged=function(){switch(a.criteria.isAccepted=null,a.criteria.isRejected=null,a.criteria.status){case"accepted":a.criteria.isAccepted=!0;break;case"rejected":a.criteria.isRejected=!0;break;case"isNotAccepted":a.criteria.isAccepted=!1,a.criteria.isRejected=!1}};var l=d.endpoint("/absences/accept");a.accept=function(b){g.confirmDialog({prompt:"absence.acceptConfirm"},function(){new l(b).$update().then(function(){f.remove(a.tabledata.content,b),h.info("absence.accepted"),a.criteria.status||a.loadData()})})},a.openRejectDialog=function(b){var c="studentAbsence/absence.reject.dialog.html";g.showDialog(c,function(c){function e(){return c.dialogForm.$setSubmitted(),c.dialogForm.$valid?!0:(h.error("main.messages.form-has-errors"),!1)}c.absence=b,c.rejectAbsence=function(){e()&&d.endpoint("/absences/reject/"+c.absence.id).put(c.rejectReason).$promise.then(function(){f.remove(a.tabledata.content,b),h.info("absence.rejected"),a.criteria.status||a.loadData()})}},function(){})};var m=d.endpoint("/absences/acceptByLessons");a.acceptByLessons=function(b){g.showDialog("studentAbsence/absence.accept.by.lessons.dialog.html",function(a){function c(b){var c=[];if(a.absence.validThru)for(var e=moment.utc(a.absence.validFrom),f=moment.utc(a.absence.validThru);f>=e;)d(c,b,e.toDate()),e=moment(e).add(1,"days");else d(c,b,new Date(a.absence.validFrom));return c}function d(a,b,c){b?a.push(c):e.isWeekend(c)||a.push(c)}function f(){for(var b in a.lessonsByDate){var c=g(b);if(c)return!0}return!1}function g(b){if(!a.showWeekends&&e.isWeekend(new Date(b)))return!1;for(var c in a.lessonsByDate[b])if(a.lessonsByDate[b][c])return!0;return!1}a.canEdit=!0,a.absence=b,a.maxLessonNr=10,a.lessons=i.map(function(a){return{nameEt:a,nameEn:a,id:a}}),a.lessonsByDate={},a.lessonsToAccept=!1,a.showWeekendsChanged=function(){a.dates=c(a.showWeekends),a.lessonsToAccept=f()},a.lessonByDate=function(){a.lessonsToAccept=f()},a.dates=c(!1)},function(c){var d={};angular.forEach(c.lessonsByDate,function(a,b){!c.showWeekends&&e.isWeekend(new Date(b))&&(a=void 0),d[moment(new Date(b)).format("YYYY-MM-DD")]=a}),b.lessonsByDate=d,new m(b).$update().then(function(){f.remove(a.tabledata.content,b),h.info("absence.accepted"),a.criteria.status||a.loadData()})})},a.viewAcceptedLessons=function(a){g.showDialog("studentAbsence/absence.accept.by.lessons.dialog.html",function(b){b.canEdit=!1,d.endpoint("/absences").get({id:a.id}).$promise.then(function(a){b.absence=a,b.lessonsByDate=a.acceptedLessonsByDate,b.maxLessonNr=a.maxLessonNr>10?a.maxLessonNr:10,b.dates=Object.keys(a.acceptedLessonsByDate)})})},a.filterByStudyYear=function(a){return function(b){return!a||b.studyYear===a}},a.studyYearChanged=function(){a.criteria.studyPeriod=void 0}}]),angular.module("hitsaOis").controller("StudentGroupAbsenceController",["$route","$scope","$timeout","Classifier","DataUtils","QueryUtils","message","stateStorageService",function(a,b,c,d,e,f,g,h){function i(){if(!b.criteria.studyYear){var a=e.getCurrentStudyYearOrPeriod(b.formState.studyYears);a&&(b.criteria.studyYear=a.id,b.studyYearChanged(!0))}}function j(){b.studentGroupAbsenceForm&&b.studentGroupAbsenceForm.$valid?b.search():c(j)}function k(){var a=new Date,c=a.getTime();b.criteria.studyWeek=null;for(var d in b.formState.studyWeeks){var e=b.formState.studyWeeks[d];if(c>=new Date(e.start)&&c<=new Date(e.end)){b.criteria.studyWeek=e;break}}}function l(a){return a.slice(0,10)}function m(a){b.journals=[];for(var c in a){var d=a[c];for(var e in d)d[e].date=c;b.journals=b.journals.concat(d)}}function n(a){b.studentAbsences={};for(var c=0;c<a.length;c++){var d=a[c],e=d.student;angular.isDefined(b.studentAbsences[e])||(b.studentAbsences[e]={});var f=d.journal;angular.isDefined(b.studentAbsences[e][f])||(b.studentAbsences[e][f]={});var g=l(d.entryDate);angular.isDefined(b.studentAbsences[e][f][g])||(b.studentAbsences[e][f][g]={});var h=d.journalStudentEntry;angular.isDefined(b.studentAbsences[e][f][g][h])||(b.studentAbsences[e][f][g][h]=[]),b.studentAbsences[e][f][g][h].push(d)}}b.auth=a.current.locals.auth;var o="/groupAbsences",p=a.current.locals.auth.school.id,q="groupabsences";d.queryForDropdown({mainClassCode:"PUUDUMINE"},function(a){b.formState.absenceOptions=a}),b.criteria={},b.directiveControllers=[],b.formState={studyYears:f.endpoint("/autocomplete/studyYears").query(i),studyWeeks:[]},b.studyYearChanged=function(a){var c=[];c=a?f.endpoint(o+"/studyYearWeeks/"+b.criteria.studyYear).query(k):f.endpoint(o+"/studyYearWeeks/"+b.criteria.studyYear).query(),b.formState.studyWeeks=c},b.search=function(){return b.studentGroupAbsenceForm.$setSubmitted(),b.studentGroupAbsenceForm.$valid?(b.criteria.studyWeekStart=b.criteria.studyWeek?b.criteria.studyWeek.start:null,b.criteria.studyWeekEnd=b.criteria.studyWeek?b.criteria.studyWeek.end:null,f.loadingWheel(b,!0),f.endpoint(o).get(b.criteria).$promise.then(function(a){f.loadingWheel(b,!1),b.content=a,m(a.journalsByDates),n(a.studentAbsences),b.$broadcast("refreshFixedColumns")}),void h.changeState(p,q,b.criteria)):void g.error("main.messages.form-has-errors")},b.clearCriteria=function(){b.criteria={},b.directiveControllers.forEach(function(a){a.clear()})},"today"in a.current.params?(b.criteria.todaysAbsences=!0,j()):"_menu"in a.current.params||(b.storedCriteria=h.loadState(p,q),angular.extend(b.criteria,b.storedCriteria),b.studyYearChanged(!1),b.formState.studyWeeks.$promise.then(function(a){for(var c in a)if(a[c].nr===b.criteria.studyWeek.nr){b.criteria.studyWeek=a[c],b.studentGroupAbsenceForm.$valid=!0,b.studentGroupAbsenceForm.$invalid=!1,b.search();break}})),b.auth.isTeacher()&&f.endpoint("/autocomplete/studentgroups").query({valid:!0,higher:!1,studentGroupTeacherId:b.auth.teacher}).$promise.then(function(a){b.formState.studentGroups=a,b.criteria.studentGroup||(b.criteria.studentGroup=1===a.length?a[0].id:null)}),b.journalsByDateCount=function(a){var c=l(a);return b.content.journalsByDates[c].length},b.absenceChanged=function(a){f.endpoint(o+"/entry/"+a.journalStudentEntry).put({absence:a.absence})},b.lessonAbsenceChanged=function(a){f.endpoint(o+"/lesson/"+a.journalEntryStudentLessonAbsence).put({absence:a.absence})}}]),angular.module("hitsaOis").config(["$routeProvider","USER_ROLES",function(a,b){a.when("/studentCards",{templateUrl:"studentCard/student.card.search.html",controller:"StudentCardSearchController",controllerAs:"controller",data:{authorizedRoles:function(a,c){return"ROLL_A"===a.roleCode&&-1!==c.indexOf(b.ROLE_OIGUS_V_TEEMAOIGUS_PILET)}},resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]}}).when("/studentCards/studentCardManagement",{templateUrl:"studentCard/student.card.management.html",controller:"StudentCardManagementController",controllerAs:"controller",data:{authorizedRoles:function(a,c){return"ROLL_A"===a.roleCode&&-1!==c.indexOf(b.ROLE_OIGUS_M_TEEMAOIGUS_PILET)}},resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]}})}]),angular.module("hitsaOis").controller("StudentCardSearchController",["$scope","$q","QueryUtils","config","$httpParamSerializer","$route","dialogService","message","FormUtils",function(a,b,c,d,e,f,g,h,i){a.currentNavItem="student.card.search";var j=f.current.locals.auth;a.canEdit=-1!==j.authorizedRoles.indexOf("ROLE_OIGUS_M_TEEMAOIGUS_PILET"),c.createQueryForm(a,"/studentCards",{order:"p.lastname, p.firstname"}),a.copiedCriteria={};var k=a.loadData;a.loadData=function(){i.withValidForm(a.searchForm,function(){angular.copy(a.criteria,a.copiedCriteria),k()})},b.all().then(a.loadData),a.orderUrl=function(b){return d.apiUrl+"/studentCards/"+b+".zip?"+e(a.copiedCriteria)},a.excelUrl=function(){return d.apiUrl+"/studentCards/excel.xlsx?"+e(a.copiedCriteria)},a.orderRepetition=function(a){g.confirmDialog({prompt:"student.card.operation.orderRepetition.prompt"},function(){c.endpoint("/studentCards/orderRepetition/"+a.studentId).save({},function(b){h.info("student.card.operation.orderRepetition.success");for(var c in b)a[c]=b[c]})})}}]).controller("StudentCardManagementController",["$scope","$q","QueryUtils","dialogService","message","$route","FormUtils","$timeout",function(a,b,c,d,e,f,g,h){a.currentNavItem="student.card.management";var i=f.current.locals.auth;a.canEdit=-1!==i.authorizedRoles.indexOf("ROLE_OIGUS_M_TEEMAOIGUS_PILET"),c.createQueryForm(a,"/studentCards",{order:"p.lastname, p.firstname"},function(){angular.isDefined(a.cards)&&a.cards.$dirty===!0&&a.cards.$setPristine()},!0),angular.extend(a.criteria,{size:100}),a.copiedCriteria={};var j=a.loadData;a.loadData=function(){g.withValidForm(a.searchForm,function(){angular.copy(a.criteria,a.copiedCriteria),j()})},b.all().then(a.loadData);var k=!1;a.changePage=function(){k||(angular.isDefined(a.cards)&&a.cards.$dirty===!0?d.confirmDialog({prompt:"main.messages.confirmFormDataNotSaved"},function(){a.loadData()},function(){k=!0,angular.copy(a.copiedCriteria,a.criteria),h(function(){k=!1},50)}):a.loadData())},a.save=function(){g.withValidForm(a.cards,function(){c.endpoint("/studentCards").save(a.tabledata.content.filter(function(a){return a.dirty})).$promise.then(function(){e.info("main.messages.update.success"),a.loadData()})["catch"](a.loadData)})}}]),angular.module("hitsaOis").controller("StudentgroupContractController",["$scope","$route","$rootScope","QueryUtils","Classifier","$q","dialogService","$location","message","$timeout","FormUtils",function(a,b,c,d,e,f,g,h,i,j,k){a.auth=b.current.locals.auth;var l=e.valuemapper({status:"LEPING_STAATUS"});d.createQueryForm(a,"/contracts/studentGroup",{order:"student_person.lastname,student_person.firstname"},l.objectmapper);var m=!1;a.reload=function(){d.loadingWheel(a,!0),f.all(l.promises).then(function(){d.loadingWheel(a,!1),a.loadData()})},a.loadContracts=function(){k.withValidForm(a.searchForm,function(){a.reload()})},b.current.params.studentGroupId&&d.endpoint("/autocomplete/studentgroups").query({id:b.current.params.studentGroupId},function(b){a.studentGroupObject=b[0]}),a.$watch("studentGroupObject",function(b){angular.isObject(b)&&j(function(){m=!0,a.criteria.studentGroup=b.id,c.replaceLastUrl("#/practice/studentgroup/contracts/"+a.criteria.studentGroup),null!==b.curriculumVersion?d.endpoint("/autocomplete/curriculumversions?id="+b.curriculumVersion).query({},function(b){b&&1===b.length&&(a.criteria.curriculumVersion=b[0])}):d.endpoint("/autocomplete/curriculumsauto?id="+b.curriculum).query({},function(b){b&&1===b.length&&(a.criteria.curriculumVersion=b[0])}),a.reload()})}),a.contractInWork=function(a){var b=a.filter(function(a){return a.status?"LEPING_STAATUS_S"===a.status.code:!1});return b.length>0},a.studentActive=function(a){var b=a.filter(function(a){return a.active});return b.length>0},a.$watch("criteria.active",function(){m&&a.reload()}),a.sendToEkis=function(){h.path("/practice/studentgroup/ekis").search({"":"_menu",studentGroup:a.criteria.studentGroup})}}]).controller("StudentgroupEkisContractController",["$scope","$route","message","QueryUtils","Classifier","$q","dialogService","FormUtils",function(a,b,c,d,e,f,g,h){function i(b){g.showDialog("studentgroupContract/studentgroup.contract.result.dialog.html",function(a){a.criteria=b},a.reload())}a.auth=b.current.locals.auth;var j=e.valuemapper({status:"LEPING_STAATUS"});d.createQueryForm(a,"/contracts/ekis",{order:"student_person.lastname,student_person.firstname"},j.objectmapper),a.reload=function(){d.loadingWheel(a,!0),angular.isObject(a.criteria)&&(a.criteria.size=9e3,a.criteria.page=1,angular.isObject(a.studentGroupObject)?a.criteria.studentGroup=a.studentGroupObject.id:a.criteria.studentGroup=void 0),f.all(j.promises).then(function(){d.loadingWheel(a,!1),a.loadData()})},a.checkAll=function(){a.allChecked===!0?a.tabledata.content.forEach(function(a){a.checked=!0}):a.allChecked===!1&&a.tabledata.content.forEach(function(a){a.checked=!1})},a.loadContracts=function(){h.withValidForm(a.searchForm,function(){a.reload()})},(b.current.params.studentGroup||b.current.params.studentName)&&(b.current.params.studentName&&(a.criteria.studentName=b.current.params.studentName),b.current.params.studentGroup?d.endpoint("/autocomplete/studentgroups").query({id:b.current.params.studentGroup},function(b){a.studentGroupObject=b[0],a.reload()}):a.reload()),a.contractInWork=function(a){var b=a.filter(function(a){return a.status?"LEPING_STAATUS_S"===a.status.code:!1});return b.length>0},a.sendToEkis=function(){var b={contracts:[]};return a.tabledata.content.forEach(function(a){return a.id&&a.checked?b.contracts.push(a.id):void 0}),0===b.contracts.length?void c.error("contract.atleastOne"):void d.endpoint("/contracts/checkForEkis").get().$promise.then(function(c){g.confirmDialog({prompt:c.templateExists?"contract.ekisconfirm":"contract.ekisconfirmTemplateMissing",template:c.templateName},function(){var c=d.endpoint("/contracts/sendToEkis");new c(b).$save().then(function(b){a.allChecked=!1,i(b)})["catch"](angular.noop)})})}}]),angular.module("hitsaOis").config(["$routeProvider","USER_ROLES",function(a){a.when("/practice/studentgroup/contracts",{templateUrl:"studentgroupContract/studentgroup.contract.list.html",controller:"StudentgroupContractController",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]}}).when("/practice/studentgroup/contracts/:studentGroupId",{templateUrl:"studentgroupContract/studentgroup.contract.list.html",controller:"StudentgroupContractController",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]}}).when("/practice/studentgroup/ekis",{templateUrl:"studentgroupContract/studentgroup.ekis.contract.list.html",controller:"StudentgroupEkisContractController",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]}})}]),angular.module("hitsaOis").controller("StudentGroupSearchController",["$q","$scope","Classifier","Curriculum","QueryUtils","Session",function(a,b,c,d,e,f){function g(){return b.formState.studyForms.length>0?b.formState.allStudyForms.filter(function(a){return-1===b.formState.studyForms.indexOf(a.code)}):void 0}var h="/studentgroups",i=c.valuemapper({studyForm:"OPPEVORM"});e.createQueryForm(b,h,{order:"code"},i.objectmapper);var j=f.school||{},k=j.higher&&!j.vocational;b.formState={allCurriculumVersions:d.queryVersions(),curriculumVersions:[],allStudyForms:c.queryForDropdown({mainClassCode:"OPPEVORM",higher:j.higher||void 0,vocational:j.vocational||void 0}),studyForms:[],curriculumVersionLabel:"studentGroup.curriculumVersionBoth",onlyhigher:k},void 0===b.criteria.isValid&&(b.criteria.isValid=!0),k?b.formState.curriculumVersionLabel="studentGroup.curriculumVersionHigher":!j.higher&&j.vocational&&(b.formState.curriculumVersionLabel="studentGroup.curriculumVersionVocational"),b.$watch("criteria.curriculum",function(){function a(a){c?(b.formState.curriculumVersions=b.formState.allCurriculumVersions.filter(function(a){return a.curriculum===c}),b.criteria.curriculumVersion=null):b.formState.curriculumVersions=b.formState.allCurriculumVersions,b.formState.studyForms=a.studyForms||[],b.criteria.studyForm=b.formState.studyForm.filter(function(a){return-1!==b.formState.studyForms.indexOf(a)}),b.curriculumVersionChanged()}var c=b.criteria.curriculum?b.criteria.curriculum.id:null;b.formState.studyForm=b.criteria.studyForm||[],c?e.endpoint(h+"/curriculumdata").get({id:c},a):a({studyForms:b.formState.allStudyForms.map(function(a){return a.code})})}),b.curriculumVersionChanged=function(){if(b.criteria.curriculumVersion&&0!==b.criteria.curriculumVersion.length){var a=b.formState.curriculumVersions.reduce(function(a,b){return a[b.id]=b.studyForm,a},{});a=b.criteria.curriculumVersion.map(function(b){return a[b]}),-1!==a.indexOf(null)?b.formState.hiddenStudyForms=g():b.formState.hiddenStudyForms=b.formState.allStudyForms.filter(function(b){return-1===a.indexOf(b.code)})}else b.formState.hiddenStudyForms=g()},a.all(i.promises).then(b.loadData)}]).controller("StudentGroupEditController",["$location","$mdDialog","$q","$route","$scope","dialogService","message","Classifier","Curriculum","QueryUtils","Session",function(a,b,c,d,e,f,g,h,i,j,k){function l(){e.formState.students=r.objectmapper(e.record.members),e.formState.selectedStudents=angular.copy(e.formState.students),e.formState.readonly=e.record.id&&e.formState.students&&e.formState.students.length>0,e.formState.currentCurriculumVersion=e.record.curriculumVersion,e.curriculumChanged(),e.validThruChanged(),e.record.members.forEach(function(a,b){a.rowno=b+1})}function m(){e.record.students=e.formState.selectedStudents.map(function(a){return a.id}),e.record.id?e.record.$update().then(l).then(g.updateSuccess)["catch"](angular.noop):e.record.$save().then(function(){g.info("main.messages.create.success"),a.url(p+"/"+e.record.id+"/edit?_noback")})["catch"](angular.noop)}function n(a){e.formState.selectedStudents=e.formState.selectedStudents.concat(a),e.update()}var o=d.current.params.id,p="/studentgroups",q=j.endpoint(p),r=h.valuemapper({studyForm:"OPPEVORM",studyLevel:"OPPEASTE",status:"OPPURSTAATUS"}),s=h.valuemapper({code:"SPETSKUTSE"}),t=k.school||{},u=!t.higher&&t.vocational;e.formState={allCurriculumVersions:i.queryVersions(),curriculumVersions:[],languages:[],studyForms:[],specialities:[],selectedStudents:[],order:"rowno",curriculumVersionLabel:"studentGroup.curriculumVersionBoth",onlyvocational:u,isVocational:t.vocational},u?e.formState.curriculumVersionLabel="studentGroup.curriculumVersionVocational":t.higher&&!t.vocational&&(e.formState.curriculumVersionLabel="studentGroup.curriculumVersionHigher"),e.curriculumChanged=function(){var a=e.record.curriculum?e.record.curriculum.id:null;if(e.formState.curriculumId!==a){e.formState.curriculumId=a,e.formState.language=e.record.language,e.formState.studyForm=e.record.studyForm,e.formState.speciality=e.record.speciality,e.formState.curriculumVersion=e.record.curriculumVersion;var b=function(b){e.formState.curriculumVersions=e.formState.allCurriculumVersions.filter(function(b){return b.curriculum===a}),e.formState.languages=b.languages||[],e.formState.studyForms=b.studyForms||[],e.formState.origStudyLevel=b.origStudyLevel,e.formState.specialities=b.specialities||[],e.formState.isVocational=b.isVocational,e.formState.studyPeriodInYears=b.studyPeriodInYears,c.all(s.promises).then(function(){s.objectmapper(e.formState.specialities),e.formState.specialities.forEach(function(a){a.code.validFrom=a.validFrom,a.code.validThru=a.validThru}),e.record.speciality=void 0!==e.formState.specialities.find(function(a){return a.code.code===e.formState.speciality})?e.formState.speciality:null}),e.record.language=-1!==e.formState.languages.indexOf(e.formState.language)?e.formState.language:null,e.record.studyForm=-1!==e.formState.studyForms.indexOf(e.formState.studyForm)?e.formState.studyForm:null,e.record.curriculumVersion=void 0!==e.formState.curriculumVersions.find(function(a){return a.id===e.formState.curriculumVersion})?e.formState.curriculumVersion:null};a?j.endpoint(p+"/curriculumdata").get({id:a},b):b({})}},e.curriculumVersionChanged=function(){if(e.record.curriculumVersion){var a=e.formState.curriculumVersions.reduce(function(a,b){return a[b.id]=b.studyForm,a},{}),b=a[e.record.curriculumVersion];b&&(e.record.studyForm=b)}},e.$watch("record.validThru",function(a){a&&"string"==typeof a&&(e.record.validThru=new Date(a))}),e.$watch("record.validFrom",function(a){a&&"string"==typeof a&&(e.record.validFrom=new Date(a))}),e.validThruChanged=function(){var a=e.record.validThru;a&&"string"==typeof e.record.validThru&&(a=moment(a,"YYYY-MM-DD'T'hh:mm:ss.SSS'Z'")),
e.formState.canAddStudents=!a||moment().isSameOrBefore(a,"day")},o?e.record=q.get({id:o},l):(e.record=new q,e.formState.readonly=!1),e.update=function(){return e.studentGroupForm.$setSubmitted(),e.studentGroupForm.$valid?void(e.record.id&&e.formState.currentCurriculumVersion!==e.record.curriculumVersion?j.endpoint(p+"/existsPendingLessonPlans/"+e.record.id).search({formCurriculumVersion:e.record.curriculumVersion}).$promise.then(function(a){a.pendingLessonPlans?f.confirmDialog({prompt:"studentGroup.updateLessonPlansConfirm",studentGroup:e.record.code},function(){m()}):m()}):m()):void g.error("main.messages.form-has-errors")},e["delete"]=function(){f.confirmDialog({prompt:"studentGroup.deleteconfirm"},function(){e.record.$delete().then(function(){g.info("main.messages.delete.success"),a.url(p+"?_noback")})["catch"](angular.noop)})},e.addStudents=function(){var a=["id","curriculum","curriculumVersion","language","studyForm"].reduce(function(a,b){return a[b]=e.record[b],a},{}),d=function(b){j.endpoint(p+"/findstudents").query(a,function(a){return 0===a.length?(b.formState.students=void 0,void g.info("studentGroup.nostudentsfound")):void c.all(r.promises).then(function(){var c=r.objectmapper(a);angular.isNumber(e.formState.curriculumVersion)&&(c=c.filter(function(a){return a.curriculumVersion.id===e.formState.curriculumVersion})),c.forEach(function(a,b){a.rowno=b+1}),b.formState.students=c})})};if(e.record.id){var f=e.formState.curriculumVersionLabel;return void b.show({controller:["$scope",function(a){a.formState={selectedStudents:[],curriculumVersionLabel:f,order:"rowno"},a.cancel=b.hide,a.select=function(){n(a.formState.selectedStudents),b.hide()},d(a)}],templateUrl:"studentGroup/student.select.dialog.html",clickOutsideToClose:!1})}return e.studentGroupForm.$setSubmitted(),e.studentGroupForm.$valid?void d(e):void g.info("studentGroup.mandatoryfields")},e.removeStudent=function(a){f.confirmDialog({prompt:"studentGroup.deletestudentconfirm"},function(){function b(b){return b.id!==a}e.formState.students=e.formState.students.filter(b),e.formState.selectedStudents=e.formState.selectedStudents.filter(b)})}}]).controller("StudentGroupViewController",["$route","$scope","$q","Classifier","Curriculum","QueryUtils","Session","USER_ROLES","AuthService",function(a,b,c,d,e,f,g,h,i){b.auth=a.current.locals.auth,b.canEdit=i.isAuthorized(h.ROLE_OIGUS_M_TEEMAOIGUS_OPPERYHM),b.showPersonalData=b.auth.isAdmin()||b.auth.isTeacher();var j=a.current.params.id,k="/studentgroups",l=d.valuemapper({status:"OPPURSTAATUS"}),m=d.valuemapper({speciality:"SPETSKUTSE"}),n=g.school||{},o=!n.higher&&n.vocational;b.formState={curriculumVersionLabel:"studentGroup.curriculumVersionBoth",onlyvocational:o,isVocational:n.vocational,order:"rowno"},o?b.formState.curriculumVersionLabel="studentGroup.curriculumVersionVocational":n.higher&&!n.vocational&&(b.formState.curriculumVersionLabel="studentGroup.curriculumVersionHigher"),b.record=f.endpoint(k).get({id:j},function(a){a&&a.curriculum&&a.curriculum.id&&f.endpoint(k+"/curriculumdata").get({id:a.curriculum.id},function(a){b.formState.origStudyLevel=a.origStudyLevel,b.formState.isVocational=a.isVocational;var d=a.specialities.find(function(a){return a.code===(angular.isObject(b.record.speciality)?b.record.speciality.code:b.record.speciality)});c.all(m.promises).then(function(){m.objectmapper(b.record),d&&(b.record.speciality.validFrom=d.validFrom,b.record.speciality.validThru=d.validThru)})}),a.curriculumVersion&&e.queryVersions().$promise.then(function(c){var d=c.filter(function(b){return b.id===a.curriculumVersion});b.formState.curriculumVersion=d.length>0?d[0]:void 0}),c.all(l.promises).then(l.objectmapper(a.members)),a.members.forEach(function(a,b){a.rowno=b+1})})}]),angular.module("hitsaOis").config(["$routeProvider","USER_ROLES",function(a,b){a.when("/studentgroups",{templateUrl:"studentGroup/student.group.list.html",controller:"StudentGroupSearchController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_OPPERYHM]}}).when("/studentgroups/new",{templateUrl:"studentGroup/student.group.edit.html",controller:"StudentGroupEditController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_OPPERYHM]}}).when("/studentgroups/:id/edit",{templateUrl:"studentGroup/student.group.edit.html",controller:"StudentGroupEditController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_OPPERYHM]}}).when("/studentgroups/:id/view",{templateUrl:"studentGroup/student.group.view.html",controller:"StudentGroupViewController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:function(a,c){return"ROLL_T"===a.roleCode||"ROLL_A"===a.roleCode&&-1!==c.indexOf(b.ROLE_OIGUS_V_TEEMAOIGUS_OPPERYHM)}}})}]),angular.module("hitsaOis").controller("StudentGroupYearTransferController",["$scope","QueryUtils","$translate","message","dialogService","Classifier","DataUtils",function(a,b,c,d,e,f,g){function h(b){return a.studyYears.filter(function(a){return a.id===b})[0]}function i(){return{id:a.studyYear,lang:c.use().toUpperCase()}}function j(b){if(!a.canTransfer)return null;var c=h(a.studyYear).startDate;return b.filter(function(a){return!a.transfered&&a.validThru<c}).map(function(a){return a.oldCode}).join(", ")}function k(){return a.studentGroups.filter(function(a){return a.selected})}function l(){var a={};return k().forEach(function(b){a[b.id]=b.newCode}),a}function m(a,b){var c=!0;return a.forEach(function(a){a[b]||(c=!1)}),c}function n(b){return a.transferForm.$setSubmitted(),0===b.length?(d.error("main.messages.error.atLeastOneMustBeSelected"),!1):m(b,"newCode")?!0:(d.error("main.messages.form-has-errors"),!1)}function o(){var b={};return a.mismatchingStudents.forEach(function(a){b[a.id]=a.newGroup}),b}var p="/studentGroupYearTransfer",q=f.valuemapper({mismatchCode:"OPPERYHM_EISOBI"}),r=b.endpoint(p);a.canTransfer=!1,a.studyYears=b.endpoint(p+"/studyYears").query(),a.studyYearChanged=function(){a.canTransfer=!g.isPastStudyYearOrPeriod(h(a.studyYear)),a.studentGroups=r.query(i(),function(b){a.checkGroupValidThru=j(b)}),a.multiSelect=!1,a.calculated=!1,a.mismatchingStudents=[]},a.multiSelectChanged=function(){a.studentGroups.filter(function(a){return!a.transfered}).forEach(function(b){b.selected=a.multiSelect}),a.selectChanged()},a.selectChanged=function(){a.calculated&&(a.calculated=!1,e.messageDialog({prompt:"studentGroupYearTransfer.recalculate"}))},a.calculate=function(){var c=k();n(c)&&b.endpoint(p+"/calculate").save(angular.extend(i(),{academicLeave:a.academicLeave,academicLeaveDays:a.academicLeaveDays,abroadStudies:a.abroadStudies,abroadStudiesDays:a.abroadStudiesDays,studentGroupIds:c.map(function(a){return a.id}),newGroupCodes:l()}),function(b){a.mismatchingStudents=[],a.studentGroups.forEach(function(c){var d=b[c.id];d&&(c.logId=d.logId,c.relatedStudents=d.suitableStudents+d.unsuitableStudents,c.suitableStudents=d.suitableStudents,c.unsuitableStudents=d.unsuitableStudents,d.mismatchingStudents.forEach(function(b){a.mismatchingStudents.push(angular.extend(b,{group:c}))}))}),q.objectmapper(a.mismatchingStudents),a.calculated=!0}).$promise["catch"](angular.noop)},a.viewMatchingStudents=function(a){e.showDialog("studentGroupYearTransfer/students.match.dialog.html",function(c){c.studentGroup=a,c.students=b.endpoint(p+"/matching/"+a.logId).query()})},a.viewMismatchingStudents=function(a){e.showDialog("studentGroupYearTransfer/students.mismatch.dialog.html",function(c){c.studentGroup=a,c.students=b.endpoint(p+"/mismatching/"+a.logId).query(function(a){q.objectmapper(a)})})},a.transfer=function(){var c=k();if(n(c))return m(a.mismatchingStudents,"newGroup")?void e.confirmDialog({prompt:"studentGroupYearTransfer.confirm"},function(){b.endpoint(p+"/transfer").save({logIds:c.map(function(a){return a.logId}),newGroupCodes:l(),newStudentGroups:o()},function(){a.studyYearChanged()}).$promise["catch"](angular.noop)}):void d.error("main.messages.form-has-errors")}}]),angular.module("hitsaOis").config(["$routeProvider","USER_ROLES",function(a,b){a.when("/studentGroupYearTransfer",{templateUrl:"studentGroupYearTransfer/student.group.year.transfer.html",controller:"StudentGroupYearTransferController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_UUDE_AASTASSE]}})}]),angular.module("hitsaOis").controller("StudentRepresentativeApplicationSearchController",["$mdDialog","$q","$scope","dialogService","message","Classifier","QueryUtils",function(a,b,c,d,e,f,g){c.formState={status:"AVALDUS_ESINDAJA_STAATUS_E"};var h=f.valuemapper({relation:"OPPURESINDAJA",status:"AVALDUS_ESINDAJA_STAATUS"});g.createQueryForm(c,"/studentrepresentatives/applications",{order:"student.person.lastname,student.person.firstname",status:c.formState.status},h.objectmapper);var i=c.loadData;c.loadData=function(){i(),c.formState.status=c.criteria.status};var j=g.endpoint("/studentrepresentatives/applications/accept");c.accept=function(a){d.confirmDialog({prompt:"student.representative.application.confirm",student:a.studentFullname,representative:a.fullname},function(){j.update({id:a.id,version:a.version}).$promise.then(function(){e.info("student.representative.application.accepted"),i()})["catch"](angular.noop)})},c.decline=function(b){a.show({controller:["$scope",function(c){c.record={id:b.id,version:b.version},c.decline=function(){if(c.studentRepresentativeApplicationDeclineForm.$setSubmitted(),!c.studentRepresentativeApplicationDeclineForm.$valid)return void e.error("main.messages.form-has-errors");var b=c.record;g.endpoint("/studentrepresentatives/applications/decline").update(b).$promise.then(function(){a.hide(),e.info("student.representative.application.declined"),i()})["catch"](angular.noop)},c.cancel=a.hide}],templateUrl:"studentRepresentative/representative.application.decline.dialog.html",clickOutsideToClose:!1})},b.all(h.promises).then(c.loadData)}]).controller("StudentRepresentativeApplicationCreateController",["$location","$scope","message","QueryUtils",function(a,b,c,d){b.record={},b.lookupPerson=function(a){b.record.firstname=a.firstname,b.record.lastname=a.lastname},b.lookupFailure=function(a){a&&412===a.status||c.error("student.representative.studentnotfound"),b.record.firstname=void 0,b.record.lastname=void 0},b.apply=function(){return b.studentRepresentativeApplicationCreateForm.$setSubmitted(),b.studentRepresentativeApplicationCreateForm.$valid?void d.endpoint("/studentrepresentatives/applications").save(b.record).$promise.then(function(){c.info("student.representative.application.applied"),a.url("/?_noback")})["catch"](angular.noop):void c.error("main.messages.form-has-errors")}}]),angular.module("hitsaOis").config(["$routeProvider","USER_ROLES",function(a,b){a.when("/studentrepresentatives/applications",{templateUrl:"studentRepresentative/representative.application.list.html",controller:"StudentRepresentativeApplicationSearchController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_ESINDAVALDUS]}}).when("/studentrepresentatives/applications/new",{templateUrl:"studentRepresentative/representative.application.create.html",controller:"StudentRepresentativeApplicationCreateController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}]}})}]),angular.module("hitsaOis").controller("StudentResultCardListController",["$httpParamSerializer","$q","$route","$scope","$window","Classifier","QueryUtils","config",function(a,b,c,d,e,f,g,h){d.auth=c.current.locals.auth;var i=f.valuemapper({studyForm:"OPPEVORM",status:"OPPURSTAATUS"});g.createQueryForm(d,"/students",{size:100,order:"person.lastname, person.firstname"},i.objectmapper),d.criteria.higher=!1,d.criteria.status||(d.criteria.status=["OPPURSTAATUS_L"]),d.selectedStudents=[],b.all().then(d.loadData),d.print=function(){e.location=h.apiUrl+"/students/studentResultCards.pdf?"+a({studentIds:d.selectedStudents})};var j=d.clearCriteria;d.clearCriteria=function(){j(),d.criteria.higher=!1}}]).controller("StudentResultCardController",["$httpParamSerializer","$route","$scope","$window","QueryUtils","config",function(a,b,c,d,e,f){c.auth=b.current.locals.auth;var g=b.current.params.id;e.endpoint("/students/"+g+"/studentResultCard").search(function(a){c.resultCard=a}),c.print=function(){d.location=f.apiUrl+"/students/studentResultCards.pdf?"+a({studentIds:g})}}]),angular.module("hitsaOis").config(["$routeProvider","USER_ROLES",function(a,b){a.when("/studentResultCards",{templateUrl:"studentResultCard/student.result.card.list.html",controller:"StudentResultCardListController",controllerAs:"controller",data:{authorizedRoles:function(a,c){return a.school.vocational===!0&&"ROLL_A"===a.roleCode&&-1!==c.indexOf(b.ROLE_OIGUS_V_TEEMAOIGUS_OPPUR)}},resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]}}).when("/studentResultCards/:id/view",{templateUrl:"studentResultCard/student.result.card.view.html",controller:"StudentResultCardController",controllerAs:"controller",data:{authorizedRoles:function(a,c){return a.school.vocational===!0&&"ROLL_A"===a.roleCode&&-1!==c.indexOf(b.ROLE_OIGUS_V_TEEMAOIGUS_OPPUR)}},resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]}})}]),function(){function a(a){return a.isAdmin()||a.isTeacher()}angular.module("hitsaOis").controller("StudyMaterialSubjectStudyPeriodController",["$scope","$route","QueryUtils","ArrayUtils","oisFileService","dialogService","message","Classifier","$q",function(b,c,d,e,f,g,h,i,j){function k(){b.materials=d.endpoint("/studyMaterial/subjectStudyPeriod/"+b.subjectStudyPeriod.id+"/materials").query(),b.materials.$promise.then(function(a){j.all(m.promises).then(function(){m.objectmapper(a)})})}b.auth=c.current.locals.auth,b.canEdit=a(b.auth),b.subjectStudyPeriod=c.current.locals.subjectStudyPeriod,b.teachers=b.subjectStudyPeriod.teachers.map(b.currentLanguageNameField).join(", "),b.studentGroups=b.subjectStudyPeriod.studentGroups.join(", "),b.getFileUrl=f.getUrl;var l=d.endpoint("/studyMaterial/connect"),m=i.valuemapper({typeCode:"OPPEMATERJAL"});k(),b.deleteConnection=function(a,b){g.confirmDialog({prompt:b>1?"studyMaterial.deleteconfirm":"studyMaterial.deletelastconfirm"},function(){var b=new l(a);b.$delete().then(function(){h.info("main.messages.delete.success"),k()})["catch"](angular.noop)})},b.hAutocomplete=[],b.addExisting=function(){if(!b.existingMaterial)return void h.error("main.messages.form-has-errors");var a=new l;a.studyMaterial=b.existingMaterial.id,a.subjectStudyPeriod=b.subjectStudyPeriod.id,a.$save().then(function(){b.hAutocomplete.forEach(function(a){a.clear()}),k()})}}]).controller("StudyMaterialJournalController",["$scope","$route","QueryUtils","ArrayUtils","oisFileService","dialogService","message","Classifier","$q",function(a,b,c,d,e,f,g,h,i){function j(){a.materials=c.endpoint("/studyMaterial/journal/"+a.journal.id+"/materials").query(),a.materials.$promise.then(function(a){i.all(l.promises).then(function(){l.objectmapper(a)})})}a.auth=b.current.locals.auth,a.journal=b.current.locals.journal,a.teachers=a.journal.teachers.map(a.currentLanguageNameField).join(", "),a.studentGroups=a.journal.studentGroups.join(", "),a.getFileUrl=e.getUrl;var k=c.endpoint("/studyMaterial/connect"),l=h.valuemapper({typeCode:"OPPEMATERJAL"});j(),a.deleteConnection=function(a,b){f.confirmDialog({prompt:b>1?"studyMaterial.deleteconfirm":"studyMaterial.deletelastconfirm"},function(){var b=new k(a);b.$delete().then(function(){g.info("main.messages.delete.success"),j()})["catch"](angular.noop)})},a.hAutocomplete=[],a.addExisting=function(){if(!a.existingMaterial)return void g.error("main.messages.form-has-errors");var b=new k;b.studyMaterial=a.existingMaterial.id,b.journal=a.journal.id,b.$save().then(function(){a.hAutocomplete.forEach(function(a){a.clear()}),j()})}}]).controller("StudyMaterialSubjectStudyPeriodPublicController",["$scope","$route","QueryUtils","oisFileService","dialogService","message","Classifier","$q",function(a,b,c,d,e,f,g,h){function i(){a.materials=c.endpoint("/public/studyMaterial/subjectStudyPeriod/"+a.subjectStudyPeriod.id+"/materials").query(),a.materials.$promise.then(function(a){h.all(j.promises).then(function(){j.objectmapper(a)})})}a.subjectStudyPeriod=b.current.locals.subjectStudyPeriod,a.teachers=a.subjectStudyPeriod.teachers.map(a.currentLanguageNameField).join(", "),a.studentGroups=a.subjectStudyPeriod.studentGroups.join(", "),a.getFileUrl=d.getUrl;var j=g.valuemapper({typeCode:"OPPEMATERJAL"});i()}]).controller("StudyMaterialJournalPublicController",["$scope","$route","QueryUtils","oisFileService","dialogService","message","Classifier","$q",function(a,b,c,d,e,f,g,h){function i(){a.materials=c.endpoint("/public/studyMaterial/journal/"+a.journal.id+"/materials").query(),a.materials.$promise.then(function(a){h.all(j.promises).then(function(){j.objectmapper(a)})})}a.journal=b.current.locals.journal,a.teachers=a.journal.teachers.map(a.currentLanguageNameField).join(", "),a.studentGroups=a.journal.studentGroups.join(", "),a.getFileUrl=d.getUrl;var j=g.valuemapper({typeCode:"OPPEMATERJAL"});i()}])}(),angular.module("hitsaOis").controller("StudyMaterialHigherListController",["$scope","$route","$timeout","QueryUtils","message","USER_ROLES","AuthService","DataUtils",function(a,b,c,d,e,f,g,h){a.canEdit=g.isAuthorized(f.ROLE_OIGUS_M_TEEMAOIGUS_OPPEMATERJAL),a.auth=b.current.locals.auth,d.createQueryForm(a,"/studyMaterial/subjectStudyPeriods",{order:"subject_name_et"});var i=a.loadData;a.loadData=function(){a.searchForm.$setSubmitted(),a.searchForm.$valid?i():e.error("main.messages.form-has-errors")},a.directiveControllers=[];var j=a.clearCriteria;a.clearCriteria=function(){j(),a.directiveControllers.forEach(function(a){a.clear()})},a.studyPeriods=d.endpoint("/autocomplete/studyPeriodsWithYear").query(),a.studyPeriods.$promise.then(function(){if(a.studyPeriods.forEach(function(b){b[a.currentLanguageNameField()]=a.currentLanguageNameField(b.studyYear)+" "+a.currentLanguageNameField(b)}),a.studyPeriods.length>0&&!a.criteria.studyPeriod){var b=h.getCurrentStudyYearOrPeriod(a.studyPeriods);a.criteria.studyPeriod=b?b.id:void 0}c(a.loadData)})}]).controller("StudyMaterialVocationalListController",["$scope","$route","$timeout","QueryUtils","message","USER_ROLES","AuthService","DataUtils",function(a,b,c,d,e,f,g,h){a.canEdit=g.isAuthorized(f.ROLE_OIGUS_M_TEEMAOIGUS_OPPEMATERJAL),a.auth=b.current.locals.auth,d.createQueryForm(a,"/studyMaterial/journals",{order:"journal_name"});var i=a.loadData;a.loadData=function(){a.searchForm.$setSubmitted(),a.searchForm.$valid?i():e.error("main.messages.form-has-errors")},a.directiveControllers=[];var j=a.clearCriteria;a.clearCriteria=function(){j(),a.directiveControllers.forEach(function(a){a.clear()})},a.studyYears=d.endpoint("/autocomplete/studyYears").query(),a.studyYears.$promise.then(function(){if(a.studyYears.length>0&&!a.criteria.studyYear){var b=h.getCurrentStudyYearOrPeriod(a.studyYears);a.criteria.studyYear=b?b.id:void 0}c(a.loadData)}),a.$watch("criteria.studyYear",function(){a.criteria.studyYear&&a.criteria.journalObject&&(a.criteria.journalObject=a.criteria.journalObject.studyYear===a.criteria.studyYear?a.criteria.journalObject:null)}),a.$watch("criteria.journalObject",function(){a.criteria.journal=a.criteria.journalObject?a.criteria.journalObject.id:null})}]),function(){angular.module("hitsaOis").controller("StudyMaterialHigherEditController",["$scope","$route","QueryUtils","oisFileService","dialogService","message",function(a,b,c,d,e,f){a.auth=b.current.locals.auth,a.subjectStudyPeriod=b.current.locals.subjectStudyPeriod,a.backPath="/#/studyMaterial/higher/"+a.subjectStudyPeriod.id+"/edit";var g=b.current.params.materialId,h=c.endpoint("/studyMaterial");g?(a.material=h.get({id:g}),a.material.$promise.then(function(b){a.teacher=b.teacher})):a.material=new h({isVisibleToStudents:!1,isPublic:!1}),a.$watch("teacher",function(b){a.material.teacher=b?b.id:null}),a.$watch("material.isPublic",function(b){b===!0&&(a.material.isVisibleToStudents=!0)}),a.typeCodeChanged=function(b){a.material.url="OPPEMATERJAL_L"===b?"http://":null},a["delete"]=function(){e.confirmDialog({prompt:"apel.deleteConfirm"},function(){a.material.$delete().then(function(){f.info("main.messages.delete.success"),a.back(a.backPath)})["catch"](angular.noop)})},a.save=function(){function b(){a.material.id?a.material.$update().then(c)["catch"](angular.noop):a.material.$save().then(c)["catch"](angular.noop)}function c(){f.info(g?"main.messages.update.success":"main.messages.create.success"),a.back(a.backPath)}if(a.material.subjectStudyPeriod=a.subjectStudyPeriod.id,a.material.isVocational=!1,a.studyMaterialForm.$setSubmitted(),!a.studyMaterialForm.$valid)return void f.error("main.messages.form-has-errors");if("OPPEMATERJAL_F"!==a.material.typeCode||a.material.id)b();else{if(1!==a.files.length)return void f.error("main.messages.form-has-errors");d.getFromLfFile(a.files[0],function(c){a.material.oisFile=c,b()})}}}]).controller("StudyMaterialVocationalEditController",["$scope","$route","QueryUtils","oisFileService","dialogService","message",function(a,b,c,d,e,f){a.auth=b.current.locals.auth,a.journal=b.current.locals.journal,a.backPath="/#/studyMaterial/vocational/"+a.journal.id+"/edit";var g=b.current.params.materialId,h=c.endpoint("/studyMaterial");g?(a.material=h.get({id:g}),a.material.$promise.then(function(b){a.teacher=b.teacher})):a.material=new h({isVisibleToStudents:!1,isPublic:!1}),a.$watch("teacher",function(b){a.material.teacher=b?b.id:null}),a.$watch("material.isPublic",function(b){b===!0&&(a.material.isVisibleToStudents=!0)}),a.typeCodeChanged=function(b){a.material.url="OPPEMATERJAL_L"===b?"http://":null},a["delete"]=function(){e.confirmDialog({prompt:"apel.deleteConfirm"},function(){a.material.$delete().then(function(){f.info("main.messages.delete.success"),a.back(a.backPath)})["catch"](angular.noop)})},a.save=function(){function b(){a.material.id?a.material.$update().then(c)["catch"](angular.noop):a.material.$save().then(c)["catch"](angular.noop)}function c(){f.info(g?"main.messages.update.success":"main.messages.create.success"),a.back(a.backPath)}if(a.material.journal=a.journal.id,a.material.isVocational=!0,a.studyMaterialForm.$setSubmitted(),!a.studyMaterialForm.$valid)return void f.error("main.messages.form-has-errors");if("OPPEMATERJAL_F"!==a.material.typeCode||a.material.id)b();else{if(1!==a.files.length)return void f.error("main.messages.form-has-errors");d.getFromLfFile(a.files[0],function(c){a.material.oisFile=c,b()})}}}])}(),angular.module("hitsaOis").config(["$routeProvider","USER_ROLES",function(a,b){a.when("/studyMaterial/higher",{templateUrl:"studyMaterial/study.material.higher.list.html",controller:"StudyMaterialHigherListController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_OPPEMATERJAL]}}).when("/studyMaterial/vocational",{templateUrl:"studyMaterial/study.material.vocational.list.html",controller:"StudyMaterialVocationalListController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_OPPEMATERJAL]}}).when("/studyMaterial/higher/:subjectStudyPeriodId/edit",{templateUrl:"studyMaterial/study.material.subjectStudyPeriod.edit.html",controller:"StudyMaterialSubjectStudyPeriodController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],subjectStudyPeriod:["QueryUtils","$route",function(a,b){return a.endpoint("/studyMaterial/subjectStudyPeriod/"+b.current.params.subjectStudyPeriodId).get().$promise}]},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_OPPEMATERJAL]}}).when("/studyMaterial/vocational/:journalId/edit",{templateUrl:"studyMaterial/study.material.journal.edit.html",controller:"StudyMaterialJournalController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],journal:["QueryUtils","$route",function(a,b){return a.endpoint("/studyMaterial/journal/"+b.current.params.journalId).get().$promise}]},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_OPPEMATERJAL]}}).when("/studyMaterial/higher/:subjectStudyPeriodId/new",{templateUrl:"studyMaterial/study.material.higher.edit.html",controller:"StudyMaterialHigherEditController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],subjectStudyPeriod:["QueryUtils","$route",function(a,b){return a.endpoint("/studyMaterial/subjectStudyPeriod/"+b.current.params.subjectStudyPeriodId).get().$promise}]},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_OPPEMATERJAL]}}).when("/studyMaterial/vocational/:journalId/new",{templateUrl:"studyMaterial/study.material.vocational.edit.html",controller:"StudyMaterialVocationalEditController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],journal:["QueryUtils","$route",function(a,b){return a.endpoint("/studyMaterial/journal/"+b.current.params.journalId).get().$promise}]},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_OPPEMATERJAL]}}).when("/studyMaterial/higher/:subjectStudyPeriodId/edit/:materialId",{templateUrl:"studyMaterial/study.material.higher.edit.html",controller:"StudyMaterialHigherEditController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],subjectStudyPeriod:["QueryUtils","$route",function(a,b){return a.endpoint("/studyMaterial/subjectStudyPeriod/"+b.current.params.subjectStudyPeriodId).get().$promise}]},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_OPPEMATERJAL]}}).when("/studyMaterial/vocational/:journalId/edit/:materialId",{templateUrl:"studyMaterial/study.material.vocational.edit.html",controller:"StudyMaterialVocationalEditController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],journal:["QueryUtils","$route",function(a,b){return a.endpoint("/studyMaterial/journal/"+b.current.params.journalId).get().$promise}]},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_OPPEMATERJAL]}}).when("/studyMaterial/higher/:subjectStudyPeriodId/view",{templateUrl:"studyMaterial/study.material.subjectStudyPeriod.view.html",controller:"StudyMaterialSubjectStudyPeriodController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],subjectStudyPeriod:["QueryUtils","$route",function(a,b){return a.endpoint("/studyMaterial/subjectStudyPeriod/"+b.current.params.subjectStudyPeriodId).get().$promise}]}}).when("/studyMaterial/vocational/:journalId/view",{templateUrl:"studyMaterial/study.material.journal.view.html",controller:"StudyMaterialJournalController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],journal:["QueryUtils","$route",function(a,b){return a.endpoint("/studyMaterial/journal/"+b.current.params.journalId).get().$promise}]}}).when("/studyMaterial/:schoolId/higher/:subjectStudyPeriodId/view",{templateUrl:"studyMaterial/study.material.subjectStudyPeriod.view.html",controller:"StudyMaterialSubjectStudyPeriodPublicController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],subjectStudyPeriod:["QueryUtils","$route",function(a,b){return a.endpoint("/public/studyMaterial/subjectStudyPeriod/"+b.current.params.subjectStudyPeriodId).get().$promise}]}}).when("/studyMaterial/:schoolId/vocational/:journalId/view",{templateUrl:"studyMaterial/study.material.journal.view.html",controller:"StudyMaterialJournalPublicController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],journal:["QueryUtils","$route",function(a,b){return a.endpoint("/public/studyMaterial/journal/"+b.current.params.journalId).get().$promise}]}})}]),angular.module("hitsaOis").controller("studyYearScheduleController",["$scope","$route","$timeout","QueryUtils","ArrayUtils","message","DataUtils","$mdDialog","$window","dialogService","USER_ROLES","AuthService","config","$httpParamSerializer",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){function o(){a.studentGroups=d.endpoint("/studyYearSchedule/studentGroups").query({showMine:a.criteria.showMine}),a.criteria.showMine&&(d.loadingWheel(a,!0),a.studentGroups.$promise.then(function(b){angular.isArray(b)&&b.length>0&&(a.criteria.schoolDepartments=b[0].schoolDepartments),d.loadingWheel(a,!1)})),a.criteria.studentGroups=[]}function p(){a.criteria.studyYear=g.getCurrentStudyYearOrPeriod(a.studyYears),a.criteria.studyYear&&(a.criteria.studyYear.studyPeriods=g.sortStudyYearsOrPeriods(a.criteria.studyYear.studyPeriods)),a.yearSelectionTrigger()}function q(){a.record=d.endpoint("/studyYearSchedule").save(a.criteria),d.loadingWheel(a,!0),a.record.$promise.then(function(b){a.studyYearSchedules=b.studyYearSchedules,d.loadingWheel(a,!1)})}function r(){function b(b,c){var d=c.studyPeriodId===a.criteria.studyYear.studyPeriods[i].id?1:0;return b+d}for(var c=[],d=1,e=new Date(a.criteria.studyYear.startDate),f=a.criteria.studyYear.endDate;f>e;){var g={};g.start=e,e=new Date(e.getFullYear(),e.getMonth(),e.getDate()+(7-e.getDay())),g.end=e,g.weekNr=d++;var h=s(g);g.studyPeriodId=h?h.id:null,c.push(g),e=new Date(e.getFullYear(),e.getMonth(),e.getDate()+1)}a.weeks=c;for(var i=0;i<a.criteria.studyYear.studyPeriods.length;i++){var j=a.weeks.reduce(b,0);a.criteria.studyYear.studyPeriods[i].weeks=j}}function s(b){return g.getStudyYearOrPeriodAt(b.start,a.criteria.studyYear.studyPeriods)}function t(b){if(!b.studyYearScheduleLegend)return 1;for(var c=0,d=b.studyYearScheduleLegend;b.studyYearScheduleLegend===d;)c++,b=a.getSchedule(b.studentGroup,b.weekNr+1);return c}function u(a,b){return a.studyYearScheduleLegend===b.studyYearScheduleLegend&&a.studentGroup===b.studentGroup&&a.weekNr===b.weekNr&&a.addInfo===b.addInfo}a.auth=b.current.locals.auth,a.canEdit=l.isAuthorized(k.ROLE_OIGUS_M_TEEMAOIGUS_OPPETOOGRAAFIK),a.colorOptions={disabled:!0},a.useMyFilter=a.auth.isStudent()||a.auth.isParent(),a.criteria={schoolDepartments:[],studyYear:null,studyPeriods:[],studentGroups:[]},a.useMyFilter&&(a.criteria.showMine=!0),a.formState={xlsUrl:"studyYearSchedule/studyYearSchedule.xlsx",pdfUrl:"studyYearSchedule/studyYearSchedule.pdf"},a.weeks=[],a.studyYearSchedules=[],d.loadingWheel(a,!0),d.endpoint("/autocomplete/schooldepartments").query().$promise.then(function(b){a.schoolDepartments=b,e.isEmpty(a.criteria.schoolDepartments)&&(a.criteria.schoolDepartments=a.schoolDepartments.filter(function(a){
return a.valid}).map(function(a){return a.id}),d.loadingWheel(a,!1))}),a.legends=d.endpoint("/school/studyYearScheduleLegends").search(),d.loadingWheel(a,!0),a.legends.$promise.then(function(b){a.legends=b.legends,d.loadingWheel(a,!1)}),o(),a.studyYears=d.endpoint("/studyYearSchedule/studyYears").query(p),a.schoolDepartmentsChanged=function(){e.isEmpty(a.studentGroups)||(a.criteria.studentGroups=a.studentGroups.filter(function(b){return e.intersect(b.schoolDepartments,a.criteria.schoolDepartments)}).map(function(a){return a.id}),q())},a.showMineChanged=function(){o(),q()},a.exportUrl=function(b){var c={studyYearId:a.criteria.studyYear?a.criteria.studyYear.id:null,schoolDepartments:a.criteria.schoolDepartments,showMine:a.criteria.showMine};return m.apiUrl+"/"+b+"?"+n(c)},a.filterSchoolDepartments=function(b){return!e.isEmpty(a.criteria.schoolDepartments)&&e.includes(a.criteria.schoolDepartments,b.id)},a.filterStudentGroups=function(b){return function(c){return e.includes(c.schoolDepartments,b.id)&&a.isValidGroup(c)}},a.getLegendById=function(b){if(angular.isArray(a.legends)){var c=a.legends.find(function(a){return a.id===b});return c}},a.isValidGroup=function(b){return null===a.criteria.studyYear?!0:g.isValidObject(a.criteria.studyYear.startDate,a.criteria.studyYear.endDate,b.validFrom,b.validThru)},a.$watch(function(){return document.getElementsByClassName("lessonplan")[0].offsetHeight},function(){var a=document.getElementsByClassName("lessonplan")[0].offsetHeight+17,b=i.innerHeight-340;b>a?angular.element(document.getElementsByClassName("container")[0]).css("height",a+"px"):angular.element(document.getElementsByClassName("container")[0]).css("height",b+"px")}),angular.element(i).bind("resize",function(){var a=document.getElementsByClassName("lessonplan")[0].offsetHeight+17,b=i.innerHeight-340;b>a?angular.element(document.getElementsByClassName("container")[0]).css("height",a+"px"):angular.element(document.getElementsByClassName("container")[0]).css("height",b+"px")}),a.getWeeksPeriod=function(b){return a.weeks.find(function(a){return a.weekNr===b}).studyPeriodId},a.openAddScheduleDialog=function(b,c,d){if(c.studyPeriodId&&a.canEdit){var f=function(e){e.hasValue=d.studyYearScheduleLegend?!0:!1,e.studentGroup=b,e.week=c,e.legends=a.legends,e.data={weeks:t(d),legend:d.studyYearScheduleLegend,addInfo:d.addInfo},e.translationData={weeks:a.weeks.length-c.weekNr+1}};j.showDialog("studyYearSchedule/study.year.schedule.add.dialog.html",f,function(d){if(d.data.legend)for(var f=0;f<d.data.weeks&&!(c.weekNr+f>a.weeks.length);f++){var g=a.getSchedule(b.id,c.weekNr+f),h={studyYearScheduleLegend:d.data.legend,weekNr:c.weekNr+f,studentGroup:b.id,studyPeriod:0===f?c.studyPeriodId:a.getWeeksPeriod(c.weekNr+f),addInfo:d.data.addInfo};u(g,h)||(e.includes(a.studyYearSchedules,g)&&e.remove(a.studyYearSchedules,g),a.studyYearSchedules.push(h))}else for(var i=0;i<d.data.weeks;i++){var j=a.getSchedule(b.id,c.weekNr+i);e.includes(a.studyYearSchedules,j)&&e.remove(a.studyYearSchedules,j)}})}},a.getSchedule=function(b,c){var d=a.studyYearSchedules.find(function(a){return a.weekNr===c&&a.studentGroup===b});return d||(d={studyYearScheduleLegend:null,studentGroup:b,weekNr:c,addInfo:""}),d},a.save=function(){a.record.studyYearSchedules=a.studyYearSchedules,a.record.$put().then(function(b){f.updateSuccess(),a.studyYearSchedules=b.studyYearSchedules})},a.refreshHeight=function(){var a=21*document.getElementsByClassName("lessonplan")[0].rows.length,b=i.innerHeight-340;b>a?angular.element(document.getElementsByClassName("container")[0]).css("height",a+"px"):angular.element(document.getElementsByClassName("container")[0]).css("height",b+"px")},a.yearSelectionTrigger=function(){a.criteria.studyYear?a.criteria.studyYear!==a.lastPickedStudyYear&&(a.isPastStudyYear=g.isPastStudyYearOrPeriod(a.criteria.studyYear),a.criteria.studyYear.studyPeriods=g.sortStudyYearsOrPeriods(a.criteria.studyYear.studyPeriods),a.criteria.studyPeriods=a.criteria.studyYear.studyPeriods.map(function(a){return a.id}),q(),r(),a.lastPickedStudyYear=a.criteria.studyYear):a.isPastStudyYear=!0}}]),angular.module("hitsaOis").config(["$routeProvider","USER_ROLES",function(a,b){a.when("/studyYearScheduleLegend",{templateUrl:"studyYearSchedule/study.year.schedule.legend.html",controller:"studyYearScheduleLegendController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:function(a,c){return"ROLL_A"===a.roleCode&&a.vocational&&c.indexOf(b.ROLE_OIGUS_V_TEEMAOIGUS_OPPETOOGRAAFIK)}}}).when("/studyYearSchedule",{templateUrl:"studyYearSchedule/study.year.schedule.html",controller:"studyYearScheduleController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:function(a){return a.vocational}}})}]),angular.module("hitsaOis").controller("studyYearScheduleLegendController",["$scope","QueryUtils","ArrayUtils","message","dialogService","USER_ROLES","AuthService",function(a,b,c,d,e,f,g){function h(a){a.colorPicker=function(b){return arguments.length?a.color="#"+b:a.color}}function i(){return a.legends.filter(function(a){return!a.code}).length>0}function j(){return a.legends.filter(function(a){return a.code&&a.code.length>2}).length>0}function k(){return a.legends.filter(function(a){return!a.nameEt}).length>0}function l(){return a.legends.filter(function(a){return a.nameEt&&a.nameEt.length>50||a.nameEn&&a.nameEn.length>50}).length>0}a.removedInUseLegend=!1,a.canEdit=g.isAuthorized(f.ROLE_OIGUS_M_TEEMAOIGUS_OPPETOOGRAAFIK),a.colorOptions={disabled:!a.canEdit};var m=[{code:"E",nameEt:"Eksam",color:"#FF0000"},{code:"Pr",nameEt:"Praktika ettevõtes",color:"#790FFC"},{code:"P",nameEt:"Praktika koolis",color:"#1FF47C"},{code:"V",nameEt:"Vaheaeg",color:"#E6E6E6"},{code:"X",nameEt:"ei osale õppetöös",color:"#8C8C8C"}];m.forEach(h),a.newLegend={},a.record=b.endpoint("/school/studyYearScheduleLegends").search(function(b){b&&b.legends&&0!==b.legends.length?(a.legends=b.legends,a.legends.forEach(h),a.defaultLegends=!1):(a.legends=m,a.defaultLegends=!0)}),a.remove=function(b){b.inUse&&(a.removedInUseLegend=!0),c.remove(a.legends,b),a.legends.forEach(function(a){a.edited=!1})},a.save=function(){a.formSubmitted=!0,a.legends.forEach(function(a){a.edited=!1}),a.record.legends=a.legends,a.record.$put().then(function(b){d.updateSuccess(),a.legends=b.legends,a.legends.forEach(h),angular.isArray(b.legends)&&b.legends.length>0?a.defaultLegends=!1:a.defaultLegends=!0,a.removedInUseLegend=!1})},a.checkErrorsAndSave=function(){return i()?(d.error("studyYearScheduleLegend.error.codeRequired"),!0):j()?(d.error("studyYearScheduleLegend.error.codeLength"),!0):k()?(d.error("studyYearScheduleLegend.error.nameEtRequired"),!0):l()?(d.error("studyYearScheduleLegend.error.nameLength"),!0):void(a.removedInUseLegend?e.confirmDialog({prompt:"studyYearScheduleLegend.error.inUseLegendRemove",accept:"main.yes",cancel:"main.no"},function(){a.save()}):a.save())},a.codeIsValid=function(a){return a.code&&a.code.length<=2},a.nameEtIsValid=function(a){return a.nameEt&&a.nameEt.length<=50},a.nameEnIsValid=function(a){return!a.nameEn||a.nameEn.length<=50},a.changeEditable=function(b){a.canEdit&&(a.legends.forEach(function(a){a.edited=!1}),b.edited=!0)},a.addRow=function(){var b={color:"#FFFFFF"};a.legends.push(b),h(b),a.legends.forEach(function(a){a.edited=!1}),b.edited=!0}}]),angular.module("hitsaOis").controller("SubjectEditController",["$scope","$rootScope","$route","$location","$translate","$q","dialogService","message","QueryUtils",function(a,b,c,d,e,f,g,h,i){function j(a){h.error(a)}function k(){a.subjectForm.$setSubmitted();var b=[],c=u(b,a.subject.mandatoryPrerequisiteSubjects)||u(b,a.subject.recommendedPrerequisiteSubjects)||u(b,a.subject.substituteSubjects);return a.subjectForm.$valid&&!c?!0:(h.error("main.messages.form-has-errors"),!1)}function l(a,b){for(var c=0;c<a.length;c++)if(angular.isObject(a[c])&&a[c].id===b.id)return c;return-1}function m(a,b){b&&(angular.isArray(a)||(a=[]),-1===l(a,b)&&a.push(b))}function n(a,b){if(angular.isArray(a)){var c=l(a,b);-1!==c&&a.splice(c,1)}}function o(b,c){k()&&g.confirmDialog({prompt:c.prompt},function(){new b(a.subject).$update().then(function(b){a.subject=new r(b),h.info(c.success),a.subjectForm.$setPristine()})})}var p=c.current.params.id,q=c.current.params.backUrl;a.formState={backUrl:q?"#/"+q:"#/subject"},a.SUBJECT_TYPE=Object.freeze({MANDATORY_PREPEQUISITE:0,RECOMMENDED_PREREQUISITE:1,SUBSTITUTE:2}),a.subjectCodeUniqueQuery={id:p,url:"/subject/unique/code"},i.endpoint("/subject/initEditFormData").search(function(b){angular.extend(a,b.toJSON())});var r=i.endpoint("/subject"),s=i.endpoint("/subject/saveAndConfirm"),t=i.endpoint("/subject/saveAndUnconfirm");p?a.subject=r.get({id:p},function(){},function(){a.back("#/")}):a.subject=new r({status:"AINESTAATUS_S",mandatoryPrerequisiteSubjects:[],recommendedPrerequisiteSubjects:[],substituteSubjects:[]});var u=function(a,c){for(var d=!1,f=0;f<c.length;f++)a.indexOf(c[f].id)>-1&&(e("subject.alreadyConnected",{subject:b.currentLanguageNameField(c[f])}).then(j),d=!0),a.push(c[f].id);return d};a.addSubject=function(b){switch(b){case a.SUBJECT_TYPE.MANDATORY_PREPEQUISITE:m(a.subject.mandatoryPrerequisiteSubjects,a.mandatoryPrerequisiteSubject),a.mandatoryPrerequisiteSubject=void 0;break;case a.SUBJECT_TYPE.RECOMMENDED_PREREQUISITE:m(a.subject.recommendedPrerequisiteSubjects,a.recommendedPrerequisiteSubject),a.recommendedPrerequisiteSubject=void 0;break;case a.SUBJECT_TYPE.SUBSTITUTE:m(a.subject.substituteSubjects,a.substituteSubject),a.substituteSubject=void 0}},a.deleteSubject=function(b,c){if(c)switch(b){case a.SUBJECT_TYPE.MANDATORY_PREPEQUISITE:n(a.subject.mandatoryPrerequisiteSubjects,c);break;case a.SUBJECT_TYPE.RECOMMENDED_PREREQUISITE:n(a.subject.recommendedPrerequisiteSubjects,c);break;case a.SUBJECT_TYPE.SUBSTITUTE:n(a.subject.substituteSubjects,c)}},a.update=function(){k()&&(a.subject.id?a.subject.$update().then(function(b){a.subject=new r(b),h.updateSuccess(),a.subjectForm.$setPristine()}):a.subject.$save().then(function(a){d.url("/subject/"+a.id+"/edit?_noback"),h.info("main.messages.create.success")}))},a.saveAndConfirm=function(){var a={prompt:"subject.prompt.saveAndConfirm",success:"subject.message.savedAndConfirmed"};o(s,a)},a.saveAndUnconfirm=function(){var a={prompt:"subject.prompt.saveAndUnconfirm",success:"subject.message.savedAndUnconfirmed"};o(t,a)},a["delete"]=function(){g.confirmDialog({prompt:"subject.deleteconfirm"},function(){a.subject.$delete().then(function(){h.info("main.messages.delete.success"),d.url("/subject?_noback")})})}}]).controller("SubjectViewController",["$scope","$route","config","QueryUtils",function(a,b,c,d){a.isPublic=b.current.locals.params&&b.current.locals.params.isPublic;var e=b.current.params.id,f=b.current.params.backUrl;a.auth=b.current.locals.auth,a.formState={backUrl:f?"#/"+f:a.isPublic?"#/subject/public":"#/subject"},a.subject=d.endpoint(a.isPublic?"/public/subject/view":"/subject").get({id:e},function(){},function(){a.back("#/")}),a.publicUrl=c.apiUrl+"/public/subject/"+e+"?format=json"}]).controller("SubjectListController",["$q","$scope","$route","Classifier","QueryUtils",function(a,b,c,d,e){b.isPublic=c.current.locals.params&&c.current.locals.params.isPublic;var f=d.valuemapper({status:"AINESTAATUS",assessment:"HINDAMISVIIS",languages:"OPPEKEEL"});e.createQueryForm(b,b.isPublic?"/public/subjectsearch":"/subject",{order:"en"===b.currentLanguage()?"nameEn":"nameEt"},f.objectmapper),a.all(f.promises).then(b.loadData),b.subjectLanguages=function(a){return a.map(b.currentLanguageNameField).join(", ")},b.formState={},b.isPublic?b.$watch("criteria.schoolId",function(a){a?(b.curricula=e.endpoint("/public/curriculumversions").query({schoolId:a}),b.departments=e.endpoint("/public/schooldepartments").query({schoolId:a})):(b.curricula=[],b.departments=[])}):(e.endpoint("/subject/initSearchFormData").search(function(a){angular.extend(b,a.toJSON())}),e.endpoint("/subject/getPermissions").search(function(a){b.formState.canCreate=a.canCreate,b.formState.canViewAll=a.canViewAll}))}]),angular.module("hitsaOis").config(["$routeProvider","USER_ROLES",function(a,b){a.when("/subject",{templateUrl:"subject/subject.list.html",controller:"SubjectListController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:function(a,c){return a.higher&&-1!==c.indexOf(b.ROLE_OIGUS_V_TEEMAOIGUS_AINE)}}}).when("/subject/public",{templateUrl:"subject/subject.list.html",controller:"SubjectListController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],params:function(){return{isPublic:!0}}}}).when("/subject/new",{templateUrl:"subject/subject.edit.html",controller:"SubjectEditController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:function(a,c){return"ROLL_A"===a.roleCode&&a.higher&&-1!==c.indexOf(b.ROLE_OIGUS_M_TEEMAOIGUS_AINE)}}}).when("/subject/:id/edit",{templateUrl:"subject/subject.edit.html",controller:"SubjectEditController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:function(a,c){return"ROLL_A"===a.roleCode&&-1!==c.indexOf(b.ROLE_OIGUS_M_TEEMAOIGUS_AINE)}}}).when("/subject/:id",{templateUrl:"subject/subject.view.html",controller:"SubjectViewController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_AINE]}}).when("/subject/public/:id",{templateUrl:"subject/subject.view.html",controller:"SubjectViewController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],params:function(){return{isPublic:!0}}}})}]),angular.module("hitsaOis").controller("SubjectStudyPeriodSearchController",["$scope","QueryUtils","DataUtils","$route","ArrayUtils","Classifier","message",function(a,b,c,d,e,f,g){function h(){!a.criteria||e.isEmpty(a.studyPeriods)||a.criteria.studyPeriods||(a.criteria.studyPeriods=c.getCurrentStudyYearOrPeriod(a.studyPeriods).id)}b.createQueryForm(a,"/subjectStudyPeriods",{order:"s."+a.currentLanguageNameField()}),a.auth=d.current.locals.auth,f.queryForDropdown({mainClassCode:"AINEPROGRAMM_STAATUS"},function(b){a.statusOptions=f.toMap(b)}),a.load=function(){return a.searchForm.$valid?void a.loadData():(g.error("main.messages.form-has-errors"),!1)},b.endpoint("/autocomplete/studyPeriodsWithYear").query().$promise.then(function(b){a.studyPeriods=b,a.studyPeriods.forEach(function(b){b[a.currentLanguageNameField()]=a.currentLanguageNameField(b.studyYear)+" "+a.currentLanguageNameField(b)}),h(),a.loadData()}),a.$watch("criteria.studentObject",function(){a.criteria&&(a.criteria.student=a.criteria.studentObject?a.criteria.studentObject.id:null)}),a.showTeachers=function(a,b){var c="";if(a.teachers){c=a.teachers.join("; ");var d=30;!b&&c.length>d&&(c=c.substring(0,d)+"...")}return c},a.testStatus={code:"AINEPROGRAMM_STAATUS_L"}}]).controller("SubjectStudyPeriodEditController",["$scope","QueryUtils","ArrayUtils","$route","dialogService","message","$q","$rootScope","DeclarationType",function(a,b,c,d,e,f,g,h,i){function j(b){return a.record.teachers.filter(function(a){return a.teacherId===b.id}).length>0}function k(){return i.DEKLARATSIOON_KOIK===a.record.declarationType||i.DEKLARATSIOON_LISA===a.record.declarationType}function l(){return a.subjectStudyPeriodEditForm.$setSubmitted(),a.subjectStudyPeriodEditForm.$valid?a.record.teachers&&0!==a.record.teachers.length?!0:(f.error("subjectStudyPeriod.error.teacherNotAdded"),!1):(f.error("main.messages.form-has-errors"),!1)}function m(a){var b={};return a.filter(function(a){return b.hasOwnProperty(a)?!1:b[a]=!0})}function n(){w&&a.record.studentGroups.push(w),a.record.studentGroups=m(a.record.studentGroups),1===a.record.teachers.length&&(a.record.teachers[0].isSignatory=!0)}function o(a){return-1!==a.indexOf("new")}function p(){w&&v?h.replaceLastUrl("#/subjectStudyPeriods/studentGroups/"+w+"/"+v+"/edit",o):y&&v?h.replaceLastUrl("#/subjectStudyPeriods/teachers/"+y+"/"+v+"/edit",o):x&&v&&!w&&!y&&h.replaceLastUrl("#/subjectStudyPeriods/subjects/"+x+"/"+v+"/edit",o)}function q(){f.updateSuccess(),p(),a.subjectStudyPeriodEditForm.$setPristine()}function r(){l()&&(n(),a.record.id?a.record.$update().then(function(){f.updateSuccess(),a.subjectStudyPeriodEditForm.$setPristine()}):a.record.$save().then(q))}var s="/subjectStudyPeriods",t=b.endpoint(s),u=d.current.params.id,v=d.current.params.studyPeriodId?parseInt(d.current.params.studyPeriodId,10):null,w=d.current.params.studentGroupId?parseInt(d.current.params.studentGroupId,10):null,x=d.current.params.subjectId?parseInt(d.current.params.subjectId,10):null,y=d.current.params.teacherId?parseInt(d.current.params.teacherId,10):null;if(a.hasObligatoryStudentGroup=null!==w,a.obligatoryTeacher=y,b.endpoint("/subjectStudyPeriods/studentGroups/list").query(function(b){a.studentGroups=b.filter(function(a){return w?a.id!==w:!0}).map(function(a){var b=a;return b.nameEt=a.code,b.nameEn=a.code,b})}),h.removeLastUrlFromHistory(function(a){return a&&-1!==a.indexOf("subjectStudyPeriod/"+u+"/view")}),w&&(a.studentGroup=b.endpoint("/studentgroups").get({id:w})),a.studyPeriods=b.endpoint("/autocomplete/studyPeriodsWithYear").query({},function(b){b.forEach(function(b){b[a.currentLanguageNameField()]=a.currentLanguageNameField(b.studyYear)+" "+a.currentLanguageNameField(b)})}),a.subjects=b.endpoint("/subjectStudyPeriods/subjects/list").query(),u)t.get({id:u}).$promise.then(function(d){a.record=d,w&&c.remove(a.record.studentGroups,w),a.record.groupProportion||(a.record.groupProportion="PAEVIK_GRUPI_JAOTUS_1"),a.disableSubject=!0,a.subject=b.endpoint("/subjectStudyPeriods/subject").get({id:d.subject},function(b){a.subjects.$promise.then(function(a){for(var c=0;c<a.length;c++)if(a[c].id===b.id)return;a.push(b)})})});else{var z={groupProportion:"PAEVIK_GRUPI_JAOTUS_1",studyPeriod:v,subject:x,teachers:[],studentGroups:[]};a.record=new t(z),a.disableSubject=null!==x,y&&b.endpoint("/subjectStudyPeriods/teacher").get({id:y}).$promise.then(function(b){a.record.teachers.push({teacherId:b.id,name:b.nameEt})})}a.addTeacher=function(b){b&&!j(b)?a.record.teachers.push({teacherId:b.id,name:b.nameEt,isSignatory:!1}):b&&j(b)&&f.error("subjectStudyPeriodTeacher.teacherAlreadyAdded"),a.teacher=void 0},a.querySearch=function(a){var c=b.endpoint("/subjectStudyPeriods/teachers/page"),d=g.defer();return c.search({name:a},function(a){d.resolve(a.content)}),d.promise},a.removeTeacher=function(b){c.remove(a.record.teachers,b)},a.save=function(){k()?e.confirmDialog({prompt:"subjectStudyPeriod.prompt.addedAutomaticallyToDeclarations"},r):r()},a["delete"]=function(){e.confirmDialog({prompt:"subjectStudyPeriodTeacher.deleteconfirm"},function(){a.record.$delete().then(function(){f.info("main.messages.delete.success"),h.back("#"+s)})})}}]).controller("SubjectStudyPeriodViewController",["$scope","QueryUtils","$route",function(a,b,c){var d=b.endpoint("/subjectStudyPeriods"),e=c.current.params.id;a.record=d.get({id:e}),a.studyPeriods=b.endpoint("/autocomplete/studyPeriodsWithYear").query({},function(b){b.forEach(function(b){b[a.currentLanguageNameField()]=a.currentLanguageNameField(b.studyYear)+" "+a.currentLanguageNameField(b)})}),b.endpoint("/subjectStudyPeriods/studentGroups/list").query(function(b){a.studentGroups=b.map(function(a){var b=a;return b.nameEt=a.code,b.nameEn=a.code,b})}),a.subjects=b.endpoint("/subjectStudyPeriods/subjects/list").query(),a.record.$promise.then(function(c){b.endpoint("/subjectStudyPeriods/subject").get({id:c.subject},function(b){a.subjects.$promise.then(function(a){for(var c=0;c<a.length;c++)if(a[c].id===b.id)return;a.push(b)})})})}]).constant("DeclarationType",{DEKLARATSIOON_EI:"DEKLARATSIOON_EI",DEKLARATSIOON_KOIK:"DEKLARATSIOON_KOIK",DEKLARATSIOON_LISA:"DEKLARATSIOON_LISA"}),angular.module("hitsaOis").factory("SspCapacities",[function(){var a=function(a){function b(){return a&&a.subjectStudyPeriodDtos?a.subjectStudyPeriodDtos:[]}function c(a,b){var c=b&&b.hours?b.hours:0;return a+=c}function d(a){for(var b=0,c=0;c<a.length;c++)b+=j.capacitiesSumBySsp(a[c]);return b}function e(a){return function(b){return b.capacityType===a}}function f(a,b){var c=g(a,b);return a=a.filter(function(a){return!a.capacityDiff}),c.forEach(function(b){a.push(b)}),a}function g(a,b){for(var c=[],d=0;d<a.length;d++)if(a[d].capacityDiff)for(var e=0;e<a[d].teachers.length;e++)c.push(a[d].teachers[e]);return c.filter(function(a){return a.teacherId===b})}function h(a,b){for(var d=0,f=0;f<b.length;f++)d+=b[f].capacities.filter(e(a)).reduce(c,0);return d}function i(b){if(!a||!a.subjectStudyPeriodDtos)return 0;var c=a.subjectStudyPeriodDtos;return b&&(c=f(c,b)),c}var j=this;this.addEmptyCapacities=function(b){for(var c=0;c<b.length;c++)for(var d=a.subjectStudyPeriodDtos,e=0;e<d.length;e++)this.getCapacity(d[e],b[c].code),this.addTeacherEmptyCapacities(d[e].teachers,b)},this.addTeacherEmptyCapacities=function(a,b){for(var c=0;c<b.length;c++)for(var d=0;d<a.length;d++)this.getCapacity(a[d],b[c].code)},this.getSubjectsCapacityByType=function(b,c){if(!a||!a.subjectStudyPeriodPlans)return 0;var d=a.subjectStudyPeriodPlans.find(function(a){return a.subject===b});if(!d)return 0;var e=d.capacities.find(function(a){return a.capacityType===c});return e&&e.hours?e.hours:0},this.getSubjectsTotalCapacity=function(b,c){if(!a||!a.subjectStudyPeriodPlans||!c)return 0;for(var d=0,e=0;e<c.length;e++)d+=j.getSubjectsCapacityByType(b,c[e].code);return d},this.capacitiesSumBySsp=function(a){return a.capacities.reduce(c,0)},this.capacityBySsp=function(a,b){return a.capacities.filter(e(b)).reduce(c,0)},this.capacitiesSumOverall=function(a){var b=i(a);return d(b)},this.getCapacitiesBySubject=function(a,c){var d=b().filter(function(b){return b.subject===a});return c&&(d=f(d,c)),d},this.capacitiesSumBySubjectAndType=function(b,c,d){if(!a||!a.subjectStudyPeriodDtos)return 0;var e=j.getCapacitiesBySubject(b,d);return h(c,e)},this.capacitiesSumByType=function(a,b){var c=i(b);return h(a,c)},this.capacitiesSumBySubject=function(b,c){if(!a||!a.subjectStudyPeriodDtos)return 0;var e=j.getCapacitiesBySubject(b,c);return d(e)},this.getCapacity=function(a,b){var c=a.capacities.find(function(a){return a.capacityType===b});return c||(c={capacityType:b},a.capacities.push(c)),c},this.filterEmptyCapacities=function(){for(var a=b(),c=0;c<a.length;c++)a[c].capacities=a[c].capacities.filter(function(a){return void 0!==a.hours&&null!==a.hours&&""!==a.hours})},this.subjectsLoadValid=function(a,b){for(var c,d,e=j.getCapacitiesBySubject(a),f=function(a){return function(b){return b.capacityType===a}},g=0;g<b.length;g++){d=j.getSubjectsCapacityByType(a,b[g].code);for(var h=0;h<e.length;h++){var i=e[h].capacities.find(f(b[g].code));if(c=i?i.hours:0,c>d)return!1}}return!0},this.teachersLoadOk=function(a){return a.teachers.reduce(function(a,b){return a+=b.scheduleLoad},0)>=j.capacitiesSumBySsp(a)},this.teacherLoadOk=function(a){return a.scheduleLoad>=j.capacitiesSumBySsp(a)},this.teacherPlannedLoad=function(a){return{scheduleLoad:a.scheduleLoad,unplannedLessons:a.scheduleLoad-a.plannedLessons>0?a.scheduleLoad-a.plannedLessons:0}}};return a}]),angular.module("hitsaOis").config(["$routeProvider","USER_ROLES",function(a,b){a.when("/subjectStudyPeriods",{templateUrl:"subjectStudyPeriod/subject.study.period.search.html",controller:"SubjectStudyPeriodSearchController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:function(a,c,d){return a.higher&&d.intersect(c,[b.ROLE_OIGUS_V_TEEMAOIGUS_AINEOPPETAJA,b.ROLE_OIGUS_V_TEEMAOIGUS_PAEVIK])}}}).when("/subjectStudyPeriod/:id/edit",{templateUrl:"subjectStudyPeriod/subject.study.period.edit.html",controller:"SubjectStudyPeriodEditController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_AINEOPPETAJA,b.ROLE_OIGUS_M_TEEMAOIGUS_PAEVIK]}}).when("/subjectStudyPeriod/:id/view",{templateUrl:"subjectStudyPeriod/subject.study.period.view.html",controller:"SubjectStudyPeriodViewController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_AINEOPPETAJA,b.ROLE_OIGUS_V_TEEMAOIGUS_PAEVIK]}}).when("/subjectStudyPeriod/new",{templateUrl:"subjectStudyPeriod/subject.study.period.edit.html",controller:"SubjectStudyPeriodEditController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:function(a,c,d){return a.higher&&d.intersect(c,[b.ROLE_OIGUS_M_TEEMAOIGUS_AINEOPPETAJA,b.ROLE_OIGUS_M_TEEMAOIGUS_PAEVIK])}}}).when("/subjectStudyPeriods/studentGroups",{templateUrl:"subjectStudyPeriod/studentGroup/subject.study.period.student.group.search.html",controller:"SubjectStudyPeriodStudentGroupSearchController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:function(a,c){return"ROLL_A"===a.roleCode&&a.higher&&-1!==c.indexOf(b.ROLE_OIGUS_V_TEEMAOIGUS_TUNNIJAOTUSPLAAN)}}}).when("/subjectStudyPeriods/studentGroups/new",{templateUrl:"subjectStudyPeriod/studentGroup/subject.study.period.student.group.edit.html",controller:"SubjectStudyPeriodStudentGroupEditController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:function(a,c){return a.higher&&-1!==c.indexOf(b.ROLE_OIGUS_M_TEEMAOIGUS_TUNNIJAOTUSPLAAN)}}}).when("/subjectStudyPeriods/studentGroups/:studentGroupId/:studyPeriodId/edit",{templateUrl:"subjectStudyPeriod/studentGroup/subject.study.period.student.group.edit.html",controller:"SubjectStudyPeriodStudentGroupEditController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_TUNNIJAOTUSPLAAN]}}).when("/subjectStudyPeriods/studentGroups/:studentGroupId/:studyPeriodId/view",{templateUrl:"subjectStudyPeriod/studentGroup/subject.study.period.student.group.view.html",controller:"SubjectStudyPeriodStudentGroupViewController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_TUNNIJAOTUSPLAAN]}}).when("/subjectStudyPeriods/teachers",{templateUrl:"subjectStudyPeriod/teacher/subject.study.period.teacher.search.html",controller:"SubjectStudyPeriodTeacherSearchController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:function(a,c){return"ROLL_A"===a.roleCode&&a.higher&&-1!==c.indexOf(b.ROLE_OIGUS_V_TEEMAOIGUS_TUNNIJAOTUSPLAAN)}}}).when("/subjectStudyPeriods/teachers/new",{templateUrl:"subjectStudyPeriod/teacher/subject.study.period.teacher.edit.html",controller:"SubjectStudyPeriodTeacherEditController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:function(a,c){return a.higher&&-1!==c.indexOf(b.ROLE_OIGUS_M_TEEMAOIGUS_TUNNIJAOTUSPLAAN)}}}).when("/subjectStudyPeriods/teachers/:teacherId/:studyPeriodId/edit",{templateUrl:"subjectStudyPeriod/teacher/subject.study.period.teacher.edit.html",controller:"SubjectStudyPeriodTeacherEditController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_TUNNIJAOTUSPLAAN]}}).when("/subjectStudyPeriods/teachers/:teacherId/:studyPeriodId/view",{templateUrl:"subjectStudyPeriod/teacher/subject.study.period.teacher.view.html",controller:"SubjectStudyPeriodTeacherViewController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_TUNNIJAOTUSPLAAN]}}).when("/subjectStudyPeriods/subjects",{templateUrl:"subjectStudyPeriod/subject/subject.study.period.subject.search.html",controller:"SubjectStudyPeriodSubjectSearchController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:function(a,c){return"ROLL_A"===a.roleCode&&a.higher&&-1!==c.indexOf(b.ROLE_OIGUS_V_TEEMAOIGUS_TUNNIJAOTUSPLAAN)}}}).when("/subjectStudyPeriods/subjects/new",{templateUrl:"subjectStudyPeriod/subject/subject.study.period.subject.edit.html",controller:"SubjectStudyPeriodSubjectEditController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:function(a,c){return a.higher&&-1!==c.indexOf(b.ROLE_OIGUS_M_TEEMAOIGUS_TUNNIJAOTUSPLAAN)}}}).when("/subjectStudyPeriods/subjects/:subjectId/:studyPeriodId/edit",{templateUrl:"subjectStudyPeriod/subject/subject.study.period.subject.edit.html",controller:"SubjectStudyPeriodSubjectEditController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_TUNNIJAOTUSPLAAN]}}).when("/subjectStudyPeriods/subjects/:subjectId/:studyPeriodId/view",{templateUrl:"subjectStudyPeriod/subject/subject.study.period.subject.view.html",controller:"SubjectStudyPeriodSubjectViewController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_TUNNIJAOTUSPLAAN]}})}]),angular.module("hitsaOis").controller("SubjectStudyPeriodStudentGroupEditController",["$scope","QueryUtils","ArrayUtils","Classifier","$route","message","dialogService","$rootScope","SspCapacities","DataUtils",function(a,b,c,d,e,f,g,h,i,j){function k(){a.record.studyPeriod||(a.record.studyPeriod=j.getCurrentStudyYearOrPeriod(a.studyPeriods).id,q=a.record.studyPeriod)}function l(){a.record.studyPeriod&&(a.studentGroups=b.endpoint("/subjectStudyPeriods/studentGroups/list/limited/"+a.record.studyPeriod).query())}function m(){a.curriculum=b.endpoint("/subjectStudyPeriods/studentGroups/curriculum/"+a.studentGroup.curriculum.id).get(n)}function n(){var b=a.curriculum.studyPeriod;a.curriculumStudyPeriod={years:Math.floor(b/12),months:b%12}}function o(){a.studentGroup=a.studentGroups.find(function(b){return b.id===a.record.studentGroup}),a.studentGroup&&(a.course=a.studentGroup.course.toString(),m())}function p(){a.record.studyPeriod=q,a.capacitiesUtil.filterEmptyCapacities(),a.record.$put().then(function(b){f.updateSuccess(),a.record=b,a.capacitiesUtil.addEmptyCapacities(a.capacityTypes),
a.subjectStudyPeriodStudentGroupEditForm.$setPristine()})}var q=e.current.params.studyPeriodId?parseInt(e.current.params.studyPeriodId,10):null,r=e.current.params.studentGroupId?parseInt(e.current.params.studentGroupId,10):null;a.isEditing=null===r&&null===q;var s=b.endpoint("/subjectStudyPeriods/studentGroups/container");a.capacityTypes=b.endpoint("/autocomplete/schoolCapacityTypes").query({isHigher:!0}),a.record={},q||(a.studyPeriods=b.endpoint("/autocomplete/studyPeriodsWithYear").query(k),a.studyPeriods.$promise.then(function(b){b.forEach(function(b){b[a.currentLanguageNameField()]=a.currentLanguageNameField(b.studyYear)+" "+a.currentLanguageNameField(b)})})),r&&(a.container={studyPeriod:q,studentGroup:r,subjectStudyPeriodDtos:[]},a.record=s.search(a.container),a.record.$promise.then(function(b){a.capacitiesUtil=new i(b),a.capacityTypes=b.capacityTypes,a.capacitiesUtil.addEmptyCapacities(a.capacityTypes)}),a.studentGroup=b.endpoint("/studentgroups/"+r).get(function(b){a.studentGroup.nameEt=b.code,a.course=a.studentGroup.course.toString(),m()}),a.formState={xlsUrl:"subjectStudyPeriods/studentGroups/subjectstudyperiodstudentgroup.xls"}),a.$watch("record.studyPeriod",l),a.isEditing||(a.studyPeriod=b.endpoint("/subjectStudyPeriods/studyPeriod").get({id:q})),a.$watch("record.studentGroup",function(){!c.isEmpty(a.studentGroups)&&a.record.studentGroup&&o()}),a.save=function(){if(a.subjectStudyPeriodStudentGroupEditForm.$setSubmitted(),!a.subjectStudyPeriodStudentGroupEditForm.$valid)return void f.error("main.messages.form-has-errors");var b=a.record.subjects;if(c.isEmpty(b)||c.isEmpty(a.record.subjectStudyPeriodDtos))return void f.error("subjectStudyPeriod.error.noDataForSaving");var d=a.record.subjects.filter(function(b){return!a.capacitiesUtil.subjectsLoadValid(b.id,a.capacityTypes)});if(!c.isEmpty(d)){var e=d.map(function(a){return h.currentLanguageNameField(a)}).join(", ");return void g.confirmDialog({prompt:"subjectStudyPeriod.error.subjectLoad",subject:e},p)}p()},a.teacherPlannedLoad=function(b){return a.capacitiesUtil.teacherPlannedLoad(b)},a.teacherCapacities=function(b){g.showDialog("subjectStudyPeriod/teacher.capacities.tmpl.html",function(c){c.subject=b,c.capacityTypes=a.capacityTypes,c.capacitiesUtil=a.capacitiesUtil},function(){a.save()})}}]),angular.module("hitsaOis").controller("SubjectStudyPeriodStudentGroupViewController",["$scope","QueryUtils","Classifier","$route","SspCapacities","USER_ROLES","AuthService",function(a,b,c,d,e,f,g){function h(){a.curriculum=b.endpoint("/subjectStudyPeriods/studentGroups/curriculum/"+a.studentGroup.curriculum.id).get(i)}function i(){var b=a.curriculum.studyPeriod;a.curriculumStudyPeriod={years:Math.floor(b/12),months:b%12}}a.auth=d.current.locals.auth,a.canEdit=g.isAuthorized(f.ROLE_OIGUS_M_TEEMAOIGUS_TUNNIJAOTUSPLAAN);var j=parseInt(d.current.params.studyPeriodId,10),k=parseInt(d.current.params.studentGroupId,10);a.isEditing=null===k;var l=b.endpoint("/subjectStudyPeriods/studentGroups/container");a.formState={xlsUrl:"subjectStudyPeriods/studentGroups/subjectstudyperiodstudentgroup.xls"},a.container={studyPeriod:j,studentGroup:k,subjectStudyPeriodDtos:[]},a.record=l.search(a.container),a.record.$promise.then(function(b){a.capacitiesUtil=new e(b),a.capacityTypes=b.capacityTypes}),b.endpoint("/studentgroups/"+k).get(function(b){a.studentGroup=b,a.studentGroup.nameEt=b.code,a.course=a.studentGroup.course.toString(),h()}),a.studyPeriod=b.endpoint("/subjectStudyPeriods/studyPeriod").get({id:j}),a.teacherPlannedLoad=function(b){return a.capacitiesUtil.teacherPlannedLoad(b)}}]),angular.module("hitsaOis").controller("SubjectStudyPeriodStudentGroupSearchController",["$scope","$route","QueryUtils","ArrayUtils","DataUtils","USER_ROLES","AuthService","message",function(a,b,c,d,e,f,g,h){function i(){a.criteria&&!a.criteria.studyPeriod&&(a.criteria.studyPeriod=e.getCurrentStudyYearOrPeriod(a.studyPeriods).id),a.loadData()}a.schoolId=b.current.locals.auth.school.id,a.canEdit=g.isAuthorized(f.ROLE_OIGUS_M_TEEMAOIGUS_TUNNIJAOTUSPLAAN),a.currentNavItem="studentGroups",a.formState={xlsUrl:"subjectStudyPeriods/studentGroups/searchByStudentGroup.xls"},c.createQueryForm(a,"/subjectStudyPeriods/studentGroups",{order:"id"}),a.studyPeriods=c.endpoint("/autocomplete/studyPeriodsWithYear").query(i),a.studyPeriods.$promise.then(function(b){b.forEach(function(b){b[a.currentLanguageNameField()]=a.currentLanguageNameField(b.studyYear)+" "+a.currentLanguageNameField(b)})}),a.load=function(){return a.searchForm.$valid?void a.loadData():(h.error("main.messages.form-has-errors"),!1)},a.directiveControllers=[];var j=a.clearCriteria;a.clearCriteria=function(){j(),a.directiveControllers.forEach(function(a){a.clear()})},a.$watch("criteria.department",function(){if(a.criteria.department&&a.criteria.curriculum){var b=a.curricula.find(function(b){return b.id===a.criteria.curriculum});-1===b.departments.indexOf(a.criteria.department)&&(a.criteria.curriculum=void 0)}}),a.searchCurriculums=function(b){return e.filterArrayByText(a.curricula,b,function(b,c){return a.filterCurriculums(b)&&c.test(b.display.toUpperCase())})},a.$watch("criteria.curriculum",function(){if(a.criteria.curriculum&&a.criteria.studentGroup){var b=a.studentGroups.find(function(b){return b.id===a.criteria.studentGroup});b.curriculum.id!==a.criteria.curriculum&&(a.criteria.studentGroup=void 0)}}),a.curricula=c.endpoint("/subjectStudyPeriods/studentGroups/curricula").query({},function(b){b.forEach(function(b){b.display=b.code+" - "+a.currentLanguageNameField(b)})}),c.endpoint("/subjectStudyPeriods/studentGroups/list").query(function(b){a.studentGroups=b.map(function(a){var b=a;return b.nameEt=a.code,b.nameEn=a.code,b})}),a.filterCurriculums=function(b){return a.criteria.department?d.includes(b.departments,a.criteria.department):!0},a.filterStudentGroups=function(b){return a.criteria.curriculum?b.curriculum.id===a.criteria.curriculum:!0}}]),angular.module("hitsaOis").controller("SubjectProgramController",["$scope","QueryUtils","$route","ArrayUtils","message","dialogService","$location","config","$rootScope","$timeout","$mdColors",function(a,b,c,d,e,f,g,h,i,j,k){function l(c,d){a.subject=b.endpoint(a.isPublic&&!a.auth?"/public/subject/view":A+"/subject").get({id:c,program:d}),a.auth&&(a.auth.isTeacher()||a.auth.isAdmin())&&(a.subjectPrograms=b.endpoint(A+"/teacher/"+c).query())}function m(){z?j(function(){a.subjectProgram?a.subjectProgram.$get({id:z},r):a.subjectProgram=B.get({id:z},r),a.subjectProgram.$promise.then(function(b){v=b.subjectId,l(v,a.subjectProgram.id)})["catch"](function(){a.back(a.getDefaultBack())})}):a.subjectProgram=new B(C),v&&l(v)}function n(){a.subjectProgram.$update().then(function(b){e.info("main.messages.update.success"),r(b),a.subjectProgramForm.$setPristine()})}function o(){a.subjectProgram.$save().then(function(a){e.info("main.messages.create.success"),g.url("/subjectProgram/"+y+"/"+a.id+"/edit")})}function p(){return a.subjectProgramForm.$setSubmitted(),a.subjectProgramForm.$valid?!0:(e.error("main.messages.form-has-errors"),!1)}function q(a,b){if(a===b)return 0;if(angular.isUndefined(a)||angular.isUndefined(b))return angular.isUndefined(a)?1:-1;var c=D.test(a),d=D.test(b);if(c&&d){var e=a.split("-"),f=b.split("-");return parseInt(e?e[0]:a)-parseInt(f?f[0]:b)}return c||d?c?-1:1:a.localeCompare(b)}function r(b){a.studyContentWk=[],a.studyContentDt=[],"OPPETOOSISU_K"===b.studyContentType?(a.studyContentDt=b.studyContents,a.studyContentDt.forEach(function(a){a.studyDt=new Date(a.studyDt)}),a.studyContentDt.sort(function(a,b){return a.studyDt-b.studyDt})):"OPPETOOSISU_N"===b.studyContentType&&(a.studyContentWk=b.studyContents,a.studyContentWk.sort(function(a,b){return q(a.weekNr,b.weekNr)})),a.isSupervisor=d.includes(b.supervisorIds||[],a.userTeacherId),a.studyContentTypeChange()}function s(){a.subjectProgram.id||(a.subjectProgram.subjectId=v,a.subjectProgram.subjectStudyPeriodId=w),"OPPETOOSISU_K"===a.subjectProgram.studyContentType?(a.subjectProgram.studyDescription=null,a.studyContentWk=[],a.subjectProgram.studyContents=a.studyContentDt):"OPPETOOSISU_N"===a.subjectProgram.studyContentType?(a.subjectProgram.studyDescription=null,a.studyContentDt=[],a.subjectProgram.studyContents=a.studyContentWk):(a.studyContentWk=[],a.studyContentDt=[],a.subjectProgram.studyContents=null)}function t(){f.confirmDialog({prompt:"subjectProgram.operation.complete.message"},function(){b.endpoint(A+"/complete").get({id:a.subjectProgram.id}).$promise.then(function(){e.info("subjectProgram.operation.complete.success"),g.url("/subjectProgram/"+y+"/"+a.subjectProgram.id+"/view?_noback")})})}var u=Object.freeze({periods:"periods",programs:"programs",teachers:"teachers","public":"public"});a.auth=c.current.locals.auth;var v=c.current.params.subjectId,w=c.current.params.subjectStudyPeriodId,x=c.current.params.teacher,y=u[c.current.params.form||(c.current.locals.params?c.current.locals.params.form:void 0)];angular.isUndefined(y)&&(e.error("main.messages.error.nopermission"),g.path("/")),a.isPublic=y===u["public"];var z=c.current.params.subjectProgramId,A="/subject/subjectProgram",B=b.endpoint("/"+(a.isPublic&&!a.auth?"public":"subject")+"/subjectProgram"),C={teacherId:x,studyContentType:"OPPETOOSISU_T",status:"AINEPROGRAMM_STAATUS_L"};i.removeLastUrlFromHistory(function(a){return a&&-1!==a.indexOf("new")}),a.selectedSubjectProgram=void 0,a.studyContentWk=[],a.studyContentDt=[],a.userTeacherId=a.auth?a.auth.teacher:void 0,a.isSupervisor=!1;var D=/^\d+(\-\d+)?$/,E=k.getThemeColor("warn");a.showWarningAboutType=!1,a.studyContentTypeChange=function(){var b=!1;"OPPETOOSISU_K"!==a.subjectProgram.studyContentType&&(a.studyContentDt||[]).length>0?(document.querySelector("md-radio-button[value='OPPETOOSISU_K']").style.color=E,b=!0):document.querySelector("md-radio-button[value='OPPETOOSISU_K']").style.color="","OPPETOOSISU_N"!==a.subjectProgram.studyContentType&&(a.studyContentWk||[]).length>0?(document.querySelector("md-radio-button[value='OPPETOOSISU_N']").style.color=E,b=!0):document.querySelector("md-radio-button[value='OPPETOOSISU_N']").style.color="","OPPETOOSISU_T"!==a.subjectProgram.studyContentType&&a.subjectProgram.studyDescription?(document.querySelector("md-radio-button[value='OPPETOOSISU_T']").style.color=E,b=!0):document.querySelector("md-radio-button[value='OPPETOOSISU_T']").style.color="",a.showWarningAboutType=b},a.addStudyContentDt=function(){a.studyContentDt.push({id:null,studyDt:null,studyInfo:null})},a.addStudyContentWk=function(){a.studyContentWk.push({id:null,weekNr:null,studyInfo:null})},a.removeFromArray=d.remove,a["delete"]=function(){f.confirmDialog({prompt:"subjectProgram.operation.delete.message"},function(){a.subjectProgram.$delete().then(function(){e.info("main.messages.delete.success"),y===u.periods?g.url("/subjectStudyPeriods"):y===u.programs&&g.url("/subjectProgram")})})},a.getSubjectProgramData=function(c){angular.isDefined(c)&&b.endpoint(A).get({id:c.id}).$promise.then(function(b){a.subjectProgram.independentStudy=b.independentStudy,a.subjectProgram.assessmentDescription=b.assessmentDescription,a.subjectProgram.studyLiterature=b.studyLiterature,a.subjectProgram.studyDescription=b.studyDescription,a.subjectProgram.studyContentType=b.studyContentType,a.subjectProgram.publicAll=b.publicAll,a.subjectProgram.publicHois=b.publicHois,a.subjectProgram.publicStudent=b.publicStudent,a.subjectProgram.passDescription=b.passDescription,a.subjectProgram.npassDescription=b.npassDescription,a.subjectProgram.grade0Description=b.grade0Description,a.subjectProgram.grade1Description=b.grade1Description,a.subjectProgram.grade2Description=b.grade2Description,a.subjectProgram.grade3Description=b.grade3Description,a.subjectProgram.grade4Description=b.grade4Description,a.subjectProgram.grade5Description=b.grade5Description,a.subjectProgram.addInfo=b.addInfo,b.studyContents.forEach(function(a){a.id=null}),r(b)})},a.pdfUrl=function(){return a.isPublic&&!a.auth?h.apiUrl+"/public/print/subjectProgram/"+a.subjectProgram.id+"/program.pdf":h.apiUrl+A+"/print/"+a.subjectProgram.id+"/program.pdf"},a.edit=function(){"AINEPROGRAMM_STAATUS_I"!==a.subjectProgram.status?f.confirmDialog({prompt:"subjectProgram.messages.editAccept"},function(){g.url("/subjectProgram/"+y+"/"+z+"/edit")}):g.url("/subjectProgram/"+y+"/"+z+"/edit")},a.completeProgram=function(){a.subjectProgramForm.$dirty?f.confirmDialog({prompt:"main.messages.confirmFormDataNotSaved"},function(){t()}):t()},a.confirm=function(){f.confirmDialog({prompt:"subjectProgram.operation.confirm.message"},function(){b.endpoint(A+"/confirm").get({id:a.subjectProgram.id}).$promise.then(function(){e.info("subjectProgram.operation.confirm.success"),m()})})},a.openRejectDialog=function(){var c="subjectProgram/dialog/subject.program.reject.dialog.html";f.showDialog(c,function(c){function d(){return c.dialogForm.$setSubmitted(),c.dialogForm.$valid?!0:(e.error("main.messages.form-has-errors"),!1)}c.rejectProgram=function(){d()&&b.endpoint(A+"/reject/"+a.subjectProgram.id).save(c.rejectInfo).$promise.then(function(){e.info("subjectProgram.operation.reject.success"),m()})}},function(){})},a.save=function(){p()&&(a.showWarningAboutType?f.confirmDialog({prompt:"subjectProgram.messages.previousStudyContentBeingDeleted"},function(){s(),a.subjectProgram.id?n():o()}):(s(),a.subjectProgram.id?n():o()))},a.getDefaultBack=function(){return y===u.programs?"#/subjectProgram":y===u.periods&&(a.auth.isAdmin()||a.auth.isTeacher())?"#/subjectStudyPeriods":y===u.teachers&&angular.isDefined(a.subjectProgram)&&angular.isDefined(a.subjectProgram.subjectStudyPeriodTeacher)?"#/teachers/"+(a.auth.isTeacher()?"myData":a.subjectProgram.subjectStudyPeriodTeacher.teacherId):"#/"},m()}]).controller("SubjectProgramSearch",["$scope","QueryUtils","$route","DataUtils","Classifier","message","$q",function(a,b,c,d,e,f,g){function h(){if(!a.criteria.studyPeriod){var b=d.getCurrentStudyYearOrPeriod(a.studyPeriods);b&&(a.criteria.studyPeriod=b.id)}}function i(){h(),m.promise.then(function(){a.myData||a.loadData()}),a.studyPeriods.forEach(function(b){b[a.currentLanguageNameField()]=a.currentLanguageNameField(b.studyYear)+" "+a.currentLanguageNameField(b)})}a.myData=c.current.locals.params.myData;var j="/subject/subjectProgram";b.createQueryForm(a,j+(a.myData?"/myPrograms":"")),a.auth=c.current.locals.auth,angular.isUndefined(a.criteria.status)&&!a.myData&&(a.criteria.status="AINEPROGRAMM_STAATUS_V");var k=b.endpoint("/autocomplete/teachersList"),l=b.endpoint("/autocomplete/studyPeriodsWithYear"),m=g.defer();a.auth.isAdmin()&&a.myData&&a.teacher?a.teacher.$promise.then(function(c){a.criteria.teacher={id:c.id},b.endpoint(j+(a.myData?"/program":"/curriculum")+"/subjects?teacher="+c.id).query({},function(b){a.subjects=b,m.resolve(b)})}):b.endpoint(j+(a.myData?"/program":"/curriculum")+"/subjects").query({},function(b){a.subjects=b,m.resolve(b)}),a.studyPeriods=l.query(i),e.queryForDropdown({mainClassCode:"AINEPROGRAMM_STAATUS"},function(b){a.statusOptions=e.toMap(b)}),a.searchTeacher=function(a){return k.query({name:a,valid:!0}).$promise},a.getStudyPeriodName=function(b){return a.studyPeriods.filter(function(a){return a.id===b.id})[0][a.currentLanguageNameField()]},a.clearCriteriaBefore=function(){a.clearCriteria(),h()},a.load=function(){return a.searchController.searchForm.$valid?void a.loadData():(f.error("main.messages.form-has-errors"),!1)}}]),angular.module("hitsaOis").config(["$routeProvider",function(a){function b(a){return-1!==["ROLL_O","ROLL_A"].indexOf(a.roleCode)&&a.higher}function c(a){return angular.isDefined(a.isCurriculumTeacher)&&a.isCurriculumTeacher}var d=a.$get[a.$get.length-1]({$on:function(){}});a.when("/subjectProgram",{templateUrl:"subjectProgram/subject.program.list.html",controller:"SubjectProgramSearch",controllerAs:"searchController",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],params:function(){return{myData:!1}}},data:{authorizedRoles:c}}).when("/subjectProgram/:subjectId/:subjectStudyPeriodId/:form/new",{templateUrl:"subjectProgram/subject.program.edit.html",controller:"SubjectProgramController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:b}}).when("/subjectProgram/public/:subjectProgramId/view",{templateUrl:"subjectProgram/subject.program.view.html",controller:"SubjectProgramController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],params:function(){return{form:"public"}}}}).when("/subjectProgram/:form/:subjectProgramId/view",{templateUrl:"subjectProgram/subject.program.view.html",controller:"SubjectProgramController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:function(a){return"ROLL_A"===a.roleCode||"ROLL_O"===a.roleCode}}}).when("/subjectProgram/:form/:subjectProgramId/edit",{templateUrl:"subjectProgram/subject.program.edit.html",controller:"SubjectProgramController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:b}}),d.routes["/subjectProgram/:form/:subjectProgramId/view"].regexp=/^\/(?:subjectProgram\/(periods|programs|teachers)\/(\d+))\/view$/,d.routes["/subjectProgram/:form/:subjectProgramId/view/"].regexp=/^\/(?:subjectProgram\/(periods|programs|teachers)\/(\d+))\/view\/$/,d.routes["/subjectProgram/:form/:subjectProgramId/edit"].regexp=/^\/(?:subjectProgram\/(periods|programs|teachers)\/(\d+))\/edit$/,d.routes["/subjectProgram/:form/:subjectProgramId/edit/"].regexp=/^\/(?:subjectProgram\/(periods|programs|teachers)\/(\d+))\/edit\/$/}]),angular.module("hitsaOis").controller("SubjectStudyPeriodSubjectEditController",["$route","$scope","ArrayUtils","DataUtils","SspCapacities","QueryUtils","dialogService","message",function(a,b,c,d,e,f,g,h){function i(){b.record.studyPeriod||(b.record.studyPeriod=d.getCurrentStudyYearOrPeriod(b.studyPeriods).id,l=b.record.studyPeriod)}function j(){b.record.studyPeriod&&(b.subjects=f.endpoint("/subjectStudyPeriods/subjects/list/limited/"+b.record.studyPeriod).query())}function k(){return b.subjectStudyPeriodSubjectEditForm.$setSubmitted(),b.subjectStudyPeriodSubjectEditForm.$valid?c.isEmpty(b.record.subjectStudyPeriodDtos)?(h.error("subjectStudyPeriod.error.noDataForSaving"),!1):!0:(h.error("main.messages.form-has-errors"),!1)}var l=a.current.params.studyPeriodId?parseInt(a.current.params.studyPeriodId,10):null,m=a.current.params.subjectId?parseInt(a.current.params.subjectId,10):null;b.isNew=null===m&&null===l;var n=f.endpoint("/subjectStudyPeriods/subjects/container");b.record={},l?b.studyPeriod=f.endpoint("/subjectStudyPeriods/studyPeriod").get({id:l}):(b.studyPeriods=f.endpoint("/autocomplete/studyPeriodsWithYear").query(i),b.studyPeriods.$promise.then(function(a){a.forEach(function(a){a[b.currentLanguageNameField()]=b.currentLanguageNameField(a.studyYear)+" "+b.currentLanguageNameField(a)})})),m&&(b.container={studyPeriod:l,subject:m,subjectStudyPeriodDtos:[]},b.record=n.search(b.container),b.record.$promise.then(function(a){b.capacitiesUtil=new e(a),b.capacityTypes=a.capacityTypes,b.capacitiesUtil.addEmptyCapacities(b.capacityTypes)}),b.subject=f.endpoint("/subjectStudyPeriods/subject/"+m).get(),b.formState={xlsUrl:"subjectStudyPeriods/subjects/subjectstudyperiodsubject.xls"}),b.$watch("record.studyPeriod",j),b.save=function(){k()&&(b.capacitiesUtil.filterEmptyCapacities(),b.record.$put().then(function(a){h.updateSuccess(),b.record=a,b.capacitiesUtil.addEmptyCapacities(b.capacityTypes),b.subjectStudyPeriodSubjectEditForm.$setPristine()}))},b.teacherPlannedLoad=function(a){return b.capacitiesUtil.teacherPlannedLoad(a)},b.teacherCapacities=function(a){g.showDialog("subjectStudyPeriod/teacher.capacities.tmpl.html",function(c){c.subject=a,c.capacityTypes=b.capacityTypes,c.capacitiesUtil=b.capacitiesUtil},function(){b.save()})}}]),angular.module("hitsaOis").controller("SubjectStudyPeriodSubjectViewController",["$scope","QueryUtils","$route","Classifier","SspCapacities","USER_ROLES","AuthService",function(a,b,c,d,e,f,g){a.auth=c.current.locals.auth,a.canEdit=g.isAuthorized(f.ROLE_OIGUS_M_TEEMAOIGUS_TUNNIJAOTUSPLAAN);var h=parseInt(c.current.params.studyPeriodId,10),i=parseInt(c.current.params.subjectId,10),j=b.endpoint("/subjectStudyPeriods/subjects/container");a.formState={xlsUrl:"subjectStudyPeriods/subjects/subjectstudyperiodsubject.xls"},a.studyPeriod=b.endpoint("/subjectStudyPeriods/studyPeriod").get({id:h}),a.container={studyPeriod:h,subject:i,subjectStudyPeriodDtos:[]},a.record=j.search(a.container),a.record.$promise.then(function(b){a.capacitiesUtil=new e(b),a.capacityTypes=b.capacityTypes}),a.subject=b.endpoint("/subjectStudyPeriods/subject/"+i).get(),a.teacherPlannedLoad=function(b){return a.capacitiesUtil.teacherPlannedLoad(b)}}]),angular.module("hitsaOis").controller("SubjectStudyPeriodSubjectSearchController",["$scope","$sessionStorage","QueryUtils","DataUtils","ArrayUtils","USER_ROLES","AuthService","message",function(a,b,c,d,e,f,g,h){function i(){a.criteria&&!a.criteria.studyPeriod&&(a.criteria.studyPeriod=d.getCurrentStudyYearOrPeriod(a.studyPeriods).id),a.loadData()}a.canEdit=g.isAuthorized(f.ROLE_OIGUS_M_TEEMAOIGUS_TUNNIJAOTUSPLAAN),a.currentNavItem="subjects",a.formState={xlsUrl:"subjectStudyPeriods/subjects/searchBySubject.xls"},c.createQueryForm(a,"/subjectStudyPeriods/subjects",{order:"id"}),a.studyPeriods=c.endpoint("/autocomplete/studyPeriodsWithYear").query(i),a.studyPeriods.$promise.then(function(b){b.forEach(function(b){b[a.currentLanguageNameField()]=a.currentLanguageNameField(b.studyYear)+" "+a.currentLanguageNameField(b)})}),a.load=function(){return a.searchForm.$valid?void a.loadData():(h.error("main.messages.form-has-errors"),!1)},a.$watch("criteria.teacherObject",function(){a.criteria.teacher=a.criteria.teacherObject?a.criteria.teacherObject.id:null}),a.$watch("criteria.subjectObject",function(){a.criteria.subject=a.criteria.subjectObject?a.criteria.subjectObject.id:null})}]),angular.module("hitsaOis").controller("SubjectStudyPeriodTeacherEditController",["$rootScope","$route","$scope","ArrayUtils","DataUtils","SspCapacities","QueryUtils","dialogService","message",function(a,b,c,d,e,f,g,h,i){function j(){c.record.studyPeriod||(c.record.studyPeriod=e.getCurrentStudyYearOrPeriod(c.studyPeriods).id,n=c.record.studyPeriod)}function k(){c.record.studyPeriod&&(c.teachers=g.endpoint("/subjectStudyPeriods/teachers/list/limited/"+c.record.studyPeriod).query())}function l(){if(c.subjectStudyPeriodTeacherEditForm.$setSubmitted(),!c.subjectStudyPeriodTeacherEditForm.$valid)return i.error("main.messages.form-has-errors"),!1;var a=c.record.subjects;return d.isEmpty(a)||d.isEmpty(c.record.subjectStudyPeriodDtos)?void i.error("subjectStudyPeriod.error.noDataForSaving"):!0}function m(){c.capacitiesUtil.filterEmptyCapacities(),c.record.$put().then(function(a){i.updateSuccess(),c.record=a,c.capacitiesUtil.addEmptyCapacities(c.capacityTypes),c.subjectStudyPeriodTeacherEditForm.$setPristine()})}var n=b.current.params.studyPeriodId?parseInt(b.current.params.studyPeriodId,10):null,o=b.current.params.teacherId?parseInt(b.current.params.teacherId,10):null;c.isNew=null===o&&null===n;var p=g.endpoint("/subjectStudyPeriods/teachers/container");c.record={},n?c.studyPeriod=g.endpoint("/subjectStudyPeriods/studyPeriod").get({id:n}):(c.studyPeriods=g.endpoint("/autocomplete/studyPeriodsWithYear").query(j),c.studyPeriods.$promise.then(function(a){a.forEach(function(a){a[c.currentLanguageNameField()]=c.currentLanguageNameField(a.studyYear)+" "+c.currentLanguageNameField(a)})})),o&&(c.container={studyPeriod:n,teacher:o,subjectStudyPeriodDtos:[]},c.record=p.search(c.container),c.record.$promise.then(function(a){c.capacitiesUtil=new f(a),c.capacityTypes=a.capacityTypes,c.capacitiesUtil.addEmptyCapacities(c.capacityTypes)}),c.teacher=g.endpoint("/subjectStudyPeriods/teacher/"+o).get(),c.formState={xlsUrl:"subjectStudyPeriods/teachers/subjectstudyperiodteacher.xls"}),c.$watch("record.studyPeriod",k),c.sspTeacherCapacities=function(a){var b=a.teachers.filter(function(a){return a.teacherId===o})[0];return b.capacities},c.save=function(){if(l()){var b=c.record.subjects.filter(function(a){return!c.capacitiesUtil.subjectsLoadValid(a.id,c.capacityTypes)});if(!d.isEmpty(b)){var e=b.map(function(b){return a.currentLanguageNameField(b)}).join(", ");return void h.confirmDialog({prompt:"subjectStudyPeriod.error.subjectLoad",subject:e},m)}m()}}}]),angular.module("hitsaOis").controller("SubjectStudyPeriodTeacherViewController",["$scope","QueryUtils","$route","Classifier","SspCapacities","USER_ROLES","AuthService",function(a,b,c,d,e,f,g){a.auth=c.current.locals.auth,a.canEdit=g.isAuthorized(f.ROLE_OIGUS_M_TEEMAOIGUS_TUNNIJAOTUSPLAAN);var h=parseInt(c.current.params.studyPeriodId,10),i=c.current.params.teacherId?parseInt(c.current.params.teacherId,10):null,j=b.endpoint("/subjectStudyPeriods/teachers/container");a.formState={xlsUrl:"subjectStudyPeriods/teachers/subjectstudyperiodteacher.xls"},a.studyPeriod=b.endpoint("/subjectStudyPeriods/studyPeriod").get({id:h}),a.container={studyPeriod:h,teacher:i,subjectStudyPeriodDtos:[]},a.record=j.search(a.container),a.record.$promise.then(function(b){a.capacitiesUtil=new e(b),a.capacityTypes=b.capacityTypes,a.capacitiesUtil.addEmptyCapacities(a.capacityTypes)}),a.teacher=b.endpoint("/subjectStudyPeriods/teacher/"+i).get(),a.sspTeacherCapacities=function(a){var b=a.teachers.filter(function(a){return a.teacherId===i})[0];return b.capacities}}]),angular.module("hitsaOis").controller("SubjectStudyPeriodTeacherSearchController",["$scope","$route","QueryUtils","DataUtils","ArrayUtils","USER_ROLES","AuthService","message",function(a,b,c,d,e,f,g,h){function i(){a.criteria&&!a.criteria.studyPeriod&&(a.criteria.studyPeriod=d.getCurrentStudyYearOrPeriod(a.studyPeriods).id),a.loadData()}a.schoolId=b.current.locals.auth.school.id,a.canEdit=g.isAuthorized(f.ROLE_OIGUS_M_TEEMAOIGUS_TUNNIJAOTUSPLAAN),a.currentNavItem="teachers",a.formState={xlsUrl:"subjectStudyPeriods/teachers/searchByTeacher.xls"},c.createQueryForm(a,"/subjectStudyPeriods/teachers",{order:"id"}),a.studyPeriods=c.endpoint("/autocomplete/studyPeriodsWithYear").query(i),a.studyPeriods.$promise.then(function(b){b.forEach(function(b){b[a.currentLanguageNameField()]=a.currentLanguageNameField(b.studyYear)+" "+a.currentLanguageNameField(b)})}),a.load=function(){return a.searchForm.$valid?void a.loadData():(h.error("main.messages.form-has-errors"),!1)},a.$watch("criteria.teacherObject",function(){a.criteria.teacher=a.criteria.teacherObject?a.criteria.teacherObject.id:null})}]),angular.module("hitsaOis").controller("subjectStudyPeriodPlanSearchController",["$scope","QueryUtils","ArrayUtils","message","DataUtils","Classifier","USER_ROLES","AuthService",function(a,b,c,d,e,f,g,h){function i(){a.criteria&&!a.criteria.studyPeriod&&(a.criteria.studyPeriod=e.getCurrentStudyYearOrPeriod(a.studyPeriods).id),a.loadData(),a.checkIfStudyPeriodIsPast()}a.canEdit=h.isAuthorized(g.ROLE_OIGUS_M_TEEMAOIGUS_AINE);var j=f.queryForDropdown({mainClassCode:"MAHT",higher:!0}),k=b.endpoint("/autocomplete/schoolCapacityTypes").query({isHigher:!0});b.createQueryForm(a,"/subjectStudyPeriodPlans",{order:"id"},function(b){var c={};b.forEach(function(a){a.plans.forEach(function(a){a.capacities.forEach(function(a){c[a.capacityType]=!0})})}),k.forEach(function(a){c[a.code]=!0}),a.capacityTypes=j.filter(function(a){return c[a.code]})}),b.endpoint("/autocomplete/studyPeriodsWithYear").query().$promise.then(function(b){a.studyPeriods=b,a.studyPeriods.forEach(function(b){b[a.currentLanguageNameField()]=a.currentLanguageNameField(b.studyYear)+" "+a.currentLanguageNameField(b)}),i()}),a.curriculums=b.endpoint("/subjectStudyPeriodPlans/curriculums").query(),a.searchCurriculums=function(b){return e.filterArrayByText(a.curriculums,b,function(b,c){return c.test(a.currentLanguageNameField(b).toUpperCase())})},a.$watch("criteria.subjectObject",function(){a.criteria.subject=a.criteria.subjectObject?a.criteria.subjectObject.id:null}),a.load=function(){return a.searchForm.$valid?void a.loadData():(d.error("main.messages.form-has-errors"),!1)},a.getCapacitiesHours=function(a,b){if(b.capacities){var c=b.capacities.find(function(b){return b.capacityType===a});return c&&c.hours?c.hours:"-"}},a.pastStudyPeriodSelected=!1,a.checkIfStudyPeriodIsPast=function(){if(a.studyPeriods){var b=a.studyPeriods.find(function(b){return b.id===a.criteria.studyPeriod});b&&(a.pastStudyPeriodSelected=e.isPastStudyYearOrPeriod(b))}},a.$watch("criteria.curriculum",function(){a.subjectQueryParams=a.criteria.curriculum?{curricula:[a.criteria.curriculum.id],status:["AINESTAATUS_K"]}:{status:["AINESTAATUS_K"]}})}]).controller("subjectStudyPeriodPlanNewController",["$scope","QueryUtils","ArrayUtils","message","DataUtils","$mdDialog","dialogService","$route","Classifier","$location",function(a,b,c,d,e,f,g,h,i,j){function k(c){b.endpoint(t+"/studyPeriod/"+c).get().$promise.then(function(b){a.studyPeriod=b,b[a.currentLanguageNameField()]=a.currentLanguageNameField(b.studyYear)+" "+a.currentLanguageNameField(b),a.readOnly=e.isPastStudyYearOrPeriod(a.studyPeriod)})}function l(c){a.subject=b.endpoint(t+"/subject/"+c).get()}function m(){b.endpoint(t+"/curriculums").query({subjects:[a.record.subject]}).$promise.then(function(b){a.curriculums=b,a.curriculums.forEach(function(b){b.selected=c.includes(a.record.curriculums,b.id)})})}function n(){b.endpoint("/autocomplete/schoolCapacityTypes").query({isHigher:!0},function(b){for(var c=[],d=0;d<b.length;d++)c.push({isContact:!1,hours:null,capacityType:b[d].code});a.record.capacities=c})}function o(b){var c=a.record.capacities.find(function(a){return a.capacityType===b});return angular.isDefined(c)&&null!==c}function p(){a.record.capacities||(a.record.capacities=[]),b.endpoint("/autocomplete/schoolCapacityTypes").query({isHigher:!0},function(b){for(var c=0;c<b.length;c++)o(b[c].code)||a.record.capacities.push({isContact:!1,hours:null,capacityType:b[c].code})})}function q(){i.queryForDropdown({mainClassCode:"OPPEVORM",higher:!0},function(b){a.studyForms=b,a.studyForms.forEach(function(b){b.selected=c.includes(a.record.studyForms,b.code)})})}function r(){a.record.id?a.record.$update().then(function(){d.info("main.messages.create.success")}):a.record.$save().then(function(a){d.info("main.messages.create.success"),j.url(t+"/"+a.id+"/edit?_noback")}),a.subjectStudyPeriodPlanEditForm.$setPristine()}var s=h.current.params.id,t="/subjectStudyPeriodPlans",u=b.endpoint(t);a.readOnly=!1;var v={studyPeriod:h.current.params.studyPeriodId,subject:h.current.params.subjectId,studyForms:[],curriculums:[]};s?u.get({id:s}).$promise.then(function(b){a.record=b,k(b.studyPeriod),l(b.subject),m(),q(),p()}):(a.record=new u(v),n(),k(a.record.studyPeriod),l(a.record.subject),m(),q()),a.getTotalCapacity=function(){return a.record&&a.record.capacities?a.record.capacities.reduce(function(a,b){return b.hours?a+b.hours:a},0):0},a.save=function(){return a.subjectStudyPeriodPlanEditForm.$valid?(a.record.studyForms=a.studyForms.filter(function(a){return a.selected}).map(function(a){return a.code}),a.record.curriculums=a.curriculums.filter(function(a){return a.selected}).map(function(a){return a.id}),void b.endpoint(t+"/exists").search(a.record).$promise.then(function(a){a.exists?g.confirmDialog({prompt:"subjectStudyPeriodPlan.overrideconfirm"},function(){r()}):r()})):void d.error("main.messages.form-has-errors")},a["delete"]=function(){g.confirmDialog({prompt:"subjectStudyPeriodPlan.deleteconfirm"},function(){a.record.$delete().then(function(){d.info("main.messages.delete.success"),j.path(t)})})};
}]),angular.module("hitsaOis").config(["$routeProvider","USER_ROLES",function(a,b){a.when("/subjectStudyPeriodPlans",{templateUrl:"subjectStudyPeriodPlan/subject.study.period.plan.search.html",controller:"subjectStudyPeriodPlanSearchController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:function(a,c){return"ROLL_A"===a.roleCode&&a.higher&&-1!==c.indexOf(b.ROLE_OIGUS_V_TEEMAOIGUS_AINE)}}}).when("/subjectStudyPeriodPlans/:subjectId/:studyPeriodId/new",{templateUrl:"subjectStudyPeriodPlan/subject.study.period.plan.edit.html",controller:"subjectStudyPeriodPlanNewController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:function(a,c){return"ROLL_A"===a.roleCode&&-1!==c.indexOf(b.ROLE_OIGUS_M_TEEMAOIGUS_AINE)}}}).when("/subjectStudyPeriodPlans/:id/edit",{templateUrl:"subjectStudyPeriodPlan/subject.study.period.plan.edit.html",controller:"subjectStudyPeriodPlanNewController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_AINE]}})}]),function(){angular.module("hitsaOis").factory("GeneralTimetableUtils",["DataUtils","stateStorageService",function(a,b){var c=function(){var c="timetableState";this.getCurrentWeekIndex=function(a){for(var b=moment(),c=0;c<=a.length-1;c++){var d=moment(a[c].start).startOf("day"),e=moment(a[c].end).endOf("day");if(moment(b).isBetween(d,e,null,"[]"))return c}return a&&a.length>0?b<moment(a[0].start).startOf("day")?0:a.length-1:void 0},this.getStudyYearId=function(b,c){var d=this.loadState(b);if(d.studyYearId){var e=(c||[]).map(function(a){return a.id});if(-1!==e.indexOf(d.studyYearId))return d.studyYearId}var f=a.getCurrentStudyYearOrPeriod(c);return f?f.id:null},this.loadState=function(a){return b.loadState(a,c)},this.changeState=function(a,d){b.changeState(d,c,a)}};return c}]).controller("GeneralTimetableSearchController",["$route","$scope","GeneralTimetableUtils","QueryUtils","message",function(a,b,c,d,e){function f(){if(angular.extend(b.criteria,b.generalTimetableUtils.loadState(b.schoolId)),b.criteria.subjectObject){var a=b.formState.subjects.filter(function(a){return a.id===b.criteria.subjectObject.id});b.criteria.subjectObject=a}}function g(){b.generalTimetableUtils.changeState({roomObject:b.criteria.roomObject,teacherObject:b.criteria.teacherObject,studentGroupObject:b.criteria.studentGroupObject,subjectObject:b.criteria.subjectObject},b.schoolId)}function h(){g(),b.$broadcast("updateWeekTimetable",{criteria:b.criteria})}function i(){return null!=b.criteria.roomObject||null!=b.criteria.teacherObject||null!=b.criteria.studentGroupObject||null!=b.criteria.subjectObject}b.generalTimetableUtils=new c,b.auth=a.current.locals.auth,b.currentNavItem="search",b.formState={},b.criteria={},a.current.params.schoolId?b.schoolId=a.current.params.schoolId:b.auth?b.schoolId=b.auth.school.id:$location.url("/timetables"),b.schoolId&&d.endpoint("/timetables/timetableStudyYears/:schoolId").query({schoolId:b.schoolId}).$promise.then(function(a){b.studyYears=a,b.criteria.studyYearId=b.generalTimetableUtils.getStudyYearId(b.schoolId,a)}),b.$watch("criteria.studyYearId",function(){angular.isDefined(b.criteria.studyYearId)&&null!==b.criteria.studyYearId&&d.endpoint("/timetableevents/timetableSearch/searchFormData/:schoolId/:studyYearId").search({schoolId:b.schoolId,studyYearId:b.criteria.studyYearId}).$promise.then(function(a){b.formState.teachers=a.teachers?a.teachers:[],b.formState.studentGroups=a.studentGroups?a.studentGroups:[],b.formState.rooms=a.rooms?a.rooms:[],b.formState.subjects=a.subjects?a.subjects:[],f(),i()&&h()})}),b.search=function(){i()?h():e.error("timetable.error.atleastOneParameterMustBeFilled")},b.parameterSearch=function(a,c){return a=(a||"").toUpperCase(),(c||[]).filter(function(c){return-1!==b.currentLanguageNameField(c).toUpperCase().indexOf(a)})},b.changeStudyYear=function(a){b.generalTimetableUtils.changeState({studyYearId:a.id},b.schoolId),b.criteria.studyYearId=a.id},b.clearSearchParameters=function(){b.criteria={studyYearId:b.criteria.studyYearId},b.teacherSearchText=null,b.studentGroupSearchText=null,b.roomSearchText=null,b.subjectSearchText=null}}]).controller("GeneralTimetableController",["$route","$location","$scope","GeneralTimetableUtils","QueryUtils",function(a,b,c,d,e){c.auth=a.current.locals.auth,c.generalTimetableUtils=new d,c.currentNavItem=a.current.params.type,c.typeParam=c.currentNavItem+"Id",c.criteria={},a.current.params.schoolId?c.schoolId=a.current.params.schoolId:c.auth?c.schoolId=c.auth.school.id:b.url("/timetables"),e.endpoint("/timetables/timetableStudyYears/:schoolId").query({schoolId:c.schoolId}).$promise.then(function(a){c.studyYears=a,c.criteria.studyYearId=c.generalTimetableUtils.getStudyYearId(c.schoolId,a)}),c.$watch("criteria.studyYearId",function(){angular.isDefined(c.criteria.studyYearId)&&null!==c.criteria.studyYearId&&e.endpoint("/timetables/:type/:schoolId/:studyYearId").query({type:c.currentNavItem,schoolId:c.schoolId,studyYearId:c.criteria.studyYearId}).$promise.then(function(a){c.typeTimetables=a;var b=c.generalTimetableUtils.loadState(c.schoolId);if(b[c.typeParam]){var d=c.typeTimetables.filter(function(a){return a[c.typeParam]===b[c.typeParam]});c.criteria.selectedTimetable=d?d[0]:null}c.showTypeWeek(c.criteria.selectedTimetable?c.criteria.selectedTimetable.id:null)})}),c.changeStudyYear=function(a){c.generalTimetableUtils.changeState({studyYearId:a.id},c.schoolId),c.criteria.studyYearId=a.id},c.getStudentGroups=function(a){return a=(a||"").toUpperCase(),(c.typeTimetables||[]).filter(function(b){return-1!==b.groupCode.toUpperCase().indexOf(a)})},c.getTeachers=function(a){return a=(a||"").toUpperCase(),(c.typeTimetables||[]).filter(function(b){return-1!==(b.firstname+" "+b.lastname).toUpperCase().indexOf(a)})},c.getRooms=function(a){return a=(a||"").toUpperCase(),(c.typeTimetables||[]).filter(function(b){return-1!==b.code.toUpperCase().indexOf(a)})},c.showTypeWeek=function(a){if(angular.isDefined(a)){var b={};b[c.typeParam]=a,c.criteria[c.typeParam]=a,c.generalTimetableUtils.changeState(b,c.schoolId),c.$broadcast("updateWeekTimetable",{criteria:c.criteria})}}}]).controller("PersonalGeneralTimetableController",["$route","$scope","GeneralTimetableUtils","QueryUtils",function(a,b,c,d){b.auth=a.current.locals.auth,b.generalTimetableUtils=new c,b.currentNavItem="personal",b.criteria={},b.schoolId=b.auth.school.id,d.endpoint("/timetables/timetableStudyYears/:schoolId").query({schoolId:b.schoolId}).$promise.then(function(a){b.studyYears=a,b.criteria.studyYearId=b.generalTimetableUtils.getStudyYearId(b.schoolId,a)}),b.auth.isStudent()||b.auth.isParent()?(b.typeParam="studentId",b.criteria[b.typeParam]=b.auth.student):b.auth.isTeacher()&&(b.typeParam="teacherId",b.criteria[b.typeParam]=b.auth.teacher),b.$watch("criteria.studyYearId",function(){angular.isDefined(b.criteria.studyYearId)&&b.showPersonalWeek()}),b.changeStudyYear=function(a){b.generalTimetableUtils.changeState({studyYearId:a.id},b.schoolId),b.criteria.studyYearId=a.id},b.showPersonalWeek=function(){var a={};a[b.typeParam]=b.criteria[b.typeParam],b.generalTimetableUtils.changeState(a,b.schoolId),b.$broadcast("updateWeekTimetable",{criteria:b.criteria})}}]).controller("GeneralTimetableSchoolListController",["$scope","School","$location",function(a,b,c){a.schools=b.getSchoolsWithLogo(),a.openSchoolGeneralTimetable=function(a){c.path("timetable/"+a+"/generalTimetable/group/")}}])}(),function(){function a(a){a.shownWeek&&(a.weekIndex=a.shownWeek.weekNr,a.previousWeekIndex=a.weeks[a.weekIndex-1]?a.weekIndex-1:void 0,a.nextWeekIndex=a.weeks[a.weekIndex+1]?a.weekIndex+1:void 0)}function b(a,b){a.timetableEvents=b;for(var c=0;c<b.length;c++){var d=b[c],f=moment(d.date).isoWeekday()-1,g=moment.duration(moment(d.timeEnd,"HH:mm").diff(moment(d.timeStart,"HH:mm"))).asMinutes(),h=p*(g/n),i=moment.duration(moment(d.timeStart,"HH:mm").diff(moment(o,"HH:mm"))).asMinutes(),j=p*(i/n)+q;a.weekColumns[f].events.push({nameEt:d.nameEt,nameEn:d.nameEn,timeStart:d.timeStart,timeEnd:d.timeEnd,rowHeight:h,top:j,rooms:d.rooms,id:d.id,maxEl:1,teachers:d.teachers,studentGroups:d.studentGroups,"public":d.publicEvent,journalId:d.journalId,subjectStudyPeriodId:d.subjectStudyPeriodId,showStudyMaterials:d.showStudyMaterials,capacityType:d.capacityType,left:0,width:100})}e(a,b)}function c(a){for(var b=[],c=0;7>c;c++)b.push([]);return a.forEach(function(a){var c=moment(a.date).isoWeekday()-1;b[c].push(a)}),b}function d(){for(var a=[],b=7;23>b;b++)for(var c=0;60>c;c++){var d=(10>b?"0"+b:b)+":"+(10>c?"0"+c:c);a[d]=[]}return a}function e(a,b){for(var e,f,g=c(b),h=0;h<g.length;h++){f=d();for(var i=0;i<g[h].length;i++){var j=g[h][i],k=moment(j.timeEnd,"HH:mm").add(-1,"m").format("HH:mm"),l=!1;for(e in f)j.timeStart===e?l=!0:k===e&&(l=!1),l&&f[e].push(j.id)}for(e in f)for(var m=0;m<f[e].length;m++)for(var n=0;n<a.weekColumns[h].events.length;n++)f[e][m]===a.weekColumns[h].events[n].id&&a.weekColumns[h].events[n].maxEl<f[e].length&&(a.weekColumns[h].events[n].maxEl=f[e].length,a.weekColumns[h].events[n].left=m*Math.floor(100/f[e].length),a.weekColumns[h].events[n].width=Math.floor(100/f[e].length))}}function f(a){var b=[];b.push("");for(var c=0;64>=c;c++){var d=moment(o,"HH:mm").add(n*c,"m"),e=moment(d).format("HH:mm");b.push(e)}a.timeColumn=b}function g(a){for(var b=[],c=["dayMon","dayTue","dayWed","dayThu","dayFri","daySat","daySun"],d=0;d<c.length;d++)b.push({name:c[d],column:d+1,events:[],date:moment(a.shownWeek.start).add(d,"days").toDate(),today:moment().format("DD.MM.YYYY")===moment(a.shownWeek.start).add(d,"days").format("DD.MM.YYYY")?!0:!1});a.weekColumns=b}function h(a,b){a.weekIndex=b,a.shownWeek=a.weeks[b],a.generalTimetableUtils.changeState({weekIndex:b},a.schoolId)}function i(a,c){f(a),g(a),b(a,c)}function j(a){var b=new Blob([a.content],{type:"text/ics"}),c=a.filename+".ics";k(c,b)}function k(a,b){if(window.navigator.msSaveOrOpenBlob)window.navigator.msSaveBlob(b,a);else{var c=window.document.createElement("a");c.href=window.URL.createObjectURL(b),c.download=a,document.body.appendChild(c),c.click(),document.body.removeChild(c)}}function l(a,b){var c=["amber-100","lime-100","teal-100","indigo-100","green-200","deep-orange-100","deep-purple-200","light-green-300","blue-grey-200","brown-50"],d=b.queryForDropdown({mainClassCode:"MAHT",higher:a.auth&&a.auth.higher?a.auth.higher:void 0,vocational:a.auth&&a.auth.vocational?a.auth.vocational:void 0});return d.$promise.then(function(a){return a.forEach(function(a,b){a.color=c[b%9]}),d})}function m(a,b){for(var c=0;c<a.length;c++)if(a[c].code===b)return a[c].color;return"primary-100-0.8"}var n=15,o="7:00",p=22,q=50;angular.module("hitsaOis").controller("TimetableWeekViewController",["$location","$route","$scope","$q","Classifier","GeneralTimetableUtils","QueryUtils",function(b,c,d,e,f,g,k){function n(b){d.criteria=b,d.typeId=b[d.typeParam];var c=d.studyYearId;d.studyYearId!==b.studyYearId&&(d.studyYearId=b.studyYearId),d.weeks=null,"student"===d.timetableType?d.weeksPromise=k.endpoint("/timetables/timetableStudyYearWeeks/:studyYearId/student/:studentId").query({studyYearId:d.studyYearId,studentId:d.criteria[d.typeParam]}):d.weeksPromise=k.endpoint("/timetables/timetableStudyYearWeeks/:studyYearId").query({studyYearId:d.studyYearId}),e.all([q,d.weeksPromise.$promise]).then(function(b){d.weeks=b[1],(angular.isUndefined(d.weekIndex)||angular.isUndefined(d.weeks[d.weekIndex])||angular.isDefined(d.weeks[d.weekIndex])&&d.weeks[d.weekIndex].studyYear!==c)&&(d.weekIndex=d.generalTimetableUtils.getCurrentWeekIndex(d.weeks)),d.shownWeek=d.weeks[d.weekIndex],a(d),o()})}function o(){d.timetableEvents=null,d.shownWeek&&(d.timetableSearch||!d.timetableSearch&&d.criteria[d.typeParam])&&(k.loadingWheel(d,!0),k.endpoint(s).search(p(!0)).$promise.then(function(a){k.loadingWheel(d,!1),d.shownStudyPeriods=a.studyPeriods,d.shownTimetableCurriculum=a.generalTimetableCurriculum,"teacher"===d.timetableType&&(d.shownTeacher={firstname:a.firstname,lastname:a.lastname}),"room"===d.timetableType&&(d.shownRoom={roomCode:a.roomCode,buildingCode:a.buildingCode}),"student"===d.timetableType&&(d.shownStudent={firstname:a.firstname,lastname:a.lastname,isHigher:a.isHigher}),i(d,a.timetableEvents)}))}function p(a){var b={};switch(d.timetableType){case"student":b.student=d.criteria.studentId;break;case"group":b.studentGroups=[d.criteria.groupId];break;case"teacher":b.teachers=[d.criteria.teacherId];break;case"room":b.room=d.criteria.roomId;break;case"search":d.criteria.teacherObject&&(b.teachers=[d.criteria.teacherObject.id]),d.criteria.studentGroupObject&&(b.studentGroups=[d.criteria.studentGroupObject.id]),d.criteria.roomObject&&(b.room=d.criteria.roomObject.id),d.criteria.subjectObject&&(b.journalOrSubjectId=d.criteria.subjectObject.id)}return b=a?angular.extend(b,{from:d.shownWeek.start,thru:d.shownWeek.end}):angular.extend(b,{from:d.weeks[0].start,thru:d.weeks[d.weeks.length-1].end,lang:d.currentLanguage()})}d.generalTimetableUtils=new g,d.auth=c.current.locals.auth,d.schoolId=c.current.params.schoolId?parseInt(c.current.params.schoolId,10):d.auth.school.id;var q=l(d,f).then(function(a){d.capacityTypes=a});c.current.params.type?d.timetableType=c.current.params.type:"personal"===d.$parent.currentNavItem?d.auth.isStudent()||d.auth.isParent()?d.timetableType="student":d.auth.isTeacher()&&(d.timetableType="teacher"):"student.timetable"===d.$parent.currentNavItem?d.timetableType="student":d.timetableType=d.$parent.currentNavItem,d.typeParam=d.timetableType+"Id",d.timetableSearch="search"===d.timetableType;var r=d.timetableSearch?"/timetableevents/timetableSearch/":"/timetableevents/timetableBy"+d.timetableType.charAt(0).toUpperCase()+d.timetableType.slice(1)+"/",s=r+d.schoolId,t=r+"calendar/"+d.schoolId;if(c.current.params.typeId)d.directRoute=!0,d.studyYearId=parseInt(c.current.params.studyYearId,10),c.current.params.weekIndex&&(d.weekIndex=parseInt(c.current.params.weekIndex,10)),d.criteria={studyYearId:d.studyYearId},d.criteria[d.typeParam]=c.current.params.typeId,d.typeId=c.current.params.typeId,n(d.criteria);else{var u=d.generalTimetableUtils.loadState(d.schoolId);d.studyYearId=u.studyYearId,d.weekIndex=u.weekIndex}d.$on("updateWeekTimetable",function(a,b){b.criteria?n(b.criteria):(d.weeks=null,d.shownWeek=null)}),d.previousWeek=function(b){h(d,b),a(d),o()},d.nextWeek=function(b){h(d,b),a(d),o()},d.weekSelectChange=function(c){angular.isDefined(c)&&(d.directRoute?b.url("/timetable/"+d.schoolId+"/"+d.timetableType+"/"+d.typeId+"/"+d.studyYearId+"/"+c.weekNr):(h(d,c.weekNr),a(d),o()))},d.getEventColor=function(a){return m(d.capacityTypes,a)},d.generateCalendar=function(){k.endpoint(t).search(p(!1)).$promise.then(function(a){j(a)})}}])}(),angular.module("hitsaOis").config(["$routeProvider","USER_ROLES",function(a,b){a.when("/timetable/lessonTime/search",{templateUrl:"timetable/timetable.lessonTime.list.html",controller:"TimetableLessonTimeListController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_TUNDAEG]}}).when("/timetable/lessonTime",{templateUrl:"timetable/timetable.lessonTime.html",controller:"TimetableLessonTimeController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_TUNDAEG]}}).when("/timetable/lessonTime/:id/view",{templateUrl:"timetable/timetable.lessonTime.view.html",controller:"TimetableLessonTimeController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],entity:["QueryUtils","$route",function(a,b){return a.endpoint("/lessontimes").get({id:b.current.params.id}).$promise}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_TUNDAEG]}}).when("/timetable/lessonTime/:id/edit",{templateUrl:"timetable/timetable.lessonTime.html",controller:"TimetableLessonTimeController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],entity:["QueryUtils","$route",function(a,b){return a.endpoint("/lessontimes").get({id:b.current.params.id}).$promise}]},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_TUNDAEG]}}).when("/timetable/:schoolId?/generalTimetable/:type",{templateUrl:"timetable/generalTimetable/timetable.generalTimetable.html",controller:"GeneralTimetableController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]}}).when("/timetable/personalGeneralTimetable",{templateUrl:"timetable/generalTimetable/timetable.generalTimetable.personal.html",controller:"PersonalGeneralTimetableController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_TUNNIPLAAN]}}).when("/timetable/:schoolId?/searchGeneralTimetable",{templateUrl:"timetable/generalTimetable/timetable.generalTimetable.search.html",controller:"GeneralTimetableSearchController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]}}).when("/timetable/timetableManagement",{templateUrl:"timetable/timetable.timetableManagement.html",controller:"TimetableManagementController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_TUNNIPLAAN]}}).when("/timetable/new",{templateUrl:"timetable/timetable.edit.html",controller:"TimetableEditController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],isCreate:function(){return!0}},data:{authorizedRoles:function(a,c){return"ROLL_A"===a.roleCode&&-1!==c.indexOf(b.ROLE_OIGUS_V_TEEMAOIGUS_TUNNIPLAAN)}}}).when("/timetable/:id/edit",{templateUrl:"timetable/timetable.edit.html",controller:"TimetableEditController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],entity:["QueryUtils","$route",function(a,b){return a.endpoint("/timetables").get({id:b.current.params.id}).$promise}],isView:["$route",function(a){return"view"===a.current.params.action}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_TUNNIPLAAN]}}).when("/timetable/:id/view",{templateUrl:"timetable/timetable.view.html",controller:"TimetableViewController",controllerAs:"controller",resolve:{auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_TUNNIPLAAN]}}).when("/timetable/:id/createVocationalPlan/:groupId",{templateUrl:"timetable/timetable.createVocationalPlan.html",controller:"VocationalTimetablePlanController",controllerAs:"controller",resolve:{auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_TUNNIPLAAN]}}).when("/timetable/:id/createHigherPlan/group/:groupId",{templateUrl:"timetable/timetable.createHigherPlan.html",controller:"HigherTimetablePlanController",controllerAs:"controller",resolve:{auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_TUNNIPLAAN]}}).when("/timetable/:id/createHigherPlan/pair/:pairId",{templateUrl:"timetable/timetable.createHigherPlan.html",controller:"HigherTimetablePlanController",controllerAs:"controller",resolve:{auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_TUNNIPLAAN]}}).when("/timetable/:id/createHigherPlan",{templateUrl:"timetable/timetable.createHigherPlan.html",controller:"HigherTimetablePlanController",controllerAs:"controller",resolve:{auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_TUNNIPLAAN]}}).when("/timetable/:schoolId/:type/:typeId/:studyYearId/:weekIndex?",{templateUrl:"timetable/generalTimetable/timetable.week.view.html",controller:"TimetableWeekViewController",controllerAs:"controller",resolve:{auth:["AuthResolver",function(a){return a.resolve()}]}}).when("/timetable/:schoolId/student/:studyYearId/:studentId",{templateUrl:"timetable/generalTimetable/timetable.week.view.html",controller:"StudentTimetableViewController",controllerAs:"controller",resolve:{auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_TUNNIPLAAN]}}).when("/timetables",{templateUrl:"timetable/generalTimetable/timetable.generalTimetable.school.list.html",controller:"GeneralTimetableSchoolListController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}]}}).when("/timetable/timetableEvent/new",{templateUrl:"timetable/timetable.timetableEvent.edit.html",controller:"TimetableEventEditController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],isCreate:function(){return!0}},data:{authorizedRoles:function(a,c,d){return("ROLL_A"===a.roleCode||"ROLL_O"===a.roleCode)&&d.intersect(c,[b.ROLE_OIGUS_M_TEEMAOIGUS_TUNNIPLAAN,b.ROLE_OIGUS_M_TEEMAOIGUS_SYNDMUS])}}}).when("/timetable/timetableEvent/:id/edit",{templateUrl:"timetable/timetable.timetableEvent.edit.html",controller:"TimetableEventEditController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],isCreate:function(){return!0}},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_TUNNIPLAAN,b.ROLE_OIGUS_M_TEEMAOIGUS_SYNDMUS]}}).when("/timetable/timetableEvent/:id/view",{templateUrl:"timetable/timetable.timetableEvent.view.html",controller:"TimetableEventEditController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_TUNNIPLAAN,b.ROLE_OIGUS_V_TEEMAOIGUS_SYNDMUS]}})}]),angular.module("hitsaOis").controller("TimetableLessonTimeController",["$scope","$rootScope","$q","QueryUtils","Classifier","DataUtils","ArrayUtils","$route","message","$timeout","$location","dialogService",function(a,b,c,d,e,f,g,h,i,j,k,l){function m(b){var c=[];for(var e in b)b.hasOwnProperty(e)&&angular.isDefined(b[e])&&c.push(e);c.length>0?d.endpoint("/lessontimes/minValidFrom").get({buildings:c.join(),lessonTimeId:h.current.params.id},function(b){null===b.minValidFrom?a.minValidFrom=void 0:(f.convertStringToDates(b,["minValidFrom"]),a.minValidFrom=b.minValidFrom,a.validFrom<a.minValidFrom+1&&(a.validFrom=void 0))}):a.minValidFrom=void 0}function n(b,c,d){d===!1&&angular.isDefined(a.usedBuildings[b.id])?(a.usedBuildings[b.id]=void 0,c.selectedBuildings[b.id]=!1):(a.usedBuildings[b.id]=c,c.selectedBuildings[b.id]=!0)}function o(b){for(var c in b.selectedBuildings)b.selectedBuildings.hasOwnProperty(c)&&b.selectedBuildings[c]===!0&&(a.usedBuildings[c]=void 0)}function p(){for(var b={lessonTimes:[],selectedBuildings:{}},c={dayMon:!0,dayTue:!0,dayWed:!0,dayThu:!0,dayFri:!0,daySat:!0,daySun:!0},d=0;u>d;d++)b.lessonTimes.push(angular.extend({},c));return a.buildings.forEach(function(c){angular.isDefined(a.usedBuildings[c.id])||n(c,b,!0)}),b}function q(b){a.blocks=[],a.usedBuildings={},f.convertStringToDates(b,["validFrom"]),a.validFrom=b.validFrom,angular.isArray(b.lessonTimeBuildingGroups)&&b.lessonTimeBuildingGroups.forEach(function(b){var c={id:b.id,lessonTimes:[],selectedBuildings:{}};a.blocks.push(c),angular.isArray(b.lessonTimes)&&b.lessonTimes.forEach(function(a){f.convertStringToTime(a,["startTime","endTime"]),c.lessonTimes.push(a)}),angular.isArray(b.buildings)&&b.buildings.forEach(function(a){n(a,c,!0)})})}function r(b){for(var c=b.length;c--;)a.isLessonTimeRowFilled(b[c])||b.splice(c,1)}function s(){var b=!0;a:for(var c=0;a.blocks.length>c;c++){for(var d=!1,e=0;a.blocks[c].lessonTimes.length>e;e++){a.isLessonTimeRowFilled(a.blocks[c].lessonTimes[e])&&(d=!0);var f=a.blocks[c].lessonTimes[e].startTime,g=a.blocks[c].lessonTimes[e].endTime;if("undefined"!=typeof f&&"undefined"!=typeof g){if(f>g){i.error("timetable.lessonTime.endIsEarlierThanStart"),b=!1;break a}if(f.getHours()<7||23===g.getHours()&&g.getMinutes()>0){i.error("timetable.lessonTime.outOfTimeRange"),b=!1;break a}}}d||(i.error("timetable.lessonTime.oneRowRequired"),b=!1)}return b}function t(a){var b={validFrom:a.validFrom,lessonTimeBuildingGroups:[]};return angular.isArray(a.blocks)&&a.blocks.forEach(function(a){r(a.lessonTimes);var c={id:a.id,lessonTimes:a.lessonTimes,buildings:[]};if(angular.isObject(a.selectedBuildings))for(var d in a.selectedBuildings)a.selectedBuildings.hasOwnProperty(d)&&a.selectedBuildings[d]===!0&&c.buildings.push({id:parseInt(d,10)});b.lessonTimeBuildingGroups.push(c)}),b}var u=10;b.replaceLastUrl("#/timetable/lessonTime/search"),a.buildings=d.endpoint("/autocomplete/buildings").query(),a.blocks=[],a.usedBuildings={};var v;a.$watchCollection("usedBuildings",function(a){angular.isDefined(v)&&!v.resolved&&j.cancel(v),v=j(function(){m(a)},500)}),a.addNewRow=function(a){a.lessonTimes.push({})},a.addNewBlock=function(){a.lessonTimeForm.$setPristine(!0),a.blocks.push(p())},a.deleteBlock=function(b){o(b),g.remove(a.blocks,b)},a.deleteRow=function(a,b){g.remove(a,b)},a.calculateAcademicHours=function(a,b){var c=Math.round((b-a)/27e5*100)/100;return c>=0?c:0},a.buildingChanged=function(b,c){n(b,c,c.selectedBuildings[b.id]),a.blocks.$setDirty()},a.isBuildingDisabled=function(b,c){return angular.isDefined(a.usedBuildings[b.id])?!angular.equals(c,a.usedBuildings[b.id]):!1},a.selectedBuildingsLength=function(a){var b=0;for(var c in a.selectedBuildings)a.selectedBuildings.hasOwnProperty(c)&&a.selectedBuildings[c]===!0&&b++;var d=function(){return b};return d},a.isLessonTimeRowFilled=function(a){return angular.isObject(a)?!!a.lessonNr||!!a.startTime||!!a.endTime&&(a.dayMon===!0||a.dayTue===!0||a.dayWed===!0||a.dayThu===!0||a.dayFri===!0||a.daySat===!0||a.daySun===!0):!1};var w=h.current.locals.entity;angular.isDefined(w)?q(w):a.buildings.$promise.then(function(){a.blocks.push(p())}),a.isEdit=function(){return angular.isDefined(w)},a.save=function(){if(a.lessonTimeForm.$setSubmitted(),a.lessonTimeForm.$valid&&s()){var b;if(a.isEdit()){b=d.endpoint("/lessontimes/");var c=t(a);!c.lessonTimeBuildingGroups||angular.isArray(c.lessonTimeBuildingGroups)&&0===c.lessonTimeBuildingGroups.length?l.confirmDialog({prompt:"timetable.lessonTime.deleteConfirm"},function(){new b(c).$update().then(function(){i.info("main.messages.delete.success"),a.back("#/timetable/lessonTime/search")})}):new b(c).$update().then(function(b){i.info("main.messages.create.success"),a.lessonTimeForm.$setPristine(),q(b)})}else{b=d.endpoint("/lessontimes");var e=t(a);new b(e).$save().then(function(b){i.info("main.messages.create.success"),a.lessonTimeForm.$setPristine(),angular.isArray(b.lessonTimeBuildingGroups)&&b.lessonTimeBuildingGroups.forEach(function(a){angular.isArray(a.lessonTimes)&&a.lessonTimes.length>0&&k.path("/timetable/lessonTime/"+a.lessonTimes[0].id+"/edit")})})}}}}]),angular.module("hitsaOis").controller("TimetableLessonTimeListController",["$scope","$q","QueryUtils","Classifier","DataUtils","$filter","USER_ROLES","AuthService",function(a,b,c,d,e,f,g,h){function i(a){var b=[];return a.dayMon===!0&&b.push({day:"NADALAPAEV_E"}),a.dayTue===!0&&b.push({day:"NADALAPAEV_T"}),a.dayWed===!0&&b.push({day:"NADALAPAEV_K"}),a.dayThu===!0&&b.push({day:"NADALAPAEV_N"}),a.dayFri===!0&&b.push({day:"NADALAPAEV_R"}),a.daySat===!0&&b.push({day:"NADALAPAEV_L"}),a.daySun===!0&&b.push({day:"NADALAPAEV_P"}),b}a.canEdit=h.isAuthorized(g.ROLE_OIGUS_M_TEEMAOIGUS_TUNDAEG);var j=d.valuemapper({day:"NADALAPAEV"}),k=j.promises;a.days=[];var l=c.endpoint("/lessontimes/currentPeriod").get(function(b){e.convertStringToDates(b,["periodStart"]),a.criteria.from=b.periodStart}).$promise;k.push(l),c.createQueryForm(a,"/lessontimes",{order:"lessonNr"},j.objectmapper),b.all(k).then(function(){var b=[{day:"NADALAPAEV_E"},{day:"NADALAPAEV_T"},{day:"NADALAPAEV_K"},{day:"NADALAPAEV_N"},{day:"NADALAPAEV_R"},{day:"NADALAPAEV_L"},{day:"NADALAPAEV_P"}];j.objectmapper(b).forEach(function(b){a.days.push(b.day)}),a.loadData()}),a.displayWeekdays=function(b){var c=i(b);return j.objectmapper(c).map(function(b){return b.day[a.currentLanguageNameField()].charAt(0)}).join(", ")},a.displayBuildings=function(b){var c=b.map(function(b){return b[a.currentLanguageNameField()]});return f("orderBy")(c).join(", ")},a.hasPassed=function(a){return e.convertStringToDates(a,["validThru"]),null!==a.validThru&&a.validThru<new Date},a.canEditLessonTime=function(b){return!a.hasPassed(b)&&a.canEdit}}]),angular.module("hitsaOis").controller("TimetableManagementController",["$rootScope","$window","$scope","$location","$timeout","message","QueryUtils","DataUtils","Classifier","dialogService","USER_ROLES","AuthService","oisFileService",function(a,b,c,d,e,f,g,h,i,j,k,l,m){function n(){c.formState.studyPeriods=c.allStudyPeriods.filter(function(a){return a.studyYear===c.criteria.studyYear})}function o(a){for(var b=0;b<c.formState.studyPeriods.length;b++){var d=c.formState.studyPeriods[b];if(d.id===a)return!0}return!1}c.canEdit=l.isAuthorized(k.ROLE_OIGUS_M_TEEMAOIGUS_TUNNIPLAAN);var p="/timetables",q=i.valuemapper({status:"TUNNIPLAAN_STAATUS"});g.createQueryForm(c,p+"/searchTimetableForManagement",{order:"3, 4"},q.objectmapper),c.formState={xlsDiffUrl:"timetables/timetableDifference.xls",xlsPlanUrl:"timetables/timetablePlan.xlsx"};var r=c.loadData;c.loadData=function(){c.timetableSearchForm.$setSubmitted(),c.timetableSearchForm.$valid?r():f.error("main.messages.form-has-errors")},c.openAddFileDialog=function(a,b){j.showDialog("timetable/dialog/file.import.dialog.html",function(){},function(d){var e=d.data;m.getFromLfFile(e.file[0],function(d){e.oisFile=d;var h=g.endpoint("/timetables/importXml"),i={};i.oisFile=e.oisFile,i.studyPeriod=a,i.code=b.isHigher?"TUNNIPLAAN_LIIK_H":"TUNNIPLAAN_LIIK_V",angular.extend(i,b);var k=new h(i);k.$save().then(function(a){null!==a.errors&&0!==a.errors.length&&j.showDialog("timetable/dialog/import.result.dialog.html",function(b){b.timetable=a},null),f.info("main.messages.create.success"),c.loadData()})["catch"](angular.noop)})})},c.exportTimetable=function(c,d){g.endpoint("/timetables/exportTimetableCheck").search(d).$promise.then(function(e){null!==e.teachers&&0!==e.teachers.length||null!==e.journals&&0!==e.journals.length?j.showDialog("timetable/dialog/export.result.dialog.html",function(a){a.timetable=e},null):b.location.href=a.excel(c,d)})},g.endpoint(p+"/managementSearchFormData").search().$promise.then(function(a){c.formState.studyYears=a.studyYears,c.allStudyPeriods=a.studyPeriods;var b=h.getCurrentStudyYearOrPeriod(c.formState.studyYears);b&&(c.criteria.studyYear=b.id,n(),c.criteria.studyPeriod=a.currentStudyPeriod),c.higher=a.higher,c.vocational=a.vocational,c.higher&&c.vocational||c.higher&&(c.criteria.type="TUNNIPLAAN_LIIK_H"),c.criteria.studyYear&&c.criteria.studyPeriod?e(c.loadData):0===c.formState.studyYears.length?f.error("studyYear.missing"):0===c.allStudyPeriods.length&&f.error("studyYear.studyPeriod.missing")}),c.$watch("criteria.studyYear",function(){
void 0!==c.criteria.studyYear&&c.allStudyPeriods&&(n(),o(c.criteria.studyPeriod)||(c.criteria.studyPeriod=null))}),c.copyTimetable=function(a){g.endpoint(p+"/getPossibleTargetsForCopy").query({id:a}).$promise.then(function(b){b.forEach(function(a){a.formattedStart=new Date(a.start)}),j.showDialog("timetable/timetable.timetableManagement.copyTimetable.html",function(a){a.copyTargets=b},function(b){var d={start:b.copyTarget.start,higher:b.copyTarget.isHigher,id:b.copyTarget.id,originalTimetable:a,studyPeriod:b.copyTarget.studyPeriod};g.endpoint(p+"/copyTimetable").search(d).$promise.then(function(){f.info("main.messages.create.success"),c.loadData()})})})},c.createEvent=function(a){var b=g.endpoint(p),c=new b;c.code=a.isHigher?"TUNNIPLAAN_LIIK_H":"TUNNIPLAAN_LIIK_V",c.studyPeriod=a.studyPeriod,c.startDate=a.start,c.endDate=a.end,c.$save().then(function(a){d.url("/timetable/"+a.id+"/view")})}}]),angular.module("hitsaOis").controller("TimetableEditController",["$scope","message","QueryUtils","DataUtils","$route","$location",function(a,b,c,d,e,f){function g(b,c){for(var d=0;d<a.formState.studyPeriods.length;d++){var e=a.formState.studyPeriods[d];if(e.id===c&&e.studyYear===c)return!0}return!1}function h(a){m=[];for(var b=0;b<a.length;b++)for(var c=0;c<a[b].dates.length;c++){var d=new Date(a[b].dates[c]);d=d.setHours(0,0,0,0),m.push(d)}m=m.sort()}function i(){return void 0!==a.allStudyPeriods?a.allStudyPeriods.filter(function(b){return b.id===a.timetable.studyPeriod})[0]:void 0}function j(){if(void 0!==a.timetable.studyPeriod){var b="studyPeriod="+a.timetable.studyPeriod+"&code="+a.timetable.code;void 0!==k&&(b+="&currentTimetable="+k),c.endpoint(l+"/blockedDatesForPeriod?"+b).query(h);var d=i(),e=new Date(d.startDate),f=new Date(d.endDate);a.firstDateForCurrentRange=e.setDate(d.startDate.getDate()-1),a.lastDateForCurrentRange=f.setDate(d.endDate.getDate()+1),a.studyPeriodStartDate=new Date(d.startDate.getTime()),a.studyPeriodEndDate=new Date(d.endDate.getTime())}a.setEndDateMinDate()}var k=e.current.params.id;a.formState={};var l="/timetables",m=[],n=c.endpoint(l);a.lastDateForCurrentRange=Date.now(),a.firstDateForCurrentRange=Date.now(),k?(a.timetable=n.get({id:k}),a.timetable.$promise.then(function(){a.formState.studyYears=a.timetable.studyYears,a.allStudyPeriods=a.timetable.studyPeriods;var b=d.getCurrentStudyYearOrPeriod(a.formState.studyYears),c=d.getCurrentStudyYearOrPeriod(a.timetable.studyPeriods);a.timetable.studyYear=b.id,a.formState.studyPeriods=a.allStudyPeriods.filter(function(b){return b.studyYear===a.timetable.studyYear}),a.timetable.studyPeriod=c.id,a.timetable.studyYears=null,a.timetable.currentStudyPeriod=null,a.timetable.studyPeriods=null})):(a.timetable=new n,a.timetable.code=e.current.params.type,a.timetable.startDate=e.current.params.from?new Date(e.current.params.from):null,a.timetable.endDate=e.current.params.thru?new Date(e.current.params.thru):null,c.endpoint(l+"/managementSearchFormData").search().$promise.then(function(b){if(a.formState.studyYears=b.studyYears,a.allStudyPeriods=b.studyPeriods,!a.timetable.studyYear){var c,e;a.timetable.startDate?(d.getCurrentStudyYearOrPeriod(a.formState.studyYears),e=d.getStudyYearOrPeriodAt(a.timetable.startDate,b.studyPeriods)):(c=d.getCurrentStudyYearOrPeriod(a.formState.studyYears),e=d.getCurrentStudyYearOrPeriod(b.studyPeriods)),c&&a.allStudyPeriods&&(a.timetable.studyYear=c.id,a.formState.studyPeriods=a.allStudyPeriods.filter(function(b){return b.studyYear===a.timetable.studyYear}),a.timetable.studyPeriod=e.id)}})),a.studyYearChanged=function(){g(a.timetable.studyYear,a.timetable.studyPeriod)||(a.timetable.studyPeriod=null)},a.$watch("timetable.startDate",function(){var b=a.timetable.startDate;if(void 0===b)a.lastDateForCurrentRange=Date.now();else{m.sort(function(a,b){return a-b});for(var c=0;c<m.length;c++)if(m[c]>=b.getTime()){a.lastDateForCurrentRange=m[c];break}if(angular.isObject(b)&&a.lastDateForCurrentRange<b.getTime()){var d=new Date(i().endDate);a.lastDateForCurrentRange=d.setDate(d.getDate()+1)}}a.setEndDateMinDate()}),a.$watch("timetable.endDate",function(){var b=a.timetable.endDate;if(m=m.sort().reverse(),void 0===b){var c=i();void 0!==c&&(a.firstDateForCurrentRange=c.startDate)}else for(var d=0;d<m.length;d++)if(m[d]<=b.getTime()){a.firstDateForCurrentRange=m[d];break}m=m.sort()}),a.$watch("timetable.studyPeriod",function(){a.timetable.studyPeriod&&j()}),a.blockedFromDatesPredicate=function(b){return 0!==m.length&&-1!==m.indexOf(b.getTime())||b.getTime()<a.firstDateForCurrentRange?!1:!0},a.setEndDateMinDate=function(){a.endDateMinDate=a.timetable.startDate?a.timetable.startDate:a.studyPeriodStartDate},a.blockedThruDatesPredicate=function(b){return 0!==m.length&&-1!==m.indexOf(b.getTime())||b.getTime()>a.lastDateForCurrentRange?!1:!0},a.$watch("timetable.studyYear",function(){a.timetable.studyYear&&a.allStudyPeriods&&(a.formState.studyPeriods=a.allStudyPeriods.filter(function(b){return b.studyYear===a.timetable.studyYear}))}),a.save=function(){return a.timetableForm.$setSubmitted(),a.timetableForm.$valid?void(angular.isDefined(k)?(a.timetable.$update({id:k}).then(function(){b.info("main.messages.update.success")}),f.url("/timetable/"+k+"/view")):a.timetable.$save().then(function(a){b.info("timetable.timetableManagement.created"),f.url("/timetable/"+a.id+"/view")})):void b.error("main.messages.form-has-errors")}}]).controller("TimetableViewController",["$scope","message","QueryUtils","DataUtils","$route","$location","$rootScope","Classifier","USER_ROLES","AuthService",function(a,b,c,d,e,f,g,h,i,j){a.timetableId=e.current.params.id,a.currentLanguageNameField=g.currentLanguageNameField;var k=h.valuemapper({curriculumStudyLevelCode:"OPPEASTE"});a.canConfirm=j.isAuthorized(i.ROLE_OIGUS_K_TEEMAOIGUS_TUNNIPLAAN),c.endpoint("/timetables/:id/view").search({id:a.timetableId},function(b){k.objectmapper(b.curriculums),a.timetable=b,a.timetable.endDate=new Date(a.timetable.endDate),a.timetable.startDate=new Date(a.timetable.startDate)}),a.confirm=function(){c.endpoint("/timetables/"+a.timetableId+"/confirm").put({},function(){e.reload()})},a.publicize=function(){c.endpoint("/timetables/"+a.timetableId+"/publicize").put({},function(){e.reload()})}}]),angular.module("hitsaOis").controller("VocationalTimetablePlanController",["$scope","message","QueryUtils","DataUtils","$route","$location","$rootScope","Classifier","dialogService","ArrayUtils",function(a,b,c,d,e,f,g,h,i,j){function k(b,c,d){a.capacityTypes=b.timetableCapacities;var e=a.plan.displayPeriodLessons?a.plan.displayPeriodLessons:!1,f=a.plan.displayLeftOverLessons?a.plan.displayLeftOverLessons:!1;if(a.plan=b,a.plan.selectAll=!1,a.plan.displayPeriodLessons=e,a.plan.displayLeftOverLessons=f,a.plan.journals.sort(function(a,b){return a.id-b.id}),a.plan.journals.forEach(function(a){a.teachersString=a.teachers.map(function(a){return a.nameEt}).join(", ")}),h.setSelectedCodes(a.plan.studentGroups,a.plan.studentGroups.map(function(a){return a.code})),d){a.plan.currentStudentGroups=d;var g=d.map(function(a){return a.code});a.plan.studentGroups.forEach(function(b){-1===g.indexOf(b.code)&&(b._selected=!1,a.plan.selectAll=!1)})}else a.plan.currentStudentGroups=a.plan.studentGroups,a.plan.currentStudentGroups.forEach(function(b){b.id!==Number(c)&&(b._selected=!1,a.plan.selectAll=!1)});p(a.plan.studentGroupCapacities,a.plan.studentGroups,a.plan.journals),a.plan.datesForTimetable=[];for(var i=new Date(a.plan.startDate),j=new Date(a.plan.endDate),k=i;j>=k;)a.plan.datesForTimetable.push(k),k=new Date(k.getTime()+864e5);a.plan.lessonTimes.sort(function(a,b){return a.lessonNr-b.lessonNr}),a.lessonsInDay=[];for(var m=0;a.weekday.length>m;m++){var n=a.weekday[m];a.lessonsInDay[n]=a.plan.lessonTimes.filter(function(a){return a[n]===!0});for(var o=[],q=a.lessonsInDay[n].length-1,s=a.lessonsInDay[n];q>=0;)o.includes(s[q].lessonNr)?s.splice(q,1):o.push(s[q].lessonNr),q-=1}for(a.lessonsInDay.sort(function(b,c){return a.weekday.indexOf(b)-a.weekday.indexOf(c)}),a.firstDay=a.weekday[new Date(a.plan.startDate).getDay()],a.dayOrder=a.weekday.slice();a.dayOrder[0]!==a.firstDay;)a.dayOrder[a.dayOrder.length-1]=a.dayOrder.shift();var t=moment(a.plan.endDate).diff(moment(a.plan.startDate),"days")+1;a.dayOrder=a.dayOrder.slice(0,t),a.currentLessonTimes=[];for(var u=0;a.dayOrder.length>u;u++){for(var v=a.lessonsInDay[a.dayOrder[u]].slice(),w=!1;angular.isDefined(v)&&v.length>0;){w=!0;var x=angular.copy(v.shift());0===v.length&&(x.endOfDay=!0),a.currentLessonTimes.push(x)}w||a.currentLessonTimes.push({noLessons:!0,endOfDay:!0})}for(var y={},z={},A=0;a.plan.plannedLessons.length>A;A++){var B=a.plan.plannedLessons[A].studentGroup;angular.isDefined(y[B])||(y[B]={},y[B].id=B,y[B].lessons=[]),y[B].lessons.push(a.plan.plannedLessons[A]),angular.isArray(a.plan.plannedLessons[A].teachers)&&a.plan.plannedLessons[A].teachers.forEach(function(b){angular.isArray(z[b])||(z[b]=[]);var c=z[b].find(function(b){return b.id===a.plan.plannedLessons[A].id});c||z[b].push(a.plan.plannedLessons[A])})}a.plan.plannedLessonsByTeachers=z,a.plan.plannedLessonsByGroup=y,a.plan.selectedGroup=c,l(),r?r=!1:a.updateGroups()}function l(){if(angular.isDefined(a.plan.selectedGroup)){a.plan.currentCapacities=a.plan.studentGroupCapacities.filter(function(b){return b.studentGroup===a.plan.selectedGroup}),a.plan.currentCapacities=a.plan.currentCapacities.sort(function(a,b){return a.journal-b.journal});var b=a.plan.currentCapacities.map(function(a){return a.journal});a.plan.currentCapacitiesGrouped=q(a.plan.currentCapacities,"journal"),angular.isDefined(a.plan.journals)&&(a.plan.journals.forEach(function(b,c){b.color=a.journalColors[c%19]}),a.plan.currentJournals=a.plan.journals.filter(function(a){return-1!==b.indexOf(a.id)})),a.plan.selectedStudentGroupObject=a.plan.studentGroups.find(function(b){return b.id===a.plan.selectedGroup})}}function m(a,b){for(var c=0;c<a.length;c++)if(a[c][b]>0)return!0;return!1}function n(b,d){c.endpoint(s+"/saveVocationalEvent").save(b).$promise.then(function(b){k(b,d,a.plan.currentStudentGroups)})}function o(){a.plan.selectAll=!0,a.plan.studentGroups.forEach(function(b){b._selected||(a.plan.selectAll=!1)})}function p(a,b,c){angular.isArray(a)&&angular.isArray(b)&&b.forEach(function(b){b.teachers=[],b.teacherIds=[];var d=a.filter(function(a){return a.studentGroup===b.id});d.forEach(function(a){var d=c.find(function(b){return b.id===a.journal});d.teachers.forEach(function(a){-1===b.teacherIds.indexOf(a.id)&&(b.teacherIds.push(a.id),b.teachers.push(a))})})})}function q(a,b){for(var c,d,e=[],f=[],g=0;g<a.length;g++)c=a[g][b],d=e.indexOf(c),d>-1?f[d].push(a[g]):(e.push(c),f.push([a[g]]));return f}a.auth=e.current.locals.auth;var r=!1;a.Math=window.Math,a.isArray=angular.isArray,a.journalColors=["#ffff00","#9fff80","#ff99cc","#E8DAEF","#85C1E9","#D1F2EB","#ABEBC6","#F9E79F","#FAD7A0","#EDBB99","#D5DBDB","#64B5F6","#B0BEC5","#80CBC4","#FCD4F5","#AFBAF7","#FFF59D","#66BB6A","#E6EE9C","#9FA8DA","#EF9A9A"],a.plan={},a.timetableId=e.current.params.id,a.weekday=["daySun","dayMon","dayTue","dayWed","dayThu","dayFri","daySat"];var s="/timetables";a.currentLanguageNameField=g.currentLanguageNameField,c.loadingWheel(a,!0),c.endpoint(s+"/:id/createVocationalPlan").search({id:a.timetableId}).$promise.then(function(b){k(b,e.current.params.groupId,null),c.loadingWheel(a,!1)}),a.$watch("plan.selectedGroup",function(){l()}),a.selectAllChanged=function(){angular.isDefined(a.plan.selectAll)&&(a.plan.selectAll?h.setSelectedCodes(a.plan.studentGroups,a.plan.studentGroups.map(function(a){return a.code})):h.setSelectedCodes(a.plan.studentGroups,[]),a.updateGroups())},a.displayPeriodLessonsChanged=function(){a.plan.displayLeftOverLessons=!1},a.displayLeftOverLessonsChanged=function(){a.plan.displayPeriodLessons=!1},a.orderBySelectedGroup=function(b){return b.id!==a.plan.selectedGroup},a.getTotalsByJournal=function(b,c){var d=a.plan.currentCapacities.filter(function(a){return a.journal===b.id}),e=0;return d.forEach(function(a){e+=a[c]}),e},a.showJournalPlannedLessons=function(b){return a.plan.displayPeriodLessons||a.plan.displayLeftOverLessons?a.plan.displayPeriodLessons?a.getTotalsByJournal(b,"totalPlannedLessons")>0:a.plan.displayLeftOverLessons?a.getTotalsByJournal(b,"totalPlannedLessons")>0||a.getTotalsByJournal(b,"leftOverLessons")>0:!1:a.getTotalsByJournal(b,"thisPlannedLessons")>0},a.showCurrentCapacitiesGrouped=function(b){return a.plan.displayPeriodLessons||a.plan.displayLeftOverLessons?a.plan.displayPeriodLessons?m(b,"totalPlannedLessons"):a.plan.displayLeftOverLessons?m(b,"totalPlannedLessons")||m(b,"leftOverLessons"):!1:m(b,"thisPlannedLessons")},a.isUnderAllocatedWeekLessons=function(b){return a.getTotalsByJournal(b,"thisPlannedLessons")>=a.getTotalsByJournal(b,"thisPlannedLessons")-a.getTotalsByJournal(b,"lessonsLeft")?!0:!1},a.isUnderAllocatedTotalLessons=function(b){return a.getTotalsByJournal(b,"totalPlannedLessons")>=a.getTotalsByJournal(b,"totalAllocatedLessons")?!0:!1},a.isUnderLeftOverTotalLessons=function(b){return a.getTotalsByJournal(b,"totalPlannedLessons")+a.getTotalsByJournal(b,"leftOverLessons")>=a.getTotalsByJournal(b,"totalAllocatedLessons")?!0:!1},a.getByCapacity=function(b,c){var d=a.plan.currentJournals.find(function(a){return a.id===b.journal});return d[c]},a.getCapacityTypeValue=function(b){var c=a.capacityTypes.find(function(a){return a.code===b});return null!==c&&angular.isDefined(c)?c.value.toUpperCase():""},a.getCapacityType=function(b){return a.capacityTypes.find(function(a){return a.code===b})},a.getCountForCapacity=function(a){return a.thisAllocatedLessons=0,a.thisPlannedLessons-a.thisAllocatedLessons},a.getRoomCodes=function(a){return a.map(function(a){return a.nameEt}).join("-")},a.getEventsForLesson=function(b,c,d){for(var e,f=0,g=0;a.dayOrder.length>g;g++)if(f+=a.lessonsInDay[a.dayOrder[g]].length,f>b){e=a.dayOrder[g];break}if(angular.isDefined(a.plan.plannedLessonsByGroup)&&angular.isDefined(a.plan.plannedLessonsByGroup[d.id])){var h=a.plan.plannedLessonsByGroup[d.id].lessons.filter(function(b){return a.weekday[new Date(b.start).getDay()]===e&&c.lessonNr===b.lessonNr});if(0!==h.length)return h.forEach(function(b){b.journalObject=a.plan.journals.filter(function(a){return a.id===b.journal})[0];var d=a.plan.lessonTimes.filter(function(a){return a[e]===!0&&a.lessonNr===c.lessonNr});if(d.length>1){var f=d.reduce(function(a,b){return a.constructor===Array?a.concat(b.buildingIds):a.buildingIds.concat(b.buildingIds)});f&&(b.buildingIds=f.filter(function(a,b,c){return c.indexOf(a)===b}))}else b.buildingIds=d[0].buildingIds;angular.isArray(b.teachers)||(b.teachers=[]),b.journalObject&&b.journalObject.teachers&&(b.currentTeacherIds=b.journalObject.teachers.filter(function(a){return-1!==b.teachers.indexOf(a.id)}),b.currentTeachers=b.currentTeacherIds.map(function(a){return a.nameEt}))}),h}return null},a.getTeacherLesson=function(b,c,d,e){for(var f,g=0,h=0;a.dayOrder.length>h;h++)if(g+=a.lessonsInDay[a.dayOrder[h]].length,g>b){f=a.dayOrder[h];break}var i=[];return d.teachers.forEach(function(b){if(angular.isDefined(a.plan.plannedLessonsByTeachers)&&a.plan.plannedLessonsByTeachers[b.id]){var d=a.plan.plannedLessonsByTeachers[b.id].find(function(b){return a.weekday[new Date(b.start).getDay()]===f&&c.lessonNr===b.lessonNr});d&&(e?i.push(b.nameEt):i.push(b.nameEt.replace(/\b(\S{1,2})\S*/g,"$1").replace(/ /g,"")))}}),i?i:null},a.removeFromArray=j.remove,a.changeEvent=function(d){var e=a.plan.selectedGroup;i.showDialog("timetable/timetable.event.change.dialog.html",function(f){f.displayPeriodLessons=a.plan.displayPeriodLessons,f.displayLeftOverLessons=a.plan.displayLeftOverLessons,f.occupiedTime=[],f.lesson=d,f.teachers=d.journalObject.teachers,f.teachers.forEach(function(a){angular.isArray(d.teachers)?a.isTeaching=d.teachers.includes(a.id):a.isTeaching=!0,a.capacity=(a.capacities||[]).filter(function(a){return a.capacityType===d.capacityType})[0]}),f.lessonHeader=d.journalObject.name,f.lessonCapacityName=a.getCapacityType(d.capacityType),f.lesson.startTime=new Date(d.start),f.lesson.endTime=new Date(d.end),d.rooms?f.lesson.eventRooms=angular.copy(d.rooms):f.lesson.eventRooms=[],f.$watch("lesson.eventRoom",function(){if(angular.isDefined(f.lesson.eventRoom)&&null!==f.lesson.eventRoom){if(f.lesson.eventRooms.some(function(a){return a.id===f.lesson.eventRoom.id}))return b.error("timetable.timetablePlan.duplicateroom"),void(f.lesson.eventRoom=void 0);f.lesson.eventRooms.push(f.lesson.eventRoom),f.lesson.eventRoom=null}}),f.isUnderAllocatedWeekLessons=function(a){return a.thisPlannedLessons>=a.thisPlannedLessons-a.lessonsLeft?!0:!1},f.isUnderAllocatedTotalLessons=function(a){return a.totalPlannedLessons>=a.totalAllocatedLessons?!0:!1},f.isUnderLeftOverTotalLessons=function(a){return a.totalPlannedLessons+a.leftOverLessons>=a.totalAllocatedLessons?!0:!1},f.$watchGroup(["lesson.eventRooms.length","lesson.startTime","lesson.endTime"],function(){var a={startTime:f.lesson.startTime,endTime:f.lesson.endTime,timetableEventId:f.lesson.id};a.rooms=f.lesson.eventRooms.reduce(function(a,b){return a.push(b.id),a},[]),a.teachers=f.teachers.reduce(function(a,b){return b.isTeaching&&a.push(b.id),a},[]),c.endpoint("/timetableevents/timetableTimeOccupied").get(a).$promise.then(function(a){f.occupiedTime=a})}),f.isRoomOccupied=function(a){return f.occupiedTime&&f.occupiedTime.rooms?f.occupiedTime.rooms.filter(function(b){return b.id===a}).length>0:!1},f.isTeacherOccupied=function(a){return f.occupiedTime&&f.occupiedTime.teachers?f.occupiedTime.teachers.filter(function(b){return b.id===a}).length>0:!1},f.deleteEvent=function(b){r=!0,c.endpoint(s+"/deleteVocationalEvent").save({timetableEventId:b}).$promise.then(function(b){k(b,e,a.plan.currentStudentGroups),f.cancel()})},f.saveEvent=function(){return f.lesson.startTime>f.lesson.endTime?void b.error("timetable.timetableEvent.error.endIsEarlierThanStart"):void f.submit()}},function(b){var d={startTime:b.lesson.startTime,endTime:b.lesson.endTime,rooms:b.lesson.eventRooms,timetableEventId:b.lesson.id,teachers:b.teachers.reduce(function(a,b){return b.isTeaching&&a.push(b.id),a},[])};r=!0,c.endpoint(s+"/saveVocationalEventRoomsAndTimes").save(d).$promise.then(function(b){k(b,e,a.plan.currentStudentGroups)})})},a.saveEvent=function(b){r=!0;for(var e,f=a.plan.selectedGroup,g=0,h=0;a.dayOrder.length>h;h++)if(g+=a.lessonsInDay[a.dayOrder[h]].length,b.index<g){e=a.dayOrder[h];break}var j=b.journalId,l={journal:j,timetable:a.timetableId,lessonTime:this.lessonTime.id,selectedDay:e,oldEventId:b.oldEventId,capacityType:b.capacityType},m={journal:j,timetable:a.timetableId,lessonTime:this.lessonTime.id,selectedDay:e,oldEventId:b.oldEventId};c.endpoint("/timetableevents/timetableNewVocationalTimeOccupied").get(m).$promise.then(function(b){b.occupied?i.confirmDialog(d.occupiedEventTimePrompts(a,a.auth.higher,b),function(){n(l,f)},function(){r=!1,c.loadingWheel(a,!0),c.endpoint(s+"/:id/createVocationalPlan").search({id:a.timetableId}).$promise.then(function(b){k(b,f,a.plan.currentStudentGroups),c.loadingWheel(a,!1)})}):n(l,f)})},a.range=function(a){for(var b=[],c=0;a>c;c++)b.push(c);return b},a.updateGroups=function(){var b=h.getSelectedCodes(a.plan.studentGroups);a.plan.currentStudentGroups=a.plan.studentGroups.filter(function(a){return-1!==b.indexOf(a.code)}),o(),a.$broadcast("refreshFixedColumns")}}]),angular.module("hitsaOis").controller("HigherTimetablePlanController",["$scope","message","QueryUtils","DataUtils","$route","$location","$rootScope","Classifier","dialogService","$filter","$translate",function(a,b,c,d,e,f,g,h,i,j,k){function l(b){a.capacityTypes=b.timetableCapacities,a.plan=b,a.plan.selectAll=!0,a.plan.capacitiesGrouped=D(a.plan.studentGroupCapacities,"subjectStudyPeriod"),a.plan.colorsBySubjectStudyPeriods=[],a.plan.capacitiesGrouped.forEach(function(b,c){a.plan.colorsBySubjectStudyPeriods.push({subjectStudyPeriod:b[0].subjectStudyPeriod,color:a.colors[c%19]})}),a.plan.currentStudentGroups=a.plan.studentGroups;var c=s();a.plan.selectedWeek=s()?c:a.plan.weeks[0].start,a.plan.weeks.forEach(function(a){a.startDisplay=j("hoisDate")(a.start)}),a.plan.subjectTeacherPairs.forEach(function(a){a.isSubjectTeacherPair=!0,a.dropdownValue="PAIR-"+a.id,a.originalCode=a.code,a.code=a.code+" - "+a.teacherNamesShort}),a.plan.studentGroups.forEach(function(a){a.dropdownValue="GROU-"+a.id}),m(),B(!0),t(),w(),A(a.plan.studentGroups,!1),A(a.plan.subjectTeacherPairs,!1),z(a.plan.studentGroupCapacities,a.plan.studentGroups),q(),e.current.params.groupId?a.plan.selectedGroup="GROU-"+e.current.params.groupId:e.current.params.pairId&&(a.plan.selectedGroup="PAIR-"+e.current.params.pairId)}function m(b){angular.isDefined(b)&&(angular.isDefined(b.teacherNamesShort)?a.plan.currentCapacities=a.plan.studentGroupCapacities.filter(function(a){return a.subjectStudyPeriod===b.id}):a.plan.currentCapacities=a.plan.studentGroupCapacities.filter(function(a){return a.studentGroup===b.id}),a.plan.currentCapacities=a.plan.currentCapacities.sort(function(a,b){return a.capacityType-b.capacityType}),a.plan.currentCapacitiesGrouped=D(a.plan.currentCapacities,"subjectStudyPeriod"))}function n(b,d){c.endpoint(H+"/saveHigherEventRoomsAndTimes").save(b).$promise.then(function(b){var c;c=d.isSubjectTeacherPair?b.subjectTeacherPairs.find(function(a){return a.id===d.subjectStudyPeriod}):b.studentGroups.find(function(a){return a.id===d.studentGroup}),A([c],!0),a.plan.studentGroupCapacities=b.studentGroupCapacities,u(),v()})}function o(b,d,e,f){var g={timetable:a.timetableId,oldEventId:b.oldEventId,startTime:f,capacityType:b.capacityType,subjectStudyPeriod:b.journalId,studentGroupId:a.plan.selectedGroup.substr(5),repeatCode:a.plan.repeatCode,lessonAmount:a.plan.lessonAmount,room:a.plan.eventRoom,isSubjectTeacherPair:e,isForAllGroups:d};c.endpoint(H+"/saveHigherEvent").save(g).$promise.then(function(a){p(a,d,e)})}function p(b,c,d){var e;e=d?b.subjectTeacherPairs.find(function(b){return b.id===Number(a.plan.selectedGroup.substr(5))}):b.studentGroups.find(function(b){return b.id===Number(a.plan.selectedGroup.substr(5))}),c&&A(b.studentGroups,!1),A([e],!0),a.plan.studentGroupCapacities=b.studentGroupCapacities,u(),v()}function q(){var b=r();b.sort(function(a,b){return a.code<b.code?-1:a.code>b.code?1:0}),a.plan.currentStudentGroups=b}function r(){var b=[];return a.plan.studentGroups.concat(a.plan.subjectTeacherPairs).forEach(function(a){a._selected&&b.push(a)}),b}function s(){for(var b=new Date,c=0;c<a.plan.weeks.length;c++)if(b.getTime()<new Date(a.plan.weeks[c].end).getTime())return a.plan.weeks[c].start}function t(){a.plan.datesForTimetable=[];var b=new Date(a.plan.selectedWeek),c=new Date(b);c.setDate(b.getDate()+6);for(var d=b;c>=d;)a.plan.datesForTimetable.push(d),d=new Date(d.getTime()+864e5)}function u(){w(),C(a.plan.lessonTimeBuilding),A(a.plan.studentGroups,!1),A(a.plan.subjectTeacherPairs,!1)}function v(){if(angular.isDefined(a.plan.selectedGroup)){var b=a.plan.currentStudentGroups.find(function(b){return b.dropdownValue===a.plan.selectedGroup});m(b),A([b],!0),a.plan.selectedStudentGroupObject=b}}function w(){a.totalLessons=0,a.lessonsInDay={},a.dayTimeRanges={},a.currentLessonTimes=[];for(var b=0;b<a.plan.datesForTimetable.length;b++){var c=a.plan.datesForTimetable[b],d=x(c),e=0;if(null!==d){var f=new Date(new Date(c.getTime()));f.setHours(d.start.getHours()),f.setMinutes(d.start.getMinutes());var g=new Date(f.getTime());for(g.setHours(d.end.getHours()),g.setMinutes(d.end.getMinutes()),a.dayTimeRanges[c]={start:f,end:g};f.getTime()<g.getTime();){var h=new Date(f.getTime()+F);a.currentLessonTimes.push({time:f,endOfDay:h.getTime()>=g.getTime()}),e+=1,f=h}}a.totalLessons+=e,a.lessonsInDay[c]=e}}function x(b){var c=a.weekday[b.getDay()],d=[],e=[];a.plan.lessonTimes.filter(function(a){return a[c]}).forEach(function(a){d.push(moment(a.startTime,"HH:mm")),e.push(moment(a.endTime,"HH:mm"))});var f=[],g=y(a.plan.studentGroups,b),h=y(a.plan.subjectTeacherPairs,b);if(f=f.concat(g),f=f.concat(h),f.forEach(function(a){var b=new Date(a.start),c=new Date(a.end);d.push(moment({hour:b.getHours(),minute:b.getMinutes()})),e.push(moment({hour:c.getHours(),minute:c.getMinutes()}))}),0===d.length||0===e.length)return null;var i=moment.min(d).toDate();i.setHours(Math.max(7,i.getHours())),i.setMinutes(0),i.setSeconds(0,0);var j=moment.max(e).toDate();return j.setHours(Math.min(23,j.getMinutes()>0?j.getHours()+1:j.getHours())),j.setMinutes(0),j.setSeconds(0,0),{start:i,end:j}}function y(a,b){var c=[];return a.forEach(function(a){if(a.lessons){var e=a.lessons.filter(function(a){return d.isSameDay(b,new Date(a.start))});c=c.concat(e)}}),c}function z(a,b){angular.isArray(a)&&angular.isArray(b)&&b.forEach(function(b){b.teachers=[],b.teacherIds=[];var c=a.filter(function(a){return a.studentGroup===b.id});c.forEach(function(a){a.teachers.forEach(function(a){-1===b.teacherIds.indexOf(a.id)&&(b.teacherIds.push(a.id),b.teachers.push(a))})})})}function A(b,c){if(b)for(var e=0;e<b.length;e++){var f=b[e].isSubjectTeacherPair,g=b[e].lessons;if(null!==g)for(var h=0;h<g.length;h++)g[h].start=new Date(g[h].start),g[h].end=new Date(g[h].end);else g=[];for(var i={},j=0;j<a.plan.datesForTimetable.length;j++){var k=a.dayTimeRanges[a.plan.datesForTimetable[j]];if(k){var l=new Date(k.start),m=new Date(k.end),n=g.filter(function(a){return d.isSameDay(a.start,l)});n=n.sort(function(a,b){return a.start.getTime()-b.start.getTime()});var o=l.getDate()+l.getMonth()+l.getFullYear(),p=0;angular.isArray(i[o])||(i[o]=[]);var q=0;if(n.length>0)for(var r=0;r<n.length;r++){q=0;var s=n[r],t=0;if(!(s.start.getHours()<7||s.end.getHours()<7||23===s.start.getHours())){if(c)for(;l.getTime()<s.start.getTime();)i[o].push({start:new Date(l.getTime()),colspan:1,isSubjectTeacherPair:f,subjectStudyPeriod:s.subjectStudyPeriod}),l=new Date(l.getTime()+F);else s.start.getTime()>=l.getTime()&&(t=(s.start.getTime()-l.getTime())/F,i[o].push({start:new Date(l.getTime()),colspan:t}));if(s.start.getTime()<=l.getTime()){s.colspan=(s.end.getTime()-s.start.getTime())/F,s.marginleft=(s.start.getTime()-l.getTime())/F;var u=i[o].filter(function(a){return s.start.getTime()>=a.start.getTime()&&s.start.getTime()<a.start.getTime()+a.colspan*F});if(u.length>p){var v=i[o][i[o].length-1];i[o].length>0&&v.topmargin?s.topmargin=v.topmargin+G:s.topmargin=G,p+=1}else p=0}else s.colspan=(s.end.getTime()-s.start.getTime())/F;if(s.end.getTime()>=m.getTime()&&(s.colspan-=(s.end.getTime()-m.getTime())/F),i[o].push(s),l.getTime()<s.end.getTime()&&(l=new Date(s.end.getTime())),n.length-1===r)if(c)for(;m.getTime()>l.getTime();)i[o].push({start:new Date(l.getTime()),colspan:1,isSubjectTeacherPair:f,subjectStudyPeriod:s.subjectStudyPeriod}),l=new Date(l.getTime()+F);else t=(m.getTime()-l.getTime())/F,i[o].push({start:new Date(l.getTime()),colspan:t});q++}}if(0===q)if(c)for(;l.getTime()<m.getTime();)i[o].push({start:new Date(l.getTime()),colspan:1,isSubjectTeacherPair:f}),l=new Date(l.getTime()+F);else{var w=(m.getTime()-l.getTime())/F;i[o].push({start:new Date(l.getTime()),colspan:w})}}}var x;if(angular.isDefined(b[e].teacherNamesShort)){for(var y in i)i[y].forEach(function(a){a.isSubjectTeacherPair=!0});x=a.plan.subjectTeacherPairs.find(function(a){return a.id===b[e].id})}else x=a.plan.studentGroups.find(function(a){return a.id===b[e].id});x.currentLessons=i,x.lessons=b[e].lessons}}function B(b){a.plan.studentGroups.concat(a.plan.subjectTeacherPairs).forEach(function(a){a._selected=b})}function C(b){if(angular.isDefined(a.plan.datesForTimetable)&&a.plan.datesForTimetable.length>0){var c=a.dayTimeRanges[a.plan.datesForTimetable[0]];if(!c)return;var d=new Date(c.start);a.lessonTimeLegend=[];for(var e=0;e<a.plan.datesForTimetable.length;e++){var f=0,g=a.plan.datesForTimetable[e],h=a.weekday[g.getDay()],i=a.plan.lessonTimes.filter(function(a){return a[h]===!0&&a.buildingIds.includes(Number(b))&&(Number(a.startTime.substr(0,2))<23||7===Number(a.startTime.substr(0,2))&&0===Number(a.startTime.substr(3,2)))&&(Number(a.endTime.substr(0,2))&&0===Number(a.endTime.substr(3,2))||Number(a.endTime.substr(0,2))<23)});i.forEach(function(a){a.lessonDateStart=new Date(g.getTime()),a.lessonDateStart.setHours(a.startTime.substr(0,2),a.startTime.substr(3,2)),a.lessonDateEnd=new Date(g.getTime()),a.lessonDateEnd.setHours(a.endTime.substr(0,2),a.endTime.substr(3,2))}),i=i.sort(function(a,b){return a.lessonDateStart.getTime()-b.lessonDateStart.getTime()});for(var j=0;j<i.length;j++){f=0;var k=i[j];j>0&&k.lessonDateStart.getTime()<i[j-1].lessonDateEnd.getTime()&&k.lessonDateEnd.getTime()<=i[j-1].lessonDateEnd.getTime()||(k.lessonDateStart.getTime()>d.getTime()&&(f=Math.round((k.lessonDateStart.getTime()-d.getTime())/F),a.lessonTimeLegend.push({colspan:f})),f=j>0&&k.lessonDateStart.getTime()<i[j-1].lessonDateEnd.getTime()?Math.round((i[j-1].lessonDateEnd.getTime()-k.lessonDateEnd.getTime())/F):Math.round((k.lessonDateEnd.getTime()-k.lessonDateStart.getTime())/F),a.lessonTimeLegend.push({lessonNr:k.lessonNr,colspan:f}),k.lessonDateEnd.getTime()>d.getTime()&&(d=new Date(k.lessonDateEnd.getTime())))}var l=new Date(a.dayTimeRanges[a.plan.datesForTimetable[e]].end);for(f=Math.round((l.getTime()-d.getTime())/F),f>0?a.lessonTimeLegend.push({colspan:f,endOfDay:!0}):a.lessonTimeLegend[a.lessonTimeLegend.length-1]&&(a.lessonTimeLegend[a.lessonTimeLegend.length-1].endOfDay=!0);e<a.plan.datesForTimetable.length-1;){if(a.dayTimeRanges[a.plan.datesForTimetable[e+1]]){d=new Date(a.dayTimeRanges[a.plan.datesForTimetable[e+1]].start);break}e++}}}}function D(a,b){for(var c,d,e=[],f=[],g=0;g<a.length;g++)c=a[g][b],d=e.indexOf(c),d>-1?f[d].push(a[g]):(e.push(c),f.push([a[g]]));return f}a.auth=e.current.locals.auth;var E=6e4,F=15*E,G=17;a.colors=["#ffff00","#9fff80","#ff99cc","#E8DAEF","#85C1E9","#D1F2EB","#ABEBC6","#F9E79F","#FAD7A0","#EDBB99","#D5DBDB","#64B5F6","#B0BEC5","#80CBC4","#BCAAA4","#7986CB","#FFF59D","#66BB6A","#E6EE9C","#9FA8DA","#EF9A9A"],a.plan={},a.timetableId=e.current.params.id,a.weekday=["daySun","dayMon","dayTue","dayWed","dayThu","dayFri","daySat"];var H="/timetables";a.currentLanguageNameField=g.currentLanguageNameField,k.onReady(function(){a.loaded=!0}),c.endpoint(H+"/:id/createHigherPlan").search({id:a.timetableId},l),a.$watch("plan.selectedGroup",function(){v()}),a.$watch("plan.selectAll",function(){angular.isDefined(a.plan.selectAll)&&(B(a.plan.selectAll),q())}),a.orderBySelectedGroup=function(b){return b.dropdownValue!==a.plan.selectedGroup},a.$watch("plan.selectedWeek",function(){t(),u(),v()}),a.$watch("plan.lessonTimeBuilding",function(){C(a.plan.lessonTimeBuilding)}),a.getTeachersString=function(a){return a.map(function(a){return a.nameEt}).join(", ")},a.getColorBySubjectStudyPeriod=function(b){var c=a.plan.colorsBySubjectStudyPeriods.find(function(a){return a.subjectStudyPeriod===b});return c?c.color:""},a.getCapacityTypeValue=function(b){var c=a.capacityTypes.find(function(a){return a.code===b});return null!==c&&angular.isDefined(c)?c.value.toUpperCase():""},a.getCapacityType=function(b){return a.capacityTypes.find(function(a){return a.code===b})},a.getCountForCapacity=function(a){return a.thisAllocatedLessons=0,a.thisPlannedLessons-a.thisAllocatedLessons},a.getRoomCodes=function(a){return a.map(function(a){return a.nameEt}).join("-")},a.boldAndRed=function(a){return angular.isArray(a)&&(a=0===a.length?!0:!1),!angular.isDefined(a)||null===a||a?{"font-weight":"bold",color:"red"}:""},a.isUnderAllocatedLessons=function(a){var b=a.totalAllocatedLessons?a.totalAllocatedLessons:0;return a.totalPlannedLessons>=b?!0:!1},a.lessonTimeStyle=function(b){var c=Object.keys(a.lessonsInDay),e=c.find(function(a){return a=new Date(a),d.isSameDay(a,b.start)}),f=a.lessonsInDay[e],g={};return g["background-color"]=b.id?a.getColorBySubjectStudyPeriod(b.subjectStudyPeriod):"transparent",g.width=(100/f*b.colspan).toString()+"%",b.marginleft&&(g["margin-left"]=(100/f*b.marginleft).toString()+"%"),b.topmargin&&(g["margin-top"]=b.topmargin.toString()+"px"),b.id||(g.height="100%"),
g},a.getEventForLessonTime=function(a,b){var c;return null!==b&&(c=b.find(function(b){return new Date(b.start).getTime()===a.getTime()})),c},a.changeEvent=function(d){if(d.id){var e=a.plan.studentGroupCapacities.find(function(a){return a.subjectStudyPeriod===d.subjectStudyPeriod&&a.capacityType===d.capacityType});i.showDialog("timetable/timetable.event.change.dialog.html",function(f){f.lesson=d,f.teachers=e.teachers,f.teachers.forEach(function(a){angular.isArray(d.teachers)?a.isTeaching=d.teachers.includes(a.id):a.isTeaching=!0}),f.lessonHeader=e.subjectName+", "+e.teachers.map(function(a){return a.nameEt}).join(", "),f.lessonCapacityName=a.getCapacityType(d.capacityType),f.lesson.startTime=new Date(d.start),f.lesson.endTime=new Date(d.end),f.lesson.eventRooms=d.rooms?d.rooms:[],f.$watch("lesson.eventRoom",function(){if(angular.isDefined(f.lesson.eventRoom)&&null!==f.lesson.eventRoom){if(f.lesson.eventRooms.some(function(a){return a.id===f.lesson.eventRoom.id}))return b.error("timetable.timetablePlan.duplicateroom"),void(f.lesson.eventRoom=void 0);f.lesson.eventRooms.push(f.lesson.eventRoom),f.lesson.eventRoom=null}}),f.$watchGroup(["lesson.eventRooms.length","lesson.startTime","lesson.endTime"],function(){var a={startTime:f.lesson.startTime,endTime:f.lesson.endTime,timetableEventId:f.lesson.id};a.rooms=f.lesson.eventRooms.reduce(function(a,b){return a.push(b.id),a},[]),a.teachers=f.teachers.reduce(function(a,b){return b.isTeaching&&a.push(b.id),a},[]),c.endpoint("/timetableevents/timetableTimeOccupied").get(a).$promise.then(function(a){f.occupiedTime=a})}),f.isUnderAllocatedLessons=function(b){return a.isUnderAllocatedLessons(b)},f.isRoomOccupied=function(a){return f.occupiedTime&&f.occupiedTime.rooms?f.occupiedTime.rooms.filter(function(b){return b.id===a}).length>0:!1},f.isTeacherOccupied=function(a){return f.occupiedTime&&f.occupiedTime.teachers?f.occupiedTime.teachers.filter(function(b){return b.id===a}).length>0:!1},f.deleteEvent=function(b){c.endpoint(H+"/deleteHigherEvent").save({timetableEventId:b}).$promise.then(function(b){var c;c=d.isSubjectTeacherPair?b.subjectTeacherPairs.find(function(a){return a.id===d.subjectStudyPeriod}):b.studentGroups.find(function(a){return a.id===d.studentGroup}),A([c],!0),a.plan.studentGroupCapacities=b.studentGroupCapacities,u(),v(),f.cancel()})},f.saveEvent=function(){return f.lesson.startTime>f.lesson.endTime?void b.error("timetable.timetableEvent.error.endIsEarlierThanStart"):void f.submit()}},function(a){var b={startTime:a.lesson.startTime,endTime:a.lesson.endTime,rooms:a.lesson.eventRooms,timetableEventId:a.lesson.id,teachers:a.teachers.reduce(function(a,b){return b.isTeaching&&a.push(b.id),a},[])};n(b,d)})}},a.saveEventAfterClashCheck=function(b){var c=this.lessonTime.isSubjectTeacherPair?!0:!1,d=this.lessonTime.start,e=a.plan.studentGroupCapacities.filter(function(a){return a.subjectStudyPeriod===Number(b.journalId)&&a.capacityType===b.capacityType});!isFinite(parseInt(b.oldEventId))&&e.length>1?i.confirmDialog({prompt:"timetable.timetablePlan.addForOtherGroups",accept:"main.yes",cancel:"main.no"},function(){a.saveEventAfterCheck(b,!0,c,d)},function(){a.saveEventAfterCheck(b,!1,c,d)}):a.saveEventAfterCheck(b,!1,c,d)},a.saveEventAfterCheck=function(b,e,f,g){var h={timetable:a.timetableId,oldEventId:b.oldEventId,startTime:g,subjectStudyPeriod:b.journalId,repeatCode:a.plan.repeatCode,lessonAmount:a.plan.lessonAmount,room:angular.isDefined(a.plan.eventRoom)?a.plan.eventRoom.id:null};c.endpoint("/timetableevents/timetableNewHigherTimeOccupied").get(h).$promise.then(function(h){h.occupied?i.confirmDialog(d.occupiedEventTimePrompts(a,a.auth.higher,h),function(){o(b,e,f,g)},function(){c.endpoint(H+"/:id/createHigherPlan").search({id:a.timetableId}).$promise.then(function(a){p(a,e,f)})}):o(b,e,f,g)})},a.range=function(a){for(var b=[],c=0;a>c;c++)b.push(c);return b},a.updateGroups=function(){q(),a.$broadcast("refreshFixedColumns")},a.updatePairs=function(){q(),a.$broadcast("refreshFixedColumns")}}]),angular.module("hitsaOis").controller("TimetableEventEditController",["$scope","message","QueryUtils","DataUtils","$route","$location","dialogService",function(a,b,c,d,e,f,g){function h(a){return new Date(a)>new Date}function i(b){if(a.auth.isAdmin())return!0;if(a.auth.isTeacher()){if(!b.teachers)return!1;for(var c=0;c<b.teachers.length;c++)if(b.teachers[c].teacher.id===a.auth.teacher)return!0}return!1}function j(b){b.startTime=new Date(b.startTime),b.endTime=new Date(b.endTime),a.timetableEvent=b}function k(){var b={};a.timetableEvent.rooms&&(b.rooms=a.timetableEvent.rooms.reduce(function(a,b){return a.push(b.id),a},[])),a.timetableEvent.teachers&&(b.teachers=a.timetableEvent.teachers.reduce(function(a,b){return a.push(b.teacher.id),a},[])),a.timetableEvent.studentGroups&&(b.studentGroups=a.timetableEvent.studentGroups.reduce(function(a,b){return a.push(b.id),a},[]));var c=new Date(a.timetableEvent.date),d=a.timetableEvent.startTime,e=a.timetableEvent.endTime;return b.startTime=new Date(c.getFullYear(),c.getMonth(),c.getDate(),d.getHours(),d.getMinutes()),b.endTime=new Date(c.getFullYear(),c.getMonth(),c.getDate(),e.getHours(),e.getMinutes()),b.timetableEventId=a.timetableEvent.id,b.repeatCode=a.timetableEvent.repeatCode,b.weekAmount=a.timetableEvent.weekAmount,b}function l(){o?(a.timetableEvent.$update().then(j).then(b.updateSuccess),a.eventForm.$setPristine(),a.removedJournalTeacherIds={}):a.timetableEvent.$save().then(function(){b.info("main.messages.create.success"),f.url("/lessonplans/events?_menu")})}a.auth=e.current.locals.auth;var m="/timetableevents",n=c.endpoint(m),o=e.current.params.id,p=e.current.loadedTemplateUrl;o?(a.timetableEvent=n.get({id:o},function(c){c.canEdit&&h(c.startTime)&&i(c)||"timetable/timetable.timetableEvent.edit.html"!==p||(b.error("main.messages.error.nopermission"),a.back("#/"))}),a.timetableEvent.$promise.then(j)):(a.timetableEvent=new n,a.timetableEvent.isSingleEvent=!0,a.auth.isTeacher()&&(a.timetableEvent.teachers=[],a.timetableEvent.teachers.push({teacher:{id:a.auth.teacher,nameEt:a.auth.fullname,nameEn:a.auth.fullname,nameRu:a.auth.fullname}}))),a.save=function(){if(a.eventForm.$setSubmitted(),!a.eventForm.$valid)return void b.error("main.messages.form-has-errors");if(a.timetableEvent.startTime>a.timetableEvent.endTime)return void b.error("timetable.timetableEvent.error.endIsEarlierThanStart");var e=k();c.endpoint(m+"/timetableTimeOccupied").get(e).$promise.then(function(b){b.occupied?g.confirmDialog(d.occupiedEventTimePrompts(a,a.auth.higher,b),function(){l()}):l()})},a["delete"]=function(){g.confirmDialog({prompt:"timetable.deleteConfirm",accept:"main.yes",cancel:"main.no"},function(){a.timetableEvent.$delete().then(function(){b.info("main.messages.delete.success"),f.url("/lessonplans/events?_noback")})["catch"](angular.noop)})},a.$watch("timetableEvent.teacher",function(){angular.isDefined(a.timetableEvent.teacher)&&null!==a.timetableEvent.teacher&&a.addTeacher()}),a.sortTeachers=function(b){return a.currentLanguageNameField(b.teacher)},a.addTeacher=function(){return angular.isArray(a.timetableEvent.teachers)||(a.timetableEvent.teachers=[]),a.timetableEvent.teachers.some(function(b){return b.teacher.id===a.timetableEvent.teacher.id})?void b.error(a.auth.higher?"timetable.timetableEvent.error.duplicateTeacherHigher":"timetable.timetableEvent.error.duplicateTeacherVocational"):(a.timetableEvent.teachers.push({id:a.removedJournalTeacherIds?a.removedJournalTeacherIds[a.timetableEvent.teacher.id]:null,teacher:a.timetableEvent.teacher}),void(a.timetableEvent.teacher=void 0))},a.deleteTeacher=function(b){var c=a.timetableEvent.teachers.indexOf(b);-1!==c&&(a.timetableEvent.teachers.splice(c,1),a.removedJournalTeacherIds||(a.removedJournalTeacherIds={}),a.removedJournalTeacherIds[b.teacher.id]=b.id,a.eventForm.$setDirty())},a.$watch("timetableEvent.room",function(){angular.isDefined(a.timetableEvent.room)&&null!==a.timetableEvent.room&&a.addRoom()}),a.addRoom=function(){return angular.isArray(a.timetableEvent.rooms)||(a.timetableEvent.rooms=[]),a.timetableEvent.rooms.some(function(b){return b.id===a.timetableEvent.room.id})?void b.error("timetable.timetableEvent.error.duplicateRoom"):(a.timetableEvent.rooms.push(a.timetableEvent.room),void(a.timetableEvent.room=void 0))},a.deleteRoom=function(b){var c=a.timetableEvent.rooms.indexOf(b);-1!==c&&(a.timetableEvent.rooms.splice(c,1),a.eventForm.$setDirty())},a.$watch("timetableEvent.studentGroup",function(){angular.isDefined(a.timetableEvent.studentGroup)&&null!==a.timetableEvent.studentGroup&&a.addStudentGroup()}),a.addStudentGroup=function(){return angular.isArray(a.timetableEvent.studentGroups)||(a.timetableEvent.studentGroups=[]),a.timetableEvent.studentGroups.some(function(b){return b.id===a.timetableEvent.studentGroup.id})?void b.error("timetable.timetableEvent.error.duplicateStudentGroup"):(a.timetableEvent.studentGroups.push(a.timetableEvent.studentGroup),void(a.timetableEvent.studentGroup=void 0))},a.deleteStudentGroup=function(b){var c=a.timetableEvent.studentGroups.indexOf(b);-1!==c&&(a.timetableEvent.studentGroups.splice(c,1),a.eventForm.$setDirty())}}]),function(){function a(a,b){a.vocationalHigher="";var c=[];a.teacher.isVocational&&c.push("teacher.isVocational"),a.teacher.isHigher&&c.push("teacher.isHigher"),b(c).then(function(b){a.vocationalHigher=c.map(function(a){return b[a]}).join("; ")})}function b(a,b,c){a[b]=a[b].filter(function(a){return a!==c})}angular.module("hitsaOis").controller("TeacherEditController",["$location","$route","$scope","$translate","dialogService","message","DataUtils","FormUtils","QueryUtils",function(c,d,e,f,g,h,i,j,k){function l(){a(e,f),e.currentNavItem="teacher.data",e.teacher.person.idcode&&11===e.teacher.person.idcode.length&&(e.teacher.person.sex=i.sexFromIdcode(e.teacher.person.idcode),e.teacher.person.birthdate=i.birthdayFromIdcode(e.teacher.person.idcode)),i.convertStringToDates(e.teacher.teacherPositionEhis,["contractStart","contractEnd"]),e.isHigher=e.teacher.isHigher,i.convertStringToDates(e.teacher.person,["birthdate"]),e.formState={person:!0,id:!0}}function m(a){angular.isDefined(a)&&null!==a?e.teacher=p.get({id:a},l):e.teacher=new p({isActive:!0,isStudyPeriodScheduleLoad:!0,scheduleLoad:0,person:{citizenship:"RIIK_EST"}})}e.auth=d.current.locals.auth;var n=d.current.params.id,o="/teachers",p=k.endpoint(o),q=k.endpoint("/teachers/"+n+"/ehisPositions"),r=k.endpoint("/school/generateEmail",{post:{method:"POST"}}),s=e.auth.school,t=s&&s.higher&&!s.vocational;e.occupations=k.endpoint("/school/teacheroccupations/all").query(),e.lookupFailure=function(){e.cleanReadOnly(),e.formState={person:!1,id:!0},e.teacher.person.sex=i.sexFromIdcode(e.teacher.person.idcode),e.teacher.person.birthdate=i.birthdayFromIdcode(e.teacher.person.idcode),e.teacherForm.idcode.$setValidity("teacherIdCode",!0)},m(n),angular.isArray(e.teacher.teacherPositionEhis)||(e.teacher.teacherPositionEhis=[]),e.newTeacherPositionEhis=function(){e.teacher.teacherPositionEhis.push({isVocational:!t,isTeacher:t,language:"EHIS_OPETAJA_KEEL_E"})},e.maxDate=new Date,e.cleanReadOnly=function(){e.formState={person:!1,id:!1},e.teacher.person.citizenship="RIIK_EST",e.teacher.person.firstname="",e.teacher.person.lastname="",e.teacher.person.nativeLanguage="",e.teacher.person.birthdate=null,e.teacher.person.sex=null,e.teacher.email=void 0,e.oldFoundPerson&&e.oldFoundPerson.idcode&&e.oldFoundPerson.idcode===e.teacher.person.idcode&&e.lookupPerson(e.oldFoundPerson)},e.lookupPerson=function(a){e.oldFoundPerson=a,a.citizenship&&(e.teacher.person.citizenship=a.citizenship),e.teacher.person.firstname=a.firstname,e.teacher.person.lastname=a.lastname,e.teacher.person.nativeLanguage=a.nativeLanguage,e.teacher.person.birthdate=a.birthdate,e.teacher.person.sex=a.sex,e.teacher.email=a.schoolEmail||void 0,e.teacherForm.idcode.$setValidity("teacherIdCode",null===a.teacherId),l(),e.generateEmail()},e["delete"]=function(){j.deleteRecord(e.teacher,o+"?_noback",{prompt:e.auth.higher?"teacher.deleteConfirmHigher":"teacher.deleteConfirmVocational"})},e.update=function(){j.withValidForm(e.teacherForm,function(){e.teacher.id?e.teacher.$update().then(function(){h.updateSuccess(),e.auth.isTeacher()?c.url(o+"/myData?_noback"):(l(),e.teacherForm.$setPristine())})["catch"](angular.noop):e.teacher.$save().then(function(a){h.info("main.messages.create.success"),c.url(o+"/"+a.id+"/edit?_noback")})["catch"](angular.noop)})},e.sendToEhis=function(){j.withValidForm(e.teacherForm,function(){g.confirmDialog({prompt:e.auth.higher?"teacher.ehisConfirmHigher":"teacher.ehisConfirmVocational"},function(){k.endpoint(o+"/"+e.teacher.id+"/sendToEhis").put({},e.teacher).$promise.then(function(){h.info(e.auth.higher?"teacher.sentToEhisHigher":"teacher.sentToEhisVocational"),c.url(o+"/"+e.teacher.id+"/edit?_noback"),m(e.teacher.id)})["catch"](function(){e.teacher.ehisLastSuccessfulDate=null})})})},e.deleteEhisPosition=function(a){g.confirmDialog({prompt:e.auth.higher?"teacher.teacherPositionEhis.deleteConfirmHigher":"teacher.teacherPositionEhis.deleteConfirmVocational"},function(){a.id?(a=new q(a),a.$delete().then(function(){h.info("main.messages.delete.success"),e.teacher.teacherPositionEhis=e.teacher.teacherPositionEhis.filter(function(b){return b.id!==a.id})})["catch"](angular.noop)):b(e.teacher,"teacherPositionEhis",a)})};var u;e.generateEmail=function(){e.teacher.id||u!==e.teacher.email&&void 0!==e.teacher.email||!e.teacher.person||!e.teacher.person.lastname||r.post({firstname:e.teacher.person.firstname,lastname:e.teacher.person.lastname}).$promise.then(function(a){e.teacher.email=u=a.email})["catch"](angular.noop)}}]).controller("TeacherContinuingEducationEditController",["$location","$route","$translate","$scope","dialogService","message","QueryUtils",function(c,d,e,f,g,h,i){function j(){a(f,e),f.currentNavItem="teacher.continuingEducation",f.isHigher=f.teacher.isHigher,k(f.teacher)}function k(a){a.teacherContinuingEducations&&(f.teacherContinuingEducations=new n({continuingEducations:a.teacherContinuingEducations}),a.teacherContinuingEducations=void 0)}f.auth=d.current.locals.auth;var l=d.current.params.id,m=i.endpoint("/teachers"),n=i.endpoint("/teachers/"+l+"/continuingEducations");l?f.teacher=m.get({id:l},j):f.teacher=new m({isActive:!0,isStudyPeriodScheduleLoad:!0,person:{citizenship:"RIIK_EST"}}),f.teacher.teacherContinuingEducations&&angular.isArray(f.continuingEducations)||(f.teacher.teacherContinuingEducations=[],k(f.teacher)),f.newTeacherContinuingEducation=function(){f.teacherContinuingEducations.continuingEducations.push({})},f.updateContinuingEducations=function(){f.continuingEducationsForm.$setSubmitted(),f.continuingEducationsForm.$valid&&f.teacherContinuingEducations.$update().then(function(a){h.updateSuccess(),k(a),f.continuingEducationsForm.$setPristine()})["catch"](angular.noop)},f.deleteContinuingEducation=function(a){g.confirmDialog({prompt:f.auth.higher?"teacher.continuingEducation.deleteConfirmHigher":"teacher.continuingEducation.deleteConfirmVocational"},function(){a.id?(a=new n(a),a.$delete().then(function(){h.info("main.messages.delete.success"),f.teacherContinuingEducations.continuingEducations=f.teacherContinuingEducations.continuingEducations.filter(function(b){return b.id!==a.id})})["catch"](angular.noop)):b(f.teacherContinuingEducations,"continuingEducations",a)})}}]).controller("TeacherQualificationEditController",["$location","$route","$translate","$scope","dialogService","message","QueryUtils",function(c,d,e,f,g,h,i){function j(){a(f,e),f.currentNavItem="teacher.qualification",f.isHigher=f.teacher.isHigher,k(f.teacher)}function k(a){a.teacherQualifications&&(f.teacherQualifications=new n({qualifications:a.teacherQualifications}),a.teacherQualifications=void 0)}f.auth=d.current.locals.auth;var l=d.current.params.id,m=i.endpoint("/teachers"),n=i.endpoint("/teachers/"+l+"/qualifications");l?f.teacher=m.get({id:l},j):f.teacher=new m({isActive:!0,isStudyPeriodScheduleLoad:!0,person:{citizenship:"RIIK_EST"}}),f.teacher.teacherQualifications&&angular.isArray(f.qualifications)||(f.teacher.teacherQualifications=[],k(f.teacher)),f.newTeacherQualification=function(){f.teacherQualifications.qualifications.push({})},f.updateQualifications=function(){f.qualificationsForm.$setSubmitted(),f.qualificationsForm.$valid&&f.teacherQualifications.$update().then(function(a){h.updateSuccess(),k(a),f.qualificationsForm.$setPristine()})["catch"](angular.noop)},f.deleteQualification=function(a){g.confirmDialog({prompt:f.auth.higher?"teacher.qualification.deleteConfirmHigher":"teacher.qualification.deleteConfirmVocational"},function(){a.id?(a=new n(a),a.$delete().then(function(){h.info("main.messages.delete.success"),f.teacherQualifications.qualifications=f.teacherQualifications.qualifications.filter(function(b){return b.id!==a.id})})["catch"](angular.noop)):b(f.teacherQualifications,"qualifications",a)})}}]).controller("TeacherMobilityEditController",["$location","$route","$translate","$scope","dialogService","message","DataUtils","QueryUtils",function(c,d,e,f,g,h,i,j){function k(){a(f,e),f.currentNavItem="teacher.mobility",f.isHigher=f.teacher.isHigher,l(f.teacher)}function l(a){a.teacherMobility&&(i.convertStringToDates(a.teacherMobility,["start","end"]),f.teacherMobility=new o({mobilities:a.teacherMobility}),a.teacherMobility=void 0)}f.auth=d.current.locals.auth;var m=d.current.params.id,n=j.endpoint("/teachers"),o=j.endpoint("/teachers/"+m+"/mobilities");m?f.teacher=n.get({id:m},k):f.teacher=new n({isActive:!0,isStudyPeriodScheduleLoad:!0,person:{citizenship:"RIIK_EST"}}),f.teacher.teacherMobility&&angular.isArray(f.mobilities)||(f.teacher.teacherMobility=[],l(f.teacher)),f.newTeacherMobility=function(){f.teacherMobility.mobilities.push({})},f.updateTeacherMobility=function(){f.mobilityForm.$setSubmitted(),f.mobilityForm.$valid&&f.teacherMobility.$update().then(function(a){h.updateSuccess(),l(a),f.mobilityForm.$setPristine()})["catch"](angular.noop)},f.deleteMobility=function(a){g.confirmDialog({prompt:f.auth.higher?"teacher.mobility.deleteConfirmHigher":"teacher.mobility.deleteConfirmVocational"},function(){a.id?(a=new o(a),a.$delete().then(function(){h.info("main.messages.delete.success"),f.teacherMobility.mobilities=f.teacherMobility.mobilities.filter(function(b){return b.id!==a.id})})["catch"](angular.noop)):b(f.teacherMobility,"mobilities",a)})}}]).controller("TeacherListController",["$scope","$route","QueryUtils","USER_ROLES",function(a,b,c,d){c.createQueryForm(a,"/teachers",{order:"p.lastname,p.firstname",isActive:!0}),a.auth=b.current.locals.auth,a.showSchool=a.auth.isExternalExpert(),a.schoolHigher=a.auth.school&&a.auth.school.higher,a.auth.isExternalExpert()||(a.teacherOccupations=c.endpoint("/teachers/teacheroccupations").query()),a.formState={canCreate:a.auth.isAdmin()&&-1!==a.auth.authorizedRoles.indexOf(d.ROLE_OIGUS_M_TEEMAOIGUS_OPETAJA)},a.loadData()}]).controller("TeacherViewController",["$scope","$route","$translate","QueryUtils","message",function(b,c,d,e,f){function g(){b.teacher.scheduleLoad=angular.isNumber(b.teacher.scheduleLoad)?String(b.teacher.scheduleLoad):"",a(b,d),b.teacher.teacherPositionEhis.forEach(function(a){a.load=angular.isNumber(a.load)?String(a.load):""}),b.teacher.teacherQualifications.forEach(function(a){a.year=angular.isNumber(a.year)?String(a.year):""})}var h=Object.freeze({DATA:"edit",CONTINUING_EDUCATION:"continuingEducation",QUALIFICATION:"qualification",MOBILITY:"mobility",RTIP_ABSENCE:"rtipAbsence",SUBJECT_PROGRAMS:"programs"}),i=h.DATA;b.isShowingRtipTab=!1,c.current.locals=angular.extend(c.current.locals||{},{params:{myData:!0}});var j=c.current.locals.auth;b.auth=j;var k=j.isTeacher()?j.teacher:c.current.params.id;b.teacherId=k;var l=e.endpoint("/teachers");e.endpoint("/autocomplete/schooldepartments").query(function(a){b.schoolDepartmentsById=a.reduce(function(a,b){return a[b.id]=b,a},{})}),b.teacher=l.get({id:k},g),e.createQueryForm(b,"/teachers/"+k+"/absences"),b.criteria.order="-startDate",b.afterLoadData=function(a){b.tabledata.content=a.content,b.tabledata.totalElements=a.totalElements},b.changeIsShowingRtipTab=function(){b.isShowingRtipTab=!b.isShowingRtipTab,b.isShowingRtipTab&&(i=h.RTIP_ABSENCE,b.loadData())},b.updateData=function(){e.endpoint("/teachers/"+k+"/rtip").save().$promise.then(function(){b.loadData(),f.info("teacher.rtipUpdateOperation.success")})},b.changeTab=function(a){"string"==typeof a&&void 0!==h[a]&&(i=h[a])},b.getUrl=function(){return"#/teachers/"+b.teacher.id+"/"+i+"?_noback"},b.loadData()}]).controller("TeacherRtipAbsenceEditController",["$scope","$route","$translate","QueryUtils","message",function(b,c,d,e,f){function g(){a(b,d),b.currentNavItem="teacher.rtipAbsence",b.isHigher=b.teacher.isHigher,b.loadData()}b.auth=c.current.locals.auth;var h=c.current.params.id,i=e.endpoint("/teachers");b.rtipPage=!0,h?b.teacher=i.get({id:h},g):b.teacher=new i({isActive:!0,isStudyPeriodScheduleLoad:!0,person:{citizenship:"RIIK_EST"}}),e.createQueryForm(b,"/teachers/"+h+"/absences"),b.criteria.order="-startDate",b.afterLoadData=function(a){b.tabledata.content=a.content,b.tabledata.totalElements=a.totalElements},b.updateData=function(){e.endpoint("/teachers/"+h+"/rtip").save().$promise.then(function(){b.loadData(),f.info("teacher.rtipUpdateOperation.success")})}}]).controller("TeacherProgramController",["$scope","$route","QueryUtils","$translate",function(b,c,d,e){function f(){a(b,e),b.currentNavItem="teacher.programs"}var g=c.current.params.id,h=d.endpoint("/teachers");c.current.locals=angular.extend(c.current.locals||{},{params:{myData:!0}}),b.separateController=!0,b.auth=c.current.locals.auth,g?b.teacher=h.get({id:g},f):b.teacher=new h({isActive:!0,isStudyPeriodScheduleLoad:!0,person:{citizenship:"RIIK_EST"}})}])}(),angular.module("hitsaOis").controller("TeacherOccupationEditController",["$location","$route","$scope","dialogService","message","QueryUtils",function(a,b,c,d,e,f){var g=b.current.params.id,h="/school/teacheroccupations",i=f.endpoint(h);g?c.teacherOccupation=i.get({id:g}):c.teacherOccupation=new i({occupationEt:"",occupationEn:"",isValid:!0}),c.update=function(){return c.teacherOccupationForm.$setSubmitted(),c.teacherOccupationForm.$valid?void(c.teacherOccupation.id?(c.teacherOccupation.$update().then(e.updateSuccess),c.teacherOccupationForm.$setPristine()):c.teacherOccupation.$save().then(function(){e.info("main.messages.create.success"),a.url(h+"/"+c.teacherOccupation.id+"/edit?_noback")})):void e.error("main.messages.form-has-errors")},c["delete"]=function(){d.confirmDialog({prompt:"teacher.occupation.deleteconfirm"},function(){c.teacherOccupation.$delete().then(function(){e.info("main.messages.delete.success"),a.url(h)})})}}]),angular.module("hitsaOis").config(["$routeProvider","USER_ROLES",function(a,b){var c={authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_OPETAJA]};a.when("/teachers",{templateUrl:"teacher/teacher.list.html",controller:"TeacherListController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:c}).when("/teachers/new",{templateUrl:"teacher/teacher.edit.html",controller:"TeacherEditController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_OPETAJA]}}).when("/teachers/:id/edit",{templateUrl:"teacher/teacher.edit.html",controller:"TeacherEditController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_OPETAJA]}}).when("/teachers/:id/editmydata",{templateUrl:"teacher/teacher.edit.mydata.html",controller:"TeacherEditController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_OPETAJA]}}).when("/teachers/:id/continuingEducation",{templateUrl:"teacher/teacher.continuing.education.edit.html",controller:"TeacherContinuingEducationEditController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:c}).when("/teachers/:id/qualification",{templateUrl:"teacher/teacher.qualification.edit.html",controller:"TeacherQualificationEditController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:c}).when("/teachers/:id/mobility",{templateUrl:"teacher/teacher.mobility.edit.html",controller:"TeacherMobilityEditController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:c}).when("/teachers/:id/rtipAbsence",{templateUrl:"teacher/teacher.rtip.absence.view.html",controller:"TeacherRtipAbsenceEditController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:c}).when("/teachers/myData",{templateUrl:"teacher/teacher.view.html",controller:"TeacherViewController",controllerAs:"controller",data:c,resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]}}).when("/teachers/:id/programs",{templateUrl:"teacher/teacher.programs.html",controller:"TeacherProgramController",controllerAs:"controller",data:c,resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]}}).when("/teachers/:id",{templateUrl:"teacher/teacher.view.html",controller:"TeacherViewController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:c})}]),angular.module("hitsaOis").controller("FinalThesisEditController",["$scope","$route","$location","$q","Classifier","DataUtils","QueryUtils","config","dialogService","message",function(a,b,c,d,e,f,g,h,i,j){function k(b){a.thesis=b}function l(b,c){var d=b.teacher?b.teacher.id:null;if(d)for(var e=0;e<a.thesis.supervisors.length;e++)if(a.thesis.supervisors[e].teacher&&a.thesis.supervisors[e].teacher.id===d&&c!==e)return!0;return!1}function m(b){if(b.isPrimary)for(var c=0;c<a.thesis.supervisors.length;c++)a.thesis.supervisors[c].isPrimary=!1}function n(){return a.finalThesisForm.$setSubmitted(),0===a.thesis.supervisors.length?(j.error("finalThesis.error.supervisorRequired"),!1):a.finalThesisForm.$valid?!0:(j.error("main.messages.form-has-errors"),!1)}a.auth=b.current.locals.auth;var o="/finalThesis",p=g.endpoint(o),q=b.current.locals.entity;angular.isDefined(q)?(k(q),a.thesis.canBeEdited||-1!==b.current.$$route.originalPath.indexOf("view")||c.url(o+"/"+a.thesis.id+"/view?_noback"),a.finalThesisPdfUrl=h.apiUrl+o+"/print/"+q.id+"/finalThesis.pdf"):(a.thesis={hasDraft:!1,supervisors:[]},a.auth.isStudent()&&(a.thesis.student={id:a.auth.student})),angular.isUndefined(q)&&a.auth.isStudent()&&g.endpoint(o+"/studentFinalThesis").get().$promise.then(function(a){a.finalThesisRequired?a.finalThesis&&c.url(o+"/"+a.finalThesis+"/view?_noback"):c.url(o)}),a.$watch("thesis.student",function(){a.thesis.student&&g.endpoint("/students/"+a.thesis.student.id).get(function(b){a.thesis.person=b.person,a.thesis.curriculumVersion=b.curriculumVersion,a.thesis.studentGroup=b.studentGroup,a.thesis.isVocational=b.curriculumVersion.isVocational})}),a.openAddSupervisorDialog=function(b){var c=a.thesis.supervisors?a.thesis.supervisors.length:0;c>=3&&!angular.isDefined(b)?j.error("finalThesis.error.maxSupervisors"):i.showDialog("finalThesis/supervisor.add.dialog.html",function(c){c.newSupervisor=angular.isDefined(b)?!1:!0,c.newSupervisor?c.supervisor={isExternal:!1}:c.supervisor=angular.copy(a.thesis.supervisors[b]),c.$watch("supervisor.teacher",function(){c.supervisor&&c.supervisor.teacher&&g.endpoint(o+"/teacher/").get({teacherId:c.supervisor.teacher.id},function(a){c.supervisor.firstname=a.person.firstname,c.supervisor.lastname=a.person.lastname,c.supervisor.email=a.email,c.supervisor.occupation=a.teacherOccupation.nameEt})}),c.typeChanged=function(a){c.supervisor={isExternal:a}},c.removeSupervisor=function(){i.confirmDialog({prompt:"finalThesis.supervisorDeleteConfirm"},function(){a.thesis.supervisors.splice(b,1),c.cancel()})},c.submitSupervisor=function(){l(c.supervisor,b)?j.error("finalThesis.error.teacherAlreadyIsSupervisor"):c.submit()}},function(c){var d=c.supervisor;m(d),angular.isDefined(b)?a.thesis.supervisors[b]=d:a.thesis.supervisors.push(d)})},a.save=function(){if(n()){var b=new p(a.thesis);angular.isDefined(a.thesis.id)?b.$update().then(function(a){j.info("main.messages.update.success"),k(a)})["catch"](angular.noop):b.$save().then(function(a){j.info("main.messages.update.success"),c.url(o+"/"+a.id+"/edit?_noback")})["catch"](angular.noop)}},a.confirm=function(){n()&&i.confirmDialog({prompt:"finalThesis.confirmConfirm"},function(){g.endpoint(o+"/"+a.thesis.id+"/confirm").put(a.thesis,function(a){j.info("finalThesis.isConfirmed"),k(a)})})}}]),angular.module("hitsaOis").controller("FinalThesisListController",["$scope","$route","$location","$q","QueryUtils","DataUtils","Classifier",function(a,b,c,d,e,f,g){a.auth=b.current.locals.auth,a.criteria={},a.noFinalThesisModule=!1;var h="/finalThesis",i=g.valuemapper({status:"LOPUTOO_STAATUS"});e.createQueryForm(a,h,{order:"2"},i.objectmapper),a.directiveControllers=[];var j=a.clearCriteria;a.clearCriteria=function(){j(),a.directiveControllers.forEach(function(a){a.clear()})},a.auth.isTeacher()||a.auth.isAdmin()?d.all(i.promises).then(a.loadData):a.auth.isStudent()&&e.endpoint(h+"/studentFinalThesis").get().$promise.then(function(b){b.finalThesisRequired?b.finalThesis?c.url(h+"/"+b.finalThesis+"/view?_noback"):c.url(h+"/new"):a.noFinalThesisModule=!0})}]),angular.module("hitsaOis").config(["$routeProvider","USER_ROLES",function(a,b){a.when("/finalThesis",{templateUrl:"finalThesis/final.thesis.list.html",controller:"FinalThesisListController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_LOPTEEMA]}}).when("/finalThesis/new",{templateUrl:"finalThesis/final.thesis.edit.html",controller:"FinalThesisEditController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_LOPTEEMA]}}).when("/finalThesis/:id/edit",{templateUrl:"finalThesis/final.thesis.edit.html",controller:"FinalThesisEditController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],entity:["QueryUtils","$route",function(a,b){return a.endpoint("/finalThesis").get({id:b.current.params.id}).$promise}]},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_LOPTEEMA]}}).when("/finalThesis/:id/view",{templateUrl:"finalThesis/final.thesis.view.html",controller:"FinalThesisEditController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],entity:["QueryUtils","$route",function(a,b){return a.endpoint("/finalThesis").get({id:b.current.params.id}).$promise}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_LOPTEEMA]}})}]),angular.module("hitsaOis").controller("FinalHigherProtocolListController",["$scope","$route","$timeout","$q","QueryUtils","DataUtils","Classifier","dialogService","message","$location","USER_ROLES",function(a,b,c,d,e,f,g,h,i,j,k){
a.auth=b.current.locals.auth;var l="/finalHigherProtocols",m=g.valuemapper({status:"PROTOKOLL_STAATUS"});a.formState={canCreateProtocol:(a.auth.isTeacher()||a.auth.isAdmin())&&-1!==a.auth.authorizedRoles.indexOf(k.ROLE_OIGUS_M_TEEMAOIGUS_LOPPROTOKOLL)},e.createQueryForm(a,l,{order:"14 desc"},m.objectmapper),angular.isDefined(a.criteria.status)||(a.criteria.status="PROTOKOLL_STAATUS_S"),d.all(m.promises).then(a.loadData)}]),angular.module("hitsaOis").controller("FinalHigherProtocolNewController",["$scope","$route","$location","$q","QueryUtils","DataUtils","Classifier","message","ArrayUtils",function(a,b,c,d,e,f,g,h,i){function j(){!a.formState.isFinalThesis&&a.formState.studyPeriod&&a.formState.curriculum?a.formState.subjects=e.endpoint(k+"/subjects/exam/"+a.formState.studyPeriod+"/"+a.formState.curriculum).query():a.formState.isFinalThesis&&a.formState.curriculum&&(a.formState.subjects=e.endpoint(k+"/subjects/thesis/"+a.formState.curriculum).query())}var k="/finalHigherProtocols";a.auth=b.current.locals.auth,a.formState={protocolType:"PROTOKOLLI_LIIK_P",isFinalThesis:"thesis"===b.current.params.moduleType?!0:!1,selectedStudents:[],subjects:[]};var l=g.valuemapper({status:"OPPURSTAATUS"});a.studyPeriods=e.endpoint("/autocomplete/studyPeriods").query(),a.curriculums=e.endpoint(k+"/curriculums/"+b.current.params.moduleType).query();var m=[];m.push(a.studyPeriods.$promise),d.all(m).then(function(){a.formState.studyPeriod=f.getCurrentStudyYearOrPeriod(a.studyPeriods).id}),a.studyPeriodChanged=function(){a.formState.subject=void 0,j()},a.curriculumChanged=function(){a.formState.subject=void 0,j()},a.subjectChanged=function(){var c=e.endpoint(k+"/subject/"+b.current.params.moduleType+"/"+a.formState.curriculum+"/"+a.formState.subject.id).get();a.tabledata={$promise:c.$promise},c.$promise.then(function(b){a.formState.selectedStudents=[],a.tabledata.content=l.objectmapper(b.subjectStudents),b.subjectStudents.forEach(function(b){"OPPURSTAATUS_O"===b.status.code&&a.formState.selectedStudents.push(b.studentId)})})};var n=e.endpoint(k);a.submit=function(){if(!a.finalProtocolNewForm.$valid)return h.error("main.messages.form-has-errors"),a.finalProtocolNewForm.$setSubmitted(),!1;if(i.isEmpty(a.formState.selectedStudents))return void h.error("finalProtocol.error.noStudents");var d={};"thesis"===b.current.params.moduleType?(d.isFinalThesis=!0,d.subject=a.formState.subject.id):"exam"===b.current.params.moduleType&&(d.isFinalThesis=!1,d.subjectStudyPeriod=a.formState.subject.id),d.protocolType=a.formState.protocolType,d.protocolStudents=a.formState.selectedStudents.map(function(a){return{studentId:a}}),d.curriculumVersion=a.formState.curriculum,new n(d).$save().then(function(a){h.info("main.messages.create.success"),c.url(k+"/"+a.id+"/edit?_noback")})}}]),angular.module("hitsaOis").controller("FinalHigherProtocolEditController",["$route","$location","$scope","$filter","$q","ArrayUtils","Classifier","DataUtils","HigherGradeUtil","ProtocolUtils","QueryUtils","config","dialogService","message","oisFileService",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){function p(){c.grades=c.grades.filter(function(b){return a.current.locals.isView?void 0:-1===y.indexOf(b.code)})}function q(){angular.isDefined(A)&&0===A.promise.$$state.status&&A.resolve()}function r(a){e.all(z.promises).then(function(){c.finalProtocolForm.$setPristine(),c.protocol=z.objectmapper(a),c.savedStudents=angular.copy(c.protocol.protocolStudents),c.protocol.finalDate&&(c.committees=k.endpoint(x+"/committees").query({finalDate:c.protocol.finalDate})),c.protocol.committee&&(c.committeeMembers=c.protocol.committee.members,c.committeeMembers.forEach(function(a){-1!==c.protocol.presentCommitteeMembers.indexOf(a.id)&&(a.isPresent=!0)}),c.protocol.committee=c.protocol.committee.id);for(var b=0;b<c.protocol.protocolStudents.length;b++){for(var d=c.protocol.protocolStudents[b],e=!0,f=0;f<d.curriculumOccupations.length;f++)if(d.curriculumOccupations[f].studentOccupationCertificateId){e=!1;break}d.canGrantOccupation=e}c.getUrl=o.getUrl,s(),c.formState={canEditProtocol:j.canEditProtocol(c.auth,c.protocol),canAddDeleteStudents:j.canAddDeleteStudents(c.auth,c.protocol),canConfirm:j.canConfirm(c.auth,c.protocol),canChangeConfirmedProtocolGrade:j.canChangeConfirmedProtocolGrade(c.auth,c.protocol),protocolPdfUrl:l.apiUrl+x+"/"+a.id+"/print/protocol.pdf"},q()})["catch"](function(){q()})}function s(){c.protocol.protocolStudents.forEach(function(a){a.occupations||(a.occupations=[]),a.curriculumOccupations.forEach(function(b){b.occupationCode&&(a.occupations[b.occupationCode]={code:b.occupationCode,certificateNr:b.certificateNr,ceritificateId:b.studentOccupationCertificateId,granted:!0})})})}function t(a){if(!c.finalProtocolForm.$valid)return n.error("main.messages.form-has-errors"),c.finalProtocolForm.$setSubmitted(),!1;if(a&&angular.isArray(c.protocol.protocolStudents))for(var b=0;b<c.protocol.protocolStudents.length;b++){var d=c.protocol.protocolStudents[b];if(i.isPositive(d.grade)&&!d.curriculumGrade)return n.error("finalProtocol.error.curriculumGradeRequired"),!1;if(!i.isPositive(d.grade)&&d.curriculumGrade)return n.error("finalProtocol.error.curriculumGradeNotAllowed"),!1}return!0}function u(){for(var a=0;a<c.committees.length;a++)if(c.committees[a].id=c.protocol.committee)return!0;return!1}function v(a){var b=c.protocol.protocolStudents;return b.forEach(function(a){for(var b=null,c=Object.keys(a.occupations),d=0;d<c.length;d++)a.occupations[c[d]].granted&&(b=c[d]);a.occupationCode=b,a.curriculumGradeId=a.curriculumGrade?a.curriculumGrade.id:null}),b}function w(a){var b=[];if(a)for(var c=0;c<a.length;c++)a[c].isPresent&&b.push({committeeMemberId:a[c].id});return b}c.gradeUtil=i;var x="/finalHigherProtocols";c.auth=a.current.locals.auth,c.record=a.current.locals.entity,c.grades=g.queryForDropdown({mainClassCode:"KORGHINDAMINE"},p);var y=["KORGHINDAMINE_MI"],z=g.valuemapper({grade:"KORGHINDAMINE",status:"PROTOKOLL_STAATUS",studyLevel:"OPPEASTE"});c.formState={};var A;a.current.locals.entity&&r(a.current.locals.entity),c.hideInvalid=function(a){return!g.isValid(a)},c.gradeChanged=function(a){if(a){var b=d("filter")(c.savedStudents,{id:a.id},!0)[0];b.grade!==a.grade?(c.finalProtocolForm.$setSubmitted(),a.gradeHasChanged=!0):(a.gradeHasChanged=!1,b.addInfo?a.addInfo=b.addInfo:a.addInfo=null)}c.formState.canConfirm=j.canConfirm(c.auth,c.protocol)},c.addInfoChanged=function(){c.formState.canConfirm=j.canConfirm(c.auth,c.protocol)},c.gradeValue=function(a){var b=z.objectmapper({grade:a}).grade;return b?c.auth.school.letterGrades?b.value2:b.value:void 0},c.confirm=function(){if(A=e.defer(),!t(!0))return q(),A.promise;var a={version:c.protocol.version,finalDate:c.protocol.finalDate,committeeId:c.protocol.committee,protocolCommitteeMembers:w(c.committeeMembers),protocolStudents:v(c.protocol.protocolStudents)};return j.signBeforeConfirm(c.auth,x+"/"+c.protocol.id,a,"finalProtocol.messages.confirmed",r,q),A.promise},c.selectedFinalDateChanged=function(){k.endpoint(x+"/committees").query({finalDate:c.protocol.finalDate}).$promise.then(function(a){c.committees=a,c.protocol.committee&&!u()&&(c.protocol.committee=null,c.committeeMembers=null)})},c.selectedCommitteeChanged=function(){c.protocol.committee?k.endpoint("/committees").get({id:c.protocol.committee}).$promise.then(function(a){c.committeeMembers=a.members}):c.committeeMembers=null},c.setCurriculumGrade=function(a,b){c.finalProtocolForm.$setDirty(),a.curriculumGrade&&a.curriculumGrade.id===b?a.curriculumGrade=null:a.curriculumGrade={id:b}},c.setOccupation=function(a,b){if(a.canGrantOccupation)for(var c in a.occupations)c!==b&&(a.occupations[c]=!1)},c.deleteProtocolStudent=function(a){m.confirmDialog({prompt:"finalProtocol.prompt.deleteStudent"},function(){var b=k.endpoint(x+"/"+c.protocol.id+"/removeStudent"),d=new b(a);d.$delete().then(function(a){n.info("main.messages.delete.success"),r(a)})["catch"](angular.noop)})};var B=k.endpoint(x);c.save=function(){return t(!1)?void new B({id:c.protocol.id,version:c.protocol.version,finalDate:c.protocol.finalDate,committeeId:c.protocol.committee,protocolCommitteeMembers:w(c.committeeMembers),protocolStudents:v(c.protocol.protocolStudents)}).$update().then(function(a){n.info("main.messages.create.success"),r(a)})["catch"](angular.noop):!1},c["delete"]=function(){m.confirmDialog({prompt:"finalProtocol.prompt.delete"},function(){new B(c.protocol).$delete().then(function(){n.info("finalProtocol.messages.deleted"),b.path(x)})["catch"](angular.noop)})}}]),angular.module("hitsaOis").config(["$routeProvider","USER_ROLES",function(a,b){a.when("/finalHigherProtocols",{templateUrl:"finalProtocol/higher/final.higher.protocol.list.html",controller:"FinalHigherProtocolListController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_LOPPROTOKOLL]}}).when("/finalHigherProtocols/:moduleType/new",{templateUrl:"finalProtocol/higher/final.higher.protocol.new.html",controller:"FinalHigherProtocolNewController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_LOPPROTOKOLL]}}).when("/finalHigherProtocols/:id/edit",{templateUrl:"finalProtocol/higher/final.higher.protocol.edit.html",controller:"FinalHigherProtocolEditController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],entity:["QueryUtils","$route",function(a,b){return a.endpoint("/finalHigherProtocols").get({id:b.current.params.id}).$promise}]},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_LOPPROTOKOLL]}}).when("/finalHigherProtocols/:id/view",{templateUrl:"finalProtocol/higher/final.higher.protocol.view.html",controller:"FinalHigherProtocolEditController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],entity:["QueryUtils","$route",function(a,b){return a.endpoint("/finalHigherProtocols").get({id:b.current.params.id}).$promise}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_LOPPROTOKOLL]}})}]),angular.module("hitsaOis").controller("FinalVocationalProtocolListController",["$scope","$route","QueryUtils","DataUtils","Classifier","$q","dialogService","message","$location",function(a,b,c,d,e,f,g,h,i){function j(){return(a.auth.isTeacher()||a.auth.isAdmin())&&-1!==a.auth.authorizedRoles.indexOf("ROLE_OIGUS_M_TEEMAOIGUS_LOPMOODULPROTOKOLL")}a.auth=b.current.locals.auth,a.criteria={},a.criteria.status="PROTOKOLL_STAATUS_S";var k="/finalVocationalProtocols";a.load=function(){return a.searchForm.$valid?void a.loadData():(h.error("main.messages.form-has-errors"),!1)},a.formState={canCreateProtocol:j()};var l=e.valuemapper({status:"PROTOKOLL_STAATUS"});c.createQueryForm(a,k,{order:"14 desc"},l.objectmapper),angular.isDefined(a.criteria.status)||(a.criteria.status="PROTOKOLL_STAATUS_S");var m=a.$watch("criteria.studyYear",function(b){angular.isNumber(b)&&(m(),f.all(l.promises).then(a.loadData))});a.$watch("criteria.moduleObject",function(){a.criteria.module=a.criteria.moduleObject?a.criteria.moduleObject.id:null})}]),angular.module("hitsaOis").controller("FinalVocationalProtocolNewController",["$scope","$route","$location","QueryUtils","Classifier","message","ArrayUtils",function(a,b,c,d,e,f,g){var h="/finalVocationalProtocols";a.auth=b.current.locals.auth,a.formState={selectedStudents:[],isFinalThesis:"thesis"===b.current.params.moduleType?!0:!1},a.auth.isTeacher()&&(a.formState.teacher=a.auth.teacher);var i=e.valuemapper({status:"OPPURSTAATUS"});a.$watch("formState.curriculumVersionObject",function(){a.formState.curriculumVersion=a.formState.curriculumVersionObject?a.formState.curriculumVersionObject.id:null,a.formState.curriculumVersionOccupationModule=void 0,a.formState.curriculumVersion&&(a.formState.curriculumVersionOccupationModules=d.endpoint(h+"/occupationModules/"+a.formState.curriculumVersion).query())}),a.curriculumVersionOccupationModuleChange=function(){var c=d.endpoint(h+"/occupationModule/"+b.current.params.moduleType+"/"+a.formState.studyYear+"/"+a.formState.curriculumVersionOccupationModule).get();a.tabledata={$promise:c.$promise},c.$promise.then(function(b){a.formState.selectedStudents=[],a.tabledata.content=i.objectmapper(b.occupationModuleStudents),b.occupationModuleStudents.forEach(function(b){"OPPURSTAATUS_O"===b.status.code&&a.formState.selectedStudents.push(b.studentId)}),b.teacher&&!a.auth.isTeacher()&&(a.formState.teacherObject=b.teacher)})};var j=d.endpoint(h);a.submit=function(){if(!a.finalProtocolNewForm.$valid)return f.error("main.messages.form-has-errors"),a.finalProtocolNewForm.$setSubmitted(),!1;if(g.isEmpty(a.formState.selectedStudents))return void f.error("finalProtocol.error.noStudents");var b={};b.protocolVdata={curriculumVersionOccupationModule:a.formState.curriculumVersionOccupationModule,curriculumVersion:a.formState.curriculumVersion,studyYear:a.formState.studyYear,teacher:a.formState.teacher},b.protocolStudents=a.formState.selectedStudents.map(function(a){return{studentId:a}}),b.isFinalThesis=a.formState.isFinalThesis,new j(b).$save().then(function(a){f.info("main.messages.create.success"),c.url(h+"/"+a.id+"/edit?_noback")})["catch"](angular.noop)}}]),angular.module("hitsaOis").controller("FinalVocationalProtocolEditController",["$scope","$route","$filter","$q","QueryUtils","Classifier","ProtocolUtils","VocationalGradeUtil","oisFileService","config","message","dialogService","$location",function(a,b,c,d,e,f,g,h,i,j,k,l,m){function n(){angular.isDefined(A)&&0===A.promise.$$state.status&&A.resolve()}function o(b){d.all(v.promises).then(function(){a.finalProtocolForm.$setPristine(),a.protocol=v.objectmapper(b),a.savedStudents=angular.copy(a.protocol.protocolStudents),a.protocol.finalDate&&(a.committees=e.endpoint(u+"/committees").query({finalDate:a.protocol.finalDate})),a.protocol.committee&&(a.committeeMembers=a.protocol.committee.members,a.committeeMembers.forEach(function(b){-1!==a.protocol.presentCommitteeMembers.indexOf(b.id)&&(b.isPresent=!0)}),a.protocol.committee=a.protocol.committee.id),a.getUrl=i.getUrl,p(),a.formState={canEditProtocol:g.canEditProtocol(a.auth,a.protocol),canAddDeleteStudents:g.canAddDeleteStudents(a.auth,a.protocol),canConfirm:g.canConfirm(a.auth,a.protocol),canChangeConfirmedProtocolGrade:g.canChangeConfirmedProtocolGrade(a.auth,a.protocol),protocolPdfUrl:j.apiUrl+u+"/"+b.id+"/print/protocol.pdf"},n()})["catch"](function(){n()})}function p(){a.protocol.protocolStudents.forEach(function(a){a.occupations||(a.occupations=[]),a.curriculumOccupations.forEach(function(b){if(b.partOccupationCode)if(angular.isDefined(a.occupations[b.partOccupationCode])){var c=a.occupations[b.partOccupationCode].certificateNr;a.occupations[b.partOccupationCode].certificateNr=c+", "+b.certificateNr}else a.occupations[b.partOccupationCode]={code:b.partOccupationCode,certificateNr:b.certificateNr,ceritificateId:b.studentOccupationCertificateId,granted:!0};else if(!b.partOccupationCode)if(angular.isDefined(a.occupations[b.occupationCode])){var c=a.occupations[b.occupationCode].certificateNr;a.occupations[b.occupationCode].certificateNr=c+", "+b.certificateNr}else a.occupations[b.occupationCode]={code:b.occupationCode,certificateNr:b.certificateNr,ceritificateId:b.studentOccupationCertificateId,granted:!0}})})}function q(){for(var b=0;b<a.committees.length;b++)if(a.committees[b].id=a.protocol.committee)return!0;return!1}function r(){return a.finalProtocolForm.$valid?!0:(k.error("main.messages.form-has-errors"),a.finalProtocolForm.$setSubmitted(),!1)}function s(){var b=a.protocol.protocolStudents;return b.forEach(function(a){for(var b=[],c=Object.keys(a.occupations),d=0;d<c.length;d++)a.occupations[c[d]].granted&&b.push(c[d]);a.occupationCodes=b}),b}function t(a){var b=[];if(a)for(var c=0;c<a.length;c++)a[c].isPresent&&b.push({committeeMemberId:a[c].id});return b}var u="/finalVocationalProtocols";a.gradeUtil=h,a.auth=b.current.locals.auth;var v=f.valuemapper({grade:"KUTSEHINDAMINE",status:"PROTOKOLL_STAATUS",studyLevel:"OPPEASTE"}),w=f.valuemapper({journalResults:"KUTSEHINDAMINE",status:"OPPURSTAATUS"}),x=["KUTSEHINDAMINE_1","KUTSEHINDAMINE_X"],y=["KUTSEHINDAMINE_X"],z=f.queryForDropdown({mainClassCode:"KUTSEHINDAMINE"});a.formState={};var A;z.$promise.then(function(c){a.grades=c.filter(function(a){return b.current.locals.isView?-1===y.indexOf(a.code):-1===x.indexOf(a.code)})}),a.hideInvalid=function(a){return!f.isValid(a)},a.gradeChanged=function(b){if(b){var d=c("filter")(a.savedStudents,{id:b.id},!0)[0];d.grade!==b.grade?(a.finalProtocolForm.$setSubmitted(),b.gradeHasChanged=!0):(b.gradeHasChanged=!1,d.addInfo?b.addInfo=d.addInfo:b.addInfo=null)}a.formState.canConfirm=g.canConfirm(a.auth,a.protocol)},a.addInfoChanged=function(){a.formState.canConfirm=g.canConfirm(a.auth,a.protocol)},b.current.locals.entity?o(b.current.locals.entity):a.protocol&&loadGradesSelect(),a.selectedFinalDateChanged=function(){e.endpoint(u+"/committees").query({finalDate:a.protocol.finalDate}).$promise.then(function(b){a.committees=b,a.protocol.committee&&!q()&&(a.protocol.committee=null,a.committeeMembers=null)})},a.selectedCommitteeChanged=function(){a.protocol.committee?e.endpoint("/committees").get({id:a.protocol.committee}).$promise.then(function(b){a.committeeMembers=b.members}):a.committeeMembers=null},a.deleteProtocolStudent=function(b){l.confirmDialog({prompt:"finalProtocol.prompt.deleteStudent"},function(){var c=e.endpoint(u+"/"+a.protocol.id+"/removeStudent"),d=new c(b);d.$delete().then(function(a){k.info("main.messages.delete.success"),o(a)})["catch"](angular.noop)})},a.addProtocolStudents=function(){l.showDialog("finalProtocol/templates/final.protocol.add.student.dialog.html",function(b){b.selectedStudents=[];var c=e.endpoint(u+"/"+a.protocol.id+"/otherStudents").query();b.tabledata={$promise:c.$promise},c.$promise.then(function(a){b.tabledata.content=w.objectmapper(a)})},function(b){if(!r())return!1;if(0===b.selectedStudents.length)return!1;var c=b.selectedStudents.map(function(a){return{studentId:a,occupations:[]}});c.forEach(function(b){a.protocol.protocolStudents.push(b)}),a.save()})},a.gradeValue=function(a){var b=v.objectmapper({grade:a}).grade;return b?b.value:void 0},a.confirm=function(){if(A=d.defer(),!r())return n(),A.promise;var b={version:a.protocol.version,finalDate:a.protocol.finalDate,committeeId:a.protocol.committee,protocolCommitteeMembers:t(a.committeeMembers),protocolStudents:s()};return g.signBeforeConfirm(a.auth,u+"/"+a.protocol.id,b,"finalProtocol.messages.confirmed",o,n),A.promise};var B=e.endpoint(u);a.save=function(){return r()?void new B({id:a.protocol.id,version:a.protocol.version,finalDate:a.protocol.finalDate,committeeId:a.protocol.committee,protocolCommitteeMembers:t(a.committeeMembers),protocolStudents:s()}).$update().then(function(a){k.info("main.messages.create.success"),o(a)})["catch"](angular.noop):!1},a["delete"]=function(){l.confirmDialog({prompt:"finalProtocol.prompt.delete"},function(){new B(a.protocol).$delete().then(function(){k.info("finalProtocol.messages.deleted"),m.path(u)})["catch"](angular.noop)})}}]),angular.module("hitsaOis").config(["$routeProvider","USER_ROLES",function(a,b){a.when("/finalVocationalProtocols",{templateUrl:"finalProtocol/vocational/final.vocational.protocol.list.html",controller:"FinalVocationalProtocolListController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_LOPMOODULPROTOKOLL]}}).when("/finalVocationalProtocols/:moduleType/new",{templateUrl:"finalProtocol/vocational/final.vocational.protocol.new.html",controller:"FinalVocationalProtocolNewController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_LOPMOODULPROTOKOLL]}}).when("/finalVocationalProtocols/:id/edit",{templateUrl:"finalProtocol/vocational/final.vocational.protocol.edit.html",controller:"FinalVocationalProtocolEditController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],entity:["QueryUtils","$route",function(a,b){return a.endpoint("/finalVocationalProtocols").get({id:b.current.params.id}).$promise}]},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_LOPMOODULPROTOKOLL]}}).when("/finalVocationalProtocols/:id/view",{templateUrl:"finalProtocol/vocational/final.vocational.protocol.view.html",controller:"FinalVocationalProtocolEditController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],entity:["QueryUtils","$route",function(a,b){return a.endpoint("/finalVocationalProtocols").get({id:b.current.params.id}).$promise}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_LOPMOODULPROTOKOLL]}})}]),angular.module("hitsaOis").controller("PersonsEditController",["$location","$route","$scope","$rootScope","dialogService","DataUtils","message","PersonService","QueryUtils",function(a,b,c,d,e,f,g,h,i){function j(){f.convertStringToDates(c.person,["birthdate"]),c.users=c.person.users,c.person.users=null,c.person.idcode&&11===c.person.idcode.length&&(c.person.sex=f.sexFromIdcode(c.person.idcode),c.person.birthdate=f.birthdayFromIdcode(c.person.idcode),c.idcodeReadonly=!0),c.users&&h.usersAfterLoad(c.users)}function k(){l||(c.person.firstname="",c.person.lastname="",c.person.email="",c.person.phone="")}var l=b.current.params.id,m="/persons",n=i.endpoint(m);c.auth=b.current.locals.auth,c.maxDate=new Date,c.lookupPerson=function(b){l?(c.person.idcode=void 0,g.error("person.exists")):(a.path(m+"/"+b.id+"/edit"),g.info("person.exists"))},c.lookupFailure=function(){c.person.sex=f.sexFromIdcode(c.person.idcode),c.person.birthdate=f.birthdayFromIdcode(c.person.idcode),k()},c.cleanReadOnly=function(){k(),c.person.sex=void 0,c.person.birthdate=void 0},l?c.person=n.get({id:l},j):c.person=new n,c.orderValue=function(a){return c.currentLanguageNameField(a.role)},c.personBack=function(){c.users&&c.users.length>0||c.auth.isMainAdmin()||!c.person.id?d.back("#"+m):e.confirmDialog({prompt:"person.back"},function(){d.back("#"+m)})},c.update=function(){c.personForm.$setSubmitted(),c.personForm.$valid&&(c.person.id?c.person.$update().then(g.updateSuccess):c.person.$save().then(function(b){a.url(m+"/"+b.id+"/edit?_noback"),g.info("main.messages.create.success")}))},c["delete"]=h.deletePerson}]).controller("PersonsViewController",["$scope","$route","PersonService","QueryUtils",function(a,b,c,d){var e=b.current.params.id,f=d.endpoint("/persons");a.auth=b.current.locals.auth;var g=function(){c.usersAfterLoad(a.person.users),a.users=a.person.users};a.orderValue=function(b){return a.currentLanguageNameField(b.role)},a.person=f.get({id:e},g),a["delete"]=c.deletePerson}]).factory("PersonService",["$location","Classifier","DataUtils","dialogService","message",function(a,b,c,d,e){var f=b.valuemapper({role:"ROLL"}),g="/persons",h=function(b){d.confirmDialog({prompt:"person.deleteconfirm"},function(){b.$delete().then(function(){e.info("main.messages.delete.success"),a.url(g+"?_noback")})})},i=function(a){a&&f.objectmapper(a),c.convertStringToDates(a,["validThru","validFrom"]);for(var b=moment(),d=0;d<a.length;d++){var e=a[d];e.valid=(!e.validFrom||moment(e.validFrom).isSameOrBefore(b,"day"))&&(!e.validThru||moment(e.validThru).isSameOrAfter(b,"day"))}};return{usersAfterLoad:i,deletePerson:h}}]),angular.module("hitsaOis").config(["$routeProvider","USER_ROLES",function(a,b){a.when("/persons",{templateUrl:"persons/persons.search.html",controller:"SimpleListController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],clMapping:function(){return{role:"ROLL"}},params:function(){return{order:"p.lastname,p.firstname"}},url:function(){return"/users"}},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_KASUTAJA]}}).when("/persons/new",{templateUrl:"persons/persons.edit.html",controller:"PersonsEditController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_KASUTAJA]}}).when("/persons/:person/users/new",{templateUrl:"persons/users.edit.html",controller:"UsersEditController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_KASUTAJA]}}).when("/persons/:person/users/:user/edit",{templateUrl:"persons/users.edit.html",controller:"UsersEditController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_KASUTAJA]}}).when("/persons/:person/users/:user",{templateUrl:"persons/users.view.html",controller:"UsersViewController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_KASUTAJA]}}).when("/persons/:id/edit",{templateUrl:"persons/persons.edit.html",controller:"PersonsEditController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_KASUTAJA]}}).when("/persons/:id",{templateUrl:"persons/persons.view.html",controller:"PersonsViewController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_KASUTAJA]}})}]),angular.module("hitsaOis").controller("UsersEditController",["$location","$q","$rootScope","$route","$scope","dialogService","Classifier","message","QueryUtils","ArrayUtils","AuthService",function(a,b,c,d,e,f,g,h,i,j,k){function l(a){a&&(s[e.user.role]=e.objects.reduce(function(b,c){var d=c.code;return b[d]=e.permissions.reduce(function(b,c){var e=c.code;return b[e]=-1!==(a[d]||[]).indexOf(e),b},{}),b},{}))}function m(a){a.validFrom=new Date(a.validFrom),a.validThru&&(a.validThru=new Date(a.validThru))}function n(){var a=[];for(var b in e.objectsForRole)a.push(e.objectsForRole[b].code);return a}function o(){var a=n();for(var b in e.multiSelects){e.multiSelects[b]=!0;for(var c in e.rights)if(j.contains(a,c)&&k.isValidRolePermission(e.user.role,c,b)&&!e.rights[c][b]){e.multiSelects[b]=!1;break}}}var p=d.current.params.person,q=d.current.params.user,r=i.endpoint("/persons/"+p+"/users");e.auth=d.current.locals.auth,e.multiSelects={OIGUS_V:!1,OIGUS_M:!1,OIGUS_K:!1},e.noSchool=["ROLL_P","ROLL_V"],e.filterValues=["ROLL_L","ROLL_O","ROLL_T","ROLL_X"],e.auth.isMainAdmin()||e.filterValues.push("ROLL_P"),e.auth.isAdmin()&&e.filterValues.push("ROLL_V"),e.objects=g.queryForDropdown({mainClassCode:"TEEMAOIGUS"}),e.permissions=g.queryForDropdown({mainClassCode:"OIGUS"}),e.userRoleDefaults=i.endpoint("/users/rolesDefaults").search();var s={};e.multiSelectPermission=function(a,b){var c=n();for(var d in e.rights)j.contains(c,d)&&(e.rights[d][a]=k.isValidRolePermission(e.user.role,d,a)?b:!1)},e.showPermission=function(a,b){return k.isValidRolePermission(e.user.role,a,b)},e.roleChanged=function(){var a=e.user.role;-1!==e.noSchool.indexOf(a)&&(e.user.school=null);var b=e.userRoleDefaults.defaultRights[a]||{};e.objectsForRole=e.objects.filter(function(a){return b[a.code]}),s[a]||l(b),e.rights=s[a],o()},e["delete"]=function(){f.confirmDialog({prompt:"user.deleteconfirm"},function(){e.user.$delete().then(function(){h.info("main.messages.delete.success"),c.back("#/persons/"+p)})})},e.update=function(){if(e.userForm.$setSubmitted(),e.userForm.$valid){var b=function(a){return a.code};e.user.rights=e.objectsForRole.reduce(function(a,c){var d=c.code;return a[d]=e.permissions.filter(function(a){return e.rights[d][a.code]}).map(b),a},{}),e.user.id?e.user.$update().then(h.updateSuccess).then(function(){l(e.user.rights),m(e.user)}):e.user.$save().then(function(b){a.url("/persons/"+b.person.id+"/users/"+b.id+"/edit?_noback"),h.info("main.messages.create.success")})}},q?e.user=r.get({id:q},m):e.user=r.search({},m),b.all([e.objects.$promise,e.permissions.$promise,e.userRoleDefaults.$promise,e.user.$promise]).then(function(){l(e.user.rights),e.roleChanged()})}]).controller("UsersViewController",["$q","$route","$scope","Classifier","QueryUtils","AuthService",function(a,b,c,d,e,f){var g=b.current.params.person,h=b.current.params.user,i=e.endpoint("/persons/"+g+"/users");c.objects=d.queryForDropdown({mainClassCode:"TEEMAOIGUS"}),c.permissions=d.queryForDropdown({mainClassCode:"OIGUS"}),c.userRoleDefaults=e.endpoint("/users/rolesDefaults").search(),c.user=i.get({id:h}),c.showPermission=function(a,b){return f.isValidRolePermission(c.user.role,a,b)},a.all([c.objects.$promise,c.permissions.$promise,c.userRoleDefaults.$promise,c.user.$promise]).then(function(){var a=c.userRoleDefaults.defaultRights[c.user.role]||{};c.objects=c.objects.filter(function(b){return a[b.code]})})}]),angular.module("hitsaOis").controller("VocationalCurriculumController",["$scope","Classifier","dialogService","ClassifierConnect","ArrayUtils","message","oisFileService","QueryUtils","$route","DataUtils","$location","Curriculum","$q","config","$rootScope","Session",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){function q(){Y?h.endpoint("/curriculum/schoolDepartments/"+Y).query().$promise.then(function(b){a.schoolDepartments=b,a.vocationalCurriculumForm&&a.vocationalCurriculumForm.$setPristine()}):B()}function r(b){ba(b,a)}function s(){h.endpoint("/curriculum/studyLevels").query({curriculum:Y,isHigher:!1}).$promise.then(function(b){a.schoolOrigStudyLevel=b})}function t(a){a.occupationsCount=0;var b=a.stateCurriculumOccupations;b.forEach(function(b){a.selectedStateCurriculumOccupations[b.occupation.code]&&a.occupationsCount++}),a.partOccupationsCount=0,b.forEach(function(b){b.partOccupations.forEach(function(b){a.selectedStateCurriculumPartOccupations[b.code]&&a.partOccupationsCount++})}),a.occupationsAndPartOccupationsCount=a.occupationsCount+a.partOccupationsCount}function u(){a.curriculum.draft="OPPEKAVA_LOOMISE_VIIS_KUTSE"}function v(){a.vocationalCurriculumForm.isOccupation.$setPristine();var b=a.vocationalCurriculumForm.$$controls.find(function(a){return a.$dirty});b||a.vocationalCurriculumForm.$setPristine()}function w(a){var b=angular.copy(a);return b.occupation=b.occupation.code,b.partOccupations&&(b.partOccupations=b.partOccupations.map(function(a){return a.code})),b.specialities&&(b.specialities=b.specialities.map(function(a){return a.code})),b}function x(b){return a.formState.readOnly||a.formState.notEditableBasicData&&"KUTSEMOODUL_V"!==b.module}function y(b){var c="";c=b?x(b)?"/vocationalCurriculum/"+a.curriculum.id+"/module/"+b.id+"/view":"/vocationalCurriculum/"+a.curriculum.id+"/module/"+b.id+"/edit":"/vocationalCurriculum/"+a.curriculum.id+"/module/new",k.path(c)}function z(){return a.curriculum.ehisSchool?a.curriculum.ehisSchool:p.school&&p.school.ehisSchool?p.school.ehisSchool:null}function A(){var b=[];b.push(z()),angular.isArray(a.curriculum.jointPartners)&&(a.validation.jointPartnersLength=a.curriculum.jointPartners.length,a.curriculum.jointPartners.forEach(function(a){a.abroad||b.push(a.ehisSchool);
})),a.selectedJointPartners=b}function B(){h.endpoint("/curriculum/schoolDepartments").query({ehisShools:a.selectedJointPartners,curriculum:Y}).$promise.then(function(b){if(a.schoolDepartments=b,a.curriculum.schoolDepartments){var c=b.map(function(a){return a.id});a.curriculum.schoolDepartments=a.curriculum.schoolDepartments.filter(function(a){return e.includes(c,a)})}})}function C(){a.curriculum.abroad=!1,a.curriculum.jointPartners=[],a.curriculum.supervisor=void 0,a.curriculum.jointMentor=void 0,a.curriculum.contractEt=void 0,a.curriculum.contractEn=void 0}function D(){return e.isEmpty(a.curriculum.jointPartners)&&(angular.isDefined(a.curriculum.supervisor)||angular.isDefined(a.curriculum.contractEt)||angular.isDefined(a.curriculum.contractEn))}function E(){if(a.curriculum.joint){if(ja(),D()){var b={abroad:a.curriculum.abroad,supervisor:a.curriculum.supervisor,contractEt:a.curriculum.contractEt,contractEn:a.curriculum.contractEn};a.curriculum.jointPartners.push(b)}}else a.curriculum.jointMentor=void 0,a.curriculum.jointPartners=[]}function F(b){return e.contains(a.curriculum.addresses.map(function(a){return a.addressOv}),b.addressOv)}function G(){angular.isArray(a.curriculum.addresses)&&(a.validation.addressesLength=a.curriculum.addresses.length)}function H(){var b=a.curriculum.modules.filter(function(a){return"KUTSEMOODUL_V"!==a.module}),c=b.reduce(function(a,b){return a+=b.credits},0);return a.curriculum.optionalStudyCredits+c===a.curriculum.credits}function I(){for(var b=a.curriculum.curriculumOccupations,c=0;c<b.length;c++)if(!a.isOccutationsCreditsValid(b[c]))return!1;return!0}function J(b){return a.curriculum.modules.filter(function(a){return"KUTSEMOODUL_V"!==a.module}).filter(function(a){var c=a.occupations.map(function(a){return a});return e.includes(c,b)}).reduce(function(a,b){return b.isAdditional?a:a+b.credits},0)}function K(a){if(e.isEmpty(a.partOccupations))return 0;for(var b=0,c=a.partOccupations,d=0;d<c.length;d++)b+=J(c[d].code);return b}function L(){for(var b=a.curriculum.curriculumOccupations,c=0;c<b.length;c++)if(!e.isEmpty(b[c]).specialities)for(var d=b[c].specialities,f=0;f<d.length;f++)if(!a.isSpetsOccupationValid(d[f],b[c]))return!1;return!0}function M(b){if(e.isEmpty(b.partOccupations))return 0;for(var c=0,d=b.partOccupations.map(function(a){return a.code}),f=a.curriculum.modules.filter(function(a){return"KUTSEMOODUL_V"!==a.module&&!a.isAdditional}),g=0;g<f.length;g++){var h=f[g].occupations.map(function(a){return a}),i=e.intersection(h,d);if(0!==i.length){var j=e.includes(h,b.occupation.code)?1:0;c+=f[g].credits*(i.length+j-1)}}return c}function N(b){if(a.vocationalCurriculumForm.$setSubmitted(),!a.vocationalCurriculumForm.$valid){var c=b&&b.errorMessage?b.errorMessage:"main.messages.form-has-errors";return f.error(c),!1}if(a.strictValidation()){if(a.occupationRequired()&&e.isEmpty(a.curriculum.curriculumOccupations))return f.error("curriculum.error.noOccupation"),!1;if(e.isEmpty(a.curriculum.modules))return f.error("curriculum.error.noModule"),!1;if(!e.isEmpty(a.curriculum.curriculumOccupations)&&!a.allOccupationsHavePModule())return f.error("curriculum.error.noPModules"),!1;if(!e.isEmpty(a.curriculum.curriculumOccupations)&&!a.allModulesHaveOccupation())return f.error("curriculum.error.notAllModulesHaveOccupation"),!1;if(e.isEmpty(a.curriculum.curriculumOccupations)&&!T())return f.error("curriculum.error.noBasicModule"),!1;if(e.isEmpty(a.curriculum.curriculumOccupations)&&!H())return f.error("curriculum.error.modulesCredits"),!1;if(!e.isEmpty(a.curriculum.curriculumOccupations)&&!I())return f.error("curriculum.error.occupationsCredits"),!1;if(!e.isEmpty(a.curriculum.curriculumOccupations)&&!L())return f.error("curriculum.error.spetsOccupationsCredits"),!1;if(!a.hasRequiredFiles())return f.error("curriculum.error.noSummaryFile"),!1;if(!a.hasVerifiedVersions())return f.error("curriculum.error.noImplementationPlan"),!1}return!0}function O(b){if(N(b)){ja(),E();var c=new aa(ca(a.curriculum));angular.isDefined(a.curriculum.id)?c.$update().then(function(c){var d=b&&b.updateSuccess?b.updateSuccess:"main.messages.create.success";f.info(d),a.vocationalCurriculumForm.$setPristine(),ba(c,a)},function(){r(c)}):(c.newFiles=c.files,c.files=void 0,c.$save().then(function(){f.info("main.messages.create.success"),a.vocationalCurriculumForm.$setPristine(),k.path("/vocationalCurriculum/"+c.id+"/edit")},function(){r(c)}))}}function P(b,c){new b(a.curriculum).$update().then(function(b){f.info(c.updateSuccess),ba(b,a),a.vocationalCurriculumForm.$setPristine(),Q()})}function Q(){a.formState.readOnly||k.path("/vocationalCurriculum/"+a.curriculum.id+"/view")}function R(){aa.get({id:a.curriculum.id}).$promise.then(function(b){a.curriculum.modules=b.modules})}function S(){return a.curriculum.modules.filter(function(a){return"KUTSEMOODUL_P"===a.module})}function T(){return!e.isEmpty(S())}function U(b){return a.curriculum.modules.filter(function(a){var c=a.occupations.map(function(a){return a});return"KUTSEMOODUL_P"===a.module&&e.includes(c,b)})}function V(a,b){var c=0,d=a.type,e=b.type;if(d===e){var f=a.value,g=b.value;"string"===d?(f=f.toLowerCase(),g=g.toLowerCase()):"object"===d&&(angular.isObject(f)&&(f=a.index),angular.isObject(g)&&(g=b.index)),f!==g&&(c=g>f?-1:1)}else c="undefined"===d?1:"undefined"===e?-1:"null"===d?1:"null"===e?-1:e>d?-1:1;return c}var W="/curriculum",X=b.valuemapper({occupations:"KUTSE",partOccupations:"OSAKUTSE",specialities:"SPETSKUTSE"});a.auth=i.current.locals.auth,a.school=a.auth?a.auth.school:null;var Y=i.current.params.id,Z=h.endpoint("/curriculumOccupation"),$=Object.freeze({KUTSEMOODUL_P:0,KUTSEMOODUL_Y:1,KUTSEMOODUL_L:2,KUTSEMOODUL_V:3});a.publicUrl=n.apiUrl+"/public/curriculum/"+Y+"?format=json",a.maxStydyYears={max:100},a.STATUS=l.STATUS;var _;a.formState={readOnly:-1!==i.current.$$route.originalPath.indexOf("view")},q();var aa=h.endpoint(W),ba=function(b,c){a.formState.strictValidation=!1;var e=[],f=angular.extend({},b);if(a.isDraftEmployerSupportLetter="OPPEKAVA_LOOMISE_VIIS_TOOANDJA"===f.draft,f.jointPartners&&1===f.jointPartners.length&&!(f.jointPartners[0].ehisSchool||f.jointPartners[0].nameEt||f.jointPartners[0].nameEn)&&(f.jointPartners=[]),a.formState.notEditableBasicData=f.status===l.STATUS.VERIFIED,a.formState.sentToEhis="OPPEKAVA_EHIS_STAATUS_A"===f.ehisStatus||"OPPEKAVA_EHIS_STAATUS_M"===f.ehisStatus,j.convertStringToDates(f,["validFrom","validThru","approval"]),angular.isArray(b.jointPartners)&&b.jointPartners.length>0&&(f.supervisor=b.jointPartners[0].supervisor,f.contractEt=b.jointPartners[0].contractEt,f.contractEn=b.jointPartners[0].contractEn),f.studyPeriodMonths=b.studyPeriod%12,f.studyPeriodYears=Math.floor(b.studyPeriod/12),angular.isString(b.iscedClass)){var g=m.defer();d.queryAll({classifierCode:b.iscedClass,connectClassifierMainClassCode:"ISCED_SUUN"},function(a){a.length>0&&(f.fieldOfStudy=a[0].connectClassifier.code),d.queryAll({classifierCode:f.fieldOfStudy,connectClassifierMainClassCode:"ISCED_VALD"},function(a){0===a.length?g.reject():(f.areaOfStudy=a[0].connectClassifier.code,g.resolve())})}),e.push(g.promise)}m.all(e).then(function(){angular.extend(c.curriculum,f),G()})},ca=function(a){var b=angular.extend({},a);return a.studyPeriodMonths=a.studyPeriodMonths?a.studyPeriodMonths:0,b.studyPeriod=a.studyPeriodMonths+12*a.studyPeriodYears,b},da={selectedOccupationsPartOccupations:[],modules:[],occupations:[],files:[],addresses:[],jointPartners:[],studyLanguageClassifiers:[],studyFormClassifiers:[],abroad:!1},ea={validFrom:new Date,status:l.STATUS.ENTERING,consecution:"OPPEKAVA_TYPE_E",optionalStudyCredits:0,studyPeriodMonths:0,draft:"OPPEKAVA_LOOMISE_VIIS_KUTSE",higher:!1,joint:!1,abroad:!1,occupation:!1};a.curriculum=angular.extend({},da),a.validation={occupationsLength:0},a.curriculumPdfUrl=n.apiUrl+W+"/print/"+Y+"/general.pdf",a.curriculumModulesPdfUrl=n.apiUrl+W+"/print/"+Y+"/modules.pdf",a.curriculumCompetencesPdfUrl=n.apiUrl+W+"/print/"+Y+"/competences.pdf",a.$watchCollection("curriculum.curriculumOccupations",function(){a.validation.occupationsLength=a.curriculum&&a.curriculum.curriculumOccupations?a.curriculum.curriculumOccupations.length:0,a.curriculum&&"OPPEKAVA_LOOMISE_VIIS_TOOANDJA"===a.curriculum.draft&&(a.validation.occupationsLength=1)}),a.schoolOrigStudyLevel=[],s();var fa=angular.isDefined(i.current.locals.entity)?i.current.locals.entity.id:void 0;a.codeUniqueQuery={url:"/curriculum/unique/code",id:fa},a.merCodeUniqueQuery={url:"/curriculum/unique/merCode",id:fa},angular.isDefined(i.current.locals.entity)?(ba(i.current.locals.entity,a),_=h.endpoint("/curriculum/"+i.current.locals.entity.id+"/file"),o.removeLastUrlFromHistory(function(a){return a==="#/vocationalCurriculum/"+i.current.locals.entity.id+"/view"||a==="#/vocationalCurriculum/"+i.current.locals.entity.id+"/edit"||"#/vocationalCurriculum/new"===a})):angular.extend(a.curriculum,ea),a.draftOptions={},b.queryForDropdown({mainClassCode:"OPPEKAVA_LOOMISE_VIIS"},function(c){a.draftOptions=b.toMap(c)}),a.draftSelected=function(){"OPPEKAVA_LOOMISE_VIIS_RIIKLIK"===a.curriculum.draft?c.showDialog("vocationalCurriculum/dialog/state.curriculum.selection.dialog.html",function(b){b.selectedStateCurriculumOccupations={},b.selectedStateCurriculumPartOccupations={},b.selectedStateCurriculumSpecialities={},h.endpoint("/stateCurriculum/all").query({sort:a.currentLanguageNameField()+",asc",status:[l.STATUS.VERIFIED]}).$promise.then(function(a){b.stateCurriculums=a}),b.stateCurriculumSelected=function(a){b.selectedStateCurriculumOccupations={},b.selectedStateCurriculumPartOccupations={},b.selectedStateCurriculumSpecialities={},angular.isNumber(a)&&h.endpoint("/stateCurriculum").get({id:a}).$promise.then(function(a){X.objectmapper(a).$promise.then(function(a){var c=[];angular.isArray(a.occupations)&&a.occupations.forEach(function(a){var b={occupation:a};ha(b),c.push(b)}),b.stateCurriculumOccupations=c}),b.stateCurriculum=a}),b.occupationsCount=0,b.partOccupationsCount=0,b.occupationsAndPartOccupationsCount=0},b.countOccupationsAndPartOccupationsSelected=function(){t(b)},b.selectedSpecialitiesCount={},b.occupationSelected=function(a){var c=b.selectedStateCurriculumOccupations[a]===!0;b.stateCurriculumOccupations.forEach(function(d){d.occupation.code===a&&(d.partOccupations.forEach(function(a){b.selectedStateCurriculumPartOccupations[a.code]=c}),angular.isArray(d.specialities)&&d.specialities.length>0&&(b.selectedSpecialitiesCount[a]=c?0:void 0,d.specialities.forEach(function(a){b.selectedStateCurriculumSpecialities[a.code]=!1})))}),t(b)},b.specialitySelected=function(a,c){var d=b.selectedStateCurriculumSpecialities[c]===!0;if(angular.isNumber(b.selectedSpecialitiesCount[a])){var e=d?1:-1;b.selectedSpecialitiesCount[a]+=e}}},function(a){var b={id:a.stateCurriculum.id,occupations:[]};angular.isArray(a.stateCurriculumOccupations)&&a.stateCurriculumOccupations.forEach(function(c){var d;a.selectedStateCurriculumOccupations[c.occupation.code]===!0&&(d={occupation:c.occupation.code,specialities:[]},b.occupations.push(d)),angular.isArray(c.partOccupations)&&c.partOccupations.forEach(function(c){if(a.selectedStateCurriculumPartOccupations[c.code]===!0&&!d){var e={occupation:c.code};b.occupations.push(e)}}),angular.isArray(c.specialities)&&c.specialities.forEach(function(e){a.selectedStateCurriculumSpecialities[e.code]===!0&&(d||(d={occupation:c.occupation.code,specialities:[],occupationGrant:!1},b.occupations.push(d)),d.specialities.push(e.code))})}),h.endpoint("/curriculum/copy/statecurriculum").put(b).$promise.then(function(a){f.info("main.messages.create.success"),k.path("/vocationalCurriculum/"+a.id+"/edit")},u)},u):"OPPEKAVA_LOOMISE_VIIS_KOOL"===a.curriculum.draft?c.showDialog("vocationalCurriculum/dialog/school.curriculum.selection.dialog.html",function(a){a.curriculumSelected=[],a.fromStorage=function(){return{}},h.createQueryForm(a,"/curriculum"),a.toStorage=angular.noop;var b=a.getCriteria;a.getCriteria=function(){return angular.extend(b(),{isVocational:!0,isPartnerSchool:!1})},a.loadData()},function(a){var b=h.endpoint("/curriculum/copy/curriculum"),c=new b({id:a.curriculumSelected[0].id});c.$update().then(function(a){f.info("main.messages.create.success"),k.path("/vocationalCurriculum/"+a.id+"/edit")},u)},u):"OPPEKAVA_LOOMISE_VIIS_TOOANDJA"===a.curriculum.draft&&(a.curriculum.curriculumOccupations=[],a.curriculum.occupation=!1),a.isDraftEmployerSupportLetter="OPPEKAVA_LOOMISE_VIIS_TOOANDJA"===a.curriculum.draft};var ga=function(){var b={};angular.isArray(a.curriculum.curriculumOccupations)&&a.curriculum.curriculumOccupations.forEach(function(a){b[a.occupation.code]=!0,angular.isArray(a.partOccupations)&&a.partOccupations.forEach(function(a){b[a.code]=!0}),angular.isArray(a.specialities)&&a.specialities.forEach(function(a){b[a.code]=!0})}),angular.isArray(a.curriculum.modules)&&a.curriculum.modules.forEach(function(a){a.occupations=a.occupations.filter(function(a){return b[a]===!0})})};a.occupationChanged=function(){a.curriculum.curriculumOccupations=[],angular.isArray(a.curriculum.versions)&&a.curriculum.versions.forEach(function(a){a.occupationModules=[]}),ga()};var ha=function(a){angular.isDefined(a.occupation)&&d.queryAll({connectClassifierCode:a.occupation.code,classifierMainClassCode:["SPETSKUTSE","OSAKUTSE"]},function(c){var d=[],e=[];c.forEach(function(a){b.isValid(a.classifier)&&("SPETSKUTSE"===a.classifier.mainClassCode&&d.push(a.classifier),"OSAKUTSE"===a.classifier.mainClassCode&&e.push(a.classifier))}),a.specialities=d,a.partOccupations=e})};a.openOccupationDialog=function(b){c.showDialog("vocationalCurriculum/dialog/occupation.add.dialog.html",function(c){c.auth=a.auth,c.$watch("occupation",function(a,d){angular.isDefined(b)&&a.code!==d.code&&(c.selectedSpecialities={}),ha(c)}),c.formState={readOnly:a.formState.readOnly||a.formState.notEditableBasicData},c.selectedSpecialities={},angular.isDefined(b)&&(c.occupation=b.occupation,c.occupationGrant=b.occupationGrant,angular.isArray(b.specialities)&&b.specialities.forEach(function(a){c.selectedSpecialities[a.code]=!0}))},function(c){angular.isDefined(b)||(b={curriculum:Y}),b.occupation=c.occupation,b.occupationGrant=c.occupationGrant?c.occupationGrant:!1,b.partOccupations=c.partOccupations,b.specialities=[],c.specialities.forEach(function(a){c.selectedSpecialities[a.code]===!0&&b.specialities.push(a)});var d=w(b);d.id?new Z(d).$update().then(function(a){f.info("main.messages.update.success"),b=a,R(),v()}):new Z(d).$save().then(function(b){f.info("main.messages.create.success"),a.curriculum.curriculumOccupations.push(b),v()})})},a.openPartOccupationsDialog=function(d){c.showDialog("vocationalCurriculum/dialog/partOccupation.add.dialog.html",function(c){m.all([h.endpoint("/autocomplete/classifiers/withparents").query({mainClassCode:"OSAKUTSE"}).$promise,h.endpoint("/autocomplete/classifiers/withparents").query({mainClassCode:"KUTSE"}).$promise]).then(function(a){c.partOccupations=a[0],angular.isDefined(d)&&(c.partOccupationAquired=c.partOccupations.find(function(a){return a.code===d.occupation.code})),c.occupations=a[1].filter(function(a){return angular.isUndefined(c.partOccupationAquired)?b.isValid(a):angular.isUndefined(c.occupation)&&e.includes(c.partOccupationAquired.parents,a.code)?(c.occupation=a,!0):b.isValid(a)}).filter(function(a){for(var b=0;b<c.partOccupations.length;b++)if(e.includes(c.partOccupations[b].parents,a.code))return!0;return!1})}),c.filterPartOccupations=function(a){return b.isValid(a)?c.occupation?e.includes(a.parents,c.occupation.code):!0:!1},angular.isDefined(d),c.formState={readOnly:a.formState.readOnly||a.formState.notEditableBasicData}},function(b){angular.isDefined(d)||(d={occupationGrant:!1,curriculum:Y}),d.occupation=b.partOccupationAquired;var c=w(d);c.id?new Z(c).$update().then(function(a){f.info("main.messages.update.success"),d=a,R(),v()}):new Z(c).$save().then(function(b){f.info("main.messages.create.success"),a.curriculum.curriculumOccupations.push(b),v()})})},a.openAddModuleDialog=function(b){!a.formState.readOnly&&a.vocationalCurriculumForm.$dirty?c.confirmDialog({prompt:"main.messages.confirmFormDataNotSaved"},function(){y(b)}):y(b)};var ia=function(){if(angular.isArray(a.curriculum.modules)){var b=l.modulesViewData(a.curriculum.modules);a.occupationModuleTypesModules=b.occupationModuleTypesModules,a.modulesWithOutOccupation=b.modulesWithOutOccupation,a.validation.mainModuleCount=0,a.curriculum.modules.forEach(function(b){"KUTSEMOODUL_P"===b.module&&a.validation.mainModuleCount++});var c={};for(var d in a.occupationModuleTypesModules)if(!angular.isDefined(c[d])&&(c[d]=0,angular.isDefined(a.occupationModuleTypesModules[d].moduleTypes)))for(var e in a.occupationModuleTypesModules[d].moduleTypes)if(angular.isArray(a.occupationModuleTypesModules[d].moduleTypes[e].modules))for(var f in a.occupationModuleTypesModules[d].moduleTypes[e].modules)c[d]+=a.occupationModuleTypesModules[d].moduleTypes[e].modules[f].credits;a.creditsPerOccupation=c}};a.$watchCollection("curriculum.modules",ia),a.openAddFileDialog=function(){c.showDialog("curriculum/dialog/file.add.dialog.html",function(a){a.fileTypeCriteria={vocational:!0}},function(b){var c=b.data;c.sendEhis=!1,c.ehis=!1,c.oisFile=g.getFromLfFile(c.file[0],function(b){c.oisFile=b;var d=new _(c);d.$save().then(function(b){f.info("main.messages.create.success"),a.curriculum.files.push(b)})})})},a.deleteFile=function(b){c.confirmDialog({prompt:"curriculum.itemDeleteConfirm"},function(){e.remove(a.curriculum.files,b);var c=new _(b);c.$delete().then(function(){f.info("main.messages.delete.success")})})},a.getUrl=g.getUrl,a.addJointPartner=function(){var b={abroad:a.curriculum.abroad};b.abroad?(b.nameEt=a.curriculum.jointPartnerForeignNameEt,b.nameEn=a.curriculum.jointPartnerForeignNameEn):b.ehisSchool=a.curriculum.jointPartnerEhisSchool,a.curriculum.jointPartners.push(b),a.curriculum.jointPartnerForeignNameEt=void 0,a.curriculum.jointPartnerForeignNameEn=void 0,A(),B()},a.validation.jointPartnersLength=0,a.$watch("curriculum.joint",function(a,b){b&&!a?(C(),A(),B()):!b&&a&&A()}),a.removejointPartner=function(b){c.confirmDialog({prompt:"curriculum.itemDeleteConfirm"},function(){e.remove(a.curriculum.jointPartners,b),a.vocationalCurriculumForm.$setDirty(),A(),B()})};var ja=function(){a.curriculum.jointPartners.forEach(function(b){b.contractEt=a.curriculum.contractEt,b.contractEn=a.curriculum.contractEn,b.supervisor=a.curriculum.supervisor})};a.clearJointPartnersFields=function(){a.curriculum.jointPartnerForeignNameEt=void 0,a.curriculum.jointPartnerForeignNameEn=void 0,a.curriculum.jointPartnerEhisSchool=void 0},a.filterEmptyJointPartners=function(a){return a.ehisSchool||a.nameEt||a.nameEn},a.addAddress=function(){return F(a.formState.address)?void f.error("curriculum.error.addressAlreadyAdded"):(a.curriculum.addresses.push(a.formState.address),a.formState.address={},void G())},a.removeAddress=function(b){c.confirmDialog({prompt:"curriculum.itemDeleteConfirm"},function(){e.remove(a.curriculum.addresses,b),a.vocationalCurriculumForm.$setDirty(),G()})},a.isSpetsOccupationValid=function(b,c){var d=J(c.occupation.code),e=J(b.code),f=K(c),g=M(c),h=d+e+f+a.curriculum.optionalStudyCredits-g===a.curriculum.credits;return h},a.isOccutationsCreditsValid=function(b){var c=J(b.occupation.code),d=K(b);return c+=d,e.isEmpty(b.specialities)||(c+=J(b.specialities[0].code)),c-=M(b),a.curriculum.credits-a.curriculum.optionalStudyCredits===c},a.hasRequiredFiles=function(){var b=a.curriculum.files;return e.isEmpty(b)?!1:!e.isEmpty(b.filter(function(a){return"EHIS_FAIL_15773"===a.ehisFile&&a.sendEhis===!0&&a.oisFile&&"application/pdf"===a.oisFile.ftype}))},a.hasVerifiedVersions=function(){var b=a.curriculum.versions;return e.isEmpty(b)?!1:!e.isEmpty(b.filter(function(a){return a.status===l.VERSION_STATUS.K}))},a.notAllModulesHaveOccupation=function(){return a.vocationalCurriculumForm.$submitted&&a.strictValidation()&&(a.occupationRequired()||!e.isEmpty(a.curriculum.curriculumOccupations))&&!a.allModulesHaveOccupation()},a.save=function(){a.formState.strictValidation=!1,setTimeout(O,0)},a["delete"]=function(){c.confirmDialog({prompt:"curriculum.deleteconfirm"},function(){new aa(a.curriculum).$delete().then(function(){f.info("main.messages.delete.success"),k.path("/curriculum")})})},a.goToEditForm=function(){a.curriculum&&(a.curriculum.status===l.STATUS.VERIFIED?c.confirmDialog({prompt:"curriculum.prompt.editAccepted"},function(){k.path("/vocationalCurriculum/"+a.curriculum.id+"/edit")}):k.path("/vocationalCurriculum/"+a.curriculum.id+"/edit"))},a.canBeEdited=function(){var b=a.curriculum?a.curriculum.status:null;return a.formState.readOnly&&(b===l.STATUS.ENTERING||b===l.STATUS.PROCEEDING||b===l.STATUS.VERIFIED)},a.getStar=function(){return a.strictValidation()?"":" *"},a.strictValidation=function(){return a.curriculum&&(a.curriculum.status===l.STATUS.VERIFIED||a.curriculum.status===l.STATUS.PROCEEDING||a.formState.strictValidation)},a.saveAndProceed=function(){var b={prompt:a.formState.readOnly?"curriculum.statuschangeReadOnly.vocational.proceed":"curriculum.statuschange.vocational.proceed",errorMessage:"curriculum.error.inputFieldsNotFilledOnProcede",updateSuccess:"curriculum.success.proceed"};a.formState.strictValidation=!0,c.confirmDialog({prompt:b.prompt},function(){setTimeout(function(){if(N(b)){ca(a.curriculum,a);var c=h.endpoint("/curriculum/saveAndProceed");P(c,b)}},0)})},a.changeStatusUnderRevision=function(){var a={updateSuccess:"curriculum.success.opened"};c.confirmDialog({prompt:"curriculum.prompt.setStatusUnderRevision"},function(){setTimeout(function(){var b=h.endpoint(W+"/underrevision");P(b,a)})})},a.setStatusClosed=function(){var b={prompt:a.formState.readOnly?"curriculum.statuschangeReadOnly.vocational.close":"curriculum.statuschange.vocational.close",updateSuccess:"curriculum.success.closed"};c.confirmDialog({prompt:b.prompt},function(){var a=h.endpoint("/curriculum/close");P(a,b)})},a.sendToEhis=function(a){c.confirmDialog({prompt:"curriculum.ehisconfirm"},function(){var b=h.endpoint("/curriculum/sendToEhis"+(a?"/test":""));P(b,{updateSuccess:"curriculum.sentToEhis"})})},a.updateFromEhis=function(a){var b=h.endpoint("/curriculum/updateFromEhis"+(a?"/test":""));P(b,{updateSuccess:"curriculum.message.ehisStatusUpdated"})},a.isOccupationChanged=function(){if(!e.isEmpty(a.curriculum.curriculumOccupations)){var b=a.curriculum.occupation?"curriculum.prompt.hasOccupations":"curriculum.prompt.hasSubOccupations";a.curriculum.occupation=!a.curriculum.occupation,c.confirmDialog({prompt:b},function(){for(var b=0;b<a.curriculum.modules.length;b++)a.curriculum.modules[b].occupations=[];a.curriculum.curriculumOccupations=[],a.curriculum.occupation=!a.curriculum.occupation})}},b.queryForDropdown({mainClassCode:"KUTSEMOODUL"},function(b){a.moduleTypes=b,a.moduleTypes.sort(function(a,b){return $[a.code]-$[b.code]})}),a.getTotalCredits=function(a){return a.reduce(function(a,b){return a+b.credits},0)},a.filterEmptyModulesByType=function(a){return function(b){return b.module===a&&e.isEmpty(b.occupations)}},a.filterModulesByType=function(a,b){return function(c){var d=c.occupations;return c.module===a&&e.includes(d,b)}},a.filterTypesWithoutModules=function(a,b){return function(c){var d=b?b.filter(function(b){var d=b.occupations;return e.includes(d,a)&&b.module===c.code}):[];return!e.isEmpty(d)}},a.filterTypesWithoutEmptyModules=function(b){var c=a.curriculum.modules.filter(function(a){return e.isEmpty(a.occupations)}),d=c?c.filter(function(a){return a.module===b.code}):[];return!e.isEmpty(d)},a.removeOccupation=function(b){c.confirmDialog({prompt:"curriculum.itemDeleteConfirm"},function(){new Z(b).$delete().then(function(){f.info("main.messages.delete.success"),e.remove(a.curriculum.curriculumOccupations,b),R()})})},a.goToVersionNewForm=function(){var b="/vocationalCurriculum/"+a.curriculum.id+"/moduleImplementationPlan/new";!a.formState.readOnly&&a.vocationalCurriculumForm.$dirty?c.confirmDialog({prompt:"main.messages.confirmFormDataNotSaved"},function(){k.path(b)}):k.path(b)},a.goToImplementationPlanForm=function(b){var d=a.formState.readOnly||b.status!==l.VERSION_STATUS.S?"/vocationalCurriculum/"+a.curriculum.id+"/moduleImplementationPlan/"+b.id+"/view":"/vocationalCurriculum/"+a.curriculum.id+"/moduleImplementationPlan/"+b.id+"/edit";!a.formState.readOnly&&a.vocationalCurriculumForm.$dirty?c.confirmDialog({prompt:"main.messages.confirmFormDataNotSaved"},function(){k.path(d)}):k.path(d)},a.versionCanBeAdded=function(){return a.curriculum&&a.curriculum.canChange&&(a.curriculum.status===l.STATUS.ENTERING&&!a.formState.readOnly||a.curriculum.status===l.STATUS.PROCEEDING||a.curriculum.status===l.STATUS.VERIFIED)},a.allModulesHaveOccupation=function(){var b=a.getModulesWithoutOccupation();return e.isEmpty(b)},a.getModulesWithoutOccupation=function(){return a.curriculum.modules.filter(function(a){return e.isEmpty(a.occupations)})},a.modulesValid=function(){return e.isEmpty(a.curriculum.modules)?!1:e.isEmpty(a.curriculum.curriculumOccupations)?T()&&H():a.allModulesHaveOccupation()&&a.allOccupationsHavePModule()&&I()&&L()},a.allOccupationsHavePModule=function(){for(var b=a.curriculum.curriculumOccupations,c=0;c<b.length;c++){if(!a.occupationHasPModule(b[c].occupation.code))return!1;var d=b[c].specialities;if(!e.isEmpty(d))for(var f=0;f<d.length;f++)if(!a.occupationHasPModule(d[f].code))return!1;var g=b[c].partOccupations;if(!e.isEmpty(g))for(var h=0;h<g.length;h++)if(!a.occupationHasPModule(g[h].code))return!1}return!0},a.occupationHasPModule=function(a){return!e.isEmpty(U(a))},a.occupationRequired=function(){return"OPPEKAVA_LOOMISE_VIIS_KUTSE"===a.curriculum.draft||"OPPEKAVA_LOOMISE_VIIS_RIIKLIK"===a.curriculum.draft},a.occupationCanBeChanged=function(){return"OPPEKAVA_LOOMISE_VIIS_RIIKLIK"!==a.curriculum.draft},a.showPrintButton=function(){return angular.isDefined(a.curriculum.id)&&(a.auth.isAdmin()||a.curriculum.status===a.STATUS.VERIFIED)},a.searchTeacher=function(a){return h.endpoint("/curriculum/teachers").query({name:a}).$promise},a.compareUsingLanguage=function(b,c){if(angular.isObject(b)&&angular.isObject(c)){var d=a.currentLanguageNameField(b.value),e=a.currentLanguageNameField(c.value);return d||e?V({type:typeof d,value:d,index:b.index},{type:typeof e,value:e,index:c.index}):V(b,c)}return V(b,c)}}]),angular.module("hitsaOis").controller("VocationalCurriculumModuleImplementationPlanController",["$scope","Curriculum","Classifier","ClassifierConnect","QueryUtils","DataUtils","message","$location","$route","$q","dialogService","$routeParams","ArrayUtils","$rootScope","$http","config",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){function q(a){var b;return C.occupationModules.forEach(function(c){angular.isDefined(a)&&c.curriculumModule===a.id&&(b=c)}),b}function r(b,c){c=q(b);var d="";d=c?a.formState.readOnly?"/occupationModule/"+y.id+"/"+a.implementationPlan.id+"/"+b.id+"/"+c.id+"/view":"/occupationModule/"+y.id+"/"+a.implementationPlan.id+"/"+b.id+"/"+c.id+"/edit":"/occupationModule/"+y.id+"/"+a.implementationPlan.id+"/"+b.id+"/new",h.path(d)}function s(b){if(a.vocationalCurriculumModuleImplementationPlanForm.$setSubmitted(),!a.vocationalCurriculumModuleImplementationPlanForm.$valid){var c=b&&b.errorMessage?b.errorMessage:"main.messages.form-has-errors";return g.error(c),!1}return!0}function t(a,b){o({url:p.apiUrl+"/curriculumVersion/valid/hourscredits/"+z,method:"GET"}).then(function(c){c.data||(b.extraPrompts=[b.prompt],b.prompt="curriculum.error.themeCreditsAndHoursMismatch"),v(a,b)})}function u(a,b,c){s(b)&&(c?t(a,b):v(a,b))}function v(b,c){setTimeout(function(){k.confirmDialog({prompt:c.prompt,extraPrompts:c.extraPrompts},function(){new b(a.implementationPlan).$update().then(function(b){var d=c&&c.updateSuccess?c.updateSuccess:"main.messages.create.success";g.info(d),a.implementationPlan=b,f.convertStringToDates(a.implementationPlan,["validFrom","validThru"]),a.implementationPlan.curriculum=y.id,w(b),a.vocationalCurriculumModuleImplementationPlanForm.$setPristine()})})},0)}function w(b){a.formState.readOnly||h.path("/vocationalCurriculum/"+y.id+"/moduleImplementationPlan/"+b.id+"/view")}function x(a,b){var c=0,d=a.type,e=b.type;if(d===e){var f=a.value,g=b.value;"string"===d?(f=f.toLowerCase(),g=g.toLowerCase()):"object"===d&&(angular.isObject(f)&&(f=a.index),angular.isObject(g)&&(g=b.index)),f!==g&&(c=g>f?-1:1)}else c="undefined"===d?1:"undefined"===e?-1:"null"===d?1:"null"===e?-1:e>d?-1:1;return c}var y=i.current.locals.curriculum;a.initializing=!0,a.auth=i.current.locals.auth;var z=i.current.params.versionId,A=e.endpoint("/curriculumVersion"),B=Object.freeze({KUTSEMOODUL_P:0,KUTSEMOODUL_Y:1,KUTSEMOODUL_L:2,KUTSEMOODUL_V:3});a.CURRICULUM_STATUS=b.STATUS,a.VERSION_STATUS=b.VERSION_STATUS,a.formState={readOnly:-1!==i.current.$$route.originalPath.indexOf("view")};var C={curriculum:y.id,occupationModules:[]},D={status:b.VERSION_STATUS.S,validFrom:new Date,code:y.code+" - "+y.nameEt,curriculum:y.id};if(z)C=i.current.locals.curriculumVersion,a.publicUrl=p.apiUrl+"/public/curriculum/"+y.id+"/"+z+"?format=json",a.implementationPlan=C,f.convertStringToDates(a.implementationPlan,["validFrom","validThru"]),n.removeLastUrlFromHistory(function(b){return b&&-1!==b.indexOf("#/vocationalCurriculum/"+a.implementationPlan.curriculum+"/moduleImplementationPlan/")});else{var E=Math.floor(((y.studyPeriod||0)+11)/12);D.yearCapacities=Array.apply(null,{length:E}).fill(0),angular.extend(C,D),a.implementationPlan=C}a.curriculumVersionCodeUniqueQuery={id:z,url:"/curriculumVersion/unique/code"},a.curriculumId=y.id,a.studyForms=y.studyForms,a.curriculumStudyForms=y.studyForms;for(var F=[null],G=(new Date).getFullYear(),H=G-10;G+2>=H;H++)F.push(H);a.admissionYears=F,a.curriculumVersionPdfUrl=p.apiUrl+"/curriculum/print/"+z+"/curriculumVersion.pdf",a.curriculumVersionModulesPdfUrl=p.apiUrl+"/curriculum/print/"+z+"/curriculumVersionModules.pdf";var I=[];if(angular.isArray(y.modules)){var J=[];y.modules.forEach(function(a){var b={};if(angular.isString(a.module)){var d=c.get(a.module).$promise.then(function(c){angular.extend(b,a,{module:c})});I.push(d)}if(angular.isArray(a.occupations)){var e=[];a.occupations.forEach(function(a){e.push(c.get(a).$promise)});var f=j.all(e).then(function(a){angular.extend(b,{occupations:a})});I.push(j.all(f))}J.push(b)})}var K=[];angular.isArray(y.occupations)&&y.occupations.forEach(function(a){var b={};b.specialities=a.specialities;var d=c.get(a.occupation).$promise.then(function(c){angular.extend(b,a,{occupation:c})});I.push(d),K.push(b)}),j.all(I).then(function(){var c=b.modulesViewData(J);a.occupations=K,a.modules=y.modules,a.isOccupation=y.occupation,a.occupationModuleTypesModules=c.occupationModuleTypesModules,a.modulesWithOutOccupation=c.modulesWithOutOccupation,a.initializing=!1}),e.endpoint("/curriculumVersion/schoolDepartments/curriculum/"+y.id).query().$promise.then(function(b){a.schoolDepartments=b}),a.openViewModuleDialog=function(a){k.showDialog("vocationalCurriculum/implementationPlan/module.view.dialog.html",function(b){b.occupations=K,b.occupationsSelected={},b.partOccupationsSelected={},b.specialitiesSelected={},b.module={outcomes:[],occupations:[]},angular.isDefined(a)&&(angular.extend(b.module,a),angular.isArray(a.occupations)&&(b.module.occupations=a.occupations,a.occupations.forEach(function(a){angular.isDefined(a)&&(0===a.indexOf("KUTSE")||0===a.indexOf("OSAKUTSE")?b.occupationsSelected[a]=!0:0===a.indexOf("SPETSKUTSE")&&(b.specialitiesSelected[a]=!0))})))},null)},a.openAddModuleDataDialog=function(b,c){a.vocationalCurriculumModuleImplementationPlanForm.$dirty?k.confirmDialog({prompt:"main.messages.confirmFormDataNotSaved"},function(){r(b,c)}):r(b,c)},a.occupationModuleHasBaseModule=function(b){for(var c=0;c<a.implementationPlan.occupationModules.length;c++)if(a.implementationPlan.occupationModules[c].curriculumModule===b.id)return a.implementationPlan.occupationModules[c].baseModule?!0:!1;return null!==b.baseModule},a.isOccupationModuleDataSaved=function(b){
var c=!1;return a.implementationPlan.occupationModules.forEach(function(a){a.curriculumModule===b.id&&(c=!0)}),c},a.isModuleValid=function(b){return a.isOccupationModuleDataSaved(b)||"KUTSEMOODUL_V"===b.module},a.copy=function(){var a=e.endpoint("/curriculumVersion/copy");new a({id:z}).$update().then(function(a){g.info("main.messages.create.success"),h.path("/vocationalCurriculum/"+a.curriculum+"/moduleImplementationPlan/"+a.id+"/edit")})},a.anyModuleAdded=function(){return!m.isEmpty(a.modules)},a.save=function(b){if(s(b)){var c=new A(a.implementationPlan);angular.isDefined(a.implementationPlan.id)?c.$update().then(function(c){var d=b&&b.updateSuccess?b.updateSuccess:"main.messages.create.success";g.info(d),a.implementationPlan.version=c.version,a.vocationalCurriculumModuleImplementationPlanForm.$setPristine()}):c.$save().then(function(a){g.info("main.messages.create.success"),h.path("/vocationalCurriculum/"+y.id+"/moduleImplementationPlan/"+a.id+"/edit")})}},a["delete"]=function(){k.confirmDialog({prompt:"curriculum.prompt.deleteImplementationPlan"},function(){var b=new A(a.implementationPlan);b.$delete().then(function(){g.info("main.messages.delete.success"),n.back("#/vocationalCurriculum/"+y.id+"/view")})})},a.changeStatusUnderRevision=function(){var a={prompt:"curriculum.statuschange.implementationPlan.prompt.setStatusUnderRevision",updateSuccess:"curriculum.statuschange.implementationPlan.success.opened"},b=e.endpoint("/curriculumVersion/underrevision");u(b,a)},a.saveAndConfirm=function(){var b={prompt:a.formState.readOnly?"curriculum.statuschangeReadOnly.implementationPlan.prompt.verify":"curriculum.statuschange.implementationPlan.prompt.verify",updateSuccess:"curriculum.statuschange.implementationPlan.success.verified"},c=e.endpoint("/curriculumVersion/saveAndConfirm");u(c,b,!0)},a.confirm=function(){var b={prompt:a.formState.readOnly?"curriculum.statuschangeReadOnly.implementationPlan.prompt.verify":"curriculum.statuschange.implementationPlan.prompt.verify",updateSuccess:"curriculum.statuschange.implementationPlan.success.verified"},c=e.endpoint("/curriculumVersion/confirm");u(c,b,!0)},a.setStatusClosed=function(){var b={prompt:a.formState.readOnly?"curriculum.statuschangeReadOnly.implementationPlan.prompt.close":"curriculum.statuschange.implementationPlan.prompt.close",updateSuccess:"curriculum.statuschange.implementationPlan.success.closed"},c=e.endpoint("/curriculumVersion/close");u(c,b,!1)},a.goToEditForm=function(){if(a.curriculumId){var c="/vocationalCurriculum/"+y.id+"/moduleImplementationPlan/"+a.implementationPlan.id+"/edit";a.implementationPlan.status===b.VERSION_STATUS.K?k.confirmDialog({prompt:"curriculum.statuschange.implementationPlan.prompt.editAccepted"},function(){h.path(c)}):h.path(c)}},c.queryForDropdown({mainClassCode:"KUTSEMOODUL"},function(b){a.moduleTypes=b,a.moduleTypes.sort(function(a,b){return B[a.code]-B[b.code]})}),a.getTotalCredits=function(a){return a.reduce(function(a,b){return a+b.credits},0)},a.filterEmptyModulesByType=function(a){return function(b){return b.module===a&&m.isEmpty(b.occupations)}},a.filterModulesByType=function(a,b){return function(c){var d=c.occupations;return c.module===a&&m.includes(d,b)}},a.filterTypesWithoutModules=function(a,b){return function(c){var d=b?b.filter(function(b){var d=b.occupations;return m.includes(d,a)&&b.module===c.code}):[];return!m.isEmpty(d)}},a.filterTypesWithoutEmptyModules=function(b){var c=a.modules?a.modules.filter(function(a){return m.isEmpty(a.occupations)}):[],d=c?c.filter(function(a){return a.module===b.code}):[];return!m.isEmpty(d)},a.codeNameUnique=!0,a.$watch("implementationPlan.code",function(){a.implementationPlan.code?o({url:p.apiUrl+"/curriculumVersion/unique/code",method:"GET",params:{paramName:"nameEt",paramValue:a.implementationPlan.code,id:i.current.params.versionId}}).then(function(b){a.codeNameUnique=b.data}):a.codeNameUnique=!0}),a.showPrintButton=function(){return angular.isDefined(a.implementationPlan.id)&&(a.auth.isAdmin()||a.implementationPlan.status===a.VERSION_STATUS.K&&y.status===a.CURRICULUM_STATUS.VERIFIED)},a.compareUsingLanguage=function(b,c){if(angular.isObject(b)&&angular.isObject(c)){var d=a.currentLanguageNameField(b.value),e=a.currentLanguageNameField(c.value);return d||e?x({type:typeof d,value:d,index:b.index},{type:typeof e,value:e,index:c.index}):x(b,c)}return x(b,c)}}]),angular.module("hitsaOis").controller("VocationalCurriculumVersionOccupationModuleController",["$scope","$route","QueryUtils","Classifier","message","$location","ArrayUtils","dialogService","$rootScope","USER_ROLES",function(a,b,c,d,e,f,g,h,i,j){function k(){B?a.occupationModule=H.get({id:B}).$promise.then(function(b){t(b),a.viewMode=a.viewModes.MAIN,l()}):(t(new H(K)),l())}function l(){c.endpoint(G+"/curriculumModule").get({id:E}).$promise.then(function(b){a.curriculumModule=b,a.curriculumModule.baseModule&&!a.occupationModule.id&&(a.viewMode=a.viewModes.NEW),B||(a.occupationModule.assessmentsEt=b.assessmentsEt);var c=Math.floor(((b.studyPeriod||0)+11)/12);a.studyYears=Array.apply(null,{length:c}).map(function(a,b){return b+1}),B?v():a.occupationModule.yearCapacities=a.studyYears.map(function(a){return{credits:0,studyYearNumber:a}}),m()})}function m(){a.curriculumModule.baseModule&&a.auth.isAdmin()&&g.includes(a.auth.authorizedRoles,j.ROLE_OIGUS_V_TEEMAOIGUS_OPPEKAVA)&&c.endpoint("/basemodule/replace/"+a.curriculumModule.baseModule.id+"/"+a.curriculumModule.id+(B?"/"+B:"")).get().$promise.then(function(b){a.replaceForm=b,a.replaceForm.connections={},a.replaceForm.baseModuleThemes.forEach(function(a){a.selection={},b.occupationModules.forEach(function(b){a.selection[b.id]={selected:!1}})})})}function n(){a.occupationModule.$update().then(function(b){e.info("main.messages.update.success"),t(b),a.occupationModuleForm.$setPristine()})["catch"](angular.noop)}function o(){a.occupationModule.$save().then(function(a){e.info("main.messages.create.success"),f.path("/occupationModule/"+C+"/"+D+"/"+E+"/"+a.id+"/edit")})["catch"](angular.noop)}function p(){a.occupationModule.id?n():o()}function q(){h.confirmDialog({prompt:"basemodule.operation.createNewBaseModule.message"},function(){c.endpoint("/basemodule/generate/"+a.curriculumModule.id+"/"+a.occupationModule.id).get().$promise.then(function(){e.info("main.messages.create.success"),k()})})}function r(){return a.occupationModuleForm.$setSubmitted(),a.occupationModuleForm.$valid?!0:(e.error("main.messages.form-has-errors"),!1)}function s(){return a.replaceModuleForm.$setSubmitted(),a.replaceModuleForm.$valid?!0:(e.error("main.messages.form-has-errors"),!1)}function t(b){a.occupationModule=new H(b),a.occupationModule.baseModule&&(a.startMode=a.startModes.BASE_MODULE),a.occupationModule.supervisor&&(a.occupationModule.supervisor=a.occupationModule.supervisor.trim()),a.occupationModule.totalGradeDescription&&(a.occupationModule.totalGradeDescription=a.occupationModule.totalGradeDescription.trim()),a.occupationModule.requirementsEt&&(a.occupationModule.requirementsEt=a.occupationModule.requirementsEt.trim()),a.occupationModule.id||a.capacities.$promise.then(function(){a.occupationModule.capacities=a.capacities.map(y)}),v()}function u(b){c.endpoint("/basemodule/cm/"+a.curriculumModule.baseModule.id).get().$promise.then(function(c){a.occupationModule.requirementsEt=c.cvRequirementsEt,a.occupationModule.assessmentsEt=c.cvAssessmentsEt,a.occupationModule.learningMethodsEt=c.cvLearningMethodsEt,a.occupationModule.assessmentMethodsEt=c.cvAssessmentMethodsEt,a.occupationModule.assessment=c.cvAssessment,a.occupationModule.totalGradeDescription=c.cvTotalGradeDescription,a.occupationModule.passDescription=c.cvPassDescription,a.occupationModule.grade3Description=c.cvGrade3Description,a.occupationModule.grade4Description=c.cvGrade4Description,a.occupationModule.grade5Description=c.cvGrade5Description,a.occupationModule.independentStudyEt=c.cvIndependentStudyEt,a.occupationModule.studyMaterials=c.cvStudyMaterials,a.occupationModule.teacher=c.teacher,a.occupationModule.supervisor=c.teacher[a.currentLanguageNameField()],a.occupationModule.capacities=c.capacities.map(function(a){return{capacityType:a.capacityType,contact:a.contact,hours:a.hours,nameEn:a.nameEn,nameEt:a.nameEt}}),b()})}function v(){if(a.studyYears&&a.occupationModule&&a.occupationModule.yearCapacities){var b=a.studyYears.length;a.occupationModule.yearCapacities=a.occupationModule.yearCapacities.filter(function(a){return a.studyYearNumber<=b}).sort(function(a,b){return a.studyYearNumber-b.studyYearNumber})}}function w(){var b=a.occupationModule.capacities.reduce(function(a,b){return a+(b.hours?b.hours:0)},0);return b/J===a.curriculumModule.credits}function x(){var b=a.occupationModule.yearCapacities.reduce(function(a,b){return a+b.credits},0);return b===a.curriculumModule.credits}function y(a){return{capacityType:a.code,nameEt:a.nameEt,nameEn:a.nameEn}}function z(){H.get({id:B}).$promise.then(function(b){a.occupationModule.capacities=b.capacities,a.occupationModule.yearCapacities=b.yearCapacities,v()})}function A(a){for(var b=a.concat(),c=0;c<b.length;++c)for(var d=c+1;d<b.length;++d)b[c].capacityType===b[d].capacityType&&b.splice(d--,1);return b}a.viewModes=Object.freeze({NEW:0,REPLACE:1,MAIN:2}),a.startModes=Object.freeze({BASE_MODULE:0,COPY_MODULE:1,INDEPENDENT:2});var B=b.current.params.occupationModule,C=b.current.params.curriculum,D=b.current.params.version,E=b.current.params.curriculumModule,F=c.endpoint("/basemodule/teachers"),G="/occupationModule",H=c.endpoint(G),I=c.endpoint(G+"/theme"),J=26,K={curriculumModule:E,curriculumVersion:D,assessment:"KUTSEHINDAMISVIIS_E",yearCapacities:[{credits:0,studyYearNumber:1}],themes:[],capacities:[]};a.auth=b.current.locals.auth,a.hasBaseModuleRight=g.includes(a.auth.authorizedRoles,j.ROLE_OIGUS_M_TEEMAOIGUS_BAASMOODUL),a.viewMode=a.viewModes.MAIN,a.startMode=a.startModes.INDEPENDENT,a.formState={readOnly:-1!==b.current.$$route.originalPath.indexOf("view")},a.capacities=c.endpoint("/autocomplete/schoolCapacityTypes").query({isHigher:!1}),a.curriculumVersion=c.endpoint(G+"/curriculumVersion").get({id:D}),a.backToEditForm="#/vocationalCurriculum/"+C+"/moduleImplementationPlan/"+D+"/edit",a.backToViewForm="#/vocationalCurriculum/"+C+"/moduleImplementationPlan/"+D+"/view";var L={};a.selectChange=function(b,c,d){return d.selection[b].selected?(L[c]&&L[c].selection[b]&&(L[c].selection[b].selected=!1),delete L[c],delete a.replaceForm.connections[c],void(a.replaceForm.showOneToOneThemeError=!0)):(L[c]&&L[c].selection[b]&&(L[c].selection[b].selected=!1),L[c]=d,L[c].selection[b].selected=!0,void(a.replaceForm.showOneToOneThemeError=!1))},i.removeLastUrlFromHistory(function(a){return a&&-1!==a.indexOf("new")}),a.save=function(){r()&&(w()||x()?w()?x()?p():h.confirmDialog({prompt:"curriculum.prompt.occupationModuleYearCapacitiesMismatch"},p):h.confirmDialog({prompt:"curriculum.prompt.occupationModuleCapacitiesMismatch"},p):h.confirmDialog({prompt:"curriculum.prompt.capacitiesAndYearCapacitiesMismatch"},p))},a.hasThemes=function(){return a.occupationModule&&!g.isEmpty(a.occupationModule.themes)},a.deleteTheme=function(b){h.confirmDialog({prompt:"curriculum.prompt.deleteTheme"},function(){new I(b).$delete().then(function(){e.info("main.messages.delete.success"),g.remove(a.occupationModule.themes,b),z(),m()})})},a.createBaseModule=function(){r()&&a.occupationModule.id&&(a.occupationModuleForm.$dirty?h.confirmDialog({prompt:"main.messages.confirmFormDataNotSaved"},function(){a.occupationModule.$get({id:a.occupationModule.id}).then(q)}):q())},a.release=function(){h.confirmDialog({prompt:"basemodule.operation.release.message"},function(){c.endpoint("/basemodule/releaseMin/"+a.occupationModule.id).get().$promise.then(function(){e.info("basemodule.operation.release.success"),k()})["catch"](function(){e.error("basemodule.operation.release.fail")})})},a["continue"]=function(){switch(a.startMode){case a.startModes.BASE_MODULE:a.occupationModule.baseModule=a.curriculumModule.baseModule.id,u(p);break;case a.startModes.COPY_MODULE:a.occupationModule.baseModule=a.curriculumModule.baseModule.id,a.occupationModule.copy=!0,u(p)}a.viewMode=a.viewModes.MAIN},a["delete"]=function(){h.confirmDialog({prompt:"curriculum.prompt.deleteModule"},function(){new H(a.occupationModule).$delete().then(function(){e.info("main.messages.delete.success"),f.url("/vocationalCurriculum/"+C+"/moduleImplementationPlan/"+D+"/edit?_noback")})["catch"](angular.noop)})},a.replace=function(){if(s()){var b={};b.baseModule=a.replaceForm.baseModule.id,b.curriculumModule=a.replaceForm.curriculumModule.id,b.curriculumVersionOModules=[a.occupationModule.id],b.themeReferences={},a.replaceForm.occupationModules.forEach(function(c){b.themeReferences[c.id]={},a.replaceForm.themes[c.id].forEach(function(d){b.themeReferences[c.id][d.id]=a.replaceForm.connections[d.id].id})}),c.endpoint("/basemodule/replace").save(b).$promise.then(function(){e.info("basemodule.operation.replace.success"),a.viewMode=a.viewModes.MAIN,k()})["catch"](function(){e.error("basemodule.operation.replace.fail")})}},a.searchTeacher=function(b){return a.occupationModuleForm.$setDirty(),F.query({name:b}).$promise},a.openAddThemeDialog=function(b){var c=a.formState.readOnly?"vocationalCurriculum/implementationPlan/occupation.module.theme.view.dialog.html":"vocationalCurriculum/implementationPlan/occupation.module.theme.edit.dialog.html";h.showDialog(c,function(c){function f(a){return a.dialogForm.$setSubmitted(),a.dialogForm.$valid?a.occupationModuleTheme.hours!==Math.round(J*a.occupationModuleTheme.credits)&&a.occupationModuleTheme.credits!==Math.round(a.occupationModuleTheme.hours/J*10)/10?(e.error("curriculum.error.themeCreditsAndHoursMismatch"),!1):h()?!0:(e.error("curriculum.error.themeCapacitiesAndHoursMismatch"),!1):(e.error("main.messages.form-has-errors"),!1)}function h(){return c.occupationModuleTheme.hours===c.occupationModuleTheme.capacities.reduce(function(a,b){return angular.isDefined(b.hours)?a+=b.hours:a},0)}var i,j=a.occupationModule;c.hasBaseModule=!(angular.isUndefined(a.occupationModule.baseModule)||null===a.occupationModule.baseModule),angular.isArray(j.themes)||(j.themes=[]),angular.isDefined(b)?(b.capacities=A(b.capacities.concat(a.capacities.map(y))),c.occupationModuleTheme=angular.copy(b)):c.occupationModuleTheme={capacities:a.capacities.map(y),assessment:"KUTSEHINDAMISVIIS_E",module:a.occupationModule.id},c.outcomes=a.curriculumModule.outcomes,c.setDefaultHours=function(){if(angular.isNumber(c.occupationModuleTheme.credits)){c.occupationModuleTheme.hours=Math.round(J*c.occupationModuleTheme.credits),c.dialogForm.hours.$setDirty();var a=Math.round(c.occupationModuleTheme.credits/j.credits*100);c.occupationModuleTheme.proportion&&i!==c.occupationModuleTheme.proportion||(i=a,c.occupationModuleTheme.proportion=a)}},c.studyYears=a.studyYears,c.assessments=d.queryForDropdown({mainClassCode:"KUTSEHINDAMISVIIS"}),c.setDefaultCredits=function(){c.occupationModuleTheme.credits=Math.round(c.occupationModuleTheme.hours/J*10)/10,c.dialogForm.credits.$setDirty();var a=Math.round(c.occupationModuleTheme.credits/j.credits*100);c.occupationModuleTheme.proportion&&i!==c.occupationModuleTheme.proportion||(i=a,c.occupationModuleTheme.proportion=a)},c.getOutcomesByIds=function(a){return angular.isArray(a)?c.outcomes.filter(function(b){for(var c=0;c<a.length;c++)if(a[c]===b.id)return!0;return!1}):[]},c.joinOutcomes=function(b,c){return!b||angular.isUndefined(c)?"":b.map(function(b){return"en"===a.currentLanguage()?b.outcomeEn:b.outcomeEt}).join(c)},c.saveTheme=function(){var a=c;f(a)&&(angular.isDefined(b)?new I(a.occupationModuleTheme).$update().then(function(a){e.info("main.messages.update.success"),g.remove(j.themes,b),j.themes.push(a),z(),c.cancel(),m()}):new I(a.occupationModuleTheme).$save().then(function(a){e.info("main.messages.create.success"),j.themes.push(a),z(),c.cancel(),m()}))}},function(){})},k()}]),angular.module("hitsaOis").config(["$routeProvider","USER_ROLES",function(a,b){function c(a,b,c,d,e){d.resolve().then(function(d){d.isAdmin()&&c.includes(d.authorizedRoles,e.ROLE_OIGUS_M_TEEMAOIGUS_OPPEKAVA)||(a.error("main.messages.error.nopermission"),b.path(""))})}c.$inject=["message","$location","ArrayUtils","AuthResolver","USER_ROLES"],a.when("/vocationalCurriculum/new",{templateUrl:"vocationalCurriculum/vocational.curriculum.html",controller:"VocationalCurriculumController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],checkAccess:c},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_OPPEKAVA]}}).when("/vocationalCurriculum/:id/edit",{templateUrl:"vocationalCurriculum/vocational.curriculum.html",controller:"VocationalCurriculumController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],entity:["QueryUtils","$route",function(a,b){return a.endpoint("/curriculum").get({id:b.current.params.id}).$promise}],checkAccess:c},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_OPPEKAVA]}}).when("/vocationalCurriculum/:id/view",{templateUrl:"vocationalCurriculum/vocational.curriculum.view.html",controller:"VocationalCurriculumController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],entity:["QueryUtils","$route",function(a,b){return a.endpoint("/curriculum").get({id:b.current.params.id}).$promise}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_OPPEKAVA,b.ROLE_OIGUS_V_TEEMAOIGUS_RIIKLIKOPPEKAVA]}}).when("/vocationalCurriculum/:id/moduleImplementationPlan/new",{templateUrl:"vocationalCurriculum/implementationPlan/implementation.plan.html",controller:"VocationalCurriculumModuleImplementationPlanController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],curriculum:["QueryUtils","$route",function(a,b){return a.endpoint("/curriculumVersion/curriculum").get({id:b.current.params.id}).$promise}],checkAccess:c},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_OPPEKAVA]}}).when("/vocationalCurriculum/:id/moduleImplementationPlan/:versionId/edit",{templateUrl:"vocationalCurriculum/implementationPlan/implementation.plan.html",controller:"VocationalCurriculumModuleImplementationPlanController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],curriculum:["QueryUtils","$route",function(a,b){return a.endpoint("/curriculumVersion/curriculum").get({id:b.current.params.id}).$promise}],curriculumVersion:["QueryUtils","$route",function(a,b){return a.endpoint("/curriculumVersion").get({id:b.current.params.versionId}).$promise}],checkAccess:c},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_OPPEKAVA]}}).when("/vocationalCurriculum/:id/moduleImplementationPlan/:versionId/view",{templateUrl:"vocationalCurriculum/implementationPlan/implementation.plan.view.html",controller:"VocationalCurriculumModuleImplementationPlanController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],curriculum:["QueryUtils","$route",function(a,b){return a.endpoint("/curriculumVersion/curriculum").get({id:b.current.params.id}).$promise}],curriculumVersion:["QueryUtils","$route",function(a,b){return a.endpoint("/curriculumVersion").get({id:b.current.params.versionId}).$promise}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_OPPEKAVA,b.ROLE_OIGUS_V_TEEMAOIGUS_RIIKLIKOPPEKAVA]}}).when("/vocationalCurriculum/:curriculum/module/new",{templateUrl:"vocationalCurriculum/module/vocational.curriculum.module.edit.html",controller:"VocationalCurriculumModuleController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],checkAccess:c},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_OPPEKAVA]}}).when("/vocationalCurriculum/:curriculum/module/:id/view",{templateUrl:"vocationalCurriculum/module/vocational.curriculum.module.view.html",controller:"VocationalCurriculumModuleController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_OPPEKAVA,b.ROLE_OIGUS_V_TEEMAOIGUS_RIIKLIKOPPEKAVA]}}).when("/vocationalCurriculum/:curriculum/module/:id/edit",{templateUrl:"vocationalCurriculum/module/vocational.curriculum.module.edit.html",controller:"VocationalCurriculumModuleController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],checkAccess:c},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_OPPEKAVA]}}).when("/occupationModule/:curriculum/:version/:curriculumModule/new",{templateUrl:"vocationalCurriculum/implementationPlan/occupation.module.edit.html",controller:"VocationalCurriculumVersionOccupationModuleController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],checkAccess:c},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_OPPEKAVA]}}).when("/occupationModule/:curriculum/:version/:curriculumModule/:occupationModule/edit",{templateUrl:"vocationalCurriculum/implementationPlan/occupation.module.edit.html",controller:"VocationalCurriculumVersionOccupationModuleController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],checkAccess:c},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_OPPEKAVA]}}).when("/occupationModule/:curriculum/:version/:curriculumModule/:occupationModule/view",{templateUrl:"vocationalCurriculum/implementationPlan/occupation.module.view.html",controller:"VocationalCurriculumVersionOccupationModuleController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_OPPEKAVA,b.ROLE_OIGUS_V_TEEMAOIGUS_RIIKLIKOPPEKAVA]}})}]),angular.module("hitsaOis").controller("VocationalCurriculumModuleController",["$scope","$route","QueryUtils","dialogService","message","ArrayUtils","$location","$rootScope","USER_ROLES",function(a,b,c,d,e,f,g,h,i){function j(){t?v.get({id:t}).$promise.then(n):(a.module=new v(B),c.endpoint(u+"/curriculum/"+a.curriculumId).search().$promise.then(function(b){a.module.curriculumOccupations=b.occupations,a.module.occupation=b.occupation,a.module.canHaveOccupations=b.canHaveOccupations}))}function k(){a.module.$update().then(function(b){e.info("main.messages.update.success"),n(b),a.vocationalCurriculumModuleForm.$setPristine()})}function l(){a.module.$save().then(function(b){e.info("main.messages.create.success"),g.path("/vocationalCurriculum/"+a.module.curriculum+"/module/"+b.id+"/edit")})}function m(){a.module.outcomes.forEach(function(b){b.orderNr=a.module.outcomes.indexOf(b)}),o(a,a.module)}function n(b){a.module=b,a.module.baseModule&&(a.baseModuleUsed=!0,a.moduleType=a.moduleTypes.BASE_MODULE,a.baseModule=a.module.baseModule),a.module.outcomes.forEach(function(b){angular.isDefined(b.orderNr)||(b.orderNr=a.module.outcomes.indexOf(b))}),a.module.outcomes.sort(function(a,b){return a.orderNr-b.orderNr}),angular.isArray(a.module.occupations)&&a.module.occupations.forEach(function(b){0===b.indexOf("KUTSE")||0===b.indexOf("OSAKUTSE")?a.occupationsSelected[b]=!0:0===b.indexOf("SPETSKUTSE")&&(a.specialitiesSelected[b]=!0)})}function o(a,b){b.occupations=[],b.curriculumOccupations.forEach(function(c){a.occupationsSelected[c.occupation]===!0&&b.occupations.push(c.occupation),angular.isArray(c.partOccupations)&&c.partOccupations.forEach(function(c){a.occupationsSelected[c]===!0&&b.occupations.push(c)}),angular.isArray(c.specialities)&&c.specialities.forEach(function(c){a.specialitiesSelected[c]===!0&&b.occupations.push(c)})})}function p(){return w&&t?!0:(a.vocationalCurriculumModuleForm.$setSubmitted(),a.vocationalCurriculumModuleForm.$valid?!0:(e.error("main.messages.form-has-errors"),!1))}function q(){return a.replaceModuleForm.$setSubmitted(),a.replaceModuleForm.$valid?!0:(e.error("main.messages.form-has-errors"),!1)}function r(b){(angular.isDefined(a.replaceBaseModuleForm)||b)&&(a.baseModuleNameTemplate="",a.baseModuleTemplate=void 0,a.replaceBaseModuleForm=void 0,a.replaceModuleForm.showNotEnoughOutcomesError=!1,a.replaceModuleForm.showOneToOneOutcomeError=!1,a.replaceModuleForm.showOneToOneThemeError=!1,x={},y={})}function s(){if(!a.module||!a.module.curriculumOccupations)return!0;for(var b=a.module.curriculumOccupations,c=0;c<b.length;c++){var d=b[c].occupation,e=a.occupationsSelected[d];if(e){var f=b[c].specialities;if(f)for(var g=0;g<f.length;g++)if(a.specialitiesSelected[f[g]])return null}}return!0}a.moduleTypes=Object.freeze({NEW_MODULE:0,BASE_MODULE:1});var t=b.current.params.id,u="/curriculumModule",v=c.endpoint(u),w=-1!==b.current.$$route.originalPath.indexOf("view"),x={},y={},z=32,A=7;a.auth=b.current.locals.auth,a.hasBaseModuleRight=f.includes(a.auth.authorizedRoles,i.ROLE_OIGUS_M_TEEMAOIGUS_BAASMOODUL),a.curriculumId=b.current.params.curriculum,a.occupationsSelected={},a.specialitiesSelected={},a.competences=[],a.curriculum=c.endpoint(u+"/curriculumMin").get({id:a.curriculumId}),c.endpoint(u+"/competences/curriculum/"+a.curriculumId).query().$promise.then(function(b){a.competences=b,a.vocationalCurriculumModuleForm&&a.vocationalCurriculumModuleForm.$setPristine()}),a.possibleTypes=c.endpoint(u+"/types").query({module:t,curriculum:a.curriculumId}),a.moduleType=a.moduleTypes.NEW_MODULE,a.baseModuleUsed=!1;var B={curriculum:a.curriculumId,occupations:[],competences:[],outcomes:[],practice:!1};h.removeLastUrlFromHistory(function(a){return a&&-1!==a.indexOf("new")}),a.save=function(){p()&&(m(),a.module.id?k():l())},a["delete"]=function(){d.confirmDialog({prompt:"module.messages.prompt.delete"},function(){a.module.$delete().then(function(){e.info("main.messages.delete.success"),h.back("#/vocationalCurriculum/"+a.module.curriculum+"/edit")})})},a.$watch("module.module",function(b,c){b!==c&&angular.isDefined(a.curriculum)&&"OPPEKAVA_LOOMISE_VIIS_RIIKLIK"===a.curriculum.draft&&("KUTSEMOODUL_Y"===c||"KUTSEMOODUL_P"===c||a.module.id&&!a.module.basicDataCanBeEdited&&"KUTSEMOODUL_L"===c)&&d.confirmDialog({prompt:"curriculum.prompt.confirmModuleTypeChange"},function(){},function(){a.module.module=c})}),a.isEditingOutcome=!1,a.editedOutcome=null,a.addOutcome=function(){angular.isString(a.outcomeEt)&&""!==a.outcomeEt&&(a.module.outcomes.push({outcomeEt:a.outcomeEt,outcomeEn:a.outcomeEn,order:a.module.outcomes.length}),a.outcomeEt=void 0,a.outcomeEn=void 0)},a.swap=function(b,c){var d=a.module.outcomes[b];a.module.outcomes[b]=a.module.outcomes[c],a.module.outcomes[c]=d,a.vocationalCurriculumModuleForm.$setDirty()},a.editOutcome=function(b){a.isEditingOutcome=!0,a.editedOutcome=b,a.outcomeEt=b.outcomeEt,a.outcomeEn=b.outcomeEn},a.saveOutcome=function(){angular.isString(a.outcomeEt)&&""!==a.outcomeEt&&(a.isEditingOutcome=!1,a.editedOutcome.outcomeEt=a.outcomeEt,a.editedOutcome.outcomeEn=a.outcomeEn,a.outcomeEt=void 0,a.outcomeEn=void 0)},a.removeFromArray=function(b,c){d.confirmDialog({prompt:"curriculum.itemDeleteConfirm"},function(){f.remove(b,c),a.vocationalCurriculumModuleForm.$setDirty()})},a.radioChange=function(){a.module.baseModule=null},a.getBaseModule=function(b){angular.isDefined(b)&&!a.baseModuleUsed&&c.endpoint("/basemodule/cm").get({id:b.id}).$promise.then(function(b){a.module.baseModule=b,a.module.credits=b.credits,a.module.nameEt=b.nameEt,a.module.nameEn=b.nameEn,a.module.objectivesEt=b.objectivesEt,a.module.objectivesEn=b.objectivesEn,a.module.outcomes=b.outcomes,a.module.outcomes.forEach(function(b){b.id=null,angular.isDefined(b.orderNr)||(b.orderNr=a.module.outcomes.indexOf(b))}),a.module.outcomes.sort(function(a,b){return a.orderNr-b.orderNr}),a.module.assessmentsEt=b.assessmentsEt,a.module.assessmentsEn=b.assessmentsEn})},a.getReplaceForm=function(b){r(),angular.isDefined(b)&&c.endpoint("/basemodule/replace/"+b.id+"/"+a.module.id).get().$promise.then(function(b){b.outcomes?(a.replaceModuleForm.showNotEnoughOutcomesError=!1,a.replaceBaseModuleForm=b,a.replaceBaseModuleForm.connections={},a.replaceBaseModuleForm.baseModuleThemes.forEach(function(b){b.selection={},a.replaceBaseModuleForm.occupationModules.forEach(function(a){b.selection[a.id]={selected:!1}})}),a.replaceBaseModuleForm.occupationModules.forEach(function(b){b.enabled=angular.isDefined(a.replaceBaseModuleForm.themes[b.id])}),angular.equals(a.replaceBaseModuleForm.themes,{})&&(a.replaceBaseModuleForm.themes=void 0)):(r(),a.replaceModuleForm.showNotEnoughOutcomesError=!0)})},a.switchView=function(b){a.showReplaceMenu=b,r(!0)},a.replace=function(){if(q()){var b={};b.baseModule=a.replaceBaseModuleForm.baseModule.id,b.curriculumModule=a.replaceBaseModuleForm.curriculumModule.id,b.curriculumVersionOModules=a.replaceBaseModuleForm.occupationModules.filter(function(a){return a.enabled}).map(function(a){return a.id}),b.themeReferences={},b.curriculumVersionOModules.forEach(function(c){b.themeReferences[c]={},a.replaceBaseModuleForm.themes[c].forEach(function(d){b.themeReferences[c][d.id]=a.replaceBaseModuleForm.connections[d.id].id})}),b.outcomeReferences={},a.replaceBaseModuleForm.outcomes.forEach(function(c){b.outcomeReferences[c.id]=a.replaceBaseModuleForm.connectionsOutcome[c.id].id}),c.endpoint("/basemodule/replace").save(b).$promise.then(function(){e.info("basemodule.operation.replace.success"),a.showReplaceMenu=!1,j()})["catch"](function(){e.error("basemodule.operation.replace.fail")})}},a.selectChange=function(b,c,d){return d.selection[b].selected?(x[c]&&x[c].selection[b]&&(x[c].selection[b].selected=!1),delete x[c],delete a.replaceBaseModuleForm.connections[c],void(a.replaceModuleForm.showOneToOneThemeError=!0)):(x[c]&&x[c].selection[b]&&(x[c].selection[b].selected=!1),x[c]=d,x[c].selection[b].selected=!0,void(a.replaceModuleForm.showOneToOneThemeError=!1))},a.selectChangeOutcome=function(b,c){return c.selected?(y[b]&&(y[b].selected=!1),delete y[b],delete a.replaceBaseModuleForm.connectionsOutcome[b],void(a.replaceModuleForm.showOneToOneOutcomeError=!0)):(y[b]&&(y[b].selected=!1),y[b]=c,y[b].selected=!0,void(a.replaceModuleForm.showOneToOneOutcomeError=!1))},a.searchBaseModule=function(a){return c.endpoint("/autocomplete/basemodules").query({name:a,notExpired:!0},function(a){document.querySelector("md-virtual-repeat-container.md-autocomplete-suggestions-container").style.setProperty("min-height",z*(a.length>A?A:a.length)+"px","important")}).$promise},a.releaseModule=function(){d.confirmDialog({prompt:"basemodule.operation.release.message"},function(){c.endpoint("/basemodule/release/"+a.module.id).get().$promise.then(function(){a.module.baseModule=null,a.baseModuleUsed=!1,a.baseModule=void 0,a.moduleType=a.moduleTypes.NEW_MODULE,e.info("basemodule.operation.release.success")})["catch"](function(){e.error("basemodule.operation.release.fail")})})},a.occupationsValid=s(),a.validateOccupations=function(){a.occupationsValid=s()},j()}]),angular.module("hitsaOis").controller("StudentEhisController",["$scope","message","QueryUtils","$timeout","dialogService","$filter","$translate","busyHandler",function(a,b,c,d,e,f,g,h){function i(b){if("VOTA"===a.criteria.dataType){var c=[];return b.forEach(function(a){angular.isArray(a.records)&&a.records.length>0?(c.push(angular.extend({},a,a.records[0])),a.records.forEach(function(a,b){b>0&&c.push(a)})):c.push(a)}),c}return b}function j(){c.loadingWheel(a,!0,!1,g.instant("ehis.messages.requestInProgress"),!0),
c.endpoint("/students/ehisStudentExport").save2(a.criteria).$promise.then(function(a){d(function(){k(a.key)},1e3)})["catch"](function(){c.loadingWheel(a,!1)})}function k(e){c.endpoint("/students/ehisStudentExportStatus").get({key:e}).$promise.then(function(f){a.cancelledBy&&(a.cancelledBy=null),"IN_PROGRESS"===f.status?(h.setProgress(Math.round(100*f.progress)),d(function(){k(e)},5e3)):"DONE"===f.status?(b.info(f&&f.result.length>0?"ehis.messages.exportFinished":"ehis.messages.nostudentsfound"),a.result=i(f.result),h.setProgress(100),c.loadingWheel(a,!1)):(b.error("ehis.messages.taskStatus."+f.status,{error:f.error}),"CANCELLED"!==f.status&&"INTERRUPTED"!==f.status||!f.result||(a.cancelledBy=f.cancelledBy,a.result=i(f.result)),c.loadingWheel(a,!1))})}var l="COURSE_CHANGE",m="CURRICULA_FULFILMENT",n="DORMITORY",o="FOREIGN_STUDY",p="GRADUATION",q="VOTA",r="SPECIAL_NEEDS";a.dataTypes=[{type:l,translate:g.instant("ehis.student.COURSE_CHANGE")},{type:m,translate:g.instant("ehis.student.CURRICULA_FULFILMENT")},{type:n,translate:g.instant("ehis.student.DORMITORY")},{type:o,translate:g.instant("ehis.student.FOREIGN_STUDY")},{type:p,translate:g.instant("ehis.student.GRADUATION")},{type:q,translate:g.instant("ehis.student.VOTA")},{type:r,translate:g.instant("ehis.student.SPECIAL_NEEDS")}],a.displayDates=[l,n,o,p,q,r],a.criteria={from:new Date,thru:new Date},a.exportStudents=function(){a.studentExportForm.$valid?c.endpoint("/students/ehisStudentExportCheck").get(a.criteria).$promise.then(function(a){a&&a.user?e.confirmDialog({prompt:a.from?"ehis.messages.overlappedRequestDateRange":"ehis.messages.overlappedRequest",user:a.user,type:g.instant("ehis.student."+a.type),from:f("hoisDate")(a.from),thru:f("hoisDate")(a.thru)},function(){j()}):j()})["catch"](angular.noop):b.error("main.messages.form-has-errors")}}]),angular.module("hitsaOis").controller("EhisLogsController",["$mdDialog","$route","$scope","QueryUtils","Session",function(a,b,c,d,e){c.auth=b.current.locals.auth;var f=e.school||{};c.messageTypes=["laeKorgharidus","oisOppekava","oisOppekavaStaatus"],f.higher&&c.messageTypes.push("laeOppejoud"),f.vocational&&c.messageTypes.push("laePedagoogid"),c.messageTypesWithTeacher=["laeOppejoud","laePedagoogid"];var g="/logs/ehis";d.createQueryForm(c,g,{order:"-inserted"}),c.loadData(),c.logentry=function(b){a.show({controller:["$scope",function(c){var e=1e3;c.requestLength=c.responseLength=e,c.cancel=a.hide,c.showAll=function(a){a?c.requestLength=void 0:c.responseLength=void 0},c.record=d.endpoint(g).get({id:b.id,messageType:b.wsName},function(a){(!a.request||a.request.length<e)&&c.showAll(!0),(!a.response||a.response.length<e)&&c.showAll(!1)})}],templateUrl:"ehis/logentry.view.dialog.html",clickOutsideToClose:!0})}}]),angular.module("hitsaOis").controller("TeacherExportController",["$route","$scope","message","QueryUtils","$timeout","$translate","busyHandler","dialogService","$filter",function(a,b,c,d,e,f,g,h,i){function j(){d.loadingWheel(b,!0,!1,f.instant("ehis.messages.requestInProgress"),!0),d.endpoint(l).save2(b.teacher).$promise.then(function(a){e(function(){k(a.key)},1e3)})["catch"](function(){d.loadingWheel(b,!1)})}function k(a){d.endpoint("/teachers/ehisTeacherExportStatus").get({key:a}).$promise.then(function(f){b.cancelledBy&&(b.cancelledBy=null),"IN_PROGRESS"===f.status?(g.setProgress(Math.round(100*f.progress)),e(function(){k(a)},5e3)):"DONE"===f.status?(c.info(f&&f.result.length>0?"ehis.messages.exportFinished":b.auth.higher?"ehis.messages.noTeachersFoundHigher":"ehis.messages.noTeachersFoundVocational"),b.result=f.result,g.setProgress(100),d.loadingWheel(b,!1)):(c.error("ehis.messages.taskStatus."+f.status,{error:f.error}),"CANCELLED"!==f.status&&"INTERRUPTED"!==f.status||!f.result||(b.cancelledBy=f.cancelledBy,b.result=f.result),d.loadingWheel(b,!1))})}b.auth=a.current.locals.auth,b.higher=a.current.locals.higher;var l=b.higher?"/teachers/exportToEhis/higher":"/teachers/exportToEhis/vocational";b.teacher={},b.teacher.allDates=!1,b.exportTeachers=function(){b.teacherExportForm.$valid?d.endpoint("/teachers/ehisTeacherExportCheck").get(b.criteria).$promise.then(function(a){a&&a.user?h.confirmDialog({prompt:a.from?"ehis.messages.overlappedRequestDateRangeTeacher":"ehis.messages.overlappedRequestTeacher",user:a.user,from:i("hoisDate")(a.from),thru:i("hoisDate")(a.thru)},function(){j()}):j()})["catch"](angular.noop):c.error("main.messages.form-has-errors")}}]),angular.module("hitsaOis").config(["$routeProvider","USER_ROLES",function(a,b){a.when("/ehis/teacher/export/higher",{templateUrl:"ehis/teacher.export.html",controller:"TeacherExportController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],higher:function(){return!0}},data:{authorizedRoles:function(a,c){return a.higher&&-1!==c.indexOf(b.ROLE_OIGUS_M_TEEMAOIGUS_ANDMEVAHETUS_EHIS)}}}).when("/ehis/teacher/export/vocational",{templateUrl:"ehis/teacher.export.html",controller:"TeacherExportController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}],higher:function(){return!1}},data:{authorizedRoles:function(a,c){return a.vocational&&-1!==c.indexOf(b.ROLE_OIGUS_M_TEEMAOIGUS_ANDMEVAHETUS_EHIS)}}}).when("/ehis/student/export",{templateUrl:"ehis/student.html",controller:"StudentEhisController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_ANDMEVAHETUS_EHIS]}}).when("/ehis/logs",{templateUrl:"ehis/logs.view.html",controller:"EhisLogsController",controllerAs:"controller",resolve:{translationLoaded:["$translate",function(a){return a.onReady()}],auth:["AuthResolver",function(a){return a.resolve()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_ANDMEVAHETUS_EHIS]}})}]),angular.module("hitsaOis").config(["$routeProvider","USER_ROLES",function(a,b){function c(a){return angular.isArray(a.teacherGroupIds)&&a.teacherGroupIds.length>0}a.when("/scholarships/grant/new",{templateUrl:"scholarship/scholarship.edit.html",controller:"ScholarshipEditController",controllerAs:"controller",resolve:{auth:["AuthResolver",function(a){return a.resolve()}],translationLoaded:["$translate",function(a){return a.onReady()}],params:function(){return{allowedStipendTypes:["STIPTOETUS_POHI","STIPTOETUS_ERI","STIPTOETUS_SOIDU"],typeIsScholarship:!1}}},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_STIPTOETUS]}}).when("/scholarships/scholarship/new",{templateUrl:"scholarship/scholarship.edit.html",controller:"ScholarshipEditController",controllerAs:"controller",resolve:{auth:["AuthResolver",function(a){return a.resolve()}],translationLoaded:["$translate",function(a){return a.onReady()}],params:function(){return{allowedStipendTypes:["STIPTOETUS_TULEMUS","STIPTOETUS_ERIALA","STIPTOETUS_MUU"],typeIsScholarship:!0}}},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_STIPTOETUS]}}).when("/scholarships/drGrant/new",{templateUrl:"scholarship/scholarship.edit.html",controller:"ScholarshipEditController",controllerAs:"controller",resolve:{auth:["AuthResolver",function(a){return a.resolve()}],translationLoaded:["$translate",function(a){return a.onReady()}],params:function(){return{allowedStipendTypes:["STIPTOETUS_DOKTOR"],typeIsScholarship:!0}}},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_STIPTOETUS]}}).when("/scholarships/:id/edit",{templateUrl:"scholarship/scholarship.edit.html",controller:"ScholarshipEditController",controllerAs:"controller",resolve:{auth:["AuthResolver",function(a){return a.resolve()}],translationLoaded:["$translate",function(a){return a.onReady()}]},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_STIPTOETUS]}}).when("/scholarships/:id/view",{templateUrl:"scholarship/scholarship.view.html",controller:"ScholarshipViewController",controllerAs:"controller",resolve:{auth:["AuthResolver",function(a){return a.resolve()}],translationLoaded:["$translate",function(a){return a.onReady()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_STIPTOETUS]}}).when("/scholarships",{templateUrl:"scholarship/scholarship.search.html",controller:"ScholarshipSearchController",controllerAs:"controller",resolve:{auth:["AuthResolver",function(a){return a.resolve()}],translationLoaded:["$translate",function(a){return a.onReady()}],params:function(){return{allowedStipendTypes:["STIPTOETUS_DOKTOR"],scholarshipType:"drGrant"}}},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_STIPTOETUS]}}).when("/scholarships/grants",{templateUrl:"scholarship/scholarship.search.html",controller:"ScholarshipSearchController",controllerAs:"controller",resolve:{auth:["AuthResolver",function(a){return a.resolve()}],translationLoaded:["$translate",function(a){return a.onReady()}],params:function(){return{allowedStipendTypes:["STIPTOETUS_POHI","STIPTOETUS_ERI","STIPTOETUS_SOIDU"],grant:!0}}},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_STIPTOETUS]}}).when("/scholarships/scholarships",{templateUrl:"scholarship/scholarship.search.html",controller:"ScholarshipSearchController",controllerAs:"controller",resolve:{auth:["AuthResolver",function(a){return a.resolve()}],translationLoaded:["$translate",function(a){return a.onReady()}],params:function(){return{allowedStipendTypes:["STIPTOETUS_ERIALA","STIPTOETUS_TULEMUS","STIPTOETUS_MUU"],scholarship:!0}}},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_STIPTOETUS]}}).when("/scholarships/myData/scholarships",{templateUrl:"scholarship/student/scholarship.scholarship.student.html",controller:"StudentScholarshipController",controllerAs:"controller",resolve:{auth:["AuthResolver",function(a){return a.resolve()}],translationLoaded:["$translate",function(a){return a.onReady()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_OPPUR]}}).when("/scholarships/myData/grants",{templateUrl:"scholarship/student/scholarship.grants.student.html",controller:"StudentScholarshipController",controllerAs:"controller",resolve:{auth:["AuthResolver",function(a){return a.resolve()}],translationLoaded:["$translate",function(a){return a.onReady()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_OPPUR]}}).when("/scholarships/myData/drGrants",{templateUrl:"scholarship/student/scholarship.drGrants.student.html",controller:"StudentScholarshipController",controllerAs:"controller",resolve:{auth:["AuthResolver",function(a){return a.resolve()}],translationLoaded:["$translate",function(a){return a.onReady()}],drGrant:function(){return!0}},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_OPPUR]}}).when("/scholarships/:id/application",{templateUrl:"scholarship/student/scholarship.application.edit.html",controller:"StudentScholarshipApplicationEditController",controllerAs:"controller",resolve:{auth:["AuthResolver",function(a){return a.resolve()}],translationLoaded:["$translate",function(a){return a.onReady()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_OPPUR]}}).when("/scholarships/applications/grants",{templateUrl:"scholarship/scholarship.application.list.grants.html",controller:"ScholarshipApplicationController",controllerAs:"controller",resolve:{auth:["AuthResolver",function(a){return a.resolve()}],translationLoaded:["$translate",function(a){return a.onReady()}],params:function(){return{allowedStipendTypes:["STIPTOETUS_POHI","STIPTOETUS_ERI","STIPTOETUS_SOIDU"],stipend:!1,scholarshipType:"grants"}}},data:{authorizedRoles:function(a){return-1!==a.authorizedRoles.indexOf(b.ROLE_OIGUS_V_TEEMAOIGUS_STIPTOETUS)||c(a)}}}).when("/scholarships/applications/drGrants",{templateUrl:"scholarship/scholarship.application.list.drGrants.html",controller:"ScholarshipApplicationController",controllerAs:"controller",resolve:{auth:["AuthResolver",function(a){return a.resolve()}],translationLoaded:["$translate",function(a){return a.onReady()}],params:function(){return{allowedStipendTypes:["STIPTOETUS_DOKTOR"],scholarshipType:"drGrants"}}},data:{authorizedRoles:function(a,c){return a.higher&&-1!==c.indexOf(b.ROLE_OIGUS_V_TEEMAOIGUS_STIPTOETUS)}}}).when("/scholarships/applications/scholarships",{templateUrl:"scholarship/scholarship.application.list.scho.html",controller:"ScholarshipApplicationController",controllerAs:"controller",resolve:{auth:["AuthResolver",function(a){return a.resolve()}],translationLoaded:["$translate",function(a){return a.onReady()}],params:function(){return{allowedStipendTypes:["STIPTOETUS_TULEMUS","STIPTOETUS_ERIALA","STIPTOETUS_MUU"],stipend:!0,scholarshipType:"scholarships"}}},data:{authorizedRoles:function(a,c){return a.higher&&-1!==c.indexOf(b.ROLE_OIGUS_V_TEEMAOIGUS_STIPTOETUS)}}}).when("/scholarships/applications/:type/annul",{templateUrl:"scholarship/scholarship.application.annul.edit.html",controller:"ScholarshipRejectionController",controllerAs:"controller",resolve:{auth:["AuthResolver",function(a){return a.resolve()}],translationLoaded:["$translate",function(a){return a.onReady()}],params:function(){return{type:"annulApplications"}}},authorizedRoles:function(a){return-1!==a.authorizedRoles.indexOf(b.ROLE_OIGUS_M_TEEMAOIGUS_STIPTOETUS)||c(a)}}).when("/scholarships/applications/:type/reject",{templateUrl:"scholarship/scholarship.application.reject.edit.html",controller:"ScholarshipRejectionController",controllerAs:"controller",resolve:{auth:["AuthResolver",function(a){return a.resolve()}],translationLoaded:["$translate",function(a){return a.onReady()}],params:function(){return{type:"rejectApplications"}}},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_STIPTOETUS]}}).when("/scholarships/decision/:type",{templateUrl:"scholarship/scholarship.decision.edit.html",controller:"ScholarshipDecisionController",controllerAs:"controller",resolve:{auth:["AuthResolver",function(a){return a.resolve()}],translationLoaded:["$translate",function(a){return a.onReady()}]},data:{authorizedRoles:[b.ROLE_OIGUS_M_TEEMAOIGUS_STIPTOETUS]}}).when("/scholarships/decision/:type/:id",{templateUrl:"scholarship/scholarship.decision.view.html",controller:"ScholarshipDecisionViewController",controllerAs:"controller",resolve:{auth:["AuthResolver",function(a){return a.resolve()}],translationLoaded:["$translate",function(a){return a.onReady()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_STIPTOETUS]}}).when("/scholarships/applications/:id",{templateUrl:"scholarship/student/scholarship.application.edit.html",controller:"StudentScholarshipApplicationViewController",controllerAs:"controller",resolve:{auth:["AuthResolver",function(a){return a.resolve()}],translationLoaded:["$translate",function(a){return a.onReady()}]},data:{authorizedRoles:[b.ROLE_OIGUS_V_TEEMAOIGUS_OPPUR]}})}]),angular.module("hitsaOis").factory("ScholarshipUtils",["$location","dialogService",function(a,b){function c(b){a.url(d+"/"+b+"/edit")}var d="/scholarships";return{changeStipend:function(a,d,e){var f;f=-1!==["STIPTOETUS_POHI","STIPTOETUS_ERI","STIPTOETUS_SOIDU","STIPTOETUS_DOKTOR"].indexOf(d)?"stipend.confirmations.grantIsPublishedChange":"stipend.confirmations.scholarshipIsPublishedChange",e?b.confirmDialog({prompt:f},function(){c(a)}):c(a)},getScholarshipTypeGroup:function(a){return-1!==["STIPTOETUS_POHI","STIPTOETUS_ERI","STIPTOETUS_SOIDU"].indexOf(a)?"grants":-1!==["STIPTOETUS_TULEMUS","STIPTOETUS_ERIALA","STIPTOETUS_MUU"].indexOf(a)?"scholarships":-1!==["STIPTOETUS_DOKTOR"].indexOf(a)?"drGrants":void 0}}}]),angular.module("hitsaOis").controller("ScholarshipEditController",["$route","$scope","$location","Classifier","DataUtils","QueryUtils","dialogService","message",function(a,b,c,d,e,f,g,h){function i(){b.formState.committees=f.endpoint(o+"/committees").query({validDate:b.stipend.applicationEnd,curriclumIds:(b.stipend.curriculums||[]).map(function(a){return a.id})})}function j(a){b.formState.allowedStipendTypes=[a.type],b.stipend=a,b.stipendTypeChanged(),b.applicationEndChanged(),b.stipendForm.$setPristine(),e.convertStringToDates(b.stipend,["applicationStart","applicationEnd","paymentStart","paymentEnd","lastPeriodGradeFrom","lastPeriodGradeThru","studyStartPeriodStart","studyStartPeriodEnd"])}function k(){return b.stipendForm.$setSubmitted(),b.stipendForm.$valid?!angular.isArray(b.stipend.curriculums)||b.stipend.curriculums.length<1?(h.error("stipend.messages.error.curriculumsEmtpy"),!1):!0:(h.error("main.messages.form-has-errors"),!1)}var l={STIPTOETUS_POHI:"scholarship/term/scholarship.pohi.edit.html",STIPTOETUS_ERI:"scholarship/term/scholarship.eri.edit.html",STIPTOETUS_SOIDU:"scholarship/term/scholarship.soidu.edit.html",STIPTOETUS_DOKTOR:"scholarship/term/scholarship.doktor.edit.html",STIPTOETUS_ERIALA:"scholarship/term/scholarship.scho.edit.html",STIPTOETUS_MUU:"scholarship/term/scholarship.scho.edit.html",STIPTOETUS_TULEMUS:"scholarship/term/scholarship.scho.edit.html"};b.filteredStudyForm=["OPPEVORM_P","OPPEVORM_Q","OPPEVORM_S","OPPEVORM_MS","OPPEVORM_K","OPPEVORM_M"],b.formState={priorities:d.queryForDropdown({mainClassCode:"PRIORITEET"})};var m=d.queryForDropdown({mainClassCode:"STIPTOETUS"}).$promise;m.then(function(a){b.formState.typeMap=d.toMap(a)});var n=a.current.params.id,o="/scholarships",p=f.endpoint(o);b.stipendTypeChanged=function(){b.templateName=l[b.stipend.type],m.then(function(){b.stipend.nameEt||(b.stipend.nameEt=(b.formState.typeMap[b.stipend.type]||{}).nameEt),angular.isArray(b.formState.allowedStipendTypes)&&1===b.formState.allowedStipendTypes.length&&(b.formState.typeIsScholarship=-1!==["STIPTOETUS_ERIALA","STIPTOETUS_MUU","STIPTOETUS_TULEMUS"].indexOf(b.formState.allowedStipendTypes[0]))})},b.applicationEndChanged=function(){i()},n?b.stipend=p.get({id:n},j):(b.stipend=new p({}),b.formState.allowedStipendTypes=a.current.locals.params.allowedStipendTypes,b.formState.typeIsScholarship=a.current.locals.params.typeIsScholarship,1===b.formState.allowedStipendTypes.length&&(b.stipend.type=b.formState.allowedStipendTypes[0],b.stipendTypeChanged()),b.stipend.courses=["KURSUS_1","KURSUS_2","KURSUS_3","KURSUS_4"],b.missingCurriculums=!0),b.update=function(){k()&&(b.stipend.id?b.stipend.$update().then(j).then(h.updateSuccess)["catch"](angular.noop):b.stipend.$save().then(function(){h.info("main.messages.create.success"),c.url(o+"/"+b.stipend.id+"/edit?_noback")})["catch"](angular.noop))},b.$watch("formState.curriculum",function(){if(angular.isDefined(b.formState.curriculum)&&null!==b.formState.curriculum){if(angular.isArray(b.stipend.curriculums)||(b.stipend.curriculums=[]),b.stipend.curriculums.some(function(a){return a.id===b.formState.curriculum.id}))return h.error("stipend.messages.error.duplicateCurriculum"),void(b.formState.curriculum=void 0);b.stipend.curriculums.push(b.formState.curriculum),b.stipend.curriculums.length>0&&(b.missingCurriculums=!1),b.formState.curriculum=void 0,i()}}),b.addAllCurriculums=function(a){f.endpoint("/autocomplete/curriculumsauto").query(a,function(a){angular.isArray(b.stipend.curriculums)||(b.stipend.curriculums=[]);for(var c=b.stipend.curriculums.map(function(a){return a.id}),d=0;d<a.length;d++){var e=a[d];-1===c.indexOf(e.id)&&b.stipend.curriculums.push(e)}b.stipend.curriculums.length>0&&(b.missingCurriculums=!1),i()})},b.deleteCurriculum=function(a){var c=b.stipend.curriculums.indexOf(a);-1!==c&&b.stipend.curriculums.splice(c,1),0===b.stipend.curriculums.length&&(b.missingCurriculums=!0),i()},b.publish=function(){g.confirmDialog({prompt:"stipend.confirmations.saveAndPublish"},function(){k()&&b.stipend.$update({},function(){f.endpoint(o+"/"+b.stipend.id+"/publish").put({},function(){a.reload()})})["catch"](angular.noop)})},b["delete"]=function(){var a,d;-1!==["STIPTOETUS_POHI","STIPTOETUS_ERI","STIPTOETUS_SOIDU"].indexOf(b.stipend.type)?(a="stipend.confirmations.deleteGrant",d="/scholarships/grants"):(a="stipend.confirmations.deleteStipend",d="/scholarships/scholarships"),g.confirmDialog({prompt:a},function(){f.endpoint(o+"/"+b.stipend.id+"/deleteTerm")["delete"]({},function(){c.url(d+"?_noback")}).$promise["catch"](angular.noop)})},b.averageMarkPriorityFilter=function(a){var c=[b.stipend.lastPeriodMarkPriority,b.stipend.curriculumCompletionPriority,b.stipend.maxAbsencesPriority];return-1===c.indexOf(a.code)},b.lastPeriodMarkPriorityFilter=function(a){var c=[b.stipend.averageMarkPriority,b.stipend.curriculumCompletionPriority,b.stipend.maxAbsencesPriority];return-1===c.indexOf(a.code)},b.curriculumCompletionPriorityFilter=function(a){var c=[b.stipend.averageMarkPriority,b.stipend.lastPeriodMarkPriority,b.stipend.maxAbsencesPriority];return-1===c.indexOf(a.code)},b.maxAbsencesPriorityFilter=function(a){var c=[b.stipend.averageMarkPriority,b.stipend.lastPeriodMarkPriority,b.stipend.curriculumCompletionPriority];return-1===c.indexOf(a.code)}}]).controller("ScholarshipViewController",["$route","$scope","AuthService","ScholarshipUtils","USER_ROLES","QueryUtils","dialogService",function(a,b,c,d,e,f,g){function h(a){b.stipend=a,b.templateName=i[a.type],b.formState.typeIsScholarship=-1!==["STIPTOETUS_ERIALA","STIPTOETUS_MUU","STIPTOETUS_TULEMUS"].indexOf(a.type),f.endpoint("/autocomplete/studyPeriodsWithYear").query(function(a){b.formState.readonlyStudyPeriod=a.find(function(a){return a.id===b.stipend.studyPeriod})}),f.endpoint(k+"/committees").query(function(a){b.formState.committee=a.find(function(a){return a.id===b.stipend.committee})})}var i={STIPTOETUS_POHI:"scholarship/term/scholarship.pohi.view.html",STIPTOETUS_ERI:"scholarship/term/scholarship.eri.view.html",STIPTOETUS_SOIDU:"scholarship/term/scholarship.soidu.view.html",STIPTOETUS_DOKTOR:"scholarship/term/scholarship.doktor.view.html",STIPTOETUS_ERIALA:"scholarship/term/scholarship.scho.view.html",STIPTOETUS_MUU:"scholarship/term/scholarship.scho.view.html",STIPTOETUS_TULEMUS:"scholarship/term/scholarship.scho.view.html"};b.canEdit=c.isAuthorized(e.ROLE_OIGUS_M_TEEMAOIGUS_STIPTOETUS),b.formState={};var j=a.current.params.id,k="/scholarships",l=f.endpoint(k);b.publish=function(){g.confirmDialog({prompt:"stipend.confirmations.publish"},function(){f.endpoint(k+"/"+b.stipend.id+"/publish").put({},function(a){h(a)})["catch"](angular.noop)})},j&&(b.stipend=l.get({id:j},h)),b.changeStipend=function(a){d.changeStipend(a.id,a.type,a.isOpen)}}]),angular.module("hitsaOis").controller("ScholarshipSearchController",["$scope","$q","$route","message","Classifier","QueryUtils","USER_ROLES","AuthService","ScholarshipUtils",function(a,b,c,d,e,f,g,h,i){a.canEdit=h.isAuthorized(g.ROLE_OIGUS_M_TEEMAOIGUS_STIPTOETUS);var j="/scholarships";a.allowedStipendTypes=c.current.locals.params.allowedStipendTypes;var k=e.valuemapper({type:"STIPTOETUS"});a.formState={},a.statuses=[{id:0,nameEt:"Sisestamisel"},{id:1,nameEt:"Avalik"}],f.createQueryForm(a,j,{order:"id",allowedStipendTypes:a.allowedStipendTypes},k.objectmapper);var l=a.clearCriteria;a.clearCriteria=function(){l(),a.criteria.allowedStipendTypes=a.allowedStipendTypes},c.current.locals.params.scholarship?(a.formState.typeIsScholarship=!0,a.scholarshipType="scholarship"):c.current.locals.params.grant?a.scholarshipType="grant":c.current.locals.params.scholarshipType&&(a.scholarshipType=c.current.locals.params.scholarshipType);var m=a.$watch("criteria.studyPeriod",function(c){angular.isNumber(c)&&(m(),b.all(k.promises).then(a.loadData))});a.changeStipend=function(a){i.changeStipend(a.id,a.type.code,a.isOpen)}}]),angular.module("hitsaOis").controller("ScholarshipApplicationController",["$location","$route","$scope","$sessionStorage","$q","AuthService","Classifier","USER_ROLES","QueryUtils","dialogService","message",function(a,b,c,d,e,f,g,h,i,j,k){function l(){return c.applications.filter(function(a){return c.selected[a.id]&&!a.hasDirective}).map(function(a){return a.id})}function m(){return c.applications.filter(function(a){return!a.hasDirective}).map(function(a){return a.id})}var n="/scholarships";c.criteria={},c.formState={},c.formState.allowedStipendTypes=b.current.locals.params.allowedStipendTypes,c.scholarshipType=b.current.locals.params.scholarshipType;var o=b.current.locals.params.stipend;c.auth=b.current.locals.auth,c.canManage=f.isAuthorized(h.ROLE_OIGUS_M_TEEMAOIGUS_STIPTOETUS),c.isStudentGroupTeacher=c.auth.isTeacher()&&c.auth.teacherGroupIds.length>0,c.applicationsTable={showSelect:!0},c.selected={};var p=g.valuemapper({status:"STIPTOETUS_STAATUS",type:"STIPTOETUS",compensationFrequency:"STIPTOETUS_HYVITAMINE",compensationReason:"STIPTOETUS_HYVITAMINE_POHJUS"}),q=p.promises;e.all(q).then(function(){if(!("_menu"in b.current.params)){c.fromStorage=function(a){return JSON.parse(d[a]||"{}")};var a=c.fromStorage(b.current.originalPath);angular.isNumber(a.page)&&(a.page=a.page+1),angular.extend(c.criteria,a)}}),angular.element(document).ready(function(){c.applicationSearchForm.$setSubmitted(),c.applicationSearchForm.$valid?c.reloadTable():window.setTimeout(function(){c.applicationSearchForm.$setSubmitted(),c.applicationSearchForm.$valid&&c.reloadTable()},500)}),c.toStorage=function(a,b){d[a]=JSON.stringify(b)},c.reloadTable=function(){return c.applicationSearchForm.$setSubmitted(),c.applicationSearchForm.$valid?void i.endpoint(n+"/applications").search(c.criteria,function(a){angular.isArray(a.applications)?a.applications.length<1?(k.info("main.messages.error.notFound"),c.applications=[],c.allowedCount=0):(c.applications=p.objectmapper(a.applications),c.allowedCount=a.allowedCount):(k.info("main.messages.error.notFound"),c.applications=[],c.allowedCount=0),c.submittedType=c.criteria.type,c.toStorage(b.current.originalPath,c.criteria)}):(k.error("main.messages.form-has-errors"),!1)},c.updateAllApplicationCheckBoxes=function(a){c.applications.forEach(function(b,d){(d<c.allowedCount||!angular.isNumber(c.allowedCount))&&(b.needsConfirm&&c.auth.isTeacher()?c.selected[b.id]=a:c.auth.isTeacher()||b.hasDirective||(c.selected[b.id]=a))})},c.clearCriteria=function(){c.criteria={}},c.isNumber=angular.isNumber,c.accept=function(){var a=l();a.length>0?i.endpoint(n+"/acceptApplications").put(a,c.reloadTable).$promise.then(function(){k.info("stipend.messages.applicationAccepted")}):k.error("stipend.messages.error.noStudentsSelected")},c.annul=function(){var b=l();b.length>0?a.path("/scholarships/applications/"+c.scholarshipType+"/annul").search({ids:b,stipend:o}):k.error("stipend.messages.error.noStudentsSelected")},c.reject=function(){var b=l();b.length>0?a.path("/scholarships/applications/"+c.scholarshipType+"/reject").search({ids:b,stipend:o}):k.error("stipend.messages.error.noStudentsSelected")},c.teacherConfirm=function(a){var b=l();b.length>0?i.endpoint(n+"/teacherConfirmApplications/"+a).put(b,c.reloadTable).$promise.then(function(){"yes"===a?k.info("stipend.messages.applicationConfirmed"):"no"===a&&k.info("stipend.messages.applicationUnconfirmed")}):k.error("stipend.messages.error.noStudentsSelected")},c.refreshResults=function(){var a=m();a.length>0?i.endpoint(n+"/refreshResults").put(a,c.reloadTable).$promise.then(function(){k.info("stipend.messages.resultsRefreshed")}):k.error("stipend.messages.error.noApplicationsWithoutDirectives")},c.checkComplies=function(){var a=m();a.length>0?i.endpoint(n+"/checkComplies").save(a,function(a){c.applications.forEach(function(b){a[b.id]&&(b.nonCompliant=a[b.id].fullyComplies===!1,b.termCompliance=a[b.id])})}).$promise.then(function(){k.info("stipend.messages.compliesChecked")}):k.error("stipend.messages.error.noApplicationsWithoutDirectives")},c.scholarshipTermCompliances=function(a){j.showDialog("scholarship/templates/scholarship.term.compliance.dialog.html",function(b){b.stipend=a,b.stipend.nameEt=a.termNameEt})},c.committeeDecision=function(){var b=l();b.length>0?i.endpoint(n+"/decision/canCreate").get({ids:b},function(d){d.canCreate?a.path("/scholarships/decision/"+c.scholarshipType).search({ids:b,stipend:o}):k.error("stipend.messages.error.cannotCreateDecision")}):k.error("stipend.messages.error.noStudentsSelected")};var r;c.resetCurriculum=function(){"STIPTOETUS_POHI"===r&&(c.criteria.curriculum=[]),r=c.criteria.type}}]).controller("ScholarshipRejectionController",["dialogService","Classifier","$scope","$location","message","QueryUtils","$route","ArrayUtils","FormUtils",function(a,b,c,d,e,f,g,h,i){var j="/scholarships";c.scholarshipType=g.current.params.type,f.endpoint(j+"/studentProfilesRejection").query({id:g.current.params.ids},function(a){angular.isArray(a)&&(a.length<1?e.info("main.messages.error.notFound"):c.rejections=a)}),c.reject=function(){i.withValidForm(c.rejectForm,function(){f.endpoint(j+"/rejectApplications").put({applications:c.rejections},function(){e.info("stipend.messages.applicationRejected"),d.path("/scholarships/applications/"+c.scholarshipType)})})},c.annul=function(){f.endpoint(j+"/annulApplications").put({applications:c.rejections},function(){e.info("stipend.messages.applicationAnnulled"),d.path("/scholarships/applications/"+c.scholarshipType)})},c.removeFromArray=h.remove}]).controller("ScholarshipDecisionController",["$scope","$location","$q","message","QueryUtils","$route","Classifier",function(a,b,c,d,e,f,g){function h(a){return a?a.filter(function(a){return a.isPresent}).map(function(a){return a.id}):[]}function i(a){return angular.isArray(a)?a:[a]}var j="/scholarships";a.scholarshipType=f.current.params.type,a.formState={};var k=g.valuemapper({status:"STIPTOETUS_STAATUS",type:"STIPTOETUS",compensationFrequency:"STIPTOETUS_HYVITAMINE",compensationReason:"STIPTOETUS_HYVITAMINE_POHJUS"});e.endpoint(j+"/decision").get({ids:f.current.params.ids},function(b){a.formState.committee=b.committeeId,a.selectedCommitteeChanged(),a.formState.committees=e.endpoint(j+"/committees").query({validDate:(new Date).withoutTime(),id:b.committeeId}),a.submittedType=b.applications[0].type,c.all(k.promises).then(function(){a.applications=k.objectmapper(b.applications)})}),a.selectedCommitteeChanged=function(){a.formState.committee&&e.endpoint("/committees").get({id:a.formState.committee},function(b){a.formState.committeeMembers=b.members})},a.decide=function(){return a.decisionForm.$setSubmitted(),a.decisionForm.$valid?(angular.extend(a.decision,{presentCommitteeMembers:h(a.formState.committeeMembers),applicationIds:i(f.current.params.ids)}),void e.endpoint(j+"/decide").save(a.decision,function(){d.info("main.messages.update.success"),b.path("/scholarships/applications/"+a.scholarshipType)})):void d.error("main.messages.form-has-errors")}}]).controller("ScholarshipDecisionViewController",["$scope","$location","$q","message","QueryUtils","$route","Classifier","dialogService",function(a,b,c,d,e,f,g,h){var i="/scholarships/decision";a.auth=f.current.locals.auth,a.scholarshipType=f.current.params.type;var j=f.current.params.id,k=e.endpoint(i),l=g.valuemapper({status:"STIPTOETUS_STAATUS",type:"STIPTOETUS",compensationFrequency:"STIPTOETUS_HYVITAMINE",compensationReason:"STIPTOETUS_HYVITAMINE_POHJUS"});a.decision=k.get({id:j},function(b){a.decision.committee=b.committeeId,a.submittedType=b.applications[0].type,c.all(l.promises).then(function(){a.applications=l.objectmapper(b.applications)}),e.endpoint("/committees").get({id:a.decision.committee},function(c){a.decision.committeeMembers=c.members,b.presentCommitteeMembers&&a.decision.committeeMembers.forEach(function(a){-1!==b.presentCommitteeMembers.indexOf(a.id)&&(a.isPresent=!0)})})}),a["delete"]=function(){h.confirmDialog({prompt:"stipend.decision.deleteconfirm"},function(){a.decision.$delete().then(function(){d.info("main.messages.delete.success"),a.back("/scholarships/applications/"+a.scholarshipType)})["catch"](angular.noop)})}}]),angular.module("hitsaOis").controller("StudentScholarshipController",["$route","$scope","$q","Classifier","QueryUtils","dialogService",function(a,b,c,d,e,f){var g="/scholarships",h=a.current.locals.drGrant,i=d.valuemapper({type:"STIPTOETUS",status:"STIPTOETUS_STAATUS"});c.all(i.promises).then(function(){var a=e.endpoint(g+(h?"/availableDrGrants":"/availableStipends")).query({},function(a){i.objectmapper(a),b.possibleStipends=a}).$promise,d=e.endpoint(g+(h?"/studentDrGrants":"/studentStipends")).query({},function(a){
i.objectmapper(a),b.studentStipends=a}).$promise;c.all([a,d]).then(function(){b.possibleStipends.forEach(function(a){var c=b.studentStipends.find(function(b){return b.termId===a.id});a.canApply=a.termCompliance.fullyComplies?!angular.isDefined(c):!1,a.alreadyApplied=angular.isDefined(c)?!0:!1})})}),b.scholarshipTerms=function(a){f.showDialog("scholarship/templates/scholarship.term.dialog.html",function(b){b.stipend=a})},b.scholarshipTermCompliances=function(a){f.showDialog("scholarship/templates/scholarship.term.compliance.dialog.html",function(b){b.stipend=a})}}]),angular.module("hitsaOis").controller("StudentScholarshipApplicationEditController",["$location","$scope","$route","ArrayUtils","Classifier","DataUtils","QueryUtils","dialogService","message","oisFileService",function(a,b,c,d,e,f,g,h,i,j){function k(a){return a.$setSubmitted(),b.application.family&&b.application.family.length>b.application.familyMembersAdult?(i.error("stipend.family.deleteRows"),!1):a.$valid?!0:(i.error("main.messages.form-has-errors"),!1)}function l(a){b.application=a,"STIPTOETUS_ERI"===b.stipend.type&&(f.convertStringToDates(b.stipend,["paymentStart","paymentEnd"]),f.convertStringToDates(b.application,["scholarshipFrom","scholarshipThru"]),b.updateScholarshipDateValidation())}function m(a){g.endpoint(o+"/studentTermCompliance/"+a.id).search(function(a){b.termCompliance=a})}var n={STIPTOETUS_POHI:"scholarship/student/scholarship.application.pohi.edit.html",STIPTOETUS_ERI:"scholarship/student/scholarship.application.eri.edit.html",STIPTOETUS_SOIDU:"scholarship/student/scholarship.application.soidu.edit.html",STIPTOETUS_DOKTOR:"scholarship/student/scholarship.application.doktor.edit.html",STIPTOETUS_ERIALA:"scholarship/student/scholarship.application.scho.edit.html",STIPTOETUS_MUU:"scholarship/student/scholarship.application.scho.edit.html",STIPTOETUS_TULEMUS:"scholarship/student/scholarship.application.scho.edit.html"};b.application={},b.formState={};var o="/scholarships";b.editable=!0;var p=c.current.params.id;g.endpoint(o+"/"+p+"/application").get({},function(a){b.stipend=a.stipend,b.termCompliance=a.termCompliance,b.templateName=n[a.stipend.type],"STIPTOETUS_ERI"===a.stipend.type&&calculateSumsForFamilyBlock(b.application.family),a.application.compensationFrequency||(a.application.compensationFrequency="STIPTOETUS_HYVITAMINE_1"),l(a.application)}),b.openAddFileDialog=function(){h.showDialog("components/file.add.dialog.html",function(a){a.addedFiles=b.application.files},function(a){var c=a.data;j.getFromLfFile(c.file[0],function(a){b.application.files.push(a)})})},b.removeFile=function(a,b){d.remove(a,b)},b.compensationFrequencies=e.queryForDropdown({mainClassCode:"STIPTOETUS_HYVITAMINE"}),b.getUrl=j.getUrl,b.removeFromArray=d.remove,b.isNumber=angular.isNumber,b.updateScholarshipDateValidation=function(){var a=b.stipend.paymentStart?moment(b.stipend.paymentStart):null,c=b.stipend.paymentEnd?moment(b.stipend.paymentEnd):null,d=b.application.scholarshipFrom?moment(b.application.scholarshipFrom):null,e=b.application.scholarshipThru?moment(b.application.scholarshipThru):null;b.formState.scholarshipFromMax=c&&e?moment.min(c,e).toDate():b.stipend.paymentEnd||b.application.scholarshipThru,b.formState.scholarshipThruMin=a&&d?moment.max(a,d).toDate():b.stipend.paymentStart||b.application.scholarshipFrom},b.apply=function(c){h.confirmDialog({prompt:"stipend.confirmations.apply"},function(){b.update(c,function(b){g.endpoint(o+"/apply").update({id:b.id},function(b){i.info("stipend.messages.applicationSuccessful"),a.url(o+"/applications/"+b.id+"?_noback")}),m(b)})})},b.update=function(c,d){k(c)&&(b.application.id?g.endpoint(o+"/"+p+"/application").update(b.application,function(a){d?d(a):(l(a),i.updateSuccess(),c.$setPristine())}):g.endpoint(o+"/"+p+"/application").save(b.application,function(c){d?d(c):(i.info("main.messages.create.success"),a.url(o+"/"+b.stipend.id+"/application?_noback"))}))},b.addFamilyMember=function(){angular.isArray(b.application.family)||(b.application.family=[]),b.application.family.length<b.application.familyMembersAdult?h.showDialog("scholarship/student/scholarship.family.addMember.html",function(){},function(a){var c=a.member;a.member.sum=[c.netSalary,c.pension,c.stateBenefit,c.otherIncome,c.unemployedBenefit].reduce(function(a,b){return isNaN(b)?a:a+b},0),b.application.family.push(a.member)}):i.error("stipend.family.errorWithMembers")}}]).controller("StudentScholarshipApplicationViewController",["dialogService","Classifier","$scope","$location","message","QueryUtils","$route","oisFileService","AuthService",function(a,b,c,d,e,f,g,h,i){function j(){f.endpoint(l+"/application/"+m).get({},function(a){c.stipend=a.stipend,c.application=a.application,c.templateName=k[a.stipend.type],"STIPTOETUS_ERI"===a.stipend.type&&calculateSumsForFamilyBlock(c.application.family),c.canManage=i.isAuthorized("ROLE_OIGUS_M_TEEMAOIGUS_STIPTOETUS")&&"STIPTOETUS_STAATUS_A"!==a.application.status})}var k={STIPTOETUS_POHI:"scholarship/student/scholarship.application.pohi.view.html",STIPTOETUS_ERI:"scholarship/student/scholarship.application.eri.view.html",STIPTOETUS_SOIDU:"scholarship/student/scholarship.application.soidu.view.html",STIPTOETUS_DOKTOR:"scholarship/student/scholarship.application.doktor.view.html",STIPTOETUS_ERIALA:"scholarship/student/scholarship.application.scho.view.html",STIPTOETUS_MUU:"scholarship/student/scholarship.application.scho.view.html",STIPTOETUS_TULEMUS:"scholarship/student/scholarship.application.scho.view.html"};c.getUrl=h.getUrl,c.isNumber=angular.isNumber,c.editable=!1;var l="/scholarships",m=g.current.params.id;c.isStudent=g.current.locals.auth.isStudent,j(),c.compensationFrequencies=b.queryForDropdown({mainClassCode:"STIPTOETUS_HYVITAMINE"}),c.accept=function(){f.endpoint(l+"/acceptApplications").put([m],function(){j()})}}]),angular.module("hitsaOis").run(["$templateCache",function(a){a.put("academicCalendar/academic.calendar.school.list.html",'<div layout-padding class="schoolList"> <md-grid-list md-cols="1" md-cols-sm="2" md-cols-md="3" md-cols-gt-md="6" md-row-height-gt-md="1:1" md-row-height="4:3" md-gutter="24px" md-gutter-gt-sm="24px"> <md-grid-tile ng-repeat="school in schools" md-colspan="1"> <button class="schoolTileButton" ng-click="openSchoolAcademicCalendar(school.id)"> <img class="schoolTileImage" ng-src="data:image/JPEG;base64,{{school.logo}}" on-error-src="images/HITSA_innov_logo_03.4e2f45c0.png"> <md-grid-tile-footer class="schoolTileFooter"> <span>{{currentLanguageNameField(school)}}</span> </md-grid-tile-footer> </button> </md-grid-tile> </md-grid-list> </div>'),a.put("academicCalendar/academic.calendar.view.html",'<div layout-padding> <div flex ng-if="data.events.length > 0"> <h2 class="md-title"> <span ng-if="schoolId">{{currentLanguageNameField(data.school)}}</span> <hois-classifier-value ng-model="data.yearCode" main-classifier-code="OPPEAASTA"></hois-classifier-value> {{\'academicCalendar.studyYear\' | translate}} </h2> <md-table-container> <table md-table md-progress="endpoint.$promise"> <thead md-head> <tr md-row> <th md-column width="20%">{{\'academicCalendar.date\' | translate}}</th> <th md-column width="20%">{{\'academicCalendar.description\' | translate}}</th> <th md-column width="60%">{{\'academicCalendar.type\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in data.events" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell ng-if="!row.endDate">{{row.startDate | hoisTimestamp}}</td> <td md-cell ng-if="row.endDate">{{row.startDate | hoisTimestamp}} - {{row.endDate | hoisTimestamp}}</td> <td md-cell> <span ng-if="!row.eventType">{{currentLanguageNameField(row)}}</span> <span ng-if="row.eventType"> <span ng-if="row.eventType == 1"> {{currentLanguageNameField(row)}} ({{\'academicCalendar.beginning\' | translate}}) </span> <span ng-if="row.eventType == 2"> {{currentLanguageNameField(row)}} ({{\'academicCalendar.end\' | translate}}) </span> </span> </td> <td md-cell> <hois-classifier-value ng-if="!row.eventType" ng-model="row.eventTypeCode" main-classifier-code="SYNDMUS"></hois-classifier-value> <span ng-if="row.eventType">{{\'academicCalendar.studyPeriod\' | translate}}</span> </td> </tr> </tbody> </table> </md-table-container> </div> <div flex ng-if="!data.events || data.events.length == 0"> <md-whiteframe class="md-whiteframe-1dp attention-whiteframe" flex="100" layout layout-align="left center"> <div md-colors="{color: \'warn\'}"> <md-icon md-colors="{color: \'warn\'}" md-font-set="material-icons">info_outline</md-icon> <span>{{\'academicCalendar.notFound\' | translate}}</span> </div> </md-whiteframe> </div> <div ng-if="schoolId" layout="row"> <md-button ng-click="back(\'#/academicCalendars/\')" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </div> </div>'),a.put("apelApplication/apel.application.edit.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <form name="apelApplicationForm" ng-submit="save()" novalidate> <div ng-hide="application.student" layout="row" layout-sm="column" layout-xs="column"> <div flex="45" flex-sm="100" flex-xs="100"> <hois-autocomplete flex ng-model="application.student" method="students" name="student" label="apel.student" additional-query-params="{active: true}"></hois-autocomplete> </div> </div> <div ng-hide="!application.student"> <div ng-include="\'apelApplication/templates/apel.application.information.html\'"></div> </div> <div ng-hide="!application.student"> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small"> {{\'apel.formalLearnings.label\' | translate}} {{application.isVocational ? (\'apel.formalLearnings.vocationalSubtitle\' | translate) : (\'apel.formalLearnings.higherSubtitle\' | translate)}} </legend> <span ng-if="application.isVocational" ng-repeat="record in application.records | filter:{isFormalLearning: true} | orderBy:\'id\'"> <div ng-include="\'apelApplication/templates/apel.application.formal.learning.vocational.list.html\'" style="margin-bottom: 20px"></div> </span> <span ng-if="!application.isVocational" ng-repeat="record in application.records | filter:{isFormalLearning: true} | orderBy:\'id\'"> <div ng-include="\'apelApplication/templates/apel.application.formal.learning.higher.list.html\'" style="margin-bottom: 20px"></div> </span> <md-button ng-if="application.canEdit" class="md-raised md-default" ng-click="editFormalLearning()">{{\'main.button.create\' | translate}}</md-button> </fieldset> </div> <div>&nbsp;</div> <div ng-hide="!application.student"> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small"> {{\'apel.informalLearnings.label\' | translate}} {{application.isVocational ? (\'apel.informalLearnings.vocationalSubtitle\' | translate) : (\'apel.informalLearnings.higherSubtitle\' | translate)}} </legend> <span ng-repeat="record in application.records | filter:{isFormalLearning: false} | orderBy:\'id\'"> <div ng-if="application.isVocational" ng-include="\'apelApplication/templates/apel.application.informal.learning.vocational.list.html\'" style="margin-bottom: 20px"></div> <div ng-if="!application.isVocational" ng-include="\'apelApplication/templates/apel.application.informal.learning.higher.list.html\'" style="margin-bottom: 20px"></div> </span> <md-button ng-if="application.canEdit" class="md-raised md-default" ng-click="editInformalLearning()">{{\'main.button.create\' | translate}}</md-button> </fieldset> </div> <div>&nbsp;</div> <div ng-hide="!application.student" layout="column" flex> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'apel.addInfo.addInfos\' | translate}}</legend> <md-button ng-if="application.canEdit" class="md-raised" ng-click="openEditCommentDialog()">{{\'main.button.create\' | translate}}</md-button> <md-table-container> <table md-table md-progress="tabledata.$promise" class="secondary-table"> <thead md-head> <tr md-row> <th md-column width="55%">{{\'apel.addInfo.label\' | translate}}</th> <th md-column width="20%">{{\'apel.addInfo.additionDate\' | translate}}</th> <th md-column width="20%">{{\'apel.addInfo.addedBy\' | translate}}</th> <th md-column width="5%"></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="comment in application.comments | orderBy: \'inserted\'" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{comment.addInfo}}</td> <td md-cell>{{comment.inserted | hoisDateTime}}</td> <td md-cell>{{comment.insertedBy}}</td> <td md-cell></td> </tr> </tbody> </table> </md-table-container> </fieldset> </div> <div>&nbsp;</div> <div ng-hide="!application.student" layout="column" flex> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.relatedFiles\' | translate}}</legend> <md-button class="md-raised" ng-if="application.canEdit" ng-click="openAddFileDialog()">{{\'main.button.uploadFile\' | translate}}</md-button> <md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column width="55%"> <span>{{\'file.nameAndFile\' | translate}}</span> </th> <th md-column width="20%"> <span>{{\'file.additionDate\' | translate}}</span> </th> <th md-column width="20%">{{\'file.addedBy\' | translate}}</th> <th md-column width="5%"></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="file in application.files | orderBy: \'id\'" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell> <div layout="row" flex> <div> {{file.oisFile.fname}} </div> <div flex> <a ng-href="{{getUrl(file.oisFile, \'apelapplication\')}}" target="_blank" rel="noopener noreferrer"> <md-icon md-font-set="material-icons">file_download</md-icon> </a> </div> </div> </td> <td md-cell> {{file.inserted | hoisDateTime}} </td> <td md-cell> {{file.insertedBy}} </td> <td md-cell> <a class="remove nomargin" ng-if="application.canEdit" ng-click="deleteFile(file)">&times;</a> </td> </tr> </tbody> </table> </md-table-container> </fieldset> </div> <div>&nbsp;</div> <div ng-if="(application.status !== \'VOTA_STAATUS_K\' && auth.isAdmin()) || application.committee || application.decision"> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'apel.committee \' | translate}}</legend> <div ng-if="application.status === \'VOTA_STAATUS_E\'" flex="45" flex-sm="100" flex-xs="100"> <md-input-container style="width: 100%"> <label>{{\'apel.committee\' | translate}}</label> <hois-select ng-model="application.committeeId" values="committees" ng-disabled="!application.canEdit" required></hois-select> </md-input-container> </div> <div ng-if="application.status !== \'VOTA_STAATUS_E\' || (application.status === \'VOTA_STAATUS_E\' && !application.canEdit)" layout="column" class="form-readonly"> <div>&nbsp;</div> <md-input-container> <label>{{\'apel.committee\' | translate}}</label> <hois-value value="currentLanguageNameField(application.committee)"></hois-value> </md-input-container> </div> <div ng-if="application.decision" layout="column" flex> <md-input-container flex> <label>{{\'apel.decision\' | translate}}</label> <textarea ng-model="application.decision" md-maxlength="4000" max-rows="5" readonly></textarea> </md-input-container> </div> </fieldset> </div> <div>&nbsp;</div> <div ng-if="application.student" layout="row" layout-xs="column"> <md-button class="md-raised md-primary" ng-if="canChangeTransferStatus" type="submit">{{\'main.button.save\' | translate}}</md-button> <md-button class="md-raised md-default" ng-if="(auth.isStudent() || auth.isAdmin()) && application.status === \'VOTA_STAATUS_K\'" ng-click="submit()">{{\'main.button.submit\' | translate}}</md-button> <md-button class="md-raised md-default" ng-if="(auth.isStudent() || auth.isAdmin()) && application.status === \'VOTA_STAATUS_K\'" ng-click="delete()">{{\'main.button.delete\' | translate}}</md-button> <md-button class="md-raised md-default" ng-if="application.canSendToConfirm" ng-click="sendToConfirm()">{{\'apel.sendToConfirm\' | translate}}</md-button> <md-button class="md-raised md-default" ng-if="application.canSendToCommittee" ng-click="sendToCommittee()" ng-disabled="!application.committeeId">{{\'apel.sendToCommittee\' | translate}}</md-button> <md-button class="md-raised md-default" ng-if="application.canSendBackToCreation" ng-click="sendBackToCreation()">{{\'apel.sendBackToCreation\' | translate}}</md-button> <md-button class="md-raised md-default" ng-if="application.canConfirm" ng-click="confirm()">{{\'apel.confirm\' | translate}}</md-button> <md-button class="md-raised md-default" ng-if="application.canSendBack" ng-click="sendBack()">{{\'apel.sendBack\' | translate}}</md-button> <md-button class="md-raised md-default" ng-if="application.canReject" ng-click="reject()">{{\'apel.reject\' | translate}}</md-button> <md-button class="md-raised md-default" ng-if="application.canRemoveConfirmation" ng-click="removeConfirmation()">{{\'apel.removeConfirmation\' | translate}}</md-button> <a href="{{applicationPdfUrl}}" target="_blank" class="md-button md-raised">{{\'main.button.print\' | translate}}</a> <md-button class="md-raised md-default" href="/#/apelApplication/">{{\'main.button.back\' | translate}}</md-button> </div> <div ng-if="!application.student" layout="row"> <md-button class="md-raised md-default" ng-click="back(\'/#/apelApplication/\')">{{\'main.button.back\' | translate}}</md-button> </div> </form> </div> </div>'),a.put("apelApplication/apel.application.list.html",'<div ng-if="auth.isAdmin() || auth.isTeacher()" class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <form name="searchForm" ng-submit="loadData()" novalidate> <div layout="row" layout-sm="column" layout-xs="column"> <div flex="45" flex-sm="100" flex-xs="100"> <hois-autocomplete flex ha-controller="directiveControllers" ng-model="criteria.studentObject" method="students" name="student" label="apel.student"></hois-autocomplete> </div> <div flex="50" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <div layout="column" flex> <div layout="row" flex> <hois-autocomplete flex ha-controller="directiveControllers" ng-model="criteria.committeeObject" method="committees" name="committee" additional-query-params="{type: \'KOMISJON_V\', memberPerson: auth.isTeacher() ? auth.user : null}" label="apel.committee"></hois-autocomplete> </div> </div> </div> </div> <div layout="row" layout-sm="column" layout-xs="column"> <div flex="45" flex-sm="100" flex-xs="100"> <div layout="column" flex> <div layout="row" layout-xs="column" flex> <md-input-container> <label>{{\'apel.insertedFrom\' | translate}}</label> <md-datepicker ng-model="criteria.insertedFrom" md-max-date="criteria.insertedThru" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> <md-input-container flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'apel.insertedThru\' | translate}}</label> <md-datepicker ng-model="criteria.insertedThru" md-min-date="criteria.insertedFrom" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> </div> </div> </div> <div ng-if="!auth.isTeacher()" flex="45" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <div layout="column" flex> <div layout="row" flex> <md-input-container> <label>{{\'apel.confirmedFrom\' | translate}}</label> <md-datepicker ng-model="criteria.confirmedFrom" md-max-date="criteria.confirmedThru" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> <md-input-container flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'apel.confirmedThru\' | translate}}</label> <md-datepicker ng-model="criteria.confirmedThru" md-min-date="criteria.confirmedFrom" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> </div> </div> </div> </div> <div ng-if="!auth.isTeacher()" layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label>{{\'apel.status\' | translate}}</label> <hois-classifier-select multiple ng-model="criteria.status" main-classifier-code="VOTA_STAATUS" model-value-attr="code"></hois-classifier-select> </md-input-container> </div> <div layout="row"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> <md-button ng-if="isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_VOTA\')" ng-href="#/apelApplication/new" class="md-raised">{{\'main.button.create\' | translate}}</md-button> </div> <div flex-xs="0" flex-gt-xs="0" flex-gt-sm="50"></div> </form> </fieldset> </div> </div> <div layout-padding ng-if="auth.isStudent()"> <div flex> <md-button ng-href="#/apelApplication/new" class="md-raised">{{\'main.button.create\' | translate}}</md-button> </div> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column ng-if="!auth.isStudent()" md-order-by="student_lastname, student_firstname">{{\'apel.studentName\' | translate}}</th> <th md-column ng-if="!auth.isStudent()" md-order-by="{{\'curriculum_\' + currentLanguageNameField()}}">{{\'apel.curriculum\' | translate}}</th> <th md-column ng-if="!auth.isTeacher()" md-order-by="application_status">{{\'apel.status\' | translate}}</th> <th md-column md-order-by="inserted">{{\'apel.insertedDate\' | translate}}</th> <th md-column ng-if="!auth.isTeacher()" md-order-by="confirmed">{{\'apel.confirmedDate\' | translate}}</th> <th md-column ng-if="auth.isStudent()"></th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell ng-if="!auth.isStudent()"> <a ng-href="#/apelApplication/{{row.id}}/view">{{currentLanguageNameField(row.student)}}</a> </td> <td md-cell ng-if="!auth.isStudent()">{{currentLanguageNameField(row.curriculum)}}</td> <td md-cell ng-if="!auth.isTeacher()"> <hois-classifier-value ng-model="row.status" main-classifier-code="VOTA_STAATUS"></hois-classifier-value> </td> <td md-cell>{{row.inserted | hoisDate}}</td> <td md-cell ng-if="!auth.isTeacher()">{{row.confirmed | hoisDate}}</td> <td md-cell ng-if="auth.isStudent()"> <div> <md-button md-no-ink class="md-primary change-button" ng-href="#/apelApplication/{{::row.id}}/view">{{\'main.button.view\' | translate}}</md-button> </div> </td> <td md-cell> <div ng-if="row.canEdit || row.canReview"> <md-button md-no-ink class="md-primary change-button" ng-href="#/apelApplication/{{::row.id}}/edit">{{\'main.button.change\' | translate}}</md-button> </div> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> </div>'),a.put("apelApplication/apel.application.view.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <div ng-include="\'apelApplication/templates/apel.application.information.html\'"></div> <div> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small"> {{\'apel.formalLearnings.label\' | translate}} {{application.isVocational ? (\'apel.formalLearnings.vocationalSubtitle\' | translate) : (\'apel.formalLearnings.higherSubtitle\' | translate)}} </legend> <span ng-if="application.isVocational" ng-repeat="record in application.records | filter:{isFormalLearning: true} | orderBy:\'id\'"> <div ng-include="\'apelApplication/templates/apel.application.formal.learning.vocational.list.html\'" style="margin-bottom: 20px"></div> </span> <span ng-if="!application.isVocational" ng-repeat="record in application.records | filter:{isFormalLearning: true} | orderBy:\'id\'"> <div ng-include="\'apelApplication/templates/apel.application.formal.learning.higher.list.html\'" style="margin-bottom: 20px"></div> </span> </fieldset> </div> <br> <div> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small"> {{\'apel.informalLearnings.label\' | translate}} {{application.isVocational ? (\'apel.informalLearnings.vocationalSubtitle\' | translate) : (\'apel.informalLearnings.higherSubtitle\' | translate)}} </legend> <span ng-repeat="record in application.records | filter:{isFormalLearning: false}"> <div ng-if="application.isVocational" ng-include="\'apelApplication/templates/apel.application.informal.learning.vocational.list.html\'" style="margin-bottom: 20px"></div> <div ng-if="!application.isVocational" ng-include="\'apelApplication/templates/apel.application.informal.learning.higher.list.html\'" style="margin-bottom: 20px"></div> </span> </fieldset> </div> <br> <div layout="column" flex> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'apel.addInfo.addInfos\' | translate}}</legend> <md-table-container> <table md-table md-progress="tabledata.$promise" class="secondary-table"> <thead md-head> <tr md-row> <th md-column width="60%">{{\'apel.addInfo.label\' | translate}}</th> <th md-column width="20%">{{\'apel.addInfo.additionDate\' | translate}}</th> <th md-column width="20%">{{\'apel.addInfo.addedBy\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="comment in application.comments | orderBy: \'inserted\'" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{comment.addInfo}}</td> <td md-cell>{{comment.inserted | hoisDateTime}}</td> <td md-cell>{{comment.insertedBy}}</td> </tr> </tbody> </table> </md-table-container> </fieldset> </div> <br> <div layout="column" flex> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.relatedFiles\' | translate}}</legend> <md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column width="60%"> <span>{{\'file.nameAndFile\' | translate}}</span> </th> <th md-column width="20%"> <span>{{\'file.additionDate\' | translate}}</span> </th> <th md-column width="20%">{{\'file.addedBy\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="file in application.files | orderBy: \'id\'" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell> <div layout="row" flex> <div> {{file.oisFile.fname}} </div> <div flex> <a ng-href="{{getUrl(file.oisFile, \'apelapplication\')}}" target="_blank" rel="noopener noreferrer"> <md-icon md-font-set="material-icons">file_download</md-icon> </a> </div> </div> </td> <td md-cell> {{file.inserted | hoisDateTime}} </td> <td md-cell> {{file.insertedBy}} </td> </tr> </tbody> </table> </md-table-container> </fieldset> <div>&nbsp;</div> <div ng-if="(application.status !== \'VOTA_STAATUS_K\' && auth.isAdmin()) || application.committee || application.decision"> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'apel.committee \' | translate}}</legend> <div ng-if="application.status === \'VOTA_STAATUS_E\' && application.canEdit" flex="45" flex-sm="100" flex-xs="100"> <md-input-container style="width: 100%"> <label>{{\'apel.committee\' | translate}}</label> <hois-select ng-model="application.committeeId" values="committees" required></hois-select> </md-input-container> </div> <div ng-if="application.status !== \'VOTA_STAATUS_E\' || (application.status === \'VOTA_STAATUS_E\' && !application.canEdit)" layout="column" class="form-readonly"> <div>&nbsp;</div> <md-input-container> <label>{{\'apel.committee\' | translate}}</label> <hois-value value="currentLanguageNameField(application.committee)"></hois-value> </md-input-container> </div> <div ng-if="application.decision" layout="column" flex> <md-input-container flex> <label>{{\'apel.decision\' | translate}}</label> <textarea ng-model="application.decision" md-maxlength="4000" max-rows="5" disabled></textarea> </md-input-container> </div> </fieldset> </div> <div>&nbsp;</div> <div layout="row" layout-xs="column"> <md-button ng-if="application.canEdit || application.canReview" class="md-raised md-primary" ng-href="#/apelApplication/{{::applicationId}}/edit">{{\'main.button.edit\' | translate}}</md-button> <md-button class="md-raised md-default" ng-if="application.canSendToConfirm" ng-click="sendToConfirm()">{{\'apel.sendToConfirm\' | translate}}</md-button> <md-button class="md-raised md-default" ng-if="application.canSendBackToCreation" ng-click="sendBackToCreation()">{{\'apel.sendBackToCreation\' | translate}}</md-button> <md-button class="md-raised md-default" ng-if="application.canConfirm" ng-click="confirm()">{{\'apel.confirm\' | translate}}</md-button> <md-button class="md-raised md-default" ng-if="application.canSendToCommittee" ng-click="sendToCommittee()" ng-disabled="!application.committeeId">{{\'apel.sendToCommittee\' | translate}}</md-button> <md-button class="md-raised md-default" ng-if="application.canSendBack" ng-click="sendBack()">{{\'apel.sendBack\' | translate}}</md-button> <md-button class="md-raised md-default" ng-if="application.canReject" ng-click="reject()">{{\'apel.reject\' | translate}}</md-button> <md-button class="md-raised md-default" ng-if="application.canRemoveConfirmation" ng-click="removeConfirmation()">{{\'apel.removeConfirmation\' | translate}}</md-button> <a href="{{applicationPdfUrl}}" target="_blank" class="md-button md-raised">{{\'main.button.print\' | translate}}</a> <md-button class="md-raised md-default" ng-click="back(\'/#/apelApplication/\')">{{\'main.button.back\' | translate}}</md-button> </div> </div> </div> </div>'),a.put("apelApplication/apel.school.edit.html",'<div layout="column" layout-padding> <div> <form name="apelSchoolForm"> <md-input-container class="md-block"> <label>{{\'apel.apelSchool.country\' | translate}}</label> <hois-classifier-select ng-model="apelSchool.country" aria-label="country" model-value-attr="code" main-classifier-code="RIIK" ng-change="countryChanged(apelSchool.country)" required></hois-classifier-select> </md-input-container> <md-input-container class="md-block" ng-if="apelSchool.country === \'RIIK_EST\'"> <label class="textInput">{{\'apel.apelSchool.schoolEHIS\' | translate}}</label> <hois-classifier-select ng-model="apelSchool.ehisSchool" aria-label="ehisSchool" model-value-attr="code" main-classifier-code="EHIS_KOOL" ng-change="ehisSchoolChanged(apelSchool.ehisSchool)" filter-values="usedEhisSchoolCodes" required></hois-classifier-select> </md-input-container> <md-input-container class="md-block"> <label class="textInput">{{\'apel.apelSchool.schoolNameEt\' | translate}}</label> <input ng-model="apelSchool.nameEt" name="nameEt" type="text" md-maxlength="100" required> </md-input-container> <md-input-container class="md-block"> <label class="textInput">{{\'apel.apelSchool.schoolNameEn\' | translate}}</label> <input ng-model="apelSchool.nameEn" name="nameEn" type="text" md-maxlength="100"> </md-input-container> </form> <md-button ng-click="update()" class="md-raised md-primary">{{\'main.button.save\' | translate}}</md-button> <md-button ng-click="delete()" ng-if="apelSchool.id" class="md-raised">{{\'main.button.delete\' | translate}}</md-button> <md-button ng-href="#/apelSchools" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </div> </div>'),a.put("apelApplication/apel.school.list.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <form name="searchForm" ng-submit="searchForm.$valid && loadData()" novalidate ng-model-options="{allowInvalid: true}"> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'apel.apelSchool.schoolNameEt\' | translate}}</label> <input ng-model="criteria.name" name="name" type="text" md-maxlength="255" autofocus> </md-input-container> <md-input-container flex="50" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'apel.apelSchool.country\' | translate}}</label> <hois-classifier-select multiple ng-model="criteria.country" main-classifier-code="RIIK" model-value-attr="code"></hois-classifier-select> </md-input-container> </div> <div layout="row"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> <md-button class="md-raised" ng-if="isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_VOTA\')" ng-href="#/apelSchools/new">{{\'main.button.create\' | translate}}</md-button> </div> <div flex-xs="0" flex-gt-xs="0" flex-gt-sm="50"></div> </form> </fieldset> </div> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="nameEt">{{\'apel.apelSchool.schoolNameEt\' | translate}}</th> <th md-column md-order-by="nameEn">{{\'apel.apelSchool.schoolNameEn\' | translate}}</th> <th md-column md-order-by="countryCode">{{\'apel.apelSchool.country\' | translate}}</th> <th md-column md-order-by="ehisSchoolCode">{{\'apel.apelSchool.schoolEHIS\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{row.nameEt}}</td> <td md-cell>{{row.nameEn}}</td> <td md-cell> <hois-classifier-value ng-model="row.country" main-classifier-code="RIIK"></hois-classifier-value> </td> <td md-cell> <hois-classifier-value ng-model="row.ehisSchool" main-classifier-code="EHIS_KOOL"></hois-classifier-value> </td> <td md-cell> <div> <md-button md-no-ink class="md-primary change-button" ng-if="isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_VOTA\')" ng-href="#/apelSchools/{{::row.id}}/edit">{{\'main.button.change\' | translate}}</md-button> </div> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> </div>'),
a.put("application/application.html",'<div class="ois-form-layout-padding" ng-cloak> <div flex> <form ng-submit="loadData()" layout="column" name="applicationForm"> <div ng-show="!applicationEditView"> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="60" flex-sm="100" flex-xs="100"> <label>{{\'application.type\' | translate}}</label> <hois-classifier-select ng-model="application.type" model-value-attr="code" main-classifier-code="AVALDUS_LIIK" only-valid show-only-values="showOnlyTypes" criteria="{higher: auth.school.higher ? true : undefined, vocational: auth.school.vocational ? true : undefined}" ng-change="applicationTypeChange()"></hois-classifier-select> </md-input-container> </div> <div ng-hide="!application.type" layout="row" layout-sm="column" layout-xs="column"> <div flex="60" flex-sm="100" flex-xs="100"> <hois-autocomplete ng-model="application.student" method="students" additional-query-params="studentSearchCriteria" name="student" label="student.label"></hois-autocomplete> </div> </div> </div> <div ng-if="applicationEditView" style="padding-top: 1em"> <div ng-include="\'application/templates/application.html\'"></div> </div> <br> <div ng-show="applicationEditView" layout="row"> <md-button ng-if="canSave" class="md-raised md-primary" ng-click="save()">{{\'main.button.save\' | translate}}</md-button> <div ng-include="\'application/templates/action.buttons.html\'"></div> <md-button ng-click="back(auth.isStudent() || auth.isParent() ? \'#/applications/student\' : \'#/applications/\', applicationForm)" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </div> <div ng-hide="applicationEditView" layout="row"> <md-button ng-click="back(\'#/applications/\')" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </div> </form> </div> </div>'),a.put("application/application.list.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <form name="searchForm" ng-submit="searchForm.$valid && loadData()" layout="column" ng-model-options="{allowInvalid: true}"> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="100"> <label>{{\'application.type\' | translate}}</label> <hois-classifier-select multiple ng-model="criteria.type" criteria="{higher: auth.school.higher ? true : undefined, vocational: auth.school.vocational ? true : undefined}" model-value-attr="code" main-classifier-code="AVALDUS_LIIK"></hois-classifier-select> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <div flex> <md-input-container> <label>{{\'application.insertionDateA\' | translate}}</label> <md-datepicker ng-model="criteria.insertedFrom" md-max-date="criteria.insertedThru" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> <md-input-container> <label>{{\'application.insertionDateK\' | translate}}</label> <md-datepicker ng-model="criteria.insertedThru" md-min-date="criteria.insertedFrom" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> </div> </div> <div layout="row" layout-sm="column" layout-xs="column"> <div flex> <md-input-container> <label>{{\'application.submissionDateA\' | translate}}</label> <md-datepicker ng-model="criteria.submittedFrom" md-max-date="criteria.submittedThru" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> <md-input-container> <label>{{\'application.submissionDateK\' | translate}}</label> <md-datepicker ng-model="criteria.submittedThru" md-min-date="criteria.submittedFrom" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> </div> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="100"> <label class="textInput">{{\'main.status\' | translate}}</label> <hois-classifier-select multiple ng-model="criteria.status" model-value-attr="code" main-classifier-code="AVALDUS_STAATUS"></hois-classifier-select> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="100"> <label class="textInput">{{\'application.studentName\' | translate}}</label> <input ng-model="criteria.studentName" type="text" md-maxlength="255"> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="100"> <label class="textInput">{{\'application.studentIdCode\' | translate}}</label> <input ng-model="criteria.studentIdCode" type="text" minlength="11" md-maxlength="11"> </md-input-container> </div> <div layout="row" layout-xs="column"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> <md-button ng-href="#/applications/new" ng-if="isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_AVALDUS\')" class="md-raised">{{\'application.makeApplication\' | translate}}</md-button> </div> <div flex-xs="0" flex-gt-xs="0" flex-gt-sm="50"></div> </form> </fieldset> </div> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="person.lastname,person.firstname">{{\'application.student\' | translate}}</th> <th md-column md-order-by="{{currentLanguage()===\'en\' ? \'type.nameEn\' : \'type.nameEt\'}}">{{\'application.type\' | translate}}</th> <th md-column md-order-by="{{currentLanguage()===\'en\' ? \'status.nameEn\' : \'status.nameEt\'}}">{{\'main.status\' | translate}}</th> <th md-column md-order-by="inserted">{{\'application.insertionDate\' | translate}}</th> <th md-column md-order-by="submitted">{{\'application.submissionDate\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell><a ng-href="/#/students/{{::row.student.id}}/main">{{::row.student.nameEt}}</a></td> <td md-cell><a ng-href="#/applications/{{::row.id}}/view">{{currentLanguageNameField(row.type)}}</a></td> <td md-cell> {{currentLanguageNameField(row.status)}} <md-tooltip ng-if="row.status.code === \'AVALDUS_STAATUS_TAGASI\' && row.rejectReason">{{row.rejectReason}}</md-tooltip> </td> <td md-cell>{{row.inserted | hoisDateTime}}</td> <td md-cell>{{row.submitted | hoisDateTime}}</td> <td md-cell> <md-button ng-if="((row.status.code === \'AVALDUS_STAATUS_KOOST\') || ((row.status.code === \'AVALDUS_STAATUS_YLEVAAT\' || row.status.code === \'AVALDUS_STAATUS_ESIT\') && auth.isAdmin()))\r\n            && isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_AVALDUS\') && row.canEditStudent" md-no-ink class="md-primary change-button" ng-href="#/applications/{{::row.id}}/edit">{{\'main.button.change\' | translate}}</md-button> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> </div>'),a.put("application/application.view.html",'<div class="ois-form-layout-padding" ng-cloak> <div flex> <form layout="column" name="applicationForm"> <div class="form-readonly"> <div style="padding-top: 1em"> <md-input-container ng-if="!application.isAdult && application.needsRepresentativeConfirm === true && application.status === \'AVALDUS_STAATUS_KOOST\'" flex="60" flex-sm="100" flex-xs="100"> <b>{{\'application.missingRepresentativeConfirmation\' | translate}}</b> </md-input-container> <md-input-container ng-if="!application.isAdult && auth.isStudent() && application.status === \'AVALDUS_STAATUS_KINNITAM\' && application.type === \'AVALDUS_LIIK_TUGI\'" flex="60" flex-sm="100" flex-xs="100"> <b>{{\'application.missingRepresentativeConfirmation\' | translate}}</b> </md-input-container> <div ng-if="application.type !== \'AVALDUS_LIIK_TUGI\'" ng-include="\'application/templates/application.information.html\'"></div> <div ng-include="templateUrlByType"></div> <div layout="row" layout-sm="column" layout-xs="column" ng-if="application.type !== \'AVALDUS_LIIK_TUGI\'"> <md-input-container flex="60" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'application.additionalInfo\' | translate}}</label> <hois-value value="application.addInfo"></hois-value> </md-input-container> </div> <div layout="column" flex> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.relatedFiles\' | translate}}</legend> <md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column><span>{{\'file.nameAndFile\' | translate}}</span></th> <th md-column><span>{{\'file.additionDate\' | translate}}</span></th> <th md-column>{{\'file.addedBy\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="file in application.files | orderBy: \'id\'" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell> {{file.oisFile.fname}} <a ng-href="{{getUrl(file.oisFile, \'application\')}}" target="_blank" rel="noopener noreferrer"> <md-icon md-font-set="material-icons">file_download</md-icon> </a> </td> <td md-cell> {{file.inserted | hoisDateTime}} </td> <td md-cell> {{file.insertedBy}} </td> </tr> </tbody> </table> </md-table-container> </fieldset> </div> </div> <div>&nbsp;</div> </div> <div ng-if="application.canEditStudent && application.id > 0\r\n          && application.status === \'AVALDUS_STAATUS_KINNITAM\' && application.type === \'AVALDUS_LIIK_TUGI\'\r\n          && ((auth.isStudent() && application.isAdult) || auth.isParent() || (auth.isAdmin() && isAuthorized(\'ROLE_OIGUS_K_TEEMAOIGUS_AVALDUS\')))"> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'application.agreement\' | translate}}</legend> <div layout="column"> <md-input-container style="max-width: 360px"> <label>{{\'application.agreeWithDecision\' | translate}}</label> <md-select ng-model="application.agreeWithDecision" required> <md-option ng-value="false">{{\'main.no\' | translate}}</md-option> <md-option ng-value="true">{{\'main.yes\' | translate}}</md-option> </md-select> </md-input-container> <md-input-container> <label>{{\'application.representativeDecisionAddInfo\' | translate}}</label> <textarea ng-model="application.representativeDecisionAddInfo" md-maxlength="4000" max-rows="10" ng-required="application.agreeWithDecision === false"></textarea> </md-input-container> <div layout="column" ng-if="auth.isAdmin()"> <md-input-container flex> <lf-ng-md-file-input name="fileData" lf-files="fileData" lf-browse-label="{{\'main.addFile\' | translate}}" lf-remove-label="{{\'main.button.delete\' | translate}}" lf-placeholder="{{\'application.agreementFile\' | translate}}" lf-filesize="5MB" disallow-same-file="application.files" ng-change="onOisFileChange()"> </lf-ng-md-file-input> </md-input-container> <div ng-messages="applicationForm.fileData.$error"> <div class="invalid" ng-message="filesize">{{\'main.messages.error.fileTooLarge\' | translate}} 5MB!</div> <div class="invalid" ng-message="samefile">{{\'main.messages.error.fileAlreadyExists\' | translate}}</div> </div> </div> </div> </fieldset> <div>&nbsp;</div> </div> <div layout="row" layout-xs="column"> <md-button ng-if="canChange" ng-href="#/applications/{{application.id}}/edit?_noback" class="md-raised md-primary">{{\'main.button.change\' | translate}}</md-button> <div ng-include="\'application/templates/action.buttons.html\'"></div> <md-button ng-if="auth.isStudent() || auth.isParent()" ng-click="back(\'#/applications/student\')" class="md-raised">{{\'main.button.back\' | translate}}</md-button> <md-button ng-if="!(auth.isStudent() || auth.isParent())" ng-click="back(\'#/applications/\', applicationForm)" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </div> </form> </div> </div>'),a.put("application/file.add.dialog.html",'<md-dialog aria-label="file add dialog" flex="40" flex-xs="100"> <form name="dialogForm" ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2>{{"main.addFile" | translate}}</h2> <span flex></span> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <span flex></span> <div class="ois-form-layout" layout="column" layout-margin ng-cloak> <div layout="column"> <md-input-container flex> <lf-ng-md-file-input name="file" lf-files="data.file" lf-browse-label="{{\'main.addFile\' | translate}}" lf-remove-label="{{\'main.button.delete\' | translate}}" lf-placeholder="" lf-filesize="5MB" disallow-same-file="addedFiles" lf-required> </lf-ng-md-file-input> </md-input-container> <div ng-messages="dialogForm.file.$error"> <div class="invalid" ng-message="required">{{\'main.messages.error.selectFile\' | translate}}</div> <div class="invalid" ng-message="filesize">{{\'main.messages.error.fileTooLarge\' | translate}} 5MB!</div> <div class="invalid" ng-message="samefile">{{\'main.messages.error.fileAlreadyExists\' | translate}}</div> </div> </div> </div> </md-dialog-content> <span flex></span> <md-dialog-actions layout="row" layout-align="start center"> <md-button class="md-raised md-primary" ng-click="submit()">{{"main.button.save" | translate}}</md-button> <md-button class="md-raised" ng-click="cancel()">{{"main.button.close" | translate}}</md-button> </md-dialog-actions> </form> </md-dialog>'),a.put("application/reject.dialog.html",'<md-dialog aria-label="reject dialog" flex="50" flex-xs="100"> <form name="dialogForm" ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2>{{"application.rejection" | translate}}</h2> <span flex></span> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <span flex></span> <div class="ois-form-layout" layout="column" layout-margin ng-cloak> <div layout="column" flex> <md-input-container flex> <label>{{\'application.justification\' | translate}}</label> <textarea ng-model="rejectReason" md-maxlength="1000" max-rows="2" required md-autofocus></textarea> </md-input-container> </div> </div> </md-dialog-content> <span flex></span> <md-dialog-actions layout="row" layout-align="start center"> <md-button class="md-raised" ng-click="submit()">{{"main.button.reject" | translate}}</md-button> <md-button class="md-raised" ng-click="cancel()">{{"main.button.close" | translate}}</md-button> </md-dialog-actions> </form> </md-dialog>'),a.put("baseModule/basemodule.edit.html",'<div class="ois-form-layout-padding nomargin"> <form ng-cloak name="baseModuleForm"> <div layout="column" ng-cloak> <div layout="row" flex> <md-input-container flex="90" flex-sm="75" flex-xs="75"> <label>{{\'basemodule.nameEt\' | translate}}</label> <input ng-model="baseModule.nameEt" name="nameEt" type="text" md-maxlength="255" required> </md-input-container> <md-input-container flex="10" flex-sm="20" flex-xs="20" flex-offset="5"> <label>{{\'basemodule.ekap\' | translate}}</label> <input ng-model="baseModule.credits" type="number" name="credits" min="0" max="999" pattern="^\\d+(\\.\\d{1})?$" required> <div ng-messages="baseModuleForm.credits.$error" ng-show="baseModuleForm.credits.$dirty"> <div ng-message="min"> {{\'main.messages.error.positive\' | translate}} </div> <div ng-message="max"> {{\'curriculum.error.max999\' | translate}} </div> <div ng-message="pattern"> {{\'stateCurriculum.error.decimalPresision\' | translate}} </div> </div> </md-input-container> </div> <md-input-container flex> <label>{{\'basemodule.nameEn\' | translate}}</label> <input ng-model="baseModule.nameEn" name="nameEn" type="text" md-maxlength="255"> </md-input-container> <md-input-container flex> <label>{{\'basemodule.objectivesEt\' | translate}}</label> <textarea ng-model="baseModule.objectivesEt" name="objectivesEt" md-maxlength="10000" max-rows="10" required></textarea> </md-input-container> <md-input-container flex> <label>{{\'basemodule.objectivesEn\' | translate}}</label> <textarea ng-model="baseModule.objectivesEn" name="objectivesEn" md-maxlength="10000" max-rows="10"></textarea> </md-input-container> <div flex> <fieldset tabindex="0"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'basemodule.studyOutcome\' | translate}} *</legend> <input style="display:none" type="number" readonly name="outcomesLength" ng-model="baseModule.outcomes.length" min="1"> <div class="invalid" ng-if="baseModuleForm.$submitted" ng-messages="baseModuleForm.outcomesLength.$error"> <div ng-message="min">{{\'main.messages.error.atLeastOneShouldBeAdded\' | translate}}</div> </div> <div layout="row" flex> <md-input-container flex="45"> <label>{{\'studyOutcome.nameEt\' | translate}} *</label> <textarea ng-model="outcomeEt" md-maxlength="1000" max-rows="10"></textarea> </md-input-container> <md-input-container flex="40" flex-offset="5"> <label>{{\'studyOutcome.nameEn\' | translate}}</label> <textarea ng-model="outcomeEn" md-maxlength="1000" max-rows="10"></textarea> </md-input-container> <md-button class="md-primary" ng-click="addOutcome()" ng-if="!isEditingOutcome">{{\'main.button.add\' | translate}}</md-button> <md-button class="md-primary" ng-click="saveOutcome()" ng-if="isEditingOutcome">{{\'main.button.change\' | translate}}</md-button> </div> <div layout="column"> <div ng-repeat="item in baseModule.outcomes track by $index" class="occupation-row align-center" layout="row" flex> <div flex="45"> <a ng-click="editOutcome(item)"> <p class="scrollable">{{item.outcomeEt}}</p> </a> </div> <div flex="40" flex-offset="5"> <a ng-click="editOutcome(item)"> <p class="scrollable">{{item.outcomeEn}}</p> </a> </div> <div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div> <div> <a class="remove" ng-click="removeFromArray(baseModule.outcomes, item)">&times;&nbsp;&nbsp;</a> </div> <div> <p ng-if="$first" class="link-disabled">&#9650;&nbsp;</p> <a ng-if="!$first" class="link-no-underline" ng-click="swap($index, $index - 1)">&#9650;&nbsp;</a> </div> <div> <p ng-if="$last" class="link-disabled">&#9660;&nbsp;</p> <a ng-if="!$last" class="link-no-underline" ng-click="swap($index, $index + 1)">&#9660;&nbsp;</a> </div> </div> </div> </fieldset> </div> <div>&nbsp;</div> <md-input-container flex> <label>{{\'stateCurriculum.enter.module.criteriaEt\' | translate}}</label> <textarea ng-model="baseModule.assessmentsEt" name="assessmentsEt" required md-maxlength="20000" max-rows="10"></textarea> </md-input-container> <md-input-container flex> <label>{{\'stateCurriculum.enter.module.criteriaEn\' | translate}}</label> <textarea ng-model="baseModule.assessmentsEn" name="assessmentsEn" md-maxlength="20000" max-rows="10"></textarea> </md-input-container> <div flex> <fieldset tabindex="1"> <legend md-colors="{color: \'default-primary-800\'}" class="md-title-small">{{\'basemodule.capacityDistribution\' | translate}}</legend> <div layout="row" style="padding-bottom:1em" flex class="secondary-table-header"> <div flex="30">&nbsp;</div> <div flex="30">{{\'basemodule.capacity\' | translate}}</div> <div flex="40" layout="row">{{\'basemodule.contactStudy\' | translate}}</div> </div> <div ng-repeat="item in baseModule.capacities | orderBy: \'nameEt\' track by item.capacityType" layout="row" class="secondary-table-row"> <div flex="30" class="occupation-module-capacity">{{currentLanguageNameField(item)}}</div> <div flex="30"> <md-input-container flex> <input ng-model="item.hours" type="number" min="0" max="9999" pattern="^\\d+$" aria-label="capacity hours" class="small-input" ng-readonly="hasThemes()" ng-required="item.contact"> </md-input-container> </div> <div flex="40" layout="row"> <md-checkbox ng-model="item.contact" aria-label="capacity contact" ng-disabled="hasThemes()" class="occupation-module-capacity-contact"></md-checkbox> </div> </div> </fieldset> </div> <div>&nbsp;</div> <md-input-container flex> <label>{{\'basemodule.requirements\' | translate}}</label> <textarea ng-model="baseModule.cvRequirementsEt" name="cvRequirementsEt" required md-maxlength="20000" max-rows="10"></textarea> </md-input-container> <md-input-container flex> <label>{{\'basemodule.assessments\' | translate}}</label> <textarea ng-model="baseModule.cvAssessmentsEt" name="cvAssessmentsEt" required md-maxlength="20000" max-rows="10"></textarea> </md-input-container> <md-input-container flex> <label>{{\'basemodule.learningMethods\' | translate}}</label> <textarea ng-model="baseModule.cvLearningMethodsEt" name="cvLearningMethodsEt" md-maxlength="20000" max-rows="10"></textarea> </md-input-container> <md-input-container flex> <label>{{\'basemodule.assessmentMethodsAndTasks\' | translate}}</label> <textarea ng-model="baseModule.cvAssessmentMethodsEt" name="cvAssessmentMethodsEt" md-maxlength="20000" max-rows="10"></textarea> </md-input-container> <md-input-container flex> <label>{{\'basemodule.independentStudyDescription\' | translate}}</label> <textarea ng-model="baseModule.cvIndependentStudyEt" name="cvIndependentStudyEt" md-maxlength="20000" max-rows="2"></textarea> </md-input-container> <md-input-container flex> <label>{{\'basemodule.studyMaterials\' | translate}}</label> <textarea ng-model="baseModule.cvStudyMaterials" name="cvStudyMaterials" md-maxlength="20000" max-rows="2"></textarea> </md-input-container> <div flex> <fieldset tabindex="2"> <legend md-colors="{color: \'default-primary-800\'}" class="md-title-small">{{\'basemodule.gradeFormation\' | translate}}</legend> <div flex layout="row"> <span flex="30" class="common-label">{{\'basemodule.assessmentType\' | translate}}</span> <hois-classifier-radio layout="row" ng-model="baseModule.cvAssessment" name="cvAssessment" model-value-attr="code" main-classifier-code="KUTSEHINDAMISVIIS" required class="md-primary"></hois-classifier-radio> </div> <div>&nbsp;</div> <md-input-container flex style="width: 100%"> <label>{{\'basemodule.totalGradeDescription\' | translate}}</label> <textarea ng-model="baseModule.cvTotalGradeDescription" name="cvTotalGradeDescription" md-maxlength="20000" max-rows="2" required></textarea> </md-input-container> <div>&nbsp;</div> <div ng-show="baseModule.cvAssessment === \'KUTSEHINDAMISVIIS_E\'" layout="column"> <md-input-container flex> <label>{{\'basemodule.grade3Description\' | translate}}</label> <textarea ng-model="baseModule.cvGrade3Description" name="cvGrade3Description" md-maxlength="20000" max-rows="2" ng-required="baseModule.cvAssessment === \'KUTSEHINDAMISVIIS_E\'"></textarea> </md-input-container> <md-input-container flex> <label>{{\'basemodule.grade4Description\' | translate}}</label> <textarea ng-model="baseModule.cvGrade4Description" name="cvGrade4Description" md-maxlength="20000" max-rows="2" ng-required="baseModule.cvAssessment === \'KUTSEHINDAMISVIIS_E\'"></textarea> </md-input-container> <md-input-container flex> <label>{{\'basemodule.grade5Description\' | translate}}</label> <textarea ng-model="baseModule.cvGrade5Description" name="cvGrade5Description" md-maxlength="20000" max-rows="2" ng-required="baseModule.cvAssessment === \'KUTSEHINDAMISVIIS_E\'"></textarea> </md-input-container> </div> <div ng-show="baseModule.cvAssessment === \'KUTSEHINDAMISVIIS_M\'" layout="column" flex> <md-input-container flex> <label>{{\'basemodule.gradeADescription\' | translate}}</label> <textarea ng-model="baseModule.cvPassDescription" name="cvPassDescription" md-maxlength="20000" max-rows="10" ng-required="baseModule.cvAssessment === \'KUTSEHINDAMISVIIS_M\'"></textarea> </md-input-container> </div> </fieldset> </div> <div>&nbsp;</div> <div flex> <fieldset tabindex="3"> <legend md-colors="{color: \'default-primary-800\'}" class="md-title-small">{{\'basemodule.themes\' | translate}}</legend> <div layout="column"> <div flex="10"> <md-button class="md-raised" ng-click="editTheme()" ng-if="baseModuleId">{{\'main.button.add\' | translate}}</md-button> </div> <md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'basemodule.themeName\' | translate}}</th> <th md-column>{{\'basemodule.capacityEkapPerHour\' | translate}}</th> <th md-column>{{\'basemodule.subthemes\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="theme in baseModule.themes | orderBy: currentLanguageNameField()"> <td md-cell> <a class="md-primary one-row" ng-click="editTheme(theme)">{{currentLanguageNameField(theme)}}</a> </td> <td md-cell>{{theme.credits}}/{{theme.hours}}</td> <td md-cell><p class="scrollable">{{theme.subthemes}}</p></td> </tr> </tbody> </table> </md-table-container> </div> </fieldset> </div> <div>&nbsp;</div> <md-autocomplete name="teacher" md-selected-item="baseModule.teacher" md-search-text="queryText" md-items="teacher in searchTeacher(queryText)" md-item-text="currentLanguageNameField(teacher)" md-min-length="1" md-floating-label="{{\'basemodule.supervisor\' | translate}}" md-no-cache class="small-margin" required md-require-match flex> <md-item-template> <span md-highlight-text="queryText" md-highlight-flags="^i">{{currentLanguageNameField(teacher)}}</span> </md-item-template> <md-not-found> {{\'main.messages.error.notFound\' | translate}} </md-not-found> </md-autocomplete> <div flex> <fieldset tabindex="4"> <legend md-colors="{color: \'default-primary-800\'}" class="md-title-small">{{\'basemodule.validity\' | translate}}</legend> <div layout="row"> <md-input-container flex="50" flex-sm="100" flex-xs="100"> <label>{{\'main.validFrom\' | translate}}</label> <md-datepicker name="validFrom" ng-model="baseModule.validFrom" md-max-date="baseModule.validThru" required md-open-on-focus></md-datepicker> </md-input-container> <md-input-container flex="50" flex-sm="100" flex-xs="100"> <label>{{\'main.validTo\' | translate}}</label> <md-datepicker name="validThru" ng-model="baseModule.validThru" md-min-date="baseModule.validFrom" md-open-on-focus></md-datepicker> </md-input-container> </div> </fieldset> </div> <div>&nbsp;</div> <div flex ng-if="baseModule.curriculums.length > 0"> <fieldset tabindex="5"> <legend md-colors="{color: \'default-primary-800\'}" class="md-title-small">{{\'basemodule.connectedCurriculumsAndCurriculumVersions\' | translate}}</legend> <div layout="column"> <md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column style="width: 50%"> {{\'basemodule.curriculum\' | translate}} </th> <th md-column> {{\'basemodule.curriculumVersion\' | translate}} </th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="curriculum in baseModule.curriculums"> <td md-cell> <p><a href="#/vocationalCurriculum/{{curriculum.id}}/view">{{currentLanguageNameField(curriculum)}}</a></p> </td> <td md-cell> <p ng-repeat="cv in baseModule.curriculumVersions[curriculum.id]"><a href="#/vocationalCurriculum/{{curriculum.id}}/moduleImplementationPlan/{{cv.id}}/view">{{currentLanguageNameField(cv)}}</a><br ng-if="!$first"></p> </td> </tr> </tbody> </table> </md-table-container> </div> </fieldset> </div> </div> <div>&nbsp;</div> <md-button class="md-raised md-primary" ng-click="save()">{{"main.button.save" | translate}}</md-button> <md-button class="md-raised" ng-if="baseModule.id && baseModule.curriculums.length == 0" ng-click="delete()">{{\'main.button.delete\' | translate}}</md-button> <md-button class="md-raised" ng-click="back(\'#/basemodule\', baseModuleForm)">{{"main.button.back" | translate}}</md-button> </form> </div> <style>.link-no-underline {\r\n        text-decoration: none;\r\n    }\r\n\r\n    .link-disabled {\r\n        color: #d7dde5;\r\n    }</style>'),a.put("baseModule/basemodule.list.html",'<div class="ois-form-layout-padding"> <div flex> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <form name="searchForm" ng-submit="searchForm.$valid && loadData()" class="nomargin" layout="column" ng-model-options="{allowInvalid: true}"> <div layout-gt-sm="row" layout="column"> <md-input-container flex-gt-sm="45" flex="100" class="flex-end"> <label class="textInput">{{\'basemodule.search.name\' | translate}}</label> <input ng-model="criteria.name" type="text" md-maxlength="255" autofocus> </md-input-container> <div layout="column" flex="50" flex-offset-gt-sm="5"> <label class="common-label">{{\'main.validityPeriod\' | translate}}</label> <div layout="row"> <md-input-container> <label>{{\'main.from\' | translate}}</label> <md-datepicker ng-model="criteria.validFrom" md-max-date="criteria.validThru" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> <md-input-container> <label>{{\'main.thru\' | translate}}</label> <md-datepicker ng-model="criteria.validThru" md-min-date="criteria.validFrom" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> </div> </div> </div> <div layout-gt-sm="row" layout="column"> <md-autocomplete name="curriculum" md-selected-item="criteria.curriculum" md-search-text="queryC" md-items="curriculum in searchCurriculums(queryC)" md-item-text="currentLanguageNameField(curriculum)" md-min-length="3" md-floating-label="{{\'basemodule.search.curriculum\' | translate}}" md-no-cache class="small-margin" flex="100" flex-gt-sm="45"> <md-item-template> <span md-highlight-text="queryC" md-highlight-flags="^i">{{currentLanguageNameField(curriculum)}}</span> </md-item-template> <md-not-found> {{\'main.messages.error.notFound\' | translate}} </md-not-found> </md-autocomplete> <md-autocomplete name="curriculumVersion" md-selected-item="criteria.curriculumVersion" md-search-text="queryCV" md-items="curriculumVersion in searchCurriculumVersions(queryCV)" md-item-text="currentLanguageNameField(curriculumVersion)" md-min-length="3" md-floating-label="{{\'basemodule.search.curriculumVersion\' | translate}}" md-no-cache class="small-margin" flex="50" flex-sm="100" flex-xs="100" flex-offset="0" flex-offset-gt-sm="5"> <md-item-template> <span md-highlight-text="queryCV" md-highlight-flags="^i">{{currentLanguageNameField(curriculumVersion)}}</span> </md-item-template> <md-not-found> {{\'main.messages.error.notFound\' | translate}} </md-not-found> </md-autocomplete> </div> <div layout="row"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearFields()">{{\'main.button.clear\' | translate}}</md-button> <md-button ng-href="#/basemodule/new" ng-if="formState.canCreate" class="md-raised">{{\'main.button.create\' | translate}}</md-button> </div> <div flex-xs="0" flex-gt-xs="0" flex-gt-sm="50"></div> </form> </fieldset> </div> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column style="width:35%" md-order-by="b.{{currentLanguageNameField()}}">{{\'basemodule.label\' | translate}}</th> <th md-column style="width:25%">{{\'basemodule.search.curriculum\' | translate}}</th> <th md-column style="width:25%">{{\'basemodule.search.curriculumVersion\' | translate}}</th> <th md-column style="width:5%">{{\'basemodule.ekap\' | translate}}</th> <th md-column style="width:10%"></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell><a ng-href="#/basemodule/{{::row.id}}/view">{{currentLanguageNameField(row)}}</a></td> <td md-cell ng-init="row.c = row.curriculums.join(\', \')"> {{row.c | hoisLimitTo: 20:!row.showC}} <span class="custom-tooltip" ng-if="!row.showC && row.c.length > 20" ng-click="row.showC = true">{{\'basemodule.search.showMore\' | translate}}</span> <span class="custom-tooltip" ng-if="row.showC" ng-click="row.showC = false">{{\'basemodule.search.showLess\' | translate}}</span> </td> <td md-cell ng-init="row.cv = row.curriculumVersions.join(\', \')"> {{row.cv | hoisLimitTo: 20:!row.showCV}} <span class="custom-tooltip" ng-if="!row.showCV && row.cv.length > 20" ng-click="row.showCV = true">{{\'basemodule.search.showMore\' | translate}}</span> <span class="custom-tooltip" ng-if="row.showCV" ng-click="row.showCV = false">{{\'basemodule.search.showLess\' | translate}}</span> </td> <td md-cell>{{row.credits}}</td> <td md-cell> <md-button md-no-ink ng-if="row.canEdit" class="md-primary change-button" ng-href="#/basemodule/{{::row.id}}/edit"> {{\'main.button.change\' | translate}} </md-button> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> </div> <style>@media screen and (min-width: 960px) {\r\n        .flex-end {\r\n            align-self: flex-end;\r\n        }\r\n    }</style>'),
a.put("baseModule/basemodule.view.html",'<div class="ois-form-layout-padding nomargin"> <form ng-cloak name="baseModuleForm"> <div layout="column" ng-cloak> <div layout="row" flex> <md-input-container flex="90" flex-sm="75" flex-xs="75"> <label>{{\'basemodule.nameEt\' | translate}}</label> <input ng-model="baseModule.nameEt" name="nameEt" type="text" disabled> </md-input-container> <md-input-container flex="10" flex-sm="20" flex-xs="20" flex-offset="5"> <label>{{\'basemodule.ekap\' | translate}}</label> <input ng-model="baseModule.credits" type="number" name="credits" disabled> </md-input-container> </div> <md-input-container flex> <label>{{\'basemodule.nameEn\' | translate}}</label> <input ng-model="baseModule.nameEn" name="nameEn" type="text" disabled> </md-input-container> <md-input-container flex> <label>{{\'basemodule.objectivesEt\' | translate}}</label> <textarea ng-model="baseModule.objectivesEt" name="objectivesEt" max-rows="10" disabled></textarea> </md-input-container> <md-input-container flex> <label>{{\'basemodule.objectivesEn\' | translate}}</label> <textarea ng-model="baseModule.objectivesEn" name="objectivesEn" max-rows="10" disabled></textarea> </md-input-container> <div flex> <fieldset tabindex="0"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'basemodule.studyOutcome\' | translate}}</legend> <div layout="column"> <div ng-repeat="item in baseModule.outcomes track by $index" class="occupation-row align-center" layout="row" flex> <div flex="45"> <p class="scrollable">{{item.outcomeEt}}</p> </div> <div flex="40" flex-offset="5"> <p class="scrollable">{{item.outcomeEn}}</p> </div> </div> </div> </fieldset> </div> <div>&nbsp;</div> <md-input-container flex> <label>{{\'stateCurriculum.enter.module.criteriaEt\' | translate}}</label> <textarea ng-model="baseModule.assessmentsEt" name="assessmentsEt" max-rows="10" disabled></textarea> </md-input-container> <md-input-container flex> <label>{{\'stateCurriculum.enter.module.criteriaEn\' | translate}}</label> <textarea ng-model="baseModule.assessmentsEn" name="assessmentsEn" max-rows="10" disabled></textarea> </md-input-container> <div flex> <fieldset tabindex="1"> <legend md-colors="{color: \'default-primary-800\'}" class="md-title-small">{{\'basemodule.capacityDistribution\' | translate}}</legend> <div layout="row" style="padding-bottom:1em" flex class="secondary-table-header"> <div flex="30">&nbsp;</div> <div flex="30">{{\'basemodule.capacity\' | translate}}</div> <div flex="40" layout="row">{{\'basemodule.contactStudy\' | translate}}</div> </div> <div ng-repeat="item in baseModule.capacities | orderBy: \'nameEt\' track by item.capacityType" layout="row" class="secondary-table-row"> <div flex="30" class="occupation-module-capacity">{{currentLanguageNameField(item)}}</div> <div flex="30"> <md-input-container flex> <input ng-model="item.hours" type="number" aria-label="capacity hours" class="small-input" disabled> </md-input-container> </div> <div flex="40" layout="row"> <md-checkbox ng-model="item.contact" aria-label="capacity contact" disabled class="occupation-module-capacity-contact"></md-checkbox> </div> </div> </fieldset> </div> <div>&nbsp;</div> <md-input-container flex> <label>{{\'basemodule.requirements\' | translate}}</label> <textarea ng-model="baseModule.cvRequirementsEt" name="cvRequirementsEt" disabled max-rows="10"></textarea> </md-input-container> <md-input-container flex> <label>{{\'basemodule.assessments\' | translate}}</label> <textarea ng-model="baseModule.cvAssessmentsEt" name="cvAssessmentsEt" disabled max-rows="10"></textarea> </md-input-container> <md-input-container flex> <label>{{\'basemodule.learningMethods\' | translate}}</label> <textarea ng-model="baseModule.cvLearningMethodsEt" name="cvLearningMethodsEt" disabled max-rows="10"></textarea> </md-input-container> <md-input-container flex> <label>{{\'basemodule.assessmentMethodsAndTasks\' | translate}}</label> <textarea ng-model="baseModule.cvAssessmentMethodsEt" name="cvAssessmentMethodsEt" disabled max-rows="10"></textarea> </md-input-container> <md-input-container flex> <label>{{\'basemodule.independentStudyDescription\' | translate}}</label> <textarea ng-model="baseModule.cvIndependentStudyEt" name="cvIndependentStudyEt" disabled max-rows="2"></textarea> </md-input-container> <md-input-container flex> <label>{{\'basemodule.studyMaterials\' | translate}}</label> <textarea ng-model="baseModule.cvStudyMaterials" name="cvStudyMaterials" disabled max-rows="2"></textarea> </md-input-container> <div flex> <fieldset tabindex="2"> <legend md-colors="{color: \'default-primary-800\'}" class="md-title-small">{{\'basemodule.gradeFormation\' | translate}}</legend> <div flex layout="row"> <span flex="30" class="common-label">{{\'basemodule.assessmentType\' | translate}}</span> <hois-classifier-radio layout="row" ng-model="baseModule.cvAssessment" name="cvAssessment" model-value-attr="code" main-classifier-code="KUTSEHINDAMISVIIS" disabled class="md-primary"></hois-classifier-radio> </div> <div>&nbsp;</div> <md-input-container flex style="width: 100%"> <label>{{\'basemodule.totalGradeDescription\' | translate}}</label> <textarea ng-model="baseModule.cvTotalGradeDescription" name="cvTotalGradeDescription" max-rows="2" disabled></textarea> </md-input-container> <div>&nbsp;</div> <div ng-show="baseModule.cvAssessment === \'KUTSEHINDAMISVIIS_E\'" layout="column"> <md-input-container flex> <label>{{\'basemodule.grade3Description\' | translate}}</label> <textarea ng-model="baseModule.cvGrade3Description" name="cvGrade3Description" max-rows="2" disabled></textarea> </md-input-container> <md-input-container flex> <label>{{\'basemodule.grade4Description\' | translate}}</label> <textarea ng-model="baseModule.cvGrade4Description" name="cvGrade4Description" max-rows="2" disabled></textarea> </md-input-container> <md-input-container flex> <label>{{\'basemodule.grade5Description\' | translate}}</label> <textarea ng-model="baseModule.cvGrade5Description" name="cvGrade5Description" max-rows="2" disabled></textarea> </md-input-container> </div> <div ng-show="baseModule.cvAssessment === \'KUTSEHINDAMISVIIS_M\'" layout="column" flex> <md-input-container flex> <label>{{\'basemodule.gradeADescription\' | translate}}</label> <textarea ng-model="baseModule.cvPassDescription" name="cvPassDescription" max-rows="10" disabled></textarea> </md-input-container> </div> </fieldset> </div> <div>&nbsp;</div> <div flex> <fieldset tabindex="3"> <legend md-colors="{color: \'default-primary-800\'}" class="md-title-small">{{\'basemodule.themes\' | translate}}</legend> <div layout="column"> <md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'basemodule.themeName\' | translate}}</th> <th md-column>{{\'basemodule.capacityEkapPerHour\' | translate}}</th> <th md-column>{{\'basemodule.subthemes\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="theme in baseModule.themes | orderBy: currentLanguageNameField()"> <td md-cell> <a class="md-primary one-row" ng-click="viewTheme(theme)">{{currentLanguageNameField(theme)}}</a> </td> <td md-cell>{{theme.credits}}/{{theme.hours}}</td> <td md-cell><p class="scrollable">{{theme.subthemes}}</p></td> </tr> </tbody> </table> </md-table-container> </div> </fieldset> </div> <div>&nbsp;</div> <md-input-container flex> <label>{{\'basemodule.supervisor\' | translate}}</label> <input ng-value="currentLanguageNameField(baseModule.teacher)" type="text" disabled> </md-input-container> <div flex> <fieldset tabindex="4"> <legend md-colors="{color: \'default-primary-800\'}" class="md-title-small">{{\'basemodule.validity\' | translate}}</legend> <div layout="row"> <md-input-container flex="50" flex-sm="100" flex-xs="100"> <label>{{\'main.validFrom\' | translate}}</label> <md-datepicker name="validFrom" ng-model="baseModule.validFrom" disabled md-max-date="baseModule.validThru" required md-open-on-focus></md-datepicker> </md-input-container> <md-input-container flex="50" flex-sm="100" flex-xs="100"> <label>{{\'main.validTo\' | translate}}</label> <md-datepicker name="validThru" ng-model="baseModule.validThru" disabled md-min-date="baseModule.validFrom" md-open-on-focus></md-datepicker> </md-input-container> </div> </fieldset> </div> <div>&nbsp;</div> <div flex ng-if="baseModule.curriculums.length > 0"> <fieldset tabindex="5"> <legend md-colors="{color: \'default-primary-800\'}" class="md-title-small">{{\'basemodule.connectedCurriculumsAndCurriculumVersions\' | translate}}</legend> <div layout="column"> <md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column style="width: 50%"> {{\'basemodule.curriculum\' | translate}} </th> <th md-column> {{\'basemodule.curriculumVersion\' | translate}} </th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="curriculum in baseModule.curriculums"> <td md-cell> <p><a href="#/vocationalCurriculum/{{curriculum.id}}/view">{{currentLanguageNameField(curriculum)}}</a></p> </td> <td md-cell> <p ng-repeat="cv in baseModule.curriculumVersions[curriculum.id]"><a href="#/vocationalCurriculum/{{curriculum.id}}/moduleImplementationPlan/{{cv.id}}/view">{{currentLanguageNameField(cv)}}</a><br ng-if="!$first"></p> </td> </tr> </tbody> </table> </md-table-container> </div> </fieldset> </div> </div> <div>&nbsp;</div> <md-button class="md-raised md-primary" ng-if="canEdit" ng-click="edit()">{{"main.button.edit" | translate}}</md-button> <md-button class="md-raised" ng-click="back(\'#/basemodule\')">{{"main.button.back" | translate}}</md-button> </form> </div> <style>.link-no-underline {\r\n        text-decoration: none;\r\n    }\r\n\r\n    .link-disabled {\r\n        color: #d7dde5;\r\n    }</style>'),a.put("boardingSchool/boarding.school.check.dialog.html",'<md-dialog aria-label="boarding school management check dialog" flex="50" flex-sm="50" flex-xs="100"> <form name="dialogForm" novalidate ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2>{{\'boardingSchool.error.problematicRows\' | translate}}</h2> <span flex></span> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <div layout-padding> <div ng-repeat="row in content"> <div class="md-title-small" flex layout="row" layout-align="space-between none"> <div md-colors="{color: \'warn\'}" layout layout-align="left center"> <md-icon md-colors="{color: \'warn\'}" md-font-set="material-icons">info_outline</md-icon> <span>&nbsp;&nbsp;</span> <span>{{row.fullname}}, {{row.idcode}} - {{currentLanguageNameField(row.roomObject)}} {{row.validFrom | hoisDate}} - {{row.validThru | hoisDate}}</span> </div> <div layout layout-align="right center"> <span ng-if="row.duplicateStudents" md-colors="{color: \'default-red\'}">{{\'boardingSchool.error.duplicateStudents\' | translate}}</span> </div> </div> <md-table-container> <table md-table md-progress="tabledata.$promise" class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'student.name\' | translate}}</th> <th md-column>{{\'student.idcode\' | translate}}</th> <th md-column>{{\'main.validFrom\' | translate}}</th> <th md-column>{{\'main.validThru\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="resident in row.residents | orderBy: [\'validFrom\', \'validThru\']" ng-class-odd="\'odd\'" ng-class-even="\'even\'" ng-class="{\'student-row\': row.student === resident.student && row.dormitory === resident.dormitory}"> <td md-cell>{{resident.fullname}}</td> <td md-cell>{{resident.idcode}}</td> <td md-cell>{{resident.validFrom | hoisDate}}</td> <td md-cell>{{resident.validThru | hoisDate}}</td> </tr> </tbody> </table> </md-table-container> <div ng-if="!$last">&nbsp;</div> </div> </div> </md-dialog-content> <span flex></span> <md-dialog-actions layout="row" layout-align="start center"> <md-button class="md-raised md-primary" ng-click="save()">{{\'main.button.save\' | translate}}</md-button> <md-button class="md-raised" ng-click="cancel()">{{\'main.button.close\' | translate}}</md-button> </md-dialog-actions> </form> </md-dialog> <style>.student-row {\r\n      color: rgb(255, 87, 34) !important;\r\n      font-style: italic;\r\n    }\r\n\r\n    .student-row td {\r\n      color: rgb(255, 87, 34) !important;\r\n    }</style>'),a.put("boardingSchool/boarding.school.management.html",'<div ng-include="\'boardingSchool/boarding.school.navbar.tmpl.html\'"></div> <div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <form name="searchForm" ng-submit="searchForm.$valid && loadData()" novalidate ng-model-options="{ allowInvalid: true }"> <fieldset tabindex="1"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <div layout="row" layout-sm="column" layout-xs="column"> <hois-autocomplete flex="45" flex-sm="100" flex-xs="100" ng-model="criteria.studentGroup" ha-controller="directiveControllers" method="studentgroups" name="studentGroup" label="{{\'student.studentGroup\'}}"></hois-autocomplete> <md-input-container flex="50" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label class="textInput">{{\'student.name\' | translate}}</label> <input ng-model="criteria.name" name="name" type="text" md-maxlength="255" autofocus> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'student.idcode\' | translate}}</label> <input ng-model="criteria.idcode" name="idcode" type="text" minlength="11" md-maxlength="11"> </md-input-container> <md-input-container flex="50" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'boardingSchool.dormitory\' | translate}}</label> <hois-classifier-select multiple ng-model="criteria.dormitory" main-classifier-code="YHISELAMU" model-value-attr="code"></hois-classifier-select> </md-input-container> </div> <div layout="row" flex> <md-input-container class="md-block"> <md-checkbox ng-model="criteria.notActiveStudents" name="notActiveStudents">{{\'boardingSchool.showNotActiveStudents\' | translate}}</md-checkbox> </md-input-container> </div> <div layout="row"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> </div> </fieldset> </form> </div> </div> <div layout-padding> <div flex> <md-table-container fixed-column-table fixed-columns="2" resize-table search-criteria-height="550" class="fixed-md-table-container"> <form name="boardingSchools" novalidate> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="p.lastname, p.firstname">{{\'student.name\' | translate}}</th> <th md-column md-order-by="sg.code">{{\'student.studentGroup\' | translate}}</th> <th md-column md-order-by="p.idcode">{{\'student.idcode\' | translate}}</th> <th md-column>{{\'boardingSchool.room\' | translate}}</th> <th md-column>{{\'main.validFrom\' | translate}}</th> <th md-column>{{\'main.validThru\' | translate}}</th> <th md-column style="min-width: 250px">{{\'boardingSchool.addInfo\' | translate}}</th> <th md-column></th> <th md-column>{{\'boardingSchool.dormitory\' | translate}}</th> <th md-column style="min-width: 250px">{{\'boardingSchool.previousPlaces\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell class="fixed-cell"><a ng-href="#/students/{{::row.student}}/main">{{::row.fullname}}</a></td> <td md-cell class="fixed-cell">{{currentLanguageNameField(row.studentGroup)}}</td> <td md-cell>{{row.idcode}}</td> <td md-cell> <md-input-container> <hois-select ng-model="row.latestDorm.room" values="rooms" ng-change="roomChanged(row)" ng-disabled="!row.canEditLatest" aria-label="{{\'boardingSchool.room\' | translate}}"></hois-select> </md-input-container> </td> <td md-cell> <md-input-container> <md-datepicker ng-model="row.latestDorm.validFrom" md-max-date="row.latestDorm.validThru" ng-disabled="!row.canEditLatest || !row.latestDorm.room" ng-required="row.latestDorm.room" aria-label="{{\'main.validFrom\' | translate}}"></md-datepicker> </md-input-container> </td> <td md-cell> <md-input-container> <md-datepicker ng-model="row.latestDorm.validThru" md-min-date="row.latestDorm.validFrom" ng-disabled="!row.canEditLatest || !row.latestDorm.room" ng-required="row.latestDorm.room" aria-label="{{\'main.validFrom\' | translate}}"></md-datepicker> </md-input-container> </td> <td md-cell> <md-input-container style="width:100%"> <textarea ng-model="row.latestDorm.addInfo" md-maxlength="4000" max-rows="3" ng-disabled="!row.canEditLatest || !row.latestDorm.room" aria-label="{{\'boardingSchool.addInfo\' | translate}}"></textarea> </md-input-container> </td> <td md-cell> <md-button ng-if="row.canAddNew && row.latestDormCopy && !row.addedToPrevious" md-no-ink class="md-primary change-button" ng-click="addNew(row)"> {{\'boardingSchool.addNew\' | translate}}</md-button> <md-button ng-if="row.addedToPrevious" class="md-icon-button" ng-click="restorePreviousDorm(row)"> <md-icon class="remove" md-font-set="material-icons">close</md-icon> </md-button> </td> <td md-cell> <md-input-container> <hois-classifier-select ng-model="row.dormitory" name="dormitory" hide-empty only-valid model-value-attr="code" main-classifier-code="YHISELAMU" aria-label="{{\'boardingSchool.dormitory\' | translate}}" ng-disabled="!row.canEditLatest"></hois-classifier-select> </md-input-container> </td> <td md-cell> <li ng-repeat="dorm in row.previousDorms"> {{dorm.validFrom | hoisDate}} - {{dorm.validThru | hoisDate}} {{currentLanguageNameField(dorm.roomObject)}} </li> </td> <td md-cell> <md-button ng-if="row.canAddNew && row.previousDorms.length > 0" md-no-ink class="md-primary change-button" ng-click="previousDormsDialog(row)">{{\'boardingSchool.changePrevious\' | translate}}</md-button> </td> </tr> </tbody> </table> </form> </md-table-container> <md-table-toolbar class="md-default"> <div class="md-toolbar-tools"> <md-button ng-click="save()" class="md-primary md-raised">{{\'main.button.save\' | translate}}</md-button> </div> </md-table-toolbar> <md-table-pagination md-limit="criteria.size" md-limit-options="[20, 50, 100]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="changePage" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> </div> <style>td md-input-container input {\r\n      height: 24px !important;\r\n      padding-top: 2px !important;\r\n    }\r\n  \r\n    td md-input-container md-select {\r\n      height: 24px !important;\r\n      padding-top: 2px !important;\r\n    }\r\n\r\n    td md-input-container md-select md-select-value {\r\n      min-height: 20px !important;\r\n    }\r\n  \r\n    td md-input-container textarea {\r\n      min-height: 24px !important;\r\n      padding-top: 2px !important;\r\n    }</style>'),a.put("boardingSchool/boarding.school.navbar.tmpl.html",'<md-nav-bar md-selected-nav-item="currentNavItem" aria-label="{{\'main.nagivationBar\' | translate}}"> <md-nav-item md-nav-href="#/boardingSchools?_menu" name="boarding.school.search" aria-label="{{\'student.card.search\' | translate}}">{{\'boardingSchool.search\' | translate}}</md-nav-item> <md-nav-item md-nav-href="#/boardingSchools/management?_menu" ng-if="isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_OPILASKODU\')" name="boarding.school.management" aria-label="{{\'student.card.management\' | translate}}">{{\'boardingSchool.management\' | translate}}</md-nav-item> <md-nav-item md-nav-href="#/boardingSchools/rooms?_menu" name="boarding.school.rooms" aria-label="{{\'student.card.management\' | translate}}">{{\'boardingSchool.rooms\' | translate}}</md-nav-item> </md-nav-bar>'),a.put("boardingSchool/boarding.school.previous.places.dialog.html",'<md-dialog aria-label="previous boarding school dialog" flex="50" flex-sm="50" flex-xs="100"> <form name="dialogForm" novalidate ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2>{{::student.fullname}} {{\'boardingSchool.previousBoardingSchools\' | translate}}</h2> <span flex></span> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <div layout-padding> <md-table-container> <table md-table md-progress="tabledata.$promise" class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'main.validFrom\' | translate}}</th> <th md-column>{{\'main.validThru\' | translate}}</th> <th md-column>{{\'boardingSchool.room\' | translate}}</th> <th md-column style="min-width: 250px">{{\'boardingSchool.addInfo\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in student.previousDorms" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{row.validFrom | hoisDate}}</td> <td md-cell>{{row.validThru | hoisDate}}</td> <td md-cell>{{currentLanguageNameField(row.roomObject)}}</td> <td md-cell> <hois-value value="row.addInfo"></hois-value> </td> <td md-cell> <a class="remove nomargin" ng-click="removePreviousDorm(row)">&times;</a> </td> </tr> </tbody> </table> </md-table-container> </div> </md-dialog-content> <span flex></span> <md-dialog-actions layout="row" layout-align="start center"> <md-button class="md-raised" ng-click="cancel()">{{"main.button.close" | translate}}</md-button> </md-dialog-actions> </form> </md-dialog>'),a.put("boardingSchool/boarding.school.rooms.html",'<div ng-include="\'boardingSchool/boarding.school.navbar.tmpl.html\'"></div> <div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <form name="searchForm" ng-submit="searchForm.$valid && loadData()" novalidate ng-model-options="{ allowInvalid: true }"> <fieldset tabindex="1"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container class="md-block" flex="45" flex-sm="100" flex-xs="100"> <label>{{\'boardingSchool.building\' | translate}}</label> <hois-select ng-model="criteria.building" name="building" type="building" criteria="{isDormitory: true}"></hois-select> </md-input-container> <hois-autocomplete flex="50" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0" ng-model="criteria.room" ha-controller="directiveControllers" method="rooms" name="room" label="{{\'boardingSchool.room\'}}" additional-query-params="{buildingIds: criteria.building ? [criteria.building] : [], isDormitory: true}"></hois-autocomplete> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container> <label>{{\'main.from\' | translate}}</label> <md-datepicker ng-model="criteria.from" md-max-date="criteria.thru" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> <md-input-container flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'main.thru\' | translate}}</label> <md-datepicker ng-model="criteria.thru" md-min-date="criteria.from" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> </div> <div layout="row" flex> <md-input-container class="md-block" flex="15" flex-md="30" flex-sm="100" flex-xs="100"> <md-checkbox ng-model="criteria.showValid" name="showValid">{{\'boardingSchool.showValid\' | translate}}</md-checkbox> </md-input-container> <md-input-container class="md-block" flex="15" flex-md="30" flex-sm="100" flex-xs="100"> <md-checkbox ng-model="criteria.showFreeRooms" name="showFreeRooms">{{\'boardingSchool.showFreeRooms\' | translate}}</md-checkbox> </md-input-container> <md-input-container class="md-block" flex="15" flex-md="30" flex-sm="100" flex-xs="100"> <md-checkbox ng-model="criteria.showResidents" name="showNeighbours">{{\'boardingSchool.showResidents\' | translate}}</md-checkbox> </md-input-container> </div> <div layout="row"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> </div> </fieldset> </form> </div> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="b_name">{{\'boardingSchool.building\' | translate}}</th> <th md-column md-order-by="b_code, r_code">{{\'boardingSchool.room\' | translate}}</th> <th md-column md-order-by="seats">{{\'boardingSchool.seats\' | translate}}</th> <th md-column md-order-by="free_seats">{{\'boardingSchool.freeSeats\' | translate}}</th> <th md-column ng-if="showResidents">{{\'boardingSchool.residents\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'" ng-class="{vacant: row.occupied === false, occupied: row.occupied === true}"> <td md-cell>{{currentLanguageNameField(row.building)}}</td> <td md-cell>{{currentLanguageNameField(row.room)}}</td> <td md-cell>{{row.room.seats}}</td> <td md-cell>{{row.freeSeats}}</td> <td md-cell ng-if="showResidents"> <li ng-repeat="resident in row.residents | orderBy: [\'validFrom\', \'validThru\']"> <span>{{resident.fullname}}<span ng-if="resident.idcode">, </span>{{resident.idcode}}</span> <md-tooltip>{{resident.validFrom | hoisDate}} - {{resident.validThru | hoisDate}}</md-tooltip> </li> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> </div> <style>.vacant {\r\n    background: #a4dba7;\r\n  }\r\n\r\n  .occupied {\r\n    background: #dd9d9d;\r\n  }</style>'),a.put("boardingSchool/boarding.school.search.html",'<div ng-include="\'boardingSchool/boarding.school.navbar.tmpl.html\'"></div> <div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <form name="searchForm" ng-submit="searchForm.$valid && loadData()" novalidate ng-model-options="{ allowInvalid: true }"> <fieldset tabindex="1"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <div layout="row" layout-sm="column" layout-xs="column"> <hois-autocomplete flex="45" flex-sm="100" flex-xs="100" ng-model="criteria.studentGroup" ha-controller="directiveControllers" method="studentgroups" name="studentGroup" label="{{\'student.studentGroup\'}}"></hois-autocomplete> <md-input-container flex="50" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label class="textInput">{{\'student.name\' | translate}}</label> <input ng-model="criteria.name" name="name" type="text" md-maxlength="255" autofocus> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'student.idcode\' | translate}}</label> <input ng-model="criteria.idcode" name="idcode" type="text" minlength="11" md-maxlength="11"> </md-input-container> <hois-autocomplete flex="50" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0" ng-model="criteria.room" ha-controller="directiveControllers" method="rooms" name="room" label="{{\'boardingSchool.room\'}}" additional-query-params="{isDormitory: true}"></hois-autocomplete> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container> <label>{{\'main.validFrom\' | translate}}</label> <md-datepicker ng-model="criteria.validFrom" md-max-date="criteria.validThru" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> <md-input-container flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'main.validThru\' | translate}}</label> <md-datepicker ng-model="criteria.validThru" md-min-date="criteria.validFrom" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> </div> <div layout="row" flex> <md-input-container class="md-block" flex="15" flex-md="30" flex-sm="100" flex-xs="100"> <md-checkbox ng-model="criteria.showValid" name="showValid">{{\'boardingSchool.showValid\' | translate}}</md-checkbox> </md-input-container> <md-input-container class="md-block" flex="15" flex-md="30" flex-sm="100" flex-xs="100"> <md-checkbox ng-model="criteria.showNeighbours" name="showNeighbours">{{\'boardingSchool.showNeighbours\' | translate}}</md-checkbox> </md-input-container> </div> <div layout="row"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> <md-button class="md-raised" ng-href="{{excel(formState.xlsUrl, criteria)}}" target="_blank">{{\'main.button.printXls\' | translate}}</md-button> </div> </fieldset> </form> </div> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="p.lastname, p.firstname">{{\'student.name\' | translate}}</th> <th md-column md-order-by="sg.code">{{\'student.studentGroup\' | translate}}</th> <th md-column md-order-by="p.idcode">{{\'student.idcode\' | translate}}</th> <th md-column md-order-by="d.valid_from">{{\'main.validFrom\' | translate}}</th> <th md-column md-order-by="d.valid_thru">{{\'main.validThru\' | translate}}</th> <th md-column md-order-by="b.code, r.code">{{\'boardingSchool.room\' | translate}}</th> <th md-column ng-if="showNeighbours">{{\'boardingSchool.neighbours\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell><a ng-href="#/students/{{::row.student}}/main">{{::row.fullname}}</a></td> <td md-cell>{{currentLanguageNameField(row.studentGroup)}}</td> <td md-cell>{{row.idcode}}</td> <td md-cell>{{row.validFrom | hoisDate}}</td> <td md-cell>{{row.validThru | hoisDate}}</td> <td md-cell>{{currentLanguageNameField(row.room)}}</td> <td md-cell ng-if="showNeighbours"> <li ng-repeat="neighbour in row.neighbours | orderBy: [\'validFrom\', \'validThru\']"> <span>{{neighbour.fullname}}<span ng-if="neighbour.idcode">, </span>{{neighbour.idcode}}</span> <md-tooltip>{{neighbour.validFrom | hoisDate}} - {{neighbour.validThru | hoisDate}}</md-tooltip> </li> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> </div>'),a.put("building/building.edit.html",'<div layout="column" layout-padding> <div flex> <form name="buildingForm"> <md-input-container class="md-block"> <label>{{\'building.name\' | translate}}</label> <input ng-model="record.name" name="name" type="text" md-maxlength="255" required> <div ng-messages="buildingForm.name.$error"> <div ng-message="md-maxlength"> {{\'main.messages.error.maxlength\' | translate}} </div> </div> </md-input-container> <md-input-container class="md-block"> <label class="textInput">{{\'building.code\' | translate}}</label> <input ng-model="record.code" name="code" type="text" md-maxlength="20" ng-model-options="{debounce: 250}" unique="buildingUniqueQuery" required> <div ng-messages="buildingForm.code.$error"> <div ng-message="md-maxlength"> {{\'main.messages.error.maxlength\' | translate}} </div> <div ng-message="notUnique"> {{\'building.alreadyexist\' | translate}} </div> </div> </md-input-container> <md-div class="md-block"> <hois-ads-adapter class="md-text" ng-model="record.addressAds" ads-oid-model="record.addressAdsOid" address-model="record.address"></hois-ads-adapter> </md-div> <div>&nbsp;</div> <md-input-container flex> <md-checkbox ng-model="record.isDormitory" aria-label="{{\'building.boardingSchool\' | translate}}">{{\'building.boardingSchool\' | translate}}</md-checkbox> </md-input-container> </form> <md-button ng-click="update()" class="md-raised md-primary">{{\'main.button.save\' | translate}}</md-button> <md-button ng-click="delete()" ng-show="record.id" class="md-raised">{{\'main.button.delete\' | translate}}</md-button> <md-button ng-click="back(\'#/rooms/search\', buildingForm)" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </div> </div>'),
a.put("certificate/certificate.edit.html",'<div layout="column" layout-padding> <form name="certificateEditForm"> <div layout="column"> <md-input-container> <label>{{\'certificate.type\' | translate}}</label> <hois-classifier-select ng-model="record.type" model-value-attr="code" main-classifier-code="TOEND_LIIK" required ng-disabled="record.id" filter-values="forbiddenTypes" only-valid ignore-preselected criteria="{higher: auth.school.higher ? true : undefined, vocational: auth.school.vocational ? true : undefined}"></hois-classifier-select> </md-input-container> <md-input-container ng-if="record.id && auth.school.withoutEkis"> <label>{{\'certificate.nr\' | translate}}{{ certificateEditForm.certificateNr.$error.required ? \' *\' : \'\'}}</label> <input type="text" ng-model="record.certificateNr" md-maxlength="20" name="certificateNr" ng-change="changedCertificateNr()"> </md-input-container> <div ng-show="!isOtherCertificate()"> <md-autocomplete md-input-minlength="2" name="student" md-selected-item="student" md-search-text="queryText" md-items="item in querySearch(queryText)" md-item-text="currentLanguageNameField(item)" md-floating-label="{{\'certificate.student\' | translate}}" ng-model="queryText" md-no-cache class="small-margin" md-selected-item-change="studentChanged()" ng-required="!isOtherCertificate()" ng-disabled="record.id"> <md-item-template> <span md-highlight-text="queryText" md-highlight-flags="^i">{{currentLanguageNameField(item)}}</span> </md-item-template> <md-not-found> {{\'main.messages.error.notFound\' | translate}} </md-not-found> </md-autocomplete> </div> <div ng-if="isOtherCertificate()"> <md-input-container class="md-block"> <label>{{\'certificate.otherIdcode\' | translate}}</label> <input type="text" ng-model="record.otherIdcode" name="idcode" required ng-pattern="idcodePattern" md-maxlength="11" ng-disabled="record.id"> <div ng-messages="certificateEditForm.idcode.$error" ng-show="certificateEditForm.idcode.$dirty"> <div ng-message="pattern"> {{\'certificate.invalidIdcode\' | translate}} </div> </div> </md-input-container> <md-input-container class="md-block"> <label>{{\'certificate.otherName\' | translate}}</label> <input type="text" ng-model="record.otherName" required md-maxlength="100" ng-disabled="record.id"> </md-input-container> </div> <md-input-container> <label>{{\'certificate.headline\' | translate}}</label> <textarea ng-model="record.headline" required md-maxlength="1000" max-rows="2"></textarea> </md-input-container> <md-input-container> <label>{{\'certificate.whom\' | translate}}</label> <input type="text" ng-model="record.whom" md-maxlength="1000" ng-disabled="record.id && !auth.school.withoutEkis"> </md-input-container> <md-input-container> <label>{{\'certificate.signatory\' | translate}}</label> <md-select ng-model="record.signatoryIdcode" aria-label="{{\'certificate.signatory\' | translate}}" required> <md-option ng-value="signatory.idcode" ng-repeat="signatory in signatories"> {{::signatory.name}} </md-option> </md-select> </md-input-container> <md-input-container ng-if="record.type === \'TOEND_LIIK_SOOR\' && !record.id"> <md-checkbox ng-model="record.addOutcomes" ng-change="addOutcomesChanged()">{{\'certificate.addOutcomes\' | translate}}</md-checkbox> </md-input-container> <md-input-container ng-if="contentEditable()"> <label>{{\'certificate.content\' | translate}}</label> <textarea ng-model="record.content" required md-maxlength="2000" max-rows="2"></textarea> </md-input-container> <br> <div ng-if="!contentEditable()"> <label class="common-label" ng-show="record.content">{{\'certificate.content\' | translate}}</label> <md-table-container> <div id="content" class="md-body-1"></div> </md-table-container> </div> </div> <div layout="row"> <md-button class="md-raised md-primary" ng-if="!record.id || record.canBeChanged" ng-click="save()">{{\'main.button.save\' | translate}}</md-button> <md-button class="md-raised md-default" ng-if="(!record.id || record.canBeChanged) && !auth.school.withoutEkis" ng-click="saveAndOrder()">{{\'certificate.saveAndOrder\' | translate}}</md-button> <md-button class="md-raised md-default" ng-if="record.id && record.canBeChanged && auth.school.withoutEkis && auth.isAdmin()" ng-click="complete()">{{\'main.button.complete\' | translate}}</md-button> <md-button class="md-raised md-default" ng-if="record.id && auth.school.withoutEkis && auth.isAdmin()" ng-href="{{printUrl()}}" target="_blank">{{\'main.button.print\' | translate}}</md-button> <md-button class="md-raised md-default" ng-click="delete()" ng-if="record.id && record.canBeChanged">{{\'main.button.delete\' | translate}}</md-button> <md-button class="md-raised md-default" ng-click="back(\'#/certificate\', certificateEditForm)">{{\'main.button.back\' | translate}}</md-button> </div> </form> </div>'),a.put("certificate/certificate.search.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <form name="searchForm" ng-submit="searchForm.$valid && loadData()" novalidate ng-model-options="{allowInvalid: true}"> <fieldset ng-if="!auth.isStudent() && !auth.isParent()"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <div layout="column"> <div layout-gt-sm="row" layout="column"> <md-input-container flex-gt-sm="45" flex="100"> <label>{{\'certificate.type\' | translate}}</label> <hois-classifier-select ng-model="criteria.type" model-value-attr="code" main-classifier-code="TOEND_LIIK" multiple></hois-classifier-select> </md-input-container> <md-input-container flex-gt-sm="50" flex-offset-gt-sm="5" flex="100" flex-offset="0"> <label class="textInput">{{\'certificate.headline\' | translate}}</label> <input ng-model="criteria.headline" type="text" md-maxlength="1000"> </md-input-container> </div> <div layout-gt-sm="row" layout="column"> <md-input-container flex-gt-sm="45" flex="100"> <label class="textInput">{{\'certificate.studentName\' | translate}}</label> <input ng-model="criteria.name" type="text" md-maxlength="255"> </md-input-container> <md-input-container flex-gt-sm="50" flex-offset-gt-sm="5" flex="100" flex-offset="0"> <label class="textInput">{{\'certificate.idcode\' | translate}}</label> <input ng-model="criteria.idcode" type="text" minlength="11" md-maxlength="11"> </md-input-container> </div> <div layout="row"> <md-input-container> <label>{{\'certificate.insertedFrom\' | translate}}</label> <md-datepicker ng-model="criteria.insertedFrom" md-max-date="criteria.insertedThru" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> <md-input-container> <label>{{\'certificate.insertedThru\' | translate}}</label> <md-datepicker ng-model="criteria.insertedThru" md-min-date="criteria.insertedFrom" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> </div> <div layout-gt-sm="row" layout="column"> <md-input-container flex-gt-sm="45" flex="100"> <label class="textInput">{{\'certificate.nr\' | translate}}</label> <input ng-model="criteria.certificateNr" type="text" md-maxlength="20"> </md-input-container> <md-input-container flex-gt-sm="50" flex-offset-gt-sm="5" flex="100" flex-offset="0"> <label>{{\'certificate.status\' | translate}}</label> <hois-classifier-select ng-model="criteria.status" model-value-attr="code" main-classifier-code="TOEND_STAATUS"></hois-classifier-select> </md-input-container> </div> <div layout="row"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> <md-button class="md-raised" ng-if="isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_TOEND\')" ng-href="#/certificate/new">{{\'certificate.add\' | translate}}</md-button> </div> </div> </fieldset> </form> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="sortablename" ng-if="!auth.isStudent() && !auth.isParent()">{{\'certificate.studentName\' | translate}}</th> <th md-column md-order-by="sg.code" ng-if="!auth.isStudent() && !auth.isParent()">{{\'certificate.studentGroup\' | translate}}</th> <th md-column md-order-by="c.certificateNr">{{\'certificate.nr\' | translate}}</th> <th md-column md-order-by="type.{{currentLanguageNameField()}}">{{\'certificate.type\' | translate}}</th> <th md-column md-order-by="status.{{currentLanguageNameField()}}">{{\'certificate.status\' | translate}}</th> <th md-column md-order-by="c.headline">{{\'certificate.headline\' | translate}}</th> <th md-column md-order-by="c.inserted">{{\'certificate.inserted\' | translate}}</th> <th md-column ng-if="!auth.isStudent() && !auth.isParent()"></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell ng-if="!auth.isStudent() && !auth.isParent()"> <a ng-if="row.studentId" ng-href="#/students/{{row.studentId}}/main" class="md-primary change-button">{{::row.studentFullname}}</a> <span ng-if="!row.studentId">{{::row.studentFullname}}</span> </td> <td md-cell ng-if="!auth.isStudent() && !auth.isParent()">{{::row.studentGroup}}</td> <td md-cell>{{::row.certificateNr}}</td> <td md-cell><a ng-href="#/certificate/{{::row.id}}/view">{{currentLanguageNameField(row.type)}}</a></td> <td md-cell>{{currentLanguageNameField(row.status)}}</td> <td md-cell>{{::row.headline}}</td> <td md-cell>{{row.inserted | hoisDate}}</td> <td md-cell ng-if="!auth.isStudent() && !auth.isParent()"> <md-button ng-if="row.canBeChanged && isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_TOEND\')" class="md-primary change-button" ng-href="#/certificate/{{::row.id}}/edit">{{\'main.button.change\' | translate}}</md-button> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> <md-table-container> <table md-table class="secondary-table" ng-if="auth.isStudent()"> <thead md-head> <tr md-row> <th md-column>{{\'certificate.type\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="type in certificateTypes" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{currentLanguageNameField(type)}}</td> <td md-cell> <md-button md-no-ink class="md-primary change-button" ng-href="#/certificate/{{::type.code}}/new"> {{\'certificate.order\' | translate}} </md-button> </td> </tr> </tbody> </table> </md-table-container> </div>'),a.put("certificate/certificate.student.new.html",'<div layout="column" layout-padding> <form name="certificateEditForm"> <div layout="column" class="form-readonly"> <md-input-container> <label>{{\'certificate.type\' | translate}}</label> <hois-classifier-value ng-model="record.type" main-classifier-code="TOEND_LIIK"></hois-classifier-value> </md-input-container> <md-input-container> <label>{{\'certificate.headline\' | translate}}</label> <textarea ng-model="record.headline" required md-maxlength="1000" max-rows="2" readonly></textarea> </md-input-container> <md-input-container> <label>{{\'certificate.whom\' | translate}}</label> <input type="text" ng-model="record.whom" md-maxlength="255"> </md-input-container> <md-input-container ng-if="record.type === \'TOEND_LIIK_SOOR\' && !record.id"> <md-checkbox ng-model="record.addOutcomes" ng-change="addOutcomesChanged()">{{\'certificate.addOutcomes\' | translate}}</md-checkbox> </md-input-container> <md-input-container> <label class="common-label" ng-show="record.content">{{\'certificate.content\' | translate}}</label> <md-table-container> <div id="content" class="md-body-1"></div> </md-table-container> </md-input-container> </div> <div layout="row"> <md-button class="md-raised md-primary" ng-click="save()">{{\'certificate.order\' | translate}}</md-button> <md-button class="md-raised md-default" ng-click="back(\'#/certificate\', certificateEditForm)">{{\'main.button.back\' | translate}}</md-button> </div> </form> </div>'),a.put("certificate/certificate.view.html",'<div layout-padding ng-cloak class="form-readonly"> <div layout="column"> <md-input-container> <label>{{\'certificate.type\' | translate}}</label> <hois-classifier-value ng-model="record.type" main-classifier-code="TOEND_LIIK"></hois-classifier-value> </md-input-container> <md-input-container ng-if="record.status === \'TOEND_STAATUS_V\' || (auth.school.withoutEkis && record.certificateNr)"> <label>{{\'certificate.nr\' | translate}}</label> <hois-value value="record.certificateNr"></hois-value> </md-input-container> <div ng-show="!isOtherCertificate() && !auth.isStudent()" layout="column"> <md-input-container> <label>{{\'certificate.student\' | translate}}</label> <hois-value value="student.nameEt" href-value="\'#/students/\' + student.id + \'/main\'"></hois-value> </md-input-container> </div> <div ng-if="isOtherCertificate() && !auth.isStudent()"> <md-input-container class="md-block"> <label>{{\'certificate.otherIdcode\' | translate}}</label> <hois-value value="record.otherIdcode"></hois-value> </md-input-container> <md-input-container class="md-block"> <label>{{\'certificate.otherName\' | translate}}</label> <hois-value ng-if="student.id" value="record.otherName" href-value="\'#/students/\' + student.id + \'/main\'"></hois-value> <hois-value ng-if="!student.id" value="record.otherName"></hois-value> </md-input-container> </div> <md-input-container> <label>{{\'certificate.headline\' | translate}}</label> <hois-value value="record.headline"></hois-value> </md-input-container> <md-input-container> <label>{{\'certificate.whom\' | translate}}</label> <hois-value value="record.whom"></hois-value> </md-input-container> <md-input-container ng-if="!auth.isStudent()"> <label>{{\'certificate.signatory\' | translate}}</label> <hois-value value="record.signatoryName"></hois-value> </md-input-container> <md-input-container> <label>{{\'certificate.status\' | translate}}</label> <hois-classifier-value ng-model="record.status" main-classifier-code="TOEND_STAATUS"></hois-classifier-value> </md-input-container> <md-input-container> <label>{{\'certificate.inserted\' | translate}}</label> <hois-value value="record.inserted | hoisDate"></hois-value> </md-input-container> <md-input-container ng-if="contentEditable()"> <label>{{\'certificate.content\' | translate}}</label> <hois-value value="record.content"></hois-value> </md-input-container> <div ng-if="!contentEditable()"> <label class="common-label">{{\'certificate.content\' | translate}}</label> <md-table-container> <div id="content" class="md-body-1"></div> </md-table-container> </div> </div> <div layout="row"> <md-button class="md-raised md-primary" ng-if="record.canBeChanged && isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_TOEND\')" ng-href="/#/certificate/{{::record.id}}/edit">{{\'main.button.change\' | translate}}</md-button> <md-button class="md-raised md-default" ng-if="auth.isStudent() && record.status === \'TOEND_STAATUS_T\' && !auth.school.withoutEkis" ng-click="order()">{{\'certificate.orderAgain\' | translate}}</md-button> <md-button class="md-raised md-default" ng-if="record.id && auth.school.withoutEkis && auth.isAdmin()" ng-href="{{printUrl()}}" target="_blank">{{\'main.button.print\' | translate}}</md-button> <md-button class="md-raised md-default" ng-if="record.id && auth.isStudent() && record.status === \'TOEND_STAATUS_T\'" ng-click="delete()">{{\'main.button.delete\' | translate}}</md-button> <md-button class="md-raised md-default" ng-click="back(\'#/certificate\')">{{\'main.button.back\' | translate}}</md-button> <md-button class="md-raised md-default" ng-if="record.canViewFromEkis" ng-href="{{auth.isStudent() ? record.wdUrl : getCertificateUrl(record.wdId)}}" target="_blank">{{(auth.isStudent() ? \'certificate.downloadFromEkis\' : \'certificate.viewFromEkis\') | translate}}</md-button> </div> </div>'),a.put("classifier/classifier.content.edit.html",'<div layout="column" layout-padding> <div> <form name="classifierForm"> <h3>{{currentLanguageNameField(mainClass)}}</h3> <md-input-container class="md-block" ng-if="classifier.code"> <label>{{\'classifier.code\' | translate}}</label> <input ng-model="classifier.code" type="text" disabled required> </md-input-container> <md-input-container class="md-block"> <label class="textInput">{{\'classifier.value\' | translate}}</label> <input ng-model="classifier.value" type="text" required ng-disabled="classifier.code" md-maxlength="50"> </md-input-container> <md-input-container class="md-block"> <label class="textInput">{{\'classifier.value2\' | translate}}</label> <input ng-model="classifier.value2" type="text" md-maxlength="50"> </md-input-container> <md-input-container class="md-block"> <label class="textInput">{{\'classifier.nameEt\' | translate}}</label> <input ng-model="classifier.nameEt" type="text" required md-maxlength="1000"> </md-input-container> <md-input-container class="md-block"> <label class="textInput">{{\'classifier.nameEn\' | translate}}</label> <input ng-model="classifier.nameEn" type="text" md-maxlength="1000"> </md-input-container> <md-input-container class="md-block"> <label class="textInput">{{\'classifier.nameRu\' | translate}}</label> <input ng-model="classifier.nameRu" type="text" md-maxlength="1000"> </md-input-container> <md-input-container class="md-block"> <label class="textInput">{{\'classifier.description\' | translate}}</label> <textarea ng-model="classifier.description" md-maxlength="1000" max-rows="2"></textarea> </md-input-container> <md-input-container class="md-block"> <label class="textInput">{{\'classifier.ehisValue\' | translate}}</label> <input ng-model="classifier.ehisValue" type="text" md-maxlength="100"> </md-input-container> <md-input-container class="md-block"> <label class="textInput">{{\'classifier.extraval1\' | translate}}</label> <input ng-model="classifier.extraval1" type="text" md-maxlength="100"> </md-input-container> <md-input-container class="md-block"> <label class="textInput">{{\'classifier.extraval2\' | translate}}</label> <input ng-model="classifier.extraval2" type="text" md-maxlength="100"> </md-input-container> <br> <md-checkbox ng-model="classifier.vocational" aria-label="Is vocational"> {{\'classifier.isVocational\' | translate}} </md-checkbox> <md-checkbox ng-model="classifier.higher" aria-label="Is higher"> {{\'classifier.isHigher\' | translate}} </md-checkbox> <br> <md-input-container> <label class="textInput">{{\'stateCurriculum.enter.validFrom\' | translate}}</label> <md-datepicker ng-model="classifier.validFrom" md-max-date="classifier.validThru"></md-datepicker> </md-input-container> <md-input-container> <label class="textInput">{{\'stateCurriculum.enter.validThru\' | translate}}</label> <md-datepicker ng-model="classifier.validThru" md-min-date="classifier.validFrom"></md-datepicker> </md-input-container> <div ng-repeat="connection in possibleConnections"> <h3>{{\'classifier.connection\' | translate}}: <span ng-bind="currentLanguageNameField(connection)"></span></h3> <md-autocomplete name="classifiersParentInput$index" md-selected-item="classifiersParent$index" md-search-text="queryName" md-items="item in querySearch(queryName, connection.code)" md-item-text="item | hoisValidDates" md-min-length="0" placeholder="{{\'classifier.connection.add\' | translate}}" ng-model="queryName" md-no-cache md-selected-item-change="addParent(classifiersParent$index)"> <md-item-template> <span md-highlight-text="queryName" md-highlight-flags="^i">{{item | hoisValidDates}}</span> </md-item-template> <md-not-found> {{\'main.messages.error.notFound\' | translate}} </md-not-found> </md-autocomplete> <p ng-repeat="parent in parents | filter:{ mainClassCode: connection.code}"> <a ng-bind="parent | hoisValidDates" ng-href="#/classifier/{{parent.mainClassCode}}/{{parent.code}}/edit"></a> <md-button class="remove" ng-click="removeParent(parent)">&times;</md-button> </p> <br> </div> <h3 ng-if="hasChildren">{{\'classifier.connection.children.label\' | translate}}: </h3> <ul> <li ng-repeat="child in children | orderBy : \'nameEt\'"><a ng-bind="currentLanguageNameField(child)" ng-href="#/classifier/{{child.mainClassCode}}/{{child.code}}/edit"></a></li> </ul> </form> <md-button ng-click="save()" class="md-raised md-primary"> {{\'main.button.save\' | translate}}</md-button> <md-button ng-click="delete()" ng-if="classifier.code" class="md-raised">{{\'main.button.delete\' | translate}}</md-button> <md-button ng-click="back(\'#/classifier/\' + mainClassCode, classifierForm)" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </div> </div>'),a.put("classifier/classifier.content.list.html",'<div layout-padding> <form ng-submit="loadData()" novalidate> <div flex> <div layout="row"> <div flex-xs="100" flex-gt-xs="100" flex-gt-sm="50" layout="column"> <!--div class="indentForToast"></div--> <h3>{{currentLanguageNameField(mainClass)}}</h3> <md-input-container> <label class="textInput">{{\'classifier.name\' | translate}}</label> <input ng-model="criteria.name" type="text" autofocus> </md-input-container> <md-input-container> <label class="textInput">{{\'classifier.value\' | translate}}</label> <input ng-model="criteria.value" type="text"> </md-input-container> <div layout="row"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> <md-button class="md-raised" ng-href="#/classifier/{{mainClassCode}}/new">{{\'main.button.create\' | translate}}</md-button> <md-button class="md-raised" ng-href="#/classifier">{{\'main.button.back\' | translate}}</md-button> </div> </div> <div flex-xs="0" flex-gt-xs="0" flex-gt-sm="50"></div> </div> </div> </form> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="value">{{\'classifier.value\' | translate}}</th> <th md-column md-order-by="{{currentLanguageNameField()}}">{{\'classifier.name\' | translate}}</th> <th md-column>{{\'classifier.valid\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{::row.value}}</td> <td md-cell>{{currentLanguageNameField(row)}}</td> <td md-cell>{{(isValid(row) ? \'classifier.validTrue\' : \'classifier.validFalse\') | translate}}</td> <td md-cell> <md-button md-no-ink class="md-primary change-button" ng-href="#/classifier/{{::mainClassCode}}/{{::row.code}}/edit">{{\'main.button.change\' | translate}}</md-button> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\' }" md-page-select></md-table-pagination> </div> </div>'),a.put("classifier/classifier.list.html",'<div layout-padding> <div flex> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <form ng-submit="loadData()"> <div flex> <div layout="row"> <div flex-xs="100" flex-gt-xs="100" flex-gt-sm="50" layout="column"> <!--div class="indentForToast"></div--> <md-input-container> <label class="textInput">{{\'classifier.name\' | translate}}</label> <input ng-model="criteria.name" type="text" autofocus> </md-input-container> <div layout="row"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> </div> </div> <div flex-xs="0" flex-gt-xs="0" flex-gt-sm="50"></div> </div> </div> </form> </fieldset> </div> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="{{currentLanguage()===\'en\' ? \'nameEn\' : \'nameEt\'}}">{{\'classifier.mainname\' | translate}}</th> <th md-column md-numeric>{{\'classifier.count\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="classifier in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell><a ng-href="#/classifier/{{::classifier.code}}?_menu">{{currentLanguageNameField(classifier)}}</a></td> <td md-cell>{{::classifier.count}}</td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\' }" md-page-select></md-table-pagination> </div> </div>'),a.put("committee/committee.edit.html",'<div class="ois-form-layout-padding" ng-cloak> <form layout="column" name="committeeEditForm"> <div layout="row" ng-if="showName"> <md-input-container flex> <label>{{\'committee.name\' | translate}}</label> <input type="text" ng-model="record.nameEt" md-maxlength="255"> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex> <label>{{\'committee.addInfo\' | translate}}</label> <textarea ng-model="record.addInfo" md-maxlength="4000" max-rows="10"></textarea> </md-input-container> </div> <div layout="row"> <div layout="column" flex="45"> <label class="common-label">{{\'committee.validDate\' | translate}}</label> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex flex-sm="100" flex-xs="100"> <label>{{\'main.from\' | translate}}</label> <md-datepicker ng-model="record.validFrom" md-max-date="record.validThru" required></md-datepicker> </md-input-container> <md-input-container flex flex-sm="100" flex-xs="100" flex-offset-xs="0" flex-offset-sm="0" flex-offset="5"> <label>{{\'main.thru\' | translate}}</label> <md-datepicker ng-model="record.validThru" md-min-date="record.validFrom" required></md-datepicker> </md-input-container> </div> </div> </div> <div ng-if="committeeType === \'KOMISJON_T\'"> <div layout="row" flex="100"> <hois-autocomplete flex ng-model="formState.curriculum" method="curriculums" label="committee.curriculums" md-selected-item-change="curriculumSelected()"></hois-autocomplete> </div> <div layout="column" class="common-label" flex="95" ng-repeat="curriculum in record.curriculums"> <div layout="row" flex layout-align="start center"> <div flex="5">&nbsp;</div> <div flex="50">{{curriculum.nameEt}}</div> <div> <a ng-click="deleteCurriculum(curriculum)" class="remove">&times;</a> </div> </div> </div> </div> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'committee.memberIs\' | translate}}</legend> <div layout="row"> <md-button class="md-raised" ng-click="addMember()">{{\'committee.addMember\' | translate}}</md-button> </div> <md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'committee.isChairman\' | translate}}</th> <th md-column ng-if="allowExternalPerson">{{\'committee.external\' | translate}}</th> <th md-column>{{\'committee.member\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="member in record.members" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <ng-form name="committeeMemberForm"> <td md-cell> <md-checkbox ng-model="member.isChairman" ng-change="assingChairman(member)" aria-label="{{\'committee.isChairman\' | translate}} {{member.memberName}}"> </md-checkbox> </td> <td md-cell ng-if="allowExternalPerson"> <md-checkbox ng-model="member.isExternal" ng-change="clearMember(member)" aria-label="{{\'committee.external\' | translate}} {{member.memberName}}"> </md-checkbox> </td> <td md-cell> <div layout="row" ng-if="member.isExternal" flex="100"> <md-input-container flex> <input type="text" ng-model="member.memberName" md-maxlength="100" aria-label="{{\'committee.name\' | translate}} {{member.memberName}}" required> </md-input-container> </div> <div layout="column" ng-if="!member.isExternal && !showPersonSearch"> <md-input-container flex> <hois-select ng-model="member.teacher" type="teacher" criteria="{valid: true, selectedTeacherId: member.teacher}" aria-label="{{\'committee.name\' | translate}} {{member.memberName}}" required></hois-select> </md-input-container> </div> <div layout="column" ng-if="!member.isExternal && showPersonSearch"> <hois-autocomplete flex ng-model="member.person" method="committeeMembers" no-paging="true" label="committee.member" aria-label="{{\'committee.member\' | translate}} {{member.memberName}}" required></hois-autocomplete> </div> </td> <td md-cell><a class="remove nomargin" ng-click="removeMember(member)">&times;</a></td> </ng-form> </tr> </tbody> </table> </md-table-container> </fieldset> <br> <div> <md-button class="md-raised md-primary" ng-click="save()">{{\'main.button.save\' | translate}}</md-button> <md-button class="md-raised" ng-click="delete()" ng-if="record.id">{{\'main.button.delete\' | translate}}</md-button> <md-button class="md-raised" ng-click="back(\'#/committees/\' + committeeType, committeeEditForm)">{{\'main.button.back\' | translate}}</md-button> </div> </form> </div>'),a.put("committee/committee.search.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <form name="searchForm" ng-submit="loadData()" novalidate class="nomargin" ng-model-options="{allowInvalid: true}"> <div layout="row"> <md-input-container flex="100"> <label>{{\'committee.memberName\' | translate}}</label> <input type="text" ng-model="criteria.memberName" md-maxlength="255"> </md-input-container> </div> <div layout="row" ng-if="showName"> <md-input-container flex="100"> <label>{{\'committee.name\' | translate}}</label> <input type="text" ng-model="criteria.nameEt" md-maxlength="255"> </md-input-container> </div> <br> <div layout="row"> <div layout="column" flex="45"> <label class="common-label">{{\'committee.validDate\' | translate}}</label> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex flex-sm="100" flex-xs="100"> <label>{{\'main.from\' | translate}}</label> <md-datepicker ng-model="criteria.validFrom" md-max-date="criteria.validThru" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> <md-input-container flex flex-sm="100" flex-xs="100" flex-offset-xs="0" flex-offset-sm="0" flex-offset="5"> <label>{{\'main.thru\' | translate}}</label> <md-datepicker ng-model="criteria.validThru" md-min-date="criteria.validFrom" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> </div> </div> </div> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <md-checkbox ng-model="criteria.showInvalid" aria-label="{{\'committee.showInvalid\' | translate}}"> {{\'committee.showInvalid\' | translate}} </md-checkbox> </md-input-container> <br><br> <div layout="row"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> <md-button class="md-raised" ng-if="canEdit" ng-href="#/committees/{{committeeType}}/new">{{\'main.button.create\' | translate}}</md-button> </div> </form> </fieldset> </div> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="chairman">{{\'committee.chairman\' | translate}}</th> <th md-column md-order-by="nameEt" ng-if="showName">{{\'committee.name\' | translate}}</th> <th md-column md-order-by="c.validFrom">{{\'committee.validFromDate\' | translate}}</th> <th md-column md-order-by="c.validThru">{{\'committee.validThruDate\' | translate}}</th> <th md-column>{{\'committee.members\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell><a ng-href="#/committees/{{committeeType}}/{{row.id}}/view">{{row.chairman}}</a></td> <td md-cell ng-if="showName">{{::row.nameEt}}</td> <td md-cell>{{row.validFrom | hoisDate}}</td> <td md-cell>{{row.validThru | hoisDate}}</td> <td md-cell> <table> <tr ng-repeat="member in row.members | orderBy"> <td>{{member}}</td> </tr> </table> </td> <td md-cell> <md-button md-no-ink class="md-primary change-button" ng-if="canEdit" ng-href="#/committees/{{committeeType}}/{{row.id}}/edit"> {{\'main.button.change\' | translate}} </md-button> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> </div>'),
a.put("committee/committee.view.html",'<div class="ois-form-layout-padding form-readonly" ng-cloak> <div layout="row" ng-if="showName"> <md-input-container flex> <label>{{\'committee.name\' | translate}}</label> <hois-value value="record.nameEt"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex> <label>{{\'committee.addInfo\' | translate}}</label> <hois-value value="record.addInfo"></hois-value> </md-input-container> </div> <div layout="row"> <div layout="column" flex="45"> <label class="common-label">{{\'committee.validDate\' | translate}}</label> <div>&nbsp;</div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex flex-sm="100" flex-xs="100"> <label>{{\'main.from\' | translate}}</label> <hois-value value="record.validFrom | hoisDate"></hois-value> </md-input-container> <md-input-container flex flex-sm="100" flex-xs="100" flex-offset-xs="0" flex-offset-sm="0" flex-offset="5"> <label>{{\'main.thru\' | translate}}</label> <hois-value value="record.validThru | hoisDate"></hois-value> </md-input-container> </div> </div> </div> <div layout="row" ng-if="committeeType === \'KOMISJON_T\'"> <md-input-container flex> <label>{{\'committee.curriculums\' | translate}}</label> <hois-value value="record.curriculums.map(currentLanguageNameField).join(\', \')"></hois-value> </md-input-container> </div> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'committee.memberIs\' | translate}}</legend> <md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'committee.isChairman\' | translate}}</th> <th md-column ng-if="allowExternalPerson">{{\'committee.external\' | translate}}</th> <th md-column>{{\'committee.member\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="member in record.members" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell> <i class="material-icons" ng-if="member.isChairman">done</i> </td> <td md-cell ng-if="allowExternalPerson"> <i class="material-icons" ng-if="member.isExternal">done</i> </td> <td md-cell> <hois-value value="member.memberName"></hois-value> </td> </tr> </tbody> </table> </md-table-container> </fieldset> <br> <fieldset ng-if="committeeType === \'KOMISJON_T\'"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'committee.decisions\' | translate}}</legend> <md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'stipend.decision.protocolNr\' | translate}}</th> <th md-column>{{\'stipend.decision.decided\' | translate}}</th> <th md-column>{{\'stipend.type\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="decision in record.scholarshipDecisions track by $index" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{::decision.protocolNr}}</td> <td md-cell> <a ng-href="#/scholarships/decision/{{getScholarshipTypeForUrl(decision.scholarshipType.code)}}/{{decision.id}}">{{decision.decided | hoisDate}}</a> </td> <td md-cell>{{currentLanguageNameField(decision.scholarshipType)}}</td> </tr> </tbody> </table> </md-table-container> </fieldset> <fieldset ng-if="committeeType === \'KOMISJON_V\'"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'committee.decisions\' | translate}}</legend> <md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column width="20%">{{\'committee.apelDecisons.student\' | translate}}</th> <th md-column>{{\'committee.apelDecisons.decision\' | translate}}</th> <th md-column width="10%"></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in record.apelApplicationDecisions track by $index" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell><a ng-href="/#/apelApplication/{{row.applicationId}}/view">{{row.studentName}}</a></td> <td md-cell><span>{{row.decision | hoisLimitTo: 150:!row.showAll}}</span></td> <td md-cell> <span class="custom-tooltip" ng-if="!row.showAll && row.decision.length > 150" ng-click="row.showAll = true">{{\'committee.apelDecisons.showMore\' | translate}}</span> <span class="custom-tooltip" ng-if="row.showAll" ng-click="row.showAll = false">{{\'committee.apelDecisons.showLess\' | translate}}</span> </td> </tr> </tbody> </table> </md-table-container> </fieldset> <br> <div> <md-button class="md-raised md-primary" ng-if="record.canEdit" ng-href="#/committees/{{committeeType}}/{{record.id}}/edit?_noback">{{\'main.button.change\' | translate}}</md-button> <md-button class="md-raised" ng-href="#/committees/{{committeeType}}">{{\'main.button.back\' | translate}}</md-button> </div> </div>'),a.put("components/confirm.dialog.html",'<md-dialog aria-label="grade add dialog" flex="30" flex-xs="100" ng-cloak> <md-dialog-content> <div class="md-dialog-content"> <p translate="{{messages.prompt}}" translate-values="{{messages}}"></p> <p ng-repeat="prompt in messages.extraPrompts" translate="{{prompt}}" translate-values="{{messages}}"></p> </div> </md-dialog-content> <md-dialog-actions layout="row" layout-align="start center"> <md-button ng-click="accept()" class="md-raised md-primary">{{messages.accept | translate}}</md-button> <md-button ng-click="cancel()" class="md-raised">{{messages.cancel | translate}}</md-button> </md-dialog-actions> </md-dialog>'),a.put("components/file.add.dialog.html",'<md-dialog aria-label="file add dialog" flex="40" flex-xs="100"> <form name="dialogForm" ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2>{{"main.addFile" | translate}}</h2> <span flex></span> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <span flex></span> <div class="ois-form-layout" layout="column" layout-margin ng-cloak> <div layout="column"> <md-input-container flex> <lf-ng-md-file-input name="file" lf-files="data.file" lf-browse-label="{{\'main.addFile\' | translate}}" lf-remove-label="{{\'main.button.delete\' | translate}}" lf-placeholder="" lf-filesize="5MB" disallow-same-file="addedFiles" lf-required> </lf-ng-md-file-input> </md-input-container> <div ng-messages="dialogForm.file.$error"> <div class="invalid" ng-message="required">{{\'main.messages.error.selectFile\' | translate}}</div> <div class="invalid" ng-message="filesize">{{\'main.messages.error.fileTooLarge\' | translate}} 5MB!</div> <div class="invalid" ng-message="samefile">{{\'main.messages.error.fileAlreadyExists\' | translate}}</div> </div> </div> </div> </md-dialog-content> <span flex></span> <md-dialog-actions layout="row" layout-align="start center"> <md-button class="md-raised md-primary" ng-click="submit()">{{"main.button.save" | translate}}</md-button> <md-button class="md-raised" ng-click="cancel()">{{"main.button.close" | translate}}</md-button> </md-dialog-actions> </form> </md-dialog>'),a.put("components/hois.autocomplete.html",'<md-autocomplete flex md-min-length="mdMinLength" md-no-cache="true" md-selected-item="ngHolder" md-selected-item-change="selectedItemChange()" md-search-text="ngSearchText" md-items="item in haSearch(ngSearchText)" md-item-text="getChipText(item)" md-require-match ng-required="required" ng-disabled="disabled" md-floating-label="{{label | translate}}"> <md-item-template> <span md-highlight-text="ngSearchText" md-highlight-flags="i" ng-style="{\'color\': warningParam && item[\'{{warningParam}}\'] ? \'red\' : \'inherit\'}">{{display ? item[display] : $root.currentLanguageNameField(item)}}</span> </md-item-template> <md-not-found> {{\'main.messages.error.notFound\' | translate}} </md-not-found> </md-autocomplete>'),a.put("components/hois.autocomplete.nolabel.html",'<md-autocomplete flex md-min-length="mdMinLength" md-no-cache="true" md-selected-item="ngHolder" md-selected-item-change="selectedItemChange()" md-search-text="ngSearchText" md-items="item in haSearch(ngSearchText)" md-item-text="getChipText(item)" md-require-match ng-required="required" ng-disabled="disabled"> <md-item-template> <span md-highlight-text="ngSearchText" ng-style="{\'color\': warningParam && item[\'{{warningParam}}\'] ? \'red\' : \'inherit\'}">{{display ? item[display] : $root.currentLanguageNameField(item)}}</span> </md-item-template> </md-autocomplete>'),a.put("components/hois.chip.autocomplete.html",'<md-chips ng-model="ngHolder" md-autocomplete-snap md-transform-chip="transformChip($chip)" md-require-match="true" md-max-chips="{{maxChips}}" readonly> <md-autocomplete md-selected-item="selectedItem" md-selected-item-change="selectedItemChange()" md-search-text="ngSearchText" md-min-length="mdMinLength" md-no-cache="true" md-items="item in haSearch(ngSearchText)" placeholder="{{label | translate}}" ng-hide="ngHolder.length > maxChips" flex> <span md-highlight-text="ngSearchText" ng-style="{\'color\': warningParam && item[\'{{warningParam}}\'] ? \'red\' : \'inherit\'}">{{display ? item[display] : $root.currentLanguageNameField(item)}}</span> </md-autocomplete> <md-chip-template> <span> <strong>{{getChipText($chip)}}</strong> </span> </md-chip-template> </md-chips>'),a.put("components/hois.created.modified.html",'<div layout="column"> <div>&nbsp;</div> <fieldset tabindex="1000"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.insertedOrChanged\' | translate}}</legend> <md-table-container> <table md-table md-progress="promise" class="secondary-table"> <thead md-head md-order="query.order" md-on-reorder="getInformationSection"> <tr md-row> <th md-column><span>{{\'main.state\' | translate}}</span></th> <th md-column><span>{{\'main.insertOrChangeDate\' | translate}}</span></th> <th md-column><span>{{\'main.insertedOrChangedByFirstAndLastName\' | translate}}</span></th> </tr> </thead> <tbody md-body> <tr md-row ng-if="object.inserted" class="odd"> <td md-cell>{{\'main.inserted\' | translate}}</td> <td md-cell>{{object.inserted | hoisDateTime}}</td> <td md-cell>{{object.insertedBy}}</td> </tr> <tr md-row ng-if="object.changed" class="even"> <td md-cell>{{\'main.changed\' | translate}}</td> <td md-cell>{{object.changed | hoisDateTime}}</td> <td md-cell>{{object.changedBy}}</td> </tr> </tbody> </table> </md-table-container> </fieldset> <!--/md-card--> </div>'),a.put("components/hois.select.html",'<md-select md-on-open="queryPromise" ng-model-options="{trackBy: \'$value\'}"> <md-option ng-if="!isMultiple && !isRequired && !ngRequired" md-option-empty></md-option> <md-option ng-repeat="option in filteredOptions | orderBy: orderBy" ng-value="option[valueProperty]" aria-label="{{$root.currentLanguageNameField(option)}}"> <span ng-style="{\'color\': warningParam && option[\'{{warningParam}}\'] ? \'red\': \'inherit\'}"> {{showProperty ? option[showProperty] : $root.currentLanguageNameField(option)}} </span> </md-option> </md-select>'),a.put("components/menu-link.tmpl.html",'<md-button ng-class="{\'active\' : isSelected()}" ng-href="#{{section.url}}" ng-click="focusSection()" md-colors="{color: isSelected() ? \'primary-900\':\'primary-900\'}"> <md-icon md-colors="{color: isSelected() ? \'primary-900\':\'primary-900\'}" md-font-set="material-icons" class="sm" ng-class="{\'active\' : isSelected()}">{{section.icon}}</md-icon> {{section.name | translate}} <span class="md-visually-hidden" ng-if="isSelected()"> current page </span> </md-button>'),a.put("components/menu-toggle.tmpl.html",'<md-button class="md-button-toggle" ng-click="toggle()" aria-controls="docs-menu-{{section.name | nospace}}" aria-expanded="{{isOpen()}}"> <div flex layout="row" md-colors="{color: isSelected() ? \'primary-900\':\'primary-900\'}" ng-class="{\'active\' : isSelected()}"> <md-icon md-font-set="material-icons" class="sm" md-colors="{color: isSelected() ? \'primary-900\':\'primary-900\'}">{{section.icon}}</md-icon> {{section.name | translate}} <span flex></span> <span aria-hidden="true" class="md-toggle-icon" ng-class="{\'toggled\' : isOpen()}"> <md-icon md-font-set="material-icons">expand_less</md-icon> </span> </div> <span class="md-visually-hidden"> Toggle {{isOpen()? \'expanded\' : \'collapsed\'}} </span> </md-button> <ul id="docs-menu-{{section.name | nospace}}" class="menu-toggle-list" aria-hidden="{{!renderContent}}" ng-style="{ visibility: renderContent ? \'visible\' : \'hidden\' }"> <li ng-repeat="page in section.pages"> <menu-link section="page"></menu-link> </li> </ul>'),a.put("components/message.dialog.html",'<md-dialog aria-label="grade add dialog" flex="30" flex-xs="100" ng-cloak> <md-dialog-content> <div class="md-dialog-content"> <p translate="{{messages.prompt}}" translate-values="{{messages}}"></p> </div> </md-dialog-content> <md-dialog-actions layout="row" layout-align="start center"> <md-button ng-click="close()" class="md-raised">{{messages.close | translate}}</md-button> </md-dialog-actions> </md-dialog>'),a.put("components/moodle.enroll.dialog.html",'<md-dialog aria-label="moodle enroll dialog" flex="50"> <form name="dialogForm" ng-submit="loadData()" novalidate ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2>{{"moodle.enrollStudents" | translate}}</h2> <span flex></span> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <div class="md-dialog-content form-readonly"> <div flex> <div layout="row" flex> <h2 flex>{{\'moodle.enroll.enrolled\' | translate}}: {{moodleResponse.enrolled}}</h2> </div> <div layout="row" flex> <h2 flex> {{\'moodle.enroll.failed\' | translate}}: {{moodleResponse.failed.length + moodleResponse.missingUser.length + moodleResponse.missingIdcode.length}} </h2> </div> <ol> <li ng-repeat="user in moodleResponse.failed"> {{user}} </li> <li ng-repeat="user in moodleResponse.missingUser"> {{user}} ({{\'moodle.enroll.missingUser\' | translate}}) </li> <li ng-repeat="user in moodleResponse.missingIdcode"> {{user}} ({{\'moodle.enroll.missingIdcode\' | translate}}) </li> </ol> </div> <span flex></span> <md-dialog-actions layout="row" layout-align="start center"> <md-button class="md-raised" ng-click="cancel()">{{"main.button.close" | translate}}</md-button> </md-dialog-actions> </div> </md-dialog-content> </form> </md-dialog>'),a.put("components/progress.wheel.dialog.html",'<md-dialog class="loading-wheel" style="background-color:transparent;box-shadow:none"> <div layout="row" layout-sm="column" layout-align="center center" aria-label="wait" style="height:120px"> <!-- <md-progress-circular class="md-hue-2 loader" md-diameter="80px" value="{{progress.value}}"></md-progress-circular> --> <md-progress-circular class="md-hue-2 loader" md-diameter="80px"></md-progress-circular> </div> <h3 ng-if="text">{{text}}</h3> <h3 ng-if="text">{{progress.value}}%</h3> </md-dialog> <style>md-dialog.loading-wheel {\r\n    background-color:transparent;\r\n    box-shadow:none;\r\n  }\r\n\r\n  md-dialog.loading-wheel h3 {\r\n    text-align:center;\r\n    color: white;\r\n    text-shadow: -1px -1px 0 #000,\r\n                 1px -1px 0 #000,\r\n                 -1px 1px 0 #000,\r\n                 1px 1px 0 #000;\r\n  }</style>'),a.put("components/tara.protocol.confirm.dialog.html",'<md-dialog aria-label="tara protocol confirm dialog" flex="20"> <form name="dialogForm" novalidate ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2>{{\'protocol.confirmLabel\' | translate}}</h2> <span flex></span> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <div class="md-dialog-content form-readonly"> <md-dialog-actions layout="row" layout-align="start center"> <md-button class="md-raised md-primary" ng-click="idcard()">{{"protocol.idcard" | translate}}</md-button> <md-button class="md-raised md-primary" ng-click="mobileid()">{{"protocol.mobileid" | translate}}</md-button> </md-dialog-actions> </div> </md-dialog-content> </form> </md-dialog>'),a.put("components/terms.en.dialog.html",'<md-dialog aria-label="terms" flex="80" flex-xs="100" ng-cloak> <md-dialog-content> <div class="md-dialog-content"> <p>The study information system Tahvel (hereinafter Tahvel) is established with the aim to ensure effective, single and secure administration of studies across the educational levels. The studies are managed according to the legislation of the relevant area.</p> <p>The aim of Tahvel is to ensure the joined educational institutions (hereinafter <span class="bold">Institution</span>) a single and secure web-based environment through which to manage the study-related activities and inquire and communicate the data necessary for managing studies from the Admissions Information System to the Estonian Schools’ Information System and Estonian Education Information System.</p> <p>The Controller of Tahvel as the information system is the Information Technology Foundation for Education (hereinafter <span class="bold">HITSA</span>). The Controllers of the data in Tahvel are the Institutions to the extent of data processed by them. In respect of the data of the Institution, HITSA is the Processor by enabling to use Tahvel for processing personal data, by providing the support for the use of Tahvel, and by hosting the personal data in Tahvel in its servers. The users of Tahvel are all natural or legal persons who use the Tahvel environment.</p> <p>HITSA and the Institutions undertake to protect the personal data processed in Tahvel and their privacy.</p> <ol class="terms"> <li>General terms <ol type="a"> <li>The use of any information or data volume in Tahvel in any way or any purpose is deemed as the use of Tahvel.</li> <li>The use of Tahvel is allowed only in case of accepting all terms of use. The use of Tahvel confirms accepting all terms of use.</li> <li>The Institution has the right to use Tahvel for managing the studies. All Institutions get a sub-account of Tahvel Institution.</li> <li>The Institution who wishes to use the Tahvel shall submit a relevant request that is digitally signed by the signatory to HITSA.</li> <li>An agreement for maintaining data is entered into with all Institutions. The agreement will fix, inter alia, the backup principles. The template of the agreement is available at <a href="https://projektid.hitsa.ee/display/IS2" target="_blank" rel="noopener">https://projektid.hitsa.ee/display/IS2</a>.</li> <li>The code of Tahvel is public, available at <a href="https://github.com/hariduspilv/oppeinfo" target="_blank" rel="noopener">https://github.com/hariduspilv/oppeinfo</a>.</li> <li>Technical architecture and functionality is available on the project page at <a href="https://projektid.hitsa.ee/display/IS2" target="_blank" rel="noopener">https://projektid.hitsa.ee/display/IS2</a>.</li> <li>Tahvel can be visited only with the general-purpose Internet browsers (Chrome, Mozilla Firefox, Edge, Opera, Safari and others).</li> <li>Visiting of Tahvel with special purpose programs for any purpose is forbidden without a previous written consent of HITSA. The special purpose program is a program that is not intended for general purpose Internet browsing or which work is not directly controlled by a human. The special purpose programs include inter alia, scripts, robots and automated tools or programs that are not intended for Internet browsing.</li> <li>The activities that disturb or hinder the provision of services via Tahvel are not allowed while using Tahvel, including the user must refrain from overloading the computer network and servers.</li> <li>In the case where a provision of the terms of use is invalid due to conflict with the law, it will not affect the validity of the remaining provisions of the terms of use.</li> </ol> </li> <li>How to create and delete the Tahvel account <ol type="a"> <li>The Institution will create a Tahvel account for the user. To create the account, the person must have an employment relationship or a relationship under the law of obligations act with the Institution, or study in the Institution according to the documents regulating the study arrangements of the Institution.</li> <li>In the case of a person with the need of the representation right, their legal representative can confirm the activities in Tahvel. The Institution is responsible for entering the representative.</li> <li>The student accounts are created in the Admissions Information System or based on the data entered by the Institution.</li> <li>The teacher’s account is created based on the data entered by the enterprise software SAP or Institution.</li> <li>The administrative worker’s account is created based on the data entered by the Institution. When taking Tahvel into use, HITSA will enter the Institution’s administrative worker of the first Institution according to the application submitted by the authorised person of the Institution.</li> <li>To delete the account, the person must submit a request to the Institution with who their account is associated. The account cannot be deleted if there is a legal base for keeping it open (e.g. the account is associated with data which retention date has not arrived yet).</li> <li>It is not possible to use the Service any more after deleting the Account.</li> </ol> </li> <li>Personal data protection <ol type="a"> <li>The aim of collecting and processing the personal data is to identify the person, managing the person-related studies, including involving the person in studies and adding performances there and drawing up the studies related documents, compiling the studies related statistics of the Institutions.</li> <li>Tahvel processes the personal data in compliance with the European Parliament and Council Regulation (EU) 2016/679 of 27 April 2016 on the protection of natural persons in the processing of personal data and on the free movement of such data and repealing Directive 95/46/EC (General Data Protection Regulation).</li> <li>To protect the personal data, all relevant organisational, technical and physical measures are applied upon processing of personal data.</li> <li>The personal data are processed in Tahvel only via the secure connection (https). The users authenticate via ID card, Mobile ID or other identity solution approved by the state and the Institutions account management.</li> <li>Only the authorised and guided persons can access data for processing according to the extent necessary for performing their duties.</li> <li>Personal data can only be transferred without the consent of the person to the establishment or a party who have the direct right arising from the law (e.g. court of law or pre-trial body conducting proceeding) and the justified need.</li> <li>The personal data is stored according to the normative documents valid for the educational institutions.</li> <li>While deleting the user account, the personal data may be retained in the backup copy in Tahvel for a limited period.</li> <li>The User must address the Institution under whose educational activities their personal data are processed with issues related to processing personal data related to the study activities, or performing the law-related rights.</li> </ol> </li> <li>Processed personal data <ol type="a"> <li>Personal data are processed in Tahvel in the composition established by the Institution. The data are entered to Tahvel by the Institution, inquired from other information systems or entered personally by the user.</li> <li>The main data of the person (name, personal identification code, gender, citizenship, communication language), studies information (incl performances, documents), contact information, representatives and data on special conditions, if needed, are processed from the student’s data in Tahvel.</li> <li>The person’s main data, working place data related to the Institution and information related to the arrangement of studies are processed from the data of the teacher in Tahvel.</li> <li>The detailed data composition contained in Tahvel is disclosed in RIHA and is publicly available at <a href="https://www.riha.ee/Infos%C3%BCsteemid/Vaata/ois2" target="_blank" rel="noopener">https://www.riha.ee/Infos%C3%BCsteemid/Vaata/ois2</a></li> <li>Tahvel is connected via the data exchange layer X-Road with: <ul> <li>Admissions Information System (SAIS);</li> <li>Estonian Education Information System (EHIS);</li> <li>Professional register;</li> <li>Enterprise software SAP (Employee self-service portal).</li> </ul> </li> <li>Tahvel exchanges data via the safe SOAP synchronous web services: <ul> <li>Estonian Schools’ Information System (EKIS);</li> <li>HITSA Study Information System Moodle;</li> <li>Plagiarism detection software KRATT.</li> </ul> </li> <li>Tahvel uses the address search API inADS of the land Board.</li> <li>The personalised data (logs) with which the person logged in, which browser was used and when the session ended are collected upon the visits of Tahvel.</li> <li>The pages visited by the person are logged only on the web server level and are hence not personalised. While processing the depersonalised data, no specific user can be identified in any way.</li> </ol> </li> <li>Ensurance of Accuracy of Data, amendment and rectification of data <ol type="a"> <li>The person who submitted the data and the person who entered the data are responsible for the accuracy of the data entered to Tahvel.</li> <li>The data can be amended by the persons themselves, and HITSA by authorisation of the Institution. All amendments of the data are logged.</li> <li>When the data are entered to Tahvel, the data about the person who entered data and the date and time of entering are stored.</li> <li>When the data are rectified in Tahvel, the date of rectification and the person who rectified the data are fixed in the system log.</li> <li>Adding, amendment and deletion of data are deemed as making an entry in Tahvel.</li> <li>Every Institution enters only the data of own organisation.</li> </ol> </li> <li>Participants’ liability in data processing <ol type="a"> <li>Tahvel is hosted in the servers managed by HITSA and located in the territory of Estonia. Servers’ and Tahvel software is maintained currently with up-to-date security updates.</li> <li>HITSA is responsible for the uninterrupted operation of Tahvel and necessary development works, provides support of the information system, arranges storage and backup copies of the data that are contained in Tahvel.</li> <li>HITSA is not responsible for the failures of the Tahvel caused by circumstances that are outside the control of HITSA.</li> <li>HITSA is not responsible for the content of the data and documents entered to Tahvel by the users.</li> <li>HITSA may process all personal data processed in Tahvel for providing information system support and hosting service.</li> <li>The Institutions are responsible for performing the requirements related to management of studies related information, processing of personal data (incl obligation of notification) and responding to the inquiry of the data subject.</li> <li>The Institution undertakes to ensure the compliance of the user roles and rights of the Institution and prevent an access or unauthorised persons to Tahvel and personal data.</li> <li>The Institution is responsible in case of the damage caused via the roles, including violation of the data protection requirements and activities damaging functioning of Tahvel.</li> <li>HITSA has a unilateral right to limit or stop an access of the Institution or the user to Tahvel in case of an actual or potential risk to the security of Tahvel. HITSA will immediately inform the relevant Institution about restricting or stopping an access of the users of the Institution and both parties have to take immediate measures to eliminate the risk.</li> <li>HITSA will inform about possible data leaks all Users whom the data leak concerned or might have concerned on its website <a href="https://www.hitsa.ee" target="_blank" rel="noopener">www.hitsa.ee</a>, the home page of the Service and via e-mails provided in Moodle within 72 hours. In addition, HITSA will inform the Information System Authority and the Data Protection Inspectorate via the appropriate incident report form. In addition, HITSA will immediately take all measures to exclude the use of leaked data in any way against the users of the service.</li> </ol> </li> </ol> </div> </md-dialog-content> <md-dialog-actions layout="row" layout-align="start center"> <md-button ng-click="cancel()" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </md-dialog-actions> </md-dialog>'),a.put("components/terms.et.dialog.html",'<md-dialog aria-label="terms" flex="80" flex-xs="100" ng-cloak> <md-dialog-content> <div class="md-dialog-content"> <h1>Tahvel kasutustingimused</h1> <p>Õppeinfosüsteemi Tahvel (edaspidi Tahvel) on asutatud eesmärgiga tagada haridustasemete ülene efektiivne, ühtne ja turvaline õppetöö administreerimine. Õppetöö administreerimine toimub vastavalt valdkonna õigusaktidele.</p> <p>Tahvli eesmärgiks on tagada liitunud haridusasutustele (edaspidi <span class="bold">Asutus</span>) ühtne ja turvaline veebipõhine keskkond, mille kaudu hallata oma õppetööga seotud toiminguid ning pärida ja edastada õppetöö administreerimiseks vajalikke andmeid Sisseastumise Infosüsteemist, Eesti Koolide Infosüsteemile ja Eesti Hariduse Infosüsteemile.</p> <p>Tahvli, kui infosüsteemi, vastutav töötleja on Hariduse Infotehnoloogia Sihtasutus (edaspidi <span class="bold">HITSA</span>). Tahvlis sisalduvate andmete vastutavad töötlejad on Asutused nende poolt töödeldavate andmete ulatuses. Asutuse andmete osas on HITSA volitatud töötleja võimaldades isikuandmete töötlemiseks kasutada Tahvlit, pakkudes Tahvli kasutamisel kasutajatuge ja majutades Tahvlis sisalduvaid andmeid oma serverites. Tahvli kasutajad on kõik füüsilised või juriidilised isikud, kes kasutavad Tahvli keskkonda.</p> <p>HITSA ja Asutused kohustuvad kaitsma Tahvlis töödeldavaid isikuandmeid ja nende privaatsust.</p> <ol class="terms"> <li>Üldtingimused <ol type="a"> <li>Tahvli kasutamiseks loetakse mistahes Tahvlis asuva teabe või andmehulga kasutamist mistahes viisil või eesmärgil.</li> <li>Tahvli kasutamine on lubatud vaid kõikide kasutustingimustega nõustumise korral. Tahvli kasutamine kinnitab kõikide kausutustingimustega nõustumist.</li> <li>Asutusel on õigus kasutada Tahvlit õppetöö administreerimiseks. Igale Asutusele tehakse Tahvlis Asutuse alamkonto.</li> <li>Tahvlit kasutada sooviv Asutus peab saatma vastavasisulise allkirjaõigusliku isiku poolt digitaalselt allkirjastatud taotluse HITSAsse.</li> <li>Kõikide Asutustega sõlmitakse andmete hoidmise kokkulepe. Kokkuleppes fikseeritakse mh varundamise põhimõtted. Kokkuleppe põhi on kättesaadav: <a href="https://projektid.hitsa.ee/display/IS2" target="_blank" rel="noopener">https://projektid.hitsa.ee/display/IS2</a>.</li> <li>Tahvli kood on avalik, kättesaadav: <a href="https://github.com/hariduspilv/oppeinfo" target="_blank" rel="noopener">https://github.com/hariduspilv/oppeinfo</a>.</li> <li>Tahvli tehniline arhitektuur ja funktsionaalsus on kättesaadav projekti lehelt: <a href="https://projektid.hitsa.ee/display/IS2" target="_blank" rel="noopener">https://projektid.hitsa.ee/display/IS2</a></li> <li>Tahvli külastamine on lubatud vaid üldotstarbeliste internetisirvijatega (Chrome, Mozilla Firefox, Edge, Opera, Safari jt.).</li> <li>Tahvli külastamine eriotstarbeliste programmidega mis tahes eesmärgil on keelatud ilma HITSA eelneva kirjaliku loata. Eriotstarbeline programm on programm, mis ei ole mõeldud üldotstarbeliseks internetisirvimiseks või mille tööd ei kontrolli vahetult inimene. Eriotstarbelisteks programmideks loetakse muuhulgas scripte, roboteid ja automatiseeritud tööriistu või programme, mis ei ole mõeldud internetisirvimiseks.</li> <li>Tahvli kasutamisel ei ole lubatud mistahes tegevused, mis häirivad või takistavad Tahvli kaudu teenuste osutamist, sh peab kasutaja hoiduma arvutivõrgu ja serverite ülekoormamisest.</li> <li>Juhul, kui mõni kasutustingimuste säte on kehtetu vastuolu tõttu seadusega, siis ei mõjuta see ülejäänud kasutustingimuste sätete kehtivust.</li> </ol> </li> <li>Tahvli konto loomine ja kustutamine <ol type="a"> <li>Tahvli konto luuakse isikuke Asutuse poolt. Konto loomiseks peab isik olema Asutusega töölepingulistes või muudes võlaõiguslikes suhetes või õppima Asutuses vastavalt Asutuse õppekorraldust reguleerivatele dokumentidele.</li> <li>Esindusõiguse vajadusega isiku puhul saab toiminguid Tahvlis kinnitada tema seaduslik esindaja. Esindaja sisestamise eest vastutab Asutus.</li> <li>Õpilase kontod luuakse sisseastumise infosüsteemi või Asutuse poolt sisestatud andmete põhjal.</li> <li>Õpetaja konto luuakse majandustarkvara SAP või Asutuse poolt sisestatud andmete põhjal.</li> <li>Administratiivse töötaja konto luuakse Asutuse poolt sisestatud andmete põhjal. Tahvli kasutusele võtmisel sisestab esimese Asutuse administratiivse töötaja HITSA vastavalt Asutuse volitatud isiku poolt esitatud avaldusele.</li> <li>Konto kustutamiseks peab isik esitama taotluse Asutusele, kellega tema konto on seotud. Kontot ei kustutata, kui selle avatud hoidmisel on õiguslik alus (näiteks on konto seotud andmetega, mille säilitamise tähtaeg ei ole saabunud).</li> <li>Peale Konto kustutamist ei ole võimalik Tahvlit kasutada.</li> </ol> </li> <li>Isikuandmete kaitse <ol type="a"> <li>Isikuandmete kogumise ja töötlemise eesmärk on isiku tuvastamine, isikuga seotud õppetöö administreerimine, sh isiku kaasamine õppetöösse ning seal soorituste lisamine ning õppetööga seotud dokumentide koostamine, Asutuste õppetööga seotud statistika koostamine.</li> <li>Tahvel töötleb isikuandmeid kooskõlas Euroopa Parlamendi ja nõukogu määrusega (EL) 2016/679, 27. aprill 2016, füüsiliste isikute kaitse kohta isikuandmete töötlemisel ja selliste andmete vaba liikumise ning direktiivi 95/46/EÜ kehtetuks tunnistamise kohta (isikuandmete kaitse üldmäärus).</li> <li>Isikuandmete töötlemisel rakendatakse kõiki asjakohaseid organisatsioonilisi, tehnilisi ja füüsilisi meetmeid isikuandmete kaitsmiseks.</li> <li>Isikuandmete töötlemine Tahvlis toimub üksnes üle turvalise ühenduse (https). Kasutajad autendivad ID-kaardi, Mobiil-ID või muu riigi poolt tunnustatud identiteedilahenduse ning Asutuse kontohalduse abil.</li> <li>Juurdepääs isikuandmete töötlemiseks on ainult selleks volitatud ja juhendatud isikutel, vastavalt nende tööülesannete täitmiseks vajalikus ulatuses.</li> <li>Isikuandmeid võib isiku nõusolekuta edastada üksnes asutusele või isikule, kellel on selleks otsene seadusest tulenev õigus (näiteks kohus või kohtueelne menetleja) ja põhjendatud vajadus.</li> <li>Isikuandmeid säilitatakse vastavalt haridusasutustele kehtivatele normdokumentidele.</li> <li>Kasutajakonto kustutamisel võivad isikuandmed piiratud aja jooksul säilida Tahvli varukoopias.</li> <li>Kõikides isikuandmete töötlemise küsimustes või seadusest tulenevate õiguste teostamiseks peab pöörduma Asutuse poole, kelle õppetegevuse raames vastavaid isikuandmeid töödeldakse.</li> </ol> </li> <li>Töödeldavad kasutajaandmed <ol type="a"> <li>Tahvlis töödeldakse isikuandmeid Asutuse poolt määratud koosseisus. Andmed on Tahvlisse sisestatud Asutuse poolt, päritud teistest infosüsteemidest või sisestatud kasutaja poolt isiklikult.</li> <li>Õppuri andmetest töödeldakse Tahvlis eelkõige isiku põhiandmeid (nimi, isikukood, sugu, kodakondsus, suhtluskeel), õppimise andmeid (sh sooritused, dokumendid), kontaktandmeid, esindajaid ning vajadusel andmeid eritingimuste kohta.</li> <li>Õpetaja andmetest töödeldakse Tahvlis eelkõige isiku põhiandmeid, Asutusega seotud töökoha andmeid ning õppetöö korraldamisega seotud andmeid.</li> <li>Tahvlis sisalduv detailne andmekoosseis avaldatakse RIHA-s ning on avalikult kättesaadav: <a href="https://www.riha.ee/Infos%C3%BCsteemid/Vaata/ois2" target="_blank" rel="noopener">https://www.riha.ee/Infos%C3%BCsteemid/Vaata/ois2</a></li> <li>Tahvel on andmevahetuskihi X-tee kaudu seotud: <ul> <li>Sisseastumise Infosüsteemiga (SAIS);</li> <li>Eesti Hariduse Infosüsteemiga (EHIS);</li> <li>Kutseregistriga;</li> <li>Majandustarkvaraga SAP (Riigitöötajate iseteenindusportaal).</li> </ul> </li> <li>Tahvel vahetab andmeid üle turvalise SOAP-i sünkroonsete veebiteenuste: <ol type="a"> <li>Eesti Koolide infosüsteemiga (EKIS);</li> <li>HITSA õppeinfosüsteemiga Moodle</li> <li>Plagiaadituvastamise tarkvara KRATT</li> </ol> </li> <li>Tahvel kasutab Maa-ameti aadressandmete süsteemi inADS.</li> <li>Tahvli külastusel kogutakse isikustatud andmeid (logisid) millega isik sisse logis, millist brauserit kasutas ja millal tema sessioon lõppes.</li> <li>Isiku poolt külastatud lehed logitakse vaid veebiserveri tasemel ning on seega isikustamata. Isikustamata tehniliste andmete töötlemisel ei ole ükski konkreetne kasutaja mingil viisil tuvastatav.</li> </ol> </li> <li>Andmete õigsuse tagamine, andmete muutmine ja parandamine <ol type="a"> <li>Tahvlisse esitatud andmete õigsuse eest vastutavad andmete esitaja ja andmete sisestaja.</li> <li>Andmete muutmise õigus on Asutusel, isikul endal ja Asutuse volitusel HITSAl. Kõik andmete muudatused logitakse.</li> <li>Andmete kandmisel Tahvlisse säilitatakse andmed kande tegija kohta ning kande tegemise kuupäev ja kellaaeg.</li> <li>Andmete parandamisel Tahvlis fikseeritakse süsteemi logis paranduse tegemise kuupäev ja paranduse tegija.</li> <li>Kande tegemisena Tahvlis käsitletakse andmete lisamist, andmete muutmist ja kustutamist.</li> <li>Iga Asutus sisestab ainult oma organisatsiooni andmeid.</li> </ol> </li> <li>Osalejate vastutus andmetöötluses <ol type="a"> <li>Tahvel on majutatud HITSA poolt hallatavates ja Eesti territooriumil asuvates serverites. Serverite ja Tahvli tarkvara hooldatakse jooksvalt ajakohaste turvavärskendustega.</li> <li>HITSA vastutab Tahvli tõrgeteta töö ning vajalike arendustööde korraldamise eest, pakub infosüsteemi kasutajatuge, korraldab Tahvlis sisalduvate andmete säilimise ja varukoopiate tegemise.</li> <li>HITSA ei vastuta Tahvli tõrgete eest, mis on põhjustatud HITSA kontrolli alt väljas olevatest asjaoludest.</li> <li>HITSA ei vastuta kasutajate poolt Tahvlisse sisestatud andmete ja dokumentide sisu eest.</li> <li>HITSA võib töödelda kõiki Tahvlis töödeldavaid isikuandmeid infosüsteemi kasutajatoe ja majutusteenuse pakkumiseks.</li> <li>Asutused vastutavad Asutuse õppetööga seotud info haldamise, isikuandmete töötlemise nõuete täitmise (muuhulgas informeerimise kohustuse) ja andmesubjekti päringutele vastamise eest.</li> <li>Asutusel on kohustus tagada Asutuse kasutajate rollide ja õiguste vastavus ning hoida ära volitamata isikute ligipääs Tahvlile ja isikuandmetele.</li> <li>Asutus vastutab enda antud rollide kaudu tekitatud kahju korral, mh andmekaitse nõuete rikkumise ja Tahvli toimimist kahjustavate tegevuste eest.</li> <li>HITSA-l on õigus ühepoolselt piirata või peatada Asutuse või kaustaja juurdepääs Tahvlile, kui esineb reaalne või potentsiaalne oht Tahvli turvalisusele. Asutuse kasutajate juurdepääsu piiramisest või peatamisest teavitab HITSA viivitamata vastavat Asutust ning mõlemad peavad võtma viivitamatult kasutusele meetmed ohu kõrvaldamiseks.</li> <li>Võimalikust andmelekkest teavitab HITSA 72 tunni jooksul kõiki kasutajaid oma veebilehel <a href="https://www.hitsa.ee" target="_blank" rel="noopener">www.hitsa.ee</a>, Tahvli üldteadte all ning Tahvlis toodud e-posti teel isikuid, keda andmeleke puudutas või võis puudutada. Lisaks teavitab HITSA Riigi Infosüsteemi Ametit ja Andmekaitse Inspektsiooni kohase intsidenti raportite vormi kaudu. HITSA võtab lisaks koheselt kasutusele kõik abinõud et välistada lekkinud andmete kasutamine mistahes moel teenuse kasutajate vastu.</li> </ol> </li> </ol> </div> </md-dialog-content> <md-dialog-actions layout="row" layout-align="start center"> <md-button ng-click="cancel()" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </md-dialog-actions> </md-dialog>'),
a.put("contract/contract.edit.html",'<div class="ois-form-layout-padding" ng-cloak> <div flex> <form name="contractForm" ng-submit="save()" layout="column" novalidate> <div ng-if="!studentGroup" flex layout="row" layout-xs="column"> <hois-autocomplete ng-model="contract.student" method="students" name="student" label="student.label" ng-disabled="contract.id || contract.practiceApplication" additional-query-params="{active: true, higher: formState.isHigher, showStudentGroup: true}" flex="70" flex-xs="100" required></hois-autocomplete> <md-button class="md-raised" ng-if="!contract.id || contract.status.code === \'LEPING_STAATUS_S\'" flex="30" flex-xs="100" ng-disabled="!contract.student" ng-click="copyContract()"> {{\'contract.useContractData\' | translate}}</md-button> </div> <div ng-if="studentGroup" flex> <div layout="row"> <div flex="70" layout="column" class="form-readonly"> <br> <md-input-container> <label>{{\'lessonplan.studentGroup\' | translate}}</label> <hois-value value="currentLanguageNameField(studentGroup)"></hois-value> </md-input-container> </div> <md-button class="md-raised" ng-if="!contract.id || contract.status.code === \'LEPING_STAATUS_S\'" flex="30" style="height: 38px" layout="column" ng-disabled="!contract.student" ng-click="copyContract()"> {{\'contract.useContractData\' | translate}}</md-button> </div> <div layout="row" flex="100"> <hois-autocomplete label="student.label" ng-model="contract.student" method="students" additional-query-params="{active: true, studentGroup: studentGroupList}" flex></hois-autocomplete> <md-button flex-offset="5" ng-click="addAllStudents()" class="md-raised">{{"student.addAll" | translate}}</md-button> </div> <md-table-container ng-if="contract.students.length > 0" layout="row" flex="100" style="max-height: 200px"> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column width="90%">{{\'student.plural\' | translate}}</th> <th md-column width="10%"></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="student in contract.students" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{currentLanguageNameField(student)}}</td> <td md-cell> <a ng-click="deleteStudent(student)" class="remove">&times;</a> </td> </tr> </tbody> </table> </md-table-container> </div> <div ng-if="contract.student && formState.student" class="form-readonly" layout="column"> <div>&nbsp;</div> <div layout="row" layout-xs="column" flex> <md-input-container flex> <label>{{\'student.name\' | translate}}</label> <hois-value value="formState.student.person.firstname + \' \' + formState.student.person.lastname"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'student.idcode\' | translate}}</label> <hois-value value="formState.student.person.idcode"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'student.schoolEmail\' | translate}}</label> <hois-value value="formState.student.schoolEmail"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'student.course\' | translate}}</label> <hois-value value="formState.student.course"></hois-value> </md-input-container> </div> <div layout="row" layout-xs="column" flex> <md-input-container flex> <label>{{\'student.curriculum\' | translate}}</label> <hois-value value="currentLanguageNameField(formState.student.curriculumVersion)"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'student.studyForm\' | translate}}</label> <hois-value value="currentLanguageNameField(formState.student.studyForm)"></hois-value> </md-input-container> </div> </div> <div ng-if="!formState.isHigher" ng-repeat="module in contract.moduleSubjects track by $index" layout="row" layout-sm="column" layout-xs="column" flex> <md-input-container flex> <label>{{\'module.practice\' | translate}}</label> <hois-select ng-model="module.module" values="formState.modules" ng-change="moduleChanged(module.module, module)" required></hois-select> </md-input-container> <md-input-container flex flex-offset-gt-md="5"> <label>{{\'contract.theme\' | translate}}</label> <hois-select ng-model="module.theme" values="formState.themesByModuleId[module.module]" ng-change="themeChanged(module.theme, module)"></hois-select> </md-input-container> <md-input-container flex="10" flex-sm="100" flex-xs="100" flex-offset-gt-md="5"> <label>{{\'contract.creditsEKAP\' | translate}}</label> <input type="number" name="credits[{{$index}}]" ng-model="module.credits" ng-min="0" ng-max="999.9" ng-change="updateHours(module, $index)" required> </md-input-container> <md-input-container flex="10" flex-sm="100" flex-xs="100"> <label>{{\'contract.acadHours\' | translate}}</label> <input type="number" name="hours[{{$index}}]" ng-model="module.hours" ng-min="0" ng-max="32767" pattern="^\\d+$" ng-change="updateCredits(module, $index)" required> <div ng-messages="contractForm[\'hours[\'+$index+\']\'].$error" ng-show="contractForm[\'hours[\'+$index+\']\'].$dirty"> <div ng-message="pattern"> {{\'main.messages.error.integer\' | translate}} </div> </div> </md-input-container> <md-input-container flex="10" flex-sm="100" flex-xs="100"> <label>{{\'contract.astroHours\' | translate}}</label> <br> <hois-value value="getAstronomicalHours(module.hours)"></hois-value> </md-input-container> <div flex="10" flex-sm="100" flex-xs="100" class="center"> <a class="remove" ng-click="removeModuleSubject(module)">&times;&nbsp;&nbsp;</a> </div> </div> <div ng-if="!formState.isHigher" layout="row" layout-sm="column" layout-xs="column" flex> <md-button class="md-raised" ng-click="addModuleSubject()">{{\'contract.button.addModule\' | translate}}</md-button> </div> <div ng-if="formState.isHigher" ng-repeat="subject in contract.moduleSubjects track by $index" layout="row" layout-sm="column" layout-xs="column" flex> <md-input-container flex> <label>{{\'contract.subject\' | translate}}</label> <hois-select ng-model="subject.subject" values="formState.subjects" ng-change="subjectChanged(subject.subject, subject)" required></hois-select> </md-input-container> <md-input-container flex="10" flex-sm="100" flex-xs="100" flex-offset-gt-md="5"> <label>{{\'contract.creditsEAP\' | translate}}</label> <input type="number" name="credits[{{$index}}]" ng-model="subject.credits" ng-min="0" ng-max="999.9" ng-change="updateHours(subject, $index)" required> </md-input-container> <md-input-container flex="10" flex-sm="100" flex-xs="100"> <label>{{\'contract.acadHours\' | translate}}</label> <input type="number" name="hours[{{$index}}]" ng-model="subject.hours" ng-min="0" ng-max="32767" pattern="^\\d+$" ng-change="updateCredits(subject, $index)" required> <div ng-messages="contractForm[\'hours[\'+$index+\']\'].$error" ng-show="contractForm[\'hours[\'+$index+\']\'].$dirty"> <div ng-message="pattern"> {{\'main.messages.error.integer\' | translate}} </div> </div> </md-input-container> <md-input-container flex="10" flex-sm="100" flex-xs="100"> <label>{{\'contract.astroHours\' | translate}}</label> <br> <hois-value value="getAstronomicalHours(subject.hours)"></hois-value> </md-input-container> <div flex="10" flex-sm="100" flex-xs="100" class="center"> <a class="remove" ng-click="removeModuleSubject(subject)">&times;&nbsp;&nbsp;</a> </div> </div> <div ng-if="formState.isHigher" layout="row" layout-sm="column" layout-xs="column" flex> <md-button class="md-raised" ng-click="addModuleSubject()">{{\'contract.button.addSubject\' | translate}}</md-button> </div> <div layout="row" flex> <md-input-container> <label>{{\'contract.start\' | translate}}</label> <md-datepicker ng-model="contract.startDate" md-max-date="contract.endDate" required></md-datepicker> </md-input-container> <md-input-container> <label>{{\'contract.end\' | translate}}</label> <md-datepicker ng-model="contract.endDate" md-min-date="contract.startDate" required></md-datepicker> </md-input-container> </div> <div layout="row" flex="100"> <hois-autocomplete flex ng-model="contract.enterprise" method="activeEnterprises" name="enterprise" label="enterprise.label" required ng-disabled="contract.practiceApplication"></hois-autocomplete> </div> <div layout="row" layout-xs="column" flex> <md-input-container flex> <label class="textInput">{{\'contract.contactPersonName\' | translate}}</label> <hois-select ng-model="contract.contactPersonName" values="formState.contacts" ng-change="contactChanged(contract.contactPersonName)" value-property="contactPersonName" show-property="contactPersonName" required></hois-select> </md-input-container> <md-input-container flex style="margin-left: 4px"> <label class="textInput">{{\'contract.contactPersonEmail\' | translate}}</label> <input type="email" ng-model="contract.contactPersonEmail" md-maxlength="100" required> </md-input-container> <md-input-container flex> <label class="textInput">{{\'contract.contactPersonPhone\' | translate}}</label> <input type="text" ng-model="contract.contactPersonPhone" md-maxlength="100"> </md-input-container> </div> <div ng-if="contract.enterprise" layout="row" layout-xs="column"> <md-input-container flex="33" flex-xs="100"> <label>{{\'contract.supervisors\' | translate}}</label> <md-select ng-model="contract.supervisor" flex ng-required="contract.supervisors === undefined || contract.supervisors.length == 0"> <md-option ng-repeat="val in supervisors" ng-value="val">{{val.supervisorName}}</md-option> </md-select> </md-input-container> <md-button class="md-raised" ng-click="addEmptySupervisor()">{{\'contract.addNewSupervisor\' | translate}}</md-button> </div> <div layout="row" flex="100"> <md-table-container ng-if="contract.supervisors.length > 0" flex="100"> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column width="25%">{{\'contract.supervisorName\' | translate}}</th> <th md-column width="25%">{{\'contract.supervisorEmail\' | translate}}</th> <th md-column width="25%">{{\'contract.supervisorPhone\' | translate}}</th> <th md-column width="10%"></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="contractSupervisor in contract.supervisors" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell> <div layout="row" ng-if="!contractSupervisor.manually"> <md-input-container flex> <label></label> <input ng-model="contractSupervisor.supervisorName" disabled> </md-input-container> </div> <div layout="row" ng-if="contractSupervisor.manually" style="min-width: 240px"> <md-input-container flex> <label>{{\'contract.supervisorFirstname\' | translate}}</label> <input ng-model="contractSupervisor.supervisorFirstname" ng-required="contractSupervisor.manually" md-maxlength="99 - contractSupervisor.supervisorLastname.length"> </md-input-container> <md-input-container flex> <label>{{\'contract.supervisorLastname\' | translate}}</label> <input ng-model="contractSupervisor.supervisorLastname" ng-required="contractSupervisor.manually" md-maxlength="99 - contractSupervisor.supervisorFirstname.length"> </md-input-container> </div> </td> <td md-cell> <div layout="row"> <md-input-container flex> <label></label> <input aria-label="contract.supervisorEmail" name="email" type="email" ng-model="contractSupervisor.supervisorEmail" md-maxlength="100"> <div ng-messages="contractForm.email.$error"> <div ng-message="md-maxlength"> {{\'main.messages.error.maxlength\' | translate}} </div> </div> </md-input-container> </div> </td> <td md-cell> <div layout="row"> <md-input-container flex> <input aria-label="contract.supervisorPhone" name="phone" pattern="^\\d+$" type="text" ng-model="contractSupervisor.supervisorPhone" md-maxlength="100"> <div ng-messages="contractForm.phone.$error"> <div ng-message="md-maxlength"> {{\'main.messages.error.maxlength\' | translate}} </div> <div ng-message="pattern"> {{\'enterprise.personsTab.number\' | translate}} </div> </div> </md-input-container> </div> </td> <td md-cell> <a ng-if="contract.status.code === undefined || contract.status.code === \'LEPING_STAATUS_S\'" ng-click="deleteSupervisor(contractSupervisor)" class="remove">&times;</a> </td> </tr> </tbody> </table> </md-table-container> </div> <fieldset flex="100"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'contract.practicePlace\' | translate}}</legend> <div layout="column"> <md-input-container flex> <md-checkbox ng-checked="!contract.isPracticeTelework && !contract.isPracticeEnterprise && !contract.isPracticeOther" ng-model="contract.isPracticeSchool"> {{\'contract.practicePlaceSchool\' | translate}}</md-checkbox> </md-input-container> <md-input-container flex> <md-checkbox ng-checked="!contract.isPracticeSchool && !contract.isPracticeEnterprise && !contract.isPracticeOther" ng-model="contract.isPracticeTelework"> {{\'contract.practicePlaceDistanceWork\' | translate}}</md-checkbox> </md-input-container> <md-input-container flex> <md-checkbox ng-change="contract.practicePlace = null" ng-checked="!contract.isPracticeTelework && !contract.isPracticeSchool && !contract.isPracticeOther" ng-model="contract.isPracticeEnterprise"> {{\'contract.practicePlaceEnterprise\' | translate}}</md-checkbox> </md-input-container> <div layout="row" ng-if="contract.isPracticeEnterprise && contract.enterprise" flex> <md-input-container flex> <label>{{\'contract.practicePlaceEnterpriseLocation\' | translate}}</label> <hois-select ng-model="contract.practicePlace" values="formState.enterpriseLocations" value-property="nameEt" required></hois-select> </md-input-container> </div> <md-input-container flex> <md-checkbox ng-change="contract.practicePlace = null" ng-checked="!contract.isPracticeSchool && !contract.isPracticeTelework && !contract.isPracticeEnterprise" ng-model="contract.isPracticeOther"> {{\'contract.practicePlaceElse\' | translate}}</md-checkbox> </md-input-container> <div layout="row" ng-if="contract.isPracticeOther" flex> <md-input-container flex> <label class="textInput">{{\'contract.otherPlace\' | translate}}</label> <input type="text" ng-model="contract.practicePlace" md-maxlength="255" required> </md-input-container> </div> </div> </fieldset> <hois-autocomplete ng-model="contract.teacher" method="teachers" name="techers" label="contract.schoolSupervisor" additional-query-params="{valid: true}" required></hois-autocomplete> <div layout="row" ng-if="!auth.school.withoutEkis" flex> <md-input-container flex> <label>{{\'contract.contractCoordinator\' | translate}}</label> <hois-select ng-model="contract.contractCoordinator" type="directivecoordinator" required></hois-select> </md-input-container> </div> <div layout="row" flex> <md-input-container flex> <label class="textInput">{{\'contract.practicePlan\' | translate}}</label> <textarea ng-model="contract.practicePlan" required md-maxlength="20000" max-rows="4"></textarea> </md-input-container> </div> <div layout="row" flex> <md-input-container flex> <label>{{\'contract.supervisorEvaluation\' | translate}}</label> <hois-select ng-model="contract.practiceEvaluation" type="practiceEvaluation" criteria="{active: true, targetCode: \'PRAKTIKA_SIHTRYHM_E\'}" value-property="id" display-property="nameEt"></hois-select> </md-input-container> </div> <div layout="row" flex> <md-input-container flex> <label>{{\'contract.studentEvaluation\' | translate}}</label> <hois-select ng-model="contract.studentPracticeEvaluation" type="practiceEvaluation" criteria="{active: true, targetCode: \'PRAKTIKA_SIHTRYHM_O\'}" value-property="id" display-property="nameEt"></hois-select> </md-input-container> </div> <div ng-if="!formState.isHigher" layout="column" flex> <md-input-container flex> <md-checkbox ng-model="contract.isPracticeAbsence" ng-change="isPracticeAbsenceChanged()" aria-label="{{\'contract.markPracticeAsAtPractice\' | translate}}"> {{\'contract.markPracticeAsAtPractice\' | translate}}</md-checkbox> </md-input-container> <md-input-container flex> <md-checkbox ng-model="contract.isPracticeHidden" ng-change="isPracticeHiddenChanged()" aria-label="{{\'contract.markPracticeAsExcused\' | translate}}"> {{\'contract.markPracticeAsExcused\' | translate}}</md-checkbox> </md-input-container> </div> <div layout="row" ng-if="contract.status" class="form-readonly" style="padding-top: 10px"> <md-input-container flex> <label>{{\'contract.status\' | translate}}</label> <hois-value value="currentLanguageNameField(contract.status)"></hois-value> </md-input-container> </div> <div layout="row" layout-xs="column"> <md-button ng-if="contract.status.code !== \'LEPING_STAATUS_Y\'" class="md-raised md-primary" type="submit">{{\'main.button.save\' | translate}}</md-button> <md-button ng-if="auth.isAdmin() && contract.id && (contract.status.code === \'LEPING_STAATUS_Y\' || contract.status.code === \'LEPING_STAATUS_S\')" class="md-raised md-default" ng-click="delete()">{{\'main.button.delete\' | translate}}</md-button> <md-button ng-if="contract.id && (contract.status.code === \'LEPING_STAATUS_Y\' || contract.status.code === \'LEPING_STAATUS_S\' || contract.status.code === \'LEPING_STAATUS_K\')" class="md-raised md-default" ng-href="{{printUrl()}}" target="_blank">{{"main.button.print" | translate}}</md-button> <md-button class="md-raised md-default" ng-click="back(\'#/contracts/\', contractForm)">{{\'main.button.back\' | translate}}</md-button> <md-button ng-if="contract.id && contract.status.code === \'LEPING_STAATUS_S\' && !auth.school.withoutEkis" class="md-raised md-default" ng-click="sendToEkis()">{{\'main.button.sendToEkis\' | translate}}</md-button> <md-button ng-if="contract.id && contract.status.code === \'LEPING_STAATUS_S\' && auth.school.withoutEkis" class="md-raised md-default" ng-click="confirmWithoutEkis()">{{\'contract.confirmWithoutEkis\' | translate}}</md-button> </div> </form> </div> </div> <style>td:first-child div.layout-row button.md-button {\r\n    min-height: 8px;\r\n    min-width: 8px;\r\n  }</style>'),a.put("contract/contract.list.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <fieldset ng-if="auth.isAdmin()"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <form name="searchForm" ng-submit="searchForm.$valid && loadAndSave()" novalidate class="nomargin" ng-model-options="{allowInvalid: true}"> <div layout="row" layout-sm="column" layout-xs="column"> <div flex="45" flex-sm="100" flex-xs="100"> <div layout="column" flex> <div layout="row" flex> <md-input-container> <label>{{\'contract.startFrom\' | translate}}</label> <md-datepicker ng-model="criteria.startFrom" md-max-date="criteria.startThru" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> <md-input-container flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'contract.startThru\' | translate}}</label> <md-datepicker ng-model="criteria.startThru" md-min-date="criteria.startFrom" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> </div> </div> </div> <div flex="45" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <div layout="column" flex> <div layout="row" flex> <md-input-container> <label>{{\'contract.endFrom\' | translate}}</label> <md-datepicker ng-model="criteria.endFrom" md-max-date="criteria.endThru" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> <md-input-container flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'contract.endThru\' | translate}}</label> <md-datepicker ng-model="criteria.endThru" md-min-date="criteria.endFrom" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> </div> </div> </div> </div> <div layout="row" layout-sm="column" layout-xs="column"> <div flex="45" flex-sm="100" flex-xs="100"> <div layout="column" flex> <md-input-container> <label class="textInput">{{\'student.label\' | translate}}</label> <input ng-model="criteria.studentName" type="text" md-maxlength="255"> </md-input-container> </div> </div> <div flex="45" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <div layout="column" flex> <md-input-container> <label class="textInput">{{\'contract.curriculumVersion\' | translate}}</label> <hois-select ng-model="criteria.curriculumVersion" type="curriculumversion"></hois-select> </md-input-container> </div> </div> </div> <div layout="row" layout-sm="column" layout-xs="column"> <div flex="45" flex-sm="100" flex-xs="100"> <hois-autocomplete flex ng-model="criteria.studentGroup" ha-attribute="id" ha-controller="directiveControllers" method="studentgroups" additional-query-params="{valid: true}" label="{{\'studentGroup.label\'}}"></hois-autocomplete> </div> </div> <div layout="row" layout-sm="column" layout-xs="column"> <div flex="45" flex-sm="100" flex-xs="100"> <div layout="column" flex> <md-input-container> <label class="textInput">{{\'enterprise.label\' | translate}}</label> <input ng-model="criteria.enterpriseName" type="text" md-maxlength="255"> </md-input-container> </div> </div> <div flex="45" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <div layout="column" flex> <md-input-container> <label class="textInput">{{\'enterprise.supervisor\' | translate}}</label> <input ng-model="criteria.enterpriseContactPersonName" type="text" md-maxlength="255"> </md-input-container> </div> </div> </div> <div layout="row" layout-sm="column" layout-xs="column"> <div flex="45" flex-sm="100" flex-xs="100"> <div layout="column" flex> <md-input-container> <label class="textInput">{{\'contract.status\' | translate}}</label> <hois-classifier-select ng-model="criteria.status" main-classifier-code="LEPING_STAATUS" model-value-attr="code" multiple></hois-classifier-select> </md-input-container> </div> </div> <div flex="45" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <div layout="column" flex> <md-input-container> <label class="textInput">{{\'contract.schoolSupervisor\' | translate}}</label> <hois-select ng-model="criteria.teacher" type="teacher"></hois-select> </md-input-container> </div> </div> </div> <div layout="row" layout-xs="column"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> <md-button ng-if="!auth.isStudent() && isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_LEPING\')" class="md-raised" ng-click="newContract()">{{\'main.button.create\' | translate}}</md-button> <md-button ng-if="auth.isAdmin() && tabledata.content && !auth.school.withoutEkis" md-no-ink class="md-raised" ng-click="sendToEkis()">{{\'contract.sendToEkis\' | translate}}</md-button> </div> <div flex-xs="0" flex-gt-xs="0" flex-gt-sm="50"></div> </form> </fieldset> </div> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th ng-if="auth.isAdmin()" md-column md-order-by="student_person.lastname,student_person.firstname">{{\'student.label\' | translate}}</th> <th md-column>{{\'contract.contractNumber\' | translate}}</th> <th md-column>{{\'contract.validity\' | translate}}</th> <th md-column>{{\'studentGroup.label\' | translate}}</th> <th md-column>{{\'enterprise.label\' | translate}}</th> <th md-column>{{\'contract.supervisors\' | translate}}</th> <th md-column>{{\'contract.schoolSupervisor\' | translate}}</th> <th md-column>{{\'contract.contractDate\' | translate}}</th> <th md-column>{{\'main.status\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td ng-if="auth.isAdmin()" md-cell>{{currentLanguageNameField(row.student)}}</td> <td md-cell>{{row.contractNr}}</td> <td md-cell>{{row.startDate | hoisDate}} - {{row.endDate | hoisDate}}</td> <td md-cell>{{row.studentGroup}}</td> <td md-cell>{{row.enterpriseName}}</td> <td md-cell>{{row.enterpriseContactPersonName}}</td> <td md-cell>{{currentLanguageNameField(row.teacher)}}</td> <td md-cell>{{row.confirmDate | hoisDate}}</td> <td md-cell>{{currentLanguageNameField(row.status)}}</td> <td md-cell> <div ng-if="auth.isStudent()"> <md-button md-no-ink class="md-primary change-button" ng-href="#/contracts/{{::row.id}}/view">{{\'main.button.view\' | translate}}</md-button> </div> <div ng-if="!auth.isStudent()"> <md-button ng-if="row.status.code === \'LEPING_STAATUS_S\' && isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_LEPING\')" md-no-ink class="md-primary change-button" ng-href="#/contracts/{{::row.id}}/edit">{{\'main.button.change\' | translate}}</md-button> <md-button ng-if="row.status.code !== \'LEPING_STAATUS_S\' || !isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_LEPING\')" md-no-ink class="md-primary change-button" ng-href="#/contracts/{{::row.id}}/view">{{\'main.button.view\' | translate}}</md-button> </div> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> </div>'),a.put("contract/contract.select.dialog.html",'<md-dialog aria-label="select contract dialog"> <form name="dialogForm" ng-submit="loadData()" novalidate ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2 flex>{{"contract.select" | translate}}</h2> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <div class="ois-form-layout" layout="column" layout-margin ng-cloak> <div layout="row"> <hois-autocomplete flex ng-model="studentGroup" method="studentgroups" name="studentGroup" label="{{\'lessonplan.studentGroup\'}}"></hois-autocomplete> <hois-autocomplete flex ng-model="student" method="students" name="students" label="{{\'document.student\'}}"></hois-autocomplete> </div> <div layout="row"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> </div> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column></th> <th md-column md-order-by="student_person.lastname,student_person.firstname">{{\'student.label\' | translate}}</th> <th md-column>{{\'studentGroup.label\' | translate}}</th> <th md-column>{{\'contract.contractNumber\' | translate}}</th> <th md-column>{{\'contract.validity\' | translate}}</th> <th md-column>{{\'enterprise.label\' | translate}}</th> <th md-column>{{\'main.status\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell> <md-input-container> <md-checkbox ng-model="row.checked" ng-click="deselect(row)" aria-label="check row"></md-checkbox> </md-input-container> </td> <td md-cell>{{currentLanguageNameField(row.student)}}</td> <td md-cell>{{row.studentGroup}}</td> <td md-cell>{{row.contractNr ? row.contractNr : \'-\' }}</td> <td md-cell>{{row.startDate | hoisDate}} - {{row.endDate | hoisDate}}</td> <td md-cell>{{row.enterpriseName}}</td> <td md-cell>{{currentLanguageNameField(row.status)}}</td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> </div> </md-dialog-content> <md-dialog-actions layout="row" layout-align="start start"> <md-button class="md-raised" ng-click="checkChecked()">{{"contract.copy" | translate}}</md-button> </md-dialog-actions> </form> </md-dialog>'),a.put("contract/contract.view.html",'<div class="ois-form-layout-padding" ng-cloak> <div flex> <div layout="column"> <form name="contractForm" layout="column" novalidate> <div layout="row" layout-sm="column" layout-xs="column" flex> <div layout="column" flex="50" flex-xs="100" class="form-readonly"> <br> <md-input-container> <label>{{\'student.label\' | translate}}</label> <hois-value value="currentLanguageNameField(contract.student)"></hois-value> </md-input-container> </div> <div layout="row" flex="50" flex-xs="100" ng-if="auth.isAdmin() && \r\n          (contract.status.code === \'LEPING_STAATUS_Y\' || contract.status.code === \'LEPING_STAATUS_K\') && \r\n          isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_LEPING\')"> <md-input-container flex="100"> <label>{{\'contract.contractNumber\' | translate}}</label> <input ng-model="contract.contractNr" md-maxlength="20" ng-blur="changeContractNr()" ng-change="disableSave()"> </md-input-container> </div> </div> <div class="form-readonly"> <md-table-container ng-if="!formState.isHigher"> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column width="35%">{{\'module.practice\' | translate}}</th> <th md-column width="35%">{{\'contract.theme\' | translate}}</th> <th md-column width="10%">{{\'contract.creditsEKAP\' | translate}}</th> <th md-column width="10%">{{\'contract.acadHours\' | translate}}</th> <th md-column width="10%">{{\'contract.astroHours\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="module in contract.moduleSubjects" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{currentLanguageNameField(module.module)}}</td> <td md-cell>{{currentLanguageNameField(module.theme)}}</td> <td md-cell>{{::module.credits}}</td> <td md-cell>{{::module.hours}}</td> <td md-cell>{{getAstronomicalHours(module.hours)}}</td> </tr> </tbody> </table> </md-table-container> <md-table-container ng-if="formState.isHigher"> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column width="70%">{{\'contract.subject\' | translate}}</th> <th md-column width="10%">{{\'contract.creditsEAP\' | translate}}</th> <th md-column width="10%">{{\'contract.acadHours\' | translate}}</th> <th md-column width="10%">{{\'contract.astroHours\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="subject in contract.moduleSubjects" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{currentLanguageNameField(subject.subject)}}</td> <td md-cell>{{::subject.credits}}</td> <td md-cell>{{::subject.hours}}</td> <td md-cell>{{getAstronomicalHours(subject.hours)}}</td> </tr> </tbody> </table> </md-table-container> <br> <div layout="row" layout-sm="column" layout-xs="column" flex> <md-input-container flex="15" flex-xs="100"> <label>{{\'contract.start\' | translate}}</label> <hois-value value="contract.startDate | hoisDate"></hois-value> </md-input-container> <md-input-container flex="15" flex-xs="100" flex-offset-gt-md="5"> <label>{{\'contract.end\' | translate}}</label> <hois-value value="contract.endDate | hoisDate"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column" flex> <md-input-container flex> <label class="textInput">{{\'enterprise.label\' | translate}}</label> <hois-value value="currentLanguageNameField(contract.enterprise)"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column" flex> <md-input-container flex> <label class="textInput">{{\'contract.contactPersonName\' | translate}}</label> <hois-value value="contract.contactPersonName"></hois-value> </md-input-container> <md-input-container flex> <label class="textInput">{{\'contract.contactPersonEmail\' | translate}}</label> <hois-value value="contract.contactPersonEmail"></hois-value> </md-input-container> <md-input-container flex> <label class="textInput">{{\'contract.contactPersonPhone\' | translate}}</label> <hois-value value="contract.contactPersonPhone"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column" flex> <md-input-container flex style="margin-bottom:0px; padding-bottom: 0px"> <label class="textInput">{{\'contract.supervisors\' | translate}}</label> </md-input-container> </div> <md-table-container ng-if="contract.supervisors.length > 0" layout="row" flex="100"> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column width="25%">{{\'contract.supervisorName\' | translate}}</th> <th md-column width="25%">{{\'contract.supervisorEmail\' | translate}}</th> <th md-column width="25%">{{\'contract.supervisorPhone\' | translate}}</th> <th md-column width="25%" ng-if="(contract.status.code === \'LEPING_STAATUS_Y\' || contract.status.code === \'LEPING_STAATUS_K\'\r\n            || contract.status.code === \'LEPING_STAATUS_L\' || contract.status.code === \'LEPING_STAATUS_T\') && auth.isAdmin()"></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="contractSupervisor in contract.supervisors" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{contractSupervisor.supervisorName}}</td> <td md-cell>{{contractSupervisor.supervisorEmail}}</td> <td md-cell>{{contractSupervisor.supervisorPhone}}</td> <td ng-if="(contract.status.code === \'LEPING_STAATUS_Y\' || contract.status.code === \'LEPING_STAATUS_K\'\r\n            || contract.status.code === \'LEPING_STAATUS_L\' || contract.status.code === \'LEPING_STAATUS_T\') && auth.isAdmin()" md-cell> <div layout="row"> <div flex="50" style="margin: auto"> <a target="_blank" style="word-wrap: break-word" ng-click="openInNewTab(contractSupervisor.supervisorUrl)">{{\'contract.openPracticeJournal\' | translate}}</a> </div> <div flex="50" style="margin: auto"> <a ng-click="sendEmailAgain(contractSupervisor.id, contractSupervisor.supervisorUrl)">{{\'contract.sendAgain\' | translate}}</a> </div> </div> </td> </tr> </tbody> </table> </md-table-container> <div ng-if="contract.isPracticeSchool || contract.isPracticeTelework || contract.isPracticeEnterprise || contract.isPracticeOther"> <fieldset flex="100"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'contract.practicePlace\' | translate}}</legend> <div layout="column"> <md-input-container flex ng-if="contract.isPracticeSchool" style="margin-bottom: 0px"> <md-checkbox ng-model="contract.isPracticeSchool" disabled style="margin-bottom: 0px" flex> {{\'contract.practicePlaceSchool\' | translate}}</md-checkbox> </md-input-container> <md-input-container flex ng-if="contract.isPracticeTelework" style="margin-bottom: 0px"> <md-checkbox ng-model="contract.isPracticeTelework" disabled style="margin-bottom: 0px"> {{\'contract.practicePlaceDistanceWork\' | translate}}</md-checkbox> </md-input-container> <md-input-container flex ng-if="contract.isPracticeEnterprise"> <md-checkbox ng-model="contract.isPracticeEnterprise" disabled style="margin-bottom: 0px"> {{\'contract.practicePlaceEnterprise\' | translate}}</md-checkbox> </md-input-container> <div layout="row" ng-if="contract.isPracticeEnterprise" flex> <md-input-container flex style="margin-bottom: 0px"> <label>{{\'contract.practicePlaceEnterpriseLocation\' | translate}}</label> <hois-value value="contract.practicePlace"></hois-value> </md-input-container> </div> <md-input-container flex ng-if="contract.isPracticeOther"> <md-checkbox ng-model="contract.isPracticeOther" disabled style="margin-bottom: 0px"> {{\'contract.practicePlaceElse\' | translate}}</md-checkbox> </md-input-container> <div layout="row" ng-if="contract.isPracticeOther" flex> <md-input-container flex style="margin-bottom: 0px"> <label class="textInput">{{\'contract.otherPlace\' | translate}}</label> <hois-value value="contract.practicePlace"></hois-value> </md-input-container> </div> </div> </fieldset> </div> <div style="margin-top:20px" layout="row" layout-sm="column" layout-xs="column" flex> <md-input-container flex> <label class="textInput">{{\'contract.schoolSupervisor\' | translate}}</label> <hois-value value="currentLanguageNameField(contract.teacher)"></hois-value> </md-input-container> </div> <div layout="row" ng-if="!auth.school.withoutEkis" layout-sm="column" layout-xs="column" flex> <md-input-container flex> <label class="textInput">{{\'contract.contractCoordinator\' | translate}}</label> <hois-value value="currentLanguageNameField(contract.contractCoordinator)"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column" flex> <md-input-container flex> <label class="textInput">{{\'contract.practicePlan\' | translate}}</label> <hois-value value="contract.practicePlan"></hois-value> </md-input-container> </div> <div layout="row" flex> <md-input-container flex> <label>{{\'contract.supervisorEvaluation\' | translate}}</label> <hois-value value="currentLanguageNameField(contract.practiceEvaluation)"></hois-value> </md-input-container> </div> <div layout="row" flex> <md-input-container flex> <label>{{\'contract.studentEvaluation\' | translate}}</label> <hois-value value="currentLanguageNameField(contract.studentPracticeEvaluation)"></hois-value> </md-input-container> </div> <div ng-if="!formState.isHigher" layout="column" flex> <md-input-container flex> <label>{{\'contract.markPracticeAsAtPractice\' | translate}}</label> <hois-value value="contract.isPracticeAbsence ? \'main.yes\' : \'main.no\' | translate"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'contract.markPracticeAsExcused\' | translate}}</label> <hois-value value="contract.isPracticeHidden ? \'main.yes\' : \'main.no\' | translate"></hois-value> </md-input-container> </div> <div layout="row" class="form-readonly"> <md-input-container flex> <label>{{\'contract.status\' | translate}}</label> <hois-value value="currentLanguageNameField(contract.status)"></hois-value> </md-input-container> </div> <div ng-if="!showCancelBoolean && contract.canceledBy !== null" layout="column"> <fieldset class="form-readonly" flex="100"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'contract.cancelInfo\' | translate}}</legend> <div layout="row" style="padding-top:15px"> <div flex="50"> <md-input-container style="width: 100%"> <label>{{\'practice.contract.date\' | translate}}</label> <hois-value value="contract.canceled | hoisDate"></hois-value> </md-input-container> </div> <div flex="50"> <md-input-container style="width: 100%"> <label>{{\'contract.canceledBy\' | translate}}</label> <hois-value value="contract.canceledBy"></hois-value> </md-input-container> </div> </div> <div layout="row"> <md-input-container style="width: 100%"> <label class="textInput">{{\'practice.contract.cancelReason\' | translate}}</label> <hois-classifier-value ng-model="contract.cancelReason" required model-value-attr="code" main-classifier-code="LEPING_TYH_POHJUS"></hois-classifier-value> </md-input-container> </div> <div layout="row"> <md-input-container flex> <label class="textInput">{{\'enterprise.admissionTab.addInfo\' | translate}}</label> <hois-value value="contract.cancelDesc"></hois-value> </md-input-container> </div> </fieldset> </div> </div> <div ng-if="showCancelBoolean && contract.canceledBy === null" layout="column"> <fieldset flex="100"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'contract.cancelInfo\' | translate}}</legend> <div layout="row"> <md-input-container flex="50"> <label class="textInput">{{\'practice.contract.cancelReason\' | translate}}</label> <hois-classifier-select ng-model="contract.cancelReason" required model-value-attr="code" main-classifier-code="LEPING_TYH_POHJUS"></hois-classifier-select> </md-input-container> <div class="form-readonly" flex> <div> <md-input-container style="margin-top: 20px;width: 100%"> <label>{{\'practice.contract.date\' | translate}}</label> <hois-value value="contract.canceled | hoisDate"></hois-value> </md-input-container> </div> </div> </div> <div layout="row"> <md-input-container flex> <label class="textInput">{{\'enterprise.admissionTab.addInfo\' | translate}}</label> <input name="info" ng-model="contract.cancelDesc" md-maxlength="4000" ng-required="contract.cancelReason === \'LEPING_TYH_POHJUS_M\'"> </md-input-container> </div> <div layout="row"> <md-button class="md-raised md-primary" ng-click="save()" ng-disabled="disablesave">{{\'main.button.save\' | translate}}</md-button> <md-button class="md-raised" ng-click="showCancel()">{{\'main.button.cancel\' | translate}}</md-button> </div> </fieldset> </div> <div layout="row" layout-xs="column"> <md-button ng-if="auth.isAdmin() && (contract.status.code === \'LEPING_STAATUS_Y\')\r\n          && isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_LEPING\') && auth.school.withoutEkis" ng-disabled="disablesave" class="md-raised" ng-click="confirm()">{{\'contract.confirm\' | translate}}</md-button> <md-button ng-if="contract.id && (contract.status.code === \'LEPING_STAATUS_Y\' || contract.status.code === \'LEPING_STAATUS_S\'\r\n          || contract.status.code === \'LEPING_STAATUS_K\')" class="md-raised md-default" ng-href="{{printUrl()}}" target="_blank"> {{"main.button.print" | translate}}</md-button> <md-button class="md-raised md-default" ng-click="back(\'#/contracts/\')">{{\'main.button.back\' | translate}}</md-button> <md-button ng-if="(auth.isAdmin() && contract.status.code === \'LEPING_STAATUS_Y\' || contract.status.code=== \'LEPING_STAATUS_S\')\r\n          && isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_LEPING\')" class="md-raised" ng-click="delete()">{{\'main.button.delete\' | translate}}</md-button> <md-button ng-if="contract.wdId && (contract.status.code === \'LEPING_STAATUS_Y\' || contract.status.code === \'LEPING_STAATUS_L\' || contract.status.code === \'LEPING_STAATUS_K\') &&\r\n          !auth.school.withoutEkis" class="md-raised md-default" ng-href="{{getEkisContractUrl(contract.wdId)}}" target="_blank">{{\'contract.button.viewContractFromEkis\' | translate}}</md-button> <md-button ng-if="auth.isAdmin() && (contract.status.code === \'LEPING_STAATUS_Y\' || contract.status.code === \'LEPING_STAATUS_K\')\r\n        && isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_LEPING\') && contract.canceledBy === null" class="md-raised" ng-click="showCancel()">{{\'contract.cancel\' | translate}}</md-button> </div> </form> </div> </div> </div>'),
a.put("contract/enterprise.add.dialog.html",'<md-dialog aria-label="add enterprise dialog" flex="50"> <form name="dialogForm" ng-submit="dialogForm.$valid && submit()" novalidate ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2 flex>{{"enterprise.create" | translate}}</h2> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <div class="md-dialog-content"> <div layout="column" flex> <md-input-container flex> <label class="textInput">{{\'enterprise.name\' | translate}}</label> <input type="text" ng-model="enterprise.name" required> </md-input-container> <md-input-container flex> <label class="textInput">{{\'enterprise.regCode\' | translate}}</label> <input type="text" ng-model="enterprise.regCode" required> </md-input-container> <md-input-container flex> <label class="textInput">{{\'enterprise.contactPersonName\' | translate}}</label> <input type="text" ng-model="enterprise.contactPersonName"> </md-input-container> <md-input-container flex> <label class="textInput">{{\'enterprise.contactPersonPhone\' | translate}}</label> <input type="number" ng-model="enterprise.contactPersonPhone"> </md-input-container> <md-input-container flex> <label class="textInput">{{\'enterprise.contactPersonEmail\' | translate}}</label> <input type="email" ng-model="enterprise.contactPersonEmail"> </md-input-container> </div> </div> </md-dialog-content> <md-dialog-actions layout="row" layout-align="start start"> <md-button class="md-raised md-primary" type="submit">{{\'main.button.save\' | translate}}</md-button> <md-button class="md-raised" ng-click="cancel()">{{"main.button.close" | translate}}</md-button> </md-dialog-actions> </form> </md-dialog>'),a.put("contract/vocational.higher.select.dialog.html",'<md-dialog aria-label="vaocational higher select dialog"> <form name="dialogForm" ng-submit="dialogForm.$valid && submit()" novalidate ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2 flex>{{"contract.vocationalOrHigherSelect" | translate}}</h2> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <div class="md-dialog-content"> {{"contract.vocationalOrHigherContract" | translate}} </div> </md-dialog-content> <md-dialog-actions layout="row" layout-align="start start"> <md-button class="md-raised" type="submit">{{\'contract.button.vocational\' | translate}}</md-button> <md-button class="md-raised" type="submit" ng-click="higher=true">{{"contract.button.higher" | translate}}</md-button> </md-dialog-actions> </form> </md-dialog>'),a.put("curriculum/curriculum.list.html",'<div class="ois-form-layout-padding"> <div flex> <form name="searchForm" layout="column" ng-cloak ng-submit="searchForm.$valid && loadData()" class="nomargin" ng-model-options="{allowInvalid: true}"> <fieldset tabindex="1"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <div layout="row" layout-sm="column" layout-xs="column" ng-if="!auth.school"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label>{{\'school.label\' | translate}}</label> <hois-select ng-model="criteria.school" type="school" multiple></hois-select> </md-input-container> <md-input-container flex="50" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'curriculum.studyLevel\' | translate}}</label> <hois-classifier-select ng-model="criteria.studyLevel" multiple main-classifier-code="OPPEASTE" model-value-attr="code"></hois-classifier-select> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column" ng-if="auth.school"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label>{{\'curriculum.studyLevel\' | translate}}</label> <hois-classifier-select ng-model="criteria.studyLevel" multiple main-classifier-code="OPPEASTE" model-value-attr="code" show-only-values="studyLevelOptions"></hois-classifier-select> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column" class="top-margin"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label>{{\'curriculum.name\' | translate}}</label> <input ng-model="criteria.name" type="text" md-maxlength="255"> </md-input-container> <md-input-container flex="50" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'curriculum.ekrLevel\' | translate}}</label> <hois-classifier-select ng-model="criteria.ekrLevel" multiple main-classifier-code="EKR" model-value-attr="code"></hois-classifier-select> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label>{{\'curriculum.code\' | translate}}</label> <input ng-model="criteria.code" type="text" md-maxlength="100"> </md-input-container> <md-input-container flex="50" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'curriculum.merCode\' | translate}}</label> <input ng-model="criteria.merCode" type="text" md-maxlength="100"> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column" ng-if="school.higher && school.vocational"> <md-input-container flex="20" flex-sm="100" flex-xs="100"> <label>{{\'curriculum.curriculumGroup\' | translate}}</label> <hois-classifier-select ng-model="criteria.curriculumGroup" model-value-attr="code" main-classifier-code="OPPEKAVAGRUPP" ng-disabled="criteria.iscedClassCode && criteria.iscedClassCode.length > 0"></hois-classifier-select> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'curriculum.areaOfStudy\' | translate}}</label> <hois-classifier-select ng-model="criteria.iscedVald" model-value-attr="code" main-classifier-code="ISCED_VALD" show-only-values="areasOfStudy"></hois-classifier-select> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'curriculum.fieldOfStudy\' | translate}}</label> <hois-classifier-select ng-model="criteria.iscedSuun" model-value-attr="code" main-classifier-code="ISCED_SUUN" watch-model="criteria.iscedVald" filter-values search-from-connect connect-main-classifier-code="ISCED_VALD" multiple></hois-classifier-select> </md-input-container> <md-input-container flex="25" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'curriculum.group\' | translate}}</label> <hois-classifier-select ng-model="criteria.iscedClassCode" model-value-attr="code" main-classifier-code="ISCED_RYHM" watch-model="criteria.iscedSuun" filter-values search-from-connect connect-main-classifier-code="ISCED_SUUN" multiple ng-disabled="criteria.curriculumGroup"></hois-classifier-select> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column" ng-if="school.vocational && !school.higher"> <md-input-container flex="30" flex-sm="100" flex-xs="100"> <label>{{\'curriculum.areaOfStudy\' | translate}}</label> <hois-classifier-select ng-model="criteria.iscedVald" model-value-attr="code" main-classifier-code="ISCED_VALD" criteria="{vocational: true}"></hois-classifier-select> </md-input-container> <md-input-container flex="30" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'curriculum.fieldOfStudy\' | translate}}</label> <hois-classifier-select ng-model="criteria.iscedSuun" model-value-attr="code" main-classifier-code="ISCED_SUUN" watch-model="criteria.iscedVald" filter-values search-from-connect connect-main-classifier-code="ISCED_VALD" multiple criteria="{vocational: true}"></hois-classifier-select> </md-input-container> <md-input-container flex="30" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'curriculum.group\' | translate}}</label> <hois-classifier-select ng-model="criteria.iscedClassCode" model-value-attr="code" main-classifier-code="ISCED_RYHM" watch-model="criteria.iscedSuun" filter-values search-from-connect connect-main-classifier-code="ISCED_SUUN" multiple criteria="{vocational: true}"></hois-classifier-select> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column" ng-if="school.higher && !school.vocational"> <md-input-container flex="30" flex-sm="100" flex-xs="100"> <label>{{\'curriculum.curriculumGroup\' | translate}}</label> <hois-classifier-select ng-model="criteria.curriculumGroup" model-value-attr="code" main-classifier-code="OPPEKAVAGRUPP" multiple criteria="{higher: true}"></hois-classifier-select> </md-input-container> <md-input-container flex="30" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'curriculum.areaOfStudy\' | translate}}</label> <hois-classifier-select ng-model="criteria.iscedVald" model-value-attr="code" main-classifier-code="ISCED_VALD" criteria="{higher: true}" show-only-values="areasOfStudy"></hois-classifier-select> </md-input-container> <md-input-container flex="30" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'curriculum.fieldOfStudy\' | translate}}</label> <hois-classifier-select ng-model="criteria.iscedSuun" model-value-attr="code" main-classifier-code="ISCED_SUUN" watch-model="criteria.iscedVald" filter-values search-from-connect connect-main-classifier-code="ISCED_VALD" multiple criteria="{higher: true}"></hois-classifier-select> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column" class="top-margin"> <md-input-container flex="100" flex-sm="100" flex-xs="100"> <label>{{\'curriculum.studyLanguage2\' | translate}}</label> <hois-classifier-select ng-model="criteria.studyLanguage" multiple main-classifier-code="OPPEKEEL" model-value-attr="code"></hois-classifier-select> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <div layout="column" flex="45"> <label class="common-label"> <span ng-if="school.vocational && !school.higher">{{\'curriculum.creditsRangeEkap\' | translate}}</span> <span ng-if="!school.vocational && school.higher">{{\'curriculum.creditsRangeEap\' | translate}}</span> <span ng-if="school.vocational && school.higher || !school.vocational && !school.higher">{{\'curriculum.creditsEapEkap\' | translate}}</span> </label> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100" class=""> <label>{{\'main.from\' | translate}}</label> <input ng-model="criteria.creditsMin" type="number"> </md-input-container> <md-input-container flex="45" flex-sm="100" flex-xs="100" flex-offset="10" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'main.thru\' | translate}}</label> <input ng-model="criteria.creditsMax" type="number"> </md-input-container> </div> </div> <div layout="column" flex="50" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label class="common-label">{{\'main.validityPeriod\' | translate}}</label> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex-sm="100" flex-xs="100"> <label>{{\'main.from\' | translate}}</label> <md-datepicker ng-model="criteria.validFrom" md-max-date="criteria.validThru" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> <md-input-container flex-sm="100" flex-xs="100"> <label>{{\'main.thru\' | translate}}</label> <md-datepicker ng-model="criteria.validThru" md-min-date="criteria.validFrom" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> </div> </div> </div> <div layout="row" layout-sm="column" layout-xs="column" ng-if="canView"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label>{{\'main.status\' | translate}}</label> <hois-classifier-select ng-model="criteria.status" multiple main-classifier-code="OPPEKAVA_STAATUS" model-value-attr="code"></hois-classifier-select> </md-input-container> <md-input-container flex="50" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'curriculum.ehisStatus\' | translate}}</label> <hois-classifier-select ng-model="criteria.ehisStatus" multiple main-classifier-code="OPPEKAVA_EHIS_STAATUS" model-value-attr="code"></hois-classifier-select> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column" class="top-margin" ng-if="auth.school"> <md-input-container flex="100" flex-sm="100" flex-xs="100"> <label>{{\'school.department.department\' | translate}}</label> <hois-school-department-select ng-model="criteria.department" multiple></hois-school-department-select> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column" class="top-margin"> <md-checkbox ng-model="criteria.isJoint" aria-label="Is vocational"> {{\'curriculum.isJoint\' | translate}} </md-checkbox> </div> <div layout="row" layout-xs="column"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> <md-button class="md-raised" ng-if="auth.school.vocational && canCreate" ng-href="#/vocationalCurriculum/new">{{\'main.button.insertVocationalCurriculum\' | translate}}</md-button> <md-button class="md-raised" ng-if="auth.school.higher && canCreate" ng-href="#/higherCurriculum/new">{{\'main.button.insertHigherCurriculum\' | translate}}</md-button> </div> </fieldset> </form> </div> </div> <md-table-container flex ng-cloak layout-padding> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="school.{{currentLanguageNameField()}}" ng-if="!auth.school">{{\'school.label\' | translate}}</th> <th md-column md-order-by="{{currentLanguageNameField()}}">{{\'curriculum.name\' | translate}}</th> <th md-column md-order-by="merCode">{{\'curriculum.search.merCode\' | translate}}</th> <th md-column md-order-by="origStudyLevel.{{currentLanguageNameField()}}">{{\'curriculum.studyLevel\' | translate}}</th> <th md-column md-order-by="credits"> <span ng-if="school.vocational && school.higher || !school.vocational && !school.higher">{{\'curriculum.search.creditsEapEkap\' | translate}}</span> <span ng-if="!school.vocational && school.higher">{{\'curriculum.search.creditsEap\' | translate}}</span> <span ng-if="school.vocational && !school.higher">{{\'curriculum.search.creditsEkap\' | translate}}</span> </th> <th md-column md-order-by="validFrom">{{\'stateCurriculum.validFrom\' | translate}}</th> <th md-column md-order-by="validThru">{{\'stateCurriculum.validThru\' | translate}}</th> <th md-column md-order-by="status.{{currentLanguageNameField()}}" ng-if="canView">{{\'stateCurriculum.status\' | translate}}</th> <th></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell ng-if="!auth.school">{{row.school.nameEt}}</td> <td md-cell><a href="" ng-click="view(row)">{{currentLanguageNameField(row)}}</a></td> <td md-cell>{{::row.merCode}}</td> <td md-cell>{{currentLanguageNameField(row.origStudyLevel)}}</td> <td md-cell>{{::row.credits}}</td> <td md-cell>{{row.validFrom | hoisDate}}</td> <td md-cell>{{row.validThru | hoisDate}}</td> <td md-cell ng-if="canView">{{currentLanguageNameField(row.status)}}</td> <td md-cell> <md-button md-no-ink class="md-primary change-button" ng-if="row.canChange" ng-click="edit(row)">{{\'main.button.change\' | translate}}</md-button> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\' }" md-page-select></md-table-pagination>'),a.put("curriculum/curriculum.public.list.html",'<div layout-padding> <form layout="column" ng-cloak ng-submit="loadData()" class="nomargin"> <fieldset tabindex="1"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <div layout="column" flex> <md-input-container> <label>{{\'school.label\' | translate}}</label> <hois-select ng-model="criteria.school" type="school"></hois-select> </md-input-container> <md-input-container> <label>{{\'curriculum.studyLevel\' | translate}}</label> <hois-classifier-select ng-model="criteria.studyLevel" multiple main-classifier-code="OPPEASTE" model-value-attr="code"></hois-classifier-select> </md-input-container> <md-input-container> <label>{{\'curriculum.name\' | translate}}</label> <input ng-model="criteria.name" type="text"> </md-input-container> </div> <div layout="row"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> </div> </fieldset> </form> </div> <md-table-container flex ng-cloak layout-padding> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="school.{{currentLanguageNameField()}}">{{\'school.label\' | translate}}</th> <th md-column md-order-by="{{currentLanguageNameField()}}">{{\'curriculum.name\' | translate}}</th> <th md-column md-order-by="merCode">{{\'curriculum.search.merCode\' | translate}}</th> <th md-column md-order-by="origStudyLevel.{{currentLanguageNameField()}}">{{\'curriculum.studyLevel\' | translate}}</th> <th md-column md-order-by="credits"> <span>{{\'curriculum.search.creditsEapEkap\' | translate}}</span> </th> <th md-column md-order-by="validFrom">{{\'stateCurriculum.validFrom\' | translate}}</th> <th md-column md-order-by="validThru">{{\'stateCurriculum.validThru\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{row.school.nameEt}}</td> <td md-cell> <a href="/#/curriculum/{{::row.id}}">{{currentLanguageNameField(row)}}</a> </td> <td md-cell>{{::row.merCode}}</td> <td md-cell>{{currentLanguageNameField(row.origStudyLevel)}}</td> <td md-cell>{{::row.credits}}</td> <td md-cell>{{row.validFrom | hoisDate}}</td> <td md-cell>{{row.validThru | hoisDate}}</td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\' }" md-page-select></md-table-pagination>'),a.put("curriculum/curriculum.public.version.html",'<div layout-padding ng-cloak class="form-readonly"> <fieldset layout="column"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'curriculum.public.versionTitle\' | translate}}</legend> <div layout="column"> <div>&nbsp;</div> <md-input-container flex> <label>{{\'curriculum.public.codeOrName\' | translate}}</label> <hois-value value="version.code"></hois-value> </md-input-container> <div ng-if="curriculum.higher" layout="row"> <md-input-container flex> <label>{{\'module.implementationPlan.admissionYear\' | translate}}</label> <hois-value value="version.admissionYear"></hois-value> </md-input-container> </div> <div ng-if="!curriculum.higher" layout="row"> <md-input-container flex="50" flex-xs="100"> <label>{{\'curriculum.public.studyForm\' | translate}}</label> <hois-value value="version.curriculumStudyForm"></hois-value> </md-input-container> <md-input-container flex="45" flex-offset="5"> <label>{{\'curriculum.public.admissionYear\' | translate}}</label> <hois-value value="version.admissionYear"></hois-value> </md-input-container> </div> <div ng-if="!curriculum.higher" layout="row"> <md-input-container flex="50" flex-xs="100"> <label>{{\'curriculum.public.targetGroup\' | translate}}</label> <hois-value value="version.targetGroup"></hois-value> </md-input-container> </div> </div> <md-table-container> <table ng-if="!curriculum.higher" md-table class="secondary-table"> <thead md-head> <tr md-row style="background: #E0E0E0 !important"> <th md-column colspan="{{version.yearCapacities.length}}">{{\'curriculum.yearCapacitiesTable\' | translate}}</th> </tr> <tr md-row> <th md-column ng-repeat="yc in version.yearCapacities track by $index">{{$index+1}}.&nbsp;{{\'module.studyYearLowercase\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row> <td md-cell ng-repeat="yc in version.yearCapacities track by $index">{{yc.credits}}</td> </tr> </tbody> </table> </md-table-container> <div ng-if="!curriculum.higher">&nbsp;</div> <md-input-container flex> <label>{{\'public.url\' | translate}}</label> <hois-value value="publicUrl"></hois-value> </md-input-container> </fieldset> <span ng-if="version.modules.length > 0"> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'module.modules\' | translate}}</legend> <hois-collapsable ng-repeat="module in version.modules | orderBy: \'nameEt\'" expanded="false" label="currentLanguageNameField(module) + \' \' + module.totalCredits + \' \' + (\'curriculum.public.higherCreditsUnit\' | translate)"> <md-table-container> <table ng-if="(mandatorySubjects = (module.subjects | filter : {optional: false})).length > 0" md-table class="secondary-table"> <thead md-head> <tr md-row style="background: #E0E0E0 !important"> <th md-column colspan="6">{{\'curriculum.public.mandatorySubjects\' | translate}}</th> </tr> <tr md-row> <th md-column style="width: 35%">{{\'curriculum.public.name\' | translate}}</th> <th md-column style="width: 20%">{{\'curriculum.public.higherStudyLoad\' | translate}}</th> <th md-column style="width: 20%">{{\'curriculum.public.assessment\' | translate}}</th> <th md-column style="width: 10%">{{\'module.studyYear\' | translate}}</th> <th md-column style="width: 10%"> <hois-classifier-value ng-value="\'OPPEPERIOOD_S\'" main-classifier-code="OPPEPERIOOD"></hois-classifier-value> </th> <th md-column style="width: 10%"> <hois-classifier-value ng-value="\'OPPEPERIOOD_K\'" main-classifier-code="OPPEPERIOOD"></hois-classifier-value> </th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="subject in mandatorySubjects"> <td md-cell>{{currentLanguageNameField(subject.subject)}}</td> <td md-cell>{{subject.subject.credits}}</td> <td md-cell>{{subject.subject.assessment}}</td> <td md-cell>{{subject.studyYearNumber}}</td> <td md-cell>{{subject.autumn ? (\'main.no\' | translate) : (\'main.yes\' | translate)}}</td> <td md-cell>{{subject.spring ? (\'main.no\' | translate) : (\'main.yes\' | translate)}}</td> </tr> </tbody> </table> </md-table-container> <md-table-container style="margin-top: 0px"> <table ng-if="(optionalSubjects = (module.subjects | filter : {optional: true})).length > 0" md-table class="secondary-table"> <thead md-head> <tr md-row style="background: #E0E0E0 !important"> <th md-column colspan="6">{{\'curriculum.public.optionalSubjects\' | translate}}</th> </tr> <tr md-row> <th md-column style="width: 35%">{{\'curriculum.public.name\' | translate}}</th> <th md-column style="width: 20%">{{\'curriculum.public.higherStudyLoad\' | translate}}</th> <th md-column style="width: 20%">{{\'curriculum.public.assessment\' | translate}}</th> <th md-column style="width: 10%">{{\'module.studyYear\' | translate}}</th> <th md-column style="width: 10%"> <hois-classifier-value ng-value="\'OPPEPERIOOD_S\'" main-classifier-code="OPPEPERIOOD"></hois-classifier-value> </th> <th md-column style="width: 10%"> <hois-classifier-value ng-value="\'OPPEPERIOOD_K\'" main-classifier-code="OPPEPERIOOD"></hois-classifier-value> </th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="subject in optionalSubjects"> <td md-cell>{{currentLanguageNameField(subject.subject)}}</td> <td md-cell>{{subject.subject.credits}}</td> <td md-cell>{{subject.subject.assessment}}</td> <td md-cell>{{subject.studyYearNumber}}</td> <td md-cell>{{subject.autumn ? (\'main.no\' | translate) : (\'main.yes\' | translate)}}</td> <td md-cell>{{subject.spring ? (\'main.no\' | translate) : (\'main.yes\' | translate)}}</td> </tr> </tbody> </table> </md-table-container> </hois-collapsable> </fieldset> </span> <span ng-if="version.occupationModules.length > 0"> <div>&nbsp;</div> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'module.modules\' | translate}}</legend> <hois-collapsable ng-repeat="module in version.occupationModules | orderBy: \'nameEt\'" expanded="false" label="currentLanguageNameField(module) + \' \' + module.totalCredits + \' \' + (\'curriculum.public.vocationalCreditsUnit\' | translate)"> <div layout="column"> <md-input-container flex> <label>{{\'curriculum.public.assessment\' | translate}}</label> <hois-value value="module.assessment"></hois-value> </md-input-container> </div> <md-table-container> <table ng-if="module.themes.length > 0" md-table class="secondary-table"> <thead md-head> <tr md-row style="background: #E0E0E0 !important"> <th md-column colspan="3">{{\'curriculum.public.themes\' | translate}}</th> </tr> <tr md-row> <th md-column width="40%">{{\'curriculum.public.name\' | translate}}</th> <th md-column width="20%">{{\'curriculum.public.vocationalStudyLoad\' | translate}}</th> <th md-column width="40%">{{\'curriculum.public.assessment\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="theme in module.themes"> <td md-cell>{{theme.nameEt}}</td> <td md-cell>{{theme.hours}}/{{theme.credits}}</td> <td md-cell>{{theme.assessment}}</td> </tr> </tbody> </table> </md-table-container> </hois-collapsable> </fieldset> </span> <hois-collapsable expanded="false" ng-if="version.modules.length > 0 && years.length > 0"> <hois-collapsable-header> <span>{{\'curriculum.version.typicalTrainingPlan\' | translate}}</span> </hois-collapsable-header> <md-table-container style="padding: 1px"> <table class="custom-table"> <thead class="secondary-table-header"> <th style="width: 35%">{{\'subject.name\' | translate}}</th> <th style="width: 20%">{{\'subject.code\' | translate}}</th> <th style="width: 10%">EAP</th> <th style="width: 10%">{{\'subject.assessment\' | translate}}</th> <th style="width: 10%">{{\'subject.mandatory\' | translate}}</th> </thead> <tbody ng-repeat="year in years | orderBy"> <tr class="sub-header1" ng-show="(mappedSubjects[year] | filter: {spring: true}).length > 0"> <td colspan="6"> {{\'module.springSemesterYear\' | translate: {year: year} }} </td> </tr> <tr class="higher-curriculum-subject-row" ng-repeat="subject in mappedSubjects[year] | filter: {spring: true} | orderBy: currentLanguageNameField()"> <td>{{currentLanguageNameField(subject.subject)}}</td> <td>{{subject.subject.code}}</td> <td>{{subject.subject.credits}}</td> <td>{{subject.assessment}}</td> <td>{{subject.optional ? (\'main.no\' | translate) : (\'main.yes\' | translate)}}</td> </tr> <tr class="sub-header1" ng-show="(mappedSubjects[year] | filter: {autumn: true}).length > 0"> <td colspan="6"> {{\'module.autumnSemesterYear\' | translate: {year: year} }} </td> </tr> <tr class="higher-curriculum-subject-row" ng-repeat="subject in mappedSubjects[year] | filter: {autumn: true} | orderBy: currentLanguageNameField()"> <td>{{currentLanguageNameField(subject.subject)}}</td> <td>{{subject.subject.code}}</td> <td>{{subject.subject.credits}}</td> <td>{{subject.assessment}}</td> <td>{{subject.optional ? (\'main.no\' | translate) : (\'main.yes\' | translate)}}</td> </tr> </tbody> </table> </md-table-container> </hois-collapsable> <div layout="row"> <md-button ng-click="back(\'#/curriculums/\')" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </div> </div> <style>table.custom-table {\r\n  border-collapse: collapse;\r\n  width: 100%;\r\n}\r\n\r\ntable.custom-table th:first-child,\r\ntable.custom-table td:first-child {\r\n  padding-left: 2.5em;\r\n}\r\n\r\ntable.custom-table th:last-child,\r\ntable.custom-table td:last-child {\r\n  padding-right: 1.5em;\r\n}\r\n\r\ntable.custom-table th,\r\ntable.custom-table td{\r\n  padding-right: 0.5em;\r\n  text-align: left;\r\n  white-space: nowrap;\r\n}\r\n\r\ntable.custom-table tr.occupation-header {\r\n  height: 38px !important;\r\n}\r\n\r\ntable.custom-table tr.occupation-header td:first-child {\r\n  padding-left: 0.5em !important;\r\n}\r\n\r\ntable.custom-table tr.sub-header1 {\r\n  height: 32px !important;\r\n}\r\n\r\ntable.custom-table tr.sub-header1 td:first-child {\r\n  padding-left: 1.5em !important;\r\n}\r\n\r\ntable.custom-table tr {\r\n  height: 28px;\r\n}\r\n\r\ntable.custom-table td md-checkbox {\r\n  margin: auto;\r\n}</style>'),a.put("curriculum/curriculum.public.view.html",'<div layout-padding ng-cloak class="form-readonly"> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'curriculum.public.curriculumData\' | translate}}</legend> <div>&nbsp;</div> <div layout="row" layout-sm="column" layout-xs="column" flex> <md-input-container flex-gt-sm="50"> <label>{{\'curriculum.nameEt\' | translate}}</label> <hois-value value="curriculum.nameEt"></hois-value> </md-input-container> <md-input-container flex-gt-sm="45" flex-offset-gt-xs="5"> <label>{{\'curriculum.nameEn\' | translate}}</label> <hois-value value="curriculum.nameEn"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column" flex> <md-input-container flex-gt-sm="50"> <label>{{\'curriculum.code\' | translate}}</label> <hois-value value="curriculum.code"></hois-value> </md-input-container> <md-input-container flex-gt-sm="45" flex-offset-gt-xs="5"> <label>{{\'curriculum.merCode\' | translate}}</label> <hois-value value="curriculum.merCode"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column" flex> <md-input-container flex-gt-sm="25"> <label>{{\'curriculum.credits\' | translate}}</label> <hois-value value="curriculum.credits"></hois-value> </md-input-container> <md-input-container flex-gt-sm="25"> <label>{{\'student.studyLevel\' | translate}}</label> <hois-value value="curriculum.origStudyLevel"></hois-value> </md-input-container> <md-input-container ng-if="curriculum.higher" flex-gt-sm="45" flex-offset-gt-xs="5"> <label>{{\'curriculum.studyPeriod\' | translate}} {{\'main.years\' | translate}}/{{\'main.months\' | translate}}</label> <hois-value value="curriculum.studyPeriodYears + \'/\' + curriculum.studyPeriodMonths"></hois-value> </md-input-container> <md-input-container ng-if="!curriculum.higher" flex-gt-sm="20" flex-offset-gt-xs="5"> <label>{{\'curriculum.studyPeriod\' | translate}} {{\'main.years\' | translate}}/{{\'main.months\' | translate}}</label> <hois-value value="curriculum.studyPeriodYears + \'/\' + curriculum.studyPeriodMonths"></hois-value> </md-input-container> <md-input-container ng-if="!curriculum.higher" flex-gt-sm="25"> <label>{{\'curriculum.consecution.label\' | translate}}</label> <hois-value value="curriculum.consecution"></hois-value> </md-input-container> </div> <div>&nbsp;</div> <div layout="column"> <md-input-container flex> <label>{{\'curriculum.studyOutcomes\' | translate}}</label> <hois-value value="currentLanguage() === \'en\' ? curriculum.outcomesEn : curriculum.outcomesEt"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'curriculum.admissionRequirements\' | translate}}</label> <hois-value value="currentLanguage() === \'en\' ? curriculum.admissionRequirementsEn : curriculum.admissionRequirementsEt"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'curriculum.graduationRequirements\' | translate}}</label> <hois-value value="currentLanguage() === \'en\' ? curriculum.graduationRequirementsEn : curriculum.graduationRequirementsEt"></hois-value> </md-input-container> </div> <md-input-container flex> <label>{{\'public.url\' | translate}}</label> <hois-value value="publicUrl"></hois-value> </md-input-container> </fieldset> <span ng-if="curriculum.versions.length > 0"> <div>&nbsp;</div> <fieldset> <legend ng-if="curriculum.higher" md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'curriculum.public.curriculumVersionsHigher\' | translate}}</legend> <legend ng-if="!curriculum.higher" md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'curriculum.public.curriculumVersionsVocational\' | translate}}</legend> <md-table-container> <table md-table md-progress="promise" class="secondary-table"> <thead md-head md-order="query.order"> <tr md-row> <th md-column>{{\'curriculum.public.code\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="version in curriculum.versions | orderBy: \'code\'"> <td md-cell> <a href="/#/curriculum/{{::curriculum.id}}/version/{{::version.id}}" class="md-primary">{{version.code}}</a> </td> </tr> </tbody> </table> </md-table-container> </fieldset> </span> <div layout="row"> <md-button ng-click="back(\'#/curriculums/\')" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </div> </div>'),
a.put("declaration/declaration.edit.html",'<md-nav-bar md-selected-nav-item="currentNavItem" aria-label="{{\'subjectStudyPeriod.label.options\' | translate}}" ng-show="formState.showNavBar"> <md-nav-item md-nav-href="#/declaration/current/view" name="current">{{\'declaration.myDeclaration\' | translate}}</md-nav-item> <md-nav-item md-nav-href="#/declarations/previous?_menu" name="previous">{{\'declaration.previousDeclarations\' | translate}}</md-nav-item> </md-nav-bar> <div class="ois-form-layout-padding form-readonly" layout="column"> <div layout="row" layout-sm="column" layout-xs="column" ng-show="auth.isAdmin()"> <md-input-container flex="25" flex-sm="100" flex-xs="100"> <label>{{\'declaration.student\' | translate}}</label> <hois-value value="declaration.student.fullname"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="25" flex-sm="100" flex-xs="100"> <label>{{\'declaration.studyPeriod\' | translate}}</label> <hois-value value="currentLanguageNameField(declaration.studyPeriod)"></hois-value> </md-input-container> <md-input-container flex="25" flex-sm="100" flex-xs="100" flex-offset-xs="0" flex-offset-sm="0" flex-offset="5"> <label>{{\'declaration.curriculumVersion\' | translate}}</label> <hois-value value="currentLanguageNameField(declaration.student.curriculumVersion)"></hois-value> </md-input-container> <md-input-container flex="25" flex-sm="100" flex-xs="100" flex-offset-xs="0" flex-offset-sm="0" flex-offset="5"> <label>{{\'declaration.course\' | translate}}</label> <hois-value value="declaration.course.toString()"></hois-value> </md-input-container> <md-input-container flex="25" flex-sm="100" flex-xs="100" flex-offset-xs="0" flex-offset-sm="0" flex-offset="5"> <label>{{\'declaration.studentGroup\' | translate}}</label> <hois-value value="currentLanguageNameField(declaration.student.studentGroup)"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="25" flex-sm="100" flex-xs="100"> <label>{{\'declaration.status\' | translate}}</label> <hois-classifier-value ng-model="declaration.status" main-classifier-code="OPINGUKAVA_STAATUS"></hois-classifier-value> </md-input-container> <md-input-container flex="25" flex-sm="100" flex-xs="100" flex-offset-xs="0" flex-offset-sm="0" flex-offset="5"> <label>{{\'declaration.inserted\' | translate}}</label> <hois-value value="declaration.inserted | hoisDateTime"></hois-value> </md-input-container> <md-input-container flex="25" flex-sm="100" flex-xs="100" flex-offset-xs="0" flex-offset-sm="0" flex-offset="5"> <label>{{\'declaration.confirmDate\' | translate}}</label> <hois-value value="declaration.confirmDate | hoisDate"></hois-value> </md-input-container> <md-input-container flex="25" flex-sm="100" flex-xs="100" flex-offset-xs="0" flex-offset-sm="0" flex-offset="5"> <label>{{\'declaration.confirmer\' | translate}}</label> <hois-value value="declaration.confirmer"></hois-value> </md-input-container> </div> <div ng-show="declaration.canBeSetConfirmed" layout="row" layout-xs="column"> <md-button class="md-raised" ng-click="openAddCurriculumSubject()">{{\'declaration.addCurriculumSubject\' | translate}}</md-button> <md-button class="md-raised" ng-click="openAddExtraCurriculumSubject()">{{\'declaration.addExtraCurriculumSubject\' | translate}}</md-button> </div> <br> <fieldset ng-show="addCurriculumSubjectForm"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'declaration.addingCurriculumSubject\' | translate}}</legend> <span ng-if="tabledata.content.length === 0"> {{\'declaration.noSuitableCurriculumSubjects\' | translate}} </span> <span ng-if="tabledata.content.length > 0"> <md-table-container> <table md-table md-progress="tabledata.$promise" class="secondary-table"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="{{\'cvhm.\' + currentLanguageNameField()}}">{{\'declaration.module\' | translate}}</th> <th md-column md-order-by="{{\'s.\' + currentLanguageNameField()}}">{{\'declaration.subject\' | translate}}</th> <th md-column>{{\'declaration.teacher\' | translate}}</th> <th md-column md-order-by="s.credits">{{\'declaration.eap\' | translate}}</th> <th md-column md-order-by="c.value">{{\'declaration.assessment\' | translate}}</th> <th md-column md-order-by="cvhms.is_optional">{{\'declaration.isRequired\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr ng-repeat="subject in tabledata.content"> <td md-cell>{{currentLanguageNameField(subject.module)}}</td> <td md-cell>{{currentLanguageNameField(subject.subject)}}({{subject.subject.code}})</td> <td md-cell> <table> <tr ng-repeat="teacher in subject.teachers | orderBy"> <td>{{teacher}}</td> </tr> </table> </td> <td md-cell>{{subject.subject.credits}}</td> <td md-cell>{{subject.subject.assessment}}</td> <td md-cell>{{subject.isOptional ? \'main.no\' : \'main.yes\' | translate}}</td> <td md-cell> <a href="" ng-click="addCurriculumSubject(subject)">{{\'declaration.addSubject\' | translate}}</a> </td> </tr> <tr ng-repeat-end> <td colspan="6"></td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\' }" md-page-select></md-table-pagination> </span> </fieldset> <fieldset ng-show="addExtraCurriculumSubjectForm"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'declaration.addingExtraCurriculumSubject\' | translate}}</legend> <form name="extraCurriculumForm" ng-cloak> <div class="ois-form-layout" layout="column" layout-margin ng-cloak> <md-select ng-model="subject" required aria-label="{{\'declaration.addingExtraCurriculumSubject\' | translate}}"> <md-option ng-value="subject" ng-repeat="subject in subjects |\r\n                orderBy: \'subject.\' + currentLanguageNameField()"> {{currentLanguageNameField(subject.subject)}}({{subject.subject.code}}) - {{subject.teachers.join(\', \')}} </md-option> </md-select> </div> <md-button class="md-raised md-primary" ng-click="addExtraCurriculumSubject()">{{"main.button.add" | translate}}</md-button> </form> </fieldset> <br> <md-table-container> <table md-table> <thead md-head> <tr md-row> <th md-column>{{\'declaration.subject\' | translate}}</th> <th md-column>{{\'declaration.teacher\' | translate}}</th> <th md-column>{{\'declaration.eap_assessment\' | translate}}</th> <th md-column>{{\'declaration.module_isRequired\' | translate}}</th> <th md-column>{{\'declaration.prerequisites\' | translate}}</th> <th md-column>{{\'studyMaterial.label\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="subject in declaration.subjects | orderBy: \'subject.\' + currentLanguageNameField()" ng-class="{listItem: subject.newlyAdded}" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell> <a href="#/subject/{{subject.subject.id}}"> {{currentLanguageNameField(subject.subject)}} ({{subject.subject.code}}) <span ng-show="subject.isDeclaredRepeatedly">&nbsp;*</span> </a> </td> <td md-cell> <table> <tr ng-repeat="program in subject.programs | orderBy: \'teacherName\'"> <td>{{program.teacherName}} <span ng-if="auth.isStudent() && program.id !== -1 && program.publicStudent"> (<a href="#/subjectProgram/public/{{program.id}}/view" hide-xs>{{\'declaration.seeProgram\' | translate}}</a><a href="#/subjectProgram/public/{{program.id}}/view" show-xs>{{\'declaration.seeProgramMobile\' | translate}}</a>) </span> </td> </tr> </table> </td> <td md-cell>{{subject.subject.credits}} / {{subject.subject.assessment}}</td> <td md-cell>{{subject.module != null ? currentLanguageNameField(subject.module) : \' - \'}} / {{subject.isOptional ? \'main.no\' : \'main.yes\' | translate}}</td> <td md-cell> <span ng-show="!hasPrerequisites(subject)"> - </span> <span ng-show="hasPrerequisites(subject)"><a href="" ng-click="seePrerequisites(subject)"> {{\'declaration.seePrerequisites\' | translate}}</a> </span> </td> <td md-cell><a ng-href="/#/studyMaterial/higher/{{subject.subjectStudyPeriod}}/view">{{\'studyMaterial.openfolder\' | translate}}</a></td> <td md-cell> <a ng-if="!subject.isAssessed" class="remove nomargin" ng-click="removeSubject(subject)">&times;</a> </td> </tr> </tbody> </table> </md-table-container> <br> <div layout="row"> <md-button ng-show="declaration.canBeSetConfirmed" class="md-raised md-primary" ng-click="confirm()">{{\'declaration.confirm\' | translate}}</md-button> <md-button ng-show="declaration.canBeSetUnconfirmed" class="md-raised md-primary" ng-click="removeConfirmation()">{{\'declaration.removeConfirmation\' | translate}}</md-button> <md-button ng-if="!auth.isStudent()" class="md-raised md-default" ng-click="back(\'#/declarations\')">{{\'main.button.back\' | translate}}</md-button> <md-button ng-if="auth.isStudent()" class="md-raised md-default" ng-click="back(\'#/declaration/current/view\')">{{\'main.button.back\' | translate}}</md-button> </div> </div> <style>.listItem.ng-enter {\r\n      transition: all 2.5s ease;\r\n  }\r\n  .listItem.ng-enter-active {\r\n      background-color: #84ff8e;\r\n  }\r\n  table.md-table:not(.md-row-select) td.md-cell:nth-child(n+2):nth-last-child(n+2),\r\n  table.md-table:not(.md-row-select) th.md-column:nth-child(n+2):nth-last-child(n+2) {\r\n    padding-right: 28px !important;\r\n  }</style>'),a.put("declaration/declaration.new.html",'<form layout="column" class="ois-form-layout-padding form-readonly" name="declarationNewForm" novalidate> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label>{{\'declaration.studyPeriod\' | translate}}</label> <hois-value value="currentLanguageNameField(studyPeriod)"></hois-value> </md-input-container> <br> <hois-autocomplete ng-model="student" url="/declarations/students" name="student" label="declaration.student" required> </hois-autocomplete> <div layout="row"> <md-button class="md-raised md-primary" type="submit" ng-click="save()">{{\'main.button.add\' | translate}}</md-button> <md-button class="md-raised md-default" ng-click="back(\'#/declarations\')">{{\'main.button.back\' | translate}}</md-button> </div> </form>'),a.put("declaration/declaration.search.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div layout="column"> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <form name="declarationSearchForm" ng-submit="declarationSearchForm.$valid && loadData()" novalidate ng-model-options="{allowInvalid: true}"> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label>{{\'declaration.studyPeriod\' | translate}}</label> <hois-select ng-model="criteria.studyPeriod" values="studyPeriods" required sorted-query="true"></hois-select> </md-input-container> <hois-autocomplete flex="45" flex-sm="100" flex-xs="100" flex-offset-xs="0" flex-offset-sm="0" flex-offset="5" ng-model="criteria.student" ha-controller="directiveControllers" url="/declarations/search-students" label="student.label" no-paging="true"></hois-autocomplete> </div> <div layout="row" layout-sm="column" layout-xs="column"> <hois-autocomplete flex="45" flex-sm="100" flex-xs="100" ng-model="criteria.curriculumVersion" ha-controller="directiveControllers" ha-search="searchCurriculumVersions" label="declaration.curriculumVersion"></hois-autocomplete> <hois-autocomplete flex="45" flex-sm="100" flex-xs="100" flex-offset-xs="0" flex-offset-sm="0" flex-offset="5" ng-model="criteria.studentGroups" ha-attribute="id" ha-controller="directiveControllers" method="studentgroups" name="studentGroup" multiple label="{{\'declaration.studentGroup\'}}" additional-query-params="{higher: true, valid: true, curriculumId: criteria.curriculum}"></hois-autocomplete> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label>{{\'declaration.status\' | translate}}</label> <hois-classifier-select ng-model="criteria.status" main-classifier-code="OPINGUKAVA_STAATUS" model-value-attr="code"></hois-classifier-select> </md-input-container> <md-input-container flex="45" flex-sm="100" flex-xs="100" flex-offset-xs="0" flex-offset-sm="0" flex-offset="5"> <md-checkbox ng-model="criteria.repeatingDeclaration" aria-label="{{\'declaration.repeatingDeclaration\' | translate}}"> {{\'declaration.repeatingDeclaration\' | translate}} </md-checkbox> </md-input-container> </div> <div layout="row"> <div layout="column" flex="45"> <label class="common-label">{{\'declaration.inserted\' | translate}}</label> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex-sm="100" flex-xs="100"> <label>{{\'main.from\' | translate}}</label> <md-datepicker ng-model="criteria.insertedFrom" md-max-date="criteria.insertedThru" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> <md-input-container flex-sm="100" flex-xs="100"> <label>{{\'main.thru\' | translate}}</label> <md-datepicker ng-model="criteria.insertedThru" md-min-date="criteria.insertedFrom" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> </div> </div> <div layout="column" flex="50" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label class="common-label">{{\'declaration.confirmDate\' | translate}}</label> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex-sm="100" flex-xs="100"> <label>{{\'main.from\' | translate}}</label> <md-datepicker ng-model="criteria.confirmedFrom" md-max-date="criteria.confirmedThru" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> <md-input-container flex-sm="100" flex-xs="100"> <label>{{\'main.thru\' | translate}}</label> <md-datepicker ng-model="criteria.confirmedThru" md-min-date="criteria.confirmedFrom" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> </div> </div> </div> <div layout="row"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> <md-button class="md-raised" ng-if="formState.canCreate" ng-href="#/declarations/new">{{\'main.button.create\' | translate}}</md-button> </div> <div layout="row"> <md-button class="md-raised" ng-click="showUncomposed()">{{\'declaration.showUncomposed\' | translate}}</md-button> <md-button class="md-raised" ng-if="canConfirm" ng-click="confirmAll()">{{\'declaration.confirmAll\' | translate}}</md-button> </div> </form> </fieldset> <br> <md-table-container ng-cloak layout-padding> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="p.lastname,p.firstname">{{\'declaration.student\' | translate}}</th> <th md-column md-order-by="p.idcode">{{\'declaration.idcode\' | translate}}</th> <th md-column md-order-by="cv.code">{{\'declaration.curriculumVersion\' | translate}}</th> <th md-column md-order-by="sg.code">{{\'declaration.studentGroup\' | translate}}</th> <th md-column md-order-by="d.inserted">{{\'declaration.inserted\' | translate}}</th> <th md-column md-order-by="status.{{currentLanguageNameField()}}">{{\'declaration.status\' | translate}}</th> <th md-column md-order-by="d.confirmDate">{{\'declaration.confirmDate\' | translate}}</th> <th></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell class="one-row"><a ng-href="#/declarations/{{row.id}}/view">{{::row.student.fullname}}</a></td> <td md-cell>{{::row.student.idcode}}</td> <td md-cell>{{currentLanguageNameField(row.student.curriculumVersion)}}</td> <td md-cell>{{currentLanguageNameField(row.student.studentGroup)}}</td> <td md-cell>{{row.inserted | hoisDate}}</td> <td md-cell>{{currentLanguageNameField(row.status)}}</td> <td md-cell>{{row.confirmDate | hoisDate}}</td> <td md-cell> <md-button md-no-ink class="md-primary change-button" ng-href="#/declarations/{{row.id}}/edit" ng-if="row.canBeChanged && isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_OPINGUKAVA\')"> {{\'main.button.change\' | translate}} </md-button> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\' }" md-page-select></md-table-pagination> </div> </div>'),a.put("declaration/declaration.student.search.html",'<md-nav-bar md-selected-nav-item="currentNavItem" aria-label="{{\'subjectStudyPeriod.label.options\' | translate}}"> <md-nav-item md-nav-href="#/declaration/current/view" name="current">{{\'declaration.myDeclaration\' | translate}}</md-nav-item> <md-nav-item md-nav-href="#/declarations/previous?_menu" name="previous">{{\'declaration.previousDeclarations\' | translate}}</md-nav-item> </md-nav-bar> <md-table-container ng-cloak layout-padding> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="sp.{{currentLanguageNameField()}}">{{\'declaration.studyPeriod\' | translate}}</th> <th md-column md-order-by="d.inserted">{{\'declaration.inserted\' | translate}}</th> <th md-column md-order-by="status.{{currentLanguageNameField()}}">{{\'declaration.status\' | translate}}</th> <th md-column md-order-by="d.confirmDate">{{\'declaration.confirmDate\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell><a ng-href="#/declarations/{{row.id}}/view">{{currentLanguageNameField(row.studyPeriod)}}</a></td> <td md-cell>{{row.inserted | hoisDate}}</td> <td md-cell>{{currentLanguageNameField(row.status)}}</td> <td md-cell>{{row.confirmDate | hoisDate}}</td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\' }" md-page-select></md-table-pagination>'),a.put("declaration/declaration.subject.prerequisites.html",'<md-dialog aria-label="grade add dialog" flex="40" flex-xs="100"> <form name="dialogForm" ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2>{{"declaration.prerequisites" | translate}}</h2> <span flex></span> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <span flex></span> <div class="ois-form-layout" layout="column" layout-margin ng-cloak> <div ng-show="subject.mandatoryPrerequisiteSubjects.length > 0"> <legend md-colors="{color: \'default-primary-800\'}" class="md-title-small"> {{"declaration.mandatoryPrerequisiteSubjects" | translate}} </legend> <md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'declaration.subject\' | translate}}</th> <th md-column width="10%">{{\'declaration.eap_assessment\' | translate}}</th> <th md-column width="10%">{{\'declaration.grade\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="s in subject.mandatoryPrerequisiteSubjects | orderBy: currentLanguageNameField()" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{currentLanguageNameField(s)}} ({{s.code}})</td> <td md-cell>{{s.credits}} / {{s.assessment}}</td> <td md-cell></td> </tr> </tbody> </table> </md-table-container> </div> <div ng-show="subject.recommendedPrerequisiteSubjects.length > 0"> <legend md-colors="{color: \'default-primary-800\'}" class="md-title-small" ng-show="subject.recommendedPrerequisiteSubjects.length > 0"> {{"declaration.recommendedPrerequisiteSubjects" | translate}} </legend> <md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'declaration.subject\' | translate}}</th> <th md-column width="10%">{{\'declaration.eap_assessment\' | translate}}</th> <th md-column width="10%">{{\'declaration.grade\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="s in subject.recommendedPrerequisiteSubjects | orderBy: currentLanguageNameField()" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{currentLanguageNameField(s)}} ({{s.code}})</td> <td md-cell>{{s.credits}} / {{s.assessment}}</td> <td md-cell>{{s.grade}}</td> </tr> </tbody> </table> </md-table-container> </div> </div> </md-dialog-content> <md-dialog-actions layout="row" layout-align="start center"> <md-button class="md-raised" ng-click="cancel()">{{"main.button.close" | translate}}</md-button> </md-dialog-actions> </form> </md-dialog>'),a.put("declaration/declaration.view.html",'<md-nav-bar md-selected-nav-item="currentNavItem" aria-label="{{\'subjectStudyPeriod.label.options\' | translate}}" ng-show="formState.showNavBar"> <md-nav-item md-nav-href="#/declaration/current/view" name="current">{{\'declaration.myDeclaration\' | translate}}</md-nav-item> <md-nav-item md-nav-href="#/declarations/previous?_menu" name="previous">{{\'declaration.previousDeclarations\' | translate}}</md-nav-item> </md-nav-bar> <div class="ois-form-layout-padding form-readonly" layout="column" ng-show="formState.declaration"> <div layout="row" layout-sm="column" layout-xs="column" ng-show="auth.isAdmin()"> <md-input-container flex="25" flex-sm="100" flex-xs="100"> <label>{{\'declaration.student\' | translate}}</label> <hois-value value="declaration.student.fullname"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="25" flex-sm="100" flex-xs="100"> <label>{{\'declaration.studyPeriod\' | translate}}</label> <hois-value value="currentLanguageNameField(declaration.studyPeriod)"></hois-value> </md-input-container> <md-input-container flex="25" flex-sm="100" flex-xs="100" flex-offset-xs="0" flex-offset-sm="0" flex-offset="5"> <label>{{\'declaration.curriculumVersion\' | translate}}</label> <hois-value value="currentLanguageNameField(declaration.student.curriculumVersion)"></hois-value> </md-input-container> <md-input-container flex="25" flex-sm="100" flex-xs="100" flex-offset-xs="0" flex-offset-sm="0" flex-offset="5"> <label>{{\'declaration.course\' | translate}}</label> <hois-value value="declaration.course.toString()"></hois-value> </md-input-container> <md-input-container flex="25" flex-sm="100" flex-xs="100" flex-offset-xs="0" flex-offset-sm="0" flex-offset="5"> <label>{{\'declaration.studentGroup\' | translate}}</label> <hois-value value="currentLanguageNameField(declaration.student.studentGroup)"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="25" flex-sm="100" flex-xs="100"> <label>{{\'declaration.status\' | translate}}</label> <hois-classifier-value ng-model="declaration.status" main-classifier-code="OPINGUKAVA_STAATUS"></hois-classifier-value> </md-input-container> <md-input-container flex="25" flex-sm="100" flex-xs="100" flex-offset-xs="0" flex-offset-sm="0" flex-offset="5"> <label>{{\'declaration.inserted\' | translate}}</label> <hois-value value="declaration.inserted | hoisDateTime"></hois-value> </md-input-container> <md-input-container flex="25" flex-sm="100" flex-xs="100" flex-offset-xs="0" flex-offset-sm="0" flex-offset="5"> <label>{{\'declaration.confirmDate\' | translate}}</label> <hois-value value="declaration.confirmDate | hoisDate"></hois-value> </md-input-container> <md-input-container flex="25" flex-sm="100" flex-xs="100" flex-offset-xs="0" flex-offset-sm="0" flex-offset="5"> <label>{{\'declaration.confirmer\' | translate}}</label> <hois-value value="declaration.confirmer"></hois-value> </md-input-container> </div> <br> <md-table-container> <table md-table> <thead md-head> <tr md-row> <th md-column>{{\'declaration.subject\' | translate}}</th> <th md-column>{{\'declaration.teacher\' | translate}}</th> <th md-column>{{\'declaration.eap_assessment\' | translate}}</th> <th md-column>{{\'declaration.module_isRequired\' | translate}}</th> <th md-column>{{\'declaration.prerequisites\' | translate}}</th> <th md-column>{{\'studyMaterial.label\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="subject in declaration.subjects | orderBy: \'subject.\' + currentLanguageNameField()" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell> <a href="#/subject/{{subject.subject.id}}"> {{currentLanguageNameField(subject.subject)}} ({{subject.subject.code}}) <span ng-show="subject.isDeclaredRepeatedly">&nbsp;*</span> </a> </td> <td md-cell> <table> <tr ng-repeat="program in subject.programs | orderBy: \'teacherName\'"> <td>{{program.teacherName}} <span ng-if="auth.isStudent() && program.id !== -1 && program.publicStudent"> (<a href="#/subjectProgram/public/{{program.id}}/view" hide-xs>{{\'declaration.seeProgram\' | translate}}</a><a href="#/subjectProgram/public/{{program.id}}/view" hide-gt-xs>{{\'declaration.seeProgramMobile\' | translate}}</a>) </span> </td> </tr> </table> </td> <td md-cell>{{subject.subject.credits}} / {{subject.subject.assessment}}</td> <td md-cell>{{subject.module != null ? currentLanguageNameField(subject.module) : \' - \'}} / {{subject.isOptional ? \'main.no\' : \'main.yes\' | translate}}</td> <td md-cell> <span ng-show="!hasPrerequisites(subject)"> - </span> <span ng-show="hasPrerequisites(subject)"><a href="" ng-click="seePrerequisites(subject)"> {{\'declaration.seePrerequisites\' | translate}}</a> </span> </td> <td md-cell><a ng-href="/#/studyMaterial/higher/{{subject.subjectStudyPeriod}}/view">{{\'studyMaterial.openfolder\' | translate}}</a></td> </tr> </tbody> </table> </md-table-container> <br> <div layout="row"> <md-button ng-if="isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_OPINGUKAVA\')" ng-show="declaration.canBeChanged" class="md-raised md-primary" ng-href="#/declarations/{{declaration.id}}/edit">{{\'main.button.change\' | translate}}</md-button> <md-button ng-if="isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_OPINGUKAVA\')" ng-show="declaration.canBeSetConfirmed" class="md-raised" ng-click="confirm()">{{\'declaration.confirm\' | translate}}</md-button> <md-button ng-if="isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_OPINGUKAVA\')" ng-show="declaration.canBeSetUnconfirmed" class="md-raised" ng-click="removeConfirmation()">{{\'declaration.removeConfirmation\' | translate}}</md-button> <md-button ng-if="!auth.isStudent()" class="md-raised md-default" ng-click="back(\'#/declarations\')">{{\'main.button.back\' | translate}}</md-button> <md-button ng-if="auth.isStudent() && !currentDeclarationPage" class="md-raised md-default" ng-click="back(\'#/declaration/current/view\')">{{\'main.button.back\' | translate}}</md-button> </div> </div> <div layout-padding> <div ng-show="formState.noDeclaration && formState.isDeclarationPeriod"> <md-whiteframe class="md-whiteframe-1dp attention-whiteframe" flex="100" layout layout-align="left center"> <div md-colors="{color: \'warn\'}"> <md-icon md-colors="{color: \'warn\'}" md-font-set="material-icons">info_outline</md-icon> <span>{{\'declaration.noCurrentDeclaration\' | translate}}</span> </div> </md-whiteframe> <div ng-if="isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_OPINGUKAVA\')" layout="row"> <md-button ng-show="formState.canCreateDeclaration" class="md-raised" ng-click="addDeclaration()">{{\'main.button.add\' | translate}}</md-button> </div> </div> <div ng-show="formState.noDeclaration && !formState.isDeclarationPeriod && !formState.declarationPeriodStart && !formState.declarationPeriodEnd"> <md-whiteframe class="md-whiteframe-1dp attention-whiteframe" flex="100" layout layout-align="left center"> <div md-colors="{color: \'accent\'}"> <md-icon md-colors="{color: \'accent\'}" md-font-set="material-icons">info_outline</md-icon> <span>{{\'declaration.notDeclarationPeriod\' | translate}}</span> </div> </md-whiteframe> </div> <div ng-show="formState.noDeclaration && !formState.isDeclarationPeriod && formState.declarationPeriodEnd"> <md-whiteframe class="md-whiteframe-1dp attention-whiteframe" flex="100" layout layout-align="left center"> <div md-colors="{color: \'accent\'}"> <md-icon md-colors="{color: \'accent\'}" md-font-set="material-icons">info_outline</md-icon> <span>{{\'declaration.declarationPeriodHasEnded\' | translate}} {{formState.declarationPeriodEnd | hoisDate}}</span> </div> </md-whiteframe> </div> <div ng-show="formState.noDeclaration && !formState.isDeclarationPeriod && formState.declarationPeriodStart"> <md-whiteframe class="md-whiteframe-1dp attention-whiteframe" flex="100" layout layout-align="left center"> <div md-colors="{color: \'accent\'}"> <md-icon md-colors="{color: \'accent\'}" md-font-set="material-icons">info_outline</md-icon> <span>{{\'declaration.declarationPeriodHasNotStarted\' | translate}} {{formState.declarationPeriodStart | hoisDate}}</span> </div> </md-whiteframe> </div> </div> <style>table.md-table:not(.md-row-select) td.md-cell:nth-child(n+2):nth-last-child(n+2),\r\n  table.md-table:not(.md-row-select) th.md-column:nth-child(n+2):nth-last-child(n+2) {\r\n    padding-right: 28px !important;\r\n  }</style>'),a.put("declaration/uncomposed.declarations.html",'<md-dialog aria-label="{{\'declaration.uncomposedDeclarations\' | translate}}" flex="50" flex-sm="70" flex-xs="100"> <form name="dialogForm" ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2>{{"declaration.uncomposedDeclarations" | translate}}</h2> <span flex></span> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <div class="ois-form-layout"> <md-table-container flex> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="p.lastname,p.firstname">{{\'declaration.student\' | translate}}</th> <th md-column md-order-by="p.idcode">{{\'declaration.idcode\' | translate}}</th> <th md-column md-order-by="cv.code">{{\'declaration.curriculumVersion\' | translate}}</th> <th md-column md-order-by="sg.code">{{\'declaration.studentGroup\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell class="one-row">{{::row.fullname}}</td> <td md-cell>{{::row.idcode}}</td> <td md-cell>{{currentLanguageNameField(row.curriculumVersion)}}</td> <td md-cell>{{currentLanguageNameField(row.studentGroup)}}</td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\' }" md-page-select></md-table-pagination> </div> </md-dialog-content> <md-dialog-actions layout="row" layout-align="start center"> <md-button class="md-raised" ng-click="cancel()">{{"main.button.close" | translate}}</md-button> </md-dialog-actions> </form> </md-dialog>'),a.put("directive/coordinator.edit.html",'<div layout="column" layout-padding> <div> <form name="directiveCoordinatorForm"> <md-input-container class="md-block"> <label>{{\'directive.coordinator.name\' | translate}}</label> <input ng-model="record.name" name="name" type="text" required md-maxlength="100"> </md-input-container> <md-input-container class="md-block"> <label class="textInput">{{\'directive.coordinator.idcode\' | translate}}</label> <hois-idcode-lookup ng-model="record.idcode" required></hois-idcode-lookup> </md-input-container> <div layout="column"> <md-checkbox ng-model="record.isDirective" aria-label="{{\'directive.coordinator.isDirective\' | translate}}"> {{\'directive.coordinator.isDirective\' | translate}} </md-checkbox> <md-checkbox ng-model="record.isCertificate" aria-label="{{\'directive.coordinator.isCertificate\' | translate}}"> {{\'directive.coordinator.isCertificate\' | translate}} </md-checkbox> <md-checkbox ng-model="record.isCertificateDefault" aria-label="{{\'directive.coordinator.isCertificateDefault\' | translate}}"> {{\'directive.coordinator.isCertificateDefault\' | translate}} </md-checkbox> </div> </form> <md-button ng-click="update()" class="md-raised md-primary">{{\'main.button.save\' | translate}}</md-button> <md-button ng-click="delete()" ng-if="record.id" class="md-raised">{{\'main.button.delete\' | translate}}</md-button> <md-button ng-href="#/directives/coordinators" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </div> </div>'),
a.put("directive/coordinator.search.html",'<div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="name">{{\'directive.coordinator.name\' | translate}}</th> <th md-column md-order-by="idcode">{{\'directive.coordinator.idcode\' | translate}}</th> <th md-column md-order-by="isDirective">{{\'directive.coordinator.directive\' | translate}}</th> <th md-column md-order-by="isCertificate">{{\'directive.coordinator.certificate\' | translate}}</th> <th md-column md-order-by="isCertificateDefault">{{\'directive.coordinator.certificateDefault\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{::row.name}}</td> <td md-cell>{{::row.idcode}}</td> <td md-cell>{{::row.isDirective ? \'main.yes\' : \'main.no\' | translate}}</td> <td md-cell>{{::row.isCertificate ? \'main.yes\' : \'main.no\' | translate}}</td> <td md-cell>{{::row.isCertificateDefault ? \'main.yes\' : \'main.no\' | translate}}</td> <td md-cell> <md-button md-no-ink class="md-primary change-button" ng-if="isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_DOKALLKIRI\')" ng-href="#/directives/coordinators/{{::row.id}}/edit">{{\'main.button.change\' | translate}}</md-button> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> <div layout="row"> <md-button class="md-raised" ng-if="isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_DOKALLKIRI\')" ng-href="#/directives/coordinators/new">{{\'main.button.create\' | translate}}</md-button> </div> </div>'),a.put("directive/directive.edit.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <form name="directiveForm" class="nomargin"> <div layout="column"> <md-input-container class="md-block"> <label class="textInput">{{\'directive.type\' | translate}}</label> <hois-classifier-select ng-model="record.type" name="type" ng-change="directiveTypeChanged()" ng-disabled="formState.state !== \'CHOOSETYPE\'" model-value-attr="code" main-classifier-code="KASKKIRI" filter-values="formState.excludedTypes" only-valid required autofocus></hois-classifier-select> </md-input-container> </div> <div flex ng-if="record.type === \'KASKKIRI_LOPET\' && formState.school.higher && formState.school.vocational"> <md-input-container class="md-block"> <md-radio-group layout-gt-sm="row" ng-model="record.isHigher" ng-change="directiveTypeChanged()" required ng-disabled="formState.state !== \'CHOOSETYPE\'"> <md-radio-button ng-value="false">{{\'directive.vocational\' | translate}}</md-radio-button> <md-radio-button ng-value="true">{{\'directive.higher\' | translate}}</md-radio-button> </md-radio-group> </md-input-container> </div> <div flex ng-if="record.type === \'KASKKIRI_STIPTOET\' || record.type === \'KASKKIRI_STIPTOETL\'"> <md-input-container class="md-block"> <label class="textInput">{{\'directive.scholarshipType\' | translate}}</label> <hois-classifier-select ng-model="record.scholarshipType" name="scholarshipType" ng-change="scholarshipTypeChanged()" ng-disabled="formState.state !== \'CHOOSETYPE\'" model-value-attr="code" main-classifier-code="STIPTOETUS" criteria="{higher: formState.school.higher ? true : undefined, vocational: formState.school.vocational ? true : undefined}" required></hois-classifier-select> </md-input-container> </div> <div flex ng-if="formState.state === \'CHOOSETYPE\' && withoutInitialSelection.indexOf(record.type) === -1"> <div>&nbsp;</div> <md-table-container> <table md-table md-row-select multiple ng-model="formState.selectedStudents"> <thead md-head> <tr md-row> <th md-column>{{\'directive.student.fullname\' | translate}}</th> <th md-column>{{\'directive.student.idcode\' | translate}}</th> <th md-column ng-if="record.type === \'KASKKIRI_TUGI\'">{{\'directive.student.application\' | translate}}</th> <th md-column>{{\'directive.student.curriculum\' | translate}}</th> <th md-column>{{\'directive.student.studentGroup\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row md-select="row" md-select-id="id" ng-repeat="row in formState.students" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell> <md-button md-no-ink class="md-primary change-button" ng-href="#/students/{{::row.id}}/main">{{::row.fullname}}</md-button> </td> <td md-cell>{{::row.idcode}}</td> <td md-cell ng-if="record.type === \'KASKKIRI_TUGI\'"> <md-input-container style="width: 100%" ng-if="row.applications.length > 1"> <md-select ng-model="formState.studentApplicationRelationship[row.id]" ng-required="!!formState.selectedStudentIds[row.id]"> <md-option ng-value="opt.id" ng-repeat="opt in row.applications"> {{opt.confirmed ? "(" + (opt.confirmed | hoisDateTime) + ") " + opt.description : opt.description}} </md-option> </md-select> </md-input-container> <span ng-if="row.applications.length === 1" ng-init="formState.studentApplicationRelationship[row.id] = row.applications[0].id"> {{row.applications[0].confirmed ? "(" + (row.applications[0].confirmed | hoisDateTime) + ") " + row.applications[0].description : row.applications[0].description}} </span> </td> <td md-cell>{{currentLanguageNameField(row.curriculumVersion)}}</td> <td md-cell>{{::row.studentGroup}}</td> </tr> </tbody> </table> </md-table-container> </div> <div layout="row" ng-if="formState.state === \'CHOOSETYPE\' && record.type === \'KASKKIRI_IMMATV\'"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'directive.student.curriculumVersion\' | translate}}</label> <hois-select ng-model="formState.curriculumVersion" multiple values="formState.saisCurriculumVersions"></hois-select> </md-input-container> <md-input-container flex="50" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label class="textInput">{{\'directive.student.studyLevel\' | translate}}</label> <hois-select ng-model="formState.studyLevel" multiple type="saisCurriculumClassifiers" value-property="code"></hois-select> </md-input-container> </div> <div layout="row" ng-if="formState.state === \'CHOOSETYPE\'"> <md-button class="md-raised" ng-click="addDirective()" ng-if="formState.state === \'CHOOSETYPE\' && formState.students">{{\'directive.addToDirective\' | translate}}</md-button> <md-button ng-click="back(\'#/directives\')" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </div> <div flex-xs="0" flex-gt-xs="0" flex-gt-sm="50"></div> <div flex ng-if="formState.state === \'EDIT\'"> <div class="form-readonly top-margin" ng-if="record.type === \'KASKKIRI_TYHIST\'"> <md-input-container class="md-block"> <label class="textInput">{{\'directive.canceledDirective\' | translate}}</label> <hois-value value="formState.canceledDirective.nameEt" href-value="\'#/directives/\' + formState.canceledDirective.id + \'/view\'"></hois-value> </md-input-container> </div> <md-input-container class="md-block"> <label class="textInput">{{\'directive.headline\' | translate}}</label> <input type="text" ng-model="record.headline" name="headline" required md-maxlength="500"> </md-input-container> <div class="form-readonly top-margin"> <md-input-container class="md-block"> <label class="textInput">{{\'directive.inserted\' | translate}}</label> <hois-value value="record.inserted | hoisDate"></hois-value> </md-input-container> </div> <div class="form-readonly top-margin"> <md-input-container class="md-block"> <label class="textInput">{{\'directive.insertedBy\' | translate}}</label> <hois-value value="record.insertedBy"></hois-value> </md-input-container> </div> <md-input-container class="md-block"> <label class="textInput">{{\'directive.addInfo\' | translate}}</label> <textarea ng-model="record.addInfo" md-maxlength="4000" max-rows="10"></textarea> </md-input-container> <md-input-container class="md-block"> <label class="textInput">{{\'directive.directiveCoordinator\' | translate}}&nbsp;*</label> <hois-select ng-model="record.directiveCoordinator" name="directiveCoordinator" type="directivecoordinator" criteria="{isDirective: true}"></hois-select> </md-input-container> <md-input-container class="md-block" ng-if="record.type === \'KASKKIRI_TYHIST\'"> <label class="textInput">{{\'directive.cancelType\' | translate}}</label> <hois-classifier-select ng-model="record.cancelType" ng-change="cancelTypeChanged()" filter-values="[formState.changedStudents.length > 0 ? \'KASKKIRI_TYHISTAMISE_VIIS_T\' : undefined]" ng-required="record.type === \'KASKKIRI_TYHIST\'" main-classifier-code="KASKKIRI_TYHISTAMISE_VIIS" model-value-attr="code"></hois-classifier-select> </md-input-container> <div>&nbsp;</div> <md-table-container> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'directive.studentList\' | translate}}</legend> <md-button class="md-raised" ng-click="addStudents()" ng-if="record.type !== \'KASKKIRI_TYHIST\' && record.type !== \'KASKKIRI_IMMATV\'">{{\'directive.addStudents\' | translate}}</md-button> <div ng-include="formState.templateUrl" flex></div> </fieldset> </md-table-container> <div layout="row"> <md-button class="md-raised md-primary" ng-click="update()">{{\'main.button.save\' | translate}}</md-button> <md-button class="md-raised" ng-if="record.id" ng-click="sendToConfirm(true)">{{\'directive.sendToConfirm\' | translate}}</md-button> <md-button class="md-raised" ng-if="record.id && isAuthorized(\'ROLE_OIGUS_K_TEEMAOIGUS_KASKKIRI_EKISETA\')" ng-click="sendToConfirm(false)">{{\'directive.sendToConfirmWithoutEkis\' | translate}}</md-button> <md-button class="md-raised" ng-if="record.id" ng-click="delete()">{{\'main.button.delete\' | translate}}</md-button> <md-button ng-click="back(\'#/directives\', directiveForm)" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </div> </div> </form> </div> </div>'),a.put("directive/directive.type.akad.edit.html",'<md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'directive.student.order\' | translate}}</th> <th md-column>{{\'directive.student.fullname\' | translate}}</th> <th md-column>{{\'directive.student.idcode\' | translate}}</th> <th md-column class="required">{{\'directive.student.isPeriod\' | translate}}</th> <th md-column class="required">{{\'directive.student.akadStartDate\' | translate}}</th> <th md-column class="required">{{\'directive.student.akadEndDate\' | translate}}</th> <th md-column class="required">{{\'directive.student.reason\' | translate}}</th> <th md-column>{{\'directive.student.applicationAkadStartDate\' | translate}}</th> <th md-column>{{\'directive.student.applicationAkadEndDate\' | translate}}</th> <th></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in record.students" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{$index + 1}}.</td> <td md-cell>{{::row.fullname}}</td> <td md-cell>{{::row.idcode}}</td> <td md-cell> <md-radio-group name="isPeriod" ng-model="row.isPeriod" layout="row"> <md-radio-button ng-value="true" aria-label="period">{{ \'main.period\' | translate }}</md-radio-button> <md-radio-button ng-value="false" aria-label="date">{{ \'main.date\' | translate }}</md-radio-button> </md-radio-group> </td> <td md-cell> <hois-select ng-if="row.isPeriod" ng-model="row.studyPeriodStart" name="students[{{$index}}].studyPeriodStart" values="formState.studyPeriods" aria-label="{{\'directive.student.akadStartDate\' | translate}}"></hois-select> <md-datepicker ng-if="!row.isPeriod" ng-model="row.startDate" md-max-date="row.endDate" name="students[{{$index}}].startDate"></md-datepicker> <div ng-if="row.isPeriod" class="invalid" ng-messages="directiveForm[\'students[\'+$index+\'].studyPeriodStart\'].$error"> <p ng-message="required">{{\'main.required\' | translate}}</p> </div> <div ng-if="!row.isPeriod" class="invalid" ng-messages="directiveForm[\'students[\'+$index+\'].startDate\'].$error"> <p ng-message="required">{{\'main.required\' | translate}}</p> </div> </td> <td md-cell> <hois-select ng-if="row.isPeriod" ng-model="row.studyPeriodEnd" name="students[{{$index}}].studyPeriodEnd" values="formState.studyPeriods" aria-label="{{\'directive.student.akadEndDate\' | translate}}"></hois-select> <md-datepicker ng-if="!row.isPeriod" ng-model="row.endDate" md-min-date="row.startDate" name="students[{{$index}}].endDate"></md-datepicker> <div ng-if="row.isPeriod" class="invalid" ng-messages="directiveForm[\'students[\'+$index+\'].studyPeriodEnd\'].$error"> <p ng-message="required">{{\'main.required\' | translate}}</p> </div> <div ng-if="!row.isPeriod" class="invalid" ng-messages="directiveForm[\'students[\'+$index+\'].endDate\'].$error"> <p ng-message="required">{{\'main.required\' | translate}}</p> </div> </td> <td md-cell> <hois-classifier-select ng-model="row.reason" name="students[{{$index}}].reason" only-valid ignore-preselected criteria="{vocational: row.oldCurriculumVersion.isVocational ? true : undefined, higher: !row.oldCurriculumVersion.isVocational ? true : undefined}" model-value-attr="code" main-classifier-code="AKADPUHKUS_POHJUS" aria-label="{{\'directive.student.reason\' | translate}}"></hois-classifier-select> <div class="invalid" ng-messages="directiveForm[\'students[\'+$index+\'].reason\'].$error"> <p ng-message="required">{{\'main.required\' | translate}}</p> </div> </td> <td md-cell> <div ng-if="row.applicationIsPeriod">{{currentLanguageNameField(row.applicationStudyPeriodStart)}}</div> <hois-value ng-if="!row.applicationIsPeriod" value="row.applicationStartDate | hoisDate"></hois-value> </td> <td md-cell> <div ng-if="row.applicationIsPeriod">{{currentLanguageNameField(row.applicationStudyPeriodEnd)}}</div> <hois-value ng-if="!row.applicationIsPeriod" value="row.applicationEndDate | hoisDate"></hois-value> </td> <td md-cell> <a ng-click="deleteStudent(row)" class="remove">&times;</a> </td> </tr> </tbody> </table> </md-table-container>'),a.put("directive/directive.type.akad.view.html",'<md-table-container> <table md-table md-row-select="formState.cancelSelect" multiple ng-model="formState.selectedStudents" class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'directive.student.order\' | translate}}</th> <th md-column>{{\'directive.student.fullname\' | translate}}</th> <th md-column>{{\'directive.student.idcode\' | translate}}</th> <th md-column>{{\'directive.student.isPeriod\' | translate}}</th> <th md-column>{{\'directive.student.akadStartDate\' | translate}}</th> <th md-column>{{\'directive.student.akadEndDate\' | translate}}</th> <th md-column>{{\'directive.student.reason\' | translate}}</th> <th md-column>{{\'directive.student.applicationAkadStartDate\' | translate}}</th> <th md-column>{{\'directive.student.applicationAkadEndDate\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-disabled="!row.selectable" md-select="row" md-select-id="student" ng-repeat="row in record.students | orderBy:\'+lastname\'" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{$index + 1}}.</td> <td md-cell> <a class="md-primary" ng-href="#/students/{{::row.student}}/main">{{::row.fullname}}</a> </td> <td md-cell>{{::row.idcode}}</td> <td md-cell>{{row.isPeriod ? \'main.period\' : \'main.date\' | translate}}</td> <td md-cell> <div ng-if="row.isPeriod">{{currentLanguageNameField(row.newStudyPeriodStart)}}</div> <hois-value ng-if="!row.isPeriod" value="row.startDate | hoisDate"></hois-value> </td> <td md-cell> <div ng-if="row.isPeriod">{{currentLanguageNameField(row.newStudyPeriodEnd)}}</div> <hois-value ng-if="!row.isPeriod" value="row.endDate | hoisDate"></hois-value> </td> <td md-cell> <hois-classifier-value ng-model="row.reason" main-classifier-code="AKADPUHKUS_POHJUS"></hois-classifier-value> </td> <td md-cell> <div ng-if="row.applicationIsPeriod">{{currentLanguageNameField(row.applicationStudyPeriodStart)}}</div> <hois-value ng-if="!row.applicationIsPeriod" value="row.applicationStartDate | hoisDate"></hois-value> </td> <td md-cell> <div ng-if="row.applicationIsPeriod">{{currentLanguageNameField(row.applicationStudyPeriodEnd)}}</div> <hois-value ng-if="!row.applicationIsPeriod" value="row.applicationEndDate | hoisDate"></hois-value> </td> </tr> </tbody> </table> </md-table-container>'),a.put("directive/directive.type.akadk.edit.html",'<md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'directive.student.order\' | translate}}</th> <th md-column>{{\'directive.student.fullname\' | translate}}</th> <th md-column>{{\'directive.student.idcode\' | translate}}</th> <th md-column class="required">{{\'directive.student.akadCancelDate\' | translate}}</th> <th></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in record.students" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{$index + 1}}.</td> <td md-cell>{{::row.fullname}}</td> <td md-cell>{{::row.idcode}}</td> <td md-cell> <md-datepicker ng-model="row.startDate" name="students[{{$index}}].startDate"></md-datepicker> <div class="invalid" ng-show="directiveForm[\'students[\'+$index+\'].startDate\'].$error.required"> {{\'main.required\' | translate}} </div> <div class="invalid" ng-show="directiveForm[\'students[\'+$index+\'].startDate\'].$error.serverside"> <span ng-repeat="err in directiveForm[\'students[\'+$index+\'].startDate\'].$serverError">{{err.code | translate}}</span> <br ng-if="!$last"> </div> </td> <td md-cell> <a ng-click="deleteStudent(row)" md-no-ink class="remove">&times;</a> </td> </tr> </tbody> </table> </md-table-container> <style>.secondary-table .md-datepicker-triangle-button{\r\n    bottom: -2.5px !important;\r\n  }</style>'),a.put("directive/directive.type.akadk.view.html",'<md-table-container> <table md-table md-row-select="formState.cancelSelect" multiple ng-model="formState.selectedStudents" class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'directive.student.order\' | translate}}</th> <th md-column>{{\'directive.student.fullname\' | translate}}</th> <th md-column>{{\'directive.student.idcode\' | translate}}</th> <th md-column>{{\'directive.student.akadCancelDate\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-disabled="!row.selectable" md-select="row" md-select-id="student" ng-repeat="row in record.students | orderBy:\'+lastname\'" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{$index + 1}}.</td> <td md-cell> <a class="md-primary" ng-href="#/students/{{::row.student}}/main">{{::row.fullname}}</a> </td> <td md-cell>{{::row.idcode}}</td> <td md-cell> <hois-value value="row.startDate | hoisDate"></hois-value> </td> </tr> </tbody> </table> </md-table-container>'),a.put("directive/directive.type.eksmat.edit.html",'<md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'directive.student.order\' | translate}}</th> <th md-column>{{\'directive.student.fullname\' | translate}}</th> <th md-column>{{\'directive.student.idcode\' | translate}}</th> <th md-column class="required">{{\'directive.student.reason\' | translate}}</th> <th></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in record.students" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{$index + 1}}.</td> <td md-cell>{{::row.fullname}}</td> <td md-cell>{{::row.idcode}}</td> <td md-cell> <hois-classifier-select ng-model="row.reason" name="students[{{$index}}].reason" model-value-attr="code" main-classifier-code="EKSMAT_POHJUS" criteria="{vocational: formState.school.vocational ? true : undefined, higher: formState.school.higher ? true : undefined}" aria-label="{{\'directive.student.reason\' | translate}}" only-valid> </hois-classifier-select> <div class="invalid" ng-show="directiveForm[\'students[\'+$index+\'].reason\'].$error.required"> {{\'main.required\' | translate}} </div> </td> <td md-cell> <a ng-click="deleteStudent(row)" md-no-ink class="remove">&times;</a> </td> </tr> </tbody> </table> </md-table-container>'),a.put("directive/directive.type.eksmat.view.html",'<md-table-container> <table md-table md-row-select="formState.cancelSelect" multiple ng-model="formState.selectedStudents" class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'directive.student.order\' | translate}}</th> <th md-column>{{\'directive.student.fullname\' | translate}}</th> <th md-column>{{\'directive.student.idcode\' | translate}}</th> <th md-column>{{\'directive.student.reason\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-disabled="!row.selectable" md-select="row" md-select-id="student" ng-repeat="row in record.students | orderBy:\'+lastname\'" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{$index + 1}}.</td> <td md-cell> <a class="md-primary" ng-href="#/students/{{::row.student}}/main">{{::row.fullname}}</a> </td> <td md-cell>{{::row.idcode}}</td> <td md-cell> <hois-classifier-value ng-model="row.reason" main-classifier-code="EKSMAT_POHJUS"></hois-classifier-value> </td> </tr> </tbody> </table> </md-table-container>'),a.put("directive/directive.type.ennist.edit.html",'<md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'directive.student.order\' | translate}}</th> <th md-column>{{\'directive.student.fullname\' | translate}}</th> <th md-column>{{\'directive.student.idcode\' | translate}}</th> <th md-column>{{\'directive.student.curriculumVersion\' | translate}}</th> <th md-column class="required">{{\'directive.student.studentGroup\' | translate}}</th> <th md-column ng-if="formState.school.higher">{{\'directive.student.studyLoad\' | translate}}</th> <th md-column>{{\'directive.student.studyForm\' | translate}}</th> <th md-column class="required">{{\'directive.student.nominalStudyEnd\' | translate}}</th> <th md-column>{{\'directive.student.fin\' | translate}}</th> <th md-column>{{\'directive.student.finSpecific\' | translate}}</th> <th md-column>{{\'directive.student.language\' | translate}}</th> <th></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in record.students" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{$index + 1}}.</td> <td md-cell>{{::row.fullname}}</td> <td md-cell>{{::row.idcode}}</td> <td md-cell>{{currentLanguageNameField(row.oldCurriculumVersion)}}</td> <td md-cell> <hois-select ng-model="row.studentGroup" name="students[{{$index}}].studentGroup" values="formState.studentGroupMap[row.oldCurriculumVersion.id]" aria-label="{{\'directive.student.studentGroup\' | translate}}"></hois-select> <div class="invalid" ng-show="directiveForm[\'students[\'+$index+\'].studentGroup\'].$error.required"> {{\'main.required\' | translate}} </div> </td> <td md-cell ng-if="formState.school.higher"> <hois-classifier-value ng-model="row.oldStudyLoad" criteria="{higher: true}" main-classifier-code="OPPEKOORMUS"></hois-classifier-value> </td> <td md-cell> <hois-classifier-value ng-model="row.oldStudyForm" main-classifier-code="OPPEVORM"></hois-classifier-value> </td> <td md-cell> <md-datepicker ng-model="row.nominalStudyEnd" name="students[{{$index}}].nominalStudyEnd"></md-datepicker> <div class="invalid" ng-show="directiveForm[\'students[\'+$index+\'].nominalStudyEnd\'].$error.required"> {{\'main.required\' | translate}} </div> </td> <td md-cell> <hois-classifier-value ng-model="row.oldFin" main-classifier-code="FINALLIKAS"></hois-classifier-value> </td> <td md-cell> <hois-classifier-value ng-model="row.oldFinSpecific" main-classifier-code="FINTAPSUSTUS"></hois-classifier-value> </td> <td md-cell> <hois-classifier-value ng-model="row.oldLanguage" main-classifier-code="OPPEKEEL"></hois-classifier-value> </td> <td md-cell> <a ng-click="deleteStudent(row)" md-no-ink class="remove">&times;</a> </td> </tr> </tbody> </table> </md-table-container>'),a.put("directive/directive.type.ennist.view.html",'<md-table-container> <table md-table md-row-select="formState.cancelSelect" multiple ng-model="formState.selectedStudents" class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'directive.student.order\' | translate}}</th> <th md-column>{{\'directive.student.fullname\' | translate}}</th> <th md-column>{{\'directive.student.idcode\' | translate}}</th> <th md-column>{{\'directive.student.curriculumVersion\' | translate}}</th> <th md-column>{{\'directive.student.studentGroup\' | translate}}</th> <th md-column ng-if="formState.school.higher">{{\'directive.student.studyLoad\' | translate}}</th> <th md-column>{{\'directive.student.studyForm\' | translate}}</th> <th md-column>{{\'directive.student.nominalStudyEnd\' | translate}}</th> <th md-column>{{\'directive.student.fin\' | translate}}</th> <th md-column>{{\'directive.student.finSpecific\' | translate}}</th> <th md-column>{{\'directive.student.language\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-disabled="!row.selectable" md-select="row" md-select-id="student" ng-repeat="row in record.students | orderBy:\'+lastname\'" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{$index + 1}}.</td> <td md-cell> <a class="md-primary" ng-href="#/students/{{::row.student}}/main">{{::row.fullname}}</a> </td> <td md-cell>{{::row.idcode}}</td> <td md-cell>{{currentLanguageNameField(row.newCurriculumVersion)}}</td> <td md-cell>{{::row.newStudentGroup}}</td> <td md-cell ng-if="formState.school.higher"> <hois-classifier-value ng-model="row.studyLoad" main-classifier-code="OPPEKOORMUS"></hois-classifier-value> </td> <td md-cell> <hois-classifier-value ng-model="row.studyForm" main-classifier-code="OPPEVORM"></hois-classifier-value> </td> <td md-cell> <hois-value value="row.nominalStudyEnd | hoisDate"></hois-value> </td> <td md-cell> <hois-classifier-value ng-model="row.fin" main-classifier-code="FINALLIKAS"></hois-classifier-value> </td> <td md-cell> <hois-classifier-value ng-model="row.finSpecific" main-classifier-code="FINTAPSUSTUS"></hois-classifier-value> </td> <td md-cell> <hois-classifier-value ng-model="row.language" main-classifier-code="OPPEKEEL"></hois-classifier-value> </td> </tr> </tbody> </table> </md-table-container>'),a.put("directive/directive.type.finm.edit.html",'<md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'directive.student.order\' | translate}}</th> <th md-column>{{\'directive.student.fullname\' | translate}}</th> <th md-column>{{\'directive.student.idcode\' | translate}}</th> <th md-column class="required">{{\'directive.student.fin\' | translate}}</th> <th md-column class="required">{{\'directive.student.finSpecific\' | translate}}</th> <th></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in record.students" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{$index + 1}}.</td> <td md-cell>{{::row.fullname}}</td> <td md-cell>{{::row.idcode}}</td> <td md-cell> <hois-classifier-value ng-model="row.fin" name="students[{{$index}}].fin" main-classifier-code="FINALLIKAS"></hois-classifier-value> <div class="invalid" ng-show="directiveForm[\'students[\'+$index+\'].fin\'].$error.required"> {{\'main.required\' | translate}} </div> </td> <td md-cell> <hois-classifier-select ng-model="row.finSpecific" name="students[{{$index}}].finSpecific" model-value-attr="code" criteria="{vocational: formState.school.vocational ? true : undefined, higher: formState.school.higher ? true : undefined}" only-valid ignore-preselected filter-values="[row.oldFinSpecific]" main-classifier-code="FINTAPSUSTUS" aria-label="{{\'directive.student.finSpecific\' | translate}}"></hois-classifier-select> <div class="invalid" ng-show="directiveForm[\'students[\'+$index+\'].finSpecific\'].$error.required"> {{\'main.required\' | translate}} </div> </td> <td md-cell> <a ng-click="deleteStudent(row)" md-no-ink class="remove">&times;</a> </td> </tr> </tbody> </table> </md-table-container>'),a.put("directive/directive.type.finm.view.html",'<md-table-container> <table md-table md-row-select="formState.cancelSelect" multiple ng-model="formState.selectedStudents" class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'directive.student.order\' | translate}}</th> <th md-column>{{\'directive.student.fullname\' | translate}}</th> <th md-column>{{\'directive.student.idcode\' | translate}}</th> <th md-column>{{\'directive.student.fin\' | translate}}</th> <th md-column>{{\'directive.student.finSpecific\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-disabled="!row.selectable" md-select="row" md-select-id="student" ng-repeat="row in record.students | orderBy:\'+lastname\'" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{$index + 1}}.</td> <td md-cell> <a class="md-primary" ng-href="#/students/{{::row.student}}/main">{{::row.fullname}}</a> </td> <td md-cell>{{::row.idcode}}</td> <td md-cell> <hois-classifier-value ng-model="row.fin" main-classifier-code="FINALLIKAS"></hois-classifier-value> </td> <td md-cell> <hois-classifier-value ng-model="row.finSpecific" main-classifier-code="FINTAPSUSTUS"></hois-classifier-value> </td> </tr> </tbody> </table> </md-table-container>'),a.put("directive/directive.type.immat.edit.html",'<md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'directive.student.order\' | translate}}</th> <th md-column>{{\'directive.student.foreign\' | translate}}</th> <th md-column>{{\'directive.student.idcode\' | translate}}</th> <th md-column class="required">{{\'directive.student.firstname\' | translate}}</th> <th md-column class="required">{{\'directive.student.lastname\' | translate}}</th> <th md-column class="required">{{\'directive.student.birthdate\' | translate}}</th> <th md-column class="required">{{\'directive.student.sex\' | translate}}</th> <th md-column class="required">{{\'directive.student.citizenship\' | translate}}</th> <th md-column class="required">{{\'directive.student.curriculumVersion\' | translate}}</th> <th md-column ng-if="formState.school.higher" ng-class="{required: !formState.school.vocational}">{{\'directive.student.studyLoad\' | translate}}</th> <th md-column class="required">{{\'directive.student.studyForm\' | translate}}</th> <th md-column class="required">{{\'directive.student.nominalStudyEnd\' | translate}}</th> <th md-column class="required">{{\'directive.student.fin\' | translate}}</th> <th md-column class="required">{{\'directive.student.finSpecific\' | translate}}</th> <th md-column class="required">{{\'directive.student.language\' | translate}}</th> <th md-column class="required">{{\'directive.student.studentGroup\' | translate}}</th> <th md-column class="required">{{\'directive.student.previousStudyLevel\' | translate}}</th> <th md-column ng-if="formState.school.vocational" ng-class="{required: !formState.school.higher}">{{\'directive.student.dormitory\' | translate}}</th> <th></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in record.students" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{$index + 1}}.</td> <td md-cell> <md-checkbox ng-model="row._foreign" ng-change="foreignChanged(row)" aria-label="{{\'directive.student.foreign\' | translate}}"></md-checkbox> </td> <td md-cell> <input type="text" ng-if="!row._foreign" ng-blur="lookupStudent(row)" ng-model="row.idcode" name="students[{{$index}}].idcode"> <input type="text" ng-if="row._foreign" ng-blur="lookupStudent(row)" ng-model="row.foreignIdcode" name="students[{{$index}}].idcode"> <div class="invalid" ng-messages="directiveForm[\'students[\'+$index+\'].idcode\'].$error"> <p ng-message="required">{{\'main.required\' | translate}}</p> <p ng-message="serverside"> </p><p ng-repeat="err in directiveForm[\'students[\'+$index+\'].idcode\'].$serverError">{{\'main.messages.error.\' + err.code | translate}}</p>  </div> </td> <td md-cell> <input type="text" ng-readonly="row._found" ng-model="row.firstname" name="students[{{$index}}].firstname"> <div class="invalid" ng-messages="directiveForm[\'students[\'+$index+\'].firstname\'].$error"> <p ng-message="required">{{\'main.required\' | translate}}</p> <p ng-message="serverside"> </p><p ng-repeat="err in directiveForm[\'students[\'+$index+\'].firstname\'].$serverError">{{\'main.messages.error.\' + err.code | translate}}</p>  </div> </td> <td md-cell> <input type="text" ng-readonly="row._found" ng-model="row.lastname" name="students[{{$index}}].lastname"> <div class="invalid" ng-messages="directiveForm[\'students[\'+$index+\'].lastname\'].$error"> <p ng-message="required">{{\'main.required\' | translate}}</p> <p ng-message="serverside"> </p><p ng-repeat="err in directiveForm[\'students[\'+$index+\'].lastname\'].$serverError">{{\'main.messages.error.\' + err.code | translate}}</p>  </div> </td> <td md-cell> <md-datepicker ng-if="!row._found && !row.idcode" ng-model="row.birthdate" name="students[{{$index}}].birthdate"></md-datepicker> <hois-value ng-if="row._found || row.idcode" value="row.birthdate | hoisDate" name="students[{{$index}}].birthdate"></hois-value> <div class="invalid" ng-messages="directiveForm[\'students[\'+$index+\'].birthdate\'].$error"> <p ng-message="required">{{\'main.required\' | translate}}</p> </div> </td> <td md-cell> <hois-classifier-select ng-if="!row._found && !row.idcode" ng-model="row.sex" name="students[{{$index}}].sex" criteria="{vocational: formState.school.vocational ? true : undefined, higher: formState.school.higher ? true : undefined}" only-valid ignore-preselected model-value-attr="code" main-classifier-code="SUGU" aria-label="{{\'directive.student.sex\' | translate}}"></hois-classifier-select> <hois-classifier-value ng-if="row._found || row.idcode" ng-model="row.sex" main-classifier-code="SUGU"></hois-classifier-value> <div class="invalid" ng-messages="directiveForm[\'students[\'+$index+\'].sex\'].$error"> <p ng-message="required">{{\'main.required\' | translate}}</p> </div> </td> <td md-cell> <hois-classifier-select ng-model="row.citizenship" name="students[{{$index}}].citizenship" model-value-attr="code" criteria="{vocational: formState.school.vocational ? true : undefined, higher: formState.school.higher ? true : undefined}" only-valid ignore-preselected main-classifier-code="RIIK" aria-label="{{\'directive.student.citizenship\' | translate}}"></hois-classifier-select> <div class="invalid" ng-messages="directiveForm[\'students[\'+$index+\'].citizenship\'].$error"> <p ng-message="required">{{\'main.required\' | translate}}</p> </div> </td> <td md-cell> <hois-select ng-model="row.curriculumVersion" name="students[{{$index}}].curriculumVersion" values="formState.curriculumVersions" ng-change="curriculumVersionChanged(row)" aria-label="{{\'directive.student.curriculumVersion\' | translate}}"></hois-select> <div class="invalid" ng-messages="directiveForm[\'students[\'+$index+\'].curriculumVersion\'].$error"> <p ng-message="required">{{\'main.required\' | translate}}</p> </div> </td> <td md-cell ng-if="formState.school.higher"> <hois-classifier-select ng-model="row.studyLoad" name="students[{{$index}}].studyLoad" criteria="{higher: true}" only-valid ignore-preselected model-value-attr="code" main-classifier-code="OPPEKOORMUS" aria-label="{{\'directive.student.studyLoad\' | translate}}" ng-disabled="row.curriculumVersionObject && row.curriculumVersionObject.isVocational"></hois-classifier-select> <div class="invalid" ng-messages="directiveForm[\'students[\'+$index+\'].studyLoad\'].$error"> <p ng-message="required">{{\'main.required\' | translate}}</p> </div> </td> <td md-cell> <hois-classifier-select ng-model="row.studyForm" name="students[{{$index}}].studyForm" show-only-values="visibleStudyForms(row.curriculumVersion)" criteria="{vocational: formState.school.vocational ? true : undefined, higher: formState.school.higher ? true : undefined}" only-valid ignore-preselected model-value-attr="code" main-classifier-code="OPPEVORM" aria-label="{{\'directive.student.studyForm\' | translate}}"></hois-classifier-select> <div class="invalid" ng-messages="directiveForm[\'students[\'+$index+\'].studyForm\'].$error"> <p ng-message="required">{{\'main.required\' | translate}}</p> </div> </td> <td md-cell> <md-datepicker ng-model="row.nominalStudyEnd" name="students[{{$index}}].nominalStudyEnd"></md-datepicker> <div class="invalid" ng-messages="directiveForm[\'students[\'+$index+\'].nominalStudyEnd\'].$error"> <p ng-message="required">{{\'main.required\' | translate}}</p> </div> </td> <td md-cell> <hois-classifier-select ng-model="row.fin" name="students[{{$index}}].fin" model-value-attr="code" ignore-preselected criteria="{vocational: formState.school.vocational ? true : undefined, higher: formState.school.higher ? true : undefined}" only-valid main-classifier-code="FINALLIKAS" aria-label="{{\'directive.student.fin\' | translate}}"></hois-classifier-select> <div class="invalid" ng-messages="directiveForm[\'students[\'+$index+\'].fin\'].$error"> <p ng-message="required">{{\'main.required\' | translate}}</p> </div> </td> <td md-cell> <hois-classifier-select ng-model="row.finSpecific" name="students[{{$index}}].finSpecific" model-value-attr="code" criteria="{vocational: formState.school.vocational ? true : undefined, higher: formState.school.higher ? true : undefined}" only-valid ignore-preselected main-classifier-code="FINTAPSUSTUS" aria-label="{{\'directive.student.finSpecific\' | translate}}"></hois-classifier-select> <div class="invalid" ng-messages="directiveForm[\'students[\'+$index+\'].finSpecific\'].$error"> <p ng-message="required">{{\'main.required\' | translate}}</p> </div> </td> <td md-cell> <hois-classifier-select ng-model="row.language" name="students[{{$index}}].language" show-only-values="formState.languageMap[row.curriculumVersion]" criteria="{vocational: formState.school.vocational ? true : undefined, higher: formState.school.higher ? true : undefined}" only-valid ignore-preselected model-value-attr="code" main-classifier-code="OPPEKEEL" aria-label="{{\'directive.student.language\' | translate}}"></hois-classifier-select> <div class="invalid" ng-messages="directiveForm[\'students[\'+$index+\'].language\'].$error"> <p ng-message="required">{{\'main.required\' | translate}}</p> </div> </td> <td md-cell> <hois-select ng-model="row.studentGroup" name="students[{{$index}}].studentGroup" values="formState.studentGroupMap[row.curriculumVersion]" aria-label="{{\'directive.student.studentGroup\' | translate}}"></hois-select> <div class="invalid" ng-messages="directiveForm[\'students[\'+$index+\'].studentGroup\'].$error"> <p ng-message="required">{{\'main.required\' | translate}}</p> </div> </td> <td md-cell> <hois-classifier-select ng-model="row.previousStudyLevel" name="students[{{$index}}].previousStudyLevel" criteria="{vocational: formState.school.vocational ? true : undefined, higher: formState.school.higher ? true : undefined}" only-valid ignore-preselected model-value-attr="code" main-classifier-code="OPPEASTE" aria-label="{{\'directive.student.previousStudyLevel\' | translate}}"></hois-classifier-select> <div class="invalid" ng-messages="directiveForm[\'students[\'+$index+\'].previousStudyLevel\'].$error"> <p ng-message="required">{{\'main.required\' | translate}}</p> </div> </td> <td md-cell ng-if="formState.school.vocational"> <hois-classifier-select ng-model="row.dormitory" name="students[{{$index}}].dormitory" model-value-attr="code" main-classifier-code="YHISELAMU" aria-label="{{\'directive.student.dormitory\' | translate}}" ng-disabled="row.curriculumVersionObject && !row.curriculumVersionObject.isVocational"></hois-classifier-select> <div class="invalid" ng-messages="directiveForm[\'students[\'+$index+\'].dormitory\'].$error"> <p ng-message="required">{{\'main.required\' | translate}}</p> </div> </td> <td md-cell> <a ng-click="deleteStudent(row)" md-no-ink class="remove">&times;</a> </td> </tr> </tbody> </table> </md-table-container>'),
a.put("directive/directive.type.immat.view.html",'<md-table-container> <table md-table md-row-select="formState.cancelSelect" multiple ng-model="formState.selectedStudents" class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'directive.student.order\' | translate}}</th> <th md-column>{{\'directive.student.foreign\' | translate}}</th> <th md-column>{{\'directive.student.fullname\' | translate}}</th> <th md-column>{{\'directive.student.idcode\' | translate}}</th> <th md-column>{{\'directive.student.birthdate\' | translate}}</th> <th md-column>{{\'directive.student.sex\' | translate}}</th> <th md-column>{{\'directive.student.citizenship\' | translate}}</th> <th md-column>{{\'directive.student.curriculumVersion\' | translate}}</th> <th md-column ng-if="formState.school.higher">{{\'directive.student.studyLoad\' | translate}}</th> <th md-column>{{\'directive.student.studyForm\' | translate}}</th> <th md-column>{{\'directive.student.nominalStudyEnd\' | translate}}</th> <th md-column>{{\'directive.student.fin\' | translate}}</th> <th md-column>{{\'directive.student.finSpecific\' | translate}}</th> <th md-column>{{\'directive.student.language\' | translate}}</th> <th md-column>{{\'directive.student.studentGroup\' | translate}}</th> <th md-column>{{\'directive.student.previousStudyLevel\' | translate}}</th> <th md-column ng-if="formState.school.vocational">{{\'directive.student.dormitory\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-disabled="!row.selectable" md-select="row" md-select-id="student" ng-repeat="row in record.students | orderBy:\'+lastname\'" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{$index + 1}}.</td> <td md-cell> <md-checkbox ng-model="row._foreign" aria-label="{{\'directive.student.foreign\' | translate}}" disabled></md-checkbox> </td> <td md-cell ng-if="row.student"> <a class="md-primary" ng-href="#/students/{{::row.student}}/main">{{::row.fullname}}</a> </td> <td ng-if="!row.student" md-cell>{{::row.fullname}}</td> <td md-cell>{{::(row.idcode || row.foreignIdcode)}}</td> <td md-cell> <hois-value value="row.birthdate | hoisDate"></hois-value> </td> <td md-cell> <hois-classifier-value ng-model="row.sex" main-classifier-code="SUGU"></hois-classifier-value> </td> <td md-cell> <hois-classifier-value ng-model="row.citizenship" main-classifier-code="RIIK"></hois-classifier-value> </td> <td md-cell>{{currentLanguageNameField(row.newCurriculumVersion)}}</td> <td md-cell ng-if="formState.school.higher"> <hois-classifier-value ng-model="row.studyLoad" main-classifier-code="OPPEKOORMUS"></hois-classifier-value> </td> <td md-cell> <hois-classifier-value ng-model="row.studyForm" main-classifier-code="OPPEVORM"></hois-classifier-value> </td> <td md-cell> <hois-value value="row.nominalStudyEnd | hoisDate"></hois-value> </td> <td md-cell> <hois-classifier-value ng-model="row.fin" main-classifier-code="FINALLIKAS"></hois-classifier-value> </td> <td md-cell> <hois-classifier-value ng-model="row.finSpecific" main-classifier-code="FINTAPSUSTUS"></hois-classifier-value> </td> <td md-cell> <hois-classifier-value ng-model="row.language" main-classifier-code="OPPEKEEL"></hois-classifier-value> </td> <td md-cell>{{::row.newStudentGroup}}</td> <td md-cell> <hois-classifier-value ng-model="row.previousStudyLevel" main-classifier-code="OPPEASTE"></hois-classifier-value> </td> <td md-cell ng-if="formState.school.vocational"> <hois-classifier-value ng-model="row.dormitory" main-classifier-code="YHISELAMU"></hois-classifier-value> </td> </tr> </tbody> </table> </md-table-container>'),a.put("directive/directive.type.immatv.edit.html",'<md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'directive.student.order\' | translate}}</th> <th md-column>{{\'directive.student.idcode\' | translate}}</th> <th md-column>{{\'directive.student.firstname\' | translate}}</th> <th md-column>{{\'directive.student.lastname\' | translate}}</th> <th md-column>{{\'directive.student.curriculumVersion\' | translate}}</th> <th md-column ng-if="formState.school.higher">{{\'directive.student.studyLoad\' | translate}}</th> <th md-column>{{\'directive.student.studyForm\' | translate}}</th> <th md-column>{{\'directive.student.nominalStudyEnd\' | translate}}</th> <th md-column>{{\'directive.student.language\' | translate}}</th> <th md-column>{{\'directive.student.fin\' | translate}}</th> <th md-column class="required">{{\'directive.student.finSpecific\' | translate}}</th> <th md-column class="required">{{\'directive.student.studentGroup\' | translate}}</th> <th md-column ng-if="formState.school.vocational" ng-class="{required: !formState.school.higher}">{{\'directive.student.dormitory\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in record.students" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{$index + 1}}.</td> <td md-cell> <hois-value value="::(row.idcode || row.foreignIdcode)"></hois-value> <input type="hidden" ng-model="row.dummyHiddenInputIdcode" name="students[{{$index}}].idcode"> <div class="invalid idcode" ng-messages="directiveForm[\'students[\'+$index+\'].idcode\'].$error"> <p ng-message="serverside"> </p><p ng-repeat="err in directiveForm[\'students[\'+$index+\'].idcode\'].$serverError">{{\'main.messages.error.\' + err.code | translate}}</p>  </div> </td> <td md-cell>{{::row.firstname}}</td> <td md-cell>{{::row.lastname}}</td> <td md-cell>{{currentLanguageNameField(formState.curriculumVersionMap[row.curriculumVersion])}}</td> <td md-cell ng-if="formState.school.higher"> <hois-classifier-value ng-model="row.studyLoad" main-classifier-code="OPPEKOORMUS"></hois-classifier-value> </td> <td md-cell> <hois-classifier-value ng-model="row.studyForm" main-classifier-code="OPPEVORM"></hois-classifier-value> </td> <td md-cell> <hois-value value="row.nominalStudyEnd | hoisDate"></hois-value> </td> <td md-cell> <hois-classifier-value ng-model="row.language" main-classifier-code="OPPEKEEL"></hois-classifier-value> </td> <td md-cell> <hois-classifier-value ng-model="row.fin" main-classifier-code="FINALLIKAS"></hois-classifier-value> </td> <td md-cell> <hois-classifier-select ng-model="row.finSpecific" name="students[{{$index}}].finSpecific" model-value-attr="code" criteria="{vocational: formState.school.vocational ? true : undefined, higher: formState.school.higher ? true : undefined}" only-valid ignore-preselected main-classifier-code="FINTAPSUSTUS" aria-label="{{\'directive.student.finSpecific\' | translate}}"></hois-classifier-select> <div class="invalid" ng-messages="directiveForm[\'students[\'+$index+\'].finSpecific\'].$error"> <p ng-message="required">{{\'main.required\' | translate}}</p> </div> </td> <td md-cell> <hois-select ng-model="row.studentGroup" name="students[{{$index}}].studentGroup" values="formState.studentGroupMap[row.curriculumVersion]" aria-label="{{\'directive.student.studentGroup\' | translate}}"></hois-select> <div class="invalid" ng-messages="directiveForm[\'students[\'+$index+\'].studentGroup\'].$error"> <p ng-message="required">{{\'main.required\' | translate}}</p> </div> </td> <td md-cell ng-if="formState.school.vocational"> <hois-classifier-select ng-model="row.dormitory" name="students[{{$index}}].dormitory" model-value-attr="code" main-classifier-code="YHISELAMU" aria-label="{{\'directive.student.dormitory\' | translate}}" ng-disabled="row.curriculumVersionObject && !row.curriculumVersionObject.isVocational"></hois-classifier-select> <div class="invalid" ng-messages="directiveForm[\'students[\'+$index+\'].dormitory\'].$error"> <p ng-message="required">{{\'main.required\' | translate}}</p> </div> </td> </tr> </tbody> </table> </md-table-container> <style>div.invalid.idcode[ng-messages] > p:last-child {\r\n  margin: 0;\r\n}</style>'),a.put("directive/directive.type.immatv.view.html",'<md-table-container> <table md-table md-row-select="formState.cancelSelect" multiple ng-model="formState.selectedStudents" class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'directive.student.order\' | translate}}</th> <th md-column>{{\'directive.student.fullname\' | translate}}</th> <th md-column>{{\'directive.student.idcode\' | translate}}</th> <th md-column>{{\'directive.student.curriculumVersion\' | translate}}</th> <th md-column ng-if="formState.school.higher">{{\'directive.student.studyLoad\' | translate}}</th> <th md-column>{{\'directive.student.studyForm\' | translate}}</th> <th md-column>{{\'directive.student.nominalStudyEnd\' | translate}}</th> <th md-column>{{\'directive.student.language\' | translate}}</th> <th md-column>{{\'directive.student.fin\' | translate}}</th> <th md-column>{{\'directive.student.finSpecific\' | translate}}</th> <th md-column>{{\'directive.student.studentGroup\' | translate}}</th> <th md-column ng-if="formState.school.vocational">{{\'directive.student.dormitory\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-disabled="!row.selectable" md-select="row" md-select-id="student" ng-repeat="row in record.students | orderBy:\'+lastname\'" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{$index + 1}}.</td> <td md-cell ng-if="row.student"> <a class="md-primary" ng-href="#/students/{{::row.student}}/main">{{::row.fullname}}</a> </td> <td ng-if="!row.student" md-cell>{{::row.fullname}}</td> <td md-cell>{{::(row.idcode || row.foreignIdcode)}}</td> <td md-cell>{{currentLanguageNameField(row.newCurriculumVersion)}}</td> <td md-cell ng-if="formState.school.higher"> <hois-classifier-value ng-model="row.studyLoad" main-classifier-code="OPPEKOORMUS"></hois-classifier-value> </td> <td md-cell> <hois-classifier-value ng-model="row.studyForm" main-classifier-code="OPPEVORM"></hois-classifier-value> </td> <td md-cell> <hois-value value="row.nominalStudyEnd | hoisDate"></hois-value> </td> <td md-cell> <hois-classifier-value ng-model="row.language" main-classifier-code="OPPEKEEL"></hois-classifier-value> </td> <td md-cell> <hois-classifier-value ng-model="row.fin" main-classifier-code="FINALLIKAS"></hois-classifier-value> </td> <td md-cell> <hois-classifier-value ng-model="row.finSpecific" main-classifier-code="FINTAPSUSTUS"></hois-classifier-value> </td> <td md-cell>{{::row.newStudentGroup}}</td> <td md-cell ng-if="formState.school.vocational"> <hois-classifier-value ng-model="row.dormitory" main-classifier-code="YHISELAMU"></hois-classifier-value> </td> </tr> </tbody> </table> </md-table-container>'),a.put("directive/directive.type.indok.edit.html",'<md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'directive.student.order\' | translate}}</th> <th md-column>{{\'directive.student.fullname\' | translate}}</th> <th md-column>{{\'directive.student.idcode\' | translate}}</th> <th md-column>{{\'directive.student.curriculum\' | translate}}</th> <th md-column>{{\'directive.student.studentGroup\' | translate}}</th> <th md-column class="required">{{\'main.from\' | translate}}</th> <th md-column class="required">{{\'main.thru\' | translate}}</th> <th md-column class="required">{{\'directive.student.modules\' | translate}}</th> <th></th> <th></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in record.students" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{$index + 1}}.</td> <td md-cell>{{::row.fullname}}</td> <td md-cell>{{::row.idcode}}</td> <td md-cell>{{currentLanguageNameField(row.curriculumVersionObject)}}</td> <td md-cell>{{currentLanguageNameField(row.studentGroupObject)}}</td> <td md-cell> <md-input-container> <md-datepicker ng-model="row.startDate" md-max-date="row.endDate" name="students[{{$index}}].startDate" aria-label="{{\'main.from\' | translate}}"></md-datepicker> </md-input-container> <div class="invalid" ng-messages="directiveForm[\'students[\'+$index+\'].startDate\'].$error"> <p ng-message="required">{{\'main.required\' | translate}}</p> </div> </td> <td md-cell> <md-input-container> <md-datepicker ng-model="row.endDate" md-min-date="row.startDate" name="students[{{$index}}].endDate" aria-label="{{\'main.thru\' | translate}}"></md-datepicker> </md-input-container> <div class="invalid" ng-messages="directiveForm[\'students[\'+$index+\'].endDate\'].$error"> <p ng-message="required">{{\'main.required\' | translate}}</p> </div> </td> <td md-cell> <div ng-repeat="module in row.modules | orderBy: \'module.\' + currentLanguageNameVariable() track by $index"> {{$index + 1}}. {{currentLanguageNameField(module.module)}}</div> <!-- hidden input to show "required" error if necessary --> <input ng-show="false" ng-model="row.modules" name="students[{{$index}}].modules"> <div class="invalid" ng-messages="directiveForm[\'students[\'+$index+\'].modules\'].$error"> <p ng-message="required">{{\'directive.atleastOneModuleRequired\' | translate}}</p> <p ng-message="serverside"> </p><p ng-repeat="err in directiveForm[\'students[\'+$index+\'].modules\'].$serverError"> {{ err.code | translate : {module: currentLanguageNameField(err.object), startDate : (err.startDate | hoisDate), endDate : (err.endDate | hoisDate) } }} </p>  </div> </td> <td md-cell> <md-button md-no-ink class="md-primary change-button" ng-click="individualCurriculumModules(row, $index)"> <span>{{!row.modules || row.modules.length === 0 ? (\'main.button.add\' | translate) : (\'main.button.change\' | translate)}}</span> </md-button> </td> <td md-cell> <a ng-click="deleteStudent(row)" md-no-ink class="remove">&times;</a> </td> </tr> </tbody> </table> </md-table-container>'),a.put("directive/directive.type.indok.view.html",'<md-table-container> <table md-table md-row-select="formState.cancelSelect" multiple ng-model="formState.selectedStudents" class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'directive.student.order\' | translate}}</th> <th md-column>{{\'directive.student.fullname\' | translate}}</th> <th md-column>{{\'directive.student.idcode\' | translate}}</th> <th md-column>{{\'directive.student.curriculum\' | translate}}</th> <th md-column>{{\'directive.student.studentGroup\' | translate}}</th> <th md-column>{{\'main.from\' | translate}}</th> <th md-column>{{\'main.thru\' | translate}}</th> <th md-column style="min-width:400px">{{\'directive.student.modules\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-disabled="!row.selectable" md-select="row" md-select-id="student" ng-repeat="row in record.students | orderBy:\'+lastname\'" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{$index + 1}}.</td> <td md-cell>{{::row.fullname}}</td> <td md-cell>{{::row.idcode}}</td> <td md-cell>{{currentLanguageNameField(row.curriculumVersionObject)}}</td> <td md-cell>{{currentLanguageNameField(row.studentGroupObject)}}</td> <td md-cell> <hois-value value="row.startDate | hoisDate"></hois-value> </td> <td md-cell> <hois-value value="row.endDate | hoisDate"></hois-value> </td> <td md-cell> <div ng-repeat="module in row.modules | orderBy: \'module.\' + currentLanguageNameVariable() track by $index"> {{$index + 1}}. {{currentLanguageNameField(module.module)}}</div> </td> <td md-cell> <md-button md-no-ink class="md-primary change-button" ng-click="individualCurriculumModules(row)"> <span>{{\'main.button.view\' | translate}}</span> </md-button> </td> </tr> </tbody> </table> </md-table-container>'),a.put("directive/directive.type.indoklop.edit.html",'<md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'directive.student.order\' | translate}}</th> <th md-column>{{\'directive.student.fullname\' | translate}}</th> <th md-column>{{\'directive.student.idcode\' | translate}}</th> <th md-column>{{\'directive.student.curriculum\' | translate}}</th> <th md-column>{{\'directive.student.studentGroup\' | translate}}</th> <th md-column class="required">{{\'directive.student.validEnd\' | translate}}</th> <th md-column class="required">{{\'directive.student.directive\' | translate}}</th> <th></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in record.students" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{$index + 1}}.</td> <td md-cell>{{::row.fullname}}</td> <td md-cell>{{::row.idcode}}</td> <td md-cell>{{currentLanguageNameField(row.curriculumVersionObject)}}</td> <td md-cell>{{currentLanguageNameField(row.studentGroupObject)}}</td> <td md-cell> <md-input-container> <md-datepicker ng-model="row.startDate" name="students[{{$index}}].startDate" aria-label="{{\'main.from\' | translate}}"></md-datepicker> </md-input-container> <div class="invalid" ng-messages="directiveForm[\'students[\'+$index+\'].startDate\'].$error"> <p ng-message="required">{{\'main.required\' | translate}}</p> <p ng-message="serverside"> <span ng-repeat="err in directiveForm[\'students[\'+$index+\'].startDate\'].$serverError">{{err.code | translate}}</span> </p> </div> </td> <td md-cell> <md-input-container style="width: 250px"> <md-select ng-model="row.directiveStudent" name="students[{{$index}}].directiveStudent" ng-disabled="row.directiveStudent && row.existingDirectiveStudents.length === 1"> <md-option ng-value="existingDirective.id" ng-repeat="existingDirective in row.existingDirectiveStudents"> {{existingDirective.directiveNr}} ({{existingDirective.startDate | hoisDate}} - {{existingDirective.endDate | hoisDate}}) </md-option> </md-select> </md-input-container> <div class="invalid" ng-messages="directiveForm[\'students[\'+$index+\'].directiveStudent\'].$error"> <p ng-message="required">{{\'main.required\' | translate}}</p> <p ng-message="serverside"> <span ng-repeat="err in directiveForm[\'students[\'+$index+\'].directiveStudent\'].$serverError">{{err.code | translate}}</span> </p> </div> </td> <td md-cell> <a ng-click="deleteStudent(row)" md-no-ink class="remove">&times;</a> </td> </tr> </tbody> </table> </md-table-container>'),a.put("directive/directive.type.indoklop.view.html",'<md-table-container> <table md-table md-row-select="formState.cancelSelect" multiple ng-model="formState.selectedStudents" class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'directive.student.order\' | translate}}</th> <th md-column>{{\'directive.student.fullname\' | translate}}</th> <th md-column>{{\'directive.student.idcode\' | translate}}</th> <th md-column>{{\'directive.student.curriculum\' | translate}}</th> <th md-column>{{\'directive.student.studentGroup\' | translate}}</th> <th md-column>{{\'directive.student.validEnd\' | translate}}</th> <th md-column>{{\'directive.student.directive\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-disabled="!row.selectable" md-select="row" md-select-id="student" ng-repeat="row in record.students" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{$index + 1}}.</td> <td md-cell>{{::row.fullname}}</td> <td md-cell>{{::row.idcode}}</td> <td md-cell>{{currentLanguageNameField(row.curriculumVersionObject)}}</td> <td md-cell>{{currentLanguageNameField(row.studentGroupObject)}}</td> <td md-cell>{{::row.startDate | hoisDate}}</td> <td md-cell> <span ng-if="row.directiveStudentObject"> {{::row.directiveStudentObject.directiveNr}} ({{::row.directiveStudentObject.startDate | hoisDate}} - {{::row.directiveStudentObject.endDate | hoisDate}}) </span> </td> </tr> </tbody> </table> </md-table-container>'),a.put("directive/directive.type.kiitus.edit.html",'<md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'directive.student.order\' | translate}}</th> <th md-column>{{\'directive.student.fullname\' | translate}}</th> <th md-column>{{\'directive.student.idcode\' | translate}}</th> <th md-column>{{\'directive.student.curriculumVersion\' | translate}}</th> <th md-column>{{\'directive.student.studentGroup\' | translate}}</th> <th md-column style="min-width:400px">{{\'directive.student.reason\' | translate}}</th> <th></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in record.students" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{$index + 1}}.</td> <td md-cell>{{::row.fullname}}</td> <td md-cell>{{::row.idcode}}</td> <td md-cell>{{currentLanguageNameField(row.curriculumVersionObject)}}</td> <td md-cell>{{currentLanguageNameField(row.studentGroupObject)}}</td> <td md-cell> <md-input-container style="width:100%"> <textarea name="students[{{$index}}].reason" ng-model="row.addInfo" md-maxlength="4000" max-rows="5" aria-label="{{\'directive.student.reason\' | translate}}"></textarea> </md-input-container> </td> <td md-cell> <a ng-click="deleteStudent(row)" md-no-ink class="remove">&times;</a> </td> </tr> </tbody> </table> </md-table-container>'),a.put("directive/directive.type.kiitus.view.html",'<md-table-container> <table md-table md-row-select="formState.cancelSelect" multiple ng-model="formState.selectedStudents" class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'directive.student.order\' | translate}}</th> <th md-column>{{\'directive.student.fullname\' | translate}}</th> <th md-column>{{\'directive.student.idcode\' | translate}}</th> <th md-column>{{\'directive.student.curriculumVersion\' | translate}}</th> <th md-column>{{\'directive.student.studentGroup\' | translate}}</th> <th md-column style="min-width:400px">{{\'directive.student.reason\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-disabled="!row.selectable" md-select="row" md-select-id="student" ng-repeat="row in record.students | orderBy:\'+lastname\'" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{$index + 1}}.</td> <td md-cell>{{::row.fullname}}</td> <td md-cell>{{::row.idcode}}</td> <td md-cell>{{currentLanguageNameField(row.curriculumVersionObject)}}</td> <td md-cell>{{currentLanguageNameField(row.studentGroupObject)}}</td> <td md-cell> <md-input-container style="width:100%"> <textarea ng-model="row.addInfo" md-maxlength="4000" max-rows="5" aria-label="{{\'directive.student.reason\' | translate}}" disabled></textarea> </md-input-container> </td> </tr> </tbody> </table> </md-table-container>'),a.put("directive/directive.type.lopet.edit.html",'<md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'directive.student.order\' | translate}}</th> <th md-column>{{\'directive.student.fullname\' | translate}}</th> <th md-column>{{\'directive.student.idcode\' | translate}}</th> <th md-column>{{\'directive.student.curriculumVersion\' | translate}}</th> <th md-column>{{record.isHigher ? \'directive.student.isCumLaude\' : \'directive.student.isCumLaudeVoc\' | translate}}</th> <th md-column ng-if="record.isHigher">{{\'directive.student.curriculumGrade\' | translate}}</th> <th md-column ng-if="!record.isHigher">{{\'directive.student.occupations\' | translate}}</th> <th></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in record.students" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{$index + 1}}.</td> <td md-cell>{{::row.fullname}}</td> <td md-cell>{{::row.idcode}}</td> <td md-cell>{{currentLanguageNameField(row.oldCurriculumVersion)}}</td> <td md-cell>{{row.isCumLaude ? \'main.yes\' : \'main.no\' | translate}}</td> <td md-cell ng-if="record.isHigher">{{currentLanguageNameField(row.curriculumGrade)}}</td> <td md-cell ng-if="!record.isHigher"> <div ng-repeat="occupation in row.occupations | orderBy: \'nameEt\'"> {{currentLanguageNameField(occupation)}} <span ng-if="row.specialities[occupation.code]"> (<span ng-repeat="speciality in row.specialities[occupation.code]"> <span>{{currentLanguageNameField(speciality)}}</span> <span ng-if="!$last">, </span> </span>) </span> </div> </td> <td md-cell> <a ng-click="deleteStudent(row)" md-no-ink class="remove">&times;</a> </td> </tr> </tbody> </table> </md-table-container>'),a.put("directive/directive.type.lopet.view.html",'<md-table-container> <table md-table md-row-select="formState.cancelSelect" multiple ng-model="formState.selectedStudents" class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'directive.student.order\' | translate}}</th> <th md-column>{{\'directive.student.fullname\' | translate}}</th> <th md-column>{{\'directive.student.idcode\' | translate}}</th> <th md-column>{{\'directive.student.curriculumVersion\' | translate}}</th> <th md-column>{{record.isHigher ? \'directive.student.isCumLaude\' : \'directive.student.isCumLaudeVoc\' | translate}}</th> <th md-column ng-if="record.isHigher">{{\'directive.student.curriculumGrade\' | translate}}</th> <th md-column ng-if="!record.isHigher">{{\'directive.student.occupations\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-disabled="!row.selectable" md-select="row" md-select-id="student" ng-repeat="row in record.students" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{$index + 1}}.</td> <td md-cell> <a class="md-primary" ng-href="#/students/{{::row.student}}/main">{{::row.fullname}}</a> </td> <td md-cell>{{::row.idcode}}</td> <td md-cell>{{currentLanguageNameField(row.newCurriculumVersion)}}</td> <td md-cell>{{row.isCumLaude ? \'main.yes\' : \'main.no\' | translate}}</td> <td md-cell ng-if="record.isHigher">{{currentLanguageNameField(row.curriculumGrade)}}</td> <td md-cell ng-if="!record.isHigher"> <div ng-repeat="occupation in row.occupations | orderBy: \'nameEt\'"> <span>{{currentLanguageNameField(occupation)}}</span> <span ng-if="row.specialities[occupation.code]"> (<span ng-repeat="speciality in row.specialities[occupation.code]"> <span>{{currentLanguageNameField(speciality)}}</span> <span ng-if="!$last">, </span> </span>) </span> </div> </td> </tr> </tbody> </table> </md-table-container>'),a.put("directive/directive.type.noomi.edit.html",'<md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'directive.student.order\' | translate}}</th> <th md-column>{{\'directive.student.fullname\' | translate}}</th> <th md-column>{{\'directive.student.idcode\' | translate}}</th> <th md-column>{{\'directive.student.curriculumVersion\' | translate}}</th> <th md-column>{{\'directive.student.studentGroup\' | translate}}</th> <th md-column style="min-width:400px">{{\'directive.student.reason\' | translate}}</th> <th></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in record.students" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{$index + 1}}.</td> <td md-cell>{{::row.fullname}}</td> <td md-cell>{{::row.idcode}}</td> <td md-cell>{{currentLanguageNameField(row.curriculumVersionObject)}}</td> <td md-cell>{{currentLanguageNameField(row.studentGroupObject)}}</td> <td md-cell> <md-input-container style="width:100%"> <textarea name="students[{{$index}}].reason" ng-model="row.addInfo" md-maxlength="4000" max-rows="5" aria-label="{{\'directive.student.reason\' | translate}}"></textarea> </md-input-container> </td> <td md-cell> <a ng-click="deleteStudent(row)" md-no-ink class="remove">&times;</a> </td> </tr> </tbody> </table> </md-table-container>'),a.put("directive/directive.type.noomi.view.html",'<md-table-container> <table md-table md-row-select="formState.cancelSelect" multiple ng-model="formState.selectedStudents" class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'directive.student.order\' | translate}}</th> <th md-column>{{\'directive.student.fullname\' | translate}}</th> <th md-column>{{\'directive.student.idcode\' | translate}}</th> <th md-column>{{\'directive.student.curriculumVersion\' | translate}}</th> <th md-column>{{\'directive.student.studentGroup\' | translate}}</th> <th md-column style="min-width:400px">{{\'directive.student.reason\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-disabled="!row.selectable" md-select="row" md-select-id="student" ng-repeat="row in record.students | orderBy:\'+lastname\'" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{$index + 1}}.</td> <td md-cell>{{::row.fullname}}</td> <td md-cell>{{::row.idcode}}</td> <td md-cell>{{currentLanguageNameField(row.curriculumVersionObject)}}</td> <td md-cell>{{currentLanguageNameField(row.studentGroupObject)}}</td> <td md-cell> <md-input-container style="width:100%"> <textarea ng-model="row.addInfo" md-maxlength="4000" max-rows="5" aria-label="{{\'directive.student.reason\' | translate}}" disabled></textarea> </md-input-container> </td> </tr> </tbody> </table> </md-table-container>'),a.put("directive/directive.type.okava.edit.html",'<md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'directive.student.order\' | translate}}</th> <th md-column>{{\'directive.student.fullname\' | translate}}</th> <th md-column>{{\'directive.student.idcode\' | translate}}</th> <th md-column>{{\'directive.student.oldCurriculumVersion\' | translate}}</th> <th md-column>{{\'directive.student.oldStudyForm\' | translate}}</th> <th md-column class="required">{{\'directive.student.newCurriculumVersion\' | translate}}</th> <th md-column class="required">{{\'directive.student.newStudyForm\' | translate}}</th> <th md-column class="required">{{\'directive.student.newStudentGroup\' | translate}}</th> <th></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in record.students" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{$index + 1}}.</td> <td md-cell>{{::row.fullname}}</td> <td md-cell>{{::row.idcode}}</td> <td md-cell>{{currentLanguageNameField(row.oldCurriculumVersion)}}</td> <td md-cell> <hois-classifier-value ng-model="row.oldStudyForm" main-classifier-code="OPPEVORM"></hois-classifier-value> </td> <td md-cell> <hois-select ng-model="row.curriculumVersion" name="students[{{$index}}].curriculumVersion" values="formState.curriculumVersions" ng-change="curriculumVersionChanged(row)" filter-values="[row.oldCurriculumVersion]" aria-label="{{\'directive.student.newCurriculumVersion\' | translate}}"></hois-select> <div class="invalid" ng-show="directiveForm[\'students[\'+$index+\'].curriculumVersion\'].$error.required"> {{\'main.required\' | translate}} </div> </td> <td md-cell> <hois-classifier-select ng-model="row.studyForm" name="students[{{$index}}].studyForm" show-only-values="visibleStudyForms(row.curriculumVersion)" criteria="{vocational: formState.school.vocational ? true : undefined, higher: formState.school.higher ? true : undefined}" only-valid ignore-preselected model-value-attr="code" main-classifier-code="OPPEVORM" aria-label="{{\'directive.student.newStudyForm\' | translate}}"></hois-classifier-select> <div class="invalid" ng-show="directiveForm[\'students[\'+$index+\'].studyForm\'].$error.required"> {{\'main.required\' | translate}} </div> </td> <td md-cell> <hois-select ng-model="row.studentGroup" name="students[{{$index}}].studentGroup" values="formState.studentGroupMap[row.curriculumVersion]" aria-label="{{\'directive.student.newStudentGroup\' | translate}}"></hois-select> <div class="invalid" ng-show="directiveForm[\'students[\'+$index+\'].studentGroup\'].$error.required"> {{\'main.required\' | translate}} </div> </td> <td md-cell> <a ng-click="deleteStudent(row)" md-no-ink class="remove">&times;</a> </td> </tr> </tbody> </table> </md-table-container>'),a.put("directive/directive.type.okava.view.html",'<md-table-container> <table md-table md-row-select="formState.cancelSelect" multiple ng-model="formState.selectedStudents" class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'directive.student.order\' | translate}}</th> <th md-column>{{\'directive.student.fullname\' | translate}}</th> <th md-column>{{\'directive.student.idcode\' | translate}}</th> <th md-column ng-if="record.status !== \'KASKKIRI_STAATUS_KINNITATUD\'">{{\'directive.student.oldCurriculumVersion\' | translate}}</th> <th md-column ng-if="record.status !== \'KASKKIRI_STAATUS_KINNITATUD\'">{{\'directive.student.oldStudyForm\' | translate}}</th> <th md-column>{{\'directive.student.newCurriculumVersion\' | translate}}</th> <th md-column>{{\'directive.student.newStudyForm\' | translate}}</th> <th md-column>{{\'directive.student.newStudentGroup\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-disabled="!row.selectable" md-select="row" md-select-id="student" ng-repeat="row in record.students | orderBy:\'+lastname\'" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{$index + 1}}.</td> <td md-cell> <a class="md-primary" ng-href="#/students/{{::row.student}}/main">{{::row.fullname}}</a> </td> <td md-cell>{{::row.idcode}}</td> <td md-cell ng-if="record.status !== \'KASKKIRI_STAATUS_KINNITATUD\'">{{currentLanguageNameField(row.oldCurriculumVersion)}}</td> <td md-cell ng-if="record.status !== \'KASKKIRI_STAATUS_KINNITATUD\'"> <hois-classifier-value ng-model="row.oldStudyForm" main-classifier-code="OPPEVORM"></hois-classifier-value> </td> <td md-cell>{{currentLanguageNameField(row.newCurriculumVersion)}}</td> <td md-cell> <hois-classifier-value ng-model="row.studyForm" main-classifier-code="OPPEVORM"></hois-classifier-value> </td> <td md-cell>{{::row.newStudentGroup}}</td> </tr> </tbody> </table> </md-table-container>'),
a.put("directive/directive.type.okoorm.edit.html",'<md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'directive.student.order\' | translate}}</th> <th md-column>{{\'directive.student.fullname\' | translate}}</th> <th md-column>{{\'directive.student.idcode\' | translate}}</th> <th md-column>{{\'directive.student.newStudyLoad\' | translate}}</th> <th md-column class="required">{{\'directive.student.fin\' | translate}}</th> <th md-column class="required">{{\'directive.student.finSpecific\' | translate}}</th> <th></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in record.students" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{$index + 1}}.</td> <td md-cell>{{::row.fullname}}</td> <td md-cell>{{::row.idcode}}</td> <td md-cell>{{\'directive.student.studyLoad\'+row.studyLoad | translate}}</td> <td md-cell> <hois-classifier-value ng-model="row.fin" name="students[{{$index}}].fin" main-classifier-code="FINALLIKAS"></hois-classifier-value> <div class="invalid" ng-show="directiveForm[\'students[\'+$index+\'].fin\'].$error.required"> {{\'main.required\' | translate}} </div> </td> <td md-cell> <hois-classifier-select ng-model="row.finSpecific" name="students[{{$index}}].finSpecific" criteria="{vocational: formState.school.vocational ? true : undefined, higher: formState.school.higher ? true : undefined}" only-valid ignore-preselected filter-values="[row.oldFinSpecific]" model-value-attr="code" main-classifier-code="FINTAPSUSTUS" aria-label="{{\'directive.student.finSpecific\' | translate}}"></hois-classifier-select> <div class="invalid" ng-show="directiveForm[\'students[\'+$index+\'].finSpecific\'].$error.required"> {{\'main.required\' | translate}} </div> </td> <td md-cell> <a ng-click="deleteStudent(row)" md-no-ink class="remove">&times;</a> </td> </tr> </tbody> </table> </md-table-container>'),a.put("directive/directive.type.okoorm.view.html",'<md-table-container> <table md-table md-row-select="formState.cancelSelect" multiple ng-model="formState.selectedStudents" class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'directive.student.order\' | translate}}</th> <th md-column>{{\'directive.student.fullname\' | translate}}</th> <th md-column>{{\'directive.student.idcode\' | translate}}</th> <th md-column>{{\'directive.student.newStudyLoad\' | translate}}</th> <th md-column>{{\'directive.student.fin\' | translate}}</th> <th md-column>{{\'directive.student.finSpecific\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-disabled="!row.selectable" md-select="row" md-select-id="student" ng-repeat="row in record.students | orderBy:\'+lastname\'" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{$index + 1}}.</td> <td md-cell> <a class="md-primary" ng-href="#/students/{{::row.student}}/main">{{::row.fullname}}</a> </td> <td md-cell>{{::row.idcode}}</td> <td md-cell>{{\'directive.student.studyLoad\'+row.studyLoad | translate}}</td> <td md-cell> <hois-classifier-value ng-model="row.fin" main-classifier-code="FINALLIKAS"></hois-classifier-value> </td> <td md-cell> <hois-classifier-value ng-model="row.finSpecific" main-classifier-code="FINTAPSUSTUS"></hois-classifier-value> </td> </tr> </tbody> </table> </md-table-container>'),a.put("directive/directive.type.otegevus.edit.html",'<md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'directive.student.order\' | translate}}</th> <th md-column>{{\'directive.student.fullname\' | translate}}</th> <th md-column>{{\'directive.student.idcode\' | translate}}</th> <th md-column>{{\'directive.student.curriculumVersion\' | translate}}</th> <th md-column>{{\'directive.student.studentGroup\' | translate}}</th> <th md-column>{{\'directive.student.studyActivityStartDate\' | translate}}</th> <th md-column>{{\'directive.student.studyActivityEndDate\' | translate}}</th> <th md-column>{{\'directive.student.studyActivityIsAbsence\' | translate}}</th> <th></th> </tr> <tr> <th colspan="5"></th> <th md-column> <md-datepicker ng-model="record.studyActivityStartDate" md-max-date="record.studyActivityEndDate" ng-blur="allStudyActivityChange(\'startDate\', record.studyActivityStartDate)" aria-label="{{\'directive.student.studyActivityStartDate\' | translate}}"></md-datepicker> </th> <th md-column> <md-datepicker ng-model="record.studyActivityEndDate" md-min-date="record.studyActivityStartDate" ng-blur="allStudyActivityChange(\'endDate\', record.studyActivityEndDate)" aria-label="{{\'directive.student.studyActivityEndDate\' | translate}}"></md-datepicker> </th> <th md-column> <md-checkbox ng-model="record.studyActivityIsAbsence" ng-disabled="!record.studyActivityStartDate || !record.studyActivityEndDate" ng-change="allStudyActivityChange(\'isAbsence\', record.studyActivityIsAbsence)" aria-label="{{\'directive.student.studyActivityIsAbsence\' | translate}}"></md-checkbox> </th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in record.students" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{$index + 1}}.</td> <td md-cell>{{::row.fullname}}</td> <td md-cell>{{::row.idcode}}</td> <td md-cell>{{currentLanguageNameField(row.curriculumVersionObject)}}</td> <td md-cell>{{currentLanguageNameField(row.studentGroupObject)}}</td> <td md-cell> <md-datepicker ng-model="row.startDate" md-max-date="row.endDate" name="students[{{$index}}].startDate" ng-change="studyActivityDateChange(row)" aria-label="{{\'directive.student.studyActivityStartDate\' | translate}}"></md-datepicker> </td> <td md-cell> <md-datepicker ng-model="row.endDate" md-min-date="row.startDate" name="students[{{$index}}].endDate" ng-change="studyActivityDateChange(row)" aria-label="{{\'directive.student.studyActivityEndDate\' | translate}}"></md-datepicker> </td> <td md-cell> <md-checkbox ng-model="row.isAbsence" ng-disabled="!row.startDate || !row.endDate" aria-label="{{\'directive.student.studyActivityIsAbsence\' | translate}}"></md-checkbox> </td> <td md-cell> <a ng-click="deleteStudent(row)" md-no-ink class="remove">&times;</a> </td> </tr> </tbody> </table> </md-table-container>'),a.put("directive/directive.type.otegevus.view.html","<md-table-container> <table md-table md-row-select=\"formState.cancelSelect\" multiple ng-model=\"formState.selectedStudents\" class=\"secondary-table\"> <thead md-head> <tr md-row> <th md-column>{{'directive.student.order' | translate}}</th> <th md-column>{{'directive.student.fullname' | translate}}</th> <th md-column>{{'directive.student.idcode' | translate}}</th> <th md-column>{{'directive.student.curriculumVersion' | translate}}</th> <th md-column>{{'directive.student.studentGroup' | translate}}</th> <th md-column>{{'directive.student.studyActivityStartDate' | translate}}</th> <th md-column>{{'directive.student.studyActivityEndDate' | translate}}</th> <th md-column>{{'directive.student.studyActivityIsAbsence' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-disabled=\"!row.selectable\" md-select=\"row\" md-select-id=\"student\" ng-repeat=\"row in record.students | orderBy:'+lastname'\" ng-class-odd=\"'odd'\" ng-class-even=\"'even'\"> <td md-cell>{{$index + 1}}.</td> <td md-cell>{{::row.fullname}}</td> <td md-cell>{{::row.idcode}}</td> <td md-cell>{{currentLanguageNameField(row.curriculumVersionObject)}}</td> <td md-cell>{{currentLanguageNameField(row.studentGroupObject)}}</td> <td md-cell>{{::row.startDate | hoisDate}}</td> <td md-cell>{{::row.endDate | hoisDate}}</td> <td md-cell>{{row.isAbsence ? ('main.yes' | translate) : ('main.no' | translate)}}</td> </tr> </tbody> </table> </md-table-container>"),a.put("directive/directive.type.ovorm.edit.html",'<md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'directive.student.order\' | translate}}</th> <th md-column>{{\'directive.student.fullname\' | translate}}</th> <th md-column>{{\'directive.student.idcode\' | translate}}</th> <th md-column>{{\'directive.student.oldStudyForm\' | translate}}</th> <th md-column class="required">{{\'directive.student.newStudyForm\' | translate}}</th> <th md-column>{{\'directive.student.studentGroup\' | translate}}</th> <th></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in record.students" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{$index + 1}}.</td> <td md-cell>{{::row.fullname}}</td> <td md-cell>{{::row.idcode}}</td> <td md-cell> <hois-classifier-value ng-model="row.oldStudyForm" main-classifier-code="OPPEVORM"></hois-classifier-value> </td> <td md-cell> <hois-classifier-select ng-model="row.studyForm" name="students[{{$index}}].studyForm" criteria="{higher: true}" only-valid filter-values="[row.oldStudyForm]" model-value-attr="code" main-classifier-code="OPPEVORM" ignore-preselected aria-label="{{\'directive.student.newStudyForm\' | translate}}"></hois-classifier-select> <div class="invalid" ng-show="directiveForm[\'students[\'+$index+\'].studyForm\'].$error.required"> {{\'main.required\' | translate}} </div> </td> <td md-cell> <hois-select ng-model="row.studentGroup" name="students[{{$index}}].studentGroup" values="formState.studentGroupMap[row.oldCurriculumVersion.id]" aria-label="{{\'directive.student.studentGroup\' | translate}}"></hois-select> </td> <td md-cell> <a ng-click="deleteStudent(row)" md-no-ink class="remove">&times;</a> </td> </tr> </tbody> </table> </md-table-container>'),a.put("directive/directive.type.ovorm.view.html",'<md-table-container> <table md-table md-row-select="formState.cancelSelect" multiple ng-model="formState.selectedStudents" class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'directive.student.order\' | translate}}</th> <th md-column>{{\'directive.student.fullname\' | translate}}</th> <th md-column>{{\'directive.student.idcode\' | translate}}</th> <th md-column>{{\'directive.student.oldStudyForm\' | translate}}</th> <th md-column>{{\'directive.student.newStudyForm\' | translate}}</th> <th md-column>{{\'directive.student.studentGroup\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-disabled="!row.selectable" md-select="row" md-select-id="student" ng-repeat="row in record.students | orderBy:\'+lastname\'" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{$index + 1}}.</td> <td md-cell> <a class="md-primary" ng-href="#/students/{{::row.student}}/main">{{::row.fullname}}</a> </td> <td md-cell>{{::row.idcode}}</td> <td md-cell> <hois-classifier-value ng-model="row.oldStudyForm" main-classifier-code="OPPEVORM"></hois-classifier-value> </td> <td md-cell> <hois-classifier-value ng-model="row.studyForm" main-classifier-code="OPPEVORM"></hois-classifier-value> </td> <td md-cell>{{::row.newStudentGroup}}</td> </tr> </tbody> </table> </md-table-container>'),a.put("directive/directive.type.praktik.edit.html",'<md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'directive.student.order\' | translate}}</th> <th md-column>{{\'directive.student.fullname\' | translate}}</th> <th md-column>{{\'directive.student.idcode\' | translate}}</th> <th md-column>{{\'directive.student.curriculumVersion\' | translate}}</th> <th md-column>{{\'directive.student.studentGroup\' | translate}}</th> <th md-column>{{\'directive.student.practiceStartDate\' | translate}}</th> <th md-column>{{\'directive.student.practiceEndDate\' | translate}}</th> <th></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in record.students" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{$index + 1}}.</td> <td md-cell>{{::row.fullname}}</td> <td md-cell>{{::row.idcode}}</td> <td md-cell>{{currentLanguageNameField(row.curriculumVersionObject)}}</td> <td md-cell>{{currentLanguageNameField(row.studentGroupObject)}}</td> <td md-cell> <md-datepicker ng-model="row.startDate" md-max-date="row.endDate" name="students[{{$index}}].startDate" aria-label="{{\'directive.student.practiceStartDate\' | translate}}"></md-datepicker> </td> <td md-cell> <md-datepicker ng-model="row.endDate" md-min-date="row.startDate" name="students[{{$index}}].endDate" aria-label="{{\'directive.student.practiceEndDate\' | translate}}"></md-datepicker> </td> <td md-cell> <a ng-click="deleteStudent(row)" md-no-ink class="remove">&times;</a> </td> </tr> </tbody> </table> </md-table-container>'),a.put("directive/directive.type.praktik.view.html","<md-table-container> <table md-table md-row-select=\"formState.cancelSelect\" multiple ng-model=\"formState.selectedStudents\" class=\"secondary-table\"> <thead md-head> <tr md-row> <th md-column>{{'directive.student.order' | translate}}</th> <th md-column>{{'directive.student.fullname' | translate}}</th> <th md-column>{{'directive.student.idcode' | translate}}</th> <th md-column>{{'directive.student.curriculumVersion' | translate}}</th> <th md-column>{{'directive.student.studentGroup' | translate}}</th> <th md-column>{{'directive.student.practiceStartDate' | translate}}</th> <th md-column>{{'directive.student.practiceEndDate' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-disabled=\"!row.selectable\" md-select=\"row\" md-select-id=\"student\" ng-repeat=\"row in record.students | orderBy:'+lastname'\" ng-class-odd=\"'odd'\" ng-class-even=\"'even'\"> <td md-cell>{{$index + 1}}.</td> <td md-cell>{{::row.fullname}}</td> <td md-cell>{{::row.idcode}}</td> <td md-cell>{{currentLanguageNameField(row.curriculumVersionObject)}}</td> <td md-cell>{{currentLanguageNameField(row.studentGroupObject)}}</td> <td md-cell>{{::row.startDate | hoisDate}}</td> <td md-cell>{{::row.endDate | hoisDate}}</td> </tr> </tbody> </table> </md-table-container>"),a.put("directive/directive.type.stiptoet.edit.html",'<md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'directive.student.order\' | translate}}</th> <th md-column>{{\'directive.student.fullname\' | translate}}</th> <th md-column>{{\'directive.student.idcode\' | translate}}</th> <th md-column class="required">{{\'directive.student.scholarship\' | translate}}</th> <th md-column>{{\'directive.student.bankAccount\' | translate}}</th> <th md-column ng-class="{required: formState.scholarshipEditable}">{{\'directive.student.amountPaid\' | translate}}</th> <th md-column ng-class="{required: formState.scholarshipEditable}">{{\'directive.student.stipStartDate\' | translate}}</th> <th md-column ng-class="{required: formState.scholarshipEditable}">{{\'directive.student.stipEndDate\' | translate}}</th> <th></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in record.students" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{$index + 1}}.</td> <td md-cell>{{::row.fullname}}</td> <td md-cell>{{::row.idcode}}</td> <td md-cell> <md-input-container style="width: 250px"> <md-select ng-model="row.scholarshipApplication" ng-change="scholarshipApplicationChanged(row)" name="students[{{$index}}].scholarshipApplication" ng-disabled="row.scholarshipApplication && row.scholarshipApplications.length === 1"> <md-option ng-value="application.id" ng-repeat="application in row.scholarshipApplications"> {{application.nameEt}} </md-option> </md-select> </md-input-container> <div class="invalid" ng-messages="directiveForm[\'students[\'+$index+\'].scholarshipApplication\'].$error"> <p ng-message="required">{{\'main.required\' | translate}}</p> <p ng-message="serverside"> <span ng-repeat="err in directiveForm[\'students[\'+$index+\'].scholarshipApplication\'].$serverError">{{err.code | translate}}</span> </p> </div> </td> <td md-cell>{{row.bankAccount}}</td> <td md-cell> <md-input-container> <input ng-model="row.amountPaid" ng-disabled="!formState.scholarshipEditable" min="0" max="9999" type="number" name="students[{{$index}}].amountPaid"> </md-input-container> <div ng-messages="directiveForm[\'students[\'+$index+\'].amountPaid\'].$error" ng-show="directiveForm[\'students[\'+$index+\'].amountPaid\'].$dirty"> <div ng-message="max"> {{\'curriculum.error.max9999\' | translate}} </div> </div> <div class="invalid" ng-show="directiveForm[\'students[\'+$index+\'].amountPaid\'].$error.required"> {{\'main.required\' | translate}} </div> </td> <td md-cell> <md-datepicker ng-model="row.startDate" ng-disabled="!formState.scholarshipEditable" md-max-date="row.endDate" name="students[{{$index}}].startDate"></md-datepicker> <div class="invalid" ng-show="directiveForm[\'students[\'+$index+\'].startDate\'].$error.required"> {{\'main.required\' | translate}} </div> </td> <td md-cell> <md-datepicker ng-model="row.endDate" ng-disabled="!formState.scholarshipEditable" md-min-date="row.startDate" name="students[{{$index}}].endDate"></md-datepicker> <div class="invalid" ng-show="directiveForm[\'students[\'+$index+\'].endDate\'].$error.required"> {{\'main.required\' | translate}} </div> </td> <td md-cell> <a ng-click="deleteStudent(row)" md-no-ink class="remove">&times;</a> </td> </tr> </tbody> </table> </md-table-container>'),a.put("directive/directive.type.stiptoet.view.html",'<md-table-container> <table md-table md-row-select="formState.cancelSelect" multiple ng-model="formState.selectedStudents" class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'directive.student.order\' | translate}}</th> <th md-column>{{\'directive.student.fullname\' | translate}}</th> <th md-column>{{\'directive.student.idcode\' | translate}}</th> <th md-column>{{\'directive.student.scholarship\' | translate}}</th> <th md-column>{{\'directive.student.bankAccount\' | translate}}</th> <th md-column>{{\'directive.student.amountPaid\' | translate}}</th> <th md-column>{{\'directive.student.stipStartDate\' | translate}}</th> <th md-column>{{\'directive.student.stipEndDate\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-disabled="!row.selectable" md-select="row" md-select-id="student" ng-repeat="row in record.students | orderBy:\'+lastname\'" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{$index + 1}}.</td> <td md-cell> <a class="md-primary" ng-href="#/students/{{::row.student}}/main">{{::row.fullname}}</a> </td> <td md-cell>{{::row.idcode}}</td> <td md-cell>{{currentLanguageNameField(row.scholarshipApplicationObject)}}</td> <td md-cell>{{::row.bankAccount}}</td> <td md-cell> <hois-value value="row.amountPaid"></hois-value> </td> <td md-cell> <hois-value value="row.startDate | hoisDate"></hois-value> </td> <td md-cell> <hois-value value="row.endDate | hoisDate"></hois-value> </td> </tr> </tbody> </table> </md-table-container>'),a.put("directive/directive.type.stiptoetl.edit.html",'<md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'directive.student.order\' | translate}}</th> <th md-column>{{\'directive.student.fullname\' | translate}}</th> <th md-column>{{\'directive.student.idcode\' | translate}}</th> <th md-column class="required">{{\'directive.student.directive\' | translate}}</th> <th md-column>{{\'directive.student.stipStartDate\' | translate}}</th> <th md-column>{{\'directive.student.stipEndDate\' | translate}}</th> <th md-column class="required">{{\'directive.student.stipEndReason\' | translate}}</th> <th></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in record.students" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{$index + 1}}.</td> <td md-cell>{{::row.fullname}}</td> <td md-cell>{{::row.idcode}}</td> <td md-cell> <md-input-container style="width: 250px"> <md-select ng-model="row.directiveStudent" ng-change="scholarshipDirectiveChanged(row)" name="students[{{$index}}].directiveStudent" ng-disabled="row.directiveStudent && row.existingDirectiveStudents.length === 1"> <md-option ng-value="existingDirective.id" ng-repeat="existingDirective in row.existingDirectiveStudents"> {{existingDirective.directiveNr}} ({{existingDirective.scholarshipTermNameEt}}, {{existingDirective.confirmDate | hoisDate}}) </md-option> </md-select> </md-input-container> <div class="invalid" ng-messages="directiveForm[\'students[\'+$index+\'].directiveStudent\'].$error"> <p ng-message="required">{{\'main.required\' | translate}}</p> <p ng-message="serverside"> <span ng-repeat="err in directiveForm[\'students[\'+$index+\'].directiveStudent\'].$serverError">{{err.code | translate}}</span> </p> </div> </td> <td md-cell> <hois-value value="row.startDate | hoisDate"></hois-value> </td> <td md-cell> <hois-value value="row.endDate | hoisDate"></hois-value> </td> <td md-cell> <hois-classifier-select ng-model="row.reason" name="students[{{$index}}].reason" ignore-preselected criteria="{higher: formState.school.higher ? true : undefined, vocational: formState.school.vocational ? true : undefined}" model-value-attr="code" main-classifier-code="KASKKIRI_STIPTOETL_POHJUS" aria-label="{{\'directive.student.reason\' | translate}}" only-valid style="width: 200px"></hois-classifier-select> <div class="invalid" ng-show="directiveForm[\'students[\'+$index+\'].reason\'].$error.required"> {{\'main.required\' | translate}} </div> </td> <td md-cell> <a ng-click="deleteStudent(row)" md-no-ink class="remove">&times;</a> </td> </tr> </tbody> </table> </md-table-container>'),a.put("directive/directive.type.stiptoetl.view.html",'<md-table-container> <table md-table md-row-select="formState.cancelSelect" multiple ng-model="formState.selectedStudents" class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'directive.student.order\' | translate}}</th> <th md-column>{{\'directive.student.fullname\' | translate}}</th> <th md-column>{{\'directive.student.idcode\' | translate}}</th> <th md-column>{{\'directive.student.directive\' | translate}}</th> <th md-column>{{\'directive.student.stipStartDate\' | translate}}</th> <th md-column>{{\'directive.student.stipEndDate\' | translate}}</th> <th md-column>{{\'directive.student.stipEndReason\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-disabled="!row.selectable" md-select="row" md-select-id="student" ng-repeat="row in record.students | orderBy:\'+lastname\'" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{$index + 1}}.</td> <td md-cell> <a class="md-primary" ng-href="#/students/{{::row.student}}/main">{{::row.fullname}}</a> </td> <td md-cell>{{::row.idcode}}</td> <td md-cell> <span ng-if="row.directiveStudentObject"> {{::row.directiveStudentObject.directiveNr}} ({{::row.directiveStudentObject.scholarshipTermNameEt}}, {{::row.directiveStudentObject.confirmDate | hoisDate}}) </span> </td> <td md-cell> <hois-value value="row.startDate | hoisDate"></hois-value> </td> <td md-cell> <hois-value value="row.endDate | hoisDate"></hois-value> </td> <td md-cell> <hois-classifier-value ng-model="row.reason" main-classifier-code="KASKKIRI_STIPTOETL_POHJUS"></hois-classifier-value> </td> </tr> </tbody> </table> </md-table-container>'),a.put("directive/directive.type.tugi.edit.html",'<md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'directive.student.order\' | translate}}</th> <th md-column>{{\'directive.student.fullname\' | translate}}</th> <th md-column>{{\'directive.student.idcode\' | translate}}</th> <th md-column>{{\'directive.student.studentGroup\' | translate}}</th> <th md-column style="min-width: 200px">{{\'directive.student.supportServices\' | translate}}</th> <th md-column style="min-width: 200px">{{\'directive.student.supportModules\' | translate}}</th> <th md-column class="required">{{\'directive.student.nominalStudyEnd\' | translate}}</th> <th md-column class="required">{{\'directive.student.supportServiceStartDate\' | translate}}</th> <th md-column class="required">{{\'directive.student.supportServiceEndDate\' | translate}}</th> <th></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat-start="row in record.students" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{$index + 1}}.</td> <td md-cell>{{::row.fullname}}</td> <td md-cell>{{::row.idcode}}</td> <td md-cell>{{::(currentLanguageNameField(row.studentGroupObject))}}</td> <td md-cell> <ul style="padding-left: 1.5em"> <li ng-repeat="service in row.supportServices | orderBy: currentLanguageNameField()" style="margin-bottom: 0.25em">{{::(currentLanguageNameField(service))}}</li> </ul> </td> <td md-cell> <ul style="padding-left: 1.5em"> <li ng-repeat="module in row.supportModules | orderBy: currentLanguageNameField()" style="margin-bottom: 0.25em">{{::(currentLanguageNameField(module))}}</li> </ul> <!-- hidden input to show errors if necessary --> <input ng-show="false" ng-model="row.modules" name="students[{{$index}}].modules"> <div class="invalid" ng-messages="directiveForm[\'students[\'+$index+\'].modules\'].$error"> <p ng-message="serverside"> </p><p ng-repeat="err in directiveForm[\'students[\'+$index+\'].modules\'].$serverError"> {{ err.code | translate : {module: currentLanguageNameField(err.object), startDate : (err.startDate | hoisDate), endDate : (err.endDate | hoisDate) } }} </p>  </div> </td> <td md-cell> <md-datepicker ng-model="row.nominalStudyEnd" name="students[{{$index}}].nominalStudyEnd" aria-label="{{\'directive.student.nominalStudyEnd\' | translate}}" md-min-date="row.studentNominalStudyEnd"></md-datepicker> <div class="invalid" ng-messages="directiveForm[\'students[\'+$index+\'].nominalStudyEnd\'].$error"> <p ng-message="required">{{\'main.required\' | translate}}</p> <p ng-message="serverside"> </p><p ng-repeat="err in directiveForm[\'students[\'+$index+\'].nominalStudyEnd\'].$serverError"> {{ err.code | translate}} </p>  </div> </td> <td md-cell> <md-datepicker ng-model="row.startDate" md-max-date="row.endDate" name="students[{{$index}}].startDate" aria-label="{{\'directive.student.supportServiceStartDate\' | translate}}"></md-datepicker> <div class="invalid" ng-messages="directiveForm[\'students[\'+$index+\'].startDate\'].$error"> <p ng-message="required">{{\'main.required\' | translate}}</p> </div> </td> <td md-cell> <md-datepicker ng-model="row.endDate" md-min-date="getMinDate(row.startDate)" name="students[{{$index}}].endDate" aria-label="{{\'directive.student.supportServiceEndDate\' | translate}}"></md-datepicker> <div class="invalid" ng-messages="directiveForm[\'students[\'+$index+\'].endDate\'].$error"> <p ng-message="required">{{\'main.required\' | translate}}</p> <p ng-message="serverside"> </p><p ng-repeat="err in directiveForm[\'students[\'+$index+\'].endDate\'].$serverError"> {{ err.code | translate}} </p>  </div> </td> <td md-cell> <a ng-click="deleteStudent(row)" md-no-ink class="remove">&times;</a> </td> </tr> <tr md-row ng-class-odd="\'odd\'" ng-class-even="\'even\'" ng-repeat-end style="height: auto"> <td></td> <td colspan="9"> <p class="md-body-1" md-colors="{color: \'warn\'}" ng-if="!row.hasSpecialNeed" style="margin: 0"> {{\'application.messages.studentHasNoSpecialNeed\' | translate}}</p> </td> </tr> </tbody> </table> </md-table-container> <style>/* Overrides default user-agent style for error message */\r\n  div.invalid p {\r\n    margin-block-start: 0.25em;\r\n    margin-block-end: 0.25em;\r\n    margin-inline-start: 0px;\r\n    margin-inline-end: 0px;\r\n  }</style>'),a.put("directive/directive.type.tugi.view.html",'<md-table-container> <table md-table md-row-select="formState.cancelSelect" multiple ng-model="formState.selectedStudents" class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'directive.student.order\' | translate}}</th> <th md-column>{{\'directive.student.fullname\' | translate}}</th> <th md-column>{{\'directive.student.idcode\' | translate}}</th> <th md-column>{{\'directive.student.studentGroup\' | translate}}</th> <th md-column style="min-width: 200px">{{\'directive.student.supportServices\' | translate}}</th> <th md-column style="min-width: 200px">{{\'directive.student.supportModules\' | translate}}</th> <th md-column class="required">{{\'directive.student.nominalStudyEnd\' | translate}}</th> <th md-column class="required">{{\'directive.student.supportServiceStartDate\' | translate}}</th> <th md-column class="required">{{\'directive.student.supportServiceEndDate\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-disabled="!row.selectable" md-select="row" md-select-id="student" md-auto-select ng-repeat="row in record.students | orderBy:\'+lastname\'" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{$index + 1}}.</td> <td md-cell>{{::row.fullname}}</td> <td md-cell>{{::row.idcode}}</td> <td md-cell>{{::(currentLanguageNameField(row.studentGroupObject))}}</td> <td md-cell> <ul style="padding-left: 1.5em"> <li ng-repeat="service in row.supportServices | orderBy: currentLanguageNameField()" style="margin-bottom: 0.25em">{{::(currentLanguageNameField(service))}}</li> </ul> </td> <td md-cell> <ul style="padding-left: 1.5em"> <li ng-repeat="module in row.supportModules | orderBy: currentLanguageNameField()" style="margin-bottom: 0.25em">{{::(currentLanguageNameField(module))}}</li> </ul> </td> <td md-cell>{{row.nominalStudyEnd | hoisDate}}</td> <td md-cell>{{row.startDate | hoisDate}}</td> <td md-cell>{{row.endDate | hoisDate}}</td> </tr> </tbody> </table> </md-table-container>'),a.put("directive/directive.type.tugilopp.edit.html",'<md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'directive.student.order\' | translate}}</th> <th md-column>{{\'directive.student.fullname\' | translate}}</th> <th md-column>{{\'directive.student.idcode\' | translate}}</th> <th md-column>{{\'directive.student.studentGroup\' | translate}}</th> <th md-column class="required">{{\'directive.student.validEnd\' | translate}}</th> <th md-column class="required">{{\'directive.student.directive\' | translate}}</th> <th></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in record.students" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{$index + 1}}.</td> <td md-cell>{{::row.fullname}}</td> <td md-cell>{{::row.idcode}}</td> <td md-cell>{{::(currentLanguageNameField(row.studentGroupObject))}}</td> <td md-cell> <md-input-container> <md-datepicker ng-model="row.startDate" name="students[{{$index}}].startDate" md-min-date="getMinDate(row.directiveStudentObject.startDate)" md-max-date="row.directiveStudentObject.endDate" aria-label="{{\'main.from\' | translate}}"></md-datepicker> </md-input-container> <div class="invalid" ng-messages="directiveForm[\'students[\'+$index+\'].startDate\'].$error"> <p ng-message="required">{{\'main.required\' | translate}}</p> <p ng-message="serverside"> <span ng-repeat="err in directiveForm[\'students[\'+$index+\'].startDate\'].$serverError">{{err.code | translate}}</span> </p> </div> </td> <td md-cell> <md-input-container style="width: 250px"> <md-select ng-model="row.directiveStudent" name="students[{{$index}}].directiveStudent" ng-change="mapStudentDirective(row)" ng-disabled="row.directiveStudent && row.existingDirectiveStudents.length === 1"> <md-option ng-value="existingDirective.id" ng-repeat="existingDirective in row.existingDirectiveStudents"> {{existingDirective.directiveNr}} ({{existingDirective.startDate | hoisDate}} - {{existingDirective.endDate | hoisDate}}) </md-option> </md-select> </md-input-container> <div class="invalid" ng-messages="directiveForm[\'students[\'+$index+\'].directiveStudent\'].$error"> <p ng-message="required">{{\'main.required\' | translate}}</p> <p ng-message="serverside"> <span ng-repeat="err in directiveForm[\'students[\'+$index+\'].directiveStudent\'].$serverError">{{err.code | translate}}</span> </p> </div> </td> <td md-cell> <a ng-click="deleteStudent(row)" md-no-ink class="remove">&times;</a> </td> </tr> </tbody> </table> </md-table-container>'),a.put("directive/directive.type.tugilopp.view.html",'<md-table-container> <table md-table md-row-select="formState.cancelSelect" multiple ng-model="formState.selectedStudents" class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'directive.student.order\' | translate}}</th> <th md-column>{{\'directive.student.fullname\' | translate}}</th> <th md-column>{{\'directive.student.idcode\' | translate}}</th> <th md-column>{{\'directive.student.studentGroup\' | translate}}</th> <th md-column>{{\'directive.student.validEnd\' | translate}}</th> <th md-column>{{\'directive.student.directive\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-disabled="!row.selectable" md-select="row" md-select-id="student" md-auto-select ng-repeat="row in record.students | orderBy:\'+lastname\'" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{$index + 1}}.</td> <td md-cell>{{::row.fullname}}</td> <td md-cell>{{::row.idcode}}</td> <td md-cell>{{::(currentLanguageNameField(row.studentGroupObject))}}</td> <td md-cell>{{::row.startDate | hoisDate}}</td> <td md-cell> <span ng-if="row.directiveStudentObject"> {{::row.directiveStudentObject.directiveNr}} ({{::row.directiveStudentObject.startDate | hoisDate}} - {{::row.directiveStudentObject.endDate | hoisDate}}) </span> </td> </tr> </tbody> </table> </md-table-container>'),
a.put("directive/directive.type.valis.edit.html",'<md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'directive.student.order\' | translate}}</th> <th md-column>{{\'directive.student.fullname\' | translate}}</th> <th md-column>{{\'directive.student.idcode\' | translate}}</th> <th md-column class="required">{{\'directive.student.isAbroad\' | translate}}</th> <th md-column class="required">{{\'directive.student.school\' | translate}}</th> <th md-column class="required">{{\'directive.student.country\' | translate}}</th> <th md-column class="required">{{\'directive.student.isPeriod\' | translate}}</th> <th md-column class="required">{{\'directive.student.valisStartDate\' | translate}}</th> <th md-column class="required">{{\'directive.student.valisEndDate\' | translate}}</th> <th md-column class="required">{{\'directive.student.abroadPurpose\' | translate}}</th> <th md-column class="required">{{\'directive.student.abroadProgramme\' | translate}}</th> <th></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in record.students" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{$index + 1}}.</td> <td md-cell>{{::row.fullname}}</td> <td md-cell>{{::row.idcode}}</td> <td md-cell> <md-radio-group name="isAbroad" ng-model="row.isAbroad" layout="row" ng-change="abroadChanged(row)"> <md-radio-button ng-value="true" aria-label="foreign">{{ \'directive.student.foreignEducationalInstitute\' | translate }}</md-radio-button> <md-radio-button ng-value="false" aria-label="estonian">{{ \'directive.student.estonianEducationalInstitute\' | translate }}</md-radio-button> </md-radio-group> </td> <td md-cell> <hois-classifier-select ng-if="!row.isAbroad" ng-model="row.ehisSchool" name="students[{{$index}}].ehisSchool" criteria="{vocational: formState.school.vocational ? true : undefined, higher: formState.school.higher ? true : undefined}" only-valid ignore-preselected model-value-attr="code" filter-values="[formState.school.ehisSchool]" main-classifier-code="EHIS_KOOL" aria-label="{{\'directive.student.school\' | translate}}"></hois-classifier-select> <div ng-if="!row.isAbroad" class="invalid" ng-messages="directiveForm[\'students[\'+$index+\'].ehisSchool\'].$error"> <p ng-message="required">{{\'main.required\' | translate}}</p> </div> <input type="text" ng-if="row.isAbroad" ng-model="row.abroadSchool" name="students[{{$index}}].abroadSchool"> <div ng-if="row.isAbroad" class="invalid" ng-messages="directiveForm[\'students[\'+$index+\'].abroadSchool\'].$error"> <p ng-message="required">{{\'main.required\' | translate}}</p> </div> </td> <td md-cell> <hois-classifier-select ng-if="row.isAbroad" ng-model="row.country" name="students[{{$index}}].country" model-value-attr="code" criteria="{vocational: formState.school.vocational ? true : undefined, higher: formState.school.higher ? true : undefined}" only-valid ignore-preselected filter-values="[\'RIIK_EST\']" main-classifier-code="RIIK" aria-label="{{\'directive.student.country\' | translate}}"></hois-classifier-select> <hois-classifier-value ng-if="!row.isAbroad" ng-model="row.country" main-classifier-code="RIIK"></hois-classifier-value> <div class="invalid" ng-if="row.isAbroad" ng-messages="directiveForm[\'students[\'+$index+\'].country\'].$error"> <p ng-message="required">{{\'main.required\' | translate}}</p> </div> </td> <td md-cell> <md-radio-group name="isPeriod" ng-model="row.isPeriod" layout="row"> <md-radio-button ng-value="true" aria-label="period">{{ \'main.period\' | translate }}</md-radio-button> <md-radio-button ng-value="false" aria-label="date">{{ \'main.date\' | translate }}</md-radio-button> </md-radio-group> </td> <td md-cell> <hois-select ng-if="row.isPeriod" ng-model="row.studyPeriodStart" name="students[{{$index}}].studyPeriodStart" values="formState.studyPeriods" aria-label="{{\'directive.student.valisStartDate\' | translate}}"></hois-select> <md-datepicker ng-if="!row.isPeriod" ng-model="row.startDate" name="students[{{$index}}].startDate"></md-datepicker> <div ng-if="row.isPeriod" class="invalid" ng-messages="directiveForm[\'students[\'+$index+\'].studyPeriodStart\'].$error"> <p ng-message="required">{{\'main.required\' | translate}}</p> </div> <div ng-if="!row.isPeriod" class="invalid" ng-messages="directiveForm[\'students[\'+$index+\'].startDate\'].$error"> <p ng-message="required">{{\'main.required\' | translate}}</p> </div> </td> <td md-cell> <hois-select ng-if="row.isPeriod" ng-model="row.studyPeriodEnd" name="students[{{$index}}].studyPeriodEnd" values="formState.studyPeriods" aria-label="{{\'directive.student.valisEndDate\' | translate}}"></hois-select> <md-datepicker ng-if="!row.isPeriod" ng-model="row.endDate" name="students[{{$index}}].endDate"></md-datepicker> <div ng-if="row.isPeriod" class="invalid" ng-messages="directiveForm[\'students[\'+$index+\'].studyPeriodEnd\'].$error"> <p ng-message="required">{{\'main.required\' | translate}}</p> </div> <div ng-if="!row.isPeriod" class="invalid" ng-messages="directiveForm[\'students[\'+$index+\'].endDate\'].$error"> <p ng-message="required">{{\'main.required\' | translate}}</p> </div> </td> <td md-cell> <hois-classifier-select ng-model="row.abroadPurpose" name="students[{{$index}}].abroadPurpose" model-value-attr="code" criteria="{vocational: formState.school.vocational ? true : undefined, higher: formState.school.higher ? true : undefined}" only-valid ignore-preselected main-classifier-code="VALISOPE_EESMARK" aria-label="{{\'directive.student.abroadPurpose\' | translate}}"></hois-classifier-select> <div class="invalid" ng-messages="directiveForm[\'students[\'+$index+\'].abroadPurpose\'].$error"> <p ng-message="required">{{\'main.required\' | translate}}</p> </div> </td> <td md-cell> <hois-classifier-select ng-model="row.abroadProgramme" name="students[{{$index}}].abroadProgramme" model-value-attr="code" criteria="{vocational: formState.school.vocational ? true : undefined, higher: formState.school.higher ? true : undefined}" only-valid ignore-preselected main-classifier-code="VALISKOOL_PROGRAMM" aria-label="{{\'directive.student.abroadProgramme\' | translate}}"></hois-classifier-select> <div class="invalid" ng-messages="directiveForm[\'students[\'+$index+\'].abroadProgramme\'].$error"> <p ng-message="required">{{\'main.required\' | translate}}</p> </div> </td> <td md-cell> <a ng-click="deleteStudent(row)" md-no-ink class="remove">&times;</a> </td> </tr> </tbody> </table> </md-table-container>'),a.put("directive/directive.type.valis.view.html",'<md-table-container> <table md-table md-row-select="formState.cancelSelect" multiple ng-model="formState.selectedStudents" class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'directive.student.order\' | translate}}</th> <th md-column>{{\'directive.student.fullname\' | translate}}</th> <th md-column>{{\'directive.student.idcode\' | translate}}</th> <th md-column>{{\'directive.student.isAbroad\' | translate}}</th> <th md-column>{{\'directive.student.school\' | translate}}</th> <th md-column>{{\'directive.student.country\' | translate}}</th> <th md-column>{{\'directive.student.isPeriod\' | translate}}</th> <th md-column>{{\'directive.student.valisStartDate\' | translate}}</th> <th md-column>{{\'directive.student.valisEndDate\' | translate}}</th> <th md-column>{{\'directive.student.abroadPurpose\' | translate}}</th> <th md-column>{{\'directive.student.abroadProgramme\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-disabled="!row.selectable" md-select="row" md-select-id="student" ng-repeat="row in record.students | orderBy:\'+lastname\'" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{$index + 1}}.</td> <td md-cell> <a class="md-primary" ng-href="#/students/{{::row.student}}/main">{{::row.fullname}}</a> </td> <td md-cell>{{::row.idcode}}</td> <td md-cell>{{row.isAbroad ? \'directive.student.foreignEducationalInstitute\' : \'directive.student.estonianEducationalInstitute\' | translate}}</td> <td md-cell> <hois-classifier-value ng-if="!row.isAbroad" ng-model="row.ehisSchool" main-classifier-code="EHIS_KOOL"></hois-classifier-value> <div ng-if="row.isAbroad">{{row.abroadSchool}}</div> </td> <td md-cell> <hois-classifier-value ng-model="row.country" main-classifier-code="RIIK"></hois-classifier-value> </td> <td md-cell>{{row.isPeriod ? \'main.period\' : \'main.date\' | translate}}</td> <td md-cell> <div ng-if="row.isPeriod">{{currentLanguageNameField(row.newStudyPeriodStart)}}</div> <hois-value ng-if="!row.isPeriod" value="row.startDate | hoisDate"></hois-value> </td> <td md-cell> <div ng-if="row.isPeriod">{{currentLanguageNameField(row.newStudyPeriodEnd)}}</div> <hois-value ng-if="!row.isPeriod" value="row.endDate | hoisDate"></hois-value> </td> <td md-cell> <hois-classifier-value ng-model="row.abroadPurpose" main-classifier-code="VALISOPE_EESMARK"></hois-classifier-value> </td> <td md-cell> <hois-classifier-value ng-model="row.abroadProgramme" main-classifier-code="VALISKOOL_PROGRAMM"></hois-classifier-value> </td> </tr> </tbody> </table> </md-table-container>'),a.put("directive/directive.view.html",'<div layout-padding ng-cloak> <div flex> <div layout="row" layout-xs="column" flex class="form-readonly"> <div flex="70"> <div layout="row" layout-sm="column" layout-xs="column" ng-if="record.type === \'KASKKIRI_TYHIST\'"> <md-input-container flex="100" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'directive.canceledDirective\' | translate}}</label> <hois-value value="record.canceledDirective.nameEt" href-value="\'#/directives/\' + record.canceledDirective.id + \'/view\'"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label>{{\'directive.headline\' | translate}}</label> <hois-value value="record.headline"></hois-value> </md-input-container> <md-input-container flex="50" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'directive.directiveNr\' | translate}}</label> <hois-value value="record.directiveNr"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label>{{\'directive.type\' | translate}}</label> <hois-classifier-value ng-model="record.type" main-classifier-code="KASKKIRI"></hois-classifier-value> </md-input-container> <md-input-container flex="50" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'directive.preamble\' | translate}}</label> <hois-value value="record.preamble"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column" ng-if="record.type === \'KASKKIRI_STIPTOET\' || record.type === \'KASKKIRI_STIPTOETL\'"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label>{{\'directive.scholarshipType\' | translate}}</label> <hois-classifier-value ng-model="record.scholarshipType" main-classifier-code="STIPTOETUS"></hois-classifier-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label>{{\'directive.inserted\' | translate}}</label> <hois-value value="record.inserted | hoisDate"></hois-value> </md-input-container> <md-input-container flex="50" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'directive.confirmDate\' | translate}}</label> <hois-value value="record.confirmDate | hoisDate"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label>{{\'directive.addInfo\' | translate}}</label> <hois-value value="record.addInfo"></hois-value> </md-input-container> <md-input-container flex="50" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'directive.directiveCoordinator\' | translate}}</label> <hois-value value="record.directiveCoordinator.nameEt"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label>{{\'directive.status\' | translate}}</label> <hois-classifier-value ng-model="record.status" main-classifier-code="KASKKIRI_STAATUS"></hois-classifier-value> </md-input-container> </div> </div> </div> <div class="ois-form-layout" ng-show="userCanConfirm()"> <form name="directiveForm"> <div layout="column"> <md-input-container class="md-block"> <label>{{\'directive.directiveNr\' | translate}}</label> <input type="text" ng-model="confirmRecord.directiveNr" name="directiveNr" required md-maxlength="20"> </md-input-container> <md-input-container class="md-block"> <label>{{\'directive.preamble\' | translate}}</label> <textarea ng-model="confirmRecord.preamble" md-maxlength="4000" max-rows="10" required></textarea> </md-input-container> </div> </form> </div> <md-table-container> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'directive.studentList\' | translate}}</legend> <div ng-include="formState.templateUrl" flex></div> </fieldset> </md-table-container> <div>&nbsp;</div> <md-table-container ng-if="record.cancelingDirectives && record.cancelingDirectives.length > 0"> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'directive.cancelingDirectives\' | translate}}</legend> <table md-table> <thead md-head> <tr md-row> <th md-column>{{\'directive.headline\' | translate}}</th> <th md-column>{{\'directive.directiveNr\' | translate}}</th> <th md-column>{{\'directive.status\' | translate}}</th> <th md-column>{{\'directive.inserted\' | translate}}</th> <th md-column>{{\'directive.confirmDate\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in record.cancelingDirectives" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell> <a md-class="md-primary change-button" ng-href="#/directives/{{::row.id}}/view">{{::row.headline}}</a> </td> <td md-cell>{{::row.directiveNr}}</td> <td md-cell>{{currentLanguageNameField(row.status)}}</td> <td md-cell>{{::row.inserted | hoisDate}}</td> <td md-cell>{{::row.confirmDate | hoisDate}}</td> </tr> </tbody> </table> </fieldset> </md-table-container> <md-button ng-if="record.id && record.userCanEdit" class="md-primary md-raised" ng-href="#/directives/{{record.id}}/edit?_noback">{{\'main.button.change\' | translate}}</md-button> <md-button ng-click="back(\'#/directives\')" class="md-raised">{{\'main.button.back\' | translate}}</md-button> <md-button ng-click="confirmDirective()" ng-if="userCanConfirm()" class="md-raised">{{\'directive.confirmDuringTest\' | translate}}</md-button> <md-button ng-click="cancelDirective()" ng-if="record.userCanCancel" class="md-raised">{{\'directive.cancel\' | translate}}</md-button> </div> </div>'),a.put("directive/indok.modules.dialog.html",'<md-dialog aria-label="modules dialog" flex="60" flex-sm="100" flex-xs="100"> <form name="dialogForm" ng-submit="dialogForm.$valid && changeModules()" novalidate ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2>{{\'directive.student.modules\'| translate}}</h2> <span flex></span> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <div class="md-dialog-content"> <div layout-padding> <div flex> <md-table-container> <table md-table md-row-select multiple ng-model="formState.selectedModules" md-progress="curriculumVersionModules.$promise"> <thead md-head> <tr md-row> <th md-column>{{\'directive.student.module\' | translate}}</th> <th md-column>{{\'directive.student.distinction\' | translate}}</th> <th md-column ng-if="!formState.viewForm && existingIndividualCurriculums">{{\'directive.student.existingIndividualCurriculum\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row md-select="row.id" ng-disabled="formState.viewForm || !row.valid" ng-repeat="row in curriculumVersionModules | orderBy: currentLanguageNameField()" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{currentLanguageNameField(row)}}</td> <td md-cell style="width: 45%"> <md-input-container style="width: 100%"> <hois-value ng-if="formState.viewForm" value="row.addInfo"></hois-value> <textarea ng-if="!formState.viewForm" ng-model="row.addInfo" md-maxlength="4000" max-rows="5" aria-label="{{\'directive.student.distinction\' | translate}}" ng-disabled="formState.selectedModules.indexOf(row.id) === -1" ng-required="formState.selectedModules.indexOf(row.id) !== -1"></textarea> </md-input-container> </td> <td ng-if="!formState.viewForm && existingIndividualCurriculums" md-cell style="width: 20%"> <li ng-repeat="module in row.existingModules">{{::module.startDate | hoisDate}} - {{::module.endDate | hoisDate}}</li> </td> </tr> </tbody> </table> </md-table-container> </div> </div> </div> </md-dialog-content> <md-dialog-actions layout="row" layout-align="start center"> <md-button ng-if="!formState.viewForm" type="submit" class="md-raised md-primary">{{\'main.button.change\' | translate}}</md-button> <md-button ng-click="cancel()" class="md-raised">{{\'main.button.close\' | translate}}</md-button> </md-dialog-actions> </form> </md-dialog>'),a.put("directive/invalid.student.delete.dialog.html",'<md-dialog aria-label="grade add dialog" flex="60" flex-sm="100" flex-xs="100"> <md-dialog-content> <div class="md-dialog-content"> <p>{{\'directive.studentsNotValid\' | translate}}</p> <md-table-container> <table md-table> <thead md-head> <tr md-row> <th md-column>{{\'directive.student.fullname\' | translate}}</th> <th md-column>{{\'directive.student.idcode\' | translate}}</th> <th md-column>{{\'directive.student.reason\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in students" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{::row.fullname}}</td> <td md-cell>{{::row.idcode}}</td> <td md-cell>{{row.reason | translate}}</td> </tr> </tbody> </table> </md-table-container> </div> </md-dialog-content> <md-dialog-actions layout="row" layout-align="start center"> <md-button ng-click="submit()" class="md-raised md-primary">{{\'main.yes\' | translate}}</md-button> <md-button ng-click="cancel()" class="md-raised">{{\'main.no\' | translate}}</md-button> </md-dialog-actions> </md-dialog>'),a.put("directive/list.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <form name="searchForm" ng-submit="searchForm.$valid && loadData()" novalidate class="nomargin" ng-model-options="{allowInvalid: true}"> <fieldset tabindex="1"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'directive.type\' | translate}}</label> <hois-classifier-select ng-model="criteria.type" name="type" model-value-attr="code" main-classifier-code="KASKKIRI" filter-values="formState.excludedTypes" multiple autofocus></hois-classifier-select> </md-input-container> <md-input-container flex="50" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label class="textInput">{{\'directive.headline\' | translate}}</label> <input ng-model="criteria.headline" name="headline" type="text" md-maxlength="255"> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label>{{\'directive.directiveNr\' | translate}}</label> <input ng-model="criteria.directiveNr" name="directiveNr" type="text" md-maxlength="255"> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'directive.confirmDateFrom\' | translate}}</label> <md-datepicker ng-model="criteria.confirmDateFrom" md-max-date="criteria.confirmDateThru" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'directive.confirmDateThru\' | translate}}</label> <md-datepicker ng-model="criteria.confirmDateThru" md-min-date="criteria.confirmDateFrom" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label>{{\'directive.status\' | translate}}</label> <hois-classifier-select ng-model="criteria.status" name="status" model-value-attr="code" main-classifier-code="KASKKIRI_STAATUS" multiple></hois-classifier-select> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'directive.insertedFrom\' | translate}}</label> <md-datepicker ng-model="criteria.insertedFrom" md-max-date="criteria.insertedThru" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'directive.insertedThru\' | translate}}</label> <md-datepicker ng-model="criteria.insertedThru" md-min-date="criteria.insertedFrom" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> </div> <div layout="row"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> <md-button class="md-raised" ng-if="isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_KASKKIRI\')" ng-href="#/directives/new">{{\'directive.create\' | translate}}</md-button> </div> <div flex-xs="0" flex-gt-xs="0" flex-gt-sm="50"></div> </fieldset> </form> </div> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="headline">{{\'directive.headline\' | translate}}</th> <th md-column md-order-by="directiveNr">{{\'directive.directiveNr\' | translate}}</th> <th md-column md-order-by="{{currentLanguage()===\'en\' ? \'type.nameEn\' : \'type.nameEt\'}}">{{\'directive.type\' | translate}}</th> <th md-column md-order-by="{{currentLanguage()===\'en\' ? \'status.nameEn\' : \'status.nameEt\'}}">{{\'directive.status\' | translate}}</th> <th md-column md-order-by="inserted">{{\'directive.inserted\' | translate}}</th> <th md-column md-order-by="confirmDate">{{\'directive.confirmDate\' | translate}}</th> <th></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell> <a md-class="md-primary change-button" ng-href="#/directives/{{::row.id}}/view">{{::row.headline}}</a> </td> <td md-cell>{{::row.directiveNr}}</td> <td md-cell>{{currentLanguageNameField(row.type)}}</td> <td md-cell>{{currentLanguageNameField(row.status)}}</td> <td md-cell>{{::row.inserted | hoisDate}}</td> <td md-cell>{{::row.confirmDate | hoisDate}}</td> <td md-cell> <md-button ng-if="row.status.code === \'KASKKIRI_STAATUS_KOOSTAMISEL\' && isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_KASKKIRI\')" md-no-ink class="md-primary change-button" ng-href="#/directives/{{::row.id}}/edit">{{\'main.button.change\' | translate}}</md-button> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> </div>'),a.put("directive/student.select.dialog.html",'<md-dialog aria-label="grade add dialog" flex="60" flex-sm="100" flex-xs="100"> <form name="directiveStudentForm" ng-submit="loadData()" novalidate ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2>{{\'directive.addStudents\'| translate}}</h2> <span flex></span> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <div class="md-dialog-content"> <div flex> <md-input-container class="md-block"> <label class="textInput">{{\'directive.student.name\' | translate}}</label> <input type="text" ng-model="criteria.name" name="name" md-autofocus> </md-input-container> <md-input-container class="md-block"> <label class="textInput">{{\'directive.student.idcode\' | translate}}</label> <input type="text" ng-model="criteria.idcode" name="idcode"> </md-input-container> <div flex> <hois-autocomplete flex ng-model="criteria.studentGroupObject" method="studentgroups" name="studentGroup" label="directive.student.studentGroup"></hois-autocomplete> </div> <div layout="row" class="horizontal-radio-group" ng-if="formState.type === \'KASKKIRI_EKSMAT\'"> <md-input-container flex="20" flex-xs="100"> <label class="textInput">{{\'directive.student.isapplication\' | translate}}</label> </md-input-container> <md-input-container layout="row" layout-align="start center" flex="70"> <md-radio-group ng-model="criteria.application" layout="row"> <md-radio-button ng-value="true" aria-label="yes">{{ \'main.yes\' | translate }}</md-radio-button> <md-radio-button ng-value="false" aria-label="no">{{ \'main.no\' | translate }}</md-radio-button> </md-radio-group> </md-input-container> </div> <div layout="row" style="display:inline"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> </div> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-row-select multiple ng-model="formState.selectedStudents" md-progress="tabledata.$promise"> <thead md-head> <tr md-row> <th md-column>{{\'directive.student.fullname\' | translate}}</th> <th md-column>{{\'directive.student.idcode\' | translate}}</th> <th md-column ng-if="formState.type === \'KASKKIRI_TUGI\'">{{\'directive.student.application\' | translate}}</th> <th md-column ng-if="formState.type !== \'KASKKIRI_IMMAT\' && formState.tpye !== \'KASKKIRI_IMMATV\'">{{\'directive.student.curriculum\' | translate}}</th> <th md-column ng-if="formState.type !== \'KASKKIRI_IMMAT\' && formState.tpye !== \'KASKKIRI_IMMATV\'">{{\'directive.student.studentGroup\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row md-select="row" md-select-id="id" md-auto-select ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{::row.fullname}}</td> <td md-cell>{{::row.idcode}}</td> <td md-cell ng-if="formState.type === \'KASKKIRI_TUGI\'"> <md-input-container style="width: 100%" ng-if="row.applications.length > 1"> <md-select ng-model="formState.studentApplicationRelationship[row.id]" ng-required="!!formState.selectedStudentIds[row.id]"> <md-option ng-value="opt.id" ng-repeat="opt in row.applications"> {{opt.confirmed ? "(" + (opt.confirmed | hoisDateTime) + ") " + opt.description : opt.description}} </md-option> </md-select> </md-input-container> <span ng-if="row.applications.length === 1" ng-init="formState.studentApplicationRelationship[row.id] = row.applications[0].id"> {{row.applications[0].confirmed ? "(" + (row.applications[0].confirmed | hoisDateTime) + ") " + row.applications[0].description : row.applications[0].description}} </span> </td> <td md-cell ng-if="formState.type !== \'KASKKIRI_IMMAT\' && formState.tpye !== \'KASKKIRI_IMMATV\'">{{$root.currentLanguageNameField(row.curriculumVersion)}}</td> <td md-cell ng-if="formState.type !== \'KASKKIRI_IMMAT\' && formState.tpye !== \'KASKKIRI_IMMATV\'">{{::row.studentGroup}}</td> </tr> </tbody> </table> </md-table-container> </div> </div> </div> </md-dialog-content> <md-dialog-actions layout="row" layout-align="start center"> <md-button ng-click="select()" class="md-raised md-primary">{{\'main.button.add\' | translate}}</md-button> <md-button ng-click="cancel()" class="md-raised">{{\'main.button.close\' | translate}}</md-button> </md-dialog-actions> </form> </md-dialog>'),a.put("document/diploma.html",'<div ng-cloak> <div ng-include="\'document/templates/navbar.tmpl.html\'"></div> </div> <div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div> <form name="documentForm"> <md-input-container class="md-block"> <label>{{\'document.directive\' | translate}}</label> <hois-select ng-model="criteria.directiveId" values="formState.directives" show-property="display" ng-change="directiveChanged()" required></hois-select> </md-input-container> <md-input-container class="md-block" ng-hide="!criteria.directiveId"> <label>{{\'document.formType\' | translate}}</label> <hois-classifier-select ng-model="criteria.formType" model-value-attr="code" show-only-values="formState.formTypes" main-classifier-code="LOPUBLANKETT" ng-change="formTypeChanged()" required></hois-classifier-select> </md-input-container> <br> <md-table-container ng-hide="formState.students.length === 0"> <table md-table> <thead md-head> <tr md-row> <th md-column> <md-checkbox ng-model="formState.allStudentsSelected" ng-change="selectAllStudents(formState.allStudentsSelected)"></md-checkbox> </th> <th md-column>{{\'document.student\' | translate}}</th> <th md-column>{{\'document.idcode\' | translate}} / {{\'document.birthdate\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in formState.students" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell> <md-checkbox ng-model="row.selected" ng-change="updatePdfUrl()"></md-checkbox> </td> <td md-cell>{{::row.fullname}}</td> <td md-cell>{{::row.idcode || (row.birthdate | hoisDate)}}</td> </tr> </tbody> </table> </md-table-container> <br> <div ng-hide="formState.students.length === 0"> <div layout="row"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label>{{\'document.signer1\' | translate}}</label> <hois-select ng-model="criteria.signer1Id" values="formState.firstsigners" show-property="display" ng-change="updatePdfUrl()" required></hois-select> </md-input-container> <md-input-container flex="45" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'document.signer2\' | translate}}</label> <hois-select ng-model="criteria.signer2Id" values="formState.signers" show-property="display" ng-change="updatePdfUrl()" required></hois-select> </md-input-container> </div> <div layout="row" ng-if="isHigher"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label>{{\'document.city\' | translate}}</label> <input type="text" ng-model="criteria.city" ng-change="updatePdfUrl()" required> </md-input-container> </div> <div layout="row"> <md-input-container flex="20" flex-sm="100" flex-xs="100"> <label>{{\'document.freeForms\' | translate}}</label> <input type="number" ng-model="criteria.numeral" min="0"> </md-input-container> <hois-free-forms value="formState.freeForms"></hois-free-forms> </div> </div> </form> <a ng-href="{{viewPdfUrl}}" target="_blank" class="md-button md-raised" ng-if="viewPdfUrl">{{\'document.button.showPdf\' | translate}}</a> <md-button ng-click="print()" class="md-raised md-primary" ng-if="canPrintConfirm()">{{\'main.button.print\' | translate}}</md-button> </div> </div>'),a.put("document/diploma.search.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <form name="searchForm" ng-submit="searchForm.$valid && loadData()" novalidate class="nomargin"> <div layout="row"> <md-input-container flex="100"> <label>{{\'document.student\' | translate}}</label> <input type="text" ng-model="criteria.student"> </md-input-container> </div> <div layout="row"> <hois-autocomplete flex ng-model="criteria.curriculum" method="curriculumsauto" no-paging="true" ha-controller="directiveControllers" label="document.search.curriculum"></hois-autocomplete> </div> <div layout="row"> <div layout="column" flex="45"> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex flex-sm="100" flex-xs="100"> <label>{{\'document.search.from\' | translate}}</label> <md-datepicker ng-model="criteria.from" md-max-date="criteria.thru" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> <md-input-container flex flex-sm="100" flex-xs="100" flex-offset-xs="0" flex-offset-sm="0" flex-offset="5"> <label>{{\'document.search.thru\' | translate}}</label> <md-datepicker ng-model="criteria.thru" md-min-date="criteria.from" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> </div> </div> </div> <div layout="row"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> <a ng-href="{{excel(formState.xlsUrl, criteria)}}" target="_blank" class="md-button md-raised">{{\'document.button.excel\' | translate}}</a> </div> </form> </fieldset> </div> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="p.lastname">{{\'document.student\' | translate}}</th> <th md-column md-order-by="p.idcode">{{\'document.idcode\' | translate}}</th> <th md-column md-order-by="c.mer_code">{{\'document.search.merCode\' | translate}}</th> <th md-column md-order-by="c.name_et">{{\'document.search.curriculum\' | translate}}</th> <th md-column>{{\'document.search.type\' | translate}}</th> <th md-column>{{\'document.search.diplomaStatus\' | translate}}</th> <th md-column>{{\'document.search.diplomaNr\' | translate}}</th> <th md-column>{{\'document.search.supplementStatus\' | translate}}</th> <th md-column>{{\'document.search.supplementNr\' | translate}}</th> <th md-column ng-if="auth.higher">{{\'document.search.supplementStatusEn\' | translate}}</th> <th md-column ng-if="auth.higher">{{\'document.search.supplementNrEn\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell><a ng-href="#/students/{{::row.studentId}}/main">{{row.fullname}}</a></td> <td md-cell>{{::row.idcode}}</td> <td md-cell>{{::row.merCode}}</td> <td md-cell>{{::row.curriculum}}</td> <td md-cell>{{currentLanguageNameField(row.type)}}</td> <td md-cell>{{currentLanguageNameField(row.diplomaStatus)}}</td> <td md-cell><a ng-href="{{formState.pdfBaseUrl}}/{{::row.diplomaId}}/diploma.pdf">{{::row.diplomaNr}}</a></td> <td md-cell>{{currentLanguageNameField(row.supplementStatus)}}</td> <td md-cell><a ng-href="{{formState.pdfBaseUrl}}/{{::row.supplementId}}/supplement.pdf">{{::row.supplementNr}}</a></td> <td md-cell ng-if="auth.higher">{{currentLanguageNameField(row.supplementStatusEn)}}</td> <td md-cell ng-if="auth.higher"><a ng-href="{{formState.pdfBaseUrl}}/{{::row.supplementId}}/supplement.pdf?lang=EN">{{::row.supplementNrEn}}</a></td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> </div>'),
a.put("document/supplement.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <form layout="column"> <div layout="row"> <md-input-container flex="40" flex-sm="100" flex-xs="100" class="readonly"> <label>{{\'document.student\' | translate}}</label> <hois-value value="record.fullname"></hois-value> </md-input-container> </div> <div layout="row"> <md-input-container flex="40" flex-sm="100" flex-xs="100" class="readonly"> <label>{{\'document.diplomaNr\' | translate}}</label> <hois-value value="record.diplomaNr"></hois-value> </md-input-container> </div> <div layout="row"> <md-input-container flex="40" flex-sm="100" flex-xs="100" class="readonly"> <label>{{\'document.diplomaStatus\' | translate}}</label> <hois-classifier-value ng-model="record.diplomaStatus" main-classifier-code="LOPUDOK_STAATUS" model-value-attr="code"></hois-classifier-value> </md-input-container> </div> <div layout="row"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label>{{\'document.signer1\' | translate}}</label> <hois-select ng-model="contentData.signer1Id" values="formState.signers" show-property="display" ng-change="updatePdfUrl()" required></hois-select> </md-input-container> <md-input-container flex="45" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'document.signer2\' | translate}}</label> <hois-select ng-model="contentData.signer2Id" values="formState.signers" show-property="display" ng-change="updatePdfUrl()" required></hois-select> </md-input-container> </div> <br> <div layout="row"> <div flex="45" flex-sm="100" flex-xs="100"> <md-checkbox ng-model="contentData.showSubjectCode" ng-change="updatePdfUrl()"> {{\'document.showSubjectCode\' | translate}} </md-checkbox> </div> <div flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <md-checkbox ng-model="contentData.showTeacher" ng-change="updatePdfUrl()"> {{\'document.showTeacher\' | translate}} </md-checkbox> </div> </div> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'document.estonian\' | translate}}</legend> <br> <div layout="row" ng-if="record.diplomaStatus === \'LOPUDOK_STAATUS_T\' && record.supplementStatus !== \'LOPUDOK_STAATUS_T\'"> <md-input-container flex="20" flex-sm="100" flex-xs="100"> <label>{{\'document.freeForms\' | translate}}</label> <input type="number" ng-model="formData.numeral" min="0" required> </md-input-container> <hois-free-forms value="record.forms"></hois-free-forms> </div> <div layout="row" ng-if="record.diplomaStatus === \'LOPUDOK_STAATUS_T\' && record.supplementStatus !== \'LOPUDOK_STAATUS_T\'"> <md-input-container flex="20" flex-sm="100" flex-xs="100"> <label>{{\'document.freeExtraForms\' | translate}}</label> <input type="number" ng-model="formData.additionalNumeral" min="0"> </md-input-container> <hois-free-forms value="record.freeExtraForms"></hois-free-forms> </div> <div layout="row" ng-if="record.supplementStatus === \'LOPUDOK_STAATUS_T\'"> <md-input-container flex="40" flex-sm="100" flex-xs="100" class="readonly"> <label>{{\'document.supplementStatus\' | translate}}</label> <hois-classifier-value ng-model="record.supplementStatus" main-classifier-code="LOPUDOK_STAATUS" model-value-attr="code"></hois-classifier-value> </md-input-container> </div> <div layout="row" ng-if="record.supplementStatus === \'LOPUDOK_STAATUS_T\'"> <md-input-container flex="40" flex-sm="100" flex-xs="100" class="readonly"> <label>{{\'document.usedForms\' | translate}}</label> <hois-value value="record.forms.join(\', \')"></hois-value> </md-input-container> </div> <a ng-href="{{viewPdfUrl}}" target="_blank" class="md-button md-raised" ng-if="viewPdfUrl">{{\'document.button.showPdf\' | translate}}</a> <md-button ng-click="print()" class="md-raised md-primary" ng-if="record.diplomaStatus === \'LOPUDOK_STAATUS_T\' && viewPdfUrl"> {{\'main.button.print\' | translate}} </md-button> </fieldset> <br> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'document.english\' | translate}}</legend> <br> <div layout="row" ng-if="record.diplomaStatus === \'LOPUDOK_STAATUS_T\' && record.supplementStatusEn !== \'LOPUDOK_STAATUS_T\'"> <md-input-container flex="20" flex-sm="100" flex-xs="100"> <label>{{\'document.freeForms\' | translate}}</label> <input type="number" ng-model="formDataEn.numeral" min="0" required> </md-input-container> <hois-free-forms value="record.formsEn"></hois-free-forms> </div> <div layout="row" ng-if="record.diplomaStatus === \'LOPUDOK_STAATUS_T\' && record.supplementStatusEn !== \'LOPUDOK_STAATUS_T\'"> <md-input-container flex="20" flex-sm="100" flex-xs="100"> <label>{{\'document.freeExtraForms\' | translate}}</label> <input type="number" ng-model="formDataEn.additionalNumeral" min="0"> </md-input-container> <hois-free-forms value="record.freeExtraForms"></hois-free-forms> </div> <div layout="row" ng-if="record.supplementStatusEn === \'LOPUDOK_STAATUS_T\'"> <md-input-container flex="40" flex-sm="100" flex-xs="100" class="readonly"> <label>{{\'document.supplementStatus\' | translate}}</label> <hois-classifier-value ng-model="record.supplementStatusEn" main-classifier-code="LOPUDOK_STAATUS" model-value-attr="code"></hois-classifier-value> </md-input-container> </div> <div layout="row" ng-if="record.supplementStatusEn === \'LOPUDOK_STAATUS_T\'"> <md-input-container flex="40" flex-sm="100" flex-xs="100" class="readonly"> <label>{{\'document.usedForms\' | translate}}</label> <hois-value value="record.formsEn.join(\', \')"></hois-value> </md-input-container> </div> <a ng-href="{{viewPdfUrlEn}}" target="_blank" class="md-button md-raised" ng-if="viewPdfUrlEn">{{\'document.button.showPdf\' | translate}}</a> <md-button ng-click="print(\'EN\')" class="md-raised md-primary" ng-if="record.diplomaStatus === \'LOPUDOK_STAATUS_T\' && viewPdfUrlEn"> {{\'main.button.print\' | translate}} </md-button> </fieldset> </form> <div layout="row"> <md-button ng-click="back(\'#/documents/supplements\')" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </div> </div> </div>'),a.put("document/supplement.search.html",'<div ng-cloak> <div ng-include="\'document/templates/navbar.tmpl.html\'"></div> </div> <div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <fieldset> <legend class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <form ng-submit="loadData()" novalidate> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label>{{\'document.directive\' | translate}}</label> <hois-select ng-model="criteria.directiveId" values="formState.directives" show-property="display"></hois-select> </md-input-container> <div flex="50" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <hois-autocomplete ng-model="autocomplete.student" method="students" additional-query-params="{finishing: true}" ha-controller="directiveControllers" label="document.student"></hois-autocomplete> </div> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label>{{isHigher ? \'document.diplomaStatus\' : \'document.diplomaStatusVocational\' | translate}}</label> <hois-classifier-select ng-model="criteria.diplomaStatus" main-classifier-code="LOPUDOK_STAATUS" model-value-attr="code"></hois-classifier-select> </md-input-container> <div flex="50" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <hois-autocomplete ng-if="isHigher" ng-model="autocomplete.curriculumVersion" method="curriculumversions" ha-controller="directiveControllers" label="document.curriculumVersion"></hois-autocomplete> <hois-autocomplete ng-if="!isHigher" ng-model="autocomplete.curriculumVersion" method="curriculumversions" ha-controller="directiveControllers" label="document.curriculumVersionVocational"></hois-autocomplete> </div> </div> <div layout="row"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> </div> </form> </fieldset> </div> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column>{{\'document.student\' | translate}}</th> <th md-column>{{isHigher ? \'document.diplomaNr\' : \'document.diplomaNrVocational\' | translate}}</th> <th md-column>{{isHigher ? \'document.diplomaStatus\' : \'document.diplomaStatusVocational\' | translate}}</th> <th md-column>{{isHigher ? \'document.supplementStatus\' : \'document.supplementStatusVocational\' | translate}}</th> <th md-column ng-if="isHigher">{{\'document.supplementStatusEn\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell> <a md-class="md-primary change-button" ng-href="#/documents/supplements{{isHigher ? \'\' : \'/vocational\'}}/{{::row.directiveStudentId}}"> {{::row.fullname}} </a> </td> <td md-cell>{{::row.diplomaNr}}</td> <td md-cell>{{currentLanguageNameField(row.diplomaStatus)}}</td> <td md-cell>{{currentLanguageNameField(row.supplementStatus)}}</td> <td md-cell ng-if="isHigher">{{currentLanguageNameField(row.supplementStatusEn)}}</td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> </div>'),a.put("document/supplement.vocational.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <form layout="column"> <div layout="row"> <md-input-container flex="40" flex-sm="100" flex-xs="100" class="readonly"> <label>{{\'document.student\' | translate}}</label> <hois-value value="record.fullname"></hois-value> </md-input-container> </div> <div layout="row"> <md-input-container flex="40" flex-sm="100" flex-xs="100" class="readonly"> <label>{{\'document.diplomaNrVocational\' | translate}}</label> <hois-value value="record.diplomaNr"></hois-value> </md-input-container> </div> <div layout="row"> <md-input-container flex="40" flex-sm="100" flex-xs="100" class="readonly"> <label>{{\'document.diplomaStatusVocational\' | translate}}</label> <hois-classifier-value ng-model="record.diplomaStatus" main-classifier-code="LOPUDOK_STAATUS" model-value-attr="code"></hois-classifier-value> </md-input-container> </div> <div layout="row" ng-if="record.diplomaStatus === \'LOPUDOK_STAATUS_T\'"> <md-input-container flex="20" flex-sm="100" flex-xs="100"> <label>{{\'document.freeForms\' | translate}}</label> <input type="number" ng-model="formData.numeral" min="0" required> </md-input-container> <hois-free-forms value="record.forms"></hois-free-forms> </div> <div layout="row" ng-if="record.diplomaStatus === \'LOPUDOK_STAATUS_T\'"> <md-input-container flex="20" flex-sm="100" flex-xs="100"> <label>{{\'document.freeExtraForms\' | translate}}</label> <input type="number" ng-model="formData.additionalNumeral" min="0"> </md-input-container> <hois-free-forms value="record.freeExtraForms"></hois-free-forms> </div> <div layout="row"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label>{{\'document.signer1\' | translate}}</label> <hois-select ng-model="contentData.signer1Id" values="formState.signers" show-property="display" ng-change="updatePdfUrl()" required></hois-select> </md-input-container> </div> </form> <div layout="row"> <a ng-href="{{viewPdfUrl}}" target="_blank" class="md-button md-raised" ng-if="viewPdfUrl">{{\'document.button.showPdf\' | translate}}</a> <md-button ng-click="print()" class="md-raised md-primary" ng-if="record.diplomaStatus === \'LOPUDOK_STAATUS_T\' && viewPdfUrl">{{\'main.button.print\' | translate}}</md-button> <md-button ng-click="back(\'#/documents/supplements/vocational\')" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </div> </div> </div>'),a.put("ehis/logentry.view.dialog.html",'<md-dialog aria-label="grade add dialog" flex="75" flex-xs="100"> <md-toolbar> <div class="md-toolbar-tools"> <h2 flex>{{\'ehis.message.\' + record.wsName | translate}}</h2> <span flex> <hois-value class="md-button md-raised" ng-if="record.directive.id" value="record.directive.nameEt" href-value="\'#/directives/\' + record.directive.id + \'/view\'"></hois-value> <hois-value class="md-button md-raised" ng-if="record.teacher.id" value="record.teacher.nameEt" href-value="\'#/teachers/\' + record.teacher.id"></hois-value> </span> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <div class="md-dialog-content"> <div layout="row"> <md-input-container> <label>{{\'ehis.message.request\' | translate}}</label>&nbsp; <pre><hois-value value="record.request | limitTo:requestLength"></hois-value></pre> <a ng-click="showAll(true)" ng-if="requestLength">&hellip;</a> </md-input-container> </div> <hr> <div layout="row"> <md-input-container> <label>{{\'ehis.message.response\' | translate}}</label>&nbsp; <pre><hois-value value="record.response | limitTo:responseLength"></hois-value></pre> <a ng-click="showAll(false)" ng-if="responseLength">&hellip;</a> </md-input-container> </div> </div> </md-dialog-content> <md-dialog-actions layout="row" layout-align="start center"> <md-button ng-click="cancel()" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </md-dialog-actions> </md-dialog>'),a.put("ehis/logs.view.html",'<div layout-padding> <div flex> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <form ng-submit="loadData()" layout="column" name="ehisLogForm"> <div flex> <div layout="column" layout-gt-md="row"> <md-input-container flex="100" flex-gt-md="45"> <label>{{\'ehis.message.name\' | translate}}</label> <md-select ng-model="criteria.messageType"> <md-option md-option-empty></md-option> <md-option ng-repeat="val in messageTypes" ng-value="val"> {{\'ehis.message.\' + val | translate}} </md-option> </md-select> </md-input-container> <div flex="50" flex-offset="0" flex-offset-gt-md="5"> <label class="common-label">{{\'ehis.message.sentDatesRange\' | translate}}</label> <md-input-container flex="100" flex-gt-md="25"> <label>{{\'main.from\' | translate}}</label> <md-datepicker ng-model="criteria.from" md-max-date="criteria.thru" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> <md-input-container flex flex-offset="5"> <label>{{\'main.thru\' | translate}}</label> <md-datepicker ng-model="criteria.thru" md-min-date="criteria.from" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> </div> </div> <div layout="column" layout-gt-sm="row"> <md-input-container flex="45"> <md-checkbox ng-model="criteria.errors" aria-label="show only errors"> {{\'ehis.message.onlyErrors\' | translate}} </md-checkbox> </md-input-container> <div flex="35" ng-if="!criteria.messageType || messageTypesWithTeacher.indexOf(criteria.messageType) !== -1"> <hois-autocomplete label="{{auth.higher ? \'teacher.labelHigher\' : \'teacher.labelVocational\'}}" ng-model="criteria.teacher" ha-attribute="id" ha-controller="directiveControllers" method="teachers"></hois-autocomplete> </div> </div> </div> <div layout="row"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> </div> </form> </fieldset> </div> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column>{{\'ehis.message.name\' | translate}}</th> <th md-column md-order-by="inserted">{{\'ehis.message.time\' | translate}}</th> <th md-column>{{\'ehis.message.directive\' | translate}}</th> <th md-column>{{\'ehis.message.error\' | translate}}</th> <th md-column>{{\'ehis.message.message\' | translate}}</th> <th md-column>{{\'ehis.message.insertedBy\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell> <a md-no-ink class="md-primary" ng-click="logentry(row)">{{::(\'ehis.message.\' + row.wsName) | translate}}</a> </td> <td md-cell>{{::row.inserted | hoisDateTime}}</td> <td md-cell>{{currentLanguageNameField(row.directive)}}</td> <td md-cell>{{row.error ? \'main.yes\' : \'main.no\' | translate}}</td> <td md-cell>{{::row.logTxt}}</td> <td md-cell>{{::row.insertedBy}}</td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\' }" md-page-select></md-table-pagination> </div> </div>'),a.put("ehis/student.html","<div layout-padding> <div flex> <form ng-submit=\"exportStudents()\" layout=\"column\" name=\"studentExportForm\"> <div flex> <div layout=\"row\"> <md-input-container flex=\"25\" flex-md=\"100\" flex-sm=\"100\" flex-xs=\"100\"> <label>{{'ehis.student.dataType' | translate}}</label> <md-select ng-model=\"criteria.dataType\" required ng-change=\"result = []\"> <md-option ng-repeat=\"val in dataTypes | orderBy: 'translate'\" ng-value=\"val.type\"> {{ val.translate }} </md-option> </md-select> </md-input-container> </div> <div layout=\"row\"> <md-input-container flex=\"20\" flex-sm=\"100\" flex-xs=\"100\" ng-if=\"displayDates.indexOf(criteria.dataType) !== -1\"> <label>{{'ehis.student.sentDatesRange' | translate}}</label> <input type=\"hidden\"> </md-input-container> <div flex=\"33\" ng-if=\"displayDates.indexOf(criteria.dataType) !== -1\"> <md-input-container flex> <label>{{'main.from' | translate}}</label> <md-datepicker ng-model=\"criteria.from\" md-max-date=\"criteria.thru\" required></md-datepicker> </md-input-container> <md-input-container flex> <label>{{'main.thru' | translate}}</label> <md-datepicker ng-model=\"criteria.thru\" md-min-date=\"criteria.from\" required></md-datepicker> </md-input-container> </div> </div> </div> <div layout=\"row\"> <md-button type=\"submit\" class=\"md-raised md-primary\">{{'ehis.student.sendToEhis' | translate}}</md-button> </div> </form> </div> <p class=\"md-body-2\" md-colors=\"{color: 'warn'}\" translate=\"ehis.messages.requestCancelledBy\" translate-values=\"{user: cancelledBy}\" ng-if=\"cancelledBy\"></p> </div> <div ng-if=\"result.length > 0\"> <div layout-padding> <fieldset> <legend md-colors=\"{color: 'primary-800'}\" class=\"md-title-small\">{{'ehis.student.result' | translate}}</legend> <div flex> <md-table-container> <table md-table> <thead md-head> <tr md-row> <th md-column>{{'main.order' | translate}}</th> <th md-column>{{'ehis.student.name' | translate}}</th> <th md-column>{{'ehis.student.idcode' | translate}}</th> <th md-column>{{'ehis.student.curriculum' | translate}}</th> <th md-column ng-if=\"criteria.dataType === 'GRADUATION'\">{{'ehis.student.docNr' | translate}}</th> <th md-column ng-if=\"criteria.dataType === 'GRADUATION'\">{{'ehis.student.cumLaude' | translate}}</th> <th md-column ng-if=\"criteria.dataType === 'GRADUATION'\">{{'ehis.student.academicNr' | translate}}</th> <th md-column ng-if=\"criteria.dataType === 'COURSE_CHANGE'\">{{'ehis.student.newCourse' | translate}}</th> <th md-column ng-if=\"criteria.dataType === 'COURSE_CHANGE'\">{{'ehis.student.changeDate' | translate}}</th> <th md-column ng-if=\"criteria.dataType === 'CURRICULA_FULFILMENT'\">{{'ehis.student.percentage' | translate}}</th> <th md-column ng-if=\"criteria.dataType === 'CURRICULA_FULFILMENT'\">{{'ehis.student.points' | translate}}</th> <th md-column ng-if=\"criteria.dataType === 'CURRICULA_FULFILMENT'\">{{'ehis.student.lastPeriod' | translate}}</th> <th md-column ng-if=\"criteria.dataType === 'DORMITORY'\">{{'ehis.student.DORMITORY' | translate}}</th> <th md-column ng-if=\"criteria.dataType === 'DORMITORY'\">{{'ehis.student.changeDate' | translate}}</th> <th md-column ng-if=\"criteria.dataType === 'FOREIGN_STUDY'\">{{'ehis.student.fromDate' | translate}}</th> <th md-column ng-if=\"criteria.dataType === 'FOREIGN_STUDY'\">{{'ehis.student.toDate' | translate}}</th> <th md-column ng-if=\"criteria.dataType === 'FOREIGN_STUDY'\">{{'ehis.student.abroadPurpose' | translate}}</th> <th md-column ng-if=\"criteria.dataType === 'FOREIGN_STUDY'\">{{'ehis.student.points' | translate}}</th> <th md-column ng-if=\"criteria.dataType === 'FOREIGN_STUDY'\">{{'ehis.student.schoolName' | translate}}</th> <th md-column ng-if=\"criteria.dataType === 'FOREIGN_STUDY'\">{{'ehis.student.nominalStudyExtension' | translate}}</th> <th md-column ng-if=\"criteria.dataType === 'FOREIGN_STUDY'\">{{'ehis.student.country' | translate}}</th> <th md-column ng-if=\"criteria.dataType === 'FOREIGN_STUDY'\">{{'ehis.student.abroadProgramme' | translate}}</th> <th md-column ng-if=\"criteria.dataType === 'VOTA'\">{{'ehis.student.votaConfirmDate' | translate}}</th> <th md-column ng-if=\"criteria.dataType === 'VOTA'\">{{'ehis.student.points' | translate}}</th> <th md-column ng-if=\"criteria.dataType === 'VOTA'\">{{'ehis.student.votaType' | translate}}</th> <th md-column ng-if=\"criteria.dataType === 'VOTA'\">{{'ehis.student.schoolName' | translate}}</th> <th md-column ng-if=\"criteria.dataType === 'VOTA'\">{{'ehis.student.gradeDate' | translate}}</th> <th md-column ng-if=\"criteria.dataType === 'VOTA'\">{{'ehis.student.votaCountry' | translate}}</th> <th md-column>{{'ehis.student.error' | translate}}</th> <th md-column>{{'ehis.student.message' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat=\"row in result\" ng-class-odd=\"'odd'\" ng-class-even=\"'even'\"> <td md-cell>{{$index + 1}}.</td> <td md-cell><a ng-href=\"/#/students/{{::row.studentId}}/main\">{{::row.name}}</a></td> <td md-cell>{{::row.idcode}}</td> <td md-cell>{{::row.curriculum}}</td> <td md-cell ng-if=\"criteria.dataType === 'GRADUATION'\">{{::row.docNr}}</td> <td md-cell ng-if=\"criteria.dataType === 'GRADUATION'\">{{row.cumLaude ? 'main.yes' : 'main.no' | translate}}</td> <td md-cell ng-if=\"criteria.dataType === 'GRADUATION'\"> {{::row.academicNr}} <span ng-if=\"row.extraNr && row.extraNr.length > 0\"> ({{'ehis.student.extraNr' | translate}}: {{row.extraNr.join(', ')}}) </span> <span ng-if=\"row.academicNrEn\"><br> {{::row.academicNrEn}} <span ng-if=\"row.extraNrEn && row.extraNrEn.length > 0\"> ({{'ehis.student.extraNr' | translate}}: {{row.extraNrEn.join(', ')}}) </span> </span> </td> <td md-cell ng-if=\"criteria.dataType === 'COURSE_CHANGE'\">{{::row.newCourse}}</td> <td md-cell ng-if=\"criteria.dataType === 'COURSE_CHANGE'\">{{::row.changed | hoisDate}}</td> <td md-cell ng-if=\"criteria.dataType === 'CURRICULA_FULFILMENT'\">{{::row.percentage}}</td> <td md-cell ng-if=\"criteria.dataType === 'CURRICULA_FULFILMENT'\">{{::row.points}}</td> <td md-cell ng-if=\"criteria.dataType === 'CURRICULA_FULFILMENT'\">{{::row.lastPeriod ? 'main.yes' : 'main.no' | translate}}</td> <td md-cell ng-if=\"criteria.dataType === 'DORMITORY'\"> <hois-classifier-value ng-model=\"row.dormitory\" main-classifier-code=\"YHISELAMU\"></hois-classifier-value> </td> <td md-cell ng-if=\"criteria.dataType === 'DORMITORY'\">{{::row.changeDate | hoisDate}}</td> <td md-cell ng-if=\"criteria.dataType === 'FOREIGN_STUDY'\">{{::row.fromDate | hoisDate}}</td> <td md-cell ng-if=\"criteria.dataType === 'FOREIGN_STUDY'\">{{::row.toDate | hoisDate}}</td> <td md-cell ng-if=\"criteria.dataType === 'FOREIGN_STUDY'\"> <hois-classifier-value ng-model=\"row.abroadPurpose\" main-classifier-code=\"VALISOPE_EESMARK\"></hois-classifier-value> </td> <td md-cell ng-if=\"criteria.dataType === 'FOREIGN_STUDY'\">{{::row.points}}</td> <td md-cell ng-if=\"criteria.dataType === 'FOREIGN_STUDY'\">{{::row.schoolName}}</td> <td md-cell ng-if=\"criteria.dataType === 'FOREIGN_STUDY'\">{{::row.nominalStudyExtension}}</td> <td md-cell ng-if=\"criteria.dataType === 'FOREIGN_STUDY'\"> <hois-classifier-value ng-model=\"row.country\" main-classifier-code=\"RIIK\"></hois-classifier-value> </td> <td md-cell ng-if=\"criteria.dataType === 'FOREIGN_STUDY'\"> <hois-classifier-value ng-model=\"row.abroadProgramme\" main-classifier-code=\"VALISKOOL_PROGRAMM\"></hois-classifier-value> </td> <td md-cell ng-if=\"criteria.dataType === 'VOTA'\">{{::row.confirmed | hoisDate}}</td> <td md-cell ng-if=\"criteria.dataType === 'VOTA'\">{{::row.credits}}</td> <td md-cell ng-if=\"criteria.dataType === 'VOTA'\">{{::row.isFormalLearning ? 'ehis.student.formal' : 'ehis.student.informal' | translate}}</td> <td md-cell ng-if=\"criteria.dataType === 'VOTA'\">{{::row.schoolNameEt}}</td> <td md-cell ng-if=\"criteria.dataType === 'VOTA'\">{{::row.gradeDate | hoisDate}}</td> <td md-cell ng-if=\"criteria.dataType === 'VOTA'\"> <hois-classifier-value ng-model=\"row.countryCode\" main-classifier-code=\"RIIK\"></hois-classifier-value> </td> <td md-cell>{{row.error === true ? ('main.no' | translate) : (row.error === false ? ('main.yes' | translate) : '')}}</td> <td md-cell>{{::row.message}}</td> </tr> </tbody> </table> </md-table-container> </div> </fieldset> </div> </div>"),a.put("ehis/teacher.export.html",'<div layout-padding> <div flex> <form ng-submit="exportTeachers()" layout="column" name="teacherExportForm"> <div flex> <div flex="60" flex-sm="100" flex-xs="100" layout="row" class="horizontal-radio-group"> <md-input-container flex="20" flex-xs="100"> <label class="md-required common-label">{{\'ehis.teacher.radioData\' | translate}}</label> </md-input-container> <md-input-container layout="row" layout-align="start center" flex="60"> <md-radio-group name="datachoice" ng-model="teacher.allDates" required layout="row"> <md-radio-button ng-value="true">{{ \'ehis.teacher.allData\' | translate }}</md-radio-button> <md-radio-button ng-value="false">{{ \'ehis.teacher.changedData\' | translate }}</md-radio-button> </md-radio-group> </md-input-container> </div> <div flex-xs="100" flex-gt-xs="100" layout="column" ng-if="!teacher.allDates"> <div layout="row"> <md-input-container flex="25" flex-md="100" flex-sm="100" flex-xs="100"> <label>{{\'ehis.teacher.importRange\' | translate}}</label> <input type="hidden"> </md-input-container> <md-input-container flex="15" flex-md="100" flex-sm="100" flex-xs="100"> <label>{{\'main.from\' | translate}}</label> <md-datepicker ng-required="!teacher.allDates" ng-model="teacher.changeDateFrom" md-max-date="teacher.changeDateTo"></md-datepicker> </md-input-container> <md-input-container flex="15" flex-md="100" flex-sm="100" flex-xs="100"> <label>{{\'main.thru\' | translate}}</label> <md-datepicker ng-required="!teacher.allDates" ng-model="teacher.changeDateTo" md-min-date="teacher.changeDateFrom"></md-datepicker> </md-input-container> </div> </div> <div layout="row"> <div flex="60"> <md-checkbox ng-model="teacher.subjectData" class="md-primary"> {{(higher ? \'ehis.teacher.subjectData\' : \'ehis.teacher.moduleData\') | translate}} </md-checkbox> </div> </div> <div layout="row"> <md-button type="submit" class="md-raised md-primary">{{\'ehis.teacher.sendToEhis\' | translate}}</md-button> </div> </div> </form> </div> <p class="md-body-2" md-colors="{color: \'warn\'}" translate="ehis.messages.requestCancelledBy" translate-values="{user: cancelledBy}" ng-if="cancelledBy"></p> </div> <div ng-if="result.length > 0"> <div layout-padding> <div flex> {{\'ehis.teacher.response\' | translate}} </div> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="result"> <thead md-head> <tr md-row> <th md-column>{{\'ehis.teacher.name\' | translate}}</th> <th md-column>{{\'ehis.teacher.message\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in result" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{::row.fullName}}</td> <td md-cell>{{::row.message}}</td> </tr> </tbody> </table> </md-table-container> </div> </div> </div>'),a.put("exam/edit.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <form name="examForm" class="nomargin"> <div layout="row" class="form-readonly"> <md-input-container flex="20" flex-sm="100" flex-xs="100" ng-if="!record.id"> <label class="textInput">{{\'exam.studyPeriod\' | translate}}</label> <hois-select ng-model="formState.studyPeriod" ng-change="studyPeriodChanged()" values="formState.studyPeriods" required sorted-query="true"></hois-select> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-xs="100" ng-if="record.id"> <label class="textInput">{{\'exam.studyPeriod\' | translate}}</label> <hois-value value="currentLanguageNameField(formState.subjectStudyPeriod.studyPeriod)"></hois-value> </md-input-container> <md-input-container flex="45" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0" ng-if="!record.id"> <label class="textInput">{{\'exam.subjectTeacher\' | translate}}</label> <md-select ng-model="formState.subjectStudyPeriodId" ng-change="subjectStudyPeriodChanged()" aria-label="{{\'exam.subjectTeacher\' | translate}}" required> <md-option ng-value="row.id" ng-repeat="row in formState.subjectStudyPeriods | orderBy: \'subject.\' + currentLanguageNameField()"> {{currentLanguageNameField(row.subject)+ \' - \' + (row.teacherNames || []).join(\', \')}} </md-option> </md-select> </md-input-container> <md-input-container flex="45" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0" ng-if="record.id"> <label class="textInput">{{\'exam.subjectTeacher\' | translate}}</label> <hois-value value="currentLanguageNameField(formState.subjectStudyPeriod.subject)+ \' - \' + (formState.subjectStudyPeriod.teacherNames || []).join(\', \')"></hois-value> </md-input-container> <md-input-container flex="15" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label class="textInput">{{\'exam.assessment\' | translate}}</label> <hois-classifier-value ng-model="formState.subjectStudyPeriod.assessment" main-classifier-code="HINDAMISVIIS"></hois-classifier-value> </md-input-container> </div> <br> <div layout="row" class="form-readonly"> <md-input-container flex="15" flex-sm="100" flex-xs="100" flex-offset-xs="0" flex-offset-sm="0"> <label class="textInput">{{\'exam.type\' | translate}}</label> <hois-classifier-select ng-model="record.type" ng-disabled="record.students && record.students.length" ng-change="examTypeChanged()" required main-classifier-code="SOORITUS" model-value-attr="code"></hois-classifier-select> </md-input-container> <md-input-container flex="65" flex-sm="100" flex-xs="100" flex-offset="10" flex-offset-xs="0" flex-offset-sm="0"> <label class="textInput">{{\'exam.name\' | translate}}</label> <hois-value value="record.name"></hois-value> </md-input-container> </div> <div layout="row"> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100"> <label>{{\'exam.date\' | translate}}</label> <md-datepicker name="startDate" ng-disabled="!formState.allEditable" md-min-date="formState.minDate" ng-model="record.startDate" required></md-datepicker> <div ng-messages="examForm.startDate.$error"> <div ng-message="mindate"> {{\'exam.message.startinpast\' | translate}} </div> </div> </md-input-container> <md-input-container flex="10" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'main.start\' | translate}}</label> <hois-time required ng-readonly="!formState.allEditable" ng-model="record.startTime" name="startTime" placeholder="{{\'main.timePlaceholder\' | translate}}"></hois-time> <div ng-messages="examForm.startTime.$error"> <div ng-message="time"> {{\'main.messages.error.time\' | translate}} </div> </div> </md-input-container> <md-input-container flex="10" flex-sm="100" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'main.end\' | translate}}</label> <hois-time required ng-readonly="!formState.allEditable" ng-model="record.endTime" name="endTime" placeholder="{{\'main.timePlaceholder\' | translate}}"></hois-time> <div ng-messages="examForm.endTime.$error"> <div ng-message="time"> {{\'main.messages.error.time\' | translate}} </div> </div> </md-input-container> <hois-autocomplete label="exam.room" ng-model="record.room" method="rooms" warning-param="isOccupied" required flex="40" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0" additional-query-params="{isStudy: true, occupied: true, date: record.startDate, \r\n            startTime: record.startTime ? getLocalDateTime(record.startTime) : null, endTime: record.startTime ? getLocalDateTime(record.endTime) : null}"></hois-autocomplete> </div> <div layout="row"> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100"> <label>{{\'exam.deadline\' | translate}}</label> <md-datepicker ng-required="record.deadlineTime" md-max-date="record.startDate" ng-model="record.deadlineDate"></md-datepicker> </md-input-container> <md-input-container flex="10" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'exam.deadlineTime\' | translate}}</label> <hois-time ng-required="record.deadlineDate" ng-model="record.deadlineTime" name="deadlineTime" placeholder="{{\'main.timePlaceholder\' | translate}}"></hois-time> <div ng-messages="examForm.deadlineTime.$error"> <div ng-message="time"> {{\'main.messages.error.time\' | translate}} </div> </div> </md-input-container> <md-input-container flex="40" flex-sm="100" flex-offset="15" flex-offset-xs="0" flex-offset-sm="0"> <label class="textInput">{{\'exam.places\' | translate}}</label> <input ng-model="record.places" name="places" type="number" min="0" max="9999"> <div ng-messages="examForm.places.$error"> <div ng-message="min"> {{\'main.messages.error.min\' | translate: {min: 0} }} </div> <div ng-message="max"> {{\'main.messages.error.max\' | translate: {max: 9999} }} </div> </div> </md-input-container> </div> <div layout="row"> <md-input-container flex="90" flex-sm="100" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'exam.addInfo\' | translate}}</label> <textarea ng-model="record.addInfo" name="addInfo" md-maxlength="4000" max-rows="2"></textarea> <div ng-messages="examForm.addInfo.$error"> <div ng-message="md-maxlength"> {{\'main.messages.error.maxlength\' | translate}} </div> </div> </md-input-container> </div> <md-autocomplete ng-if="record.id" flex="20" flex-sm="100" flex-xs="100" flex-offset-xs="0" flex-offset-sm="0" ng-disabled="record.places >= 0 && record.students.length >= record.places" md-floating-label="{{\'exam.addStudent\' | translate}}" md-min-length="2" md-items="item in lookupStudents(queryText)" md-item-text="item.fullname" md-search-text="queryText" md-selected-item="formState.selectedStudent" md-selected-item-change="addStudent()" md-no-cache> <md-item-template> <span md-highlight-text="queryText" md-highlight-flags="^i">{{item.fullname}}</span> </md-item-template> <md-not-found> {{\'main.messages.error.notFound\' | translate}} </md-not-found> </md-autocomplete> <br> <md-table-container ng-if="record.id"> <table md-table class="secondary-table"> <thead md-head md-order="formState.order"> <tr md-row> <th md-column>{{\'main.rowno\' | translate}}</th> <th md-column>{{\'exam.student.fullname\' | translate}}</th> <th md-column md-order-by="curriculumVersion.{{currentLanguageNameField()}}">{{\'exam.student.curriculum\' | translate}}</th> <th md-column md-order-by="studentGroup">{{\'exam.student.studentGroup\' | translate}}</th> <th md-column md-order-by="registered">{{\'exam.student.registered\' | translate}}</th> <th></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in formState.students | orderBy: formState.order" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{::row.rowno}}</td> <td md-cell> <a class="md-primary" ng-href="#/students/{{::row.studentId}}/main">{{::row.fullname}}</a> </td> <td md-cell>{{currentLanguageNameField(row.curriculumVersion)}}</td> <td md-cell>{{::row.studentGroup}}</td> <td md-cell>{{row.registered | hoisDate}}</td> <td md-cell> <a ng-if="!row.grade" ng-click="deleteStudent(row)" md-no-ink class="remove">&times;</a> </td> </tr> </tbody> </table> </md-table-container> <div layout="row"> <md-button class="md-raised md-primary" ng-click="update()">{{\'main.button.save\' | translate}}</md-button> <md-button class="md-raised" ng-if="record.id && formState.canDelete" ng-click="delete()">{{\'main.button.delete\' | translate}}</md-button> <md-button ng-click="back(\'#/examTimes\', examForm)" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </div> </form> </div> </div>'),
a.put("exam/registration.student.html",'<div layout-padding> <div flex> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label>{{\'exam.studyPeriod\' | translate}}</label> <hois-select ng-model="criteria.studyPeriod" ng-change="studyPeriodChanged()" values="formState.studyPeriods"></hois-select> </md-input-container> </div> <br> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="s.code,{{currentLanguage()===\'en\' ? \'s.nameEn\' : \'s.nameEt\'}}">{{\'exam.subject\' | translate}}</th> <th md-column>{{\'exam.teacher\' | translate}}</th> <th md-column md-order-by="sm.{{currentLanguageNameField()}}">{{\'exam.assessment\' | translate}}</th> <th md-column md-order-by="tp.{{currentLanguageNameField()}}">{{\'exam.type\' | translate}}</th> <th md-column md-order-by="te.start">{{\'exam.when\' | translate}}</th> <th md-column>{{\'exam.room\' | translate}}</th> <th md-column md-order-by="deadline">{{\'exam.deadline\' | translate}}</th> <th md-column>{{\'exam.freePlaces\' | translate}}</th> <th md-column>{{\'exam.addInfo\' | translate}}</th> <th></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{currentLanguageNameField(row.subject)}}</td> <td md-cell> <div ng-repeat="it in row.teacherNames"> {{it}} </div> </td> <td md-cell>{{currentLanguageNameField(row.assessment)}}</td> <td md-cell>{{currentLanguageNameField(row.type)}}</td> <td md-cell>{{row.start | hoisDateTimeMin}}</td> <td md-cell> <div ng-repeat="it in row.rooms"> {{it}} </div> </td> <td md-cell>{{row.deadline | hoisDateTimeMin}}</td> <td md-cell>{{row.freePlaces}}</td> <td md-cell>{{row.addInfo}}</td> <td md-cell> <md-button ng-if="!row.registered && row.canChange && (row.freePlaces === null || row.freePlaces > 0)" md-no-ink class="md-primary change-button" ng-click="register(row)">{{\'exam.register\' | translate}}</md-button> <md-button ng-if="row.registered && row.canChange && row.protocol === null" md-no-ink class="md-primary change-button" ng-click="unregister(row)">{{\'exam.unregister\' | translate}}</md-button> <span ng-if="row.registered && row.protocol !== null">{{\'exam.connectedProtocol\' | translate}}</span> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> </div>'),a.put("exam/search.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <form ng-submit="loadData()" novalidate> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label>{{\'exam.studyPeriod\' | translate}}</label> <hois-select ng-model="criteria.studyPeriod" values="formState.studyPeriods" sorted-query="true"></hois-select> </md-input-container> <md-input-container flex="50" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label class="textInput">{{\'exam.subject\' | translate}}</label> <hois-select ng-model="criteria.subject" type="subject" criteria="{withCredits: false}"></hois-select> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <div layout="column" flex="45" flex-sm="100" flex-xs="100"> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex-sm="100" flex-xs="100"> <label>{{\'main.from\' | translate}}</label> <md-datepicker ng-model="criteria.from" md-max-date="criteria.thru" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> <md-input-container flex-sm="100" flex-xs="100"> <label>{{\'main.thru\' | translate}}</label> <md-datepicker ng-model="criteria.thru" md-min-date="criteria.from" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> </div> </div> <md-input-container flex="50" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0" ng-if="auth.isAdmin()"> <label class="textInput">{{\'exam.teacher\' | translate}}</label> <hois-select ng-model="criteria.teacher" type="teacher" criteria="{higher: true}"></hois-select> </md-input-container> </div> <div layout="row"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> <md-button class="md-raised" ng-if="formState.canAdd" ng-href="#/exams/new">{{\'main.button.create\' | translate}}</md-button> </div> <div flex-xs="0" flex-gt-xs="0" flex-gt-sm="50"></div> </form> </fieldset> </div> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="s.code,{{currentLanguage()===\'en\' ? \'s.nameEn\' : \'s.nameEt\'}}">{{\'exam.subject\' | translate}}</th> <th md-column>{{\'exam.teacher\' | translate}}</th> <th md-column md-order-by="te.start">{{\'exam.when\' | translate}}</th> <th md-column md-order-by="tp.{{currentLanguageNameField()}}">{{\'exam.type\' | translate}}</th> <th md-column md-order-by="7" md-numeric>{{\'exam.studentCount\' | translate}}</th> <th></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell> <a md-class="md-primary change-button" ng-href="#/exams/{{::row.id}}/view">{{currentLanguageNameField(row.subject)}}</a> </td> <td md-cell> <div ng-repeat="it in row.teacherNames"> {{it}} </div> </td> <td md-cell>{{row.start | hoisDateTimeMin}}</td> <td md-cell>{{currentLanguageNameField(row.type)}}</td> <td md-cell>{{::row.studentCount}}</td> <td md-cell> <md-button ng-if="row.userCanEdit" md-no-ink class="md-primary change-button" ng-href="#/exams/{{::row.id}}/edit">{{\'main.button.change\' | translate}}</md-button> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> </div>'),a.put("exam/view.html",'<div layout-padding ng-cloak class="form-readonly"> <div flex> <div layout="row"> <md-input-container flex="20" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'exam.studyPeriod\' | translate}}</label> <hois-value value="currentLanguageNameField(record.subjectStudyPeriodDto.studyPeriod)"></hois-value> </md-input-container> <md-input-container flex="45" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label class="textInput">{{\'exam.subjectTeacher\' | translate}}</label> <hois-value value="currentLanguageNameField(record.subjectStudyPeriodDto.subject)+ \' - \' + (record.subjectStudyPeriodDto.teacherNames || []).join(\', \')"></hois-value> </md-input-container> <md-input-container flex="15" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label class="textInput">{{\'exam.assessment\' | translate}}</label> <hois-classifier-value ng-model="record.subjectStudyPeriodDto.assessment" main-classifier-code="HINDAMISVIIS"></hois-classifier-value> </md-input-container> </div> <div layout="row" layout-xs="column" flex> <md-input-container flex="15" flex-sm="100" flex-xs="100"> <label>{{\'exam.type\' | translate}}</label> <hois-classifier-value ng-model="record.type" main-classifier-code="SOORITUS"></hois-classifier-value> </md-input-container> <md-input-container flex="65" flex-sm="100" flex-xs="100" flex-offset="10" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'exam.name\' | translate}}</label> <hois-value value="record.name"></hois-value> </md-input-container> </div> <div layout="row" layout-xs="column" flex> <md-input-container flex="15" flex-sm="100" flex-xs="100"> <label>{{\'exam.date\' | translate}}</label> <hois-value value="record.startDate | hoisDate"></hois-value> </md-input-container> <md-input-container flex="10" flex-sm="100" flex-xs="100" flex-offset="10" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'main.start\' | translate}}</label> <hois-value value="record.startTime | hoisTime"></hois-value> </md-input-container> <md-input-container flex="10" flex-sm="100" flex-xs="100" flex-offset="0" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'main.end\' | translate}}</label> <hois-value value="record.endTime | hoisTime"></hois-value> </md-input-container> <md-input-container flex="40" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'exam.room\' | translate}}</label> <hois-value value="record.room.nameEt"></hois-value> </md-input-container> </div> <div layout="row" layout-xs="column" flex> <md-input-container flex="15" flex-sm="100" flex-xs="100"> <label>{{\'exam.deadline\' | translate}}</label> <hois-value value="record.deadlineDate | hoisDate"></hois-value> </md-input-container> <md-input-container flex="10" flex-sm="100" flex-xs="100" flex-offset="10" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'exam.deadlineTime\' | translate}}</label> <hois-value value="record.deadlineTime | hoisTime"></hois-value> </md-input-container> <md-input-container flex="40" flex-sm="100" flex-xs="100" flex-offset="15" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'exam.places\' | translate}}</label> <hois-value value="record.places"></hois-value> </md-input-container> </div> <div layout="row" layout-xs="column" flex> <md-input-container flex="90" flex-sm="100" flex-xs="100"> <label>{{\'exam.addInfo\' | translate}}</label> <hois-value value="record.addInfo"></hois-value> </md-input-container> </div> <md-table-container ng-if="record.studentRecords && record.studentRecords.length > 0"> <table md-table> <thead md-head md-order="formState.order"> <tr md-row> <th md-column>{{\'main.rowno\' | translate}}</th> <th md-column md-order-by="rowno">{{\'exam.student.fullname\' | translate}}</th> <th md-column md-order-by="curriculumVersion.{{currentLanguageNameField()}}">{{\'exam.student.curriculum\' | translate}}</th> <th md-column md-order-by="studentGroup">{{\'exam.student.studentGroup\' | translate}}</th> <th md-column md-order-by="registered">{{\'exam.student.registered\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in record.studentRecords | orderBy: formState.order" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{::row.rowno}}</td> <td md-cell> <a class="md-primary" ng-href="#/students/{{::row.studentId}}/main">{{::row.fullname}}</a> </td> <td md-cell>{{currentLanguageNameField(row.curriculumVersion)}}</td> <td md-cell>{{::row.studentGroup}}</td> <td md-cell>{{row.registered | hoisDate}}</td> </tr> </tbody> </table> </md-table-container> <md-button ng-if="record.id && record.userCanEdit" class="md-primary md-raised" ng-href="#/exams/{{record.id}}/edit?_noback">{{\'main.button.change\' | translate}}</md-button> <md-button ng-click="back(\'#/examTimes\')" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </div> </div>'),a.put("fakePages/fake.html",""),a.put("finalThesis/final.thesis.edit.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <form name="finalThesisForm" ng-submit="save()" novalidate> <div ng-hide="thesis.student" layout="row" layout-sm="column" layout-xs="column"> <div flex="45" flex-sm="100" flex-xs="100"> <hois-autocomplete flex ng-model="thesis.student" name="student" label="finalThesis.student" url="/finalThesis/students"></hois-autocomplete> </div> </div> <div ng-hide="!thesis.student" class="form-readonly"> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label>{{\'finalThesis.student\' | translate}}</label> <hois-value value="thesis.person.firstname + \' \' + thesis.person.lastname"></hois-value> </md-input-container> <md-input-container ng-if="thesis.confirmed" flex="45" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'finalThesis.confirmed\' | translate}}</label> <hois-value value="thesis.confirmed | hoisDate"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label>{{\'finalThesis.curriculum\' | translate}}</label> <hois-value value="currentLanguageNameField(thesis.curriculumVersion)"></hois-value> </md-input-container> <md-input-container flex="45" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'finalThesis.studentGroup\' | translate}}</label> <hois-value value="currentLanguageNameField(thesis.studentGroup)"></hois-value> </md-input-container> </div> </div> <div ng-hide="!thesis.student"> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label>{{\'finalThesis.themeEt\' | translate}}</label> <input type="text" ng-model="thesis.themeEt" md-maxlength="4000" required> </md-input-container> <md-input-container flex="45" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'finalThesis.themeEn\' | translate}}</label> <input type="text" ng-model="thesis.themeEn" md-maxlength="4000" ng-required="!thesis.isVocational"> </md-input-container> </div> <br> <div layout="row"> <md-input-container> <md-checkbox ng-model="thesis.hasDraft" aria-label="{{\'finalThesis.draft\' | translate}}">{{\'finalThesis.draft\' | translate}}</md-checkbox> </md-input-container> </div> <div layout="row"> <md-input-container ng-show="thesis.hasDraft" flex> <label>{{\'finalThesis.draft\' | translate}}</label> <textarea ng-model="thesis.draft" md-maxlength="20000" max-rows="10"></textarea> </md-input-container> </div> <div layout="row" flex> <md-input-container flex> <label>{{\'finalThesis.addInfo\' | translate}}</label> <textarea ng-model="thesis.addInfo" md-maxlength="4000" max-rows="2" ng-disabled="auth.isStudent()"></textarea> </md-input-container> </div> <br> <fieldset> <legend md-colors="{color: \'primary-800\'}" ng-class="{invalid: finalThesisForm.$submitted && thesis.supervisors.length === 0}" class="md-title-small">{{\'finalThesis.supervisors\' | translate}}&nbsp;*</legend> <md-button class="md-raised" ng-click="openAddSupervisorDialog()">{{\'main.button.add\' | translate}}</md-button> <md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'finalThesis.supervisor.name\' | translate}}</th> <th md-column>{{\'finalThesis.primarySupervisor\' | translate}}</th> <th md-column>{{\'finalThesis.externalSupervisor\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="supervisor in thesis.supervisors track by $index" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{supervisor.firstname}} {{supervisor.lastname}}</td> <td md-cell> <md-checkbox ng-checked="supervisor.isPrimary" ng-disabled="true" aria-label="{{\'finalThesis.primarySupervisor\' | translate}}"></md-checkbox> </td> <td md-cell> <md-checkbox ng-checked="supervisor.isExternal" ng-disabled="true" aria-label="{{\'finalThesis.externalSupervisor\' | translate}}"></md-checkbox> </td> <td md-cell> <md-button md-no-ink class="md-primary change-button" ng-click="openAddSupervisorDialog($index)">{{\'main.button.change\' | translate}}</md-button> </td> </tr> </tbody> </table> </md-table-container> </fieldset> </div> <div ng-if="thesis.student" layout="row"> <md-button ng-if="!thesis.id || thesis.canBeEdited" class="md-raised md-primary" type="submit">{{\'main.button.save\' | translate}}</md-button> <md-button ng-if="thesis.canBeConfirmed" class="md-raised" ng-click="confirm()">{{\'main.button.confirm\' | translate}}</md-button> <a ng-if="thesis.id" href="{{finalThesisPdfUrl}}" target="_blank" class="md-button md-raised">{{\'main.button.print\' | translate}}</a> <md-button ng-if="!auth.isStudent()" class="md-raised md-default" ng-click="back(\'#/finalThesis/\')">{{\'main.button.back\' | translate}}</md-button> </div> <div ng-if="!thesis.student" layout="row"> <md-button class="md-raised md-default" ng-click="back(\'#/finalThesis/\')">{{\'main.button.back\' | translate}}</md-button> </div> </form> </div> </div>'),a.put("finalThesis/final.thesis.list.html",'<div ng-if="auth.isAdmin() || auth.isTeacher()" class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <form name="searchForm" ng-submit="searchForm.$valid && loadData()" novalidate ng-model-options="{allowInvalid: true}"> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label>{{\'finalThesis.student\' | translate}}</label> <input ng-model="criteria.studentName" name="student" type="text" md-maxlength="255"> </md-input-container> <md-input-container flex="50" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'finalThesis.label\' | translate}}</label> <input ng-model="criteria.theme" name="theme" type="text" md-maxlength="255"> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label>{{\'finalThesis.curriculum\' | translate}}</label> <hois-select ng-model="criteria.curriculumVersion" name="curriculumVersion" type="curriculumversion"></hois-select> </md-input-container> <div flex="50" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <hois-autocomplete flex ng-model="criteria.studentGroup" ha-attribute="id" ha-controller="directiveControllers" method="studentgroups" name="studentGroup" label="finalThesis.studentGroup"></hois-autocomplete> </div> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label>{{\'finalThesis.status\' | translate}}</label> <hois-classifier-select ng-model="criteria.status" main-classifier-code="LOPUTOO_STAATUS" model-value-attr="code"></hois-classifier-select> </md-input-container> <md-input-container ng-if="auth.isAdmin()" flex="50" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'finalThesis.supervisor.label\' | translate}}</label> <input ng-model="criteria.supervisor" name="supervisor" type="text" md-maxlength="255"> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <div flex="45" flex-sm="100" flex-xs="100"> <div layout="column" flex> <div layout="row" flex> <md-input-container> <label>{{\'finalThesis.insertedFrom\' | translate}}</label> <md-datepicker ng-model="criteria.insertedFrom" md-max-date="criteria.insertedThru" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> <md-input-container flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'finalThesis.insertedThru\' | translate}}</label> <md-datepicker ng-model="criteria.insertedThru" md-min-date="criteria.insertedFrom" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> </div> </div> </div> <div flex="45" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <div layout="column" flex> <div layout="row" flex> <md-input-container> <label>{{\'finalThesis.confirmedFrom\' | translate}}</label> <md-datepicker ng-model="criteria.confirmedFrom" md-max-date="criteria.confirmedThru" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> <md-input-container flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'finalThesis.confirmedThru\' | translate}}</label> <md-datepicker ng-model="criteria.confirmedThru" md-min-date="criteria.confirmedFrom" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> </div> </div> </div> </div> <div layout="row"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> <md-button ng-if="isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_LOPTEEMA\') && auth.isAdmin()" ng-href="#/finalThesis/new" class="md-raised">{{\'main.button.create\' | translate}}</md-button> </div> <div flex-xs="0" flex-gt-xs="0" flex-gt-sm="50"></div> </form> </fieldset> </div> </div> <div ng-if="auth.isAdmin() || auth.isTeacher()" layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="2">{{\'finalThesis.label\' | translate}}</th> <th md-column md-order-by="4">{{\'finalThesis.student\' | translate}}</th> <th md-column md-order-by="7">{{\'finalThesis.idcode\' | translate}}</th> <th md-column md-order-by="8">{{\'finalThesis.supervisors\' | translate}}</th> <th md-column md-order-by="9">{{\'finalThesis.curriculum\' | translate}}</th> <th md-column md-order-by="12">{{\'finalThesis.studentGroup\' | translate}}</th> <th md-column md-order-by="13">{{\'finalThesis.insertedDate\' | translate}}</th> <th md-column md-order-by="14">{{\'finalThesis.confirmedDate\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell> <a ng-href="#/finalThesis/{{row.id}}/view">{{row.themeEt}}</a> </td> <td md-cell>{{row.student.nameEt}}</td> <td md-cell>{{row.idcode}}</td> <td md-cell>{{row.supervisors}}</td> <td md-cell>{{currentLanguageNameField(row.curriculumVersion)}}</td> <td md-cell>{{row.studentGroup}}</td> <td md-cell>{{row.inserted | hoisDate}}</td> <td md-cell>{{row.confirmed | hoisDate}}</td> <td md-cell> <div ng-if="row.canBeEdited"> <md-button md-no-ink class="md-primary change-button" ng-href="#/finalThesis/{{::row.id}}/edit">{{\'main.button.change\' | translate}}</md-button> </div> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> </div> <div ng-if="noFinalThesisModule" layout-padding> <md-whiteframe class="md-whiteframe-1dp attention-whiteframe" flex="100" layout layout-align="left center"> <div md-colors="{color: \'accent\'}"> <md-icon md-colors="{color: \'accent\'}" md-font-set="material-icons">info_outline</md-icon> <span>{{\'finalThesis.error.noFinalThesisModule\' | translate}}</span> </div> </md-whiteframe> </div>'),a.put("finalThesis/final.thesis.view.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <form name="finalThesisForm" ng-submit="save()" novalidate> <div class="form-readonly"> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label>{{\'finalThesis.student\' | translate}}</label> <hois-value value="thesis.person.firstname + \' \' + thesis.person.lastname"></hois-value> </md-input-container> <md-input-container ng-if="thesis.confirmed" flex="45" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'finalThesis.confirmed\' | translate}}</label> <hois-value value="thesis.confirmed | hoisDate"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label>{{\'finalThesis.curriculum\' | translate}}</label> <hois-value value="currentLanguageNameField(thesis.curriculumVersion)"></hois-value> </md-input-container> <md-input-container flex="45" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'finalThesis.studentGroup\' | translate}}</label> <hois-value value="currentLanguageNameField(thesis.studentGroup)"></hois-value> </md-input-container> </div> </div> <div class="form-readonly"> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label>{{\'finalThesis.themeEt\' | translate}}</label> <hois-value value="thesis.themeEt"></hois-value> </md-input-container> <md-input-container flex="45" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'finalThesis.themeEn\' | translate}}</label> <hois-value value="thesis.themeEn"></hois-value> </md-input-container> </div> <br> <div layout="row"> <md-input-container> <md-checkbox ng-model="thesis.hasDraft" aria-label="{{\'finalThesis.draft\' | translate}}" disabled>{{\'finalThesis.draft\' | translate}}</md-checkbox> </md-input-container> </div> <div layout="row"> <md-input-container ng-show="thesis.hasDraft" flex> <label>{{\'finalThesis.draft\' | translate}}</label> <textarea ng-model="thesis.draft" md-maxlength="20000" max-rows="10" readonly></textarea> </md-input-container> </div> <div ng-if="thesis.addInfo" layout="row" flex> <md-input-container flex> <label>{{\'finalThesis.addInfo\' | translate}}</label> <textarea ng-model="thesis.addInfo" md-maxlength="4000" max-rows="2" readonly></textarea> </md-input-container> </div> <br> <fieldset ng-if="thesis.supervisors.length > 0"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'finalThesis.supervisors\' | translate}}</legend> <md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'finalThesis.supervisor.name\' | translate}}</th> <th md-column>{{\'finalThesis.primarySupervisor\' | translate}}</th> <th md-column>{{\'finalThesis.externalSupervisor\' | translate}}</th> <th md-column>{{\'finalThesis.supervisor.occupation\' | translate}}</th> <th md-column>{{\'finalThesis.supervisor.email\' | translate}}</th> <th md-column ng-if="!auth.isStudent()">{{\'finalThesis.supervisor.idcode\' | translate}}</th> <th md-column>{{\'finalThesis.supervisor.phone\' | translate}}</th> <th md-column>{{\'finalThesis.supervisor.bankaccount\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="supervisor in thesis.supervisors track by $index" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{supervisor.firstname}} {{supervisor.lastname}}</td> <td md-cell> <md-checkbox ng-checked="supervisor.isPrimary" ng-disabled="true" aria-label="{{\'finalThesis.primarySupervisor\' | translate}}"></md-checkbox> </td> <td md-cell> <md-checkbox ng-checked="supervisor.isExternal" ng-disabled="true" aria-label="{{\'finalThesis.externalSupervisor\' | translate}}"></md-checkbox> </td> <td md-cell>{{supervisor.occupation}}</td> <td md-cell>{{supervisor.email}}</td> <td md-cell ng-if="!auth.isStudent()">{{supervisor.idcode}}</td> <td md-cell>{{supervisor.phone}}</td> <td md-cell>{{supervisor.bankaccount}}</td> </tr> </tbody> </table> </md-table-container> </fieldset> </div> <div layout="row"> <md-button ng-if="thesis.canBeEdited" class="md-raised md-primary" ng-href="#/finalThesis/{{::thesis.id}}/edit">{{\'main.button.edit\' | translate}}</md-button> <md-button ng-if="thesis.canBeConfirmed" class="md-raised" ng-click="confirm()">{{\'main.button.confirm\' | translate}}</md-button> <a ng-if="thesis.id" href="{{finalThesisPdfUrl}}" target="_blank" class="md-button md-raised">{{\'main.button.print\' | translate}}</a> <md-button ng-if="!auth.isStudent()" class="md-raised md-default" ng-click="back(\'#/finalThesis/\')">{{\'main.button.back\' | translate}}</md-button> </div> </form> </div> </div>'),a.put("finalThesis/supervisor.add.dialog.html",'<md-dialog aria-label="supervisor edit dialog" flex="50" flex-sm="50" flex-xs="100"> <form name="dialogForm" novalidate ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2>{{"finalThesis.supervisor.add" | translate}}</h2> <span flex></span> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <div layout-padding> <form name="supervisorForm" novalidate> <div layout="row" layout-sm="column" layout-xs="column"> <md-radio-group layout-gt-sm="row" ng-model="supervisor.isExternal" ng-change="typeChanged(supervisor.isExternal)" required> <md-input-container> <md-radio-button ng-value="false" aria-label="passedModule"> {{\'finalThesis.inSchool\' | translate}} </md-radio-button> </md-input-container> <md-input-container> <md-radio-button ng-value="true" aria-label="curriculumModule"> {{\'finalThesis.external\' | translate}} </md-radio-button> </md-input-container> </md-radio-group> </div> <div ng-if="supervisor.isExternal == true || supervisor.isExternal == false"> <md-input-container> <md-checkbox ng-model="supervisor.isPrimary" ng-disabled="false" aria-label="{{\'finalThesis.primarySupervisor\' | translate}}"> {{\'finalThesis.primarySupervisor\' | translate}} </md-checkbox> </md-input-container> </div> <div ng-if="supervisor.isExternal == true" layout="row" layout-sm="column" layout-xs="column"> <div layout="column" flex> <md-input-container> <label>{{\'finalThesis.supervisor.firstname\' | translate}}</label> <input type="text" ng-model="supervisor.firstname" name="firstname" md-maxlength="100" required> </md-input-container> <md-input-container> <label>{{\'finalThesis.supervisor.lastname\' | translate}}</label> <input type="text" ng-model="supervisor.lastname" name="lastname" md-maxlength="100" required> </md-input-container> <md-input-container> <label>{{\'finalThesis.supervisor.idcode\' | translate}}</label> <input type="text" ng-model="supervisor.idcode" name="idcode" md-maxlength="11"> </md-input-container> <md-input-container> <label>{{\'finalThesis.supervisor.occupation\' | translate}}</label> <input type="text" ng-model="supervisor.occupation" name="occupation" md-maxlength="100" required> </md-input-container> <md-input-container> <label>{{\'finalThesis.supervisor.email\' | translate}}</label> <input type="email" ng-model="supervisor.email" name="email" md-maxlength="100" required> </md-input-container> <md-input-container> <label>{{\'finalThesis.supervisor.phone\' | translate}}</label> <input type="text" ng-model="supervisor.phone" name="phone" md-maxlength="100"> </md-input-container> <md-input-container> <label>{{\'finalThesis.supervisor.bankaccount\' | translate}}</label> <input type="text" ng-model="supervisor.bankaccount" name="bankaccount" md-maxlength="50"> </md-input-container> </div> </div> <span ng-if="supervisor.isExternal == false"> <div layout="column" flex> <div> <hois-autocomplete label="finalThesis.supervisor.name" ng-model="supervisor.teacher" method="teachers" additional-query-params="{valid: true}" required></hois-autocomplete> </div> </div> <br> <div class="form-readonly"> <div layout="column"> <md-input-container flex> <label>{{\'finalThesis.supervisor.occupation\' | translate}}</label> <hois-value value="supervisor.occupation"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'finalThesis.supervisor.email\' | translate}}</label> <hois-value value="supervisor.email"></hois-value> </md-input-container> </div> </div> </span> </form> </div> </md-dialog-content> {{supervisorIndex}} <span flex></span> <md-dialog-actions layout="row" layout-align="start center"> <md-button ng-if="newSupervisor" class="md-raised md-primary" ng-click="submitSupervisor()">{{"main.button.add" | translate}}</md-button> <md-button ng-if="!newSupervisor" class="md-raised md-primary" ng-click="submitSupervisor()">{{"main.button.edit" | translate}}</md-button> <md-button ng-if="!newSupervisor" class="md-raised" ng-click="removeSupervisor()">{{"main.button.delete" | translate}}</md-button> <md-button class="md-raised" ng-click="cancel()">{{"main.button.close" | translate}}</md-button> </md-dialog-actions> </form> </md-dialog>'),
a.put("finalThesis/thesis.topic.view.html",""),a.put("form/form.edit.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <form name="formForm" class="nomargin"> <div layout="row"> <md-input-container flex="40" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'form.type\' | translate}}</label> <hois-classifier-select ng-model="formState.type" name="type" model-value-attr="code" main-classifier-code="LOPUBLANKETT" ignore-preselected only-valid criteria="{higher: auth.school.higher ? true : undefined, vocational: auth.school.vocational ? true : undefined}" required></hois-classifier-select> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <div layout="column" flex="45" flex-sm="100" flex-xs="100"> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex-sm="100" flex-xs="100"> <label>{{\'main.from\' | translate}}</label> <input ng-model="formState.from" pattern="\\d*" required> </md-input-container> <md-input-container flex-sm="100" flex-xs="100"> <label>{{\'main.thru\' | translate}}</label> <input ng-model="formState.thru" pattern="\\d*" required> </md-input-container> </div> </div> </div> <div layout="row" ng-if="actionType === \'defected\'"> <md-input-container flex="50" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'form.reason\' | translate}}</label> <input ng-model="formState.reason" name="reason" required> </md-input-container> </div> <div layout="row"> <md-button class="md-raised md-primary" ng-click="update()">{{getButtonLabelKey() | translate}}</md-button> <md-button ng-click="back(\'#/forms\')" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </div> </form> </div> </div>'),a.put("form/form.list.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <form ng-submit="loadData()" novalidate> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label>{{\'form.type\' | translate}}</label> <hois-classifier-select ng-model="criteria.type" name="type" model-value-attr="code" main-classifier-code="LOPUBLANKETT"></hois-classifier-select> </md-input-container> <md-input-container flex="50" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label class="textInput">{{\'form.status\' | translate}}</label> <hois-classifier-select ng-model="criteria.status" name="status" model-value-attr="code" main-classifier-code="LOPUBLANKETT_STAATUS"></hois-classifier-select> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <div layout="column" flex="45" flex-sm="100" flex-xs="100"> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex-sm="100" flex-xs="100"> <label>{{\'main.from\' | translate}}</label> <input type="number" ng-model="criteria.from" min="0"> </md-input-container> <md-input-container flex-sm="100" flex-xs="100"> <label>{{\'main.thru\' | translate}}</label> <input type="number" ng-model="criteria.thru" min="0"> </md-input-container> </div> </div> </div> <div layout="row"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> <md-button class="md-raised" ng-if="canEdit" href="#/forms/new">{{\'main.button.add\' | translate}}</md-button> <md-button class="md-raised" ng-if="canEdit" href="#/forms/delete">{{\'main.button.delete\' | translate}}</md-button> <md-button class="md-raised" ng-if="canEdit" href="#/forms/defected">{{\'form.button.defected\' | translate}}</md-button> <a ng-href="{{excel(formState.xlsUrl, criteria)}}" target="_blank" class="md-button md-raised">{{\'form.button.excel\' | translate}}</a> </div> <div flex-xs="0" flex-gt-xs="0" flex-gt-sm="50"></div> </form> </fieldset> </div> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head> <tr md-row> <th md-column>{{\'form.type\' | translate}}</th> <th md-column>{{\'form.code\' | translate}}</th> <th md-column>{{\'main.from\' | translate}}</th> <th md-column>{{\'main.thru\' | translate}}</th> <th md-column md-numeric>{{\'form.count\' | translate}}</th> <th md-column>{{\'form.status\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{currentLanguageNameField(row.type)}}</td> <td md-cell>{{::row.code}}</td> <td md-cell>{{::row.fromFullCode}}</td> <td md-cell>{{::row.thruFullCode}}</td> <td md-cell>{{::row.count}}</td> <td md-cell> {{currentLanguageNameField(row.status)}} <md-tooltip ng-if="row.status.code === \'LOPUBLANKETT_STAATUS_R\' && row.defectReason">{{::row.defectReason}}</md-tooltip> </td> </tr> </tbody> </table> </md-table-container> </div> </div>'),a.put("generalMessage/general.message.edit.html",'<div layout="column" layout-padding> <div> <form name="generalMessageForm"> <md-input-container class="md-block"> <label class="textInput">{{\'generalmessage.title\' | translate}}</label> <input ng-model="record.title" name="title" type="text" md-maxlength="1000" required autofocus> </md-input-container> <md-input-container class="md-block"> <label class="textInput">{{\'generalmessage.content\' | translate}}</label> <textarea ng-model="record.content" name="content" md-maxlength="4000" required></textarea> </md-input-container> <div layout="row"> <div flex="100"> <md-input-container flex> <label>{{\'generalmessage.validFrom\' | translate}}</label> <md-datepicker ng-model="record.validFrom" md-max-date="record.validThru"></md-datepicker> </md-input-container> <md-input-container flex flex-offset="5"> <label>{{\'generalmessage.validThru\' | translate}}</label> <md-datepicker ng-model="record.validThru" md-min-date="record.validFrom"></md-datepicker> </md-input-container> </div> </div> <div ng-if="!auth.isMainAdmin()">&nbsp;</div> <fieldset tabindex="1" ng-if="!auth.isMainAdmin()"> <legend ng-class="{invalid: generalMessageForm.$submitted && (!record.targets || record.targets.length === 0)}" md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'generalmessage.targets\' | translate}} *</legend> <div layout="column" class="common-label" ng-repeat="role in roleDefs"> <span> <md-checkbox ng-model="role._selected" ng-change="targetChanged()"> {{currentLanguageNameField(role)}} </md-checkbox> </span> </div> </fieldset> <div layout="row"> <md-button ng-click="update()" class="md-raised md-primary">{{\'main.button.save\' | translate}}</md-button> <md-button ng-click="delete()" ng-if="record.id" class="md-raised">{{\'main.button.delete\' | translate}}</md-button> <md-button ng-click="back(\'#/generalmessages\', generalMessageForm)" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </div> </form> </div> </div>'),a.put("generalMessage/general.message.list.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <fieldset tabindex="1"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <form name="searchForm" ng-submit="searchForm.$valid && loadData()" novalidate ng-model-options="{allowInvalid: true}"> <div flex layout="column"> <md-input-container> <label class="textInput">{{\'generalmessage.title\' | translate}}</label> <input ng-model="criteria.title" type="text" autofocus md-maxlength="255"> </md-input-container> <md-input-container ng-if="!auth.isMainAdmin()"> <label>{{\'generalmessage.targets\' | translate}}</label> <hois-classifier-select ng-model="criteria.targets" model-value-attr="code" main-classifier-code="ROLL" multiple></hois-classifier-select> </md-input-container> <div layout="row" flex> <md-input-container> <label>{{\'generalmessage.validFrom\' | translate}}</label> <md-datepicker ng-model="criteria.validFrom" md-max-date="criteria.validThru" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> <md-input-container flex-offset="5"> <label>{{\'generalmessage.validThru\' | translate}}</label> <md-datepicker ng-model="criteria.validThru" md-min-date="criteria.validFrom" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> </div> <div layout="row"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> <md-button class="md-raised" ng-if="canEdit" ng-href="#/generalmessages/new">{{\'main.button.create\' | translate}}</md-button> </div> </div> </form> </fieldset> </div> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="title">{{\'generalmessage.title\' | translate}}</th> <th md-column md-order-by="validFrom">{{\'generalmessage.validFrom\' | translate}}</th> <th md-column md-order-by="validThru">{{\'generalmessage.validThru\' | translate}}</th> <th md-column ng-if="!auth.isMainAdmin()">{{\'generalmessage.targets\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell> <a md-no-ink class="md-primary change-button" ng-href="#/generalmessages/{{::row.id}}/view">{{::row.title}}</a> </td> <td md-cell>{{::row.validFrom | hoisDate}}</td> <td md-cell>{{::row.validThru | hoisDate}}</td> <td md-cell ng-if="!auth.isMainAdmin()"> <table> <tr ng-repeat="role in row.targets | orderBy: \'nameEt\'"> <td>{{currentLanguageNameField(role)}}</td> </tr> </table> </td> <td md-cell> <md-button md-no-ink class="md-primary change-button" ng-if="canEdit" ng-href="#/generalmessages/{{::row.id}}/edit">{{\'main.button.change\' | translate}}</md-button> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> </div>'),a.put("generalMessage/general.message.view.html",'<div layout="column" layout-padding class="form-readonly"> <div> <form name="generalMessageForm"> <md-input-container class="md-block"> <label class="textInput">{{\'generalmessage.title\' | translate}}</label> <hois-value value="record.title"></hois-value> </md-input-container> <md-input-container class="md-block"> <label class="textInput">{{\'generalmessage.content\' | translate}}</label> <hois-value value="record.content"></hois-value> </md-input-container> <div layout="row" flex="100"> <md-input-container flex="20"> <label>{{\'generalmessage.validFrom\' | translate}}</label> <hois-value value="record.validFrom | hoisDate"></hois-value> </md-input-container> <md-input-container flex="20" flex-offset="5"> <label>{{\'generalmessage.validThru\' | translate}}</label> <hois-value value="record.validThru | hoisDate"></hois-value> </md-input-container> </div> <div ng-if="!auth.isMainAdmin()">&nbsp;</div> <fieldset tabindex="1" ng-if="!auth.isMainAdmin()"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'generalmessage.targets\' | translate}} *</legend> <div layout="column" class="common-label" ng-repeat="role in record.targets"> <span> <hois-classifier-value ng-model="role" main-classifier-code="ROLL"></hois-classifier-value> </span> </div> </fieldset> <md-button class="md-raised md-primary" ng-if="canEdit" ng-href="#/generalmessages/{{record.id}}/edit?_noback">{{\'main.button.change\' | translate}}</md-button> <md-button ng-href="#/generalmessages" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </form> </div> </div>'),a.put("higherCurriculum/higher.curriculum.grade.add.dialog.html",'<md-dialog aria-label="grade add dialog" flex="30" flex-xs="100"> <form name="dialogForm" ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2>{{"curriculum.grade.editLabel" | translate}}</h2> <span flex></span> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <span flex></span> <div class="ois-form-layout" layout="column" layout-margin ng-cloak> <div layout="column"> <md-input-container flex> <label>{{\'curriculum.grade.nameEt\' | translate}}</label> <input ng-model="data.nameEt" type="text" required md-maxlength="255"> </md-input-container> <md-input-container flex> <label>{{\'curriculum.grade.nameEn\' | translate}}</label> <input ng-model="data.nameEn" type="text" required md-maxlength="255"> </md-input-container> <md-input-container flex> <label>{{\'curriculum.grade.nameEtGenitive\' | translate}}</label> <input ng-model="data.nameGenitiveEt" type="text" required md-maxlength="255"> </md-input-container> <md-input-container flex> <label>{{\'curriculum.grade.ehisGrade\' | translate}}</label> <hois-classifier-select ng-model="data.ehisGrade" main-classifier-code="AKAD_KRAAD" required model-value-attr="code"></hois-classifier-select> </md-input-container> </div> </div> </md-dialog-content> <md-dialog-actions layout="row" layout-align="start center"> <md-button class="md-raised md-primary" ng-click="submit()">{{"main.button.save" | translate}}</md-button> <md-button ng-click="delete()" ng-if="editing" class="md-raised">{{"main.button.delete" | translate}}</md-button> <md-button class="md-raised" ng-click="cancel()">{{"main.button.close" | translate}}</md-button> </md-dialog-actions> </form> </md-dialog>'),a.put("higherCurriculum/higher.curriculum.grade.view.dialog.html",'<md-dialog aria-label="grade add dialog" flex="30" flex-xs="100"> <form name="dialogForm" ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2>{{"curriculum.grade.viewLabel" | translate}}</h2> <span flex></span> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <span flex></span> <div class="ois-form-layout" layout="column" layout-margin ng-cloak> <div layout="column"> <md-input-container flex> <label>{{\'curriculum.grade.nameEt\' | translate}}</label> <input ng-model="data.nameEt" type="text" readonly> </md-input-container> <md-input-container flex> <label>{{\'curriculum.grade.nameEn\' | translate}}</label> <input ng-model="data.nameEn" type="text" readonly> </md-input-container> <md-input-container flex> <label>{{\'curriculum.grade.nameEtGenitive\' | translate}}</label> <input ng-model="data.nameGenitiveEt" type="text" readonly> </md-input-container> <md-input-container flex> <label>{{\'curriculum.grade.ehisGrade\' | translate}}</label> <hois-classifier-select ng-model="data.ehisGrade" main-classifier-code="AKAD_KRAAD" model-value-attr="code" disabled></hois-classifier-select> </md-input-container> </div> </div> </md-dialog-content> <md-dialog-actions layout="row" layout-align="start center"> <md-button class="md-raised" ng-click="cancel()">{{"main.button.close" | translate}}</md-button> </md-dialog-actions> </form> </md-dialog>'),a.put("higherCurriculum/higher.curriculum.html",'<div class="ois-form-layout-padding"> <form name="higherCurriculumForm" layout="column" class="nomargin"> <div layout="row" layout-sm="column" layout-xs="column"> <fieldset tabindex="1" flex="30" flex-sm="100" flex-xs="100" class="higher-curriculum-top-fieldset"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'curriculum.nameTitle\' | translate}}</legend> <div layout="column"> <md-input-container> <label>{{\'curriculum.nameEt\' | translate}}</label> <input ng-model="curriculum.nameEt" type="text" required md-maxlength="255" ng-readonly="formState.readOnly || formState.notEditableBasicData"> </md-input-container> <md-input-container> <label>{{\'curriculum.nameEn\' | translate}}</label> <input ng-model="curriculum.nameEn" type="text" required md-maxlength="255" ng-readonly="formState.readOnly"> </md-input-container> <md-input-container> <label>{{\'curriculum.nameGenitiveEt\' | translate}}</label> <input ng-model="curriculum.nameGenitiveEt" type="text" required md-maxlength="255" ng-readonly="formState.readOnly"> </md-input-container> <md-input-container> <label>{{\'curriculum.nameGenitiveEn\' | translate}}</label> <input ng-model="curriculum.nameGenitiveEn" type="text" required md-maxlength="255" ng-readonly="formState.readOnly"> </md-input-container> </div> </fieldset> <fieldset tabindex="2" flex="66" flex-offset="4" flex-sm="100" flex-xs="100" flex-offset-xs="0" flex-offset-sm="0"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'curriculum.mainData\' | translate}}</legend> <div layout="row" flex> <div flex="45"> <md-checkbox ng-model="curriculum.joint" aria-label="{{\'curriculum.isJoint\' | translate}}" class="md-primary" ng-disabled="formState.readOnly || formState.notEditableBasicData || formState.jointDisabled"> {{\'curriculum.isJoint\' | translate}} </md-checkbox> </div> <md-input-container flex="50" flex-offset="5"> <label>{{\'curriculum.code\' | translate}}</label> <input ng-model="curriculum.code" name="code" type="text" required md-maxlength="25" ng-model-options="{ debounce: 250 }" unique="codeUniqueQuery" ng-readonly="formState.readOnly || formState.notEditableBasicData"> <div ng-messages="higherCurriculumForm.code.$error" ng-show="higherCurriculumForm.code.$dirty"> <div ng-message="notUnique"> {{\'main.messages.error.mustBeUnique\' | translate}} </div> </div> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="45"> <label>{{\'curriculum.studyLevel\' | translate}}</label> <hois-classifier-select ng-model="curriculum.origStudyLevel" main-classifier-code="OPPEASTE" show-only-values="studyLevels" required model-value-attr="code" ng-disabled="formState.readOnly || formState.notEditableBasicData"></hois-classifier-select> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label>{{\'curriculum.merCode\' | translate}}</label> <input ng-model="curriculum.merCode" name="merCode" type="text" md-maxlength="10" ng-model-options="{ debounce: 250 }" unique="merCodeUniqueQuery" ng-readonly="formState.readOnly || formState.notEditableBasicData"> <div ng-messages="higherCurriculumForm.merCode.$error" ng-show="higherCurriculumForm.merCode.$dirty"> <div ng-message="notUnique"> {{\'main.messages.error.mustBeUnique\' | translate}} </div> </div> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="45"> <label>{{\'curriculum.ekrLevel\' | translate}}</label> <hois-classifier-select ng-model="ekrLevel" main-classifier-code="EKR" watch-model="curriculum.origStudyLevel" filter-values connect-main-classifier-code="EKR" select-first-value disabled></hois-classifier-select> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label>{{\'curriculum.creditsEap\' | translate}}</label> <input ng-model="curriculum.credits" type="number" required min="0" max="999" pattern="^\\d+(\\.\\d{1})?$" name="credits" ng-readonly="formState.readOnly || formState.notEditableBasicData"> <div ng-messages="higherCurriculumForm.credits.$error" ng-show="higherCurriculumForm.credits.$dirty"> <div ng-message="min"> {{\'main.messages.error.positive\' | translate}} </div> <div ng-message="max"> {{\'curriculum.error.max999\' | translate}} </div> <div ng-message="pattern"> {{\'stateCurriculum.error.decimalPresision\' | translate}} </div> </div> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="45"> <label>{{\'curriculum.educationLevel\' | translate}}</label> <hois-classifier-select ng-model="educationLevel" main-classifier-code="HARIDUSTASE" watch-model="curriculum.origStudyLevel" filter-values connect-main-classifier-code="HARIDUSTASE" select-first-value disabled></hois-classifier-select> </md-input-container> <md-input-container flex="25" flex-offset="5"> <input ng-model="curriculum.studyPeriodYears" type="number" name="studyPeriodYears" placeholder="{{\'curriculum.studyPeriod\' | translate}} {{\'main.years\' | translate}}" required min="0" max="{{maxStydyYears.max}}" pattern="^\\d+$" ng-readonly="formState.readOnly || formState.notEditableBasicData"> <div ng-messages="higherCurriculumForm.studyPeriodYears.$error" ng-show="higherCurriculumForm.studyPeriodYears.$dirty"> <div ng-message="min"> {{\'main.messages.error.positive\' | translate}} </div> <div ng-message="max"> {{\'curriculum.error.max\' | translate:maxStydyYears }} </div> <div ng-message="pattern"> {{\'stateCurriculum.enter.credits.integer\' | translate}} </div> </div> </md-input-container> <md-input-container flex="20" flex-offset="5"> <input ng-model="curriculum.studyPeriodMonths" type="number" name="studyPeriodMonths" placeholder="{{\'main.months\' | translate}}" min="0" max="11" pattern="^\\d+$" ng-readonly="formState.readOnly || formState.notEditableBasicData"> <div ng-messages="higherCurriculumForm.studyPeriodMonths.$error" ng-show="higherCurriculumForm.studyPeriodMonths.$dirty"> <div ng-message="min"> {{\'main.messages.error.positive\' | translate}} </div> <div ng-message="max"> {{\'curriculum.error.monthsMax11\' | translate}} </div> <div ng-message="pattern"> {{\'stateCurriculum.enter.credits.integer\' | translate}} </div> </div> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="45"> <label>{{\'curriculum.curriculumGroup\' | translate}}</label> <hois-classifier-select ng-model="curriculum.group" required main-classifier-code="OPPEKAVAGRUPP" ng-change="getAreasOfStudy(true)" model-value-attr="code" ng-disabled="formState.readOnly || formState.notEditableBasicData"></hois-classifier-select> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label>{{\'curriculum.studyLanguage\' | translate}}</label> <hois-classifier-select multiple ng-model="curriculum.studyLanguages" required ignore-preselected only-valid main-classifier-code="OPPEKEEL" model-value-attr="code" criteria="{higher: true}" ng-disabled="formState.readOnly"></hois-classifier-select> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="45"> <label>{{\'curriculum.group\' | translate}}</label> <hois-classifier-select ng-model="curriculum.iscedClass" required model-value-attr="code" main-classifier-code="ISCED_RYHM" criteria="{higher: true}" watch-model="curriculum.group" filter-values search-from-connect connect-main-classifier-code="OPPEKAVAGRUPP"></hois-classifier-select> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label>{{\'curriculum.languageDescription\' | translate}}</label> <textarea ng-model="curriculum.languageDescription" md-maxlength="1000" max-rows="10" ng-readonly="formState.readOnly"></textarea> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="45"> <label>{{\'curriculum.areaOfStudy\' | translate}}</label> <hois-classifier-select ng-model="curriculum.areaOfStudy" main-classifier-code="ISCED_VALD" watch-model="curriculum.fieldOfStudy" model-value-attr="code" select-first-value connect-main-classifier-code="ISCED_VALD" criteria="{higher: true}" disabled></hois-classifier-select> </md-input-container> <!-- hois-school-department-select was not used here as it set form $dirty after page load.\r\n          In addition, extra logic in providing options required --> <md-input-container flex="50" flex-offset="5"> <label> {{\'curriculum.structuralUnitResponsible\' | translate}} </label> <hois-select ng-model="curriculum.schoolDepartments" multiple values="schoolDepartments" required ng-disabled="formState.readOnly"></hois-select> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="45"> <label>{{\'curriculum.fieldOfStudy\' | translate}}</label> <hois-classifier-select ng-model="curriculum.fieldOfStudy" main-classifier-code="ISCED_SUUN" watch-model="curriculum.iscedClass" filter-values select-first-value connect-main-classifier-code="ISCED_SUUN" criteria="{higher: true}" disabled model-value-attr="code"></hois-classifier-select> </md-input-container> </div> </fieldset> </div> <div>&nbsp;</div> <fieldset tabindex="4"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'curriculum.commonData\' | translate}}</legend> <div layout="column"> <md-input-container flex> <label>{{\'stateCurriculum.enter.objectivesEt\' | translate}}{{getStar()}}</label> <textarea ng-model="curriculum.objectivesEt" ng-required="strictValidation()" md-maxlength="20000" max-rows="10" ng-readonly="formState.readOnly"></textarea> </md-input-container> <md-input-container flex> <label>{{\'stateCurriculum.enter.objectivesEn\' | translate}}{{getStar()}}</label> <textarea ng-model="curriculum.objectivesEn" ng-required="strictValidation()" md-maxlength="20000" max-rows="10" ng-readonly="formState.readOnly"></textarea> </md-input-container> <md-input-container flex> <label>{{\'curriculum.studyOutcomesEt\' | translate}}{{getStar()}}</label> <textarea ng-model="curriculum.outcomesEt" ng-required="strictValidation()" md-maxlength="20000" max-rows="10" ng-readonly="formState.readOnly"></textarea> </md-input-container> <md-input-container flex> <label>{{\'curriculum.studyOutcomesEn\' | translate}}{{getStar()}}</label> <textarea ng-model="curriculum.outcomesEn" ng-required="strictValidation()" md-maxlength="20000" max-rows="10" ng-readonly="formState.readOnly"></textarea> </md-input-container> <md-input-container flex> <label>{{\'curriculum.higherAdmissionRequirementsEt\' | translate}}{{getStar()}}</label> <textarea ng-model="curriculum.admissionRequirementsEt" ng-required="strictValidation()" md-maxlength="20000" max-rows="10" ng-readonly="formState.readOnly"></textarea> </md-input-container> <md-input-container flex> <label>{{\'curriculum.higherAdmissionRequirementsEn\' | translate}}{{getStar()}}</label> <textarea ng-model="curriculum.admissionRequirementsEn" ng-required="strictValidation()" md-maxlength="20000" max-rows="10" ng-readonly="formState.readOnly"></textarea> </md-input-container> <md-input-container flex> <label>{{\'curriculum.higherGraduationRequirementsEt\' | translate}}{{getStar()}}</label> <textarea ng-model="curriculum.graduationRequirementsEt" ng-required="strictValidation()" md-maxlength="20000" max-rows="10" ng-readonly="formState.readOnly"></textarea> </md-input-container> <md-input-container flex> <label>{{\'curriculum.higherGraduationRequirementsEn\' | translate}}{{getStar()}}</label> <textarea ng-model="curriculum.graduationRequirementsEn" ng-required="strictValidation()" md-maxlength="20000" max-rows="10" ng-readonly="formState.readOnly"></textarea> </md-input-container> <md-input-container flex> <label>{{\'curriculum.optionalStudyDescription\' | translate}}</label> <textarea ng-model="curriculum.optionalStudyDescription" md-maxlength="4000" max-rows="10" ng-readonly="formState.readOnly"></textarea> </md-input-container> <md-input-container flex> <label>{{\'curriculum.addInfo\' | translate}}</label> <textarea ng-model="curriculum.addInfo" md-maxlength="20000" max-rows="10" ng-readonly="formState.readOnly"></textarea> </md-input-container> <md-input-container flex> <label>{{\'stateCurriculum.enter.comment\' | translate}}</label> <textarea ng-model="curriculum.description" md-maxlength="20000" max-rows="10" ng-readonly="formState.readOnly"></textarea> </md-input-container> <md-input-container flex> <label>{{\'curriculum.otherLanguages\' | translate}}</label> <textarea ng-model="curriculum.otherLanguages" md-maxlength="1000" max-rows="10" ng-readonly="formState.readOnly"></textarea> </md-input-container> <md-autocomplete name="teacher" md-selected-item="curriculum.teacher" md-search-text="teacherName" md-items="teacher in searchTeacher(teacherName)" md-item-text="currentLanguageNameField(teacher)" md-min-length="1" md-floating-label="{{\'curriculum.supervisor\' | translate}}" md-no-cache class="small-margin" md-require-match flex> <md-item-template> <span md-highlight-text="teacherName" md-highlight-flags="^i">{{currentLanguageNameField(teacher)}}</span> </md-item-template> <md-not-found> {{\'main.messages.error.notFound\' | translate}} </md-not-found> </md-autocomplete> </div> </fieldset> <div>&nbsp;</div> <fieldset tabindex="9"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'curriculum.approvalInfo\' | translate}}</legend> <md-table-container> <div layout="row" flex="100" layout-xs="column"> <md-input-container flex="30" flex-sm="100" flex-xs="100"> <label>{{\'curriculum.approvalDocumentNr\' | translate}}{{getStar()}}</label> <input ng-model="curriculum.approvalDokNr" type="text" md-maxlength="50" ng-readonly="formState.readOnly" ng-required="strictValidation()"> </md-input-container> <md-input-container flex="20" flex-offset="4" flex-xs="100" flex-offset-xs="0"> <label>{{\'curriculum.approvalDate\' | translate}}{{getStar()}}</label> <md-datepicker ng-model="curriculum.approval" md-open-on-focus ng-disabled="formState.readOnly" ng-required="strictValidation()"></md-datepicker> </md-input-container> <md-input-container flex="20" flex-offset="5" flex-xs="100" flex-offset-xs="0"> <label>{{\'curriculum.htmRegisterDate\' | translate}}</label> <md-datepicker ng-model="curriculum.merRegDate" md-open-on-focus ng-disabled="formState.readOnly"></md-datepicker> </md-input-container> </div> <div layout="row" flex="100" layout-xs="column"> <md-input-container flex="30" flex-sm="100" flex-xs="100"> <label>{{\'curriculum.accreditationDesision\' | translate}}</label> <input ng-model="curriculum.accreditationResolution" type="text" md-maxlength="1000" ng-readonly="formState.readOnly"> </md-input-container> <md-input-container flex="20" flex-offset="4" flex-xs="100" flex-offset-xs="0"> <label>{{\'curriculum.accreditationDate\' | translate}}</label> <md-datepicker ng-model="curriculum.accreditationDate" md-open-on-focus ng-disabled="formState.readOnly"></md-datepicker> </md-input-container> </div> <div layout="row" flex="100" layout-xs="column"> <md-input-container flex="30" flex-sm="100" flex-xs="100"> <label>{{\'curriculum.accreditationDesisionNumber\' | translate}}</label> <input ng-model="curriculum.accreditationNr" type="text" md-maxlength="1000" ng-readonly="formState.readOnly"> </md-input-container> <md-input-container flex="20" flex-offset="4" flex-xs="100" flex-offset-xs="0"> <label>{{\'curriculum.accreditationValidityDate\' | translate}}</label> <md-datepicker ng-model="curriculum.accreditationValidDate" md-open-on-focus ng-disabled="formState.readOnly"></md-datepicker> </md-input-container> </div> </md-table-container> </fieldset> <div>&nbsp;</div> <fieldset tabindex="10"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'curriculum.diplomaInfo\' | translate}}</legend> <div layout="column"> <md-input-container flex> <label>{{\'curriculum.final31\' | translate}}</label> <input ng-model="curriculum.final31" type="text" md-maxlength="255" ng-readonly="formState.readOnly"> </md-input-container> <md-input-container flex> <label>{{\'curriculum.final33\' | translate}}</label> <input ng-model="curriculum.final33" type="text" md-maxlength="255" ng-readonly="formState.readOnly"> </md-input-container> <md-input-container flex> <label>{{\'curriculum.final51\' | translate}}</label> <input ng-model="curriculum.final51" type="text" md-maxlength="255" ng-readonly="formState.readOnly"> </md-input-container> <md-input-container flex> <label>{{\'curriculum.final52\' | translate}}</label> <input ng-model="curriculum.final52" type="text" md-maxlength="255" ng-readonly="formState.readOnly"> </md-input-container> <md-input-container flex> <label>{{\'curriculum.final61\' | translate}}</label> <input ng-model="curriculum.final61" type="text" md-maxlength="255" ng-readonly="formState.readOnly"> </md-input-container> <br> <md-input-container flex> <label>{{\'curriculum.finalEn31\' | translate}}</label> <input ng-model="curriculum.finalEn31" type="text" md-maxlength="255" ng-readonly="formState.readOnly"> </md-input-container> <md-input-container flex> <label>{{\'curriculum.finalEn33\' | translate}}</label> <input ng-model="curriculum.finalEn33" type="text" md-maxlength="255" ng-readonly="formState.readOnly"> </md-input-container> <md-input-container flex> <label>{{\'curriculum.finalEn51\' | translate}}</label> <input ng-model="curriculum.finalEn51" type="text" md-maxlength="255" ng-readonly="formState.readOnly"> </md-input-container> <md-input-container flex> <label>{{\'curriculum.finalEn52\' | translate}}</label> <input ng-model="curriculum.finalEn52" type="text" md-maxlength="255" ng-readonly="formState.readOnly"> </md-input-container> <md-input-container flex> <label>{{\'curriculum.finalEn61\' | translate}}</label> <input ng-model="curriculum.finalEn61" type="text" md-maxlength="255" ng-readonly="formState.readOnly"> </md-input-container> </div> </fieldset> <div>&nbsp;</div> <div>&nbsp;</div> <fieldset tabindex="11"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'curriculum.statuses\' | translate}}</legend> <div layout="row" flex="100"> <md-input-container flex="30" flex-sm="100" flex-xs="100"> <label>{{\'main.validFrom\' | translate}}{{getStar()}}</label> <md-datepicker ng-model="curriculum.validFrom" md-open-on-focus ng-required="strictValidation()" ng-disabled="formState.readOnly"></md-datepicker> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-xs="100" flex-offset-xs="0" flex-offset-sm="0" flex-offset="4"> <label>{{\'main.validTo\' | translate}}</label> <md-datepicker ng-model="curriculum.validThru" md-min-date="curriculum.validFrom" md-open-on-focus ng-disabled="formState.readOnly"></md-datepicker> </md-input-container> </div> <div layout="row" flex="100" class="top-margin form-readonly"> <md-input-container flex="30" flex-sm="100" flex-xs="100" class="readonly"> <label class="label">{{\'main.status\' | translate}}</label> <hois-classifier-value ng-model="curriculum.status" main-classifier-code="OPPEKAVA_STAATUS"></hois-classifier-value> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-xs="100" flex-offset-xs="0" flex-offset-sm="0" flex-offset="4"> <label>{{\'curriculum.statusInEhis\' | translate}}</label> <hois-classifier-value ng-model="curriculum.ehisStatus" main-classifier-code="OPPEKAVA_EHIS_STAATUS"></hois-classifier-value> </md-input-container> <md-input-container flex="40" flex-sm="100" flex-xs="100" flex-offset-xs="0" flex-offset-sm="0" flex-offset="5"> <label>{{\'curriculum.statusChangedDateInEhis\' | translate}}</label> <hois-value value="curriculum.ehisChanged | hoisDate"></hois-value> </md-input-container> </div> </fieldset> <div ng-show="curriculum.joint">&nbsp;</div> <fieldset tabindex="8" ng-show="curriculum.joint"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'curriculum.jointInfo\' | translate}}</legend> <div layout="column"> <div layout="row" layout-align="start start" ng-show="curriculum.joint"> <label class="md-required common-label" flex="30">{{\'curriculum.jointSchool\' | translate}}</label> <md-radio-group ng-model="curriculum.abroad" flex="50" layout="row" class="align-center" ng-change="clearJointPartnersFields()" flex-offset-xs="0" flex-offset-sm="0" flex-offset="4" ng-disabled="formState.readOnly || formState.notEditableBasicData"> <md-radio-button ng-value="false" aria-label="{{ \'curriculum.estonianEducationalInstitute\' | translate }}"> {{ \'curriculum.estonianEducationalInstitute\' | translate }} </md-radio-button> <md-radio-button ng-value="true" aria-label="{{ \'curriculum.jointPartnerAbroadSchool\' | translate }}"> {{ \'curriculum.foreignEducationalInstitute\' | translate }} </md-radio-button> </md-radio-group> </div> <div layout="row" flex="100" ng-show="curriculum.joint"> <md-input-container flex="64" ng-hide="curriculum.abroad"> <label>{{\'curriculum.estonianEducationalInstitute\' | translate}}&nbsp;*</label> <hois-classifier-select ng-model="curriculum.jointPartnerEhisSchool" main-classifier-code="EHIS_KOOL" filter-values="curriculum.jointPartners" by-property="ehisSchool" model-value-attr="code" ng-disabled="formState.readOnly || formState.notEditableBasicData"></hois-classifier-select> </md-input-container> <md-input-container ng-hide="!curriculum.abroad" flex="30"> <label>{{\'school.name\' | translate}}&nbsp;*</label> <input ng-model="curriculum.jointPartnerForeignNameEt" type="text" md-maxlength="100" ng-readonly="formState.readOnly"> </md-input-container> <md-input-container ng-hide="!curriculum.abroad" flex="30" flex-offset-xs="0" flex-offset-sm="0" flex-offset="4"> <label>{{\'school.nameEn\' | translate}}&nbsp;*</label> <input ng-model="curriculum.jointPartnerForeignNameEn" type="text" md-maxlength="100" ng-readonly="formState.readOnly"> </md-input-container> <md-button class="md-raised" ng-click="addJointPartner()" ng-disabled="(!curriculum.jointPartnerForeignNameEt || !curriculum.jointPartnerForeignNameEn) && !curriculum.jointPartnerEhisSchool">{{\'main.button.add\' | translate}}</md-button> </div> <span class="invalid" ng-show="higherCurriculumForm.$submitted && strictValidation() && (!curriculum.jointPartners || curriculum.jointPartners.length === 0)"> {{\'main.messages.error.atLeastOneShouldBeAdded\' | translate}} </span> <div layout="column" flex ng-show="curriculum.joint" class="common-label"> <div layout="row" ng-repeat="item in curriculum.jointPartners | filter: filterEmptyJointPartners | orderBy: [\'ehisSchool\', \'nameEt\']" class="align-center"> <div flex="5">&nbsp;</div> <div ng-if="item.abroad">{{currentLanguageNameField(item)}}</div> <div ng-if="!item.abroad"> <hois-classifier-value ng-model="item.ehisSchool" main-classifier-code="EHIS_KOOL"></hois-classifier-value></div> <div flex="5">&nbsp;</div> <div flex="5"><a class="remove nomargin" ng-click="removejointPartner(item)" ng-if="!formState.readOnly && !formState.notEditableBasicData && !item.hasSubjects">&times;</a></div> </div> </div> <div layout="row" layout-sm="column" layout-xs="column" ng-show="curriculum.joint"> <md-input-container flex="30" ng-if="curriculum.joint"> <label>{{\'curriculum.jointMentor\' | translate}}{{getStar()}}</label> <hois-classifier-select ng-model="curriculum.jointMentor" main-classifier-code="EHIS_KOOL" model-value-attr="code" show-only-values="jointPartnersEhisSchools" ng-required="strictValidation()" ng-disabled="formState.readOnly || formState.notEditableBasicData"></hois-classifier-select> </md-input-container> <md-input-container flex="66" flex-offset="4"> <label>{{\'curriculum.jointResponsible\' | translate}}</label> <input ng-model="curriculum.supervisor" type="text" md-maxlength="100" ng-readonly="formState.readOnly || formState.notEditableBasicData"> </md-input-container> </div> <md-input-container flex="100"> <label>{{\'curriculum.jointAgreementInfoEt\' | translate}}{{getStar()}}</label> <textarea ng-model="curriculum.contractEt" md-maxlength="1000" max-rows="10" ng-required="curriculum.joint && strictValidation()" ng-readonly="formState.readOnly || formState.notEditableBasicData"></textarea> </md-input-container> <md-input-container flex="100"> <label>{{\'curriculum.jointAgreementInfoEn\' | translate}}{{getStar()}}</label> <textarea ng-model="curriculum.contractEn" md-maxlength="1000" max-rows="10" ng-required="curriculum.joint && strictValidation()" ng-readonly="formState.readOnly || formState.notEditableBasicData"></textarea> </md-input-container> </div> </fieldset> <div>&nbsp;</div> <fieldset tabindex="9"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'curriculum.address\' | translate}}</legend> <div layout="column"> <div layout="row"> <div flex> <hois-ads-adapter class="md-text" ng-model="formState.address.addressAds" ads-oid-model="formState.address.addressOid" address-model="formState.address.address" ov-model="formState.address.addressOv"></hois-ads-adapter> </div> <md-button class="md-raised" ng-click="addAddress()" ng-disabled="!formState.address.addressOv">{{\'main.button.add\' | translate}}</md-button> </div> <input ng-if="strictValidation()" style="display:none" type="number" readonly name="addressesLength" ng-model="validation.addressesLength" min="1"> <div md-colors="{color: \'warn-A400\'}" ng-messages="higherCurriculumForm.addressesLength.$error"> <div ng-if="higherCurriculumForm.$submitted" ng-message="min">{{\'main.messages.error.atLeastOneShouldBeAdded\' | translate}}</div> </div> <div layout="column" flex class="common-label"> <div layout="row" ng-repeat="item in curriculum.addresses | orderBy: \'address\'" class="align-center"> <div flex="5">&nbsp;</div> <div>{{::item.address}}</div> <div flex="5">&nbsp;</div> <div flex="5"><a class="remove nomargin" ng-click="removeAddress(item)">&times;</a></div> </div> </div> </div> </fieldset> <div>&nbsp;</div> <fieldset tabindex="12"> <legend md-colors="{color: \'primary-800\'}" ng-class="{invalid: strictValidation() && (!curriculum.specialities || curriculum.specialities.length === 0)}" class="md-title-small">{{\'curriculum.specialty.label\' | translate}} *</legend> <md-button class="md-raised" ng-click="openAddSpecialtyDialog()" ng-show="!formState.readOnly">{{\'curriculum.specialty.add\' | translate}}</md-button> <div ng-repeat="item in curriculum.specialities | orderBy: currentLanguageNameField()" layout="column"> <div layout="row" class="occupation-row align-center" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <div flex="35"><a ng-click="openAddSpecialtyDialog(item)" href="">{{currentLanguageNameField(item)}}</a></div> </div> </div> </fieldset> <div>&nbsp;</div> <fieldset tabindex="12" ng-show="gradeRequired()"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'curriculum.grade.label\' | translate}}</legend> <md-button class="md-raised" ng-click="openAddGradeDialog()" ng-show="!formState.readOnly">{{\'curriculum.grade.add\' | translate}}</md-button> <md-table-container> <div ng-repeat="item in curriculum.grades | orderBy: currentLanguageNameField()" layout="column" ng-show="gradeRequired()"> <div layout="row" class="occupation-row align-center" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <div flex="35"><a ng-click="openAddGradeDialog(item)" href="">{{currentLanguageNameField(item)}}</a></div> </div> </div> </md-table-container> </fieldset> <div ng-if="curriculum.id">&nbsp;</div> <fieldset tabindex="11" ng-if="curriculum.id"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small" ng-class="{invalid: higherCurriculumForm.$submitted && strictValidation() && !hasRequiredFiles()}">{{\'main.relatedFiles\' | translate}}</legend> <md-button class="md-raised" ng-click="openAddFileDialog()" ng-show="!formState.readOnly">{{\'main.button.uploadFile\' | translate}}</md-button> <md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column><span>{{\'file.nameAndFile\' | translate}}</span></th> <th md-column><span>{{\'file.creationLocation\' | translate}}</span></th> <th md-column>{{\'file.type\' | translate}}</th> <th md-column>{{\'curriculum.sendToEhis\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="file in curriculum.files | orderBy: \'oisFile.fname\'" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell> {{file.oisFile.fname}} <a ng-href="{{getUrl(file, \'curriculum\')}}" download><md-icon md-font-set="material-icons">file_download</md-icon></a> </td> <td md-cell> {{file.ehis ? \'EHIS\' : \'ÕIS\'}} </td> <td md-cell> <hois-classifier-value ng-model="file.ehisFile" main-classifier-code="EHIS_FAIL"></hois-classifier-value> </td> <td md-cell> <md-checkbox ng-model="file.sendEhis" aria-label="send to ehis" ng-disabled="formState.readOnly"></md-checkbox> </td> <td md-cell> <md-button class="remove nomargin" ng-click="deleteFile(file)" ng-if="!formState.readOnly">&times;</md-button> </td> </tr> </tbody> </table> </md-table-container> </fieldset> <div ng-if="curriculum.id">&nbsp;</div> <fieldset tabindex="12" ng-if="curriculum.id"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small"><span ng-class="{invalid: higherCurriculumForm.$submitted && strictValidation() && !hasVerifiedVersions()}">{{\'curriculum.versions\' | translate}}</span></legend> <md-button class="md-raised" ng-click="goToVersionNewForm(version)" ng-show="versionCanBeAdded()">{{\'main.button.create\' | translate}}</md-button> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column><span>{{\'curriculum.versionName\' | translate}}</span></th> <th md-column><span>{{\'main.status\' | translate}}</span></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="version in curriculum.versions | orderBy: \'code\'" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell> <a ng-click="goToVersionForm(version)" href="">{{version.code}}</a> </td> <td md-cell><hois-classifier-value ng-model="version.status" main-classifier-code="OPPEKAVA_VERSIOON_STAATUS"></hois-classifier-value></td> </tr> </tbody> </table> </fieldset> <hois-created-modified object="curriculum" class="top-margin"></hois-created-modified> <div layout="row"> <div flex layout-xs="column"> <span ng-show="curriculum.status === STATUS.ENTERING"> <span ng-show="!curriculum.id" layout-xs="column"> <md-button class="md-raised md-primary" ng-click="save()">{{\'main.button.save\' | translate}}</md-button> </span> <span ng-show="curriculum.id && !formState.readOnly" layout-xs="column"> <md-button class="md-raised md-primary" ng-click="save()" ng-if="curriculum.canChange">{{\'main.button.save\' | translate}}</md-button> <md-button class="md-raised" ng-click="saveAndProceed()" ng-if="curriculum.canChange && curriculum.canConfirm">{{\'main.button.status.approving\' | translate}}</md-button> <md-button class="md-raised" ng-click="setStatusClosed()" ng-if="curriculum.canChange && curriculum.canClose">{{\'main.button.status.close\' | translate}}</md-button> <md-button class="md-raised md-default" ng-click="delete()" ng-if="curriculum.canDelete">{{\'main.button.delete\' | translate}}</md-button> </span> <span ng-show="curriculum.id && formState.readOnly" layout-xs="column"> <md-button class="md-raised md-primary" ng-click="goToEditForm()" ng-if="curriculum.canChange">{{\'main.button.change\' | translate}}</md-button> </span> </span> <span ng-show="curriculum.status === STATUS.PROCEEDING && !formState.sentToEhis"> <span ng-show="!formState.readOnly" layout-xs="column"> <md-button class="md-raised md-primary" ng-click="save()" ng-if="curriculum.canChange">{{\'main.button.save\' | translate}}</md-button> <md-button class="md-raised md-default" ng-click="changeStatusUnderRevision()" ng-if="curriculum.canSetUnderRevision">{{\'curriculum.button.changeStatusUnderRevision\' | translate}}</md-button> <md-button class="md-raised md-default" ng-click="delete()" ng-if="curriculum.canDelete">{{\'main.button.delete\' | translate}}</md-button> </span> <span ng-show="formState.readOnly" layout-xs="column"> <md-button class="md-raised md-primary" ng-click="goToEditForm()" ng-if="curriculum.canChange">{{\'main.button.change\' | translate}}</md-button> <md-button class="md-raised md-default" ng-click="changeStatusUnderRevision()" ng-if="curriculum.canSetUnderRevision">{{\'curriculum.button.changeStatusUnderRevision\' | translate}}</md-button> <md-button class="md-raised md-default" ng-click="sendToEhis(true)" ng-if="curriculum.canConfirm">{{\'curriculum.button.sendToEhisTest\' | translate}}</md-button> <md-button class="md-raised md-default" ng-click="sendToEhis(false)" ng-if="curriculum.canConfirm">{{\'curriculum.button.sendToEhis\' | translate}}</md-button> <md-button class="md-raised" ng-click="setStatusClosed()" ng-if="curriculum.canClose">{{\'main.button.status.close\' | translate}}</md-button> </span> </span> <span ng-show="curriculum.status === STATUS.PROCEEDING && formState.sentToEhis" layout-xs="column"> <md-button class="md-raised md-default" ng-click="changeStatusUnderRevision()" ng-if="curriculum.canSetUnderRevision">{{\'curriculum.button.changeStatusUnderRevision\' | translate}}</md-button> <md-button class="md-raised md-default" ng-click="updateFromEhis(true)" ng-if="curriculum.canConfirm">{{\'curriculum.button.updateFromEhisTest\' | translate}}</md-button> <md-button class="md-raised md-default" ng-click="updateFromEhis(false)" ng-if="curriculum.canConfirm">{{\'curriculum.button.updateFromEhis\' | translate}}</md-button> </span> <span ng-show="curriculum.status === STATUS.VERIFIED"> <span ng-show="!formState.readOnly" layout-xs="column"> <md-button class="md-raised md-primary" ng-click="save()" ng-if="curriculum.canChange">{{\'main.button.save\' | translate}}</md-button> <md-button class="md-raised md-default" ng-click="changeStatusUnderRevision()" ng-if="curriculum.canSetUnderRevision">{{\'curriculum.button.changeStatusUnderRevision\' | translate}}</md-button> </span> <span ng-show="formState.readOnly" layout-xs="column"> <md-button class="md-raised md-primary" ng-click="goToEditForm()" ng-if="curriculum.canChange">{{\'main.button.change\' | translate}}</md-button> <md-button class="md-raised md-default" ng-click="changeStatusUnderRevision()" ng-if="curriculum.canSetUnderRevision">{{\'curriculum.button.changeStatusUnderRevision\' | translate}}</md-button> <md-button class="md-raised" ng-click="setStatusClosed()" ng-if="curriculum.canClose">{{\'main.button.status.close\' | translate}}</md-button> </span> </span> <a ng-show="curriculum.id && (auth.isAdmin() || curriculum.status === STATUS.VERIFIED)" href="{{formState.curriculumXmlUrl}}" target="_blank" class="md-button md-raised">XML</a> <md-button class="md-raised md-default" ng-click="back(\'#/curriculum\', higherCurriculumForm)">{{\'main.button.back\' | translate}}</md-button> </div> </div> </form> </div> <style>.occupation-row {\r\n	min-height:38px;\r\n}</style>'),
a.put("higherCurriculum/higher.curriculum.specialty.add.dialog.html",'<md-dialog aria-label="specialty add dialog" flex="30" flex-xs="100"> <form name="dialogForm" ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2>{{"curriculum.specialty.editLabel" | translate}}</h2> <span flex></span> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <span flex></span> <div class="ois-form-layout" layout="column" layout-margin ng-cloak> <div layout="column"> <md-input-container> <label>{{\'curriculum.specialty.nameEt\' | translate}}</label> <input ng-model="data.nameEt" type="text" required md-maxlength="100"> </md-input-container> <md-input-container> <label>{{\'curriculum.specialty.nameEn\' | translate}}</label> <input ng-model="data.nameEn" type="text" required md-maxlength="100"> </md-input-container> <md-input-container> <label>{{\'curriculum.specialty.credits\' | translate}}</label> <input name="credits" ng-model="data.credits" type="number" required min="0" max="{{maxCredits}}" pattern="^\\d+(\\.\\d{1})?$"> <div ng-messages="dialogForm.credits.$error" ng-show="dialogForm.credits.$dirty"> <div ng-message="min"> {{\'main.messages.error.positive\' | translate}} </div> <div ng-message="max"> {{\'curriculum.specialty.creditsError\' | translate}} ({{maxCredits}} EAP) </div> <div ng-message="pattern"> {{\'stateCurriculum.error.decimalPresision\' | translate}} </div> </div> </md-input-container> <md-input-container> <label>{{\'main.additionalInfo\' | translate}}</label> <textarea ng-model="data.description" md-maxlength="1000" max-rows="10"></textarea> </md-input-container> <md-input-container> <label>{{\'occupation.givenOccupation\' | translate}}</label> <hois-classifier-select ng-model="data.occupation" ng-change="occupationSelected()" main-classifier-code="KUTSE" model-value-attr="code" only-valid></hois-classifier-select> </md-input-container> <md-input-container ng-show="data.occupation"> <label>{{\'curriculum.specialty.specialtyReferenceEt\' | translate}}</label> <input ng-model="data.occupationEt" type="text" md-maxlength="255" ng-required="data.occupation"> </md-input-container> <md-input-container ng-show="data.occupation"> <label>{{\'curriculum.specialty.specialtyReferenceEn\' | translate}}</label> <input ng-model="data.occupationEn" type="text" md-maxlength="255" ng-required="data.occupation"> </md-input-container> </div> </div> </md-dialog-content> <md-dialog-actions layout="row" layout-align="start center"> <md-button class="md-raised md-primary" ng-click="submit()">{{"main.button.save" | translate}}</md-button> <md-button class="md-raised" ng-click="delete()" ng-if="!formState.isNew">{{"main.button.delete" | translate}}</md-button> <md-button class="md-raised" ng-click="cancel()">{{"main.button.close" | translate}}</md-button> </md-dialog-actions> </form> </md-dialog>'),a.put("higherCurriculum/higher.curriculum.specialty.view.dialog.html",'<md-dialog aria-label="specialty add dialog" flex="30" flex-xs="100"> <form name="dialogForm" ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2>{{"curriculum.specialty.viewLabel" | translate}}</h2> <span flex></span> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <span flex></span> <div class="ois-form-layout" layout="column" layout-margin ng-cloak> <div layout="column"> <md-input-container flex> <label>{{\'curriculum.specialty.nameEt\' | translate}}</label> <input ng-model="data.nameEt" type="text" readonly> </md-input-container> <md-input-container flex> <label>{{\'curriculum.specialty.nameEn\' | translate}}</label> <input ng-model="data.nameEn" type="text" readonly> </md-input-container> <md-input-container flex> <label>{{\'curriculum.specialty.credits\' | translate}}</label> <input name="credits" ng-model="data.credits" type="number" readonly> </md-input-container> <md-input-container flex> <label>{{\'main.additionalInfo\' | translate}}</label> <textarea ng-model="data.description" max-rows="10" readonly></textarea> </md-input-container> <md-input-container flex> <label>{{\'occupation.givenOccupation\' | translate}}</label> <hois-classifier-select ng-model="data.occupation" main-classifier-code="KUTSE" model-value-attr="code" disabled></hois-classifier-select> </md-input-container> <md-input-container flex ng-show="data.occupation"> <label>{{\'curriculum.specialty.specialtyReferenceEt\' | translate}}</label> <input ng-model="data.occupationEt" type="text" readonly> </md-input-container> <md-input-container flex ng-show="data.occupation"> <label>{{\'curriculum.specialty.specialtyReferenceEn\' | translate}}</label> <input ng-model="data.occupationEn" type="text" readonly> </md-input-container> </div> </div> </md-dialog-content> <md-dialog-actions layout="row" layout-align="start center"> <md-button class="md-raised" ng-click="cancel()">{{"main.button.close" | translate}}</md-button> </md-dialog-actions> </form> </md-dialog>'),a.put("higherCurriculum/higher.curriculum.version.html",'<div class="ois-form-layout-padding" ng-cloak ng-show="!showMainForm"> <form name="higherCurriculumVersionForm" layout="column" class="nomargin"> <fieldset tabindex="1"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'curriculum.versionMainData\' | translate}}</legend> <div layout="column"> <md-input-container flex ng-if="!showMainForm"> <label>{{\'curriculum.version.code\' | translate}}</label> <input name="code" ng-model="version.code" type="text" required md-maxlength="100" ng-model-options="{ debounce: 250 }" unique="curriculumVersionCodeUniqueQuery" ng-readonly="formState.readOnly"> <div ng-messages="higherCurriculumVersionForm.code.$error"> <div ng-message="notUnique"> {{\'main.messages.error.mustBeUnique\' | translate}} </div> </div> </md-input-container> <div layout="row" flex> <md-input-container flex="45"> <label>{{\'curriculum.version.firstAdmissionYear\' | translate}}</label> <md-select ng-model="version.admissionYear" required ng-disabled="formState.readOnly"> <md-option ng-repeat="year in ::admissionYears" ng-value="year" aria-label="{{year}}">{{year}}</md-option> </md-select> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label>{{\'curriculum.version.type\' | translate}}</label> <hois-classifier-select ng-model="version.type" main-classifier-code="OPPEKAVA_VERSIOON_LIIK" required model-value-attr="code" ng-disabled="formState.readOnly"></hois-classifier-select> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label>{{\'curriculum.specialty.specialties\' | translate}}</label> <md-select multiple ng-model="version.specialitiesReferenceNumbers" required ng-disabled="formState.readOnly"> <md-option ng-repeat="speciality in curriculum.specialities | orderBy: currentLanguageNameField()" ng-value="speciality.referenceNumber"> {{currentLanguageNameField(speciality)}} </md-option> </md-select> </md-input-container> <div flex="50" flex-offset="5" ng-show="!formState.readOnly" layout="start center"> <md-button class="md-raised" ng-click="openAddSpecialtyDialog()" ng-if="version.canChange">{{\'curriculum.specialty.addNew\' | translate}}</md-button> </div> </div> <br> </div> </fieldset> <div>&nbsp;</div> <fieldset tabindex="2" flex> <legend md-colors="{color: \'primary-800\'}" class="md-title-small" ng-class="{invalid: higherCurriculumVersionForm.$submitted && strictValidation() && !allSpecialitiesValid()}">{{\'module.modules\' | translate}}&nbsp;*</legend> <md-button class="md-raised" ng-click="openAddModuleDialog()" ng-if="!formState.readOnly && version.specialitiesReferenceNumbers.length > 0 && version.id && version.canChange">{{\'module.add\' | translate}}</md-button> <div ng-repeat="spectiality in curriculum.specialities | filter: filterSpecialities | orderBy: currentLanguageNameField()" flex> <h2 class="md-title-small" ng-class="{invalid: higherCurriculumVersionForm.$submitted && strictValidation() && !specialityValid(spectiality.id)}">{{\'curriculum.specialty.specialty\' | translate}} {{$index + 1}}: {{currentLanguageNameField(spectiality)}}</h2> <md-table-container> <table class="custom-table"> <thead class="secondary-table-header"> <th style="width: 35%">{{\'subject.name\' | translate}}</th> <th style="width: 20%">{{\'subject.code\' | translate}}</th> <th style="width: 10%">EAP</th> <th style="width: 10%">{{\'module.studyYear\' | translate}}</th> <th style="width: 10%"> <hois-classifier-value ng-value="\'OPPEPERIOOD_S\'" main-classifier-code="OPPEPERIOOD"></hois-classifier-value> </th> <th style="width: 10%"> <hois-classifier-value ng-value="\'OPPEPERIOOD_K\'" main-classifier-code="OPPEPERIOOD"></hois-classifier-value> </th> </thead> <tbody ng-repeat="module in version.modules | filter: {minorSpeciality: false} | filter: filterModulesBySpeciality(spectiality) | orderBy: currentLanguageNameField()"> <tr class="occupation-header"> <td colspan="6"> <a href="" ng-click="openAddModuleDialog(module)" flex="70"> {{\'curriculum.module\' | translate}} {{currentLanguageNameField(module)}} {{module.totalCredits}} EAP <span ng-if="module.type === \'KORGMOODUL_M\'">({{currentLanguage()==\'et\' ? module.typeNameEt : module.typeNameEn}})</span> <span ng-if="module.type !== \'KORGMOODUL_M\'">(<hois-classifier-value ng-model="module.type" main-classifier-code="KORGMOODUL" class="inline module-type"></hois-classifier-value>)</span> </a> </td> </tr> <tr class="sub-header1" ng-show="moduleMustHaveSubjects(module)"> <td colspan="6"> {{\'subject.mandatory\' | translate}} </td> </tr> <tr class="higher-curriculum-subject-row" ng-repeat="subject in module.subjects | filter: {optional: false} | orderBy: currentLanguageNameField()"> <td>{{currentLanguageNameField(subject)}}</td> <td>{{subject.code}}</td> <td>{{subject.credits}}</td> <td>{{subject.studyYearNumber}}</td> <td><md-checkbox ng-model="subject.autumn" aria-label="Autumn semester" disabled></md-checkbox></td> <td><md-checkbox ng-model="subject.spring" aria-label="Spring semester" disabled></md-checkbox></td> </tr> <tr class="secondary-table-header" ng-show="moduleMustHaveSubjects(module)"> <td>{{\'main.OF\' | translate}}</td> <td></td> <td>{{module.compulsoryStudyCredits}}</td> <td colspan="3"></td> </tr> <tr class="sub-header1" ng-show="moduleMustHaveSubjects(module)"> <td colspan="6"> {{\'subject.optional\' | translate}} </td> </tr> <tr class="higher-curriculum-subject-row" ng-repeat="subject in module.subjects | filter: {optional: true} | orderBy: currentLanguageNameField()"> <td>{{currentLanguageNameField(subject)}}</td> <td>{{subject.code}}</td> <td>{{subject.credits}}</td> <td>{{subject.studyYearNumber}}</td> <td><md-checkbox ng-model="subject.autumn" aria-label="Autumn semester" disabled></md-checkbox></td> <td><md-checkbox ng-model="subject.spring" aria-label="Spring semester" disabled></md-checkbox></td> </tr> <tr class="secondary-table-header"> <td>{{\'module.overallAtLeast\' | translate}}</td> <td></td> <td>{{module.optionalStudyCredits}}</td> <td colspan="3"></td> </tr> </tbody> </table> </md-table-container> </div> </fieldset> <div>&nbsp;</div> <fieldset tabindex="3"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small" ng-class="{invalid: higherCurriculumVersionForm.$submitted && !allMinorSpecialitiesValid()}">{{\'curriculum.minorSpecialty.minorSpecialties\' | translate}}</legend> <md-button class="md-raised" ng-click="openAddMinorSpecialtyDialog()" ng-if="!formState.readOnly && version.id  && version.canChange">{{\'curriculum.minorSpecialty.add\' | translate}}</md-button> <md-table-container> <table class="custom-table"> <thead class="secondary-table-header"> <th style="width: 35%">{{\'subject.name\' | translate}}</th> <th style="width: 20%">{{\'subject.code\' | translate}}</th> <th style="width: 10%">EAP</th> <th style="width: 10%">{{\'module.studyYear\' | translate}}</th> <th style="width: 10%"> <hois-classifier-value ng-value="\'OPPEPERIOOD_S\'" main-classifier-code="OPPEPERIOOD"></hois-classifier-value> </th> <th style="width: 10%"> <hois-classifier-value ng-value="\'OPPEPERIOOD_K\'" main-classifier-code="OPPEPERIOOD"></hois-classifier-value> </th> </thead> <tbody ng-repeat="module in version.modules | filter: {minorSpeciality: true} | orderBy: currentLanguageNameField()"> <tr class="occupation-header"> <td colspan="6"> <a href="" ng-click="openAddMinorSpecialtyDialog(module)" flex="70"> <span>{{\'curriculum.minorSpecialty.minorSpecialty\' | translate}} {{currentLanguageNameField(module)}} {{module.totalCredits}} EAP</span> </a> </td> </tr> <tr class="sub-header1" ng-show="moduleMustHaveSubjects(module)"> <td colspan="6"> {{\'subject.mandatory\' | translate}} </td> </tr> <tr class="higher-curriculum-subject-row" ng-repeat="subject in module.subjects | filter: {optional: false} | orderBy: currentLanguageNameField()"> <td>{{currentLanguageNameField(subject)}}</td> <td>{{subject.code}}</td> <td>{{subject.credits}}</td> <td>{{subject.studyYearNumber}}</td> <td><md-checkbox ng-model="subject.autumn" aria-label="Autumn semester" disabled></md-checkbox></td> <td><md-checkbox ng-model="subject.spring" aria-label="Spring semester" disabled></md-checkbox></td> </tr> <tr class="secondary-table-header" ng-show="moduleMustHaveSubjects(module)"> <td>{{\'main.OF\' | translate}}</td> <td></td> <td>{{module.compulsoryStudyCredits}}</td> <td colspan="3"></td> </tr> <tr class="sub-header1"> <td colspan="6"> {{\'subject.optional\' | translate}} </td> </tr> <tr class="higher-curriculum-subject-row" ng-repeat="subject in module.subjects | filter: {optional: true} | orderBy: currentLanguageNameField()"> <td>{{currentLanguageNameField(subject)}}</td> <td>{{subject.code}}</td> <td>{{subject.credits}}</td> <td>{{subject.studyYearNumber}}</td> <td><md-checkbox ng-model="subject.autumn" aria-label="Autumn semester" disabled></md-checkbox></td> <td><md-checkbox ng-model="subject.spring" aria-label="Spring semester" disabled></md-checkbox></td> </tr> <tr class="secondary-table-header"> <td>{{\'module.overallAtLeast\' | translate}}</td> <td></td> <td>{{module.optionalStudyCredits}}</td> <td colspan="3"></td> </tr> </tbody> </table> </md-table-container> </fieldset> <div>&nbsp;</div> <fieldset tabindex="4"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'curriculum.versionStatus\' | translate}}</legend> <div layout="row" flex="100"> <md-input-container flex="30" flex-sm="100" flex-xs="100"> <label>{{\'main.validFrom\' | translate}}</label> <md-datepicker ng-model="version.validFrom" md-open-on-focus required ng-disabled="formState.readOnly"></md-datepicker> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-xs="100" flex-offset-xs="0" flex-offset-sm="0" flex-offset="4"> <label>{{\'main.validTo\' | translate}}</label> <md-datepicker ng-model="version.validThru" md-min-date="version.validFrom" md-open-on-focus ng-disabled="formState.readOnly"></md-datepicker> </md-input-container> </div> <div layout="row" class="top-margin form-readonly"> <md-input-container flex="30" flex-sm="100"> <label>{{\'main.status\' | translate}}</label> <hois-classifier-value ng-model="version.status" main-classifier-code="OPPEKAVA_VERSIOON_STAATUS"></hois-classifier-value> </md-input-container> </div> </fieldset> <div ng-if="years.length > 0">&nbsp;</div> <hois-collapsable expanded="false" ng-if="years.length > 0"> <hois-collapsable-header> <span>{{\'curriculum.version.typicalTrainingPlan\' | translate}}</span> </hois-collapsable-header> <md-table-container style="padding: 1px"> <table class="custom-table"> <thead class="secondary-table-header"> <th style="width: 35%">{{\'subject.name\' | translate}}</th> <th style="width: 20%">{{\'subject.code\' | translate}}</th> <th style="width: 10%">EAP</th> <th style="width: 10%">{{\'subject.assessment\' | translate}}</th> <th style="width: 10%">{{\'subject.mandatory\' | translate}}</th> </thead> <tbody ng-repeat="year in years | orderBy"> <tr class="sub-header1" ng-show="(mappedSubjects[year] | filter: {spring: true}).length > 0"> <td colspan="6"> {{\'module.springSemesterYear\' | translate: {year: year} }} </td> </tr> <tr class="higher-curriculum-subject-row" ng-repeat="subject in mappedSubjects[year] | filter: {spring: true} | orderBy: currentLanguageNameField()"> <td>{{currentLanguageNameField(subject)}}</td> <td>{{subject.code}}</td> <td>{{subject.credits}}</td> <td>{{subject.assessment}}</td> <td>{{subject.optional ? (\'main.no\' | translate) : (\'main.yes\' | translate)}}</td> </tr> <tr class="sub-header1" ng-show="(mappedSubjects[year] | filter: {autumn: true}).length > 0"> <td colspan="6"> {{\'module.autumnSemesterYear\' | translate: {year: year} }} </td> </tr> <tr class="higher-curriculum-subject-row" ng-repeat="subject in mappedSubjects[year] | filter: {autumn: true} | orderBy: currentLanguageNameField()"> <td>{{currentLanguageNameField(subject)}}</td> <td>{{subject.code}}</td> <td>{{subject.credits}}</td> <td>{{subject.assessment}}</td> <td>{{subject.optional ? (\'main.no\' | translate) : (\'main.yes\' | translate)}}</td> </tr> </tbody> </table> </md-table-container> </hois-collapsable> <hois-created-modified object="version"></hois-created-modified> </form> <div layout="row"> <div flex layout-xs="column"> <span ng-show="version.status === VERSION_STATUS.S"> <span ng-show="!version.id" layout-xs="column"> <md-button class="md-raised md-primary" ng-click="save()">{{\'main.button.save\' | translate}}</md-button> </span> <span ng-show="!formState.readOnly && version.id" layout-xs="column"> <md-button class="md-raised md-primary" ng-click="save()" ng-if="version.canChange">{{\'main.button.save\' | translate}}</md-button> <md-button class="md-raised" ng-click="saveAndConfirm()" ng-if="version.canChange && version.canConfirm">{{\'curriculum.statuschange.version.button.verify\' | translate}}</md-button> <md-button class="md-raised" ng-click="setStatusClosed()" ng-if="version.canChange && version.canClose">{{\'curriculum.statuschange.version.button.close\' | translate}}</md-button> <md-button class="md-raised md-default" ng-click="copy()" ng-if="version.canChange">{{\'main.button.copy\' | translate}}</md-button> <md-button class="md-raised md-default" ng-click="delete()" ng-if="version.canDelete">{{\'main.button.delete\' | translate}}</md-button> </span> <span ng-show="formState.readOnly" layout-xs="column"> <md-button class="md-raised md-primary" ng-click="goToEditForm()" ng-if="version.canChange">{{\'main.button.change\' | translate}}</md-button> <md-button class="md-raised" ng-click="confirm()" ng-if="version.canConfirm">{{\'curriculum.statuschange.version.button.verify\' | translate}}</md-button> <md-button class="md-raised" ng-click="setStatusClosed()" ng-if="version.canClose">{{\'curriculum.statuschange.version.button.close\' | translate}}</md-button> <md-button class="md-raised md-default" ng-click="copy()" ng-if="version.canChange">{{\'main.button.copy\' | translate}}</md-button> </span> </span> <span ng-show="version.status === VERSION_STATUS.K"> <span ng-show="!formState.readOnly" layout-xs="column"> <md-button class="md-raised md-primary" ng-click="save()" ng-if="version.canChange">{{\'main.button.save\' | translate}}</md-button> <md-button class="md-raised md-default" ng-click="changeStatusUnderRevision()" ng-if="version.canChange && version.canSetUnderRevision">{{\'curriculum.statuschange.version.button.changeStatusUnderRevision\' | translate}}</md-button> </span> <span ng-show="formState.readOnly" layout-xs="column"> <md-button class="md-raised md-primary" ng-if="version.canChange" ng-click="goToEditForm()">{{\'main.button.change\' | translate}}</md-button> <md-button class="md-raised md-default" ng-click="changeStatusUnderRevision()" ng-if="version.canChange && version.canSetUnderRevision">{{\'curriculum.statuschange.version.button.changeStatusUnderRevision\' | translate}}</md-button> <md-button class="md-raised" ng-click="setStatusClosed()" ng-if="version.canClose">{{\'curriculum.statuschange.version.button.close\' | translate}}</md-button> <md-button class="md-raised md-default" ng-if="version.canChange" ng-click="copy()">{{\'main.button.copy\' | translate}}</md-button> </span> </span> <span ng-show="version.status === VERSION_STATUS.C" layout-xs="column"> <md-button class="md-raised md-default" ng-if="version.canChange" ng-click="copy()">{{\'main.button.copy\' | translate}}</md-button> </span> <a ng-show="showPrintButton()" href="{{formState.curriculumPdfUrl}}" target="_blank" class="md-button md-raised">{{\'main.button.print\' | translate}}</a> <a ng-show="showPrintButton()" href="{{formState.curriculumXmlUrl}}" target="_blank" class="md-button md-raised">XML</a> <md-button class="md-raised md-default" ng-click="back(\'#/higherCurriculum/\' + version.curriculum + \'/view\', higherCurriculumVersionForm)">{{\'main.button.back\' | translate}}</md-button> </div> </div> </div> <style>.module-type {\r\n  text-decoration: underline;\r\n}\r\n\r\ntable.custom-table {\r\n  border-collapse: collapse;\r\n  width: 100%;\r\n}\r\n\r\ntable.custom-table th:first-child,\r\ntable.custom-table td:first-child {\r\n  padding-left: 2.5em;\r\n}\r\n\r\ntable.custom-table th:last-child,\r\ntable.custom-table td:last-child {\r\n  padding-right: 1.5em;\r\n}\r\n\r\ntable.custom-table th,\r\ntable.custom-table td{\r\n  padding-right: 0.5em;\r\n  text-align: left;\r\n  white-space: nowrap;\r\n}\r\n\r\ntable.custom-table tr.occupation-header {\r\n  height: 38px !important;\r\n}\r\n\r\ntable.custom-table tr.occupation-header td:first-child {\r\n  padding-left: 0.5em !important;\r\n}\r\n\r\ntable.custom-table tr.sub-header1 {\r\n  height: 32px !important;\r\n}\r\n\r\ntable.custom-table tr.sub-header1 td:first-child {\r\n  padding-left: 1.5em !important;\r\n}\r\n\r\ntable.custom-table tr {\r\n  height: 28px;\r\n}\r\n\r\ntable.custom-table td md-checkbox {\r\n  margin: auto;\r\n}</style>'),a.put("higherCurriculum/higher.curriculum.version.view.html",'<div class="ois-form-layout-padding" ng-cloak ng-show="!showMainForm"> <form name="higherCurriculumVersionForm" layout="column" class="nomargin"> <fieldset tabindex="1"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'curriculum.versionMainData\' | translate}}</legend> <div layout="column"> <md-input-container flex ng-if="!showMainForm"> <label>{{\'curriculum.version.code\' | translate}}</label> <input name="code" ng-model="version.code" type="text" readonly> </md-input-container> <div layout="row" flex> <md-input-container flex="45"> <label>{{\'curriculum.version.firstAdmissionYear\' | translate}}</label> <md-select ng-model="version.admissionYear" disabled> <md-option ng-repeat="year in ::admissionYears" ng-value="year" aria-label="{{year}}">{{year}}</md-option> </md-select> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label>{{\'curriculum.version.type\' | translate}}</label> <hois-classifier-select ng-model="version.type" main-classifier-code="OPPEKAVA_VERSIOON_LIIK" model-value-attr="code" disabled></hois-classifier-select> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label>{{\'curriculum.specialty.specialties\' | translate}}</label> <md-select multiple ng-model="version.specialitiesReferenceNumbers" disabled> <md-option ng-repeat="speciality in curriculum.specialities | orderBy: currentLanguageNameField()" ng-value="speciality.referenceNumber"> {{currentLanguageNameField(speciality)}} </md-option> </md-select> </md-input-container> </div> <md-input-container flex ng-if="version.status === VERSION_STATUS.K"> <label>{{\'public.url\' | translate}}</label> <input ng-model="publicUrl" type="text" readonly> </md-input-container> <br> </div> </fieldset> <div>&nbsp;</div> <fieldset tabindex="2"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'module.modules\' | translate}}</legend> <div ng-repeat="spectiality in curriculum.specialities | filter: filterSpecialities | orderBy: currentLanguageNameField()" flex> <h2 class="md-title-small">{{\'curriculum.specialty.specialty\' | translate}} {{$index + 1}}: {{currentLanguageNameField(spectiality)}}</h2> <md-table-container> <table class="custom-table"> <thead class="secondary-table-header"> <th style="width: 35%">{{\'subject.name\' | translate}}</th> <th style="width: 20%">{{\'subject.code\' | translate}}</th> <th style="width: 10%">EAP</th> <th style="width: 10%">{{\'module.studyYear\' | translate}}</th> <th style="width: 10%"> <hois-classifier-value ng-value="\'OPPEPERIOOD_S\'" main-classifier-code="OPPEPERIOOD"></hois-classifier-value> </th> <th style="width: 10%"> <hois-classifier-value ng-value="\'OPPEPERIOOD_K\'" main-classifier-code="OPPEPERIOOD"></hois-classifier-value> </th> </thead> <tbody ng-repeat="module in version.modules | filter: {minorSpeciality: false} | filter: filterModulesBySpeciality(spectiality) | orderBy: currentLanguageNameField()"> <tr class="occupation-header"> <td colspan="6"> <a href="" ng-click="openAddModuleDialog(module)" flex="70"> {{\'curriculum.module\' | translate}} {{currentLanguageNameField(module)}} {{module.totalCredits}} EAP <span ng-if="module.type === \'KORGMOODUL_M\'">({{currentLanguage()==\'et\' ? module.typeNameEt : module.typeNameEn}})</span> <span ng-if="module.type !== \'KORGMOODUL_M\'">(<hois-classifier-value ng-model="module.type" main-classifier-code="KORGMOODUL" class="inline module-type"></hois-classifier-value>)</span> </a> </td> </tr> <tr class="sub-header1" ng-show="moduleMustHaveSubjects(module)"> <td colspan="6"> {{\'subject.mandatory\' | translate}} </td> </tr> <tr class="higher-curriculum-subject-row" ng-repeat="subject in module.subjects | filter: {optional: false} | orderBy: currentLanguageNameField()"> <td>{{currentLanguageNameField(subject)}}</td> <td>{{subject.code}}</td> <td>{{subject.credits}}</td> <td>{{subject.studyYearNumber}}</td> <td><md-checkbox ng-model="subject.autumn" aria-label="Autumn semester" disabled></md-checkbox></td> <td><md-checkbox ng-model="subject.spring" aria-label="Spring semester" disabled></md-checkbox></td> </tr> <tr class="secondary-table-header" ng-show="moduleMustHaveSubjects(module)"> <td>{{\'main.OF\' | translate}}</td> <td></td> <td>{{module.compulsoryStudyCredits}}</td> <td colspan="3"></td> </tr> <tr class="sub-header1" ng-show="moduleMustHaveSubjects(module)"> <td colspan="6"> {{\'subject.optional\' | translate}} </td> </tr> <tr class="higher-curriculum-subject-row" ng-repeat="subject in module.subjects | filter: {optional: true} | orderBy: currentLanguageNameField()"> <td>{{currentLanguageNameField(subject)}}</td> <td>{{subject.code}}</td> <td>{{subject.credits}}</td> <td>{{subject.studyYearNumber}}</td> <td><md-checkbox ng-model="subject.autumn" aria-label="Autumn semester" disabled></md-checkbox></td> <td><md-checkbox ng-model="subject.spring" aria-label="Spring semester" disabled></md-checkbox></td> </tr> <tr class="secondary-table-header"> <td>{{\'module.overallAtLeast\' | translate}}</td> <td></td> <td>{{module.optionalStudyCredits}}</td> <td colspan="3"></td> </tr> </tbody> </table> </md-table-container> <!-- end show modules by specialities--> </div> </fieldset> <div>&nbsp;</div> <fieldset tabindex="3"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'curriculum.minorSpecialty.minorSpecialties\' | translate}}</legend> <md-table-container> <table class="custom-table"> <thead class="secondary-table-header"> <th style="width: 35%">{{\'subject.name\' | translate}}</th> <th style="width: 20%">{{\'subject.code\' | translate}}</th> <th style="width: 10%">EAP</th> <th style="width: 10%">{{\'module.studyYear\' | translate}}</th> <th style="width: 10%"> <hois-classifier-value ng-value="\'OPPEPERIOOD_S\'" main-classifier-code="OPPEPERIOOD"></hois-classifier-value> </th> <th style="width: 10%"> <hois-classifier-value ng-value="\'OPPEPERIOOD_K\'" main-classifier-code="OPPEPERIOOD"></hois-classifier-value> </th> </thead> <tbody ng-repeat="module in version.modules | filter: {minorSpeciality: true} | orderBy: currentLanguageNameField()"> <tr class="occupation-header"> <td colspan="6"> <a href="" ng-click="openAddMinorSpecialtyDialog(module)" flex="70"> <span>{{\'curriculum.minorSpecialty.minorSpecialty\' | translate}} {{currentLanguageNameField(module)}} {{module.totalCredits}} EAP</span> </a> </td> </tr> <tr class="sub-header1" ng-show="moduleMustHaveSubjects(module)"> <td colspan="6"> {{\'subject.mandatory\' | translate}} </td> </tr> <tr class="higher-curriculum-subject-row" ng-repeat="subject in module.subjects | filter: {optional: false} | orderBy: currentLanguageNameField()"> <td>{{currentLanguageNameField(subject)}}</td> <td>{{subject.code}}</td> <td>{{subject.credits}}</td> <td>{{subject.studyYearNumber}}</td> <td><md-checkbox ng-model="subject.autumn" aria-label="Autumn semester" disabled></md-checkbox></td> <td><md-checkbox ng-model="subject.spring" aria-label="Spring semester" disabled></md-checkbox></td> </tr> <tr class="secondary-table-header" ng-show="moduleMustHaveSubjects(module)"> <td>{{\'main.OF\' | translate}}</td> <td></td> <td>{{module.compulsoryStudyCredits}}</td> <td colspan="3"></td> </tr> <tr class="sub-header1"> <td colspan="6"> {{\'subject.optional\' | translate}} </td> </tr> <tr class="higher-curriculum-subject-row" ng-repeat="subject in module.subjects | filter: {optional: true} | orderBy: currentLanguageNameField()"> <td>{{currentLanguageNameField(subject)}}</td> <td>{{subject.code}}</td> <td>{{subject.credits}}</td> <td>{{subject.studyYearNumber}}</td> <td><md-checkbox ng-model="subject.autumn" aria-label="Autumn semester" disabled></md-checkbox></td> <td><md-checkbox ng-model="subject.spring" aria-label="Spring semester" disabled></md-checkbox></td> </tr> <tr class="secondary-table-header"> <td>{{\'module.overallAtLeast\' | translate}}</td> <td></td> <td>{{module.optionalStudyCredits}}</td> <td colspan="3"></td> </tr> </tbody> </table> </md-table-container> </fieldset> <div>&nbsp;</div> <fieldset tabindex="4"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'curriculum.versionStatus\' | translate}}</legend> <div layout="row" flex="100"> <md-input-container flex="30" flex-sm="100" flex-xs="100"> <label>{{\'main.validFrom\' | translate}}</label> <md-datepicker ng-model="version.validFrom" md-open-on-focus disabled></md-datepicker> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-xs="100" flex-offset-xs="0" flex-offset-sm="0" flex-offset="4"> <label>{{\'main.validTo\' | translate}}</label> <md-datepicker ng-model="version.validThru" md-min-date="version.validFrom" md-open-on-focus disabled></md-datepicker> </md-input-container> </div> <div layout="row" class="top-margin form-readonly"> <md-input-container flex="30" flex-sm="100"> <label>{{\'main.status\' | translate}}</label> <hois-classifier-value ng-model="version.status" main-classifier-code="OPPEKAVA_VERSIOON_STAATUS"></hois-classifier-value> </md-input-container> </div> </fieldset> <div ng-if="years.length > 0">&nbsp;</div> <hois-collapsable expanded="false" ng-if="years.length > 0"> <hois-collapsable-header> <span>{{\'curriculum.version.typicalTrainingPlan\' | translate}}</span> </hois-collapsable-header> <md-table-container style="padding: 1px"> <table class="custom-table"> <thead class="secondary-table-header"> <th style="width: 35%">{{\'subject.name\' | translate}}</th> <th style="width: 20%">{{\'subject.code\' | translate}}</th> <th style="width: 10%">EAP</th> <th style="width: 10%">{{\'subject.assessment\' | translate}}</th> <th style="width: 10%">{{\'subject.mandatory\' | translate}}</th> </thead> <tbody ng-repeat="year in years | orderBy"> <tr class="sub-header1" ng-show="(mappedSubjects[year] | filter: {spring: true}).length > 0"> <td colspan="6"> {{\'module.springSemesterYear\' | translate: {year: year} }} </td> </tr> <tr class="higher-curriculum-subject-row" ng-repeat="subject in mappedSubjects[year] | filter: {spring: true} | orderBy: currentLanguageNameField()"> <td>{{currentLanguageNameField(subject)}}</td> <td>{{subject.code}}</td> <td>{{subject.credits}}</td> <td>{{subject.assessment}}</td> <td>{{subject.optional ? (\'main.no\' | translate) : (\'main.yes\' | translate)}}</td> </tr> <tr class="sub-header1" ng-show="(mappedSubjects[year] | filter: {autumn: true}).length > 0"> <td colspan="6"> {{\'module.autumnSemesterYear\' | translate: {year: year} }} </td> </tr> <tr class="higher-curriculum-subject-row" ng-repeat="subject in mappedSubjects[year] | filter: {autumn: true} | orderBy: currentLanguageNameField()"> <td>{{currentLanguageNameField(subject)}}</td> <td>{{subject.code}}</td> <td>{{subject.credits}}</td> <td>{{subject.assessment}}</td> <td>{{subject.optional ? (\'main.no\' | translate) : (\'main.yes\' | translate)}}</td> </tr> </tbody> </table> </md-table-container> </hois-collapsable> <hois-created-modified object="version"></hois-created-modified> </form> <div layout="row"> <div flex layout-xs="column"> <span ng-show="version.status === VERSION_STATUS.S" layout-xs="column"> <md-button class="md-raised md-primary" ng-click="goToEditForm()" ng-if="version.canChange">{{\'main.button.change\' | translate}}</md-button> <md-button class="md-raised" ng-click="confirm()" ng-if="version.canConfirm">{{\'curriculum.statuschange.version.button.verify\' | translate}}</md-button> <md-button class="md-raised" ng-click="setStatusClosed()" ng-if="version.canClose">{{\'curriculum.statuschange.version.button.close\' | translate}}</md-button> <md-button class="md-raised md-default" ng-click="copy()" ng-if="version.canChange">{{\'main.button.copy\' | translate}}</md-button> </span> <span ng-show="version.status === VERSION_STATUS.K" layout-xs="column"> <md-button class="md-raised md-primary" ng-if="version.canChange" ng-click="goToEditForm()">{{\'main.button.change\' | translate}}</md-button> <md-button class="md-raised md-default" ng-click="changeStatusUnderRevision()" ng-if="version.canChange && version.canSetUnderRevision">{{\'curriculum.statuschange.version.button.changeStatusUnderRevision\' | translate}}</md-button> <md-button class="md-raised" ng-click="setStatusClosed()" ng-if="version.canClose">{{\'curriculum.statuschange.version.button.close\' | translate}}</md-button> <md-button class="md-raised md-default" ng-if="version.canChange" ng-click="copy()">{{\'main.button.copy\' | translate}}</md-button> </span> <span ng-show="version.status === VERSION_STATUS.C" layout-xs="column"> <md-button class="md-raised md-default" ng-if="version.canChange" ng-click="copy()">{{\'main.button.copy\' | translate}}</md-button> </span> <a ng-show="showPrintButton()" href="{{formState.curriculumPdfUrl}}" target="_blank" class="md-button md-raised">{{\'main.button.print\' | translate}}</a> <a ng-show="showPrintButton()" href="{{formState.curriculumXmlUrl}}" target="_blank" class="md-button md-raised">XML</a> <md-button class="md-raised md-default" ng-click="back(\'#/higherCurriculum/\' + version.curriculum + \'/view\', higherCurriculumVersionForm)">{{\'main.button.back\' | translate}}</md-button> </div> </div> </div> <style>.module-type {\r\n  text-decoration: underline;\r\n}\r\n\r\ntable.custom-table {\r\n  border-collapse: collapse;\r\n  width: 100%;\r\n}\r\n\r\ntable.custom-table th:first-child,\r\ntable.custom-table td:first-child {\r\n  padding-left: 2.5em;\r\n}\r\n\r\ntable.custom-table th:last-child,\r\ntable.custom-table td:last-child {\r\n  padding-right: 1.5em;\r\n}\r\n\r\ntable.custom-table th,\r\ntable.custom-table td{\r\n  padding-right: 0.5em;\r\n  text-align: left;\r\n  white-space: nowrap;\r\n}\r\n\r\ntable.custom-table tr.occupation-header {\r\n  height: 38px !important;\r\n}\r\n\r\ntable.custom-table tr.occupation-header td:first-child {\r\n  padding-left: 0.5em !important;\r\n}\r\n\r\ntable.custom-table tr.sub-header1 {\r\n  height: 32px !important;\r\n}\r\n\r\ntable.custom-table tr.sub-header1 td:first-child {\r\n  padding-left: 1.5em !important;\r\n}\r\n\r\ntable.custom-table tr {\r\n  height: 28px;\r\n}\r\n\r\ntable.custom-table td md-checkbox {\r\n  margin: auto;\r\n}</style>'),
a.put("higherCurriculum/higher.curriculum.view.html",'<div class="ois-form-layout-padding"> <form name="higherCurriculumForm" layout="column" class="nomargin"> <div layout="row" layout-sm="column" layout-xs="column"> <fieldset tabindex="1" flex="30" flex-sm="100" flex-xs="100" class="higher-curriculum-top-fieldset"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'curriculum.nameTitle\' | translate}}</legend> <div layout="column"> <md-input-container flex="100"> <label>{{\'curriculum.nameEt\' | translate}}</label> <input ng-model="curriculum.nameEt" type="text" readonly> </md-input-container> <md-input-container flex="100"> <label>{{\'curriculum.nameEn\' | translate}}</label> <input ng-model="curriculum.nameEn" type="text" readonly> </md-input-container> <md-input-container flex="100"> <label>{{\'curriculum.nameGenitiveEt\' | translate}}</label> <input ng-model="curriculum.nameGenitiveEt" type="text" readonly> </md-input-container> <md-input-container flex="1000"> <label>{{\'curriculum.nameGenitiveEn\' | translate}}</label> <input ng-model="curriculum.nameGenitiveEn" type="text" readonly> </md-input-container> </div> </fieldset> <fieldset tabindex="2" flex="66" flex-offset="4" flex-sm="100" flex-xs="100" flex-offset-xs="0" flex-offset-sm="0"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'curriculum.mainData\' | translate}}</legend> <div layout="row" flex> <div flex="45"> <md-checkbox ng-model="curriculum.joint" aria-label="{{\'curriculum.isJoint\' | translate}}" class="md-primary" disabled> {{\'curriculum.isJoint\' | translate}} </md-checkbox> </div> <md-input-container flex="50" flex-offset="5"> <label>{{\'curriculum.code\' | translate}}</label> <input ng-model="curriculum.code" name="code" type="text" readonly> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="45"> <label>{{\'curriculum.studyLevel\' | translate}}</label> <hois-classifier-select ng-model="curriculum.origStudyLevel" main-classifier-code="OPPEASTE" model-value-attr="code" disabled></hois-classifier-select> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label>{{\'curriculum.merCode\' | translate}}</label> <input ng-model="curriculum.merCode" name="merCode" type="text" readonly> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="45"> <label>{{\'curriculum.ekrLevel\' | translate}}</label> <hois-classifier-select ng-model="ekrLevel" main-classifier-code="EKR" watch-model="curriculum.origStudyLevel" filter-values connect-main-classifier-code="EKR" select-first-value disabled></hois-classifier-select> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label>{{\'curriculum.creditsEap\' | translate}}</label> <input ng-model="curriculum.credits" type="number" name="credits" readonly> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="45"> <label>{{\'curriculum.educationLevel\' | translate}}</label> <hois-classifier-select ng-model="educationLevel" main-classifier-code="HARIDUSTASE" watch-model="curriculum.origStudyLevel" filter-values connect-main-classifier-code="HARIDUSTASE" select-first-value disabled></hois-classifier-select> </md-input-container> <md-input-container flex="25" flex-offset="5"> <input ng-model="curriculum.studyPeriodYears" type="number" name="studyPeriodYears" placeholder="{{\'curriculum.studyPeriod\' | translate}} {{\'main.years\' | translate}}" readonly> </md-input-container> <md-input-container flex="20" flex-offset="5"> <input ng-model="curriculum.studyPeriodMonths" type="number" name="studyPeriodMonths" placeholder="{{\'main.months\' | translate}}" readonly> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="45"> <label>{{\'curriculum.curriculumGroup\' | translate}}</label> <hois-classifier-select ng-model="curriculum.group" main-classifier-code="OPPEKAVAGRUPP" model-value-attr="code" disabled></hois-classifier-select> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label>{{\'curriculum.studyLanguage\' | translate}}</label> <hois-classifier-select multiple ng-model="curriculum.studyLanguages" main-classifier-code="OPPEKEEL" model-value-attr="code" criteria="{higher: true}" disabled></hois-classifier-select> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="45"> <label>{{\'curriculum.group\' | translate}}</label> <hois-classifier-select ng-model="curriculum.iscedClass" model-value-attr="code" main-classifier-code="ISCED_RYHM" criteria="{higher: true}" watch-model="curriculum.group" filter-values search-from-connect connect-main-classifier-code="OPPEKAVAGRUPP" disabled></hois-classifier-select> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label>{{\'curriculum.languageDescription\' | translate}}</label> <textarea ng-model="curriculum.languageDescription" max-rows="10" readonly></textarea> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="45"> <label>{{\'curriculum.areaOfStudy\' | translate}}</label> <hois-classifier-select ng-model="curriculum.areaOfStudy" main-classifier-code="ISCED_VALD" watch-model="curriculum.fieldOfStudy" model-value-attr="code" select-first-value connect-main-classifier-code="ISCED_VALD" criteria="{higher: true}" disabled></hois-classifier-select> </md-input-container> <!-- hois-school-department-select was not used here as it set form $dirty after page load.\r\n          In addition, extra logic in providing options --> <md-input-container flex="50" flex-offset="5"> <label> {{\'curriculum.structuralUnitResponsible\' | translate}} </label> <hois-select ng-model="curriculum.schoolDepartments" multiple values="schoolDepartments" disabled></hois-select> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="45"> <label>{{\'curriculum.fieldOfStudy\' | translate}}</label> <hois-classifier-select ng-model="curriculum.fieldOfStudy" main-classifier-code="ISCED_SUUN" watch-model="curriculum.iscedClass" filter-values select-first-value connect-main-classifier-code="ISCED_SUUN" criteria="{higher: true}" disabled model-value-attr="code"></hois-classifier-select> </md-input-container> </div> </fieldset> </div> <div>&nbsp;</div> <fieldset tabindex="4"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'curriculum.commonData\' | translate}}</legend> <div layout="column"> <md-input-container flex> <label>{{\'stateCurriculum.enter.objectivesEt\' | translate}}</label> <textarea ng-model="curriculum.objectivesEt" max-rows="10" readonly></textarea> </md-input-container> <md-input-container flex> <label>{{\'stateCurriculum.enter.objectivesEn\' | translate}}</label> <textarea ng-model="curriculum.objectivesEn" max-rows="10" readonly></textarea> </md-input-container> <md-input-container flex> <label>{{\'curriculum.studyOutcomesEt\' | translate}}</label> <textarea ng-model="curriculum.outcomesEt" max-rows="10" readonly></textarea> </md-input-container> <md-input-container flex> <label>{{\'curriculum.studyOutcomesEn\' | translate}}</label> <textarea ng-model="curriculum.outcomesEn" max-rows="10" readonly></textarea> </md-input-container> <md-input-container flex> <label>{{\'curriculum.higherAdmissionRequirementsEt\' | translate}}</label> <textarea ng-model="curriculum.admissionRequirementsEt" max-rows="10" readonly></textarea> </md-input-container> <md-input-container flex> <label>{{\'curriculum.higherAdmissionRequirementsEn\' | translate}}</label> <textarea ng-model="curriculum.admissionRequirementsEn" max-rows="10" readonly></textarea> </md-input-container> <md-input-container flex> <label>{{\'curriculum.higherGraduationRequirementsEt\' | translate}}</label> <textarea ng-model="curriculum.graduationRequirementsEt" max-rows="10" readonly></textarea> </md-input-container> <md-input-container flex> <label>{{\'curriculum.higherGraduationRequirementsEn\' | translate}}</label> <textarea ng-model="curriculum.graduationRequirementsEn" max-rows="10" readonly></textarea> </md-input-container> <md-input-container flex> <label>{{\'curriculum.optionalStudyDescription\' | translate}}</label> <textarea ng-model="curriculum.optionalStudyDescription" max-rows="10" readonly></textarea> </md-input-container> <md-input-container flex> <label>{{\'curriculum.addInfo\' | translate}}</label> <textarea ng-model="curriculum.addInfo" max-rows="10" readonly></textarea> </md-input-container> <md-input-container flex> <label>{{\'stateCurriculum.enter.comment\' | translate}}</label> <textarea ng-model="curriculum.description" max-rows="10" readonly></textarea> </md-input-container> <md-input-container flex> <label>{{\'curriculum.otherLanguages\' | translate}}</label> <textarea ng-model="curriculum.otherLanguages" max-rows="10" readonly></textarea> </md-input-container> <md-input-container flex> <label>{{\'curriculum.supervisor\' | translate}}</label> <input ng-value="currentLanguageNameField(curriculum.teacher)" readonly> </md-input-container> <md-input-container flex ng-if="curriculum.status === STATUS.VERIFIED"> <label>{{\'public.url\' | translate}}</label> <input ng-model="publicUrl" type="text" readonly> </md-input-container> </div> </fieldset> <div>&nbsp;</div> <fieldset tabindex="9"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'curriculum.approvalInfo\' | translate}}</legend> <md-table-container> <div layout="row" flex="100" layout-xs="column"> <md-input-container flex="30" flex-sm="100" flex-xs="100"> <label>{{\'curriculum.approvalDocumentNr\' | translate}}</label> <input ng-model="curriculum.approvalDokNr" type="text" readonly> </md-input-container> <md-input-container flex="20" flex-offset="4" flex-xs="100" flex-offset-xs="0"> <label>{{\'curriculum.approvalDate\' | translate}}</label> <md-datepicker ng-model="curriculum.approval" md-open-on-focus disabled></md-datepicker> </md-input-container> <md-input-container flex="20" flex-offset="5" flex-xs="100" flex-offset-xs="0"> <label>{{\'curriculum.htmRegisterDate\' | translate}}</label> <md-datepicker ng-model="curriculum.merRegDate" md-open-on-focus disabled></md-datepicker> </md-input-container> </div> <div layout="row" flex="100" layout-xs="column"> <md-input-container flex="30" flex-sm="100" flex-xs="100"> <label>{{\'curriculum.accreditationDesision\' | translate}}</label> <input ng-model="curriculum.accreditationResolution" type="text" readonly> </md-input-container> <md-input-container flex="20" flex-offset="4" flex-xs="100" flex-offset-xs="0"> <label>{{\'curriculum.accreditationDate\' | translate}}</label> <md-datepicker ng-model="curriculum.accreditationDate" md-open-on-focus disabled></md-datepicker> </md-input-container> </div> <div layout="row" flex="100" layout-xs="column"> <md-input-container flex="30" flex-sm="100" flex-xs="100"> <label>{{\'curriculum.accreditationDesisionNumber\' | translate}}</label> <input ng-model="curriculum.accreditationNr" type="text" readonly> </md-input-container> <md-input-container flex="20" flex-offset="4" flex-xs="100" flex-offset-xs="0"> <label>{{\'curriculum.accreditationValidityDate\' | translate}}</label> <md-datepicker ng-model="curriculum.accreditationValidDate" md-open-on-focus disabled></md-datepicker> </md-input-container> </div> </md-table-container> </fieldset> <div>&nbsp;</div> <fieldset tabindex="10"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'curriculum.diplomaInfo\' | translate}}</legend> <div layout="column"> <md-input-container flex> <label>{{\'curriculum.final31\' | translate}}</label> <input ng-model="curriculum.final31" type="text" readonly> </md-input-container> <md-input-container flex> <label>{{\'curriculum.final33\' | translate}}</label> <input ng-model="curriculum.final33" type="text" readonly> </md-input-container> <md-input-container flex> <label>{{\'curriculum.final51\' | translate}}</label> <input ng-model="curriculum.final51" type="text" readonly> </md-input-container> <md-input-container flex> <label>{{\'curriculum.final52\' | translate}}</label> <input ng-model="curriculum.final52" type="text" readonly> </md-input-container> <md-input-container flex> <label>{{\'curriculum.final61\' | translate}}</label> <input ng-model="curriculum.final61" type="text" readonly> </md-input-container> <br> <md-input-container flex> <label>{{\'curriculum.finalEn31\' | translate}}</label> <input ng-model="curriculum.finalEn31" type="text" readonly> </md-input-container> <md-input-container flex> <label>{{\'curriculum.finalEn33\' | translate}}</label> <input ng-model="curriculum.finalEn33" type="text" readonly> </md-input-container> <md-input-container flex> <label>{{\'curriculum.finalEn51\' | translate}}</label> <input ng-model="curriculum.finalEn51" type="text" readonly> </md-input-container> <md-input-container flex> <label>{{\'curriculum.finalEn52\' | translate}}</label> <input ng-model="curriculum.finalEn52" type="text" readonly> </md-input-container> <md-input-container flex> <label>{{\'curriculum.finalEn61\' | translate}}</label> <input ng-model="curriculum.finalEn61" type="text" readonly> </md-input-container> </div> </fieldset> <div>&nbsp;</div> <div>&nbsp;</div> <fieldset tabindex="11"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'curriculum.statuses\' | translate}}</legend> <div layout="row" flex="100" style="overflow:auto"> <md-input-container flex="30" flex-sm="100" flex-xs="100"> <label>{{\'main.validFrom\' | translate}}</label> <md-datepicker ng-model="curriculum.validFrom" md-open-on-focus disabled></md-datepicker> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-xs="100" flex-offset-xs="0" flex-offset-sm="0" flex-offset="4"> <label>{{\'main.validTo\' | translate}}</label> <md-datepicker ng-model="curriculum.validThru" md-min-date="curriculum.validFrom" md-open-on-focus disabled></md-datepicker> </md-input-container> </div> <div layout="row" flex="100" class="top-margin form-readonly"> <md-input-container flex="30" flex-sm="100" flex-xs="100" class="readonly"> <label class="label">{{\'main.status\' | translate}}</label> <hois-classifier-value ng-model="curriculum.status" main-classifier-code="OPPEKAVA_STAATUS"></hois-classifier-value> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-xs="100" flex-offset-xs="0" flex-offset-sm="0" flex-offset="4"> <label>{{\'curriculum.statusInEhis\' | translate}}</label> <hois-classifier-value ng-model="curriculum.ehisStatus" main-classifier-code="OPPEKAVA_EHIS_STAATUS"></hois-classifier-value> </md-input-container> <md-input-container flex="40" flex-sm="100" flex-xs="100" flex-offset-xs="0" flex-offset-sm="0" flex-offset="5"> <label>{{\'curriculum.statusChangedDateInEhis\' | translate}}</label> <hois-value value="curriculum.ehisChanged | hoisDate"></hois-value> </md-input-container> </div> </fieldset> <div ng-show="curriculum.joint">&nbsp;</div> <fieldset tabindex="8" ng-show="curriculum.joint"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'curriculum.jointInfo\' | translate}}</legend> <div layout="column"> <div layout="column" flex ng-show="curriculum.joint" class="common-label"> <label class="md-required common-label" flex="30">{{\'curriculum.jointSchool\' | translate}}</label> <div>&nbsp;</div> <div layout="row" ng-repeat="item in curriculum.jointPartners | filter: filterEmptyJointPartners | orderBy: [\'ehisSchool\', \'nameEt\']" class="align-center"> <div flex="5">&nbsp;</div> <div ng-if="item.abroad">{{currentLanguageNameField(item)}}</div> <div ng-if="!item.abroad"> <hois-classifier-value ng-model="item.ehisSchool" main-classifier-code="EHIS_KOOL"></hois-classifier-value> </div> <div flex="5">&nbsp;</div> <div flex="5"></div> </div> </div> <div layout="row" layout-sm="column" layout-xs="column" ng-show="curriculum.joint"> <md-input-container flex="30" flex-xs="100" ng-if="curriculum.joint"> <label>{{\'curriculum.jointMentor\' | translate}}</label> <hois-classifier-select ng-model="curriculum.jointMentor" main-classifier-code="EHIS_KOOL" model-value-attr="code" disabled></hois-classifier-select> </md-input-container> <md-input-container flex="66" flex-xs="100" flex-offset-xs="0" flex-offset="4"> <label>{{\'curriculum.jointResponsible\' | translate}}</label> <input ng-model="curriculum.supervisor" type="text" readonly> </md-input-container> </div> <md-input-container flex="100"> <label>{{\'curriculum.jointAgreementInfoEt\' | translate}}</label> <textarea ng-model="curriculum.contractEt" max-rows="10" readonly></textarea> </md-input-container> <md-input-container flex="100"> <label>{{\'curriculum.jointAgreementInfoEn\' | translate}}</label> <textarea ng-model="curriculum.contractEn" max-rows="10" readonly></textarea> </md-input-container> </div> </fieldset> <div>&nbsp;</div> <fieldset tabindex="9"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'curriculum.address\' | translate}}</legend> <div layout="column" flex class="common-label"> <div layout="row" ng-repeat="item in curriculum.addresses | orderBy: \'address\'" class="align-center"> <div>{{::item.address}}</div> </div> </div> </fieldset> <div>&nbsp;</div> <fieldset tabindex="12"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'curriculum.specialty.label\' | translate}}</legend> <div ng-repeat="item in curriculum.specialities | orderBy: currentLanguageNameField()" layout="column"> <div layout="row" class="occupation-row align-center" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <div flex="35"> <a ng-click="openViewSpecialtyDialog(item)" href="">{{currentLanguageNameField(item)}}</a> </div> </div> </div> </fieldset> <div>&nbsp;</div> <fieldset tabindex="12" ng-show="gradeRequired()"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'curriculum.grade.label\' | translate}}</legend> <md-table-container> <div ng-repeat="item in curriculum.grades | orderBy: currentLanguageNameField()" layout="column"> <div layout="row" class="occupation-row align-center" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <div flex="35"> <a ng-click="openViewGradeDialog(item)" href="">{{currentLanguageNameField(item)}}</a> </div> </div> </div> </md-table-container> </fieldset> <fieldset tabindex="11"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.relatedFiles\' | translate}}</legend> <md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column> <span>{{\'file.nameAndFile\' | translate}}</span> </th> <th md-column> <span>{{\'file.creationLocation\' | translate}}</span> </th> <th md-column>{{\'file.type\' | translate}}</th> <th md-column>{{\'curriculum.sendToEhis\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="file in curriculum.files | orderBy: \'oisFile.fname\'" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell> {{file.oisFile.fname}} <a ng-href="{{getUrl(file, \'curriculum\')}}" download> <md-icon md-font-set="material-icons">file_download</md-icon> </a> </td> <td md-cell> {{file.ehis ? \'EHIS\' : \'ÕIS\'}} </td> <td md-cell> <hois-classifier-value ng-model="file.ehisFile" main-classifier-code="EHIS_FAIL"></hois-classifier-value> </td> <td md-cell> <md-checkbox ng-model="file.sendEhis" aria-label="send to ehis" disabled></md-checkbox> </td> <td md-cell></td> </tr> </tbody> </table> </md-table-container> </fieldset> <div>&nbsp;</div> <fieldset tabindex="12"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small"> <span>{{\'curriculum.versions\' | translate}}</span> </legend> <md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column> <span>{{\'curriculum.versionName\' | translate}}</span> </th> <th md-column> <span>{{\'main.status\' | translate}}</span> </th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="version in curriculum.versions | orderBy: \'code\'" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell> <a ng-click="goToVersionForm(version)" href="">{{version.code}}</a> </td> <td md-cell> <hois-classifier-value ng-model="version.status" main-classifier-code="OPPEKAVA_VERSIOON_STAATUS"></hois-classifier-value> </td> </tr> </tbody> </table> </md-table-container> </fieldset> <hois-created-modified object="curriculum" class="top-margin"></hois-created-modified> <div layout="row"> <div flex layout-xs="column"> <span ng-show="curriculum.status === STATUS.ENTERING" layout-xs="column"> <md-button class="md-raised md-primary" ng-click="goToEditForm()" ng-if="curriculum.canChange">{{\'main.button.change\' | translate}}</md-button> </span> <span ng-show="curriculum.status === STATUS.PROCEEDING && !formState.sentToEhis" layout-xs="column"> <md-button class="md-raised md-primary" ng-click="goToEditForm()" ng-if="curriculum.canChange">{{\'main.button.change\' | translate}}</md-button> <md-button class="md-raised md-default" ng-click="changeStatusUnderRevision()" ng-if="curriculum.canSetUnderRevision">{{\'curriculum.button.changeStatusUnderRevision\' | translate}}</md-button> <md-button class="md-raised md-default" ng-click="sendToEhis(true)" ng-if="curriculum.canConfirm">{{\'curriculum.button.sendToEhisTest\' | translate}}</md-button> <md-button class="md-raised md-default" ng-click="sendToEhis(false)" ng-if="curriculum.canConfirm">{{\'curriculum.button.sendToEhis\' | translate}}</md-button> <md-button class="md-raised" ng-click="setStatusClosed()" ng-if="curriculum.canClose">{{\'main.button.status.close\' | translate}}</md-button> </span> <span ng-show="curriculum.status === STATUS.PROCEEDING && formState.sentToEhis" layout-xs="column"> <md-button class="md-raised md-default" ng-click="changeStatusUnderRevision()" ng-if="curriculum.canSetUnderRevision">{{\'curriculum.button.changeStatusUnderRevision\' | translate}}</md-button> <md-button class="md-raised md-default" ng-click="updateFromEhis(true)" ng-if="curriculum.canConfirm">{{\'curriculum.button.updateFromEhisTest\' | translate}}</md-button> <md-button class="md-raised md-default" ng-click="updateFromEhis(false)" ng-if="curriculum.canConfirm">{{\'curriculum.button.updateFromEhis\' | translate}}</md-button> </span> <span ng-show="curriculum.status === STATUS.VERIFIED" layout-xs="column"> <md-button class="md-raised md-primary" ng-click="goToEditForm()" ng-if="curriculum.canChange">{{\'main.button.change\' | translate}}</md-button> <md-button class="md-raised md-default" ng-click="changeStatusUnderRevision()" ng-if="curriculum.canSetUnderRevision">{{\'curriculum.button.changeStatusUnderRevision\' | translate}}</md-button> <md-button class="md-raised" ng-click="setStatusClosed()" ng-if="curriculum.canClose">{{\'main.button.status.close\' | translate}}</md-button> </span> <a ng-show="curriculum.id && (auth.isAdmin() || curriculum.status === STATUS.VERIFIED)" href="{{formState.curriculumXmlUrl}}" target="_blank" class="md-button md-raised">XML</a> <md-button class="md-raised md-default" ng-click="back(\'#/curriculum\')">{{\'main.button.back\' | translate}}</md-button> </div> </div> </form> </div> <style>.occupation-row {\r\n    min-height:38px;\r\n  }</style>'),a.put("higherProtocol/higher.protocol.edit.html",'<div class="ois-form-layout-padding" ng-cloak> <div class="form-readonly"> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex flex-sm="100" flex-xs="100"> <label>{{\'higherProtocol.number\' | translate}}</label> <hois-value value="record.protocolNr"></hois-value> </md-input-container> <md-input-container flex flex-sm="100" flex-xs="100"> <label>{{\'higherProtocol.status\' | translate}}</label> <hois-classifier-value ng-model="record.status" main-classifier-code="PROTOKOLL_STAATUS"></hois-classifier-value> </md-input-container> <md-input-container flex flex-sm="100" flex-xs="100"> <label>{{\'higherProtocol.studyPeriod\' | translate}}</label> <hois-value value="currentLanguageNameField(record.subjectStudyPeriodMidtermTaskDto.subjectStudyPeriod.studyPeriod)"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex flex-sm="100" flex-xs="100"> <label>{{\'higherProtocol.type\' | translate}}</label> <hois-classifier-value ng-model="record.protocolType" main-classifier-code="PROTOKOLLI_LIIK"></hois-classifier-value> </md-input-container> <md-input-container flex flex-sm="100" flex-xs="100"> <label>{{\'higherProtocol.subject\' | translate}}</label> <hois-value value="currentLanguageNameField(record.subjectStudyPeriodMidtermTaskDto.subjectStudyPeriod.subject)"></hois-value> </md-input-container> <md-input-container flex flex-sm="100" flex-xs="100"> <label>{{\'higherProtocol.teacher\' | translate}}</label> <hois-value value="record.subjectStudyPeriodMidtermTaskDto.subjectStudyPeriod.teachers.join(\', \')"></hois-value> </md-input-container> </div> </div> <form layout="column" name="higherProtocolForm"> <md-table-container> <table md-table md-row-select="formState.canCalculate" multiple ng-model="calculateGrades.protocolStudents"> <thead md-head> <tr md-row> <th md-column>{{\'higherProtocol.student\' | translate}}</th> <th md-column ng-show="record.subjectStudyPeriodMidtermTaskDto.subjectStudyPeriod.isPracticeSubject">{{\'higherProtocol.practiceResult\' | translate}}</th> <th md-column ng-repeat="midtermTask in record.subjectStudyPeriodMidtermTaskDto.midtermTasks"> {{getMidtermTaskHeader(midtermTask)}} </th> <th md-column>{{\'higherProtocol.finalGrade\' | translate}}</th> <th md-column ng-if="formState.canChangeConfirmedProtocolGrade" style="min-width: 250px">{{\'higherProtocol.changeReason\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="student in record.protocolStudents | orderBy: \'student.nameEt\'" ng-class-odd="\'odd\'" ng-class-even="\'even\'" md-select="student.id" md-select-id="student.id"> <ng-form name="higherProtocolStudentForm"> <td md-cell>{{student.student.nameEt}}</td> <td md-cell ng-show="record.subjectStudyPeriodMidtermTaskDto.subjectStudyPeriod.isPracticeSubject"> <span ng-repeat="journalResult in student.practiceJournalResults | orderBy: \'inserted\'"> <span ng-class="{badResult: !gradeUtil.isPositive(journalResult.grade)}">{{gradeValue(journalResult.grade)}}</span> <span ng-if="!$last">/</span> </span> </td> <td md-cell ng-repeat="result in record.subjectStudyPeriodMidtermTaskDto.studentResults | filter: filterStudentResults(student)"> <span ng-if="!result.isText">{{result.points}}</span> <span ng-if="result.isText">{{result.pointsTxt}}</span> </td> <td md-cell> <hois-select class="protocolGradeSelect" ng-model="student.grade" values="grades" value-property="code" show-property="{{auth.school.letterGrades ? \'value2\' : \'value\'}}" hide-values="hideInvalid" ng-disabled="!formState.canEditProtocol" aria-label="{{\'higherProtocol.finalGrade\' | translate}}" ng-change="gradeChanged(student)"></hois-select> </td> <td md-cell ng-if="formState.canChangeConfirmedProtocolGrade"> <md-input-container ng-if="student.gradeHasChanged"> <input ng-model="student.addInfo" aria-label="addInfo" type="text" md-maxlength="255" ng-change="addInfoChanged(student);" required> </md-input-container> <span ng-if="student.addInfo && !student.gradeHasChanged"> {{student.addInfo}} </span> </td> </ng-form> </tr> </tbody> </table> </md-table-container> <br> <div layout="row"> <md-button class="md-raised" ng-click="calculate()" ng-show="formState.canCalculate" ng-disabled="calculateGrades.protocolStudents.length === 0">{{\'higherProtocol.calculate\' | translate}}</md-button> </div> <br> <div> <md-button ng-show="formState.canEditProtocol && record.status.code !== \'PROTOKOLL_STAATUS_K\'" class="md-raised md-primary" ng-click="save()">{{\'main.button.save\' | translate}}</md-button> <hois-button ng-show="formState.canConfirm" class="md-raised md-primary" hb-click="confirm()" hb-label="{{\'main.button.confirm\' | translate}}" hb-loading hb-promise></hois-button> <a href="{{formState.protocolPdfUrl}}" target="_blank" class="md-button md-raised">{{\'main.button.print\' | translate}}</a> <a ng-show="record.oisFile" ng-href="{{getUrl(record.oisFile, \'protocol\')}}" target="_blank" rel="noopener noreferrer" class="md-button md-raised">{{\'higherProtocol.downloadSigned\' | translate}}</a> <md-button class="md-raised" ng-click="back(\'#/higherProtocols/\', higherProtocolForm)">{{\'main.button.back\' | translate}}</md-button> </div> </form> </div>'),a.put("higherProtocol/higher.protocol.new.html",'<div class="ois-form-layout-padding" ng-cloak> <div flex> <form ng-submit="submit()" novalidate layout="column" name="higherProtocolNewForm"> <div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex flex-sm="100"> <label class="textInput">{{\'higherProtocol.subject\' | translate}}</label> <hois-select ng-model="record.subjectStudyPeriod" values="subjectStudyPeriods" required></hois-select> </md-input-container> </div> <br> <div layout="row"> <label flex="10" flex-sm="30" flex-xs="30" class="common-label">{{\'higherProtocol.type\' | translate}}</label> <hois-classifier-radio layout="row" ng-model="record.protocolType" model-value-attr="code" main-classifier-code="PROTOKOLLI_LIIK" required ng-disabled="formState.readOnly" class="md-primary"></hois-classifier-radio> </div> <br> <md-table-container> <table md-table md-row-select="true" multiple ng-model="record.students"> <thead md-head> <tr md-row> <th md-column>{{\'higherProtocol.student\' | translate}}</th> <th md-column>{{\'higherProtocol.studentGroup\' | translate}}</th> <th md-column>{{\'higherProtocol.curriculumCode\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row md-select="student.id" md-select-id="student.id" ng-repeat="student in students | orderBy: \'fullname\'" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{student.fullname}}</td> <td md-cell>{{student.studentGroup.nameEt}}</td> <td md-cell>{{student.curriculum.nameEt}}</td> </tr> </tbody> </table> </md-table-container> </div> <br> <div layout="row"> <md-button class="md-raised md-primary" type="submit">{{\'higherProtocol.create\' | translate}}</md-button> <md-button class="md-raised" ng-click="back(\'#/higherProtocols/\')">{{"main.button.back" | translate}}</md-button> </div> </form> </div> </div>'),a.put("higherProtocol/higher.protocol.search.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <form name="higherProtocolSearchForm" ng-submit="loadData()" novalidate class="nomargin"> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="50" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'higherProtocol.studyPeriod\' | translate}}</label> <hois-select ng-model="criteria.studyPeriod" values="studyPeriods" required autofocus sorted-query="true"></hois-select> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="50" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'higherProtocol.subject\' | translate}}</label> <input type="text" ng-model="criteria.subject"> <!-- <hois-select ng-model="criteria.subject" type="subject" criteria="{higher: true}"></hois-select> --> </md-input-container> <md-input-container flex="45" flex-sm="100" flex-xs="100" flex-offset-xs="0" flex-offset-sm="0" flex-offset="5" ng-show="auth.isAdmin()"> <label class="textInput">{{\'higherProtocol.teacher\' | translate}}</label> <hois-select ng-model="criteria.teacher" type="teacher" criteria="{higher: true}"></hois-select> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="50" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'higherProtocol.protocolStatus\' | translate}}</label> <hois-classifier-select ng-model="criteria.status" criteria="{higher: true}" model-value-attr="code" main-classifier-code="PROTOKOLL_STAATUS"></hois-classifier-select> </md-input-container> <md-input-container flex="45" flex-sm="100" flex-xs="100" flex-offset-xs="0" flex-offset-sm="0" flex-offset="5"> <label class="textInput">{{\'higherProtocol.number\' | translate}}</label> <input type="text" ng-model="criteria.protocolNr"> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <div flex="50" flex-sm="100" flex-xs="100"> <div layout="column" flex> <label class="common-label">{{\'higherProtocol.protocolCreatedDate\' | translate}}</label> <div layout="row" flex> <md-input-container> <label>{{\'main.from\' | translate}}</label> <md-datepicker ng-model="criteria.insertedFrom" md-max-date="criteria.insertedThru" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> <md-input-container flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'main.thru\' | translate}}</label> <md-datepicker ng-model="criteria.insertedThru" md-min-date="criteria.insertedFrom" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> </div> </div> </div> <div flex="45" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <div layout="column" flex> <label class="common-label">{{\'higherProtocol.protocolConfirmedDate\' | translate}}</label> <div layout="row" flex> <md-input-container> <label>{{\'main.from\' | translate}}</label> <md-datepicker ng-model="criteria.confirmDateFrom" md-max-date="criteria.confirmDateThru" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> <md-input-container flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'main.thru\' | translate}}</label> <md-datepicker ng-model="criteria.confirmDateThru" md-min-date="criteria.confirmDateFrom" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> </div> </div> </div> </div> <br><br><br> <div layout="row"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> <md-button class="md-raised" ng-href="#/higherProtocols/new" ng-if="formState.canCreate">{{\'main.button.create\' | translate}}</md-button> </div> </form> </fieldset> </div> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="protocolNr">{{\'higherProtocol.number\' | translate}}</th> <th md-column md-order-by="protocolHdata.type.{{currentLanguageNameField()}}">{{\'higherProtocol.type\' | translate}}</th> <th md-column md-order-by="protocolHdata.subjectStudyPeriod.subject.{{currentLanguageNameField()}}">{{\'higherProtocol.subject\' | translate}}</th> <th md-column>{{\'higherProtocol.teacher\' | translate}}</th> <th md-column md-order-by="status.{{currentLanguageNameField()}}">{{\'main.status\' | translate}}</th> <th md-column md-order-by="inserted">{{\'higherProtocol.insertedDate\' | translate}}</th> <th md-column md-order-by="confirmDate">{{\'higherProtocol.confirmedDate\' | translate}}</th> <th md-column md-order-by="confirmer">{{\'higherProtocol.confirmer\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell><a ng-href="#/higherProtocols/{{::row.id}}/view">{{::row.protocolNr}}</a></td> <td md-cell>{{currentLanguageNameField(row.protocolType)}}</td> <td md-cell>{{currentLanguageNameField(row.subject)}}</td> <td md-cell> <table> <tr ng-repeat="teacher in row.teachers | orderBy"> <td>{{teacher}}</td> </tr> </table> </td> <td md-cell>{{currentLanguageNameField(row.status)}}</td> <td md-cell>{{row.inserted | hoisDate}}</td> <td md-cell>{{row.confirmDate | hoisDate}}</td> <td md-cell>{{::row.confirmer}}</td> <td md-cell> <md-button ng-if="row.canChange && row.status.code !== \'PROTOKOLL_STAATUS_K\'" md-no-ink class="md-primary change-button" ng-href="#/higherProtocols/{{::row.id}}/edit">{{\'main.button.change\' | translate}}</md-button> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> </div>'),
a.put("higherProtocol/higher.protocol.view.html",'<div class="ois-form-layout-padding" ng-cloak> <div class="form-readonly"> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex flex-sm="100" flex-xs="100"> <label>{{\'higherProtocol.number\' | translate}}</label> <hois-value value="record.protocolNr"></hois-value> </md-input-container> <md-input-container flex flex-sm="100" flex-xs="100"> <label>{{\'higherProtocol.status\' | translate}}</label> <hois-classifier-value ng-model="record.status" main-classifier-code="PROTOKOLL_STAATUS"></hois-classifier-value> </md-input-container> <md-input-container flex flex-sm="100" flex-xs="100"> <label>{{\'higherProtocol.studyPeriod\' | translate}}</label> <hois-value value="currentLanguageNameField(record.subjectStudyPeriodMidtermTaskDto.subjectStudyPeriod.studyPeriod)"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex flex-sm="100" flex-xs="100"> <label>{{\'higherProtocol.type\' | translate}}</label> <hois-classifier-value ng-model="record.protocolType" main-classifier-code="PROTOKOLLI_LIIK"></hois-classifier-value> </md-input-container> <md-input-container flex flex-sm="100" flex-xs="100"> <label>{{\'higherProtocol.subject\' | translate}}</label> <hois-value value="currentLanguageNameField(record.subjectStudyPeriodMidtermTaskDto.subjectStudyPeriod.subject)"></hois-value> </md-input-container> <md-input-container flex flex-sm="100" flex-xs="100"> <label>{{\'higherProtocol.teacher\' | translate}}</label> <hois-value value="record.subjectStudyPeriodMidtermTaskDto.subjectStudyPeriod.teachers.join(\', \')"></hois-value> </md-input-container> </div> </div> <form layout="column" name="higherProtocolForm"> <md-table-container> <table md-table> <thead md-head> <tr md-row> <th md-column>{{\'higherProtocol.student\' | translate}}</th> <th md-column ng-show="record.subjectStudyPeriodMidtermTaskDto.subjectStudyPeriod.isPracticeSubject">{{\'higherProtocol.practiceResult\' | translate}}</th> <th md-column ng-repeat="midtermTask in record.subjectStudyPeriodMidtermTaskDto.midtermTasks"> {{getMidtermTaskHeader(midtermTask)}} </th> <th md-column>{{\'higherProtocol.finalGrade\' | translate}}</th> <th md-column ng-if="record.status.code === \'PROTOKOLL_STAATUS_K\'" style="min-width: 250px">{{\'higherProtocol.changeReason\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="student in record.protocolStudents | orderBy: \'student.nameEt\'" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <ng-form name="higherProtocolStudentForm"> <td md-cell>{{student.student.nameEt}}</td> <td md-cell ng-show="record.subjectStudyPeriodMidtermTaskDto.subjectStudyPeriod.isPracticeSubject"> <span ng-repeat="journalResult in student.practiceJournalResults | orderBy: \'inserted\'"> <span ng-class="{badResult: !gradeUtil.isPositive(journalResult.grade)}">{{gradeValue(journalResult.grade)}}</span> <span ng-if="!$last">/</span> </span> </td> <td md-cell ng-repeat="result in record.subjectStudyPeriodMidtermTaskDto.studentResults | filter: filterStudentResults(student)"> <span ng-if="!result.isText">{{result.points}}</span> <span ng-if="result.isText">{{result.pointsTxt}}</span> </td> <td md-cell> <span ng-class="{badResult: !gradeUtil.isPositiveValue(student.gradeValue, auth.school.letterGrades)}">{{gradeValue(student.grade)}}</span> </td> <td md-cell ng-if="record.status.code === \'PROTOKOLL_STAATUS_K\'">{{student.addInfo}}</td> </ng-form> </tr> </tbody> </table> </md-table-container> <br> <div> <md-button ng-if="formState.canEditProtocol" class="md-raised md-primary" ng-href="#/higherProtocols/{{record.id}}/edit">{{\'main.button.change\' | translate}}</md-button> <a href="{{formState.protocolPdfUrl}}" target="_blank" class="md-button md-raised">{{\'main.button.print\' | translate}}</a> <a ng-show="record.oisFile" ng-href="{{getUrl(record.oisFile, \'protocol\')}}" target="_blank" rel="noopener noreferrer" class="md-button md-raised">{{\'higherProtocol.downloadSigned\' | translate}}</a> <md-button class="md-raised" ng-click="back(\'#/higherProtocols/\')">{{\'main.button.back\' | translate}}</md-button> </div> </form> </div>'),a.put("home/home.html",'<div layout-padding> <div ng-if="state.currentUser" ng-controller="AuthenticatedHomeController as ctrl" layout="column"> <div ng-if="displayPoll" layout-margin> <md-button ng-click="openPoll()" class="md-raised" md-colors="{background: \'pink-500\'}">{{\'poll.respond\' | translate}}</md-button> </div> <div flex ng-if="canCreateAbsence" layout-margin> <md-button ng-click="addAbsence()" class="md-primary md-raised">{{\'home.student.absence.addAbsence\' | translate}}</md-button> </div> <div layout-margin> <div ng-if="canApplyForPractice"> <md-whiteframe class="md-whiteframe-1dp attention-whiteframe" flex="100" layout layout-align="left center"> <div md-colors="{color: \'accent\'}" layout layout-align="left center"> <md-icon md-colors="{color: \'accent\'}" md-font-set="material-icons">info_outline</md-icon> <span>{{\'practiceApplication.canApplyForPractice\' | translate}} <a href="/#/practice/application/myData?_menu">{{\'main.button.view\' | translate}}</a></span> </div> </md-whiteframe> </div> <div ng-if="hasUnconfirmedPrograms.has"> <md-whiteframe class="md-whiteframe-1dp attention-whiteframe" flex="100" layout layout-align="left center"> <div md-colors="{color: \'warn\'}" layout layout-align="left center"> <md-icon md-colors="{color: \'warn\'}" md-font-set="material-icons">info_outline</md-icon> <span>{{\'subjectProgram.youHaveUnconfirmedPrograms\' | translate}} <a ng-href="/#/{{isAdmin ? \'subjectStudyPeriods\' : \'subjectProgram\'}}?_menu">{{\'main.button.view\' | translate}}</a></span> </div> </md-whiteframe> </div> <div ng-if="hasUncompletedPrograms.has"> <md-whiteframe class="md-whiteframe-1dp attention-whiteframe" flex="100" layout layout-align="left center"> <div md-colors="{color: \'warn\'}" layout layout-align="left center"> <md-icon md-colors="{color: \'warn\'}" md-font-set="material-icons">info_outline</md-icon> <span>{{\'subjectProgram.youHaveUncompletedPrograms\' | translate}} <a ng-href="/#/subjectStudyPeriods?_menu">{{\'main.button.view\' | translate}}</a></span> </div> </md-whiteframe> </div> <div ng-if="hasExpiredBaseModules.length"> <md-whiteframe class="md-whiteframe-1dp attention-whiteframe" flex="100" layout layout-align="left center"> <div md-colors="{color: \'warn\'}" layout layout-align="left center"> <md-icon md-colors="{color: \'warn\'}" md-font-set="material-icons">info_outline</md-icon> <span>{{\'basemodule.youHaveExpiredBaseModules\' | translate}} <a ng-href="/#/basemodule?_menu">{{\'main.button.view\' | translate}}</a></span> </div> </md-whiteframe> </div> <div ng-if="hasOrderedCertificates.has"> <md-whiteframe class="md-whiteframe-1dp attention-whiteframe" flex="100" layout layout-align="left center"> <div md-colors="{color: \'warn\'}" layout layout-align="left center"> <md-icon md-colors="{color: \'warn\'}" md-font-set="material-icons">info_outline</md-icon> <span>{{\'certificate.youHaveOrderedCertificates\' | translate}} <a ng-href="/#/certificate?_menu&ordered">{{\'main.button.view\' | translate}}</a></span> </div> </md-whiteframe> </div> <div ng-if="hasUnacceptedAbsences"> <md-whiteframe class="md-whiteframe-1dp attention-whiteframe" flex="100" layout layout-align="left center"> <div md-colors="{color: \'warn\'}" layout layout-align="left center"> <md-icon md-colors="{color: \'warn\'}" md-font-set="material-icons">info_outline</md-icon> <span>{{\'absence.youHaveUnacceptedAbsences\' | translate}} <a ng-href="/#/absences?_menu">{{\'main.button.view\' | translate}}</a></span> </div> </md-whiteframe> </div> <div ng-if="hasTodaysAbsences"> <md-whiteframe class="md-whiteframe-1dp attention-whiteframe" flex="100" layout layout-align="left center"> <div md-colors="{color: \'warn\'}" layout layout-align="left center"> <md-icon md-colors="{color: \'warn\'}" md-font-set="material-icons">info_outline</md-icon> <span>{{\'absence.youHaveTodaysAbsences\' | translate}} <a ng-href="/#/groupAbsences?today">{{\'main.button.view\' | translate}}</a></span> </div> </md-whiteframe> </div> <div ng-if="unconfirmedJournals && unconfirmedJournals.count > 0"> <md-whiteframe class="md-whiteframe-1dp attention-whiteframe" flex="100" layout layout-align="left center"> <div md-colors="{color: \'accent\'}" layout layout-align="left center"> <md-icon md-colors="{color: \'accent\'}" md-font-set="material-icons">info_outline</md-icon> <span ng-if="unconfirmedJournals.count === 1">{{\'journal.unconfirmedCountOne\' | translate}}</span> <span ng-if="unconfirmedJournals.count > 1">{{\'journal.unconfirmedCount\' | translate:unconfirmedJournals}}</span> </div> </md-whiteframe> </div> <div ng-if="studentGroupRemarks && studentGroupRemarks.size > 0"> <md-whiteframe class="md-whiteframe-1dp attention-whiteframe" flex="100" layout layout-align="left center"> <div md-colors="{color: \'accent\'}" layout layout-align="left center"> <md-icon md-colors="{color: \'accent\'}" md-font-set="material-icons">info_outline</md-icon> <span ng-if="unconfirmedJournals.count === 1">{{\'journal.unconfirmedCountOne\' | translate}}</span> <span ng-if="unconfirmedJournals.count > 1">{{\'journal.unconfirmedCount\' | translate:unconfirmedJournals}}</span> </div> </md-whiteframe> </div> <div ng-if="rrHasRecentChangeLogs"> <md-whiteframe class="md-whiteframe-1dp attention-whiteframe" flex="100" layout layout-align="left center"> <div md-colors="{color: \'warn\'}" layout layout-align="left center"> <md-icon md-colors="{color: \'warn\'}" md-font-set="material-icons">info_outline</md-icon> <span>{{\'rr.home.hasRecentChangeLogs\' | translate}} <a ng-href="/#/rr/changelogs?_menu">{{\'main.button.view\' | translate}}</a></span> </div> </md-whiteframe> </div> </div> <div layout="column" layout-gt-md="row" layout-margin> <div id="column-1" flex-gt-md="{{ sessionStudentId ? \'50\' : \'100\' }}" flex="100"> <!--div style="margin-bottom: 8px;" layout="row" >\r\n          <a style="font-size: 13px; font-weight: normal; min-height: inherit; line-height: inherit; padding: 0;" class="md-primary md-hue-2 md-button md-ink-ripple" ng-href="/#/studentrepresentatives/applications/new?_menu">{{\'home.represantiveApplication\' | translate}}</a>\r\n        </div--> <div ng-include="\'home/home.student.expiringOccupationStandards.html\'"></div> <div ng-include="\'home/home.student.generalMessages.html\'"></div> <div ng-include="\'home/home.student.unreadMessages.html\'"></div> <div ng-include="\'home/home.student.group.remarks.html\'"></div> <div ng-if="sessionStudentId" ng-include="\'home/home.student.homeworkAndTests.html\'"></div> <div ng-if="sessionStudentId" ng-include="\'home/home.student.absences.html\'"></div> <div ng-if="sessionStudentId" ng-include="\'home/home.student.lastResults.html\'"></div> <div ng-if="sessionStudentId" ng-include="\'home/home.student.remarks.html\'"></div> <div ng-if="sessionStudentId" ng-include="\'home/home.student.declaredSubjects.html\'"></div> </div> <div ng-if="sessionStudentId" id="column-2" flex-gt-md="50" flex="100"> </div> </div> </div> <div ng-if="!state.currentUser" class="schoolList"> <div ng-if="siteMessages.length > 0"> <md-whiteframe ng-repeat="msg in siteMessages" class="md-whiteframe-1dp attention-whiteframe" flex="100" layout layout-align="left center"> <div layout layout-align="left center"> <md-icon md-colors="{color: \'warn\'}" md-font-set="material-icons" style="margin-top: 0 !important">info_outline</md-icon> <span layout="column" layout-align="start start"> <p style="margin: 0; text-align: left" md-colors="{color: \'warn\'}">{{msg.title}} <a ng-click="msg.showContent = !msg.showContent">{{msg.showContent ? \'main.button.hide\' : \'main.button.view\' | translate}}</a></p> <p style="margin: 0; text-align: left; white-space: pre-line" ng-if="msg.showContent" ng-bind-html="linkify(msg.content)"></p> </span> </div> </md-whiteframe> </div> <md-grid-list md-cols="1" md-cols-sm="2" md-cols-md="3" md-cols-gt-md="6" md-row-height-gt-md="1:1" md-row-height="4:3" md-gutter="24px" md-gutter-gt-sm="24px"> <md-grid-tile ng-repeat="school in schools" md-colspan="1"> <button class="schoolTileButton" ng-click="openSchoolCurriculumSearch(school.id)"> <img class="schoolTileImage" ng-src="data:image/JPEG;base64,{{school.logo}}" on-error-src="images/HITSA_innov_logo_03.4e2f45c0.png"> <md-grid-tile-footer class="schoolTileFooter"> <span>{{currentLanguageNameField(school)}}</span> </md-grid-tile-footer> </button> </md-grid-tile> </md-grid-list> </div> </div> <style>pre {\r\n    white-space: pre-wrap;       /* Since CSS 2.1 */\r\n    white-space: -moz-pre-wrap;  /* Mozilla, since 1999 */\r\n    white-space: -pre-wrap;      /* Opera 4-6 */\r\n    white-space: -o-pre-wrap;    /* Opera 7 */\r\n    word-wrap: break-word;       /* Internet Explorer 5.5+ */\r\n  }\r\n\r\n  #column-1 .md-button, #column-2 .md-button {\r\n    min-width: 44px;\r\n    float: right;\r\n  }\r\n\r\n  .attention-whiteframe {\r\n    box-shadow: 0px 1px 3px 0px rgba(0, 0, 0, 0.2), 0px 1px 1px 0px rgba(0, 0, 0, 0.14), 0px 2px 1px -1px rgba(0, 0, 0, 0.12) !important;\r\n  }</style>'),a.put("home/home.student.absences.html",'<hois-collapsable class="hois-collapse2" expanded="true" ng-if="studentAbsences.length > 0"> <hois-collapsable-header> <span>{{\'home.student.absences\' | translate}}</span> </hois-collapsable-header> <md-table-container> <table md-table class="absence-table"> <tbody md-body> <tr md-row class="header"> <td md-cell>{{\'academicCalendar.date\' | translate}}</td> <td md-cell>{{\'home.student.absence.beingLate\' | translate}}</td> <td md-cell>{{\'home.student.absence.absences\' | translate}}</td> <td md-cell></td> </tr> </tbody> <tbody md-body ng-repeat-start="(key, group) in absenceGroups" ng-click="openCloseDetails(group)" style="cursor:pointer"> <tr md-row> <td md-cell>{{key || \'-\'}}</td> <td md-cell class="sub-header">{{group.PUUDUMINE_H}}</td> <td md-cell class="sub-header">{{group.PUUDUMINE_P}}</td> <td md-cell> <md-button style="margin: 0"> <md-icon md-font-set="material-icons md-dark"> {{group.clicked ? "keyboard_arrow_up" : "keyboard_arrow_down"}} </md-icon> </md-button> </td> </tr> </tbody> <tbody md-body ng-repeat-end ng-show="group.clicked"> <tr class="add-info" md-row ng-repeat="absence in group | orderBy: [\'lessonNrStart\', \'lessonNrEnd\']" ng-init="$last && pageLoadingHandler.setFinish(\'studentAbsences\')"> <td md-cell ng-if="absence.lessonNrStart && !absence.lessonNrEnd">{{absence.lessonNrStart}}. {{\'home.student.lesson\' | translate}}</td> <td md-cell ng-if="absence.lessonNrStart && absence.lessonNrEnd">{{absence.lessonNrStart}} - {{absence.lessonNrEnd}}. {{\'home.student.lesson\' | translate}}</td> <td md-cell ng-if="!absence.lessonNrStart && !absence.lessonNrEnd"></td> <td md-cell>{{absence.absenceCode === \'PUUDUMINE_H\' ? absence.journalName : ""}}</td> <td md-cell>{{absence.absenceCode === \'PUUDUMINE_P\' ? absence.journalName : ""}}</td> <td md-cell></td> </tr> </tbody> </table> </md-table-container> </hois-collapsable> <!-- <span ng-show="pageLoadingHandler.setFinish(\'studentAbsences\') && false"></span> --> <style>table.absence-table tr.header > td {\r\n        font-size: 15px !important;\r\n        font-style: normal;\r\n        font-weight: normal;\r\n        color: #ADADAD !important;\r\n    }\r\n    table.absence-table tr.add-info > td {\r\n        font-weight: bold;\r\n    }\r\n    table.absence-table td {\r\n        max-width: 35%;\r\n        text-align: center !important;\r\n    }\r\n    table.absence-table td.sub-header {\r\n        color: #0D47A1 !important;\r\n    }\r\n    table.absence-table td:first-child {\r\n        width: 15% !important;\r\n        text-align: start !important;\r\n    }\r\n    table.absence-table td:last-child {\r\n        width: 15% !important;\r\n        text-align: end !important;\r\n    }</style>'),a.put("home/home.student.declaredSubjects.html",'<hois-collapsable class="hois-collapse2" expanded="true" ng-if="declaration.status"> <hois-collapsable-header> <span>{{\'home.student.declaredSubjects\' | translate}}</span> </hois-collapsable-header> <md-table-container> <table md-table> <thead md-head> <tr md-row> <th md-column>{{\'declaration.subject\' | translate}}</th> <th md-column>{{\'declaration.teacher\' | translate}}</th> <th md-column>{{\'studyMaterial.label\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="subject in declaration.subjects | orderBy: \'subject.\' + currentLanguageNameField()" ng-class-odd="\'odd\'" ng-class-even="\'even\'" ng-init="$last && pageLoadingHandler.setFinish(\'declaration\')"> <td md-cell> <a href="#/subject/{{subject.subject.id}}"> {{currentLanguageNameField(subject.subject)}} ({{subject.subject.code}}) <span ng-show="subject.isDeclaredRepeatedly">&nbsp;*</span> </a> </td> <td md-cell> <table> <tr ng-repeat="program in subject.programs | orderBy: \'teacherName\'"> <td>{{program.teacherName}} <span ng-if="program.id !== -1 && program.publicStudent">(<a href="#/subjectProgram/public/{{program.id}}/view">{{\'declaration.seeProgram\' | translate}}</a>)</span> </td> </tr> </table> </td> <td md-cell><a ng-href="/#/studyMaterial/higher/{{subject.subjectStudyPeriod}}/view">{{\'studyMaterial.openfolder\' | translate}}</a></td> </tr> </tbody> </table> </md-table-container> </hois-collapsable> <!-- <span ng-show="pageLoadingHandler.setFinish(\'declaration\') && false"></span> -->'),a.put("home/home.student.expiringOccupationStandards.html",'<hois-collapsable expanded="true" class="hois-collapse2" ng-if="expiringOccupationStandards && expiringOccupationStandards.length > 0" label="(\'home.expiringOccupationStandards.title\' | translate)" link="(numberOfOccupationStandards? \'main.button.view\' : \'main.button.hide\')|translate" action="toggleNumberOfOccupationStandards()" ngif="expiringOccupationStandards && expiringOccupationStandards.length > 3"> <!--span ng-if="expiringOccupationStandards && expiringOccupationStandards.length > 3">\r\n    <md-button class="md-primary" ng-click="toggleNumberOfOccupationStandards()">{{(numberOfOccupationStandards? \'main.button.view\' : \'main.button.hide\')|translate}}</md-button>\r\n  </span--> <!--md-content>\r\n    <md-list>\r\n      <md-list-item class="md-3-line" ng-repeat="row in expiringOccupationStandards | limitTo:numberOfOccupationStandards">\r\n        <div class="md-list-item-text" layout="row" flex>\r\n          <div flex="40">{{::currentLanguageNameField(row)}}</div>\r\n          <div flex="20">{{::row.validThru | hoisDate}}</div>\r\n          <div flex="40">{{\'home.expiringOccupationStandards.curriculum\' | translate}}&nbsp;{{::row.curriculums.join(\', \')}}</div>\r\n        </div>\r\n        <md-divider></md-divider>\r\n      </md-list-item>\r\n    </md-list>\r\n  </md-content--> <md-table-container> <table md-table> <tbody md-body> <tr md-row ng-repeat="row in expiringOccupationStandards | limitTo:numberOfOccupationStandards" ng-init="$last && pageLoadingHandler.setFinish(\'expiringOccupationStandards\')"> <td md-cell width="40%">{{::currentLanguageNameField(row)}}</td> <td md-cell width="10%">{{::row.validThru | hoisDate}}</td> <td md-cell>{{\'home.expiringOccupationStandards.curriculum\' | translate}}&nbsp;{{::row.curriculums.join(\', \')}}</td> </tr> </tbody> </table> </md-table-container> </hois-collapsable> <!-- <span ng-show="pageLoadingHandler.setFinish(\'expiringOccupationStandards\') && false"></span> -->'),a.put("home/home.student.generalMessages.html",'<hois-collapsable class="hois-collapse2" ng-show="showGeneralMessages" label="(\'home.generalmessages\' | translate)" expanded="true"> <md-table-container> <table md-table md-progress="generalmessages.$promise"> <tbody md-body> <tr md-row ng-repeat-start="row in generalmessages.content" ng-click="openCloseDetails(row)" aria-label="{{row.clicked ? \'main.button.hide\' : \'main.button.view\' | translate}}" ng-style="{\'cursor\': row.content ? \'pointer\' : \'default\'}" ng-init="$last && pageLoadingHandler.setFinish(\'generalMessages\')"> <td md-cell width="10%">{{::row.inserted | hoisDate}}</td> <td md-cell width="90%"> <p style="color: rgb(13, 71, 161)">{{::row.title}}</p> </td> <td md-cell> <md-button style="margin: 0" ng-if="row.content"> <md-icon md-font-set="material-icons md-dark"> {{row.clicked ? "keyboard_arrow_up" : "keyboard_arrow_down"}} </md-icon> </md-button> </td> </tr> <tr ng-repeat-end ng-show="row.clicked"> <td style="border: none" class="disableTableData"></td> <td md-cell style="border: none" colspan="3" class="noPadding"> <pre class="paddingLeft-24" style="width: 100%">{{::row.content}}</pre> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[5, 10, 15]" ng-if="generalmessages.totalElements > criteria.size" md-page="criteria.page" md-total="{{generalmessages.totalElements}}" md-on-paginate="loadGeneralMessages" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </hois-collapsable> <!-- <span ng-show="pageLoadingHandler.setFinish(\'generalMessages\') && false"></span> -->'),a.put("home/home.student.group.remarks.html",'<hois-collapsable class="hois-collapse2" expanded="true" ng-if="studentGroupRemarks.length > 0"> <hois-collapsable-header> <span>{{\'home.todaysRemarks\' | translate}}</span> </hois-collapsable-header> <md-table-container> <table md-table> <tbody md-body> <tr md-row ng-repeat="row in studentGroupRemarks | orderBy: [\'-remarkTime\']" ng-init="$last && pageLoadingHandler.setFinish(\'studentGroupRemarks\')"> <td md-cell width="10%">{{row.remarkDate | hoisDate}} {{row.remarkTime | hoisTime}}</td> <td md-cell width="20%">{{currentLanguageNameField(row.student)}}</td> <td md-cell width="70%"> <span>{{row.remark}}</span> <i>(<span>{{row.remarkInsertedBy}}</span><span ng-if="row.journal"> - {{currentLanguageNameField(row.journal)}}</span>)</i> </td> </tr> </tbody> </table> </md-table-container> </hois-collapsable>'),a.put("home/home.student.homeworkAndTests.html",'<hois-collapsable class="hois-collapse2" expanded="true" ng-show="tasks.todayTasks.length > 0 || tasks.tomorrowTasks.length > 0 || tasks.laterTasks.length > 0"> <hois-collapsable-header> <span>{{\'home.student.homeworkAndTests\' | translate}}</span> </hois-collapsable-header> <md-table-container> <table md-table> <tbody md-body> <!-- Today --> <tr md-row ng-if="tasks.todayTasks.length > 0" ng-repeat="task in tasks.todayTasks" ng-init="$last && tasks.tomorrowTasks.length === 0 && pageLoadingHandler.setFinish(\'studentTasks\')"> <td md-cell width="10%">{{\'home.student.today\' | translate}} {{todaysDate | hoisDate}}</td> <td md-cell> <span style="font-weight:bold">{{task.journalName}}: </span><br> <hois-value value="(testTaskTypes.indexOf(task.entryType) !== -1 ? (\'home.student.test\' | translate) : (\'home.student.homework\' | translate)) + \' - \' + task.taskContent"></hois-value> </td> </tr> <!-- Tomorrow --> <tr md-row ng-if="tasks.tomorrowTasks.length > 0" ng-repeat="task in tasks.tomorrowTasks" ng-init="$last && tasks.laterTasks.length === 0 && pageLoadingHandler.setFinish(\'studentTasks\')"> <td md-cell width="10%">{{\'home.student.tomorrow\' | translate}} {{tomorrowsDate | hoisDate}}</td> <td md-cell> <span style="font-weight:bold">{{task.journalName}}: </span><br> <hois-value value="(testTaskTypes.indexOf(task.entryType) !== -1 ? (\'home.student.test\' | translate) : (\'home.student.homework\' | translate)) + \' - \' + task.taskContent"></hois-value> </td> </tr> <!-- Later --> <tr md-row ng-if="tasks.laterTasks.length > 0" ng-repeat="task in tasks.laterTasks" ng-init="$last && pageLoadingHandler.setFinish(\'studentTasks\')"> <td md-cell width="10%">{{task.date | hoisDate}}</td> <td md-cell> <span style="font-weight:bold">{{task.journalName}}: </span><br> <hois-value value="(testTaskTypes.indexOf(task.entryType) !== -1 ? (\'home.student.test\' | translate) : (\'home.student.homework\' | translate)) + \' - \' + task.taskContent"></hois-value> </td> </tr> </tbody> </table> </md-table-container> </hois-collapsable>'),a.put("home/home.student.lastResults.html",'<hois-collapsable class="hois-collapse2" expanded="true" ng-if="lastResults.length > 0"> <hois-collapsable-header> <span>{{\'home.student.lastResults\' | translate}}</span> </hois-collapsable-header> <md-table-container> <table md-table> <tbody md-body> <tr md-row ng-if="result.entryCode" ng-repeat="result in lastResults" ng-init="$last && pageLoadingHandler.setFinish(\'lastResults\')"> <td md-cell width="10%"> {{result.gradeInserted | hoisDateTimeMin}} </td> <td md-cell width="85%"> <span style="font-weight: bold"> {{result.nameEt}} <md-tooltip ng-if="result.content || result.addInfo" hide-sm md-direction="bottom">{{result.content}}{{ result.content && result.addInfo ? " - ": ""}}{{result.addInfo}}</md-tooltip> </span> <span hide-gt-sm ng-if="result.content" style="font-style: italic"><br>({{result.content}})</span> <span hide-gt-sm ng-if="result.addInfo"><br>{{result.addInfo}}</span> </td> <td md-cell ng-class="{goodGrade: result.grade === \'5\', badGrade: result.grade === \'2\'}" style="font-weight: bold"> {{result.grade}} </td> </tr> <tr md-row ng-if="!result.entryCode" ng-repeat="result in lastResults" ng-init="$last && pageLoadingHandler.setFinish(\'lastResults\')"> <td md-cell width="10%"> {{result.gradeInserted | hoisDateTimeMin}} </td> <td md-cell width="85%"> <span style="font-weight: bold">{{currentLanguageNameField(result)}}</span> </td> <td md-cell ng-class="{goodGrade: result.grade === \'5\', badGrade: result.grade === \'2\'}" style="font-weight: bold"> {{result.grade}} </td> </tr> </tbody> </table> </md-table-container> </hois-collapsable> <!-- <span ng-show="pageLoadingHandler.setFinish(\'lastResults\') && false"></span> --> <style>.goodGrade {\r\n        color: green !important;\r\n        font-weight: 500;\r\n        font-size: 105% !important;\r\n    }\r\n\r\n    .badGrade {\r\n        color: red !important;\r\n        font-weight: 500;\r\n        font-size: 105% !important;\r\n    }</style>'),a.put("home/home.student.remarks.html",'<hois-collapsable class="hois-collapse2" expanded="true" ng-if="remarks.length > 0"> <hois-collapsable-header> <span>{{\'home.student.remarks\' | translate}}</span> </hois-collapsable-header> <md-table-container> <table md-table> <tbody md-body> <tr md-row ng-repeat="row in remarks" ng-init="$last && pageLoadingHandler.setFinish(\'remarks\')"> <td md-cell width="10%">{{row.remarkDate | hoisDate}} {{row.remarkTime | hoisTime}}</td> <td md-cell width="90%"> <span>{{row.remark}}</span> <i>(<span>{{row.remarkInsertedBy}}</span><span ng-if="row.journal"> - {{currentLanguageNameField(row.journal)}}</span>)</i> </td> </tr> </tbody> </table> </md-table-container> </hois-collapsable>'),a.put("home/home.student.unreadMessages.html",'<hois-collapsable expanded="true" class="hois-collapse2" ng-show="showUnreadMessages && unreadMessages.content.length > 0" label="(\'message.messages\' | translate)"> <!--h5 ng-show="showUnreadMessages" ng-if="unreadMessages.content.length === 0">{{\'message.noNewMessages\' | translate}}</h5--> <md-table-container ng-show="showUnreadMessages"> <table md-table md-progress="unreadMessages.$promise"> <tbody md-body> <tr md-row ng-repeat-start="row in unreadMessages.content" ng-click="readMessage(row)" ng-style="{\'cursor\': row.content ? \'pointer\' : \'default\'}" ng-init="$last && pageLoadingHandler.setFinish(\'unreadMessages\')"> <td md-cell width="10%">{{::row.dateSent | hoisDateTime}}</td> <td md-cell width="75%"><p style="color: rgb(13, 71, 161)">{{::row.subject}}</p></td> <td md-cell> <md-button style="margin: 0" ng-if="row.content"> <md-icon md-font-set="material-icons md-dark"> {{row.clicked ? "keyboard_arrow_up" : "keyboard_arrow_down"}} </md-icon> </md-button> </td> </tr> <tr ng-repeat-end ng-show="row.clicked"> <td style="border: none"></td> <td md-cell style="border: none"> <div> <pre>{{::row.content}}</pre> <p>{{\'message.messageSender\' | translate}}: {{::row.sender}}</p> </div> <md-button class="md-primary btn-respond" ng-href="/#/message/{{row.id}}/respond?backUrl=home" ng-if="row.sendersId !== -1"> {{\'message.respond\' | translate}} </md-button> </td> </tr> </tbody> </table> </md-table-container> </hois-collapsable> <!-- <span ng-show="pageLoadingHandler.setFinish(\'unreadMessages\') && false"></span> --> <style>.btn-respond {\r\n        margin: 5px 0 !important;\r\n        float: left;\r\n    }</style>'),a.put("journal/journal.addEntry.dialog.html",'<md-dialog aria-label="add entry dialog" flex="80"> <form name="dialogForm" ng-submit="loadData()" novalidate ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2 flex>{{journalEntry.id === undefined || journalEntry.id === null ? "journal.entry.new" : "journal.entry.edit" | translate}} - {{journal.nameEt}}</h2> <span flex></span> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <div class="md-dialog-content"> <div flex> <div ng-if="journalEntry.id"> <md-whiteframe class="md-whiteframe-1dp attention-whiteframe" flex="100" layout layout-align="left center"> <div md-colors="{color: \'default-warn\'}"> <md-icon md-colors="{color: \'default-warn\'}" md-font-set="material-icons">info_outline</md-icon> <span>{{\'journal.entry.changingDateAndStartLessonWarning\' | translate}}</span> </div> </md-whiteframe> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container ng-if="journalEntry.entryType !== \'SISSEKANNE_O\'" flex="45"> <label>{{\'journal.entry.type\' | translate}}</label> <hois-classifier-select ng-model="journalEntry.entryType" model-value-attr="code" main-classifier-code="SISSEKANNE" required ng-change="setJournalEntryTypeChanged(journalEntry.entryType)" filter-values="forbiddenEntryTypes"></hois-classifier-select> </md-input-container> <md-input-container ng-if="journalEntry.entryType === \'SISSEKANNE_O\'" flex="45"> <label>{{\'journal.entry.type\' | translate}}</label> <hois-classifier-select ng-model="journalEntry.entryType" model-value-attr="code" main-classifier-code="SISSEKANNE" disabled></hois-classifier-select> </md-input-container> <md-input-container flex="45" flex-offset="10"> <label>{{\'journal.entry.name\' | translate}}</label> <input type="text" ng-model="journalEntry.nameEt" md-maxlength="100"> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container layout="row" layout-align="start center" flex> <md-checkbox ng-repeat="type in capacityTypes" ng-model="selectedCapacityTypes[type.code]">{{currentLanguageNameField(type)}}</md-checkbox> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="20"> <label>{{\'journal.entry.selectDate\' | translate}}</label> <hois-select ng-model="entryDateSelect" values="lessonPlanDates" ng-change="entryDateCalendar = undefined;journalEntry.entryDate = entryDateSelect; entryDateChanged(entryDateSelect)" ng-required="journalEntry.entryType === \'SISSEKANNE_T\' && entryDateCalendar === undefined"></hois-select> </md-input-container> <div layout="row" layout-align="center" style="padding-top:8px" flex="5"> <span>{{\'main.or\' | translate}}</span> </div> <md-input-container flex="25"> <label>{{\'journal.entry.selectFromCalendar\' | translate}}</label> <md-datepicker ng-model="entryDateCalendar" md-open-on-focus ng-change="entryDateSelect = undefined;journalEntry.entryDate = entryDateCalendar; entryDateChanged(entryDateCalendar)" ng-required="journalEntry.entryType === \'SISSEKANNE_T\' && entryDateSelect === undefined"></md-datepicker> </md-input-container> <md-input-container flex="20" flex-offset="5"> <label>{{\'journal.entry.startLessonNr\' | translate}}</label> <hois-select ng-model="journalEntry.startLessonNr" values="lessons" ng-change="startLessonNrChanged()" ng-required="journalEntry.entryType === \'SISSEKANNE_T\'"></hois-select> </md-input-container> <md-input-container flex="20" flex-offset="5"> <label>{{\'journal.entry.lessons\' | translate}}</label> <hois-select ng-model="journalEntry.lessons" values="lessons" ng-change="lessonsChanged()" ng-required="journalEntry.entryType === \'SISSEKANNE_T\'"></hois-select> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex> <label>{{\'journal.entry.content\' | translate}}</label> <textarea ng-model="journalEntry.content" md-maxlength="10000" max-rows="2"></textarea> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="70"> <label>{{\'journal.entry.homework\' | translate}}</label> <textarea ng-model="journalEntry.homework" md-maxlength="10000" max-rows="2"></textarea> </md-input-container> <md-input-container flex flex-offset="5"> <label>{{\'journal.entry.homeworkDuedate\' | translate}}</label> <md-datepicker ng-model="journalEntry.homeworkDuedate" md-open-on-focus ng-required="!!journalEntry.homework"></md-datepicker> </md-input-container> </div> </div> <div layout-padding> <div flex> <md-table-container> <table md-table> <thead md-head> <tr md-row flex> <th md-column><span>{{\'main.nr\' | translate}}</span></th> <th md-column><span>{{\'student.label\' | translate}}, {{\'journal.studentGroup\' | translate}}</span></th> <th md-column ng-if="journalEntry.lessons > 1"><span>{{\'journal.entry.student.lessonAbsences\' | translate}}</span></th> <th md-column><span>{{\'journal.entry.student.absenceValues\' | translate}}</span></th> <th md-column><span>{{\'journal.entry.student.grade\' | translate}}</span></th> <th md-column><span>{{\'journal.entry.student.description\' | translate}}</span></th> <th md-column><span>{{\'journal.entry.student.remark\' | translate}}</span></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in journalStudents track by $index" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{$index + 1}}</td> <td md-cell> <i> <span ng-if="row.status === \'OPPURSTAATUS_A\'">{{\'student.statuses.academicLeaveShort\' | translate}}</span> <span ng-if="row.status === \'OPPURSTAATUS_L\'">{{\'student.statuses.finishedShort\' | translate}}</span> <span ng-if="row.status === \'OPPURSTAATUS_K\'">{{\'student.statuses.exmatriculatedShort\' | translate}}</span> <span ng-if="row.isIndividualCurriculum"> <span ng-if="row.status !== \'OPPURSTAATUS_O\' && row.status !== \'OPPURSTAATUS_V\'">, </span> <span>{{\'student.statuses.individualCurriculumShort\' | translate}}</span> </span> </i> <span>{{::row.fullname}}, {{row.studentGroup}}</span> </td> <td md-cell ng-if="journalEntry.lessons > 1"> <md-input-container> <md-checkbox class="journal-lesson-absence" ng-model="journalEntryStudents[row.id].isLessonAbsence" aria-label="{{\'journal.showAbsenceLessons\' | translate}}" ng-change="journalEntryStudentChanged(row)" ng-disabled="!row.canEdit"></md-checkbox> <md-tooltip>{{\'journal.showAbsenceLessons\' | translate}}</md-tooltip> </md-input-container> </td> <td md-cell> <span layout="row" ng-if="!journalEntryStudents[row.id].isLessonAbsence"> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container ng-if="hasSavedWholeDayAcceptedAbsence(row)"> <md-checkbox ng-if="journalEntryStudents[row.id].practice" ng-model="journalEntryStudents[row.id].practice" aria-label="PUUDUMINE_PR" disabled> {{absenceOptions["PUUDUMINE_PR"].value}} </md-checkbox> <md-checkbox ng-if="journalEntryStudents[row.id].excused" ng-model="journalEntryStudents[row.id].excused" aria-label="PUUDUMINE_V" disabled> {{absenceOptions["PUUDUMINE_V"].value}} </md-checkbox> </md-input-container> <md-input-container ng-if="!hasSavedWholeDayAcceptedAbsence(row)" layout="row" layout-align="start center" flex> <md-checkbox ng-model="journalEntryStudents[row.id].late" aria-label="PUUDUMINE_H" ng-disabled="!row.canEdit" ng-change="journalEntryStudentAbsenceChanged(row, journalEntryStudents[row.id].late, \'PUUDUMINE_H\')"> {{absenceOptions["PUUDUMINE_H"].value}} </md-checkbox> <md-checkbox ng-model="journalEntryStudents[row.id].withoutReason" aria-label="PUUDUMINE_P" ng-disabled="!row.canEdit" style="margin-left: 30px" ng-change="journalEntryStudentAbsenceChanged(row, journalEntryStudents[row.id].withoutReason, \'PUUDUMINE_P\')"> {{absenceOptions["PUUDUMINE_P"].value}} </md-checkbox> </md-input-container> </div> </span> <span ng-if="journalEntryStudents[row.id].isLessonAbsence" ng-repeat="lesson in [].constructor(journalEntry.lessons) track by $index"> <div layout="row" layout-align="space-between start" style="width: 150px; min-width: 150px"> <md-input-container ng-if="hasAcceptedLessonAbsence(row, lessonNr)"> <md-checkbox ng-if="journalEntryStudents[row.id].lessonAbsences[lessonNr].excused" ng-model="journalEntryStudents[row.id].lessonAbsences[lessonNr].excused" aria-label="PUUDUMINE_V" disabled> {{absenceOptions["PUUDUMINE_V"].value}} </md-checkbox> <md-checkbox ng-if="journalEntryStudents[row.id].lessonAbsences[lessonNr].practice" ng-model="journalEntryStudents[row.id].lessonAbsences[lessonNr].practice" aria-label="PUUDUMINE_PR" disabled> {{absenceOptions["PUUDUMINE_PR"].value}} </md-checkbox> </md-input-container> <div ng-if="!hasAcceptedLessonAbsence(row, lessonNr)"> <span ng-if="journalEntryStudents[row.id].hasWholeDayAcceptedAbsence"> <md-input-container ng-if="!journalEntryStudents[row.id].lessonAbsences[lessonNr].absence"> <md-checkbox ng-if="journalEntryStudents[row.id].wholeDayAbsenceCode === \'PUUDUMINE_V\'" aria-label="PUUDUMINE_V" ng-model="journalEntryStudents[row.id].lessonAbsences[lessonNr].excused" ng-disabled="!row.canEdit" ng-change="journalEntryStudentAbsenceChanged(row, journalEntryStudents[row.id].lessonAbsences[lessonNr].excused, \'PUUDUMINE_V\', lessonNr)"> {{absenceOptions["PUUDUMINE_V"].value}} </md-checkbox> <md-checkbox ng-if="journalEntryStudents[row.id].wholeDayAbsenceCode === \'PUUDUMINE_PR\'" aria-label="PUUDUMINE_PR" ng-model="journalEntryStudents[row.id].lessonAbsences[lessonNr].practice" ng-disabled="!row.canEdit" ng-change="journalEntryStudentAbsenceChanged(row, journalEntryStudents[row.id].lessonAbsences[lessonNr].practice, \'PUUDUMINE_PR\', lessonNr)"> {{absenceOptions["PUUDUMINE_PR"].value}} </md-checkbox> </md-input-container> <!-- groupAbsence form allows all absence types even if whole day has accepted absence and lesson absence should be of that type --> <md-input-container ng-if="journalEntryStudents[row.id].lessonAbsences[lessonNr].absence" layout="row" layout-align="start center" flex> <md-checkbox ng-if="journalEntryStudents[row.id].lessonAbsences[lessonNr].late" ng-model="journalEntryStudents[row.id].lessonAbsences[lessonNr].late" ng-change="journalEntryStudentAbsenceChanged(row, journalEntryStudents[row.id].lessonAbsences[lessonNr].late, \'PUUDUMINE_H\', lessonNr)" aria-label="PUUDUMINE_H" ng-disabled="!row.canEdit">{{absenceOptions["PUUDUMINE_H"].value}}</md-checkbox> <md-checkbox ng-if="journalEntryStudents[row.id].lessonAbsences[lessonNr].withoutReason" ng-model="journalEntryStudents[row.id].lessonAbsences[lessonNr].withoutReason" ng-change="journalEntryStudentAbsenceChanged(row, journalEntryStudents[row.id].lessonAbsences[lessonNr].withoutReason, \'PUUDUMINE_P\', lessonNr)" aria-label="PUUDUMINE_P" ng-disabled="!row.canEdit">{{absenceOptions["PUUDUMINE_P"].value}}</md-checkbox> <md-checkbox ng-if="journalEntryStudents[row.id].lessonAbsences[lessonNr].excused" ng-model="journalEntryStudents[row.id].lessonAbsences[lessonNr].excused" ng-change="journalEntryStudentAbsenceChanged(row, journalEntryStudents[row.id].lessonAbsences[lessonNr].excused, \'PUUDUMINE_V\', lessonNr)" aria-label="PUUDUMINE_V" ng-disabled="!row.canEdit">{{absenceOptions["PUUDUMINE_V"].value}}</md-checkbox> <md-checkbox ng-if="journalEntryStudents[row.id].lessonAbsences[lessonNr].practice" ng-model="journalEntryStudents[row.id].lessonAbsences[lessonNr].practice" ng-change="journalEntryStudentAbsenceChanged(row, journalEntryStudents[row.id].lessonAbsences[lessonNr].practice, \'PUUDUMINE_PR\', lessonNr)" aria-label="PUUDUMINE_PR" ng-disabled="!row.canEdit">{{absenceOptions["PUUDUMINE_PR"].value}}</md-checkbox> </md-input-container> </span> <span ng-if="!journalEntryStudents[row.id].hasWholeDayAcceptedAbsence"> <md-input-container ng-if="!journalEntryStudents[row.id].lessonAbsences[lessonNr].absence || \r\n                                journalEntryStudents[row.id].lessonAbsences[lessonNr].late || journalEntryStudents[row.id].lessonAbsences[lessonNr].withoutReason" layout="row" layout-align="start center" flex> <md-checkbox ng-model="journalEntryStudents[row.id].lessonAbsences[lessonNr].late" aria-label="PUUDUMINE_H" ng-disabled="!row.canEdit" ng-change="journalEntryStudentAbsenceChanged(row, journalEntryStudents[row.id].lessonAbsences[lessonNr].late, \'PUUDUMINE_H\', lessonNr)"> {{absenceOptions["PUUDUMINE_H"].value}} </md-checkbox> <md-checkbox ng-model="journalEntryStudents[row.id].lessonAbsences[lessonNr].withoutReason" aria-label="PUUDUMINE_P" ng-disabled="!row.canEdit" style="margin-left: 30px" ng-change="journalEntryStudentAbsenceChanged(row, journalEntryStudents[row.id].lessonAbsences[lessonNr].withoutReason, \'PUUDUMINE_P\', lessonNr)"> {{absenceOptions["PUUDUMINE_P"].value}} </md-checkbox> </md-input-container> <!-- groupAbsence form allows all absence types --> <md-input-container ng-if="journalEntryStudents[row.id].lessonAbsences[lessonNr].excused" layout="row" layout-align="start center" flex> <md-checkbox ng-model="journalEntryStudents[row.id].lessonAbsences[lessonNr].excused" ng-change="journalEntryStudentAbsenceChanged(row, journalEntryStudents[row.id].lessonAbsences[lessonNr].excused, \'PUUDUMINE_V\', lessonNr)" aria-label="PUUDUMINE_V" ng-disabled="!row.canEdit">{{absenceOptions["PUUDUMINE_V"].value}}</md-checkbox> </md-input-container> <md-input-container ng-if="journalEntryStudents[row.id].lessonAbsences[lessonNr].practice" layout="row" layout-align="start center" flex> <md-checkbox ng-model="journalEntryStudents[row.id].lessonAbsences[lessonNr].practice" ng-change="journalEntryStudentAbsenceChanged(row, journalEntryStudents[row.id].lessonAbsences[lessonNr].practice, \'PUUDUMINE_PR\', lessonNr)" aria-label="PUUDUMINE_PR" ng-disabled="!row.canEdit">{{absenceOptions["PUUDUMINE_PR"].value}}</md-checkbox> </md-input-container> </span> </div> <div style="line-height: 25px">({{lessonNr = $index + 1}})</div> </div> </span> </td> <td md-cell> <span ng-if="!journalEntryStudents[row.id].removeStudentHistory" ng-repeat="gradeHistory in journalEntryStudents[row.id].journalEntryStudentHistories | orderBy: \'gradeInserted\'"> {{gradeHistory.grade.value}} <span ng-if="gradeHistory.grade.value && !$last">/</span> </span> &nbsp; <span ng-if="row.canEdit && !(row.apelTransferredFinalResult && journalEntry.entryType === \'SISSEKANNE_L\') && !(journalEntry.moodleGradeItemId && journalEntry.entryType !== \'SISSEKANNE_L\')"> <md-input-container> <hois-select ng-if="gradeInputAsSelect" ng-model="journalEntryStudents[row.id].grade" values="grades" show-property="value" hide-values="hideInvalid" value-property="code" ng-change="journalEntryStudentChanged(row)" aria-label="grade"></hois-select> <input ng-if="!gradeInputAsSelect" ng-model="journalEntryStudents[row.id].gradeValue" style="width: 75px" ng-change="journalEntryStudentChanged(row)" type="text" ng-pattern="gradeInputRegex" aria-label="grade"> </md-input-container> <md-button class="md-icon-button" ng-click="removeStudentHistory(row)"> <md-icon md-font-set="material-icons">delete_forever</md-icon> <md-tooltip>{{\'journal.removeStudentHistory\' | translate}}</md-tooltip> </md-button> </span> <span ng-if="!row.canEdit || (row.apelTransferredFinalResult && journalEntry.entryType === \'SISSEKANNE_L\') || (journalEntry.moodleGradeItemId && journalEntry.entryType !== \'SISSEKANNE_L\')"> <md-input-container> <hois-select ng-model="journalEntryStudents[row.id].grade" values="grades" show-property="value" hide-values="hideInvalid" value-property="code" aria-label="grade" disabled></hois-select> </md-input-container> </span> </td> <td md-cell> <md-input-container class="journal-add-info-input"> <input type="text" ng-model="journalEntryStudents[row.id].addInfo" md-maxlength="1000" ng-change="journalEntryStudentChanged(row)" ng-required="journalEntryStudents[row.id].isRemark" aria-label="additional info" ng-disabled="!row.canEdit"> </md-input-container> </td> <td md-cell> <md-checkbox ng-model="journalEntryStudents[row.id].isRemark" aria-label="remark" ng-disabled="!row.canEdit" ng-change="journalEntryStudentChanged(row)"></md-checkbox> </td> </tr> </tbody> </table> </md-table-container> </div> </div> </div> </md-dialog-content> <span flex></span> <md-dialog-actions layout="row" layout-align="start center"> <md-button class="md-raised md-primary" ng-click="submit()">{{\'main.button.save\' | translate}}</md-button> <md-button ng-if="canDeleteEntries" class="md-raised" ng-click="delete()">{{"main.button.delete" | translate}}</md-button> <md-button class="md-raised" ng-click="cancel()">{{"main.button.close" | translate}}</md-button> </md-dialog-actions> </form> </md-dialog>'),
a.put("journal/journal.apel.results.dialog.html",'<md-dialog aria-label="apel results dialog" flex="50" flex-sm="50" flex-xs="100"> <form name="dialogForm" novalidate ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2>{{journalStudent.fullname}} {{"journal.apelResults.label" | translate}}</h2> <span flex></span> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <div layout-padding> <md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{"journal.apelResults.moduleTheme" | translate}}</th> <th md-column>{{"journal.apelResults.decisionDate" | translate}}</th> <th md-column>{{"journal.apelResults.result" | translate}}</th> <th md-column>{{"journal.apelResults.type" | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in journalStudent.apelResults | orderBy: \'confirmed\'" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{currentLanguageNameField(row.name)}}</td> <td md-cell>{{row.confirmed | hoisDate}}</td> <td md-cell>{{row.grade.value}}</td> <td md-cell>{{row.isFormalLearning ? (\'journal.apelResults.formal\' | translate) : (\'journal.apelResults.informal\' | translate)}}</td> </tr> </tbody> </table> </md-table-container> </div> </md-dialog-content> <span flex></span> <md-dialog-actions layout="row" layout-align="start center"> <md-button class="md-raised" ng-click="cancel()">{{"main.button.close" | translate}}</md-button> </md-dialog-actions> </form> </md-dialog>'),a.put("journal/journal.edit.buttons.tmpl.html",'<div flex> <div layout="row"> <md-button class="md-raised md-primary" ng-click="addNewEntry()">{{\'journal.addNewEntry\' | translate}}</md-button> <md-button class="md-raised" ng-click="searchStudent()">{{\'journal.addStudents\' | translate}}</md-button> <md-button class="md-raised" ng-click="confirm()" ng-if="journal.canBeConfirmed">{{\'journal.confirmJournal\' | translate}}</md-button> <md-button class="md-raised" ng-click="unconfirm()" ng-if="journal.canBeUnconfirmed">{{\'journal.button.unconfirm\' | translate}}</md-button> <a ng-href="{{excel(formState.xlsUrl)}}" target="_blank" class="md-button md-raised">{{\'report.excel\' | translate}}</a> <md-button class="md-raised" ng-click="back(\'#/journals/\', journalForm)">{{\'main.button.back\' | translate}}</md-button> <md-input-container> <span class="common-label">{{\'journal.gradeInput\' | translate}}</span> <md-radio-group layout-gt-sm="row" ng-model="formState.gradeInputAsSelect"> <md-radio-button ng-value="true">{{\'journal.asSelectField\' | translate}}</md-radio-button> <md-radio-button ng-value="false">{{\'journal.asInputField\' | translate}}</md-radio-button> </md-radio-group> </md-input-container> </div> <div layout="row" ng-if="$parent.$parent.moodleCourseId"> <md-button class="md-raised" ng-click="enrollStudents()">{{\'moodle.enrollStudents\' | translate}}</md-button> <md-button class="md-raised" ng-click="importGradeItems()">{{\'moodle.importGradeItems\' | translate}}</md-button> <md-button class="md-raised" ng-click="importAllGrades()">{{\'moodle.importAllGrades\' | translate}}</md-button> <md-button class="md-raised" ng-click="importMissingGrades()">{{\'moodle.importMissingGrades\' | translate}}</md-button> </div> </div>'),a.put("journal/journal.edit.html",'<div layout-padding> <div ng-include="\'journal/journal.edit.buttons.tmpl.html\'"></div> <div flex> <div layout="row" flex> <div flex="50" layout="column" layout-align="start"> <div class="common-label" flex>{{\'journal.absencesLegend\' | translate}}</div> <div class="common-label" flex> <span>{{\'student.statuses.academicLeaveShort\' | translate}} - {{\'student.statuses.academicLeave\' | translate}}, </span> <span>{{\'student.statuses.individualCurriculumShort\' | translate}} - {{\'student.statuses.individualCurriculum\' | translate}}, </span> <span>{{\'student.statuses.exmatriculatedShort\' | translate}} - {{\'student.statuses.exmatriculated\' | translate}}, </span> <span>{{\'student.statuses.finishedShort\' | translate}} - {{\'student.statuses.finished\' | translate}}</span> </div> </div> <div flex="50" layout="row" layout-align="end"> <md-input-container> <md-checkbox ng-model="formState.showAllStudentsModel" aria-label="show all students" ng-change="showAllStudents()"> {{\'journal.showAll\' | translate}} </md-checkbox> </md-input-container> </div> </div> <br> <div ng-include="\'journal/journal.entryType.buttons.tmpl.html\'"></div> <div class="container" fixed-column-table fixed-columns="2" ng-style="{\'overflow-y\': journal.journalStudents.length < 11 ? \'hidden\':\'scroll\'}"> <table class="journalTable"> <thead> <tr flex> <th>{{\'main.nr\' | translate}}</th> <th style="padding-right:11em"><span>{{\'student.label\' | translate}}, {{\'journal.studentGroup\' | translate}}</span></th> <th ng-if="journalEntryTypes[journalEntry.entryType.code]._selected" class="bordered" md-colors="{background: getEntryColor(journalEntry.entryType.code)}" ng-repeat="journalEntry in journal.journalEntriesByDate"> <div layout="row" layout-align="space-between center"> <span ng-if="journalEntry.moodleGradeItemId"><md-icon md-font-set="material-icons">school</md-icon></span> <span class="pointer" style="text-decoration: underline" ng-click="editJournalEntry(journalEntry.id)"> <span ng-if="journalEntry.entryType.code === \'SISSEKANNE_L\'">{{\'journal.finalResult\' | translate}} {{journalEntry.entryDate ? \' - \' + (journalEntry.entryDate | hoisDayMonth) : \'\'}}</span> <span ng-if="journalEntry.entryType.code === \'SISSEKANNE_O\'">{{\'journal.outcome\' | translate}}{{journalEntry.outcomeOrderNr + 1}}</span> <span ng-if="journalEntry.entryType.code !== \'SISSEKANNE_L\' && journalEntry.entryType.code !== \'SISSEKANNE_O\'">{{journalEntry.entryDate ? (journalEntry.entryDate | hoisDayMonth) : \'-\'}}</span> </span> <span style="float: right"> <md-icon ng-if="!journalEntry.quickUpdate" ng-click="quickUpdate(journalEntry)" title="{{\'journal.changeResults\' | translate}}" md-font-set="material-icons">forward_5</md-icon> <md-icon ng-if="journalEntry.quickUpdate" ng-click="saveQuickUpdate(journalEntry)" md-font-set="material-icons" title="{{\'journal.saveQuickUpdate\' | translate}}" md-colors="{color: \'green-500\'}">done</md-icon> <md-icon ng-if="journalEntry.quickUpdate" ng-click="cancelQuickUpdate(journalEntry)" md-font-set="material-icons" title="{{\'journal.cancelQuickUpdate\' | translate}}" md-colors="{color: \'red-500\'}">close</md-icon> </span> <md-tooltip> <span ng-if="journalEntry.startLessonNr"> <span ng-if="!journalEntry.lessons || journalEntry.lessons <= 1">{{journalEntry.startLessonNr}}. {{\'journal.lesson\' | translate}}</span> <span ng-if="journalEntry.lessons && journalEntry.lessons > 1">{{journalEntry.startLessonNr}}. - {{journalEntry.startLessonNr + journalEntry.lessons-1}}. {{\'journal.lesson\' | translate}}</span> ,&nbsp; </span> <span>{{journalEntry.nameEt}}</span> <span>,&nbsp;</span> {{currentLanguageNameField(journalEntry.entryType)}} <span>,&nbsp;</span> {{journalEntry.teacher}} </md-tooltip> </div> </th> <th ng-show="auth.isAdmin()"></th> </tr> </thead> <tbody> <tr ng-repeat="row in journal.journalStudents" ng-class-odd="\'odd\'" ng-class-even="\'even\'" ng-init="$last && finished(false)"> <td width="5%">{{$index + 1}}</td> <td width="10%"> <span> <i> <span ng-if="row.status === \'OPPURSTAATUS_A\'">{{\'student.statuses.academicLeaveShort\' | translate}}</span> <span ng-if="row.status === \'OPPURSTAATUS_L\'">{{\'student.statuses.finishedShort\' | translate}}</span> <span ng-if="row.status === \'OPPURSTAATUS_K\'">{{\'student.statuses.exmatriculatedShort\' | translate}}</span> <span ng-if="row.isIndividualCurriculum"> <span ng-if="row.status !== \'OPPURSTAATUS_O\' && row.status !== \'OPPURSTAATUS_V\'">, </span> <span>{{\'student.statuses.individualCurriculumShort\' | translate}}</span> </span> </i> <a ng-href="/#/students/{{::row.studentId}}/main">{{::row.fullname}}</a>, {{row.studentGroup}} <span ng-if="row.apelResults.length > 0"><a ng-click="openApelResultsDialog(row)">{{\'journal.apel\' | translate}}</a></span> <span ng-if="row.remarks.length > 0" ng-click="openRemarkDialog(row)"><md-icon md-font-set="material-icons">message</md-icon></span> <span ng-if="row.isMoodleRegistered"><md-icon md-font-set="material-icons">school</md-icon></span> </span> </td> <td ng-if="journalEntryTypes[journalEntry.entryType.code]._selected" class="bordered" ng-repeat="journalEntry in journal.journalEntriesByDate"> <div layout="row"> <div layout="row" layout-align="start center" ng-repeat="result in journalEntry.journalStudentResults[row.id] | orderBy: \'gradeInserted\'"> <span ng-if="result.absence"> {{result.absence.value}} <md-tooltip ng-if="result.absence.value" class="tooltip-multiline"> {{result.absenceInserted ? (result.absenceInserted | hoisDate) : (result.inserted | hoisDate)}} <span ng-if="result.addInfo">,&nbsp; {{result.addInfo}} </span> <span ng-if="journalEntry.lessons && result.absence.value === \'P\'"> ,&nbsp; {{journalEntry.lessons ? ((\'journal.entry.lessons\' | translate) + \' \' + journalEntry.lessons) : \'\'}} </span> </md-tooltip> </span> <span ng-if="result.lessonAbsences.length > 0"> <span ng-repeat="lessonAbsence in result.lessonAbsences | orderBy: \'lessonNr\'"> <span>{{lessonAbsence.absence.value}}({{lessonAbsence.lessonNr}})</span> <md-tooltip class="tooltip-multiline"> {{lessonAbsence.absenceInserted | hoisDate}} <span ng-if="result.addInfo">,&nbsp; {{result.addInfo}} </span> </md-tooltip> </span> </span> <span ng-if="(result.absence.value || result.lessonAbsences.length > 0) \r\n                    && (result.journalEntryStudentHistories.length > 0 || (result.grade && !journalEntry.quickUpdate))">/</span> <span ng-repeat="historyResult in result.journalEntryStudentHistories | orderBy: \'gradeInserted\' track by $index"> <span ng-class="{badResult: !gradeUtil.isPositive(historyResult.grade.code)}">{{historyResult.grade.value}}</span> <span>*</span> <span ng-if="!journalEntry.quickUpdate || $index !== result.journalEntryStudentHistories.length - 1"> / </span> <md-tooltip> {{historyResult.gradeInserted | hoisDate}}, &nbsp; {{historyResult.gradeInsertedBy}} </md-tooltip> </span> <span ng-if="!journalEntry.quickUpdate"> <span ng-class="{journalFinalResult: journalEntry.entryType.code === \'SISSEKANNE_L\',\r\n                                    badResult: !gradeUtil.isPositive(result.grade.code)}">{{result.grade.value}}</span> <span ng-if="!result.grade && result.journalEntryStudentHistories.length > 0"> - </span> <md-tooltip ng-if="result.grade.value" class="tooltip-multiline"> {{result.gradeInserted | hoisDate}}, &nbsp; {{result.gradeInsertedBy}} <span ng-if="result.addInfo">,&nbsp;</span> {{result.addInfo}} </md-tooltip> </span> </div> <div ng-if="journalEntry.quickUpdate" layout="row" layout-align="end center" flex> <md-input-container ng-if="formState.gradeInputAsSelect" class="quickUpdateGrade"> <hois-select ng-model="journalEntry.quickUpdateStudents[row.id].grade" values="grades" show-property="value" value-property="code" aria-label="grade" ng-change="quickUpdateGradeChanged(journalEntry, row.id)" hide-values="hideInvalid" ng-disabled="!row.canEdit || (row.apelTransferredFinalResult && journalEntry.entryType.code === \'SISSEKANNE_L\')"></hois-select> </md-input-container> <md-input-container ng-if="!formState.gradeInputAsSelect" class="quickUpdateGradeAsInput"> <input ng-model="journalEntry.quickUpdateStudents[row.id].gradeValue" style="width: 75px" ng-model-options="{ allowInvalid: true}" ng-change="quickUpdateGradeChanged(journalEntry, row.id)" type="text" ng-pattern="gradeInputRegex" aria-label="grade" ng-disabled="!row.canEdit || (row.apelTransferredFinalResult && journalEntry.entryType.code === \'SISSEKANNE_L\')"> </md-input-container> <md-input-container class="quickUpdateAddInfo"> <input type="text" ng-model="journalEntry.quickUpdateStudents[row.id].addInfo" md-maxlength="1000" aria-label="additional info" ng-change="quickUpdateAddInfoChanged(journalEntry, row.id)" ng-disabled="!row.canEdit || (row.apelTransferredFinalResult && journalEntry.entryType.code === \'SISSEKANNE_L\')\r\n                       || journalEntry.quickUpdateStudents[row.id].isRemark"> </md-input-container> </div> </div> </td> <td ng-show="auth.isAdmin()"> <a class="remove nomargin" ng-click="removeStudentFromJournal(row.studentId)">&times;</a> </td> </tr> </tbody> </table> </div> </div> </div> <div layout-padding> <div ng-include="\'journal/journal.entryType.buttons.tmpl.html\'"></div> <div ng-include="\'journal/journal.edit.buttons.tmpl.html\'"></div> </div> <div layout-padding> <div flex> <div layout="row"> <div flex="10"> <h2>{{\'journal.entries\' | translate}}</h2> </div> </div> <md-table-container> <table md-table md-progress="journalEntries.$promise"> <thead md-head md-order="journalEntriesCriteria.order" md-on-reorder="loadJournalEntries"> <tr md-row> <th md-column width="10"></th> <th md-column width="10"></th> <th md-column>{{\'journal.entry.date\' | translate}}</th> <th md-column>{{\'journal.entry.lessons\' | translate}}</th> <th md-column>{{\'journal.entry.nameContent\' | translate}}</th> <th md-column>{{\'journal.entry.homework\' | translate}}</th> <th md-column>{{\'journal.entry.homeworkDuedate\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in journalEntries.content" md-auto-select ng-click="editJournalEntry(row.id)" ng-class-odd="\'odd\'" ng-class-even="\'even\'" md-colors="{background: getEntryColor(row.entryType)}" class="pointer"> <td md-cell><span ng-if="row.moodleGradeItemId"><md-icon md-font-set="material-icons">school</md-icon></span></td> <td md-cell> <a href="#" onclick="return false">{{\'journal.entry.open\' | translate}}</a> </td> <td md-cell>{{row.entryDate ? (row.entryDate | hoisDate) : \'-\'}}</td> <td md-cell>{{row.lessons ? row.lessons : \'-\'}}</td> <td md-cell> <span>{{row.nameEt ? row.nameEt : \'-\'}}</span> <span ng-if="row.nameEt && row.content">/</span> <hois-value value="row.content"></hois-value> </td> <td md-cell> <hois-value value="row.homework ? row.homework : \'-\'"></hois-value> </td> <td md-cell>{{row.homeworkDuedate ? (row.homeworkDuedate | hoisDate) : \'-\' }}</td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="journalEntriesCriteria.size" md-limit-options="[10, 20, 50]" md-page="journalEntriesCriteria.page" md-total="{{journalEntries.totalElements}}" md-on-paginate="loadJournalEntries" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> </div> <div layout-padding> <div flex> <div ng-include="\'studyMaterial/templates/journal.material.edit.tmpl.html\'"></div> </div> </div> <div layout-padding> <hois-collapsable label="(\'journal.curriculumVersionModuleOrThemeDescription\' | translate)" expanded="false"> <div ng-repeat="module in journal.moduleDescriptions | orderBy: [\'-isModule\', currentLanguageNameField()]"> <a class="md-raised small-link" ng-click="moduleDescriptionDialog(module)">{{currentLanguageNameField(module)}}</a> </div> <div ng-repeat="individualCurriculum in journal.individualCurriculums | orderBy: \'fullname\'"> <a class="md-raised small-link" ng-click="individualCurriculumDialog(individualCurriculum)"> {{individualCurriculum.fullname}} - {{\'journal.individualCurriculumDistinction\' | translate}}</a> </div> </hois-collapsable> </div>'),a.put("journal/journal.entryType.buttons.tmpl.html",'<div layout="row" layout-md="column" layout-sm="column" layout-xs="column" flex> <md-checkbox ng-model="journalEntryTypes[\'SISSEKANNE_T\']._selected" ng-change="updateSelectedEntryTypes()" aria-label="SISSEKANNE_T"> <span class="capacity-type-legend" md-colors="{background: getEntryColor(\'SISSEKANNE_T\')}"> {{currentLanguageNameField(journalEntryTypes[\'SISSEKANNE_T\'])}} </span> </md-checkbox> <md-checkbox ng-model="journalEntryTypes[\'SISSEKANNE_E\']._selected" ng-change="updateSelectedEntryTypes()" aria-label="SISSEKANNE_E"> <span class="capacity-type-legend" md-colors="{background: getEntryColor(\'SISSEKANNE_E\')}"> {{currentLanguageNameField(journalEntryTypes[\'SISSEKANNE_E\'])}} </span> </md-checkbox> <md-checkbox ng-model="journalEntryTypes[\'SISSEKANNE_I\']._selected" ng-change="updateSelectedEntryTypes()" aria-label="SISSEKANNE_I"> <span class="capacity-type-legend" md-colors="{background: getEntryColor(\'SISSEKANNE_I\')}"> {{currentLanguageNameField(journalEntryTypes[\'SISSEKANNE_I\'])}} </span> </md-checkbox> <md-checkbox ng-model="journalEntryTypes[\'SISSEKANNE_H\']._selected" ng-change="updateSelectedEntryTypes()" aria-label="SISSEKANNE_H"> <span class="capacity-type-legend" md-colors="{background: getEntryColor(\'SISSEKANNE_H\')}"> {{currentLanguageNameField(journalEntryTypes[\'SISSEKANNE_H\'])}} </span> </md-checkbox> <md-checkbox ng-model="journalEntryTypes[\'SISSEKANNE_P\']._selected" ng-change="updateSelectedEntryTypes()" aria-label="SISSEKANNE_P"> <span class="capacity-type-legend" md-colors="{background: getEntryColor(\'SISSEKANNE_P\')}"> {{currentLanguageNameField(journalEntryTypes[\'SISSEKANNE_P\'])}} </span> </md-checkbox> <md-checkbox ng-model="journalEntryTypes[\'SISSEKANNE_R\']._selected" ng-change="updateSelectedEntryTypes()" aria-label="SISSEKANNE_R"> <span class="capacity-type-legend" md-colors="{background: getEntryColor(\'SISSEKANNE_R\')}"> {{currentLanguageNameField(journalEntryTypes[\'SISSEKANNE_R\'])}} </span> </md-checkbox> <md-checkbox ng-if="journal.moduleOutcomesAsEntries" ng-model="journalEntryTypes[\'SISSEKANNE_O\']._selected" ng-change="updateSelectedEntryTypes()" aria-label="SISSEKANNE_O"> <span class="capacity-type-legend" md-colors="{background: getEntryColor(\'SISSEKANNE_O\')}"> {{currentLanguageNameField(journalEntryTypes[\'SISSEKANNE_O\'])}} </span> </md-checkbox> <md-checkbox ng-model="journalEntryTypes[\'SISSEKANNE_L\']._selected" ng-change="updateSelectedEntryTypes()" aria-label="SISSEKANNE_L"> <span class="capacity-type-legend" md-colors="{background: getEntryColor(\'SISSEKANNE_L\')}"> {{currentLanguageNameField(journalEntryTypes[\'SISSEKANNE_L\'])}} </span> </md-checkbox> </div>'),a.put("journal/journal.html",'<div class="ois-form-layout-padding" ng-cloak> <div flex> <form name="journalForm" ng-submit="journalForm.$valid && loadData()" novalidate> <div class="form-readonly" layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="25" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'journal.studyYear\' | translate}}</label> <hois-classifier-value ng-model="journal.studyYear" main-classifier-code="OPPEAASTA"></hois-classifier-value> </md-input-container> <md-input-container flex="30" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label class="textInput">{{\'main.status\' | translate}}</label> <hois-classifier-value ng-model="journal.status" main-classifier-code="PAEVIK_STAATUS"></hois-classifier-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <div class="form-readonly" layout="row" flex="25" flex-sm="100" flex-xs="100"> <md-input-container flex> <label class="textInput">{{\'journal.label\' | translate}}</label> <hois-value value="journal.nameEt"></hois-value> </md-input-container> </div> <div ng-if="journal.canBeConfirmed" flex="30" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <md-input-container style="margin-top:-1em"> <label>{{\'journal.endDate\' | translate}}</label> <md-datepicker ng-model="journal.endDate" md-min-date="journal.studyYearStartDate"></md-datepicker> </md-input-container> <a href="" class="md-button md-raised" style="margin-top:-1em" ng-click="saveEndDate()">{{\'journal.saveEndDate\' | translate}}</a> </div> <div ng-if="!journal.canBeConfirmed" class="form-readonly" flex="30" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <md-input-container style="width: 100%"> <label>{{\'journal.endDate\' | translate}}</label> <hois-value value="journal.endDate | hoisDate"></hois-value> </md-input-container> </div> </div> <div class="form-readonly" layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="25" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'journal.studentGroups\' | translate}}</label> <hois-value value="journal.studentGroups.join(\', \')"></hois-value> </md-input-container> <md-input-container flex="30" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label class="textInput">{{auth.higher ? (\'journal.teachersHigher\' | translate) : (\'journal.teachersVocational\' | translate)}}</label> <hois-value value="journal.journalTeachers.join(\', \')"></hois-value> </md-input-container> </div> <div class="form-readonly" layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="25" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'journal.modules\' | translate}}</label> <hois-value value="showModuleNames(journal.curriculumModules)"></hois-value> </md-input-container> <md-input-container flex="30" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label class="textInput">{{\'journal.plannedAndEnteredLessonsCount\' | translate}}</label> <hois-value value="journal.lessonHours.totalPlannedHours + \'/\' + journal.lessonHours.totalUsedHours"></hois-value> </md-input-container> </div> <div ng-if="journal.canEdit" class="form-readonly" layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="25" flex-sm="100" flex-xs="100"> <label>{{\'journal.assessment\' | translate}}</label> <hois-classifier-value ng-model="journal.assessment" main-classifier-code="KUTSEHINDAMISVIIS"></hois-classifier-value> </md-input-container> <md-input-container class="md-input-has-value" flex="30" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label class="textInput">{{\'journal.capacitiesPlannedAndEnteredLessonsCount\' | translate}}</label> <div class="md-body-1"> <span ng-repeat="type in journal.lessonHours.capacityHours | orderBy: \'capacity\'"> <span>{{capacityTypes[type.capacity].value.toUpperCase()}}:</span> <span>{{type.plannedHours + \'/\' + type.usedHours}}</span> </span> </div> </md-input-container> </div> <div ng-if="journal.canEdit" layout="row"> <div flex="100"> <md-input-container> <label>{{\'moodle.courseId\' | translate}}</label> <input type="number" name="moodleCourseId" ng-model="journal.moodleCourseId" max="9007199254740991"> <div class="md-errors-spacer"> <div class="md-char-counter">{{journalForm.moodleCourseId.$viewValue ? journalForm.moodleCourseId.$viewValue.length : 0}} / 16</div> </div> <div ng-messages="journalForm.moodleCourseId.$error" ng-show="journalForm.moodleCourseId.$dirty"> <div ng-message="max"> {{\'main.messages.error.max\' | translate: {max: 16} }} </div> </div> </md-input-container> <md-button class="md-button md-raised" ng-disabled="!journal.moodleCourseId" ng-click="saveMoodleCourseId()">{{\'moodle.saveCourseId\' | translate}}</md-button> </div> </div> <fieldset ng-if="journal.hasJournalStudents"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'journal.review\' | translate}}</legend> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label>{{\'journal.isReviewOk\' | translate}}</label> <md-select ng-model="journal.isReviewOk" aria-label="{{\'journal.isReviewOk\' | translate}}" ng-disabled="!journal.canReview"> <md-option md-option-empty></md-option> <md-option ng-value="true">{{\'main.yes\' | translate}}</md-option> <md-option ng-value="false">{{\'main.no\' | translate}}</md-option> </md-select> </md-input-container> <md-input-container flex="50" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-sm="0" flex-offset-xs="0"> <label>{{\'journal.reviewDate\' | translate}}</label> <input value="{{journal.reviewDate | hoisDate}}" disabled> </md-input-container> </div> <div layout="column" flex> <md-input-container flex> <label>{{\'journal.addInfo\' | translate}}</label> <textarea ng-model="journal.reviewInfo" md-maxlength="1000" max-rows="5" ng-required="journal.isReviewOk === false" ng-disabled="!journal.canReview"></textarea> </md-input-container> </div> <md-button ng-if="journal.canReview" class="md-raised md-primary" ng-click="saveReview()">{{\'journal.saveReview\' | translate}}</md-button> </fieldset> <div ng-if="!journal.canEdit" class="form-readonly" layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="25" flex-sm="100" flex-xs="100"> <label>{{\'journal.assessment\' | translate}}</label> <hois-classifier-value ng-model="journal.assessment" main-classifier-code="KUTSEHINDAMISVIIS"></hois-classifier-value> </md-input-container> <md-input-container flex="30" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0" class="md-input-has-value"> <label class="textInput">{{\'journal.capacitiesPlannedAndEnteredLessonsCount\' | translate}}</label> <div class="md-body-1"> <span ng-repeat="type in journal.lessonHours.capacityHours | orderBy: \'capacity\'"> <span>{{capacityTypes[type.capacity].value.toUpperCase()}}:</span> <span>{{type.plannedHours + \'/\' + type.usedHours}}</span> </span> </div> </md-input-container> </div> <div ng-if="!journal.canEdit" class="form-readonly" layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="25" flex-sm="100" flex-xs="100"> <label>{{\'moodle.courseId\' | translate}}</label> <hois-value value="journal.moodleCourseId"></hois-value> </md-input-container> </div> </form> </div> </div> <div ng-if="journal.hasJournalStudents"> <div ng-include="\'journal/journal.edit.html\'" ng-controller="JournalEditController as journalEditController"></div> </div> <div ng-if="!journal.hasJournalStudents"> <div ng-include="\'journal/journal.student.selection.html\'" ng-controller="JournalStudentSelectionController as journalStudentSelectionController"></div> </div>'),a.put("journal/journal.individualCurriculum.dialog.html",'<md-dialog aria-label="module description dialog" flex="50"> <form name="dialogForm" ng-submit="loadData()" novalidate ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2>{{individualCurriculum.fullname}} - {{\'journal.individualCurriculumDistinction\' | translate}}</h2> <span flex></span> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <div class="md-dialog-content form-readonly"> <div flex> <div layout="column" ng-repeat="distinction in individualCurriculum.distinctions"> <md-input-container flex> <label>{{\'journal.module\' | translate}}</label> <hois-value value="currentLanguageNameField(distinction)"></hois-value> </md-input-container> <div layout="row"> <md-input-container flex="45"> <label>{{\'main.from\' | translate}}</label> <hois-value value="distinction.startDate | hoisDate"></hois-value> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label>{{\'main.thru\' | translate}}</label> <hois-value value="distinction.endDate | hoisDate"></hois-value> </md-input-container> </div> <md-input-container flex> <label>{{\'journal.distinction\' | translate}}</label> <hois-value value="distinction.addInfo"></hois-value> </md-input-container> <span ng-if="!$last"> <div>&nbsp;</div> <div>&nbsp;</div> </span> </div> </div> <span flex></span> <md-dialog-actions layout="row" layout-align="start center"> <md-button class="md-raised" ng-click="cancel()">{{\'main.button.close\' | translate}}</md-button> </md-dialog-actions> </div> </md-dialog-content> </form> </md-dialog>'),a.put("journal/journal.list.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <form name="searchForm" ng-submit="load()" novalidate class="nomargin"> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'journal.studyYear\' | translate}}</label> <hois-select ng-model="criteria.studyYear" type="studyyear" select-current-study-year required autofocus></hois-select> </md-input-container> <hois-autocomplete flex="50" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0" ng-model="criteria.studentGroup" ha-attribute="id" ha-controller="directiveControllers" method="studentgroups" label="{{\'journal.studentGroup\'}}" additional-query-params="{higher: false}"></hois-autocomplete> </div> <div layout="row" layout-sm="column" layout-xs="column" ng-if="auth.isAdmin()"> <div flex="45" flex-sm="100" flex-xs="100"> <hois-autocomplete label="{{auth.higher ? \'teacher.labelHigher\' : \'teacher.labelVocational\'}}" ha-attribute="id" ha-controller="directiveControllers" ng-model="criteria.teacherObject" method="teachers"></hois-autocomplete> </div> <div flex="50" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <hois-autocomplete label="module.label" ha-controller="directiveControllers" ng-model="criteria.moduleObject" method="vocationaloccupationmodules"></hois-autocomplete> </div> </div> <div layout="row" layout-sm="column" layout-xs="column" ng-if="auth.isTeacher()"> <div flex="45" flex-sm="100"> <hois-autocomplete label="module.label" ha-controller="directiveControllers" ng-model="criteria.moduleObject" method="vocationaloccupationmodules"></hois-autocomplete> </div> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100"> <label class="textInput">{{\'journal.label\' | translate}}</label> <input ng-model="criteria.journalName" type="text" md-maxlength="255"> </md-input-container> <md-input-container flex="50" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label class="textInput">{{\'journal.status\' | translate}}</label> <hois-classifier-select ng-model="criteria.status" main-classifier-code="PAEVIK_STAATUS" model-value-attr="code"></hois-classifier-select> </md-input-container> </div> <div ng-if="auth.isTeacher()" layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="30" flex-sm="100" flex-xs="100"> <md-checkbox ng-model="criteria.onlyMyJournals">{{\'journal.showOnlyMyJournals\' | translate}}</md-checkbox> </md-input-container> </div> <div layout="row"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearSearch()">{{\'main.button.clear\' | translate}}</md-button> <md-button ng-if="formState.canConfirmAll" ng-click="confirmAll()" class="md-raised">{{\'journal.confirmAllJournals\' | translate}}</md-button> </div> <div flex-xs="0" flex-gt-xs="0" flex-gt-sm="50"></div> </form> </fieldset> </div> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="2">{{\'journal.studentGroups\' | translate}}</th> <th md-column md-order-by="3">{{\'journal.label\' | translate}}</th> <th md-column md-order-by="4">{{auth.higher ? (\'journal.teachersHigher\' | translate) : (\'journal.teachersVocational\' | translate)}}</th> <th md-column md-order-by="{{currentLanguage() === \'et\' ? 5 : 6}}">{{\'journal.modules\' | translate}}</th> <th md-column>{{\'journal.plannedAndEnteredLessonsCount1\' | translate}}<br>{{\'journal.plannedAndEnteredLessonsCount2\' | translate}}</th> <th md-column md-order-by="7">{{\'main.status\' | translate}}</th> <th md-column md-order-by="8">{{\'curriculum.code\' | translate}}</th> <th md-column md-order-by="9">{{\'journal.isReviewOk\' | translate}}</th> <th md-column md-order-by="10">{{\'journal.reviewDate\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{row.studentGroups}}</td> <td md-cell> <a ng-if="!row.canEdit" ng-href="/#/journal/{{::row.id}}/view">{{row.nameEt}}</a> <a ng-if="row.canEdit" ng-href="/#/journal/{{::row.id}}/edit">{{row.nameEt}}</a> </td> <td md-cell>{{row.teachers}}</td> <td md-cell>{{currentLanguageNameField(row.modules)}}</td> <td md-cell>{{row.plannedHours}}/{{row.usedHours}}</td> <td md-cell>{{currentLanguageNameField(row.status)}}</td> <td md-cell>{{row.curriculums}}</td> <td md-cell>{{row.isReviewOk !== null ? (row.isReviewOk ? (\'main.yes\' | translate) : (\'main.no\' | translate)) : \'\'}}</td> <td md-cell>{{row.reviewDate | hoisDate}}</td> <td md-cell> <md-button ng-if="row.canEdit" md-no-ink class="md-primary change-button" ng-href="#/journal/{{::row.id}}/edit">{{\'main.button.change\' | translate}}</md-button> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> </div>'),
a.put("journal/journal.moduleDescription.dialog.html",'<md-dialog aria-label="module description dialog" flex="50"> <form name="dialogForm" ng-submit="loadData()" novalidate ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2 ng-if="moduleDescription.isModule">{{"journal.moduleDescription" | translate}}</h2> <h2 ng-if="!moduleDescription.isModule">{{"journal.themeDescription" | translate}}</h2> <span flex></span> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <div class="md-dialog-content form-readonly"> <div flex> <div layout="column"> <md-input-container flex ng-if="!moduleDescription.isModule && moduleDescription.subthemes"> <label>{{\'module.subthemes\' | translate}}</label> <hois-value value="moduleDescription.subthemes"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'module.totalGradeDescription\' | translate}}</label> <hois-value value="moduleDescription.totalGradeDescription"></hois-value> </md-input-container> <md-input-container flex ng-if="!isDistinctiveAssessment"> <label>{{\'module.gradeADescription\' | translate}}</label> <hois-value value="moduleDescription.passDescription"></hois-value> </md-input-container> <md-input-container flex ng-if="isDistinctiveAssessment"> <label>{{\'module.grade5Description\' | translate}}</label> <hois-value value="moduleDescription.grade5Description"></hois-value> </md-input-container> <md-input-container flex ng-if="isDistinctiveAssessment"> <label>{{\'module.grade4Description\' | translate}}</label> <hois-value value="moduleDescription.grade4Description"></hois-value> </md-input-container> <md-input-container flex ng-if="isDistinctiveAssessment"> <label>{{\'module.grade3Description\' | translate}}</label> <hois-value value="moduleDescription.grade3Description"></hois-value> </md-input-container> </div> </div> <span flex></span> <md-dialog-actions layout="row" layout-align="start center"> <md-button class="md-raised" ng-click="cancel()">{{"main.button.close" | translate}}</md-button> </md-dialog-actions> </div> </md-dialog-content> </form> </md-dialog>'),a.put("journal/journal.remarks.dialog.html",'<md-dialog aria-label="apel results dialog" flex="50" flex-sm="50" flex-xs="100"> <form name="dialogForm" novalidate ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2>{{journalStudent.fullname}} {{"journal.remarks.label" | translate}}</h2> <span flex></span> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <div layout-padding> <md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{"journal.remarks.date" | translate}}</th> <th md-column>{{"journal.remarks.addedBy" | translate}}</th> <th md-column>{{"journal.remarks.remark" | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in journalStudent.remarks" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{row.inserted | hoisDate}} {{row.inserted | hoisTimeMin}}</td> <td md-cell>{{row.insertedBy}}</td> <td md-cell>{{row.addInfo}}</td> </tr> </tbody> </table> </md-table-container> </div> </md-dialog-content> <span flex></span> <md-dialog-actions layout="row" layout-align="start center"> <md-button class="md-raised" ng-click="cancel()">{{"main.button.close" | translate}}</md-button> </md-dialog-actions> </form> </md-dialog>'),a.put("journal/journal.searchStudent.dialog.html",'<md-dialog aria-label="search student dialog" flex="60" flex-sm="100" flex-xs="100"> <form name="dialogForm" ng-submit="loadData()" novalidate ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2>{{"journal.searchForOtherStudent" | translate}}</h2> <span flex></span> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <div class="md-dialog-content"> <div flex> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label>{{\'student.name\' | translate}}</label> <input type="text" ng-model="criteria.studentName" md-autofocus> </md-input-container> <div flex="50" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <hois-autocomplete ng-model="criteria.studentGroupObject" method="studentgroups" additional-query-params="{higher: false}" label="journal.studentGroup" flex></hois-autocomplete> </div> </div> <div layout="row"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> </div> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise" md-row-select multiple ng-model="selectedStudents"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row flex> <th md-column><span>{{\'student.label\' | translate}}</span></th> <th md-column><span>{{\'journal.studentGroup\' | translate}}</span></th> <th md-column><span>{{\'curriculum.code\' | translate}}</span></th> </tr> </thead> <tbody md-body> <tr md-row md-select="row.studentId" md-auto-select ng-repeat="row in tabledata.content | orderBy: \'fullname\'" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell> <i> <span ng-if="row.status === \'OPPURSTAATUS_A\'">{{\'student.statuses.academicLeaveShort\' | translate}}</span> </i> <span>{{row.fullname}}</span> </td> <td md-cell>{{row.studentGroup}}</td> <td md-cell>{{row.curriculum}}</td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> </div> </div> </md-dialog-content> <span flex></span> <md-dialog-actions layout="row" layout-align="start center"> <md-button class="md-raised md-primary" ng-click="submit()" ng-disabled="selectedStudents.length === 0">{{\'journal.addSelectedStudents\' | translate}}</md-button> <md-button class="md-raised" ng-click="cancel()">{{"main.button.close" | translate}}</md-button> </md-dialog-actions> </form> </md-dialog>'),a.put("journal/journal.student.selection.html",'<div class="ois-form-layout" layout="column"> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise" md-row-select multiple ng-model="selectedStudents"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row flex> <th md-column><span>{{\'student.label\' | translate}}</span></th> <th md-column><span>{{\'journal.studentGroup\' | translate}}</span></th> <th md-column><span>{{\'curriculum.code\' | translate}}</span></th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row md-select="row.studentId" ng-repeat="row in tabledata.content | orderBy: [\'studentGroup\', \'lastname\', \'firstname\']" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell> <i> <span ng-if="row.status === \'OPPURSTAATUS_A\'">{{\'student.statuses.academicLeaveShort\' | translate}}</span> </i> <span>{{row.fullname}}</span> </td> <td md-cell>{{row.studentGroup}}</td> <td md-cell>{{row.curriculum}}</td> <td md-cell layout="row" layout-align="end"> <md-button class="remove nomargin" ng-click="removeStudent(row)">&times;</md-button> </td> </tr> </tbody> </table> </md-table-container> </div> </div> <div layout="row" layout-margin> <md-button class="md-raised md-primary" ng-click="addSelectedStudents()">{{\'journal.addSelectedStudents\' | translate}}</md-button> <md-button class="md-raised" ng-click="searchStudent()">{{\'journal.searchForOtherStudent\' | translate}}</md-button> <md-button class="md-raised" ng-click="back(\'#/journals/\', journalForm)">{{\'main.button.back\' | translate}}</md-button> </div> </div>'),a.put("journal/journal.view.html",'<div class="ois-form-layout-padding" ng-cloak> <div flex class="form-readonly"> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="25" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'journal.studyYear\' | translate}}</label> <hois-classifier-value ng-model="journal.studyYear" main-classifier-code="OPPEAASTA"></hois-classifier-value> </md-input-container> <md-input-container flex="30" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label class="textInput">{{\'main.status\' | translate}}</label> <hois-classifier-value ng-model="journal.status" main-classifier-code="PAEVIK_STAATUS"></hois-classifier-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="25" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'journal.label\' | translate}}</label> <hois-value value="journal.nameEt"></hois-value> </md-input-container> <md-input-container flex="30" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'journal.endDate\' | translate}}</label> <hois-value value="journal.endDate | hoisDate"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="25" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'journal.studentGroups\' | translate}}</label> <hois-value value="journal.studentGroups.join(\', \')"></hois-value> </md-input-container> <md-input-container flex="30" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label class="textInput">{{auth.higher ? (\'journal.teachersHigher\' | translate) : (\'journal.teachersVocational\' | translate)}}</label> <hois-value value="journal.journalTeachers.join(\', \')"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="25" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'journal.modules\' | translate}}</label> <hois-value value="showModuleNames(journal.curriculumModules)"></hois-value> </md-input-container> <md-input-container flex="30" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label class="textInput">{{\'journal.plannedAndEnteredLessonsCount\' | translate}}</label> <hois-value value="journal.lessonHours.totalPlannedHours + \'/\' + journal.lessonHours.totalUsedHours"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="25" flex-sm="100" flex-xs="100"> <label>{{\'journal.assessment\' | translate}}</label> <hois-classifier-value ng-model="journal.assessment" main-classifier-code="KUTSEHINDAMISVIIS"></hois-classifier-value> </md-input-container> <md-input-container flex="30" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0" class="md-input-has-value"> <label class="textInput">{{\'journal.capacitiesPlannedAndEnteredLessonsCount\' | translate}}</label> <div class="md-body-1"> <span ng-repeat="type in journal.lessonHours.capacityHours | orderBy: \'capacity\'"> <span>{{capacityTypes[type.capacity].value.toUpperCase()}}:</span> <span>{{type.plannedHours + \'/\' + type.usedHours}}</span> </span> </div> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="25" flex-sm="100" flex-xs="100"> <label>{{\'moodle.courseId\' | translate}}</label> <hois-value value="journal.moodleCourseId"></hois-value> </md-input-container> </div> </div> </div> <div class="ois-form-layout-padding"> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'journal.review\' | translate}}</legend> <div class="form-readonly"> <br> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label>{{\'journal.isReviewOk\' | translate}}</label> <hois-value value="journal.isReviewOk !== null ? (journal.isReviewOk ? (\'main.yes\' | translate) :  (\'main.no\' | translate)) : \'\'"></hois-value> </md-input-container> <md-input-container flex="50" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-sm="0" flex-offset-xs="0"> <label>{{\'journal.reviewDate\' | translate}}</label> <hois-value value="journal.reviewDate | hoisDate"></hois-value> </md-input-container> </div> <div layout="column" flex> <md-input-container flex> <label>{{\'journal.addInfo\' | translate}}</label> <hois-value value="journal.reviewInfo"></hois-value> </md-input-container> </div> </div> </fieldset> </div> <div ng-controller="JournalEditController as journalEditController"> <div layout-padding> <div flex> <div layout="row"> <a ng-attr-href="{{excel(formState.xlsUrl)}}" target="_blank" class="md-button md-raised">{{\'report.excel\' | translate}}</a> <md-button class="md-raised" ng-click="back(\'#/journals/\', journalForm)">{{\'main.button.back\' | translate}}</md-button> </div> </div> </div> <div layout-padding> <div flex> <div layout="row" flex> <div flex="50" layout="column" layout-align="start"> <div class="common-label" flex>{{\'journal.absencesLegend\' | translate}}</div> <div class="common-label" flex> <span>{{\'student.statuses.academicLeaveShort\' | translate}} - {{\'student.statuses.academicLeave\' | translate}}, </span> <span>{{\'student.statuses.individualCurriculumShort\' | translate}} - {{\'student.statuses.individualCurriculum\' | translate}}, </span> <span>{{\'student.statuses.exmatriculatedShort\' | translate}} - {{\'student.statuses.exmatriculated\' | translate}}, </span> <span>{{\'student.statuses.finishedShort\' | translate}} - {{\'student.statuses.finished\' | translate}}</span> </div> </div> <div flex="50" layout="row" layout-align="end"> <md-input-container> <md-checkbox ng-model="formState.showAllStudentsModel" aria-label="show all students" ng-change="showAllStudents()"> {{\'journal.showAll\' | translate}} </md-checkbox> </md-input-container> </div> </div> <br> <div ng-include="\'journal/journal.entryType.buttons.tmpl.html\'"></div> <div class="container" fixed-column-table fixed-columns="2" ng-style="{\'overflow-y\': journal.journalStudents.length < 11 ? \'hidden\':\'scroll\'}"> <table class="journalTable"> <thead> <tr flex> <th>{{\'main.nr\' | translate}}</th> <th style="padding-right:11em"><span>{{\'student.label\' | translate}}, {{\'journal.studentGroup\' | translate}}</span></th> <th ng-if="journalEntryTypes[journalEntry.entryType.code]._selected" class="bordered" md-colors="{background: getEntryColor(journalEntry.entryType.code)}" ng-repeat="journalEntry in journal.journalEntriesByDate"> <span ng-if="journalEntry.moodleGradeItemId"><md-icon md-font-set="material-icons">school</md-icon></span> <span ng-if="journalEntry.entryType.code === \'SISSEKANNE_L\'">{{\'journal.finalResult\' | translate}} {{journalEntry.entryDate ? \' - \' + (journalEntry.entryDate | hoisDayMonth) : \'\'}}</span> <span ng-if="journalEntry.entryType.code === \'SISSEKANNE_O\'">{{\'journal.outcome\' | translate}}{{journalEntry.outcomeOrderNr + 1}}</span> <span ng-if="journalEntry.entryType.code !== \'SISSEKANNE_L\' && journalEntry.entryType.code !== \'SISSEKANNE_O\'">{{journalEntry.entryDate ? (journalEntry.entryDate | hoisDayMonth) : \'-\'}}</span> <md-tooltip> <span ng-if="journalEntry.startLessonNr"> <span ng-if="!journalEntry.lessons || journalEntry.lessons <= 1">{{journalEntry.startLessonNr}}. {{\'journal.lesson\' | translate}}</span> <span ng-if="journalEntry.lessons && journalEntry.lessons > 1">{{journalEntry.startLessonNr}}. - {{journalEntry.startLessonNr + journalEntry.lessons-1}}. {{\'journal.lesson\' | translate}}</span> ,&nbsp; </span> <span>{{journalEntry.nameEt}}</span> <span>,&nbsp;</span> {{currentLanguageNameField(journalEntry.entryType)}} <span>,&nbsp;</span> {{journalEntry.teacher}} </md-tooltip> </th> </tr> </thead> <tbody md-body> <tr ng-repeat="row in journal.journalStudents" ng-class-odd="\'odd\'" ng-class-even="\'even\'" ng-init="$last && finished()"> <td width="5%">{{$index + 1}}</td> <td width="10%" height="30px"> <span> <i> <span ng-if="row.status === \'OPPURSTAATUS_A\'">{{\'student.statuses.academicLeaveShort\' | translate}}</span> <span ng-if="row.status === \'OPPURSTAATUS_L\'">{{\'student.statuses.finishedShort\' | translate}}</span> <span ng-if="row.status === \'OPPURSTAATUS_K\'">{{\'student.statuses.exmatriculatedShort\' | translate}}</span> <span ng-if="row.isIndividualCurriculum"> <span ng-if="row.status !== \'OPPURSTAATUS_O\' && row.status !== \'OPPURSTAATUS_V\'">, </span> <span>{{\'student.statuses.individualCurriculumShort\' | translate}}</span> </span> </i> <a ng-href="/#/students/{{::row.studentId}}/main">{{::row.fullname}}</a>, {{row.studentGroup}} <span ng-if="row.apelResults.length > 0"><a ng-click="openApelResultsDialog(row)">{{\'journal.apel\' | translate}}</a></span> <span ng-if="row.remarks.length > 0" ng-click="openRemarkDialog(row)"><md-icon md-font-set="material-icons">message</md-icon></span> <span ng-if="row.isMoodleRegistered"><md-icon md-font-set="material-icons">school</md-icon></span> </span> </td> <td ng-if="journalEntryTypes[journalEntry.entryType.code]._selected" class="bordered" ng-repeat="journalEntry in journal.journalEntriesByDate"> <div layout="row"> <div ng-repeat="result in journalEntry.journalStudentResults[row.id] | orderBy: \'gradeInserted\'"> <span> {{result.absence.value}} <md-tooltip ng-if="result.absence.value"> {{journalEntry.entryDate ? (journalEntry.entryDate | hoisDate) : \'-\'}} <span ng-if="result.addInfo">,&nbsp; {{result.addInfo}} </span> <span ng-if="journalEntry.lessons && result.absence.value === \'P\'"> ,&nbsp; {{journalEntry.lessons ? ((\'journal.entry.lessons\' | translate) + \' \' + journalEntry.lessons) : \'\'}} </span> </md-tooltip> </span> <span ng-if="result.lessonAbsences.length > 0"> <span ng-repeat="lessonAbsence in result.lessonAbsences | orderBy: \'lessonNr\'"> <span>{{lessonAbsence.absence.value}}({{lessonAbsence.lessonNr}})</span> <md-tooltip class="tooltip-multiline"> {{lessonAbsence.absenceInserted | hoisDate}} <span ng-if="result.addInfo">,&nbsp; {{result.addInfo}} </span> </md-tooltip> </span> </span> <span ng-if="(result.absence.value || result.lessonAbsences.length > 0) \r\n                        && (result.journalEntryStudentHistories.length > 0 || result.grade)">/</span> <span ng-repeat="historyResult in result.journalEntryStudentHistories | orderBy: \'gradeInserted\' track by $index"> <span ng-class="{badResult: !gradeUtil.isPositive(historyResult.grade.code)}">{{historyResult.grade.value}}</span> <span>* / </span> <md-tooltip> {{historyResult.gradeInserted | hoisDate}}, &nbsp; {{historyResult.gradeInsertedBy}} </md-tooltip> </span> <span> <span ng-class="{journalFinalResult: journalEntry.entryType.code === \'SISSEKANNE_L\',\r\n                                      badResult: !gradeUtil.isPositive(result.grade.code)}">{{result.grade.value}}</span> <span ng-if="!result.grade && result.journalEntryStudentHistories.length > 0"> - </span> <md-tooltip ng-if="result.grade.value" class="tooltip-multiline"> {{result.gradeInserted | hoisDate}}, &nbsp; {{result.gradeInsertedBy}} <span ng-if="result.addInfo">,&nbsp;</span> {{result.addInfo}} </md-tooltip> </span> </div> </div> </td> </tr> </tbody> </table> </div> </div> </div> <div layout-padding> <div ng-include="\'journal/journal.entryType.buttons.tmpl.html\'"></div> <div flex> <div layout="row"> <a ng-attr-href="{{excel(formState.xlsUrl)}}" target="_blank" class="md-button md-raised">{{\'report.excel\' | translate}}</a> <md-button class="md-raised" ng-click="back(\'#/journals/\', journalForm)">{{\'main.button.back\' | translate}}</md-button> </div> </div> </div> <div layout-padding> <div flex> <div layout="row"> <div flex="10"> <h2>{{\'journal.entries\' | translate}}</h2> </div> </div> <md-table-container> <table md-table md-progress="journalEntries.$promise"> <thead md-head md-order="journalEntriesCriteria.order" md-on-reorder="loadJournalEntries"> <tr md-row> <th md-column> </th> <th md-column>{{\'journal.entry.date\' | translate}}</th> <th md-column>{{\'journal.entry.lessons\' | translate}}</th> <th md-column>{{\'journal.entry.nameContent\' | translate}}</th> <th md-column>{{\'journal.entry.homework\' | translate}}</th> <th md-column>{{\'journal.entry.homeworkDuedate\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in journalEntries.content " ng-class-odd="\'odd\'" ng-class-even="\'even\'" md-colors="{background: getEntryColor(row.entryType)}"> <td md-cell><span ng-if="row.moodleGradeItemId"><md-icon md-font-set="material-icons">school</md-icon></span> </td> <td md-cell>{{row.entryDate ? (row.entryDate | hoisDate) : \'-\'}}</td> <td md-cell>{{row.lessons ? row.lessons : \'-\'}}</td> <td md-cell> <span>{{row.nameEt ? row.nameEt : \'-\'}}</span> <span ng-if="row.nameEt && row.content">/</span> <hois-value value="row.content"></hois-value> </td> <td md-cell> <hois-value value="row.homework ? row.homework : \'-\'"></hois-value> </td> <td md-cell>{{row.homeworkDuedate ? (row.homeworkDuedate | hoisDate) : \'-\' }}</td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="journalEntriesCriteria.size" md-limit-options="[10, 20, 50]" md-page="journalEntriesCriteria.page" md-total="{{journalEntries.totalElements}}" md-on-paginate="loadJournalEntries" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> </div> <div layout-padding> <div flex> <div ng-include="\'studyMaterial/templates/journal.material.view.tmpl.html\'"></div> </div> </div> <div layout-padding> <hois-collapsable label="(\'journal.curriculumVersionModuleOrThemeDescription\' | translate)" expanded="false"> <div ng-repeat="module in journal.moduleDescriptions | orderBy: [\'-isModule\', currentLanguageNameField()]"> <a href="" class="md-raised small-link" ng-click="moduleDescriptionDialog(module)">{{currentLanguageNameField(module)}}</a> </div> <div ng-repeat="individualCurriculum in journal.individualCurriculums | orderBy: \'fullname\'"> <a class="md-raised small-link" ng-click="individualCurriculumDialog(individualCurriculum)"> {{individualCurriculum.fullname}} - {{\'journal.individualCurriculumDistinction\' | translate}}</a> </div> </hois-collapsable> </div> </div>'),a.put("lessonplan/event.search.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <form name="searchForm" ng-submit="searchForm.$valid && loadData()" novalidate class="nomargin" ng-model-options="{allowInvalid: true}"> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label>{{\'lessonplan.event.studyPeriod\' | translate}}</label> <hois-select ng-model="criteria.studyPeriod" values="formState.studyPeriods" sorted-query="true"></hois-select> </md-input-container> <hois-autocomplete flex="50" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-sm="0" flex-offset-xs="0" ng-model="criteria.studentGroups" ha-attribute="id" ha-controller="directiveControllers" method="studentgroups" name="studentGroup" multiple label="{{\'lessonplan.event.studentGroups\'}}"></hois-autocomplete> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'lessonplan.event.name\' | translate}}</label> <input ng-model="criteria.name" type="text" md-maxlength="255"> </md-input-container> <md-input-container flex="25" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-sm="0" flex-offset-xs="0"> <label>{{\'main.from\' | translate}}</label> <md-datepicker ng-model="criteria.from" md-max-date="criteria.thru" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> <md-input-container flex="25" flex-sm="100" flex-xs="100"> <label>{{\'main.thru\' | translate}}</label> <md-datepicker ng-model="criteria.thru" md-min-date="criteria.from" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> </div> <div layout="row"> <md-input-container class="md-block" flex="45" flex-sm="100" flex-xs="100"> <label>{{auth.higher ? (\'lessonplan.event.teachersHigher\' | translate) : (\'lessonplan.event.teachersVocational\' | translate)}}</label> <hois-select ng-model="criteria.teachers" values="formState.teachers" flex multiple></hois-select> </md-input-container> <md-input-container flex="50" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-sm="0" flex-offset-xs="0"> <label class="textInput">{{auth.higher ? (\'lessonplan.event.otherTeacherHigher\' | translate) : (\'lessonplan.event.otherTeacherVocational\' | translate)}}</label> <input ng-model="criteria.otherTeacher" type="text" md-maxlength="255"> </md-input-container> </div> <div layout="row"> <div layout="row" flex="45" flex-sm="100" flex-xs="100"> <hois-autocomplete flex ha-controller="directiveControllers" ng-model="criteria.roomObject" method="rooms" name="student" label="lessonplan.event.room" additional-query-params="{isStudy: true}"></hois-autocomplete> </div> <md-input-container flex="50" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-sm="0" flex-offset-xs="0"> <label class="textInput">{{\'lessonplan.event.otherRoom\' | translate}}</label> <input ng-model="criteria.otherRoom" type="text" md-maxlength="255"> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="30" flex-sm="100" flex-xs="100"> <md-checkbox ng-model="criteria.singleEvent">{{\'lessonplan.event.singleEvent\' | translate}}</md-checkbox> </md-input-container> <md-input-container flex="30" flex-sm="100" flex-xs="100"> <md-checkbox ng-model="criteria.showOnlySubstitutes">{{\'lessonplan.event.showOnlySubstitutes\' | translate}}</md-checkbox> </md-input-container> </div> <div layout="row"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearEventCriteria()">{{\'main.button.clear\' | translate}}</md-button> <md-button class="md-raised" ng-if="canEdit" ng-href="#/timetable/timetableEvent/new">{{\'main.button.create\' | translate}}</md-button> </div> <div flex-xs="0" flex-gt-xs="0" flex-gt-sm="50"></div> </form> </fieldset> </div> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="{{currentLanguage()===\'en\' ? 3 : 2}}">{{\'lessonplan.event.name\' | translate}}</th> <th md-column md-order-by="4">{{\'lessonplan.event.date\' | translate}}</th> <th md-column md-order-by="cast(tet.start as time), cast(tet.end as time)">{{\'lessonplan.event.time\' | translate}}</th> <th md-column>{{auth.higher ? (\'lessonplan.event.teachersHigher\' | translate) : (\'lessonplan.event.teachersVocational\' | translate)}}</th> <th md-column>{{\'lessonplan.event.rooms\' | translate}}</th> <th md-column>{{\'lessonplan.event.studentGroups\' | translate}}</th> <th md-column>{{\'lessonplan.event.singleEvent\' | translate}}</th> <th></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell><a ng-href="#/timetable/timetableEvent/{{::row.id}}/view">{{row.nameEt}}</a></td> <td md-cell>{{::row.date | hoisDate}}</td> <td md-cell>{{::row.timeStart | hoisTime}}-{{::row.timeEnd | hoisTime}}</td> <td md-cell><span ng-repeat="teacher in row.teachers">{{::teacher.name}}{{$last ? "" : ", "}}</span></td> <td md-cell> <span ng-repeat="room in row.rooms"> <span ng-if="room.id">{{::room.buildingCode}}-{{::room.roomCode}}</span> <span ng-if="!room.id">{{::room.roomCode}}</span> {{$last ? "" : ", "}} </span> </td> <td md-cell><span ng-repeat="group in row.studentGroups">{{::group.code}}{{$last ? "" : ", "}}</span></td> <td md-cell>{{::row.singleEvent ? "jah" : "ei"}}</td> <td md-cell> <md-button md-no-ink class="md-primary change-button" ng-if="canEdit && afterNow(row.date, row.timeStart) && allowedToEdit(row)" ng-href="#/timetable/timetableEvent/{{::row.id}}/edit">{{\'main.button.change\' | translate}}</md-button> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> </div>'),a.put("lessonplan/journal.edit.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <form name="journalForm" class="nomargin"> <div flex="100" layout="row"> <div flex="75"> <div> <div layout="row" flex="100" flex-sm="100" flex-xs="100"> <span class="common-label">{{\'lessonplan.moduleName\' | translate}}: {{record.moduleNameEt}}</span> </div> <div layout="row" flex="100" flex-sm="100" flex-xs="100"> <span class="common-label">{{\'lessonplan.studentGroup\' | translate}}: {{record.studentGroupCode}}</span> </div> </div> <div flex> <br> <md-checkbox ng-model="record.addModuleOutcomes" aria-label="{{\'lessonplan.journal.addModuleOutcomes\' | translate}}"> {{\'lessonplan.journal.addModuleOutcomes\' | translate}} </md-checkbox> </div> <div layout="row" flex="100" flex-sm="100" flex-xs="100"> <md-input-container flex> <label class="textInput">{{\'lessonplan.journal.theme\' | translate}}</label> <md-select name="theme" ng-model="formState.theme"> <md-option md-option-empty></md-option> <md-option ng-repeat="theme in formState.themes" ng-value="theme.id" ng-style="theme.existsInOtherJournals ? {color: \'red\'} : {}"> <span>{{currentLanguageNameField(theme)}}</span> <span ng-if="theme.studyYearNumber">({{theme.studyYearNumber}}. {{\'main.studyYearShort\' | translate}})</span> </md-option> </md-select> </md-input-container> </div> <div layout="column" class="common-label" flex="95" ng-repeat="theme in record.journalOccupationModuleThemes | orderBy: orderByThemeName"> <div layout="row" flex layout-align="start center"> <div flex="5">&nbsp;</div> <div flex="50"> <span ng-style="{\'color\': formState.themeMap[theme].existsInOtherJournals ? \'red\' : \'inherit\'}"> <span>{{currentLanguageNameField(formState.themeMap[theme])}}</span> <span ng-if="formState.themeMap[theme].studyYearNumber"> ({{formState.themeMap[theme].studyYearNumber}} {{\'main.studyYearShort\' | translate}})</span> </span> </div> <div> <a ng-click="deleteTheme(theme)" class="remove">&times;</a> </div> </div> </div> <div layout="row" flex="100" flex-sm="100" flex-xs="100"> <md-input-container flex="100" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'lessonplan.journal.assessment\' | translate}}</label> <hois-classifier-select flex="100" flex-sm="100" flex-xs="100" ng-model="record.assessment" required main-classifier-code="KUTSEHINDAMISVIIS" model-value-attr="code"></hois-classifier-select> </md-input-container> </div> <div layout="row"> <md-input-container flex="100" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'lessonplan.journal.name\' | translate}}</label> <input type="text" ng-model="record.nameEt" md-maxlength="255" required> </md-input-container> </div> <div layout="row" flex="100" flex-sm="100" flex-xs="100"> <md-input-container flex="50" flex-sm="100" flex-xs="100"> <label>{{\'teacher.untis\' | translate}}</label> <input ng-model="record.untisCode" name="untisCode" type="text" md-maxlength="20"> <div ng-messages="teacherForm.untisCode.$error"> <div ng-message="md-maxlength"> {{\'main.messages.error.maxlength\' | translate}} </div> </div> </md-input-container> <md-input-container flex="50" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'lessonplan.journal.groupProportion\' | translate}}</label> <hois-classifier-select ng-model="record.groupProportion" required main-classifier-code="PAEVIK_GRUPI_JAOTUS" model-value-attr="code"></hois-classifier-select> </md-input-container> </div> <div layout="row" flex="100" flex-sm="100" flex-xs="100"> <hois-autocomplete ng-model="formState.teacher" method="teachers" additional-query-params="{valid: true}" label="{{auth.higher ? \'lessonplan.journal.teacherHigher\' : \'lessonplan.journal.teacherVocational\'}}" flex></hois-autocomplete> </div> <div layout="row"> <md-table-container class="secondary-table"> <table md-table> <thead md-head> <tr md-row> <th md-column></th> <th md-column>{{\'lessonplan.journal.isFiller\' | translate}}</th> <th md-column>{{\'lessonplan.journal.isConfirmer\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="teacher in record.journalTeachers"> <td md-cell>{{currentLanguageNameField(teacher.teacher)}}</td> <td md-cell> <md-input-container> <md-checkbox ng-model="teacher.isFiller" aria-label="{{\'lessonplan.journal.isFiller\' | translate}}"></md-checkbox> </md-input-container> </td> <td md-cell> <md-input-container> <md-checkbox ng-model="teacher.isConfirmer" aria-label="{{\'lessonplan.journal.isConfirmer\' | translate}}"></md-checkbox> </md-input-container> </td> <td md-cell> <a ng-click="deleteTeacher(teacher)" class="remove">&times;</a> </td> </tr> </tbody> </table> </md-table-container> </div> <div layout="row" flex="100"> <hois-autocomplete flex ng-model="formState.room" method="rooms" additional-query-params="{isStudy: true}" label="lessonplan.room"></hois-autocomplete> </div> <div layout="column" class="common-label" flex="95" ng-repeat="room in record.journalRooms"> <div layout="row" flex layout-align="start center"> <div flex="5">&nbsp;</div> <div flex="50">{{room.nameEt}}</div> <div> <a ng-click="deleteRoom(room)" class="remove">&times;</a> </div> </div> </div> <div layout="row" flex="100" flex-sm="100" flex-xs="100"> <hois-autocomplete flex ng-model="formState.group" label="lessonplan.journal.group" ha-search="searchStudentGroups"></hois-autocomplete> </div> <div layout="row" flex> <md-table-container class="secondary-table" flex> <table md-table flex> <thead md-head flex> <tr md-row> <th md-column></th> <th md-column>{{\'lessonplan.journal.group-module\' | translate}}</th> <th md-column>{{\'lessonplan.journal.group-theme\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="moduleTheme in record.groups"> <td md-cell>{{moduleTheme.group.nameEt}}</td> <td md-cell> <md-input-container class="md-block" flex> <label>{{\'lessonplan.journal.group-module\' | translate}}</label> <hois-select ng-change="newSelectedModule(moduleTheme)" required ng-model="moduleTheme.curriculumVersionOccupationModule" values="moduleTheme.group.modules" flex></hois-select> </md-input-container> </td> <td md-cell> <md-input-container class="md-block" flex> <label>{{\'lessonplan.journal.group-theme\' | translate}}</label> <hois-select ng-model="moduleTheme.curriculumVersionOccupationModuleThemes" values="moduleTheme.group.themes" warning-param="existsInOtherJournals" multiple required flex></hois-select> </md-input-container> </td> <td md-cell> {{moduleTheme.group.themes[moduleTheme.curriculumVersionOccupationModuleThemes]}} </td> <td md-cell> <a ng-click="deleteGroup(moduleTheme)" class="remove">&times;</a> </td> </tr> </tbody> </table> </md-table-container> </div> </div> <div layout="column" flex="20" flex-offset="5"> <fieldset flex="100" layout="column"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'lessonplan.journal.capacity-type\' | translate}}</legend> <div layout="column" ng-repeat="capacityType in formState.capacityTypes"> <div layout="row" flex layout-align="start center"> <div flex="5">&nbsp;</div> <div flex> <md-checkbox ng-model="capacityType._selected"> {{currentLanguageNameField(capacityType)}} <span ng-if="capacityType.hours">({{capacityType.hours}})</span> </md-checkbox> </div> </div> </div> </fieldset> </div> </div> <div layout="row"> <md-button class="md-raised md-primary" ng-click="update()">{{\'main.button.save\' | translate}}</md-button> <md-button class="md-raised" ng-if="record.id" ng-click="delete()">{{\'main.button.delete\' | translate}}</md-button> <md-button ng-click="back(\'#/lessonplans/vocational/\' + record.lessonPlan + \'/edit\', journalForm)" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </div> </form> </div> </div>'),
a.put("lessonplan/new.lessonplan.dialog.html",'<md-dialog aria-label="grade add dialog" flex="30" flex-sm="100" flex-xs="100"> <form name="newLessonPlanForm" ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2>{{"lessonplan.addPlanDialog" | translate}}</h2> <span flex></span> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <div class="ois-form-layout-padding nomargin" layout="column" ng-cloak> <md-input-container class="md-block"> <label class="textInput">{{\'lessonplan.studyYear\' | translate}}</label> <hois-select values="formState.studyYears" ng-model="record.studyYear" md-autofocus required></hois-select> </md-input-container> <hois-autocomplete class="md-block" ha-attribute="id" ng-model="record.studentGroup" label="lessonplan.studentGroup" ha-search="search" name="studentGroup" required></hois-autocomplete> <md-input-container class="md-block"> <label class="textInput">{{\'lessonplan.copyLessonplan\' | translate}}</label> <md-select ng-model="record.previousLessonplan" aria-label="{{\'lessonplan.copyLessonplan\' | translate}}" ng-disabled="!record.studentGroup"> <md-option md-option-empty></md-option> <md-option ng-value="value.lessonplan" ng-repeat="value in formState.previousLessonplans">{{::value.name}}</md-option> </md-select> </md-input-container> <div>&nbsp;</div> <md-input-container> <md-checkbox ng-model="record.copyLessons" aria-label="{{\'lessonplan.copyLessons\' | translate}}" ng-disabled="!record.previousLessonplan"> {{\'lessonplan.copyLessons\' | translate}} </md-checkbox> </md-input-container> </div> </md-dialog-content> <md-dialog-actions layout="row" layout-align="start center"> <md-button ng-click="create()" class="md-raised md-primary">{{\'main.button.create\' | translate}}</md-button> <md-button ng-click="cancel()" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </md-dialog-actions> </form> </md-dialog>'),a.put("lessonplan/teacher.capacities.dialog.html",'<md-dialog aria-label="teacher capacities dialog" flex="80" flex-sm="80" flex-xs="100"> <form name="dialogForm" ng-submit="dialogForm.$valid && submit()" novalidate ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2>{{\'lessonplan.teacherSpecificLoads\' | translate}}</h2> <span flex></span> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <div class="md-dialog-content"> <div class="ois-form-layout" layout="column" layout-margin ng-cloak> <md-checkbox ng-model="journal.capacityDiff" ng-disabled="isView" aria-label="{{\'lessonplan.journal.loadsDiffer\' | translate}}"> {{\'lessonplan.journal.loadsDiffer\' | translate}} </md-checkbox> <div class="container" fixed-column-table resize-table max-table-height="500" fixed-columns="3"> <table class="lessonplan"> <thead> <tr> <th colspan="3" class="dividerBorder"></th> <th ng-if="!atLeastOneShownPeriod" colspan="1" class="dividerBorder"></th> <th ng-if="sp._selected" colspan="{{sp.weekNrs.length}}" class="dividerBorder" ng-repeat="sp in ::formState.studyPeriods track by $index"> {{currentLanguageNameField(sp)}} ({{sp.startDate | hoisDayMonth}}-{{sp.endDate | hoisDayMonth}})</th> </tr> <tr ng-if="formState.showWeeks"> <th colspan="3" class="cross dividerBorder">&nbsp;</th> <th ng-if="!atLeastOneShownPeriod" colspan="1" class="dividerBorder"></th> <th ng-if="w.show" ng-repeat="w in ::formState.weekNrs track by $index" class="center" ng-class="{dividerBorder: w.endOfPeriod}" ng-style="{ background: true ? getLegendByWeek(w.nr) :  \'white\' }" title="{{formState.weekBeginningDates[$index] | hoisDate}}">{{w.nr}}</th> </tr> </thead> <tbody class="teacher-capacity-tbody" ng-repeat="teacher in journal.teachers track by $index"> <tr> <td></td> <td class="lessonplan-teacher-load-label fix dividerBorder" title="{{getPlannedLessonsTitle(teacher.teacher.id)}}" colspan="2"> {{\'lessonplan.load\' | translate}} {{(teacherLoad = getTeacherStudyLoad(teacher.teacher.id)).plannedLessons}} </td> <td ng-if="!atLeastOneShownPeriod" colspan="1" class="dividerBorder"></td> <td ng-if="formState.showWeeks && week.show" ng-repeat="week in ::formState.weekNrs track by $index" ng-class="{dividerBorder: week.endOfPeriod}" title="{{getStudyLoadTitle(teacher.teacher.id, $index)}}" class="center lessonplan-teacher-load">{{teacherLoad.studyLoadByWeek[$index]}}</td> <td ng-if="!formState.showWeeks && sp._selected" colspan="{{::sp.weekNrs.length}}" ng-repeat="sp in ::formState.studyPeriods track by $index" title="{{getStudyLoadSpTitle(teacher.teacher.id, $index)}}" class="center dividerBorder lessonplan-teacher-load">{{teacherLoad.studyLoadByPeriod[$index]}}</td> </tr> <tr ng-repeat="ct in journalCapacities" class="fix" ng-style="{\'border-top\': $first ? \'border-top: solid 2px #777 !important;\' : \'inherit\'}"> <td rowspan="{{::journalCapacities.length}}" ng-if="$first" class="fix" title="{{\'lessonplan.teacherLoad\' | translate : getTeacherLoad(teacher.teacher.id)}}">{{currentLanguageNameField(teacher.teacher)}}</td> <td class="center fix">{{ct.value.toUpperCase()}}</td> <td class="dividerBorder center fix">{{formState.teacherTotals[teacher.id][ct.code]}}</td> <td ng-if="!atLeastOneShownPeriod" colspan="1" class="dividerBorder"></td> <td ng-if="formState.showWeeks && formState.weekNrs[$index].show" ng-repeat="h in ::teacher.hours[ct.code] track by $index" ng-class="{dividerBorder: formState.weekNrs[$index].endOfPeriod}" class="center"> <input type="number" min="0" step="1" ng-model="teacher.hours[ct.code][$index]" ng-change="updateTotals(teacher, ct.code, $index)" ng-disabled="isView || !journal.capacityDiff"> </td> <td ng-if="!formState.showWeeks && sp._selected" colspan="{{::sp.weekNrs.length}}" ng-repeat="sp in ::formState.studyPeriods track by $index" class="center dividerBorder"> <input type="number" min="0" step="1" ng-model="teacher.spHours[ct.code][$index]" ng-change="updateLessonCountByStudyPeriod(teacher, ct.code, $index)" ng-disabled="isView || !journal.capacityDiff"> </td> </tr> </tbody> <tbody> <tr ng-repeat="ct in journalCapacities" class="fix lessonplan-total-row"> <td rowspan="{{::journalCapacities.length + 1}}" ng-if="$first" class="fix">{{\'lessonplan.journal.total\' | translate}}</td> <td class="center fix">{{ct.value.toUpperCase()}}</td> <td class="center fix dividerBorder">{{formState.journalTotals[journal.id][ct.code]}}</td> <th ng-if="!atLeastOneShownPeriod" colspan="1" class="dividerBorder"></th> <td ng-if="formState.showWeeks && formState.weekNrs[$index].show" ng-repeat="h in ::journal.hours[ct.code] track by $index" ng-class="{dividerBorder: formState.weekNrs[$index].endOfPeriod}" class="center">{{journal.hours[ct.code][$index]}}</td> <td ng-if="!formState.showWeeks && sp._selected" colspan="{{::sp.weekNrs.length}}" ng-repeat="sp in ::formState.studyPeriods track by $index" class="center dividerBorder">{{journal.spHours[ct.code][$index]}}</td> </tr> <tr ng-repeat-end class="fix lessonplan-total-row"> <td class="fix">{{\'lessonplan.total\' | translate}}</td> <td class="center fix dividerBorder">{{formState.journalTotals[journal.id].__ ? (formState.journalTotals[journal.id].__ | hoisNumber:1) : 0}}</td> <th ng-if="!atLeastOneShownPeriod" colspan="1" class="dividerBorder"></th> <td ng-if="formState.showWeeks && formState.weekNrs[$index].show" ng-repeat="w in ::formState.weekNrs track by $index" ng-class="{dividerBorder: formState.weekNrs[$index].endOfPeriod}" class="center">{{formState.journalTotals[journal.id]._[$index]}}</td> <td ng-if="!formState.showWeeks && sp._selected" colspan="{{::sp.weekNrs.length}}" ng-repeat="sp in ::formState.studyPeriods track by $index" class="center dividerBorder">{{formState.journalTotals[journal.id]._spTotals[$index]}}</td> </tr> </tbody> </table> </div> </div> </div> <span flex></span> <md-dialog-actions layout="row" layout-align="start center"> <md-button ng-if="!isView" class="md-raised md-primary" ng-click="submit()">{{"main.button.save" | translate}}</md-button> <md-button class="md-raised" ng-click="cancel()">{{"main.button.close" | translate}}</md-button> </md-dialog-actions> </form> </md-dialog>'),a.put("lessonplan/vocational.edit.html",'<div ng-cloak class="ois-form-layout-padding"> <div layout="column"> <div flex="30" class="md-title"> <hois-classifier-value ng-model="record.studyYearCode" main-classifier-code="OPPEAASTA"></hois-classifier-value> <span>{{\'lessonplan.studentGroup\' | translate}} {{record.studentGroupCode}} ({{record.courseNr}}. {{\'lessonplan.course\' | translate}}), </span> <span>{{record.curriculumCode}}, {{currentLanguageNameField(record.curriculumVersion)}}, </span> <span>{{\'lessonplan.studyPeriod\' | translate}} {{formState.studyPeriodYears}} {{\'main.years\' | translate}} {{formState.studyPeriodMonths}} {{\'main.months\' | translate}}</span> </div> <div>&nbsp;</div> <div flex layout="row"> <div flex="50" layout="row" layout-align="start center"> <md-checkbox ng-model="record.isUsable" ng-disabled="isView || !canEdit"> {{\'lessonplan.isUsable\' | translate}} </md-checkbox> <md-checkbox ng-model="formState.showWeeks" ng-change="showWeeksChanged()">{{\'lessonplan.showWeeks\' | translate}}</md-checkbox> <md-checkbox ng-model="formState.showTotals" ng-change="showTotalsChanged()">{{\'lessonplan.showTotals\' | translate}}</md-checkbox> </div> <div flex="50" layout="row" layout-align="end start" class="common-label" md-colors="{color: \'background-400\'}"> <span ng-repeat="c in ::formState.capacityTypes track by $index"> <span ng-if="!$first">|</span> {{::c.value.toUpperCase()}} - {{currentLanguageNameField(c)}} </span> </div> </div> </div> <fieldset tabindex="1"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'lessonplan.showPeriods\' | translate}}</legend> <div layout="column"> <md-grid-list ng-app="app" md-cols="6" md-cols-md="4" md-cols-sm="3" md-cols-xs="1" md-gutter="1em" md-row-height="35px"> <md-grid-tile ng-repeat="sp in ::formState.studyPeriods track by $index"> <md-checkbox aria-label="{{currentLanguageNameField(sp)}}" ng-model="sp._selected" ng-change="updateStudyPeriods()" style="position: absolute; left: 5px">{{currentLanguageNameField(sp)}}</md-checkbox> </md-grid-tile> </md-grid-list> </div> </fieldset> <div>&nbsp;</div> <div id="lessonplan-container" class="container" fixed-column-table fixed-columns="3"> <table class="lessonplan" id="lessonplan-table"></table> </div> </div> <div> <md-button ng-if="isView && canEdit" class="md-raised md-primary" ng-href="#/lessonplans/vocational/{{::lessonPlanId}}/edit">{{\'main.button.edit\' | translate}}</md-button> <md-button ng-if="!isView && canEdit" class="md-raised md-primary" ng-click="update()">{{\'main.button.save\' | translate}}</md-button> <a ng-href="{{excel(formState.xlsUrl, criteria)}}" target="_blank" class="md-button md-raised">{{\'main.button.printXls\' | translate}}</a> <md-button ng-if="!isView && canEdit" class="md-raised" ng-click="delete()">{{\'main.button.delete\' | translate}}</md-button> <md-button ng-click="back()" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </div>'),a.put("lessonplan/vocational.search.html",'<md-nav-bar md-selected-nav-item="currentNavItem"> <md-nav-item ng-if="formState.vocational" md-nav-href="#/lessonplans/vocational" name="lessonplan.vocational">{{\'lessonplan.search.vocational\' | translate}}</md-nav-item> <md-nav-item ng-if="formState.vocational" md-nav-href="#/lessonplans/vocational/byteacher" name="lessonplan.vocational-byteacher"> {{auth.higher ? (\'lessonplan.search.vocationalByTeacherHigher\' | translate) : (\'lessonplan.search.vocationalByTeacherVocational\' | translate)}} </md-nav-item> <!--  <md-nav-item ng-if="formState.higher" md-nav-href="#/lessonplans/higher" name="lessonplan.higher">{{\'lessonplan.higher\' | translate}}</md-nav-item>\r\n  <md-nav-item ng-if="formState.higher" md-nav-href="#/lessonplans/higher/byteacher" name="lessonplan.higher-byteacher">{{\'lessonplan.higher-byteacher\' | translate}}</md-nav-item>  --> </md-nav-bar> <div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <form ng-submit="load()" name="vocationalSearchForm" novalidate class="nomargin"> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'lessonplan.studyYear\' | translate}}</label> <hois-select ng-model="criteria.studyYear" values="formState.studyYears" required autofocus></hois-select> </md-input-container> <md-input-container flex="50" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label class="textInput">{{\'lessonplan.schoolDepartment\' | translate}}</label> <hois-school-department-select ng-model="criteria.schoolDepartment"></hois-school-department-select> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label>{{\'lessonplan.curriculumVersion\' | translate}}</label> <hois-select ng-model="criteria.curriculumVersion" values="formState.curriculumVersions"></hois-select> </md-input-container> <hois-autocomplete flex="50" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0" ng-model="criteria.studentGroup" ha-attribute="id" ha-controller="directiveControllers" method="studentgroups" name="studentGroup" label="{{\'lessonplan.studentGroup\'}}" additional-query-params="{higher: false}"></hois-autocomplete> </div> <div layout="row" layout-sm="column" layout-xs="column"> <div flex="45" flex-sm="100" flex-xs="100"> <hois-autocomplete ng-model="criteria.teacherObject" ha-controller="directiveControllers" method="teachers" label="{{auth.higher ? (\'lessonplan.teacherHigher\' | translate) : (\'lessonplan.teacherVocational\' | translate)}}"></hois-autocomplete> </div> </div> <div layout="row" layout-xs="column"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> <md-button class="md-raised" ng-if="canEdit" ng-click="newLessonplan()">{{\'main.button.create\' | translate}}</md-button> </div> <div flex-xs="0" flex-gt-xs="0" flex-gt-sm="50"></div> </form> </fieldset> </div> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="sg.code">{{\'lessonplan.studentGroup\' | translate}}</th> <th md-column md-order-by="cv.code">{{\'lessonplan.curriculumVersion\' | translate}}</th> <th md-column md-order-by="hours">{{\'lessonplan.plannedHoursTotal\' | translate}}</th> <th></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{::row.studentGroup}}</td> <td md-cell>{{::row.curriculumVersion}}</td> <td md-cell>{{::row.plannedHours | hoisNumber:1}}</td> <td md-cell> <md-button md-no-ink ng-if="canView && !canEdit" class="md-primary change-button" ng-href="#/lessonplans/vocational/{{::row.id}}/view">{{\'main.button.view\' | translate}}</md-button> <md-button md-no-ink ng-if="canEdit" class="md-primary change-button" ng-href="#/lessonplans/vocational/{{::row.id}}/edit">{{\'main.button.change\' | translate}}</md-button> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> </div>'),a.put("lessonplan/vocational.teacher.search.html",'<md-nav-bar md-selected-nav-item="currentNavItem" ng-if="formState.vocational && auth.isAdmin()"> <md-nav-item ng-if="formState.vocational" md-nav-href="#/lessonplans/vocational" name="lessonplan.vocational">{{\'lessonplan.search.vocational\' | translate}}</md-nav-item> <md-nav-item ng-if="formState.vocational" md-nav-href="#/lessonplans/vocational/byteacher" name="lessonplan.vocational-byteacher"> {{auth.higher ? (\'lessonplan.search.vocationalByTeacherHigher\' | translate) : (\'lessonplan.search.vocationalByTeacherVocational\' | translate)}}</md-nav-item> <!--  <md-nav-item ng-if="formState.higher" md-nav-href="#/lessonplans/higher" name="lessonplan.higher">{{\'lessonplan.higher\' | translate}}</md-nav-item>\r\n  <md-nav-item ng-if="formState.higher" md-nav-href="#/lessonplans/higher/byteacher" name="lessonplan.higher-byteacher">{{\'lessonplan.higher-byteacher\' | translate}}</md-nav-item>  --> </md-nav-bar> <div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <form ng-submit="load()" name="vocationalTeacherSearchForm" novalidate class="nomargin" ng-model-options="{allowInvalid: true}"> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'lessonplan.studyYear\' | translate}}</label> <hois-select ng-model="criteria.studyYear" values="formState.studyYears" required autofocus></hois-select> </md-input-container> <div flex="50" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0" ng-if="auth.isAdmin()"> <hois-autocomplete ha-attribute="id" ha-controller="directiveControllers" label="{{auth.higher ? \'lessonplan.teacherHigher\' : \'lessonplan.teacherVocational\'}}" ng-model="criteria.teacher" method="teachers"></hois-autocomplete> </div> </div> <div layout="row"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()" ng-if="auth.isAdmin()">{{\'main.button.clear\' | translate}}</md-button> </div> <div flex-xs="0" flex-gt-xs="0" flex-gt-sm="50"></div> </form> </fieldset> </div> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="p.lastname,p.firstname"> {{auth.higher ? (\'lessonplan.teacherHigher\' | translate) : (\'lessonplan.teacherVocational\' | translate)}} </th> <th md-column>{{\'lessonplan.plannedHoursTotal\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell> <md-button md-no-ink class="md-primary change-button" ng-href="#/lessonplans/vocational/byteacher/{{::row.id}}/{{::row.studyYear}}">{{::row.teacherFullname}}</md-button> </td> <td md-cell>{{::row.plannedHours}}</td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> </div>'),a.put("lessonplan/vocational.teacher.view.html",'<div ng-cloak class="ois-form-layout-padding"> <div layout="column"> <div flex="30" class="md-title"> <hois-classifier-value ng-model="record.studyYearCode" main-classifier-code="OPPEAASTA"></hois-classifier-value> <span>{{auth.higher ? (\'lessonplan.teacherHigher\' | translate) : (\'lessonplan.teacherVocational\' | translate)}} {{record.teacherName}}</span> </div> <div>&nbsp;</div> <div flex layout="row"> <div flex="50" layout="row" class="common-label" md-colors="{color: \'background-400\'}"> <span ng-repeat="c in formState.capacityTypes"> <span ng-if="!$first">|</span> {{::c.value.toUpperCase()}} - {{currentLanguageNameField(c)}} </span> </div> </div> </div> <md-table-container ng-if="record.journals.length > 0"> <table class="teacher-lessonplan"> <!-- table header --> <thead> <tr> <th>{{\'lessonplan.journals\' | translate}}</th> <th colspan="2" class="dividerBorder">{{\'lessonplan.total\' | translate}}</th> <th colspan="{{::sp.weekNrs.length}}" class="dividerBorder" ng-repeat="sp in formState.studyPeriods">{{currentLanguageNameField(sp)}}</th> </tr> <tr> <th colspan="3" class="dividerBorder"> <md-checkbox ng-model="formState.showWeeks">{{\'lessonplan.showWeeks\' | translate}}</md-checkbox> <md-checkbox ng-model="formState.showCapacityTypes">{{\'lessonplan.showCapacityTypes\' | translate}}</md-checkbox> </th> <th ng-repeat="w in formState.weekNrs track by $index" class="center" ng-class="{dividerBorder: w.endOfPeriod}" ng-style="{background: \'white\'}" title="{{formState.weekBeginningDates[$index] | hoisDate}}">{{w.nr}}</th> </tr> </thead> <!-- journals --> <tbody ng-repeat="journal in record.journals"> <tr> <td colspan="{{::formState.weekNrs.length+3}}" class="dividerBorder"> <span class="bold">{{::journal.nameEt}}:</span>&nbsp; <span ng-repeat="theme in getUniqueJournalThemes(journal.themes)"> <span ng-if="!$first">,&nbsp;</span>{{::theme.nameEt}}&nbsp;{{::theme.credits}}&nbsp;{{\'lessonplan.credits\' | translate}} &nbsp;(<span ng-repeat="(hourCap, hourCount) in theme.hours">{{::getCapacityByCode(hourCap).value.toUpperCase()}}{{hourCount}}{{$last ? "" : "/"}}</span>)</span> <div ng-if="!auth.isAdmin()" style="float: right"> <md-checkbox disabled ng-model="journal.isFiller">{{\'lessonplan.isFiller\' | translate}}</md-checkbox> <md-checkbox disabled ng-model="journal.isConfirmer">{{\'lessonplan.isConfirmer\' | translate}}</md-checkbox> </div> </td> </tr> <tr ng-repeat="ct in getCapacityTypes(journal.hours)" ng-if="formState.showCapacityTypes"> <td rowspan="{{::keys(journal.hours).length+1}}" ng-if="$first"> <div layout="column"> <div layout="row" layout-align="space-around center"> <span> <span ng-repeat="studentGroup in journal.studentGroups"> <br ng-if="!$first"> {{studentGroup}} <br ng-if="$last"> </span> <br> <span ng-repeat="teacher in journal.teachers"> <br ng-if="!$first"> {{teacher.teacher.nameEt}} </span> <br> <div ng-if="journal.groupProportion !== \'PAEVIK_GRUPI_JAOTUS_1\'" layout="row"> <label>{{\'lessonplan.journal.groupProportion\' | translate}} &nbsp;</label> <hois-classifier-value ng-model="journal.groupProportion" main-classifier-code="PAEVIK_GRUPI_JAOTUS"></hois-classifier-value> </div> </span> </div> </div> </td> <td class="center">{{ct.value.toUpperCase()}}</td> <td class="center dividerBorder">{{formState.journalTotals[journal.id][ct.code]}}</td> <td ng-if="formState.showWeeks" ng-repeat="h in journal.hours[ct.code] track by $index" ng-class="{dividerBorder: formState.weekNrs[$index].endOfPeriod}" class="center">{{journal.hours[ct.code][$index]}}</td> <td ng-if="!formState.showWeeks" colspan="{{::sp.weekNrs.length}}" ng-repeat="sp in formState.studyPeriods track by $index" class="center dividerBorder">{{journal.spHours[ct.code][$index]}}</td> </tr> <tr> <td ng-if="!formState.showCapacityTypes"> <div> <span style="float:left"> <span ng-repeat="teacher in journal.teachers"> <br ng-if="!$first"> {{teacher.teacher.nameEt}} </span> </span> </div> <div ng-if="journal.groupProportion !== \'PAEVIK_GRUPI_JAOTUS_1\'"> <label>{{\'lessonplan.journal.groupProportion\' | translate}}</label> <hois-classifier-value ng-model="journal.groupProportion" main-classifier-code="PAEVIK_GRUPI_JAOTUS"></hois-classifier-value> </div> </td> <td>{{\'lessonplan.total\' | translate}}</td> <td class="center dividerBorder">{{formState.journalTotals[journal.id].__}}</td> <td ng-if="formState.showWeeks" ng-repeat="w in formState.weekNrs track by $index" ng-class="{dividerBorder: formState.weekNrs[$index].endOfPeriod}" class="center">{{formState.journalTotals[journal.id]._[$index]}}</td> <td ng-if="!formState.showWeeks" colspan="{{::sp.weekNrs.length}}" ng-repeat="sp in formState.studyPeriods track by $index" class="center dividerBorder">{{formState.journalTotals[journal.id]._spTotals[$index]}}</td> </tr> </tbody> <!-- grand totals --> <tbody md-colors="{background: \'background-200\'}"> <tr ng-repeat="ct in getCapacityTypes(formState.grandTotals)" ng-if="formState.showCapacityTypes"> <td rowspan="{{keys(formState.grandTotals).length+1}}" ng-if="$first"> {{currentLanguageNameField(module)}}&nbsp;{{\'lessonplan.grandTotal\' | translate}} </td> <td class="center">{{ct.value.toUpperCase()}}</td> <td class="center dividerBorder">{{formState.grandTotals._[ct.code]}}</td> <td ng-if="formState.showWeeks" ng-repeat="h in formState.grandTotals[ct.code] track by $index" ng-class="{dividerBorder: formState.weekNrs[$index].endOfPeriod}" class="center">{{h | hoisNumber:1}}</td> <td ng-if="!formState.showWeeks" ng-repeat="sp in formState.studyPeriods track by $index" colspan="{{::sp.weekNrs.length}}" class="center dividerBorder">{{formState.capGrandTotalsSp[ct.code][$index] | hoisNumber:1}}</td> </tr> <tr> <td colspan="{{formState.showCapacityTypes ? 1 : 2}}">{{\'lessonplan.total\' | translate}}</td> <td class="center dividerBorder">{{formState.grandTotals.__}}</td> <td ng-if="formState.showWeeks" ng-repeat="h in formState.grandTotals._._ track by $index" ng-class="{dividerBorder: formState.weekNrs[$index].endOfPeriod}" class="center">{{h | hoisNumber:1}}</td> <td ng-if="!formState.showWeeks" ng-repeat="sp in formState.studyPeriods track by $index" colspan="{{::sp.weekNrs.length}}" class="center dividerBorder">{{formState.grandTotalsSp[$index] | hoisNumber:1}}</td> </tr> </tbody> </table> </md-table-container> <br> <md-table-container ng-if="record.subjects.length > 0"> <table class="subject-study-period"> <!-- Header --> <thead> <tr> <th rowspan="2" class="dividerBorder"><span style="float: left">{{\'lessonplan.subjects\' | translate}}</span></th> <th colspan="{{formState.capacityTypes.length}}" ng-repeat="sp in formState.studyPeriods" class="dividerBorder">{{currentLanguageNameField(sp)}}</th> <th rowspan="2">{{\'lessonplan.total\' | translate}}</th> </tr> <tr> <td ng-if="formState.subjectCapacityTypes.length" ng-repeat="sct in formState.subjectCapacityTypes track by $index" class="center" ng-class="{dividerBorder: sct.endOfPeriod}">{{sct.value.toUpperCase()}}</td> <td ng-if="!formState.subjectCapacityTypes.length" ng-repeat="sp in formState.studyPeriods" class="center">-</td> </tr> </thead> <!-- Subjects --> <tbody ng-repeat="subject in record.subjects"> <tr class="bold-top-line"> <td class="bold dividerBorder"> <span>{{currentLanguageNameField(subject)}}</span> </td> <td ng-repeat="sct in formState.subjectCapacityTypes track by $index" ng-class="{dividerBorder: sct.endOfPeriod}">{{(subject.hours[sct.studyPeriod] || {})[sct.code]}}</td> <td>{{sumSubjectHours(subject.hours)}}</td> </tr> <tr ng-repeat="studentGroup in subject.studentGroups"> <td class="dividerBorder"> <span>{{studentGroup.studentGroups.join(\', \')}}</span> <span ng-if="subject.groupProportion && subject.groupProportion !== \'PAEVIK_GRUPI_JAOTUS_1\'" style="float: right"> <span class="subject-study-period-proportion">{{\'subjectStudyPeriod.proportion\' | translate | lowercase}}: <hois-classifier-value ng-model="subject.groupProportion" main-classifier-code="PAEVIK_GRUPI_JAOTUS"></hois-classifier-value> </span> </span> </td> <td ng-repeat="sct in formState.subjectCapacityTypes track by $index" ng-class="{dividerBorder: sct.endOfPeriod}"> {{(studentGroup.hours[sct.studyPeriod] || {})[sct.code]}} </td> <td>{{sumSubjectHours(studentGroup.hours)}}</td> </tr> <!-- Total --> <tr class="bold"> <td class="dividerBorder">{{\'lessonplan.total\' | translate}}</td> <td ng-repeat="sct in formState.subjectCapacityTypes track by $index" ng-class="{dividerBorder: sct.endOfPeriod}">{{(subject.capacityTotals[sct.studyPeriod] || {})[sct.code] || 0}}</td> <td>{{sumSubjectHours(subject.capacityTotals)}}</td> </tr> </tbody> <!-- Grand Total --> <tr class="bold bold-top-line" md-colors="{background: \'background-200\'}"> <td class="dividerBorder">{{\'lessonplan.grandTotal\' | translate | uppercase}}</td> <td ng-repeat="sct in formState.subjectCapacityTypes track by $index" ng-class="{dividerBorder: sct.endOfPeriod}">{{(record.subjectTotals[sct.studyPeriod] || {})[sct.code] || 0}}</td> <td>{{sumSubjectHours(record.subjectTotals)}}</td> </tr> </table> </md-table-container> </div> <div> <md-button ng-href="{{excel(formState.xlsUrl)}}" class="md-raised">{{\'main.button.printXls\' | translate}}</md-button> <md-button ng-href="#/lessonplans/vocational/byteacher" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </div> <style>.subject-study-period td {\r\n    min-width: 0 !important;\r\n    padding: 5px !important;\r\n  }\r\n  .subject-study-period th {\r\n    padding: 3px !important;\r\n  }\r\n  tr.bold-top-line,\r\n  tr.bold-top-line td {\r\n      border-top: #525252 2px solid !important;\r\n  }\r\n  .subject-study-period td,\r\n  .subject-study-period th {\r\n      border-bottom: none !important;\r\n  }</style>'),a.put("login/login.dialog.html",'<md-dialog style="width: 400px; height: 320px"> <md-toolbar style="height: 40px; min-height: 40px !important"> <div class="md-toolbar-tools"> <span flex></span> <md-button class="md-icon-button" ng-click="cancel()"> <span class="material-icons">close</span> </md-button> </div> </md-toolbar> <md-dialog-content> <md-tabs md-dynamic-height md-border-bottom> <md-tab label="{{ \'main.login.tara.title\' | translate }}"> <md-content class="md-padding"> <md-button class="md-raised md-primary" ng-href="{{taraLoginUrl}}">{{ \'main.logIn\' | translate }}</md-button> </md-content> </md-tab> <md-tab label="{{ \'main.login.idcard.title\' | translate }}"> <md-content class="md-padding"> <md-button class="md-raised md-primary" ng-href="{{idCardLoginUrl}}">{{ \'main.logIn\' | translate }}</md-button> </md-content> </md-tab> <md-tab label="{{ \'main.login.mobileid.title\' | translate }}"> <md-content class="md-padding"> <form name="mobileIdLoginForm"> <md-input-container class="md-block"> <label flex>{{ \'main.login.mobileid.mobilenumber\' | translate }}</label> <input type="text" flex class="form-control" name="mobilenumber" ng-model="mobilenumber" required> </md-input-container> <md-button class="md-raised md-primary" ng-click="mIdLogin()">{{ \'main.logIn\' | translate }}</md-button> </form> </md-content> </md-tab> <md-tab label="{{ \'main.login.harid.title\' | translate }}"> <md-content class="md-padding"> <md-button class="md-raised md-primary" ng-href="{{haridLoginUrl}}">{{ \'main.logIn\' | translate }}</md-button> </md-content> </md-tab> <md-tab label="{{ \'main.login.user.title\' | translate }}"> <md-content class="md-padding"> <form name="userLoginForm"> <md-input-container class="md-block"> <label flex>{{ \'main.login.user.school\' | translate }}</label> <md-select flex class="form-control" name="school" ng-model="credentials.school" required> <md-option ng-value="school.id" ng-repeat="school in schools">{{currentLanguageNameField(school)}}</md-option> </md-select> </md-input-container> <md-input-container class="md-block"> <label flex>{{ \'main.login.user.username\' | translate }}</label> <input type="text" flex class="form-control" name="username" ng-model="credentials.username" required> </md-input-container> <md-input-container class="md-block"> <label flex>{{ \'main.login.user.password\' | translate }}</label> <input type="password" flex class="form-control" name="password" ng-model="credentials.password" required> </md-input-container> <md-button class="md-raised md-primary" ng-click="login()">{{ \'main.logIn\' | translate }}</md-button> </form> </md-content> </md-tab> </md-tabs> </md-dialog-content> </md-dialog>'),
a.put("login/m-id.login.dialog.html",'<md-dialog> <form> <md-dialog-content> <div class="md-dialog-content" layout="column" layout-align="center center"> <p>{{ \'main.login.mobileid.instructions\' | translate }}</p> <h1>{{challengeID}}</h1> </div> </md-dialog-content> </form> </md-dialog>'),a.put("login/message.login.dialog.html",'<md-dialog> <form> <md-dialog-content> <div class="md-dialog-content"> {{ message | translate }} </div> </md-dialog-content> </form> </md-dialog>'),a.put("login/session.timed.out.dialog.html",'<md-dialog aria-label="grade add dialog" flex="30" flex-xs="100"> <md-dialog-content> <div class="md-dialog-content"> <p translate="main.messages.sessionHasTimedOut"></p> </div> </md-dialog-content> <md-dialog-actions layout="row" layout-align="start center"> <md-button ng-click="ok()" class="md-raised">{{\'main.button.ok\' | translate}}</md-button> </md-dialog-actions> </md-dialog>'),a.put("login/session.timing.out.dialog.html",'<md-dialog aria-label="grade add dialog" flex="30" flex-xs="100"> <md-dialog-content> <div class="md-dialog-content"> <p translate="main.messages.sessionIsTimingOut"></p> </div> </md-dialog-content> <md-dialog-actions layout="row" layout-align="start center"> <md-button ng-click="refresh()" class="md-raised">{{\'main.button.refresh\' | translate}}</md-button> </md-dialog-actions> </md-dialog>'),a.put("logs/logentry.view.dialog.html",'<md-dialog aria-label="grade add dialog" flex="75" flex-xs="100"> <md-toolbar> <div class="md-toolbar-tools"> <h2 flex>{{messagePrefix + record.wsName | translate}}</h2> <span flex> <hois-value class="md-button md-raised" ng-if="logType === \'ekis\' && record.directive.id" value="record.directive.nameEt" href-value="\'#/directives/\' + record.directive.id + \'/view\'"></hois-value> </span> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <div class="md-dialog-content"> <div layout="row"> <md-input-container> <label>{{\'logs.request\' | translate}}</label>&nbsp; <pre><hois-value value="record.request | limitTo:requestLength"></hois-value></pre> <a ng-click="showAll(true)" ng-if="requestLength">&hellip;</a> </md-input-container> </div> <hr> <div layout="row"> <md-input-container> <label>{{\'logs.response\' | translate}}</label>&nbsp; <pre><hois-value value="record.response | limitTo:responseLength"></hois-value></pre> <a ng-click="showAll(false)" ng-if="responseLength">&hellip;</a> </md-input-container> </div> </div> </md-dialog-content> <md-dialog-actions layout="row" layout-align="start center"> <md-button ng-click="cancel()" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </md-dialog-actions> </md-dialog>'),a.put("logs/logs.view.html",'<div layout-padding> <div flex> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <form ng-submit="loadData()" layout="column" name="logForm" ng-model-options="{allowInvalid: true}"> <div flex> <div layout-gt-sm="row" layout="column" layout-align-gt-sm="start end" layout-align="start stretch"> <md-input-container ng-if="logType !== \'rr\'" flex="45" flex-sm="100" flex-xs="100" style="margin-bottom: 4px"> <label>{{\'logs.name\' | translate}}</label> <md-select ng-model="criteria.messageType"> <md-option md-option-empty></md-option> <md-option ng-repeat="val in messageTypes" ng-value="val"> {{messagePrefix + val | translate}} </md-option> </md-select> </md-input-container> <md-input-container ng-if="logType === \'rr\'" flex="45" flex-sm="100" flex-xs="100" style="margin-bottom: 4px"> <label>{{\'logs.idcode\' | translate}}</label> <input ng-model="criteria.idcode" name="idcode" pattern="^\\d+$" md-maxlength="11" autofocus> </md-input-container> <div flex-gt-sm="50" flex="100" flex-offset="0" flex-offset-gt-sm="5"> <label class="common-label">{{\'logs.sentDatesRange\' | translate}}</label> <div layout="row"> <md-input-container> <label>{{\'main.from\' | translate}}</label> <md-datepicker ng-model="criteria.from" md-max-date="criteria.thru" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> <md-input-container> <label>{{\'main.thru\' | translate}}</label> <md-datepicker ng-model="criteria.thru" md-min-date="criteria.from" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> </div> </div> </div> <div layout="row"> <md-input-container flex="45"> <md-checkbox ng-model="criteria.errors" aria-label="show only errors"> {{\'logs.onlyErrors\' | translate}} </md-checkbox> </md-input-container> </div> </div> <div layout="row"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> </div> </form> </fieldset> </div> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column>{{\'logs.name\' | translate}}</th> <th md-column md-order-by="inserted">{{\'logs.time\' | translate}}</th> <th md-column ng-if="logType === \'ekis\'">{{\'logs.directive\' | translate}}</th> <th md-column>{{\'logs.error\' | translate}}</th> <th md-column>{{\'logs.message\' | translate}}</th> <th md-column>{{\'logs.insertedBy\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell> <a md-no-ink class="md-primary" ng-click="logentry(row)">{{::(messagePrefix + row.wsName) | translate}}</a> </td> <td md-cell>{{::row.inserted | hoisDateTime}}</td> <td md-cell ng-if="logType === \'ekis\'">{{currentLanguageNameField(row.directive)}}</td> <td md-cell>{{row.error ? \'main.yes\' : \'main.no\' | translate}}</td> <td md-cell>{{::row.logTxt}}</td> <td md-cell>{{::row.insertedBy}}</td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\' }" md-page-select></md-table-pagination> </div> </div>'),a.put("message/message.new.html",'<div layout="column" layout-padding> <form name="messageNewForm"> <div layout="column"> <md-input-container flex="50" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'message.subject\' | translate}}</label> <input ng-model="record.subject" type="text" md-maxlength="1000" required> </md-input-container> <md-input-container flex="50" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'message.content\' | translate}}</label> <textarea ng-model="record.content" max-rows="20" md-maxlength="2000" required></textarea> </md-input-container> <md-input-container flex="50" flex-sm="100" flex-xs="100"> <label>{{\'message.targetGroup\' | translate}}</label> <hois-classifier-select ng-model="targetGroup" model-value-attr="code" main-classifier-code="ROLL" show-only-values="targetGroups" required ng-change="tarGetGroupChanged()"></hois-classifier-select> </md-input-container> <!--hois-autocomplete is not used as query needs additional parameters (school, role)--> <md-autocomplete ng-show="targetGroup" name="receiverInput" md-selected-item="receiver" md-search-text="queryText" md-items="item in querySearch(queryText)" md-item-text="item.fullname" md-min-length="3" md-floating-label="{{\'message.receiver\' | translate}}" ng-model="queryText" md-no-cache class="small-margin" md-selected-item-change="addReceiver(receiver)"> <md-item-template> <span md-highlight-text="queryText" md-highlight-flags="^i">{{item.fullname}}</span> </md-item-template> <md-not-found> {{\'main.messages.error.notFound\' | translate}} </md-not-found> </md-autocomplete> <!--  view for school admin   --> <div ng-show="targetGroup && targetGroup === \'ROLL_T\' && auth.isAdmin()" layout="column"> <md-input-container flex="50" flex-sm="100" flex-xs="100"> <label>{{\'message.curriculumStudents\' | translate}}</label> <hois-select multiple ng-model="curriculum" type="curriculum" criteria="{closed: false}" sorted-query="true"></hois-select> </md-input-container> <hois-autocomplete flex="50" flex-sm="100" flex-xs="100" display="code" ha-attribute="id" ng-model="studentGroup" url="/message/studentgroups" multiple label="message.studyGroupStudents" additional-query-params="{curriculums: curriculum, studyForm: studyForm}" no-paging="true" ha-ignored="{{auth.isAdmin() ? \'false\' : \'true\'}}"></hois-autocomplete> <md-input-container flex="50" flex-sm="100" flex-xs="100"> <label>{{\'message.studyFormStudents\' | translate}}</label> <hois-classifier-select multiple ng-model="studyForm" model-value-attr="code" main-classifier-code="OPPEVORM"></hois-classifier-select> </md-input-container> </div> <!--  view for teacher   --> <md-input-container flex="50" flex-sm="100" flex-xs="100" ng-show="targetGroup && auth.isTeacher()"> <label>{{\'message.searchType\' | translate}}</label> <hois-select ng-model="groupSearchType" values="groupSearchTypes" value-property="code" show-property="name" ng-change="searchTypeChanged()"></hois-select> </md-input-container> <md-input-container flex="50" flex-sm="100" flex-xs="100" ng-show="targetGroup && targetGroup === \'ROLL_T\' && groupSearchType === \'SEARCH_JOURNAL\' && auth.isTeacher()"> <label>{{\'message.journalStudent\' | translate}}</label> <hois-select multiple ng-model="journalStudent" values="journals"></hois-select> </md-input-container> <md-input-container flex="50" flex-sm="100" flex-xs="100" ng-show="targetGroup && targetGroup === \'ROLL_L\' && groupSearchType === \'SEARCH_JOURNAL\' && auth.isTeacher()"> <label>{{\'message.journalStudentParent\' | translate}}</label> <hois-select multiple ng-model="journalStudentParent" values="journals"></hois-select> </md-input-container> <md-input-container flex="50" flex-sm="100" flex-xs="100" ng-show="targetGroup && targetGroup === \'ROLL_T\' && groupSearchType === \'SEARCH_SUBJECTS\' && auth.isTeacher()"> <label>{{\'message.subjectStudent\' | translate}}</label> <hois-select multiple ng-model="subjectStudent" values="subjects"></hois-select> </md-input-container> <md-input-container flex="50" flex-sm="100" flex-xs="100" ng-show="targetGroup && targetGroup === \'ROLL_L\' && groupSearchType === \'SEARCH_SUBJECTS\' && auth.isTeacher()"> <label>{{\'message.subjectStudentParent\' | translate}}</label> <hois-select multiple ng-model="subjectStudentParent" values="subjects"></hois-select> </md-input-container> <hois-autocomplete flex="50" flex-sm="100" flex-xs="100" ng-show="targetGroup && targetGroup === \'ROLL_T\' && groupSearchType === \'SEARCH_STUDENT_GROUP\' && auth.isTeacher()" display="code" ha-attribute="id" ng-model="studentGroup" url="/message/studentgroups" multiple label="message.studyGroupStudents" additional-query-params="{curriculums: curriculum, studyForm: studyForm}" no-paging="true" ha-ignored="{{auth.isTeacher() ? \'false\' : \'true\'}}"></hois-autocomplete> <hois-autocomplete flex="50" flex-sm="100" flex-xs="100" ng-show="targetGroup && targetGroup === \'ROLL_L\' && groupSearchType === \'SEARCH_STUDENT_GROUP\' && auth.isTeacher()" display="code" ha-attribute="id" ng-model="studyGroupStudentsParents" url="/message/studentgroups" multiple label="message.studyGroupStudentsParents" additional-query-params="{curriculums: curriculum, studyForm: studyForm}" no-paging="true" ha-ignored="{{auth.isTeacher() ? \'false\' : \'true\'}}"></hois-autocomplete> <h2 ng-class="{invalid: messageNewForm.$submitted && receivers.length === 0}">{{\'message.messageReceiver\' | translate}} *</h2> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'message.receiver\' | translate}}</th> <th md-column ng-if="auth.isAdmin()">{{\'student.idcode\' | translate}}</th> <th md-column ng-if="auth.isAdmin() || auth.isTeacher()">{{\'message.targetGroup\' | translate}}</th> <th md-column ng-if="auth.isTeacher() && groupSearchType === \'SEARCH_STUDENT_GROUP\'">{{\'message.curriculum\' | translate}}</th> <th md-column ng-if="auth.isTeacher() && groupSearchType === \'SEARCH_STUDENT_GROUP\'">{{\'message.studentGroup\' | translate}}</th> <th md-column ng-if="auth.isTeacher() && groupSearchType === \'SEARCH_JOURNAL\'">{{\'message.journalLabel\' | translate}}</th> <th md-column ng-if="auth.isTeacher() && groupSearchType === \'SEARCH_SUBJECTS\'">{{\'message.subjectLabel\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="receiver in receivers" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{receiver.fullname}}</td> <td md-cell ng-if="auth.isAdmin()"> <span ng-if="receiver.role.length === 1 && receiver.role[0] === \'ROLL_T\'">{{receiver.idcode}}</span> </td> <td md-cell ng-if="auth.isAdmin() || auth.isTeacher()"> <p ng-repeat="role in receiver.role"> <hois-classifier-value ng-model="role" main-classifier-code="ROLL"></hois-classifier-value> </p> </td> <td md-cell ng-if="auth.isTeacher() && groupSearchType === \'SEARCH_STUDENT_GROUP\'"> <span>{{currentLanguageNameField(receiver.curriculum)}}</span> </td> <td md-cell ng-if="auth.isTeacher() && groupSearchType === \'SEARCH_STUDENT_GROUP\'"> <span>{{currentLanguageNameField(receiver.studentGroup)}}</span> </td> <td md-cell ng-if="auth.isTeacher() && groupSearchType === \'SEARCH_JOURNAL\'"> <span>{{currentLanguageNameField(receiver.journal)}}</span> </td> <td md-cell ng-if="auth.isTeacher() && groupSearchType === \'SEARCH_SUBJECTS\'"> <span>{{currentLanguageNameField(receiver.subject)}}</span> </td> <td md-cell> <md-button ng-if="receiver.addedWithAutocomplete" ng-click="removeReceiver(receiver)" class="remove nomargin">&times;</md-button> </td> </tr> </tbody> </table> </div> <div layout="row"> <md-button class="md-raised md-primary" ng-click="send()">{{\'main.button.send\' | translate}}</md-button> <md-button class="md-raised" ng-click="back(\'#/messages/sent\', messageNewForm, \'message.confirmClose\')">{{\'main.button.back\' | translate}}</md-button> </div> </form> </div>'),a.put("message/message.received.html",'<div id="scrolling_div" style="overflow: auto"> <md-nav-bar md-selected-nav-item="currentNavItem"> <md-nav-item md-nav-href="#/messages/received?_menu" name="message.received">{{\'message.received\' | translate}}</md-nav-item> <md-nav-item md-nav-href="#/messages/sent?_menu" name="message.sent">{{\'message.sent\' | translate}}</md-nav-item> <md-nav-item md-nav-href="#/messages/automatic/sent?_menu" name="message.automaticSent" ng-if="canSeeAutomatic">{{\'message.automaticSent\' | translate}}</md-nav-item> </md-nav-bar> </div> <div class="ois-form-layout-padding ois-form-layout" ng-cloak> <form name="searchForm" ng-submit="searchForm.$valid && loadData()" layout="column" novalidate> <div layout="row"> <md-input-container flex="50" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'message.subject\' | translate}}</label> <input ng-model="criteria.subject" type="text" md-maxlength="255"> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="20" flex-sm="100" flex-xs="100"> <label>{{\'message.sentDatesRange\' | translate}}</label> <input style="visibility: hidden"> </md-input-container> <div flex="33"> <md-input-container flex> <label>{{\'main.from\' | translate}}</label> <md-datepicker ng-model="criteria.sentFrom" md-max-date="criteria.sentThru" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> <md-input-container flex> <label>{{\'main.thru\' | translate}}</label> <md-datepicker ng-model="criteria.sentThru" md-min-date="criteria.sentFrom" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> </div> </div> <div layout="row"> <md-input-container flex="50" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'message.sender\' | translate}}</label> <input ng-model="criteria.sender" type="text" md-maxlength="255"> </md-input-container> </div> <div layout="row" layout-xs="column"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> <md-button class="md-raised" ng-if="formState.canSend" ng-href="/#/message/new">{{\'message.send\' | translate}}</md-button> </div> </form> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="subject">{{\'message.subject\' | translate}}</th> <th md-column md-order-by="inserted">{{\'message.dateSent\' | translate}}</th> <th md-column md-order-by="p.lastname,p.firstname">{{\'message.sender\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell><a href="#/message/{{row.id}}/view?backUrl=received" ng-class="{bold: !row.isRead}">{{::row.subject}}</a></td> <td md-cell>{{row.dateSent | hoisDateTime}}</td> <td md-cell>{{::row.sender}}</td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> </div>'),a.put("message/message.respond.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <form layout="column" name="messageRespondForm" novalidate> <div layout="row"> <md-input-container flex="50" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'message.subject\' | translate}}</label> <input ng-model="record.subject" type="text" md-maxlength="1000" required> </md-input-container> </div> <div layout="row"> <md-input-container flex="50" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'message.content\' | translate}}</label> <textarea ng-model="record.content" max-rows="20" md-maxlength="2000" required id="content"></textarea> </md-input-container> </div> <div layout="row"> <md-button class="md-raised md-primary" ng-click="send()">{{\'main.button.send\' | translate}}</md-button> <md-button class="md-raised" ng-href="{{::formState.backUrl}}">{{\'main.button.back\' | translate}}</md-button> </div> </form> </div>'),a.put("message/message.sent.html",'<div id="scrolling_div" style="overflow: auto"> <md-nav-bar md-selected-nav-item="currentNavItem"> <md-nav-item md-nav-href="#/messages/received?_menu" name="message.received">{{\'message.received\' | translate}}</md-nav-item> <md-nav-item md-nav-href="#/messages/sent?_menu" name="message.sent">{{\'message.sent\' | translate}}</md-nav-item> <md-nav-item md-nav-href="#/messages/automatic/sent?_menu" name="message.automaticSent" ng-if="canSeeAutomatic">{{\'message.automaticSent\' | translate}}</md-nav-item> </md-nav-bar> </div> <div class="ois-form-layout-padding ois-form-layout" ng-cloak> <form name="searchForm" ng-submit="searchForm.$valid && loadData()" layout="column" novalidate> <div layout="row"> <md-input-container flex="50" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'message.subject\' | translate}}</label> <input ng-model="criteria.subject" type="text" md-maxlength="255"> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="20" flex-sm="100" flex-xs="100"> <label>{{\'message.sentDatesRange\' | translate}}</label> <input style="visibility: hidden"> </md-input-container> <div flex="33"> <md-input-container flex> <label>{{\'main.from\' | translate}}</label> <md-datepicker ng-model="criteria.sentFrom" md-max-date="criteria.sentThru" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> <md-input-container flex> <label>{{\'main.thru\' | translate}}</label> <md-datepicker ng-model="criteria.sentThru" md-min-date="criteria.sentFrom" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> </div> </div> <div layout="row" layout-xs="column"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> <md-button class="md-raised" ng-if="formState.canSend" ng-href="/#/message/new">{{\'message.send\' | translate}}</md-button> </div> </form> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="subject">{{\'message.subject\' | translate}}</th> <th md-column md-order-by="inserted">{{\'message.dateSent\' | translate}}</th> <th md-column>{{\'message.receiver\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell><a href="#/message/{{row.id}}/view">{{::row.subject}}</a></td> <td md-cell>{{row.dateSent | hoisDateTime}}</td> <td md-cell ng-click="row.clicked = !row.clicked"> <span ng-if="!row.clicked">{{showReceivers(row, false)}}</span> <span ng-if="row.clicked">{{showReceivers(row, true)}}</span> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> </div>'),a.put("message/message.view.html",'<div layout-padding ng-cloak class="form-readonly"> <form layout="column" novalidate> <div layout="row"> <md-input-container flex> <label class="textInput">{{\'message.subject\' | translate}}</label> <hois-value value="record.subject"> </md-input-container> </div> <div layout="row"> <md-input-container flex> <label class="textInput">{{\'message.content\' | translate}}</label> <hois-value value="record.content"> </md-input-container> </div> <div layout="row" ng-show="!isSent"> <md-input-container flex> <label class="textInput">{{\'message.sender\' | translate}}</label> <hois-value value="record.sendersName"> </md-input-container> </div> <div layout="row" ng-show="isSent"> <md-input-container flex> <label class="textInput">{{\'message.receiver\' | translate}}</label> <hois-value value="record.receivers"> </md-input-container> </div> <div layout="row"> <md-input-container flex> <label>{{\'message.dateSent\' | translate}}</label> <hois-value value="record.inserted | hoisDate"> </md-input-container> </div> <div layout="row"> <md-button class="md-raised md-primary" ng-if="!isSent && record.sendersId !== -1" ng-href="/#/message/{{record.id}}/respond">{{\'message.respond\' | translate}}</md-button> <md-button class="md-raised" ng-click="back(\'#/messages/sent\')">{{\'main.button.back\' | translate}}</md-button> </div> </form> </div>'),a.put("messageTemplate/message.template.edit.html",'<div layout="column" layout-padding> <form name="messageTemplateForm"> <div layout="column"> <md-input-container ng-if="isValid"> <label>{{\'messageTemplate.type\' | translate}}</label> <hois-classifier-select ng-if="isValid" ng-model="record.type" model-value-attr="code" main-classifier-code="TEATE_LIIK" required filter-values="allowedTypes" ng-disabled="readOnly"></hois-classifier-select> </md-input-container> <md-input-container ng-if="!isValid"> <label>{{\'messageTemplate.type\' | translate}}</label> <hois-classifier-select ng-if="!isValid" ng-model="record.type" model-value-attr="code" main-classifier-code="TEATE_LIIK" required ng-disabled="readOnly"></hois-classifier-select> </md-input-container> <md-input-container> <label>{{\'generalmessage.title\' | translate}}</label> <textarea ng-model="record.headline" required md-maxlength="1000" max-rows="2" ng-readonly="readOnly"></textarea> </md-input-container> <md-input-container> <label>{{\'generalmessage.content\' | translate}}</label> <textarea ng-model="record.content" required md-maxlength="2000" max-rows="2" ng-readonly="readOnly"></textarea> </md-input-container> <div layout="row"> <md-input-container> <label>{{\'messageTemplate.validFrom\' | translate}}</label> <md-datepicker ng-model="record.validFrom" ng-change="getIsValid()" ng-disabled="readOnly"></md-datepicker> </md-input-container> <md-input-container flex-offset="5"> <label>{{\'messageTemplate.validThru\' | translate}}</label> <md-datepicker ng-model="record.validThru" md-min-date="record.validFrom" ng-change="getIsValid()" ng-disabled="readOnly"></md-datepicker> </md-input-container> </div> </div> <div layout="row"> <md-button class="md-raised md-primary" ng-href="#/messageTemplate/{{::record.id}}/edit" ng-if="readOnly && isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_AUTOTEADE\')">{{\'main.button.change\' | translate}}</md-button> <md-button class="md-raised md-primary" ng-click="save()" ng-if="!readOnly">{{\'main.button.save\' | translate}}</md-button> <md-button class="md-raised md-default" ng-click="delete()" ng-if="record.id && !readOnly">{{\'main.button.delete\' | translate}}</md-button> <md-button class="md-raised md-default" ng-if="!readOnly" ng-click="back(\'#/messageTemplate\', messageTemplateForm)">{{\'main.button.back\' | translate}}</md-button> <md-button class="md-raised md-default" ng-if="readOnly" ng-click="back(\'#/messageTemplate\')">{{\'main.button.back\' | translate}}</md-button> </div> </form> </div>'),a.put("messageTemplate/message.template.search.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <form name="searchForm" ng-submit="searchForm.$valid && loadData()" layout="column" novalidate ng-model-options="{allowInvalid: true}"> <md-input-container> <label>{{\'messageTemplate.type\' | translate}}</label> <hois-classifier-select ng-model="criteria.type" model-value-attr="code" main-classifier-code="TEATE_LIIK" multiple></hois-classifier-select> </md-input-container> <md-input-container> <label class="textInput">{{\'generalmessage.title\' | translate}}</label> <input ng-model="criteria.headline" type="text" md-maxlength="255"> </md-input-container> <div layout="row" layout-sm="column" layout-xs="column"> <div flex="1//"> <md-input-container flex> <label>{{\'messageTemplate.validFrom\' | translate}}</label> <md-datepicker ng-model="criteria.validFrom" md-max-date="criteria.validThru" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> <md-input-container flex flex-offset="5"> <label>{{\'messageTemplate.validThru\' | translate}}</label> <md-datepicker ng-model="criteria.validThru" md-min-date="criteria.validFrom" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> </div> </div> <md-checkbox ng-model="criteria.valid" aria-label="{{\'main.valid\' | translate}}"> {{\'main.valid\' | translate}} </md-checkbox> <div layout="row"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> <md-button class="md-raised" ng-if="isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_AUTOTEADE\')" ng-href="#/messageTemplate/new">{{\'main.button.create\' | translate}}</md-button> </div> </form> </fieldset> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="type.{{currentLanguageNameField()}}">{{\'messageTemplate.type\' | translate}}</th> <th md-column md-order-by="headline">{{\'generalmessage.title\' | translate}}</th> <th md-column md-order-by="validFrom">{{\'messageTemplate.validFrom\' | translate}}</th> <th md-column md-order-by="validThru">{{\'messageTemplate.validThru\' | translate}}</th> <th md-column>{{\'main.status\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell><a ng-href="#/messageTemplate/{{::row.id}}/view">{{currentLanguageNameField(row.type)}}</a></td> <td md-cell>{{::row.headline}}</td> <td md-cell>{{::row.validFrom | hoisDate}}</td> <td md-cell>{{::row.validThru | hoisDate}}</td> <td md-cell>{{row._isValid ? \'main.valid\' : \'main.invalid\' | translate}}</td> <td md-cell> <md-button md-no-ink class="md-primary change-button" ng-if="isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_AUTOTEADE\')" ng-href="#/messageTemplate/{{::row.id}}/edit">{{\'main.button.change\' | translate}}</md-button> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> </div>'),a.put("midtermTask/midtermTask.copy.dialog.html",'<md-dialog aria-label="{{\'midtermTask.copy\' | translate}}" flex="50" flex-sm="70" flex-xs="100"> <form name="dialogForm" ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2>{{\'midtermTask.copy\' | translate}}</h2> <span flex></span> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <span flex></span> <div class="ois-form-layout" layout="column" layout-margin ng-cloak> <div layout="column"> <!-- hois-value and disabled attribute have weird behaviour in IE browser --> <md-input-container ng-show="formState.auth.isTeacher()"> <label>{{formState.auth.higher ? (\'midtermTask.teacherHigher\' | translate) : (\'midtermTask.teacherVocational\' | translate)}}</label> <input type="text" ng-model="formState.auth.fullname" readonly> </md-input-container> <md-input-container> <label>{{\'midtermTask.studyPeriod\' | translate}}</label> <hois-select ng-model="criteria.studyPeriod" values="studyPeriods"></hois-select> </md-input-container> <hois-autocomplete ng-model="criteria.teacherObject" method="teachers" name="teacher" label="{{formState.auth.higher ? \'midtermTask.teacherHigher\' : \'midtermTask.teacherVocational\'}}" ng-show="formState.auth.isAdmin()"></hois-autocomplete> <hois-autocomplete ng-model="criteria.subjectObject" method="subjects" name="subject" label="midtermTask.subject"></hois-autocomplete> </div> </div> <div layout="row"> <md-button type="submit" ng-click="loadData()" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> </div> <md-table-container flex> <table md-table md-row-select="true" md-progress="tabledata.$promise" ng-model="subjectStudyPeriodSelected"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="subject.{{currentLanguageNameField()}}">{{\'midtermTask.subject\' | translate}}</th> <th md-column ng-show="formState.auth.isAdmin()"> {{formState.auth.higher ? (\'midtermTask.teacherHigher\' | translate) : (\'midtermTask.teacherVocational\' | translate)}} </th> <th md-column>{{\'midtermTask.midtermTasks\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row md-select="row" md-select-id="row.id" ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{currentLanguageNameField(row.subject)}}</td> <td md-cell ng-show="formState.auth.isAdmin()"> <table> <tr ng-repeat="teacher in row.teachers | orderBy"> <td>{{teacher}}</td> </tr> </table> </td> <td md-cell> <table> <tr ng-repeat="midtermTask in row.midtermTasks | orderBy: currentLanguageNameField()"> <td>{{currentLanguageNameField(midtermTask)}}</td> </tr> </table> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\' }" md-page-select></md-table-pagination> </md-dialog-content> <md-dialog-actions layout="row" layout-align="start center"> <md-button class="md-raised md-primary" ng-click="submit()" ng-disabled="subjectStudyPeriodSelected.length !== 1">{{"main.button.add" | translate}}</md-button> <md-button class="md-raised" ng-click="cancel()">{{"main.button.close" | translate}}</md-button> </md-dialog-actions> </form> </md-dialog>'),
a.put("midtermTask/midtermTask.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <form name="midtermTaskForm" layout="column" class="nomargin"> <md-table-container> <table md-table> <thead md-head> <tr md-row ng-if="!record.canBeEdited"> <th md-column>{{\'midtermTask.nr\' | translate}}</th> <th md-column ng-click="sortBy(\'nameEt\')"> {{\'midtermTask.nameEt\' | translate}} * <span class="sortorder" ng-show="propertyName === \'nameEt\'" ng-class="{reverse: reverse}"></span> </th> <th md-column ng-click="sortBy(\'nameEn\')"> {{\'midtermTask.nameEn\' | translate}} <span class="sortorder" ng-show="propertyName === \'nameEn\'" ng-class="{reverse: reverse}"></span> </th> <th md-column ng-click="sortBy(\'descriptionEt\')"> {{\'midtermTask.descriptionEt\' | translate}} * <span class="sortorder" ng-show="propertyName === \'descriptionEt\'" ng-class="{reverse: reverse}"></span> </th> <th md-column ng-click="sortBy(\'descriptionEn\')"> {{\'midtermTask.descriptionEn\' | translate}} <span class="sortorder" ng-show="propertyName === \'descriptionEn\'" ng-class="{reverse: reverse}"></span> </th> <th md-column ng-click="sortBy(\'maxPoints\')"> {{\'midtermTask.maxPoints\' | translate}} * <span class="sortorder" ng-show="propertyName === \'maxPoints\'" ng-class="{reverse: reverse}"></span> </th> <th md-column ng-click="sortBy(\'percentage\')"> {{\'midtermTask.percentage\' | translate}} * <span class="sortorder" ng-show="propertyName === \'percentage\'" ng-class="{reverse: reverse}"></span> </th> <th md-column ng-click="sortBy(\'taskDate\')"> {{\'midtermTask.taskDate\' | translate}} <span class="sortorder" ng-show="propertyName === \'taskDate\'" ng-class="{reverse: reverse}"></span> </th> <th md-column ng-click="sortBy(\'threshold\')"> {{\'midtermTask.threshold\' | translate}} <span class="sortorder" ng-show="propertyName === \'threshold\'" ng-class="{reverse: reverse}"></span> </th> <th md-column ng-click="sortBy(\'thresholdPercentage\')"> {{\'midtermTask.thresholdPercentage\' | translate}} <span class="sortorder" ng-show="propertyName === \'thresholdPercentage\'" ng-class="{reverse: reverse}"></span> </th> <th md-column></th> </tr> <tr md-row ng-if="record.canBeEdited"> <th md-column>{{\'midtermTask.nr\' | translate}}</th> <th md-column>{{\'midtermTask.nameEt\' | translate}} *</th> <th md-column>{{\'midtermTask.nameEn\' | translate}}</th> <th md-column>{{\'midtermTask.descriptionEt\' | translate}} *</th> <th md-column>{{\'midtermTask.descriptionEn\' | translate}}</th> <th md-column>{{\'midtermTask.maxPoints\' | translate}} *</th> <th md-column>{{\'midtermTask.percentage\' | translate}} *</th> <th md-column>{{\'midtermTask.taskDate\' | translate}}</th> <th md-column>{{\'midtermTask.threshold\' | translate}}</th> <th md-column>{{\'midtermTask.thresholdPercentage\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in record.midtermTasks" ng-class-odd="\'odd\'" ng-class-even="\'even\'" ng-if="record.canBeEdited"> <ng-form name="midtermTaskUnitForm"> <td md-cell> {{$index + 1}} <span ng-if="row.moodleGradeItemId"><md-icon md-font-set="material-icons">school</md-icon></span> </td> <td md-cell> <md-input-container> <input ng-model="row.nameEt" type="text" md-maxlength="255" required aria-label="{{\'midtermTask.nameEt\' | translate}}"> </md-input-container> </td> <td md-cell> <md-input-container> <input ng-model="row.nameEn" type="text" md-maxlength="255" aria-label="{{\'midtermTask.nameEn\' | translate}}"> </md-input-container> </td> <td md-cell> <md-input-container> <input ng-model="row.descriptionEt" type="text" md-maxlength="4000" aria-label="{{\'midtermTask.descriptionEt\' | translate}}" required> </md-input-container> </td> <td md-cell> <md-input-container> <input ng-model="row.descriptionEn" type="text" md-maxlength="4000" aria-label="{{\'midtermTask.descriptionEn\' | translate}}"> </md-input-container> </td> <td md-cell> <md-input-container> <input ng-model="row.maxPoints" type="number" min="0" max="999" required aria-label="{{\'midtermTask.maxPoints\' | translate}}" pattern="^\\d+(\\.\\d{1})?$" ng-disabled="row.moodleGradeItemId"> </md-input-container> </td> <td md-cell> <md-input-container> <input ng-model="row.percentage" type="number" min="0" max="100" required aria-label="{{\'midtermTask.percentage\' | translate}}" pattern="^\\d+$"> </md-input-container> </td> <td md-cell> <md-input-container> <md-datepicker ng-model="row.taskDate" md-open-on-focus aria-label="{{currentLanguageNameField(row)}} {{\'midtermTask.taskDate\' | translate}}"></md-datepicker> </md-input-container> </td> <td md-cell> <md-checkbox ng-model="row.threshold" ng-change="clearThresholdPercentage(row)" aria-label="{{currentLanguageNameField(row)}} {{\'midtermTask.threshold\' | translate}}" ng-disabled="row.moodleGradeItemId"> </md-checkbox> </td> <td md-cell> <md-input-container> <input ng-model="row.thresholdPercentage" type="number" min="0" max="100" ng-disabled="!row.threshold || row.moodleGradeItemId" ng-required="row.threshold" aria-label="{{\'midtermTask.thresholdPercentage\' | translate}}" pattern="^\\d+$"> </md-input-container> </td> <td md-cell><a class="remove nomargin" ng-click="removeRow(row)">&times;</a></td> </ng-form> </tr> <tr md-row ng-repeat="row in record.midtermTasks | orderBy:propertyName:reverse" ng-class-odd="\'odd\'" ng-class-even="\'even\'" ng-if="!record.canBeEdited"> <ng-form name="midtermTaskUnitForm"> <td md-cell>{{$index + 1}}</td> <td md-cell>{{row.nameEt}}</td> <td md-cell>{{row.nameEn}}</td> <td md-cell>{{row.descriptionEt}}</td> <td md-cell>{{row.descriptionEn}}</td> <td md-cell>{{row.maxPoints}}</td> <td md-cell>{{row.percentage}}</td> <td md-cell>{{row.taskDate | hoisDate}}</td> <td md-cell> <md-checkbox ng-model="row.threshold" aria-label="{{currentLanguageNameField(row)}} {{\'midtermTask.threshold\' | translate}}" disabled> </md-checkbox> </td> <td md-cell>{{row.thresholdPercentage}}</td> <td md-cell></td> </ng-form> </tr> <!-- colspan is not used because of the line under previous row on readOnly form --> <tr md-row> <td md-cell></td> <td md-cell></td> <td md-cell></td> <td md-cell></td> <td md-cell></td> <td md-cell></td> <td md-cell>{{\'midtermTask.percentageSum\' | translate}}: {{getPercentageSum()}}</td> <td md-cell></td> <td md-cell></td> <td md-cell></td> <td md-cell></td> </tr> </tbody> </table> </md-table-container> <div layout="row"> <md-button class="md-primary" ng-click="addRow()" ng-show="record.canBeEdited">{{\'main.button.addNewRow\' | translate}}</md-button> </div> <div layout="row"> <md-button class="md-raised md-primary" ng-click="save()" ng-show="record.canBeEdited">{{\'main.button.save\' | translate}}</md-button> <md-button class="md-raised" ng-click="openCopyDialog()" ng-show="record.canBeEdited">{{\'midtermTask.copy\' | translate}}</md-button> <md-button class="md-raised" ng-click="back(\'#/subjectStudyPeriods/\' + subjectStudyPeriodId + \'/midtermTasks/studentResults\', midtermTaskForm)">{{\'main.button.back\' | translate}}</md-button> </div> </form> </div> <style>.sortorder:after {\r\n    content: \'\\25b2\';\r\n  }\r\n  .sortorder.reverse:after {\r\n    content: \'\\25bc\';\r\n  }</style>'),a.put("midtermTask/midtermTask.studentResults.html",'<div class="ois-form-layout-padding form-readonly" ng-cloak> <form name="midtermTaskResultForm"> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="20" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'midtermTask.subject\' | translate}}</label> <hois-value value="record.subjectStudyPeriod.subject.nameEt"></hois-value> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-xs="100" flex-offset-xs="0" flex-offset-sm="0" flex-offset="5"> <label class="textInput">{{auth.higher ? (\'midtermTask.teacherHigher\' | translate) : (\'midtermTask.teacherVocational\' | translate)}}</label> <hois-value value="record.subjectStudyPeriod.teachers.join(\', \')"></hois-value> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-xs="100" flex-offset-xs="0" flex-offset-sm="0" flex-offset="5"> <label class="textInput">{{\'midtermTask.studyPeriod\' | translate}}</label> <hois-value value="currentLanguageNameField(record.subjectStudyPeriod.studyPeriod)"></hois-value> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-xs="100" flex-offset-xs="0" flex-offset-sm="0" flex-offset="5"> <label class="textInput">{{\'midtermTask.assessment\' | translate}}</label> <hois-value value="currentLanguageNameField(record.assessment)"></hois-value> </md-input-container> </div> <md-table-container> <table md-table> <thead md-head> <tr md-row> <th md-column>{{\'midtermTask.student\' | translate}}</th> <th md-column ng-repeat="midtermTask in record.midtermTasks"> {{getMidtermTaskHeader(midtermTask)}} <span ng-if="midtermTask.moodleGradeItemId"><md-icon md-font-set="material-icons">school</md-icon></span> </th> <th md-column>{{\'midtermTask.finalGrade\' | translate}}</th> <th md-column>{{\'midtermTask.protocols\' | translate}}</th> <th md-column class="one-row">{{\'midtermTask.notes\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="student in record.students | orderBy: \'name\'" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <ng-form name="midtermTaskUnitForm"> <td md-cell> {{student.name}} <span ng-if="student.isMoodleRegistered"><md-icon md-font-set="material-icons">school</md-icon></span> </td> <td md-cell ng-repeat="result in record.studentResults | filter: filterStudentResults(student)"> <md-input-container ng-if="result.isText"> <input ng-model="result.pointsTxt" type="text" md-maxlength="10" aria-label="{{\'midtermTask.pointsTxt\' | translate}}" ng-disabled="!student.studentResultCanBeChanged || moodleTasks[result.midtermTask]"> </md-input-container> <md-input-container ng-if="!result.isText"> <input ng-model="result.points" type="number" min="0" max="{{result.maxPoints}}" pattern="^\\d+(\\.\\d{1,2})?$" aria-label="{{\'midtermTask.points\' | translate}}" ng-disabled="!student.studentResultCanBeChanged || moodleTasks[result.midtermTask]"> </md-input-container> </td> <td md-cell> <table> <tr ng-repeat="protocol in record.protocols | orderBy: \'protocolNr\' | filter: filterProtocols(student)"> <td> <table> <tr ng-repeat="protocolStudent in protocol.protocolStudents | filter: filterStudentProtocols(student)"> <td>{{protocolStudent.gradeValue}}</td> </tr> </table> </td> </tr> </table> </td> <td md-cell colspan="2"> <table> <tr ng-repeat="protocol in record.protocols | orderBy: \'protocolNr\' | filter: filterProtocols(student)"> <td class="protocol"> <a ng-href="#/higherProtocols/{{::protocol.id}}/view"> <span>{{protocol.protocolNr}}</span> <hois-classifier-value class="inline" ng-model="protocol.protocolType" main-classifier-code="PROTOKOLLI_LIIK"> </hois-classifier-value> </a> </td> <td> <table> <tr ng-repeat="protocolStudent in protocol.protocolStudents | filter: filterStudentProtocols(student)"> <td>{{protocolStudent.addInfo}}</td> </tr> </table> </td> </tr> </table> </td> </ng-form> </tr> </tbody> </table> </md-table-container> </form> <div layout="row"> <md-button class="md-raised md-primary" ng-click="save()" ng-hide="record.subjectStudyPeriod.isPracticeSubject || record.students.length === 0">{{\'main.button.save\' | translate}}</md-button> <md-button class="md-raised" ng-click="back(\'#/subjectStudyPeriods\')">{{\'main.button.back\' | translate}}</md-button> <md-button class="md-raised" ng-href="#/subjectStudyPeriods/{{subjectStudyPeriodId}}/midtermTasks" ng-hide="record.subjectStudyPeriod.isPracticeSubject">{{\'midtermTask.add\' | translate}}</md-button> </div> <div layout="row" ng-if="moodleCourseId"> <md-button class="md-raised" ng-click="enrollStudents()">{{\'moodle.enrollStudents\' | translate}}</md-button> <md-button class="md-raised" ng-click="importGradeItems()">{{\'moodle.importGradeItems\' | translate}}</md-button> <md-button class="md-raised" ng-click="importAllGrades()">{{\'moodle.importAllGrades\' | translate}}</md-button> <md-button class="md-raised" ng-click="importMissingGrades()">{{\'moodle.importMissingGrades\' | translate}}</md-button> </div> </div> <style>.inline {\r\n    display: inline;\r\n  }\r\n\r\n  .protocol {\r\n    min-width: 150px;\r\n    padding-right: 50px;\r\n  }\r\n\r\n  table.md-table th.md-column {\r\n    white-space: unset;\r\n  }\r\n\r\n  table.md-table th.md-column:last-child {\r\n    padding-right: 90px;\r\n    padding-left: 100px;\r\n  }</style>'),a.put("occupationcertificate/import.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <form novalidate name="occupationCertificateForm"> <div layout="row"> <md-input-container flex> <label>{{\'occupationcertificate.curriculum\' | translate}}</label> <hois-select ng-model="criteria.curriculumVersion" criteria="{valid: true}" type="curriculumversion" multiple required></hois-select> </md-input-container> </div> <div layout="row"> <hois-autocomplete flex ng-model="criteria.studentGroups" ha-attribute="id" ha-controller="directiveControllers" method="studentgroups" name="studentGroup" multiple label="{{\'occupationcertificate.studentGroup\'}}" additional-query-params="{valid: true, curriculumVersionIds: criteria.curriculumVersion}"></hois-autocomplete> </div> <div layout="row"> <div flex> <hois-autocomplete ng-model="criteria.student" method="students" additional-query-params="{active: true, curriculumVersion: criteria.curriculumVersion, studentGroup: criteria.studentGroup}" label="occupationcertificate.student"></hois-autocomplete> </div> </div> <div layout="row"> <md-input-container flex="20" flex-sm="100" flex-xs="100"> <label>{{\'occupationcertificate.dateRange\' | translate}}</label> <input type="hidden"> </md-input-container> <div flex="33"> <md-input-container flex> <label>{{\'main.from\' | translate}}</label> <md-datepicker ng-model="criteria.from" md-max-date="criteria.thru"></md-datepicker> </md-input-container> <md-input-container flex> <label>{{\'main.thru\' | translate}}</label> <md-datepicker ng-model="criteria.thru" md-min-date="criteria.from"></md-datepicker> </md-input-container> </div> </div> <div layout="row"> <md-button class="md-raised md-primary" ng-click="importFromKutseregister()">{{\'occupationcertificate.import\' | translate}}</md-button> </div> </form> </div> </div> <div ng-if="results"> <div layout-padding> <div flex> <md-table-container> <table md-table> <thead md-head> <tr md-row> <th md-column>{{\'occupationcertificate.certificateNr\' | translate}}</th> <th md-column>{{\'occupationcertificate.idcode\' | translate}}</th> <th md-column>{{\'occupationcertificate.firstname\' | translate}}</th> <th md-column>{{\'occupationcertificate.lastname\' | translate}}</th> <th md-column>{{\'occupationcertificate.typename\' | translate}}</th> <th md-column>{{\'occupationcertificate.occupation\' | translate}}</th> <th md-column>{{\'occupationcertificate.issuer\' | translate}}</th> <th md-column>{{\'occupationcertificate.issueDate\' | translate}}</th> <th md-column>{{\'occupationcertificate.validFrom\' | translate}}</th> <th md-column>{{\'occupationcertificate.validThru\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in results" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{::row.certificateNr}}</td> <td md-cell>{{::row.idcode}}</td> <td md-cell>{{::row.firstname}}</td> <td md-cell>{{::row.lastname}}</td> <td md-cell>{{row.type | translate}}</td> <td md-cell>{{currentLanguageNameField(row.occupation)}}</td> <td md-cell>{{::row.issuer}}</td> <td md-cell>{{::row.issueDate | hoisDate}}</td> <td md-cell>{{::row.validFrom | hoisDate}}</td> <td md-cell>{{::row.validThru | hoisDate}}</td> </tr> </tbody> </table> </md-table-container> </div> </div> </div>'),a.put("occupationstandard/occupationstandard.html",'<div layout-padding> <div flex> <form layout="column" name="kutseregisterSyncForm"> <div layout="row"> <div flex="33"> <md-input-container flex> <label>{{\'main.from\' | translate}}</label> <md-datepicker ng-model="criteria.from" md-max-date="criteria.thru" required></md-datepicker> </md-input-container> </div> </div> <div layout="row"> <md-button class="md-raised" ng-click="occupationStandards()">{{\'kutseregister.occupationStandards\' | translate}}</md-button> </div> </form> </div> </div>'),a.put("persons/persons.edit.html",'<div class="ois-form-layout-padding" layout="column" ng-cloak> <form name="personForm" class="nomargin"> <div layout="column" flex> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100"> <label>{{\'person.idcode\' | translate}}</label> <hois-idcode-lookup ng-model="person.idcode" name="idcode" role="person" after-lookup="lookupPerson(response)" after-failed-lookup="lookupFailure()" no-lookup="cleanReadOnly()" required ng-disabled="idcodeReadonly"></hois-idcode-lookup> <ng-messages for="personForm.idcode.$error" role="alert"> <ng-message when="estonianIdcode">{{\'main.messages.error.estonianIdcode\' | translate}}</ng-message> </ng-messages> </md-input-container> <md-input-container flex="50" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'person.sex\' | translate}}</label> <hois-classifier-select ng-model="person.sex" main-classifier-code="SUGU" model-value-attr="code" required ng-disabled="idcodeReadonly"></hois-classifier-select> </md-input-container> </div> <div layout="row"> <md-input-container flex="20" flex-sm="100"> <label>{{\'teacher.person.birthdate\' | translate}}</label> <md-datepicker ng-model="person.birthdate" md-max-date="maxDate" required md-open-on-focus ng-disabled="idcodeReadonly"></md-datepicker> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100"> <label>{{\'person.firstname\' | translate}}</label> <input ng-model="person.firstname" type="text" md-maxlength="100" required> </md-input-container> <md-input-container flex="50" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'person.lastname\' | translate}}</label> <input ng-model="person.lastname" type="text" md-maxlength="100" required> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100"> <label>{{\'person.email\' | translate}}</label> <input ng-model="person.email" type="email" md-maxlength="100"> </md-input-container> <md-input-container flex="50" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'person.phone\' | translate}}</label> <input ng-model="person.phone" type="text" md-maxlength="100"> </md-input-container> </div> </div> <md-button ng-click="update()" class="md-raised md-primary">{{\'main.button.save\' | translate}}</md-button> <md-button ng-if="person.id" ng-click="delete(person)" class="md-raised">{{\'main.button.delete\' | translate}}</md-button> <md-button ng-click="personBack()" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </form> <div ng-if="person.id"> <div>&nbsp;</div> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'user.role\' | translate}}</legend> <div layout="row" class="align-center"> <md-button class="md-raised" ng-if="person.id" ng-href="#/persons/{{::person.id}}/users/new">{{\'main.button.create\' | translate}}</md-button> </div> <div layout="row"> <div ng-include="\'persons/users.table.html\'" flex></div> </div> </fieldset> </div> </div>'),a.put("persons/persons.search.html",'<div class="ois-form-layout-padding"> <div flex> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <form name="seachForm" ng-submit="seachForm.$valid && loadData()" class="ois-form-layout nomargin" ng-model-options="{ allowInvalid: true}" layout="column"> <div layout="column" flex> <md-input-container ng-if="auth.isMainAdmin()" flex> <label>{{\'school.label\' | translate}}</label> <hois-select ng-if="auth.isMainAdmin()" ng-model="criteria.school" type="school"></hois-select> </md-input-container> <md-input-container flex> <label>{{\'person.name\' | translate}}</label> <input ng-model="criteria.name" type="text" md-maxlength="255"> </md-input-container> <md-input-container flex> <label>{{\'person.idcode\' | translate}}</label> <input ng-model="criteria.idcode" type="text" minlength="11" md-maxlength="11"> </md-input-container> <md-input-container flex> <label>{{\'user.role\' | translate}}</label> <hois-classifier-select ng-model="criteria.role" main-classifier-code="ROLL" model-value-attr="code"></hois-classifier-select> </md-input-container> </div> <div layout="row"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> <md-button class="md-raised" ng-if="isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_KASUTAJA\')" ng-href="#/persons/new">{{\'main.button.create\' | translate}}</md-button> </div> </form> </fieldset> </div> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="p.lastname,p.firstname">{{\'person.name\' | translate}}</th> <th md-column md-order-by="p.idcode">{{\'person.idcode\' | translate}}</th> <th md-column ng-if="auth.isMainAdmin()">{{\'school.label\' | translate}}</th> <th md-column>{{\'user.role\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell><a href="#/persons/{{::row.id}}">{{::row.name}}</a></td> <td md-cell>{{::row.idcode}}</td> <td md-cell ng-if="auth.isMainAdmin()">{{currentLanguageNameField(row.school)}}</td> <td md-cell>{{currentLanguageNameField(row.role)}}</td> <td md-cell><md-button md-no-ink class="md-primary change-button" ng-if="isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_KASUTAJA\')" ng-href="#/persons/{{::row.id}}/edit">{{\'main.button.change\' | translate}}</md-button></td> </tr> </tbody> </table> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </md-table-container> </div> </div>'),a.put("persons/persons.view.html",'<div class="ois-form-layout-padding form-readonly" ng-cloak> <form name="personForm" class="ois-form-layout"> <div layout="column" flex> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100"> <label>{{\'person.idcode\' | translate}}</label> <hois-value value="person.idcode"></hois-value> </md-input-container> <md-input-container flex="50" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'person.sex\' | translate}}</label> <hois-classifier-value ng-model="person.sex" main-classifier-code="SUGU"></hois-classifier-value> </md-input-container> </div> <div layout="row"> <md-input-container flex="20" flex-sm="100"> <label>{{\'teacher.person.birthdate\' | translate}}</label> <hois-value value="person.birthdate | hoisDate"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100"> <label>{{\'person.firstname\' | translate}}</label> <hois-value value="person.firstname"></hois-value> </md-input-container> <md-input-container flex="50" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'person.lastname\' | translate}}</label> <hois-value value="person.lastname"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100"> <label>{{\'person.email\' | translate}}</label> <hois-value value="person.email"></hois-value> </md-input-container> <md-input-container flex="50" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'person.phone\' | translate}}</label> <hois-value value="person.phone"></hois-value> </md-input-container> </div> </div> <md-button ng-href="#/persons/{{::person.id}}/edit?_noback" ng-if="isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_KASUTAJA\')" class="md-raised md-primary">{{\'main.button.change\' | translate}}</md-button> <md-button ng-click="back(\'#/persons\')" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </form> <div ng-if="person.id"> <div>&nbsp;</div> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'user.role\' | translate}}</legend> <div layout="row" class="align-center"> <md-button class="md-raised" ng-if="person.id && isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_KASUTAJA\')" ng-href="#/persons/{{::person.id}}/users/new">{{\'main.button.create\' | translate}}</md-button> </div> <div layout="row"> <div ng-include="\'persons/users.table.html\'" flex></div> </div> </fieldset> </div> </div>'),a.put("persons/users.edit.html",'<div class="ois-form-layout-padding" layout="column" ng-cloak> <form name="userForm"> <div layout="column" flex> <div layout="row" flex class="form-readonly"> <md-input-container flex="45"> <label>{{\'person.name\' | translate}}</label> <hois-value value="user.person.fullname"> </md-input-container> <md-input-container flex-offset="5" flex="50"> <label>{{\'person.idcode\' | translate}}</label> <hois-value value="user.person.idcode"> </md-input-container> </div> <md-input-container flex> <label>{{\'school.label\' | translate}}</label> <hois-select ng-disabled="noSchool.indexOf(user.role) !== -1 || !auth.isMainAdmin()" ng-model="user.school.id" ng-required="noSchool.indexOf(user.role) === -1" type="school"></hois-select> </md-input-container> <md-input-container flex> <label>{{\'user.role\' | translate}}</label> <hois-classifier-select ng-model="user.role" filter-values="filterValues" ng-change="roleChanged()" main-classifier-code="ROLL" model-value-attr="code" required></hois-classifier-select> </md-input-container> <div layout="row"> <md-input-container flex="15"> <label>{{\'user.validFrom\' | translate}}</label> <md-datepicker ng-model="user.validFrom" md-max-date="user.validThru" required md-open-on-focus></md-datepicker> </md-input-container> <md-input-container flex> <label>{{\'user.validThru\' | translate}}</label> <md-datepicker ng-model="user.validThru" md-min-date="user.validFrom" md-open-on-focus></md-datepicker> </md-input-container> </div> </div> <div> <div flex> <md-table-container> <table md-table ng-show="user.role"> <thead md-head> <tr md-row> <th md-column>{{\'user.rights.right\' | translate}}</th> <th md-column ng-repeat="perm in permissions"> <md-checkbox ng-model="multiSelects[perm.code]" ng-change="multiSelectPermission(perm.code, multiSelects[perm.code])" aria-label="{{currentLanguageNameField(perm)}}" flex>{{currentLanguageNameField(perm)}}</md-checkbox> </th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="object in objectsForRole | orderBy: currentLanguageNameField()" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{currentLanguageNameField(object)}}</td> <td md-cell ng-repeat="perm in permissions"> <md-checkbox ng-if="showPermission(object.code, perm.code)" ng-model="(rights[object.code] || {})[perm.code]" aria-label="{{currentLanguageNameField(object)+\' \'+currentLanguageNameField(perm)}}" flex></md-checkbox> </td> </tr> </tbody> </table> </md-table-container> </div> </div> <md-button ng-click="update()" class="md-raised md-primary">{{\'main.button.save\' | translate}}</md-button> <md-button ng-if="user.id" ng-click="delete()" class="md-raised">{{\'main.button.delete\' | translate}}</md-button> <md-button ng-click="back(\'#/persons/\' + user.person.id + \'/edit\')" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </form> </div>'),a.put("persons/users.table.html","<table md-table class=\"secondary-table\"> <thead md-head> <tr md-row> <th ng-if=\"auth.isMainAdmin()\" md-column>{{'school.label' | translate}}</th> <th md-column>{{'user.role' | translate}}</th> <th md-column>{{'main.status' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat=\"user in users | orderBy: orderValue\" ng-class-odd=\"'odd'\" ng-class-even=\"'even'\"> <td ng-if=\"auth.isMainAdmin()\" md-cell>{{currentLanguageNameField(user.school)}}</td> <td md-cell><a ng-href=\"#/persons/{{::person.id}}/users/{{::user.id}}\">{{currentLanguageNameField(user.role)}}</a></td> <td md-cell>{{user.valid ? 'main.valid' : 'main.invalid' | translate }}</td> <td md-cell><md-button ng-if=\"user.role.code !== 'ROLL_T' && user.role.code !== 'ROLL_L' && isAuthorized('ROLE_OIGUS_M_TEEMAOIGUS_KASUTAJA')\" class=\"md-primary change-button\" ng-href=\"#/persons/{{::person.id}}/users/{{::user.id}}/edit\">{{'main.button.change' | translate}}</md-button></td> </tr> </tbody> </table>"),a.put("persons/users.view.html",'<div class="ois-form-layout-padding form-readonly" layout="column" ng-cloak> <form name="userForm" class="ois-form-layout"> <div layout="column" flex> <div layout="row" flex> <md-input-container flex> <label>{{\'person.name\' | translate}}</label> <hois-value value="user.person.fullname"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'person.idcode\' | translate}}</label> <hois-value value="user.person.idcode"></hois-value> </md-input-container> </div> <md-input-container flex> <label>{{\'school.label\' | translate}}</label> <hois-value value="currentLanguageNameField(user.school)"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'user.role\' | translate}}</label> <hois-classifier-value ng-model="user.role" main-classifier-code="ROLL"></hois-classifier-value> </md-input-container> <md-input-container flex> <label>{{\'user.validFrom\' | translate}}</label> <hois-value value="user.validFrom | hoisDate"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'user.validThru\' | translate}}</label> <hois-value value="user.validThru | hoisDate"></hois-value> </md-input-container> </div> <div layout-padding> <div flex> <md-table-container> <table md-table ng-show="user.role" class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'user.rights.right\' | translate}}</th> <th md-column ng-repeat="perm in permissions">{{currentLanguageNameField(perm)}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="object in objects | orderBy: currentLanguageNameField()" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{currentLanguageNameField(object)}}</td> <td md-cell ng-repeat="perm in permissions">{{showPermission(object.code, perm.code) ? ((user.rights[object.code] || []).indexOf(perm.code) !== -1 ? \'main.yes\' : \'main.no\' | translate) : \'\'}}</td> </tr> </tbody> </table> </md-table-container> </div> </div> <md-button ng-if="user.role !== \'ROLL_T\' && user.role !== \'ROLL_L\' && isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_KASUTAJA\')" ng-href="#/persons/{{user.person.id}}/users/{{user.id}}/edit?_noback" class="md-raised md-primary">{{\'main.button.change\' | translate}}</md-button> <md-button ng-click="back(\'#/persons/\' + user.person.id)" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </form> </div>'),a.put("poll/poll.answers.dialog.html",'<style>canvas{\r\n        -moz-user-select: none;\r\n        -webkit-user-select: none;\r\n        -ms-user-select: none;\r\n    }\r\n    #chartjs-tooltip {\r\n        opacity: 1;\r\n        position: absolute;\r\n        background: rgba(0, 0, 0, .8);\r\n        color: white;\r\n        border-radius: 3px;\r\n        -webkit-transition: all .1s ease;\r\n        transition: all .1s ease;\r\n        pointer-events: none;\r\n        -webkit-transform: translate(-50%, 0);\r\n        transform: translate(-50%, 0);\r\n        z-index: 1;\r\n        border-color: rgba(0, 0, 0, 0);\r\n        text-align: left;\r\n        table-layout: fixed;\r\n        max-width: 70%;\r\n    }\r\n    .chartjs-tooltip-key {\r\n        display: inline-block;\r\n        width: 10px;\r\n        height: 10px;\r\n        margin-right: 10px;\r\n    }\r\n    @media screen and (max-width: 599px) {\r\n        .hideOnFlexXs {\r\n            display: none !important;\r\n        }\r\n    }</style> <md-dialog aria-label="add question dialog" flex="50"> <form name="dialogForm" ng-submit="submit()" novalidate ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2 flex ng-if="!enterprise && !teacher && !student && !poll">{{showGraph && graphName && !overall ? (journal ? (\'poll.answers.dialog.journal\' | translate) + \' \' + currentLanguageNameField(graphName) : (\'poll.answers.dialog.subject\' | translate) + \' \' + currentLanguageNameField(graphName)) : (overall ? (\'poll.answers.dialog.themes\' | translate) : currentLanguageNameField(formState.name))}}</h2> <h2 flex ng-if="enterprise">{{(\'poll.answers.enterprise\' | translate) + \' \' + currentLanguageNameField(graphName)}}</h2> <h2 flex ng-if="teacher">{{\'poll.answers.teachers\' | translate}}</h2> <h2 flex ng-if="student">{{\'poll.answers.students\' | translate}}</h2> <h2 flex ng-if="poll">{{\'poll.answers.dialog.pollName\' | translate:poll}}</h2> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <div class="md-dialog-content" flex> <div layout="column" ng-if="!showGraph" flex="100"> <h3 ng-if="criteria.journals.length !== 0" style="margin-left: auto; margin-right: auto">{{\'poll.answers.dialog.journals\' | translate}}</h3> <md-button ng-repeat="row in criteria.journals" class="md-raised" ng-click="showJournalGraph(row)">{{currentLanguageNameField(row)}}</md-button> <md-button ng-repeat="row in criteria.subjects" class="md-raised" ng-click="showSubjectGraph(row)">{{currentLanguageNameField(row)}}</md-button> <md-button ng-if="criteria.themes" ng-click="showOtherGraph()" class="md-raised"> <h3 style="margin-left: auto; margin-right: auto">{{\'poll.answers.dialog.themes\' | translate}}</h3> </md-button> </div> <div ng-if="showGraph" layout="column"> <div layout="row" ng-repeat="chart in graph.graphByTheme track by $index"> <div flex="40" class="hideOnFlexXs" layout="column" layout-align="space-between"> <br> <div layout="row" ng-repeat="label in chart.labels" style="word-break: break-word"> {{label}} </div> <br> </div> <div flex="60" flex-xs="100" layout="column"> <canvas id="canvas" class="chart-horizontal-bar" chart-options="chart.options" width="100%" chart-data="chart.data" chart-labels="chart.labels" chart-dataset-override="chart.labelOverride"> </canvas> </div> </div> <div layout="row" ng-if="teacherViewing"> <md-input-container flex="100"> <label>{{\'poll.answers.dialog.comment\' | translate}}</label> <textarea ng-disabled="graph.commentDisabled" ng-model="criteria.addInfo" md-maxlength="10000" ng-blur="saveComment(criteria.addInfo)"></textarea> </md-input-container> </div> <div layout="row" ng-if="!teacherViewing || adminViewing" ng-repeat="comment in comments"> <md-input-container flex="100"> <label>{{currentLanguageNameField(comment.teacher)}}</label> <textarea disabled ng-model="comment.addInfo"></textarea> </md-input-container> </div> </div> </div> </md-dialog-content> <md-dialog-actions layout="row" layout-xs="column" layout-align="start start" layout-align-xs="none none"> <md-button class="md-raised" ng-if="showGraph && !teacherViewing && !adminViewing" ng-click="hideGraph()">{{\'main.button.back\' | translate}}</md-button> <md-button flex-xs="100" class="md-raised" ng-click="cancel()">{{"main.button.close" | translate}}</md-button> </md-dialog-actions> </form> </md-dialog>'),
a.put("poll/poll.answers.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <form name="searchForm" ng-submit="searchForm.$valid && loadData()" novalidate class="nomargin" ng-model-options="{allowInvalid: true}"> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <div layout="column" flex> <div layout="row"> <div layout="column" flex="50"> <md-input-container> <label class="textInput">{{\'poll.name\' | translate}}</label> <input ng-model="criteria.pollName" type="text" md-maxlength="255"> </md-input-container> <md-input-container> <label>{{\'poll.type\' | translate}}</label> <hois-classifier-select ng-model="criteria.typeCode" model-value-attr="code" main-classifier-code="KYSITLUS"></hois-classifier-select> </md-input-container> </div> <div layout="column" flex="50"> <div layout="row" layout-xs="column"> <md-input-container flex-offset="5" flex-offset-xs="0"> <label>{{\'poll.answers.endDate\' | translate}}</label> <md-datepicker name="thru" ng-model="criteria.validThru" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> </div> </div> </div> <div layout="row" layout-xs="column"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> </div> </div> <div flex-xs="0" flex-gt-xs="0" flex-gt-sm="50"></div> </fieldset> </form> </div> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="p.name_et">{{\'poll.poll\' | translate}}</th> <th md-column md-order-by="p.type_code">{{\'poll.type\' | translate}}</th> <th md-column md-order-by="p.valid_from">{{\'poll.period\' | translate}}</th> <th md-column md-order-by="r.status_code">{{\'poll.status\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell><a style="word-break: break-word" ng-click="openResponse(row)">{{row.name ? currentLanguageNameField(row.name) : \'-\'}}</a></td> <td md-cell>{{row.type ? currentLanguageNameField(row.type) : \'-\'}}</td> <td md-cell>{{(row.validFrom | hoisDate) + \' - \' + (row.validThru | hoisDate)}}</td> <td md-cell>{{row.status ? currentLanguageNameField(row.status) : \'-\'}}</td> <td md-cell> <md-button ng-if="auth.isStudent() && ((row.isTeacherComment && row.isTeacherCommentVisible) || row.isStudentVisible) &&\r\n                         isInThePast(row.validThru) && row.type.code === \'KYSITLUS_O\'" md-no-ink class="md-primary change-button" ng-click="openAnswers(row)">{{\'poll.answers.viewResponse\' | translate}}</md-button> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> </div>'),a.put("poll/poll.answers.subjects.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <form name="searchForm" ng-submit="searchForm.$valid && loadData()" novalidate class="nomargin" ng-model-options="{allowInvalid: true}"> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <div layout="column" flex> <div layout="row"> <div layout="column" flex="50"> <md-input-container> <label class="textInput">{{\'poll.name\' | translate}}</label> <input ng-model="criteria.pollName" type="text" md-maxlength="255"> </md-input-container> <md-input-container> <label>{{\'poll.type\' | translate}}</label> <hois-classifier-select ng-model="criteria.typeCode" model-value-attr="code" main-classifier-code="KYSITLUS"></hois-classifier-select> </md-input-container> </div> <div layout="column" flex="50"> <div layout="row" layout-xs="column"> <md-input-container flex-offset="5" flex-offset-xs="0"> <label>{{\'poll.answers.endDate\' | translate}}</label> <md-datepicker name="thru" ng-model="criteria.validThru" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> </div> </div> </div> <div layout="row" layout-xs="column"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> </div> </div> <div flex-xs="0" flex-gt-xs="0" flex-gt-sm="50"></div> </fieldset> </form> </div> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="p.name_et">{{\'poll.poll\' | translate}}</th> <th md-column md-order-by="p.valid_from, p.valid_thru">{{\'poll.answers.pollDuration\' | translate}}</th> <th md-column md-order-by="{{auth.higher ? \'s.name_et\' : \'j.name_et\'}}">{{(auth.higher ? \'poll.response.subject\' : \'poll.response.journal\') | translate}}</th> <th md-column md-order-by="cl.name_et">{{auth.higher ? (\'poll.answers.studyPeriod\' | translate) : (\'poll.answers.studyYear\' | translate)}}</th> <th md-column>{{\'poll.answers.amount\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{row.poll ? currentLanguageNameField(row.poll) : \'-\'}}</td> <td md-cell>{{(row.startDate | hoisDate) + \' - \' + (row.endDate | hoisDate)}}</td> <td md-cell>{{row.name ? currentLanguageNameField(row.name) : \'-\'}}</td> <td md-cell>{{row.yearCode ? currentLanguageNameField(row.yearCode) : \'-\'}}</td> <td md-cell>{{row.answers}}</td> <td md-cell> <md-button ng-if="canViewResult(row.endDate)" md-no-ink class="md-primary change-button" ng-click="openAnswers(row)">{{\'poll.answers.viewResponse\' | translate}}</md-button> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> </div>'),a.put("poll/poll.edit.html",'<div id="scrolling_div" style="overflow: auto"> <md-nav-bar md-selected-nav-item="currentNavItem" nav-bar-aria-label="main selection" ng-cloak> <md-nav-item ng-if="!criteria.id" md-nav-href="#/poll/new?_noback" name="poll.data"> {{\'poll.basicData.label\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && criteria.id" md-nav-href="#/poll/{{::criteria.id}}/edit?_noback" name="poll.data"> {{\'poll.basicData.label\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && criteria.id" md-nav-href="#/poll/questions/{{::criteria.id}}/edit?_noback" name="poll.questions"> {{\'poll.questions.label\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && criteria.id" md-nav-href="#/poll/results/{{::criteria.id}}/edit?_noback" name="poll.results"> {{\'poll.results\' | translate}}</md-nav-item> </md-nav-bar> </div> <div class="ois-form-layout-padding ois-form-layout" layout="row" ng-cloak> <form name="pollForm" role="form" class="nomargin" ng-submit="save()" flex novalidate> <div layout="column" flex> <div layout="row"> <md-input-container flex="50" flex-xs="100"> <label>{{\'poll.type\' | translate}}</label> <hois-classifier-select ng-model="criteria.type" model-value-attr="code" main-classifier-code="KYSITLUS" ng-disabled="disabled" required ng-change="emptyLists() && checkCases()"></hois-classifier-select> </md-input-container> </div> <div ng-if="criteria.type !== undefined" layout="column" flex> <md-input-container> <label class="textInput">{{\'poll.basicData.name\' | translate}}</label> <input ng-model="criteria.nameEt" type="text" md-maxlength="255" name="nameEt" ng-blur="checkNames(criteria.nameEt)" required> <ng-messages for="pollForm.nameEt.$error" role="alert"> <ng-message when="incorrectName">{{\'poll.basicData.nameError\' | translate}}</ng-message> </ng-messages> </md-input-container> <md-input-container> <label class="textInput">{{\'poll.basicData.foreWord\' | translate}}</label> <textarea ng-model="criteria.foreword" md-maxlength="4000" max-rows="4"></textarea> </md-input-container> <md-input-container> <label class="textInput">{{\'poll.basicData.afterWord\' | translate}}</label> <textarea ng-model="criteria.afterword" md-maxlength="4000" max-rows="4"></textarea> </md-input-container> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'poll.basicData.target\' | translate}}</legend> <div layout="row" layout-xs="column" ng-if="criteria.type !== \'KYSITLUS_O\' && criteria.type !== \'KYSITLUS_T\' && criteria.type !== \'KYSITLUS_V\'"> <div flex="50" flex-xs="100"> <div layout="column" flex> <md-input-container> <label>{{\'poll.chooseTarget\' | translate}} <span>*</span></label> <hois-select ng-model="formState.targetCode" value-property="code" values="formState.aim | filter: targetCodeFilter" ng-change="addTargetCode()" aria-label="targetcodes"></hois-select> </md-input-container> </div> </div> <md-button flex-offset="5" flex-offset-xs="0" ng-click="addAllTargetCodes()" class="md-raised">{{"poll.basicData.pickAll" | translate}}</md-button> <md-button ng-if="formState.targetCodes.length > 0" flex-offset-xs="0" ng-click="removeAllTargetCodes()" class="md-raised">{{"poll.basicData.removeAll" | translate}}</md-button> </div> <div ng-if="formState.targetCodes.length > 0" layout="row"> <md-table-container flex="50" style="max-height: 200px"> <table md-table class="secondary-table"> <tbody md-body> <tr md-row ng-repeat="targetCode in formState.targetCodes" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{currentLanguageNameField(targetCode)}}</td> <td md-cell> <a ng-click="deleteTargetCode(targetCode)" ng-if="criteria.type !== \'KYSITLUS_O\' && criteria.type !== \'KYSITLUS_T\' && criteria.type !== \'KYSITLUS_V\'" class="remove">&times;</a> </td> </tr> </tbody> </table> </md-table-container> <div layout="row" flex="45" flex-offset="5"> <div layout="column" flex> <div ng-if="criteria.type === \'KYSITLUS_T\' || (criteria.type === \'KYSITLUS_Y\' && showOccupations)" layout="row"> <md-input-container flex> <label>{{auth.isHigher ? (\'main.menu.settings.teacheroccupationsHigher\' | translate) : (\'main.menu.settings.teacheroccupationsVocational\' | translate)}} </label> <hois-select ng-model="criteria.teacherOccupations" values="formState.occupations" multiple></hois-select> </md-input-container> </div> <div layout="row" layout-xs="column" ng-if="criteria.type === \'KYSITLUS_P\' || (criteria.type === \'KYSITLUS_Y\' && showJournalDates)"> <md-input-container flex-xs="100"> <label>{{\'poll.basicData.journalFrom\' | translate}}</label> <md-datepicker name="from" ng-model="criteria.journalFrom" md-max-date="criteria.journalThru" required></md-datepicker> </md-input-container> <md-input-container flex-xs="100"> <label>{{\'poll.basicData.journalThru\' | translate}}</label> <md-datepicker name="thru" ng-model="criteria.journalThru" md-min-date="criteria.journalFrom" required></md-datepicker> </md-input-container> </div> <div layout="row" ng-if="auth.higher && criteria.type === \'KYSITLUS_O\'"> <md-input-container flex> <label>{{\'poll.basicData.declarationPeriod\' | translate}}</label> <hois-select ng-model="criteria.studyPeriod" type="studyperiodyear" sorted-query="true" ng-required="auth.higher && (criteria.journals === undefined || criteria.journals.length === 0)" preselect-current aria-label="studyperiod"></hois-select> </md-input-container> </div> <div class="form-readonly" ng-if="showExpertUrl && criteria.id"> <div layout="row" layout-xs="column" style="margin-top: 10px"> <md-input-container flex> <label>{{\'poll.basicData.outsiderUrl\' | translate}}</label> <hois-value value="criteria.pollUrl"></hois-value> </md-input-container> <md-button copy-to-clipboard="{{criteria.pollUrl}}">{{\'poll.basicData.copy\' | translate}}</md-button> </div> </div> </div> </div> </div> <div ng-if="studentGroupAllowed"> <div layout="row" layout-xs="column"> <hois-autocomplete label="poll.studentgroup" flex="50" flex-xs="100" ng-model="formState.studentgroup" method="studentgroups" additional-query-params="{valid: true}"></hois-autocomplete> <md-button flex-offset="5" flex-offset-xs="0" ng-click="addAllStudentgroups()" class="md-raised">{{"poll.basicData.pickAll" | translate}}</md-button> <md-button ng-if="formState.studentGroups.length > 0" flex-offset-xs="0" ng-click="removeAllStudentgroups()" class="md-raised">{{"poll.basicData.removeAll" | translate}}</md-button> </div> <div ng-if="formState.studentGroups.length > 0" layout="row"> <md-table-container flex="50" flex-xs="100" style="max-height: 200px"> <table md-table class="secondary-table"> <thead md-head ng-hide="true"> <tr md-row> <th md-column width="90%"></th> <th md-column width="10%"></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="studentgroup in formState.studentGroups" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{currentLanguageNameField(studentgroup)}}</td> <td md-cell> <a ng-click="deleteStudentgroup(studentgroup)" class="remove">&times;</a> </td> </tr> </tbody> </table> </md-table-container> </div> </div> <div layout="column" ng-if="criteria.type === \'KYSITLUS_O\'"> <div layout="column" ng-if="!auth.higher || (auth.higher && auth.vocational)"> <div layout="row"> <hois-autocomplete flex="50" ng-model="formState.journal" method="journalsAndStudentGroups" name="journals" label="lessonplan.journals"></hois-autocomplete> </div> <div layout="row"> <md-table-container flex="50" style="max-height: 200px"> <table md-table class="secondary-table"> <tbody md-body> <tr md-row ng-repeat="journal in criteria.journals" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{currentLanguageNameField(journal)}}</td> <td md-cell> <md-button class="remove nomargin" ng-click="removeJournal(journal)">&times;</md-button> </td> </tr> </tbody> </table> </md-table-container> </div> </div> </div> </fieldset> <br> <md-input-container ng-if="criteria.type === \'KYSITLUS_O\'"> <md-checkbox ng-model="criteria.isTeacherComment" aria-label="required" ng-checked="formState.isTeacherComment"> {{\'poll.basicData.teacherCanComment\' | translate}} </md-checkbox> </md-input-container> <md-input-container ng-if="criteria.type === \'KYSITLUS_O\' && criteria.isTeacherComment"> <md-checkbox ng-model="criteria.isTeacherCommentVisible" aria-label="required" ng-checked="formState.isTeacherCommentVisible"> {{\'poll.basicData.teacherCommentVisible\' | translate}} </md-checkbox> </md-input-container> <md-input-container ng-if="criteria.type === \'KYSITLUS_O\'"> <md-checkbox ng-model="criteria.isStudentVisible" aria-label="required"> {{\'poll.basicData.studentCanSeeResponse\' | translate}} </md-checkbox> </md-input-container> <div layout="row"> <div flex="50" flex-xs="100"> <md-input-container flex="50"> <label>{{\'main.validFrom\' | translate}}</label> <md-datepicker name="from" ng-model="criteria.validFrom" md-max-date="earlierDate(criteria.reminderDt, criteria.validThru)" required ng-change="checkReminder()"></md-datepicker> </md-input-container> <md-input-container flex="50" flex-offset="5" flex-offset-xs="0"> <label>{{\'main.validThru\' | translate}}</label> <md-datepicker name="thru" ng-model="criteria.validThru" md-min-date="laterDate(criteria.reminderDt, criteria.validFrom)" required ng-change="checkReminder()"></md-datepicker> </md-input-container> </div> </div> <div layout="row"> <md-input-container flex="25" flex-xs="50"> <label>{{\'poll.basicData.notificationDate\' | translate}}</label> <md-datepicker id="notificationDate" name="reminderDt" ng-model="criteria.reminderDt" md-min-date="criteria.validFrom" md-max-date="criteria.validThru" ng-change="checkReminder()" required></md-datepicker> <ng-messages for="pollForm.reminderDt.$error" role="alert"> <ng-message when="incorrect">{{\'poll.basicData.reminderError\' | translate}}</ng-message> </ng-messages> </md-input-container> </div> <div layout="column" class="form-readonly" flex> <div layout="column" ng-if="formState.insertedBy !== undefined"> <br> <div layout="row"> <md-input-container flex="25" flex-xs="100"> <label>{{\'poll.basicData.insertedBy\' | translate}}</label> <hois-value value="formState.insertedBy"></hois-value> </md-input-container> </div> </div> <div layout="column" ng-if="formState.changedBy !== undefined"> <br> <div layout="row"> <md-input-container flex="25" flex-xs="100"> <label>{{\'poll.basicData.changedBy\' | translate}}</label> <hois-value value="formState.changedBy"></hois-value> </md-input-container> </div> </div> <div layout="column" ng-if="formState.status !== undefined"> <br> <div layout="row"> <md-input-container flex="25" flex-xs="100"> <label>{{\'poll.basicData.status\' | translate}}</label> <hois-value value="currentLanguageNameField(formState.status)"></hois-value> </md-input-container> </div> </div> </div> </div> <div layout="row" ng-if="!criteria.type"> <md-button flex-xs="100" ng-if="auth.isAdmin()" ng-click="back(\'#/poll\', pollForm, \'poll.confirmBack\')" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </div> </div> <div layout="row" layout-xs="column" ng-if="criteria.type"> <md-button flex-xs="100" ng-if="auth.isAdmin()" type="submit" class="md-raised md-primary">{{\'main.button.save\' | translate}}</md-button> <md-button flex-xs="100" ng-if="auth.isAdmin() && formState.status !== undefined && formState.status.code === \'KYSITLUS_STAATUS_E\'" ng-click="confirm()" class="md-raised">{{\'main.button.confirm\' | translate}}</md-button> <md-button flex-xs="100" ng-if="auth.isAdmin() && formState.status !== undefined && formState.status.code === \'KYSITLUS_STAATUS_E\'" ng-click="deletePoll()" class="md-raised">{{\'main.button.delete\' | translate}}</md-button> <md-button flex-xs="100" ng-if="auth.isAdmin() && criteria.id" ng-click="test()" class="md-raised">{{\'poll.test\' | translate}}</md-button> <md-button flex-xs="100" ng-if="auth.isAdmin()" ng-click="back(\'#/poll\', pollForm, \'poll.confirmBack\')" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </div> </form> </div>'),a.put("poll/poll.list.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <form name="searchForm" ng-submit="searchForm.$valid && loadData()" novalidate class="nomargin" ng-model-options="{allowInvalid: true}"> <fieldset ng-if="auth.isAdmin()"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <div layout="column" flex> <div layout="row"> <div layout="column" flex="50"> <md-input-container> <label class="textInput">{{\'poll.name\' | translate}}</label> <input ng-model="criteria.pollName" type="text" md-maxlength="255"> </md-input-container> <md-input-container> <label>{{\'poll.type\' | translate}}</label> <hois-classifier-select ng-model="criteria.typeCode" model-value-attr="code" main-classifier-code="KYSITLUS"></hois-classifier-select> </md-input-container> <md-input-container> <label>{{\'poll.target\' | translate}}</label> <hois-classifier-select ng-model="criteria.targetCode" model-value-attr="code" main-classifier-code="KYSITLUS_SIHT"></hois-classifier-select> </md-input-container> </div> <div layout="column" flex="50"> <div layout="row" layout-xs="column"> <md-input-container flex="50" flex-xs="100" flex-offset="5"> <label>{{\'main.from\' | translate}}</label> <md-datepicker name="from" ng-model="criteria.validFrom" md-max-date="criteria.validThru" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> <md-input-container flex="50" flex-xs="100" flex-offset-xs="5"> <label>{{\'main.thru\' | translate}}</label> <md-datepicker name="thru" ng-model="criteria.validThru" md-min-date="criteria.validFrom" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> </div> <md-input-container flex-offset="5"> <label>{{\'poll.status\' | translate}}</label> <hois-classifier-select ng-model="criteria.statusCode" model-value-attr="code" main-classifier-code="KYSITLUS_STAATUS"></hois-classifier-select> </md-input-container> </div> </div> <div layout="row" layout-xs="column"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> <!--<md-button class="md-raised" ng-click="testEmail()">{{\'main.button.test\' | translate}}</md-button>--> <md-button ng-href="#/poll/new" class="md-raised">{{\'main.button.create\' | translate}}</md-button> </div> </div> <div flex-xs="0" flex-gt-xs="0" flex-gt-sm="50"></div> </fieldset> </form> </div> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="p.name_et">{{\'poll.poll\' | translate}}</th> <th md-column md-order-by="p.type_code">{{\'poll.type\' | translate}}</th> <th md-column md-order-by="targetcodes">{{\'poll.targets\' | translate}}</th> <th md-column md-order-by="p.valid_from">{{\'poll.period\' | translate}}</th> <th md-column md-order-by="p.status_code">{{\'poll.status\' | translate}}</th> <th md-column md-order-by="p.inserted_by">{{\'poll.basicData.insertedBy\' | translate}}</th> <th md-column md-order-by="p.changed_by">{{\'poll.basicData.changedBy\' | translate}}</th> <th md-column ng-if="isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_KYSITLUS\')"></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell><a style="word-break: break-word" href="#/poll/{{::row.id}}/view">{{row.name ? row.name : \'-\'}}</a></td> <td md-cell>{{row.typeCode ? currentLanguageNameField(row.typeCode) : \'-\'}}</td> <td md-cell>{{row.targetCodes ? currentLanguageNameField(row.targetCodes) : \'-\'}}</td> <td md-cell>{{(row.validFrom | hoisDate) + \' - \' + (row.validThru | hoisDate)}}</td> <td md-cell>{{row.status ? currentLanguageNameField(row.status) : \'-\'}}</td> <td md-cell>{{row.insertedBy ? row.insertedBy : \'-\'}}</td> <td md-cell>{{row.changedBy ? row.changedBy : \'-\'}}</td> <td ng-if="isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_KYSITLUS\')" md-cell> <md-button ng-if="row.status.code !== \'KYSITLUS_STAATUS_K\'" md-no-ink class="md-primary change-button" ng-href="#/poll/{{::row.id}}/edit">{{\'main.button.change\' | translate}}</md-button> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> </div>'),a.put("poll/poll.question.add.dialog.html",'<style>.link-no-underline {\r\n        text-decoration: none;\r\n    }\r\n    .link-disabled {\r\n        color: #d7dde5;\r\n    }</style> <md-dialog aria-label="add question dialog" flex="50"> <form name="dialogForm" ng-submit="checkAnswers() && submit()" novalidate ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2 flex>{{"poll.questions.question" | translate}}</h2> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <div class="md-dialog-content" flex> <div layout="column"> <div layout="row"> <md-input-container flex> <label>{{\'poll.questions.theme\' | translate}}</label> <hois-select ng-model="criteria.theme" values="themes" value-property="id" show-property="nameEt" required ng-change="checkName(criteria.theme)"></hois-select> </md-input-container> </div> <div layout="row"> <md-input-container flex> <label>{{\'poll.questions.pick\' | translate}}</label> <hois-select ng-model="criteria.question" values="questions" value-property="id" show-property="nameEt" ng-change="loadQuestion(criteria.question)"></hois-select> </md-input-container> </div> <div layout="row" flex-align="center center"> <h3 style="margin: 3px 0px 3px 0px !important">{{\'poll.questions.orAddNew\' | translate}}</h3> </div> <div layout="row"> <md-input-container flex> <label>{{\'poll.questions.question\' | translate}}</label> <input ng-model="criteria.nameEt" type="text" md-maxlength="255" name="nameEt" required> <ng-messages for="dialogForm.nameEt.$error" role="alert"> <ng-message when="nameEtError">{{\'poll.questions.sameNameError\' | translate}}</ng-message> </ng-messages> </md-input-container> </div> <div layout="row" flex> <md-input-container flex> <label class="textInput">{{\'poll.questions.helpText\' | translate}}</label> <textarea ng-model="criteria.addInfoEt" ng-disabled="criteria.disabled || (new && criteria.question)" md-maxlength="4000" max-rows="4"></textarea> </md-input-container> </div> <div layout="row" flex> <md-input-container flex> <md-checkbox ng-model="criteria.isRequired">{{\'poll.questions.mandatory\' | translate}}</md-checkbox> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="60"> <label>{{\'poll.questions.answerType\' | translate}}</label> <hois-classifier-select ng-model="criteria.type" main-classifier-code="VASTUS" model-value-attr="code" required ng-disabled="criteria.disabled || (new && criteria.question)"></hois-classifier-select> </md-input-container> <div ng-if="criteria.type === \'VASTUS_M\' || criteria.type ===  \'VASTUS_R\' || criteria.type === \'VASTUS_S\'" layout="row" flex="35" layout-align="left center" flex-offset="5"> <md-input-container flex> <md-radio-group name="criteria.isInRow" ng-model="criteria.isInRow" required layout="row" flex> <md-radio-button ng-value="true" flex>{{\'poll.questions.displayRow\' | translate}}</md-radio-button> <md-radio-button ng-value="false" flex>{{\'poll.questions.displayColumn\' | translate}}</md-radio-button> </md-radio-group> </md-input-container> </div> </div> <div ng-if="criteria.type === \'VASTUS_M\' || criteria.type ===  \'VASTUS_R\' || criteria.type === \'VASTUS_V\' || criteria.type === \'VASTUS_S\'" layout="column" flex> <div ng-repeat="item in criteria.answers track by $index" class="occupation-row align-center" layout="row" flex="100"> <div layout="row" layout-align="start center" flex="100"> <div layout="row" flex="20"> <md-input-container flex> <label class="textInput">{{\'poll.questions.weight\' | translate}}</label> <input ng-model="item.answerNr" name="answerNr" ng-disabled="criteria.disabled || (new && criteria.question)" type="number" max="32767" min="0" required> </md-input-container> </div> <div layout="row" flex="70"> <md-input-container flex> <label class="textInput">{{\'poll.questions.answer\' | translate}}</label> <input ng-model="item.nameEt" type="text" ng-disabled="criteria.disabled || (new && criteria.question)" name="{{$index}}" md-maxlength="255" required ng-change="checkAnswer()"> <ng-messages for="dialogForm[$index].$error" role="alert" layout="row"> <ng-message when="answerEtError">{{\'poll.questions.sameAnswerError\' | translate}}</ng-message> </ng-messages> </md-input-container> </div> <div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div> <div ng-if="!(criteria.disabled || (new && criteria.question))" layout="row" layout-align="center center"> <div flex> <a class="remove" ng-click="deleteAnswer(item)">&times;&nbsp;&nbsp;</a> <div ng-if="item.disabled">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div> </div> <div flex> <p ng-if="$first" class="link-disabled">&#9650;&nbsp;</p> <a ng-if="!$first" class="link-no-underline" ng-click="swapCriteria($index, $index - 1)">&#9650;&nbsp;</a> </div> <div flex> <p ng-if="$last" class="link-disabled">&#9660;&nbsp;</p> <a ng-if="!$last" class="link-no-underline" ng-click="swapCriteria($index, $index + 1)">&#9660;&nbsp;</a> </div> </div> </div> </div> <div layout="row" ng-if="!(criteria.disabled || (new && criteria.question))"> <md-button class="md-primary" ng-click="addAnswer()">{{\'poll.questions.addAnswer\' | translate}}</md-button> </div> </div> <div layout="column" flex> <md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column><span>{{\'poll.questions.files\' | translate}}</span></th> <th md-column> <md-button flex class="md-primary" ng-click="openAddFileDialog()" style="text-transform: none">{{\'main.button.uploadFile\' | translate}}</md-button> </th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="file in criteria.files | orderBy: \'oisFile.fname\'" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell> {{file.fname}} <a ng-href="{{(file.fdata === undefined || file.fdata === null) ? getUrl(file, \'pollThemeQuestionFile\') : getFileUrl(file)}}" download target="_blank" rel="noopener noreferrer"> <md-icon md-font-set="material-icons">file_download</md-icon> </a> </td> <td md-cell> <md-button class="remove nomargin" ng-click="deleteFile(file)">&times;</md-button> </td> </tr> </tbody> </table> </md-table-container> </div> </div> </div> </md-dialog-content> <md-dialog-actions layout="row" layout-xs="column" layout-align="start start" layout-align-xs="none none"> <md-button flex-xs="100" class="md-raised md-primary" type="submit">{{\'main.button.save\' | translate}}</md-button> <md-button ng-if="criteria.id" flex-xs="100" class="md-raised" ng-click="delete()">{{\'main.button.delete\' | translate}}</md-button> <md-button flex-xs="100" class="md-raised" ng-click="cancel()">{{"main.button.close" | translate}}</md-button> </md-dialog-actions> </form> </md-dialog>'),a.put("poll/poll.question.edit.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <form name="searchForm" ng-submit="searchForm.$valid && loadData()" novalidate class="nomargin" ng-model-options="{allowInvalid: true}"> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'poll.questions.question\' | translate}}</legend> <div layout="column" flex> <div layout="row"> <div layout="column" flex="50"> <md-input-container> <label class="textInput">{{\'poll.questions.name\' | translate}}</label> <input ng-model="formState.question.nameEt" type="text" md-maxlength="255" name="nameEt" required> <ng-messages for="dialogForm.nameEt.$error" role="alert"> <ng-message when="nameEtError">{{\'poll.questions.sameNameError\' | translate}}</ng-message> </ng-messages> </md-input-container> </div> <div layout="column" flex="50" flex-offset="5" class="form-readonly"> <br> <md-input-container> <label>{{\'poll.questions.answerType\' | translate}}</label> <hois-value value="currentLanguageNameField(formState.question.type)"></hois-value> </md-input-container> </div> </div> </div> <div ng-if="formState.question.type.code === \'VASTUS_M\' || formState.question.type.code ===  \'VASTUS_R\' || formState.question.type.code === \'VASTUS_V\' || formState.question.type.code === \'VASTUS_S\'" layout="column" flex> <div ng-repeat="item in formState.question.answers track by $index" class="occupation-row align-center" layout="row" flex="100"> <div layout="row" layout-align="start center" flex="100"> <div layout="row" flex="20"> <md-input-container flex> <label class="textInput">{{\'poll.questions.weight\' | translate}}</label> <input ng-model="item.answerNr" name="answerNr" disabled type="number" max="32767" min="0" required> </md-input-container> </div> <div layout="row" flex="80"> <md-input-container flex> <label class="textInput">{{\'poll.questions.answer\' | translate}}</label> <input ng-model="item.nameEt" type="text" name="{{$index}}" md-maxlength="255" required ng-change="checkAnswer()"> <ng-messages for="searchForm[$index].$error" role="alert" layout="row"> <ng-message when="answerEtError">{{\'poll.questions.sameAnswerError\' | translate}}</ng-message> </ng-messages> </md-input-container> </div> </div> </div> </div> <div layout="row" layout-xs="column"> <md-button ng-if="auth.isAdmin() && isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_KYSITLUS\')" class="md-raised md-primary" ng-click="saveQuestion()">{{\'main.button.save\' | translate}}</md-button> <md-button ng-if="auth.isAdmin()" ng-click="back(\'#/poll/questions\', searchForm)" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </div> <div flex-xs="0" flex-gt-xs="0" flex-gt-sm="50"></div> </fieldset> </form> </div> </div> <div layout-padding> <div flex> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'poll.questions.pollConnections\' | translate}}</legend> <md-table-container> <table md-table md-progress="tabledata.$promise" class="secondary-table"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="p.name_et">{{\'poll.poll\' | translate}}</th> <th md-column md-order-by="p.type_code">{{\'poll.type\' | translate}}</th> <th md-column md-order-by="targetcodes">{{\'poll.targets\' | translate}}</th> <th md-column md-order-by="p.valid_from">{{\'poll.period\' | translate}}</th> <th md-column md-order-by="p.status_code">{{\'poll.status\' | translate}}</th> <th md-column md-order-by="p.inserted_by">{{\'poll.basicData.insertedBy\' | translate}}</th> <th md-column md-order-by="p.changed_by">{{\'poll.basicData.changedBy\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell><a style="word-break: break-word" ng-click="test(row)">{{row.name ? row.name : \'-\'}}</a></td> <td md-cell>{{row.typeCode ? currentLanguageNameField(row.typeCode) : \'-\'}}</td> <td md-cell>{{row.targetCodes ? currentLanguageNameField(row.targetCodes) : \'-\'}}</td> <td md-cell>{{(row.validFrom | hoisDate) + \' - \' + (row.validThru | hoisDate)}}</td> <td md-cell>{{row.status ? currentLanguageNameField(row.status) : \'-\'}}</td> <td md-cell>{{row.insertedBy ? row.insertedBy : \'-\'}}</td> <td md-cell>{{row.changedBy ? row.changedBy : \'-\'}}</td> <td ng-if="isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_ETTEVOTE\')" md-cell> <md-button md-no-ink class="md-primary change-button" ng-click="test(row)">{{\'main.button.view\' | translate}}</md-button> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </fieldset> </div> </div>'),
a.put("poll/poll.question.view.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <form name="searchForm" ng-submit="searchForm.$valid && loadData()" novalidate class="nomargin" ng-model-options="{allowInvalid: true}"> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'poll.questions.question\' | translate}}</legend> <div style="padding-top: 8px"></div> <div layout="column" flex class="form-readonly"> <div layout="row"> <div layout="column" flex="50"> <md-input-container> <label class="textInput">{{\'poll.questions.name\' | translate}}</label> <hois-value value="formState.question.nameEt"></hois-value> </md-input-container> </div> <div layout="column" flex="50" flex-offset="5"> <md-input-container> <label>{{\'poll.questions.answerType\' | translate}}</label> <hois-value value="currentLanguageNameField(formState.question.type)"></hois-value> </md-input-container> </div> </div> </div> <div ng-if="formState.question.type.code === \'VASTUS_M\' || formState.question.type.code ===  \'VASTUS_R\' || formState.question.type.code === \'VASTUS_V\' || formState.question.type.code === \'VASTUS_S\'" layout="column" flex> <div ng-repeat="item in formState.question.answers track by $index" class="occupation-row align-center" layout="row" flex="100"> <div layout="row" layout-align="start center" flex="100"> <div layout="row" flex="20"> <md-input-container flex> <label class="textInput">{{\'poll.questions.weight\' | translate}}</label> <input ng-model="item.answerNr" name="answerNr" disabled type="number" max="32767" min="0" required> </md-input-container> </div> <div layout="row" flex="80"> <md-input-container flex> <label class="textInput">{{\'poll.questions.answer\' | translate}}</label> <input ng-model="item.nameEt" type="text" disabled name="{{$index}}" md-maxlength="255" required ng-change="checkAnswer()"> <ng-messages for="searchForm[$index].$error" role="alert" layout="row"> <ng-message when="answerEtError">{{\'poll.questions.sameAnswerError\' | translate}}</ng-message> </ng-messages> </md-input-container> </div> </div> </div> </div> <div layout="row" layout-xs="column"> <md-button ng-if="auth.isAdmin() && isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_KYSITLUS\')" class="md-raised md-primary" ng-href="#/poll/question/{{::questionId}}/edit?_noback">{{\'main.button.change\' | translate}}</md-button> <md-button ng-if="auth.isAdmin()" ng-click="back(\'#/poll/questions\')" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </div> <div flex-xs="0" flex-gt-xs="0" flex-gt-sm="50"></div> </fieldset> </form> </div> </div> <div layout-padding> <div flex> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'poll.questions.pollConnections\' | translate}}</legend> <md-table-container> <table md-table md-progress="tabledata.$promise" class="secondary-table"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="p.name_et">{{\'poll.poll\' | translate}}</th> <th md-column md-order-by="p.type_code">{{\'poll.type\' | translate}}</th> <th md-column md-order-by="targetcodes">{{\'poll.targets\' | translate}}</th> <th md-column md-order-by="p.valid_from">{{\'poll.period\' | translate}}</th> <th md-column md-order-by="p.status_code">{{\'poll.status\' | translate}}</th> <th md-column md-order-by="p.inserted_by">{{\'poll.basicData.insertedBy\' | translate}}</th> <th md-column md-order-by="p.changed_by">{{\'poll.basicData.changedBy\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell><a style="word-break: break-word" ng-click="test(row)">{{row.name ? row.name : \'-\'}}</a></td> <td md-cell>{{row.typeCode ? currentLanguageNameField(row.typeCode) : \'-\'}}</td> <td md-cell>{{row.targetCodes ? currentLanguageNameField(row.targetCodes) : \'-\'}}</td> <td md-cell>{{(row.validFrom | hoisDate) + \' - \' + (row.validThru | hoisDate)}}</td> <td md-cell>{{row.status ? currentLanguageNameField(row.status) : \'-\'}}</td> <td md-cell>{{row.insertedBy ? row.insertedBy : \'-\'}}</td> <td md-cell>{{row.changedBy ? row.changedBy : \'-\'}}</td> <td ng-if="isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_ETTEVOTE\')" md-cell> <md-button md-no-ink class="md-primary change-button" ng-click="test(row)">{{\'main.button.view\' | translate}}</md-button> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </fieldset> </div> </div>'),a.put("poll/poll.questions.edit.html",'<div id="scrolling_div" style="overflow: auto"> <md-nav-bar md-selected-nav-item="currentNavItem" nav-bar-aria-label="main selection" ng-cloak> <md-nav-item ng-if="!criteria.id" md-nav-href="#/poll/new?_noback" name="poll.data"> {{\'poll.basicData.label\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && criteria.id" md-nav-href="#/poll/{{::criteria.id}}/edit?_noback" name="poll.data"> {{\'poll.basicData.label\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && criteria.id" md-nav-href="#/poll/questions/{{::criteria.id}}/edit?_noback" name="poll.questions"> {{\'poll.questions.label\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && criteria.id" md-nav-href="#/poll/results/{{::criteria.id}}/edit?_noback" name="poll.results"> {{\'poll.results\' | translate}}</md-nav-item> </md-nav-bar> </div> <style>md-checkbox .md-container {\r\n        top: 10px;\r\n    }\r\n    md-radio-button .md-container {\r\n        top: 10px;\r\n    }\r\n    .link-no-underline {\r\n        text-decoration: none;\r\n    }\r\n    .link-disabled {\r\n        color: #d7dde5;\r\n    }</style> <div class="ois-form-layout-padding ois-form-layout" layout="row" ng-cloak> <form name="pollForm" role="form" class="nomargin" ng-submit="save()" flex novalidate> <div layout="row"> <md-checkbox ng-model="criteria.isThemePageable" aria-label="required" ng-change="saveThemePageable()"> {{\'poll.questions.isThemePageable\' | translate}} </md-checkbox> </div> <div ng-if="criteria.themes" layout="column"> <h2 ng-if="criteria.themes.length === 0">{{\'poll.questions.themesMissing\' | translate}}</h2> <div ng-repeat="item in criteria.themes track by $index" class="occupation-row align-center" layout="row" ng-style="{\'margin-top\': $first ? \'0px\' : \'16px\'}"> <div flex> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small" style="word-break: break-word">{{item.orderNr + \' \' + item.nameEt}}</legend> <div layout="row" layout-align="end center"> <md-input-container flex ng-if="formState.type === \'KYSITLUS_O\'"> <md-checkbox ng-model="item.isRepetitive" aria-label="required" ng-change="saveThemeRepetitive(item)"> {{auth.higher ? (\'poll.questions.isRepedetiveHigher\' | translate) : (\'poll.questions.isRepedetiveVocational\' | translate)}} </md-checkbox> </md-input-container> <div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div> <md-button class="md-primary" ng-click="addQuestion(item)">{{\'poll.questions.addQuestion\' | translate}}</md-button> <md-button class="md-primary" ng-click="addNewTheme(item)">{{\'poll.questions.changeTheme\' | translate}}</md-button> <div> <a class="remove" ng-click="deleteTheme(item.id)" ng-if="!item.disabled">&times;&nbsp;&nbsp;</a> <div ng-if="item.disabled">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div> </div> <div> <p ng-if="$first" class="link-disabled">&#9650;&nbsp;</p> <a ng-if="!$first" class="link-no-underline" ng-click="swapTheme($index, $index - 1)">&#9650;&nbsp;</a> </div> <div> <p ng-if="$last" class="link-disabled">&#9660;&nbsp;</p> <a ng-if="!$last" class="link-no-underline" ng-click="swapTheme($index, $index + 1)">&#9660;&nbsp;</a> </div> </div> <h2 ng-if="item.questions.length === 0">{{\'poll.questions.questionsMissing\' | translate}}</h2> <div ng-repeat="question in item.questions track by $index" layout="row" flex> <div flex="100"> <fieldset> <div layout="row"> <div layout="column" flex="80"> <div layout="row" layout-align="start center"> <h2><span style="word-break: break-word; margin-bottom: 0px">{{item.orderNr + \'.\' + question.orderNr + \' \' + (question.isRequired ? \'*\' : \'\') + question.nameEt}}</span></h2> </div> </div> <div layout="column" flex="20"> <div layout="row" layout-align="end center"> <div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div> <md-button class="md-primary" ng-click="addQuestion(item, question)">{{\'main.button.change\' | translate}}</md-button> <div> <a class="remove" ng-click="deleteQuestion(question.id)" ng-if="!item.disabled">&times;&nbsp;&nbsp;</a> <div ng-if="item.disabled">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div> </div> <div> <p ng-if="$first" class="link-disabled">&#9650;&nbsp;</p> <a ng-if="!$first" class="link-no-underline" ng-click="swapQuestion(item, $index, $index - 1)">&#9650;&nbsp;</a> </div> <div> <p ng-if="$last" class="link-disabled">&#9660;&nbsp;</p> <a ng-if="!$last" class="link-no-underline" ng-click="swapQuestion(item, $index, $index + 1)">&#9660;&nbsp;</a> </div> </div> </div> </div> <div layout="{{question.pictures.length !== 0 ? \'row\' : \'column\'}}"> <div layout="column" flex="35"> <div ng-repeat="file in question.files track by $index"> <img ng-if="file.ftype.indexOf(\'image\') !== -1" flex style="display: block; margin-left: auto; margin-right: auto; max-width: 100%; max-height: 100%" ng-src="{{getUrl(file)}}"> <div ng-if="file.ftype.indexOf(\'image\') === -1"> {{file.fname}} <a ng-href="{{getUrl(file)}}" target="_blank" rel="noopener noreferrer" download> <md-icon md-font-set="material-icons">file_download</md-icon> </a> </div> </div> </div> <div layout="column" flex="{{question.pictures.length !== 0 ? \'60\' : \'100\'}}" flex-offset="{{question.pictures.length !== 0 ? \'5\' : \'0\'}}"> <p style="word-break: break-word; margin-top: 0px;font-style: italic">{{question.addInfoEt}}</p> <div ng-if="question.type === \'VASTUS_S\'" layout="{{question.isInRow ? \'row\' : \'column\'}}" flex="100"> <div ng-repeat="answer in question.answers track by $index" flex> <md-input-container flex> <md-checkbox ng-model="s" aria-label="required"> <span style="word-break: break-word">{{answer.nameEt}}</span> </md-checkbox> </md-input-container> </div> </div> <div ng-if="question.type === \'VASTUS_R\'" layout="row"> <md-input-container flex> <md-radio-group name="radio" ng-model="question.radio" required layout="{{question.isInRow ? \'row\' : \'column\'}}" flex="100"> <md-radio-button ng-value="answer.nameEt" aria-label="period" ng-repeat="answer in question.answers track by $index" flex> <span style="word-break: break-word">{{answer.nameEt}}</span></md-radio-button> </md-radio-group> <div ng-if="pollForm.$submitted" ng-messages="pollForm.radio.$error"> <div ng-message="required">{{\'main.messages.error.inputFieldIsRequired\' | translate}}</div> </div> </md-input-container> </div> <div ng-if="question.type === \'VASTUS_M\'" layout="{{question.isInRow ? \'row\' : \'column\'}}"> <div ng-repeat="answer in question.answers track by $index" flex> <md-input-container flex> <md-checkbox ng-model="s" aria-label="required"> <span style="word-break: break-word">{{answer.nameEt}}</span> </md-checkbox> </md-input-container> </div> </div> <div ng-if="question.type === \'VASTUS_T\'" layout="row"> <md-input-container flex> <label>{{answer.nameEt}}</label> <textarea ng-model="s" type="text" required md-maxlength="4000" max-rows="5"></textarea> </md-input-container> </div> <div ng-if="question.type === \'VASTUS_V\'" layout="row"> <md-input-container flex> <hois-select ng-model="s" values="question.answers" sorted-query="true" order-by-property="orderNr" required aria-label="answers"></hois-select> </md-input-container> </div> </div> </div> </fieldset> <br ng-if="!$last"> </div> </div> </fieldset> </div> </div> </div> <div layout="row" layout-xs="column"> <md-button flex-xs="100" ng-if="auth.isAdmin()" ng-click="addNewTheme()" class="md-raised">{{\'poll.questions.addTheme\' | translate}}</md-button> <md-button flex-xs="100" ng-if="auth.isAdmin()" ng-click="test()" class="md-raised">{{\'poll.test\' | translate}}</md-button> <md-button flex-xs="100" ng-if="auth.isAdmin()" ng-click="back(\'#/poll\')" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </div> </form> </div>'),a.put("poll/poll.questions.list.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <form name="searchForm" ng-submit="searchForm.$valid && loadData()" novalidate class="nomargin" ng-model-options="{allowInvalid: true}"> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <div layout="column" flex> <div layout="row"> <div layout="column" flex="50"> <md-input-container> <label class="textInput">{{\'poll.questions.question\' | translate}}</label> <input ng-model="criteria.name" type="text" md-maxlength="255"> </md-input-container> <md-input-container> <label>{{\'poll.questions.answerType\' | translate}}</label> <hois-classifier-select ng-model="criteria.type" model-value-attr="code" main-classifier-code="VASTUS"></hois-classifier-select> </md-input-container> </div> <div layout="column" flex="50"> <div layout="row" layout-xs="column"> <md-input-container flex-offset="5" flex-offset-xs="0"> <md-checkbox ng-model="criteria.pollConnection" aria-label="required"> {{\'poll.questions.pollConnection\' | translate}} </md-checkbox> </md-input-container> </div> </div> </div> <div layout="row" layout-xs="column"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> </div> </div> <div flex-xs="0" flex-gt-xs="0" flex-gt-sm="50"></div> </fieldset> </form> </div> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="q.name_et">{{\'poll.questions.question\' | translate}}</th> <th md-column md-order-by="q.type_code">{{\'poll.questions.answerType\' | translate}}</th> <th md-column md-order-by="polls">{{\'poll.questions.linkedPolls\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell style="word-break: break-word"> <a ng-href="#/poll/question/{{row.name.id}}/view">{{row.name ? currentLanguageNameField(row.name) : \'-\'}}</a> </td> <td md-cell>{{row.type ? currentLanguageNameField(row.type) : \'-\'}}</td> <td md-cell>{{row.polls}}</td> <td md-cell> <md-button md-no-ink class="md-primary change-button" ng-href="#/poll/question/{{row.name.id}}/view"> {{\'poll.questions.view\' | translate}}</md-button> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> </div>'),a.put("poll/poll.questions.view.html",'<div id="scrolling_div" style="overflow: auto"> <md-nav-bar md-selected-nav-item="currentNavItem" nav-bar-aria-label="main selection" ng-cloak> <md-nav-item ng-if="!criteria.id" md-nav-href="#/poll/new?_noback" name="poll.data"> {{\'poll.basicData.label\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && criteria.id" md-nav-href="#/poll/{{::criteria.id}}/view?_noback" name="poll.data"> {{\'poll.basicData.label\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && criteria.id" md-nav-href="#/poll/questions/{{::criteria.id}}/view?_noback" name="poll.questions"> {{\'poll.questions.label\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && criteria.id" md-nav-href="#/poll/results/{{::criteria.id}}/view?_noback" name="poll.results"> {{\'poll.results\' | translate}}</md-nav-item> </md-nav-bar> </div> <style>md-checkbox .md-container {\r\n        top: 10px;\r\n    }\r\n    md-radio-button .md-container {\r\n        top: 10px;\r\n    }</style> <div class="ois-form-layout-padding ois-form-layout" layout="row" ng-cloak> <form name="pollForm" role="form" class="nomargin" ng-submit="save()" flex novalidate> <div layout="row"> <md-checkbox ng-model="criteria.isThemePageable" aria-label="pageable" disabled> {{\'poll.questions.isThemePageable\' | translate}} </md-checkbox> </div> <div ng-if="criteria.themes" layout="column"> <div ng-repeat="item in criteria.themes track by $index" class="occupation-row align-center" layout="row" ng-style="{\'margin-top\': $first ? \'0px\' : \'16px\'}"> <div flex> <fieldset> <legend md-colors="{color: \'primary-800\'}" style="word-break: break-word" class="md-title-small">{{item.orderNr + \' \' + item.nameEt}}</legend> <md-input-container flex ng-if="formState.type === \'KYSITLUS_O\'"> <md-checkbox ng-model="item.isRepetitive" aria-label="repedetive" disabled> {{auth.higher ? (\'poll.questions.isRepedetiveHigher\' | translate) : (\'poll.questions.isRepedetiveVocational\' | translate)}} </md-checkbox> </md-input-container> <div ng-repeat="question in item.questions track by $index" layout="row" flex> <div flex="100"> <fieldset> <div layout="row"> <div layout="column" flex="100"> <div layout="row" layout-align="start center"> <h2 style="word-break: break-word; margin-bottom: 0px">{{item.orderNr + \'.\' + question.orderNr + \' \' + (question.isRequired ? \'*\' : \'\') + question.nameEt}}</h2> </div> </div> </div> <div layout="{{question.pictures.length !== 0 ? \'row\' : \'column\'}}"> <div layout="column" flex="35"> <div ng-repeat="file in question.files track by $index"> <img ng-if="file.ftype.indexOf(\'image\') !== -1" flex style="display: block; margin-left: auto; margin-right: auto; max-width: 100%; max-height: 100%" ng-src="{{getUrl(file)}}"> <div ng-if="file.ftype.indexOf(\'image\') === -1"> {{file.fname}} <a ng-href="{{getUrl(file)}}" target="_blank" rel="noopener noreferrer" download> <md-icon md-font-set="material-icons">file_download</md-icon> </a> </div> </div> </div> <div layout="column" flex="{{question.pictures.length !== 0 ? \'60\' : \'100\'}}" flex-offset="{{question.pictures.length !== 0 ? \'5\' : \'0\'}}"> <p style="word-break: break-word; margin-top: 0px;font-style: italic">{{question.addInfoEt}}</p> <div ng-if="question.type === \'VASTUS_S\'" layout="{{question.isInRow ? \'row\' : \'column\'}}" flex="100"> <div ng-repeat="answer in question.answers track by $index" flex> <md-input-container flex> <md-checkbox ng-model="s" aria-label="required" disabled> <span style="word-break: break-word">{{answer.nameEt}}</span> </md-checkbox> </md-input-container> </div> </div> <div ng-if="question.type === \'VASTUS_R\'" layout="row"> <md-input-container flex> <md-radio-group name="radio" required layout="{{question.isInRow ? \'row\' : \'column\'}}" flex="100"> <md-radio-button ng-value="answer.nameEt" aria-label="period" ng-repeat="answer in question.answers track by $index" flex disabled> <span style="word-break: break-word">{{answer.nameEt}}</span> </md-radio-button> </md-radio-group> </md-input-container> </div> <div ng-if="question.type === \'VASTUS_M\'" layout="{{question.isInRow ? \'row\' : \'column\'}}"> <div ng-repeat="answer in question.answers track by $index" flex> <md-input-container flex> <md-checkbox ng-model="s" aria-label="required" disabled> <span style="word-break: break-word">{{answer.nameEt}}</span> </md-checkbox> </md-input-container> </div> </div> <div ng-if="question.type === \'VASTUS_T\'" layout="row"> <md-input-container flex> <label>{{answer.nameEt}}</label> <textarea ng-model="s" type="text" required max-rows="5" disabled></textarea> </md-input-container> </div> <div ng-if="question.type === \'VASTUS_V\'" layout="row"> <md-input-container flex> <label>{{answer.nameEt}}</label> <hois-select ng-model="s" values="question.answers" required sorted-query="true" order-by-property="orderNr" aria-label="select" disabled></hois-select> </md-input-container> </div> </div> </div> </fieldset> <br ng-if="!$last"> </div> </div> </fieldset> </div> </div> </div> <div layout="row" layout-xs="column"> <md-button flex-xs="100" ng-if="auth.isAdmin() && !criteria.confirmed" ng-href="#/poll/questions/{{::criteria.id}}/edit" class="md-raised md-primary">{{\'main.button.change\' | translate}}</md-button> <md-button flex-xs="100" ng-if="auth.isAdmin()" ng-click="test()" class="md-raised">{{\'poll.test\' | translate}}</md-button> <md-button flex-xs="100" ng-if="auth.isAdmin()" ng-click="back(\'#/poll\')" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </div> </form> </div>'),a.put("poll/poll.response.by.subjectOrJournal.dialog.html",'<style>.link-no-underline {\r\n        text-decoration: none;\r\n    }\r\n    .link-disabled {\r\n        color: #d7dde5;\r\n    }\r\n    md-checkbox .md-container {\r\n        top: 10px;\r\n    }\r\n    md-radio-button .md-container {\r\n        top: 10px;\r\n    }\r\n    .red-border {\r\n        border: 1px solid red;\r\n        border-radius: 5px;\r\n    }\r\n    .md-toolbar-tools {\r\n        max-height: max-content;\r\n    }</style> <md-dialog aria-label="add question dialog" flex> <md-toolbar style="min-height: max-content"> <div class="md-toolbar-tools"> <h2 flex style="word-break: break-word">{{currentLanguageNameField(formState.name) + \' (\' + (criteria.startDate | hoisDate) + \' - \' + (criteria.endDate | hoisDate) + \')\'}}</h2> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <div class="md-dialog-content" flex> <div layout="column" ng-cloak> <form name="responseForm" ng-submit="confirm()" ng-cloak novalidate> <div flex> <div ng-if="formState.themeBySubjectOrJournalId" layout="column"> <div ng-repeat="(key, themeList) in formState.themeBySubjectOrJournalId track by $index" layout="column" flex ng-style="{\'margin-top\': $first ? \'0px\' : \'16px\'}" ng-if="themeList.show"> <div ng-repeat="item in themeList" layout="column" flex> <div layout="column" ng-if="first($index)"> <div layout="row" ng-if="item.journal === null && item.subject === null && criteria.type === \'KYSITLUS_O\' && hasSubjectOrJournal" class="form-readonly"> <p style="margin-top: 0px">{{\'poll.response.other\' | translate}}</p> </div> <div layout="row" ng-if="item.journal !== null" class="form-readonly"> <md-input-container flex="50"> <label>{{\'poll.response.journal\' | translate}}</label> <hois-value value="currentLanguageNameField(item.journal)"></hois-value> </md-input-container> </div> <div layout="row" ng-if="item.subject !== null" class="form-readonly"> <md-input-container flex="50"> <label>{{\'poll.response.subject\' | translate}}</label> <hois-value value="currentLanguageNameField(item.subject)"></hois-value> </md-input-container> </div> <div layout="row" ng-if="criteria.foreword !== null && firstPage(themeList)"> <p style="word-break: break-word; font-size: 15px">{{criteria.foreword}}</p> </div> </div> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{item.orderNr + \' \' + item.nameEt}}</legend> <div ng-repeat="question in item.questions track by $index" layout="row" flex> <div flex="100"> <fieldset> <div layout="row"> <div layout="column" flex="100"> <div layout="row" layout-align="start center"> <h2 style="word-break: break-word; margin-bottom: 0px">{{item.orderNr + \'.\' + question.orderNr + \' \' + (question.isRequired ? \'*\' : \'\') + question.nameEt}}</h2> </div> </div> </div> <div layout="{{question.pictures.length !== 0 ? \'row\' : \'column\'}}" layout-xs="column"> <div layout="column" flex="35" flex-xs="100"> <div ng-repeat="file in question.files track by $index"> <img ng-if="file.ftype.indexOf(\'image\') !== -1" flex style="display: block; margin-left: auto; margin-right: auto; max-width: 100%; max-height: 100%" ng-src="{{getUrl(file)}}"> <div ng-if="file.ftype.indexOf(\'image\') === -1"> {{file.fname}} <a ng-href="{{getUrl(file)}}" target="_blank" rel="noopener noreferrer" download> <md-icon md-font-set="material-icons">file_download</md-icon> </a> </div> </div> </div> <div layout="column" flex="{{question.pictures.length !== 0 ? \'60\' : \'100\'}}" flex-offset="{{question.pictures.length !== 0 ? \'5\' : \'0\'}}"> <p style="word-break: break-word; margin-top: 0px;font-style: italic;font-size: 13px">{{question.addInfoEt}}</p> <div ng-if="question.type === \'VASTUS_S\'" layout="{{question.isInRow ? \'row\' : \'column\'}}" flex="100" class="{{question.requiredError ? \'red-border\' : \'\'}}"> <div ng-repeat="answer in question.answers track by $index" flex> <md-input-container flex> <md-checkbox ng-model="answer.chosen" ng-disabled="formState.viewOnly" aria-label="required" ng-change="question.requiredError && checkErrors()" ng-blur="save(question)"> <span style="word-break: break-word">{{answer.nameEt}}</span> </md-checkbox> </md-input-container> </div> </div> <div ng-if="question.type === \'VASTUS_R\'" layout="row" class="{{question.requiredError ? \'red-border\' : \'\'}}"> <md-input-container flex> <md-radio-group name="radio" ng-model="question.answerTxt" ng-disabled="formState.viewOnly" layout="{{question.isInRow ? \'row\' : \'column\'}}" layout-xs="column" flex="100" ng-change="question.requiredError && checkErrors()" ng-blur="save(question)"> <md-input-container ng-repeat="answer in question.answers track by $index"> <md-radio-button ng-value="answer.nameEt" aria-label="period" flex> <span style="word-break: break-word">{{answer.nameEt}}</span> </md-radio-button> </md-input-container> </md-radio-group> <div ng-if="responseForm.$submitted" ng-messages="pollForm.radio.$error"> <div ng-message="required">{{\'main.messages.error.inputFieldIsRequired\' | translate}}</div> </div> <md-button ng-if="!question.isRequired && !formState.viewOnly" ng-click="clearRadio(question)" class="md-raised">{{\'main.button.clear\' | translate}}</md-button> </md-input-container> </div> <div ng-if="question.type === \'VASTUS_M\'" layout="{{question.isInRow ? \'row\' : \'column\'}}" class="{{question.requiredError ? \'red-border\' : \'\'}}"> <div ng-repeat="answer in question.answers track by $index" flex> <md-input-container flex> <md-checkbox ng-model="answer.chosen" ng-disabled="formState.viewOnly" aria-label="checkBox" name="checkBox" ng-change="question.requiredError && checkErrors()" ng-blur="save(question)"> <span style="word-break: break-word">{{answer.nameEt}}</span> </md-checkbox> </md-input-container> </div> </div> <div ng-if="question.type === \'VASTUS_T\'" layout="row"> <md-input-container flex> <label>{{answer.nameEt}}</label> <textarea ng-model="question.answerTxt" ng-disabled="formState.viewOnly" type="text" ng-required="question.isRequired" md-maxlength="4000" max-rows="5" ng-blur="save(question)"></textarea> </md-input-container> </div> <div ng-if="question.type === \'VASTUS_V\'" layout="row"> <md-input-container flex> <label>{{answer.nameEt}}</label> <hois-select ng-model="question.answerTxt" ng-disabled="formState.viewOnly" values="question.answers" ng-required="question.isRequired" sorted-query="true" order-by-property="orderNr" ng-blur="save(question)" value-property="nameEt" aria-label="answers"></hois-select> </md-input-container> </div> </div> </div> </fieldset> <br ng-if="!$last"> </div> </div> </fieldset> <br ng-if="!$last"> </div> <div layout="row" layout-align="space-between"> <div> <md-button class="md-raised" ng-click="previousSubjectOrJournal($index)" ng-if="!first($index)"> <md-icon md-font-set="material-icons">keyboard_arrow_left</md-icon> {{\'poll.questions.previous\' | translate}} </md-button> </div> <div> <md-button class="md-raised" ng-click="nextSubjectOrJournal($index)" ng-if="!last($index)"> {{\'poll.questions.next\' | translate}} <md-icon md-font-set="material-icons">keyboard_arrow_right</md-icon> </md-button> </div> </div> <div layout="column" ng-if="last($index)"> <div layout="row"> <p style="word-break: break-word; font-size: 15px">{{criteria.afterword}}</p> </div> <div layout="row" ng-if="!formState.viewOnly"> <md-button flex-xs="100" type="submit" class="md-raised">{{\'main.button.confirm\' | translate}}</md-button> </div> </div> </div> </div> </div> </form> </div> </div> </md-dialog-content> </md-dialog>'),a.put("poll/poll.response.by.theme.dialog.html",'<style>.link-no-underline {\r\n        text-decoration: none;\r\n    }\r\n    .link-disabled {\r\n        color: #d7dde5;\r\n    }\r\n    md-checkbox .md-container {\r\n        top: 10px;\r\n    }\r\n    md-radio-button .md-container {\r\n        top: 10px;\r\n    }\r\n    .red-border {\r\n        border: 1px solid red;\r\n        border-radius: 5px;\r\n    }\r\n    .md-toolbar-tools {\r\n        max-height: max-content;\r\n        height: inherit;\r\n    }\r\n    .margin-bottom-0 {\r\n        margin-bottom: 0px !important;\r\n    }\r\n    /** xs breakpoint */\r\n    @media(max-width: 600px) {\r\n        .margin-bottom-0 {\r\n            margin-bottom: 18px !important;\r\n        }\r\n    }</style> <md-dialog aria-label="add question dialog" flex> <md-toolbar style="min-height: max-content"> <div class="md-toolbar-tools"> <h2 flex style="word-break: break-word">{{currentLanguageNameField(formState.name) + \' (\' + (criteria.startDate | hoisDate) + \' - \' + (criteria.endDate | hoisDate) + \')\'}}</h2> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <div class="md-dialog-content" flex> <div layout="column" ng-cloak> <form name="responseForm" ng-submit="confirm()" ng-cloak novalidate> <div flex> <div ng-if="criteria.themes" layout="column"> <div ng-repeat="item in criteria.themes track by $index" layout="column" flex ng-style="{\'margin-top\': $first ? \'0px\' : \'16px\'}" ng-if="item.show"> <div layout="row" ng-if="item.journal === null && item.subject === null && criteria.type === \'KYSITLUS_O\' && hasSubjectOrJournal" class="form-readonly"> <p style="margin-top: 0px">{{\'poll.response.other\' | translate}}</p> </div> <div layout="row" ng-if="item.journal !== null" class="form-readonly"> <md-input-container flex="50" flex-xs="100"> <label>{{\'poll.response.journal\' | translate}}</label> <hois-value value="currentLanguageNameField(item.journal)"></hois-value> </md-input-container> </div> <div layout="row" ng-if="item.subject !== null" class="form-readonly"> <md-input-container flex="50" flex-xs="100"> <label>{{\'poll.response.subject\' | translate}}</label> <hois-value value="currentLanguageNameField(item.subject)"></hois-value> </md-input-container> </div> <div layout="column" ng-if="$first" class="form-readonly"> <div layout="row" ng-if="criteria.school !== null"> <md-input-container flex="50" flex-xs="100" ng-if="criteria.school"> <label>{{\'poll.response.school\' | translate}}</label> <hois-value value="currentLanguageNameField(criteria.school)"></hois-value> </md-input-container> <div flex="50" flex-xs="0" ng-if="criteria.school" flex-offset="5" flex-offset-xs="0"></div> </div> <div layout="row" layout-xs="column" ng-if="criteria.student !== null && criteria.studentGroup !== null"> <md-input-container flex="50" flex-xs="100" ng-if="criteria.student"> <label>{{\'poll.response.student\' | translate}}</label> <hois-value value="criteria.student"></hois-value> </md-input-container> <md-input-container flex="50" flex-xs="100" ng-if="criteria.studentGroup" flex-offset="{{criteria.student ? \'5\' : \'0\'}}" flex-offset-xs="0"> <label>{{\'poll.studentgroup\' | translate}}</label> <hois-value value="currentLanguageNameField(criteria.studentGroup)"></hois-value> </md-input-container> <div flex="50" flex-xs="0" ng-if="!criteria.student" flex-offset="5" flex-offset-xs="0"></div> </div> <div layout="row" layout-xs="column" ng-if="criteria.enterprise !== null || (criteria.practiceFrom !== null && criteria.practiceThru != null)"> <md-input-container flex="50" flex-xs="100" class="margin-bottom-0" ng-if="criteria.enterprise"> <label>{{\'poll.response.enterprise\' | translate}}</label> <hois-value value="criteria.enterprise"></hois-value> </md-input-container> <md-input-container flex="50" flex-xs="100" style="margin-bottom: 0px" ng-if="criteria.practiceFrom && criteria.practiceThru" flex-offset="{{criteria.enterprise ? \'5\' : \'0\'}}" flex-offset-xs="0"> <label>{{\'poll.response.practiceDuration\' | translate}}</label> <hois-value value="(criteria.practiceFrom | hoisDate) + \' - \' + (criteria.practiceThru | hoisDate)"></hois-value> </md-input-container> <div flex="50" flex-xs="0" ng-if="!criteria.enterprise" flex-offset="5" flex-offset-xs="0"></div> </div> <div layout="row" ng-if="criteria.foreword !== null"> <p style="word-break: break-word; font-size: 15px">{{criteria.foreword}}</p> </div> </div> <fieldset> <legend md-colors="{color: \'primary-800\'}" style="word-break: break-word" class="md-title-small">{{item.orderNr + \' \' + item.nameEt}}</legend> <div ng-repeat="question in item.questions track by $index" layout="row" flex> <div flex="100"> <fieldset> <div layout="row"> <div layout="column" flex="100"> <div layout="row" layout-align="start center"> <h2 style="word-break: break-word; margin-bottom: 0px">{{item.orderNr + \'.\' + question.orderNr + \' \' + (question.isRequired ? \'*\' : \'\') + question.nameEt}}</h2> </div> </div> </div> <div layout="{{question.pictures.length !== 0 ? \'row\' : \'column\'}}" layout-xs="column"> <div layout="column" flex="35" flex-xs="100"> <div ng-repeat="file in question.files track by $index"> <img ng-if="file.ftype.indexOf(\'image\') !== -1" flex style="display: block; margin-left: auto; margin-right: auto; max-width: 100%; max-height: 100%" ng-src="{{getUrl(file)}}"> <div ng-if="file.ftype.indexOf(\'image\') === -1"> {{file.fname}} <a ng-href="{{getUrl(file)}}" target="_blank" rel="noopener noreferrer" download> <md-icon md-font-set="material-icons">file_download</md-icon> </a> </div> </div> </div> <div layout="column" flex="{{question.pictures.length !== 0 ? \'60\' : \'100\'}}" flex-xs="100" flex-offset="{{question.pictures.length !== 0 ? \'5\' : \'0\'}}"> <p style="word-break: break-word; margin-top: 0px;font-style: italic;font-size: 13px">{{question.addInfoEt}}</p> <div ng-if="question.type === \'VASTUS_S\'" layout="{{question.isInRow ? \'row\' : \'column\'}}" flex="100" class="{{question.requiredError ? \'red-border\' : \'\'}}"> <div ng-repeat="answer in question.answers track by $index" flex> <md-input-container flex> <md-checkbox ng-disabled="formState.viewOnly" ng-model="answer.chosen" aria-label="required" ng-change="question.requiredError && checkErrors()" ng-blur="save(question)"> <span style="word-break: break-word">{{answer.nameEt}}</span> </md-checkbox> </md-input-container> </div> </div> <div ng-if="question.type === \'VASTUS_R\'" layout="column" class="{{question.requiredError ? \'red-border\' : \'\'}}"> <md-radio-group name="radio" ng-model="question.answerTxt" ng-disabled="formState.viewOnly" layout="{{question.isInRow ? \'row\' : \'column\'}}" layout-xs="column" flex="100" ng-change="save(question)" ng-blur="question.requiredError && checkErrors()"> <md-input-container ng-repeat="answer in question.answers track by $index"> <md-radio-button ng-value="answer.nameEt" aria-label="period" flex> <span style="word-break: break-word">{{answer.nameEt}}</span> </md-radio-button> </md-input-container> </md-radio-group> <div ng-if="responseForm.$submitted" ng-messages="pollForm.radio.$error"> <div ng-message="required">{{\'main.messages.error.inputFieldIsRequired\' | translate}}</div> </div> <div layout="row" ng-if="!question.isRequired && !formState.viewOnly"> <md-button ng-click="clearRadio(question)" class="md-raised">{{\'main.button.clear\' | translate}}</md-button> </div> </div> <div ng-if="question.type === \'VASTUS_M\'" layout="{{question.isInRow ? \'row\' : \'column\'}}" class="{{question.requiredError ? \'red-border\' : \'\'}}"> <div ng-repeat="answer in question.answers track by $index" flex> <md-input-container flex> <md-checkbox ng-model="answer.chosen" ng-disabled="formState.viewOnly" aria-label="checkBox" name="checkBox" ng-change="question.requiredError && checkErrors()" ng-blur="save(question)"> <span style="word-break: break-word">{{answer.nameEt}}</span> </md-checkbox> </md-input-container> </div> </div> <div ng-if="question.type === \'VASTUS_T\'" layout="row"> <md-input-container flex> <label>{{answer.nameEt}}</label> <textarea ng-model="question.answerTxt" ng-disabled="formState.viewOnly" type="text" ng-required="question.isRequired" md-maxlength="4000" max-rows="5" ng-blur="save(question)"></textarea> </md-input-container> </div> <div ng-if="question.type === \'VASTUS_V\'" layout="row"> <md-input-container flex> <label>{{answer.nameEt}}</label> <hois-select ng-model="question.answerTxt" ng-disabled="formState.viewOnly" values="question.answers" ng-required="question.isRequired" sorted-query="true" order-by-property="orderNr" value-property="nameEt" ng-blur="save(question)" aria-label="answers"></hois-select> </md-input-container> </div> </div> </div> </fieldset> <br ng-if="!$last"> </div> </div> </fieldset> <div layout="row" layout-align="space-between" layout-xs="column"> <div layout="row"> <md-button class="md-raised" ng-click="previousTheme($index)" ng-if="!$first" flex-xs="100"> <md-icon md-font-set="material-icons">keyboard_arrow_left</md-icon> {{\'poll.questions.previousTheme\' | translate}} </md-button> </div> <div layout="row"> <md-button class="md-raised" ng-click="nextTheme($index)" ng-if="!$last" flex-xs="100"> {{\'poll.questions.nextTheme\' | translate}} <md-icon md-font-set="material-icons">keyboard_arrow_right</md-icon> </md-button> </div> </div> <div layout="column" ng-if="$last"> <div layout="row"> <p style="word-break: break-word; font-size: 15px">{{criteria.afterword}}</p> </div> <div layout="row" ng-if="!formState.viewOnly"> <md-button flex-xs="100" type="submit" class="md-raised">{{\'main.button.confirm\' | translate}}</md-button> </div> </div> </div> </div> </div> </form> </div> </div> </md-dialog-content> </md-dialog>'),
a.put("poll/poll.response.dialog.html",'<style>.link-no-underline {\r\n        text-decoration: none;\r\n    }\r\n    .link-disabled {\r\n        color: #d7dde5;\r\n    }\r\n    md-checkbox .md-container {\r\n        top: 10px;\r\n    }\r\n    md-radio-button .md-container {\r\n        top: 10px;\r\n    }\r\n    .red-border {\r\n        border: 1px solid red;\r\n        border-radius: 5px;\r\n    }\r\n    .md-toolbar-tools {\r\n        max-height: max-content;\r\n    }\r\n    .margin-bottom-0 {\r\n        margin-bottom: 0px !important;\r\n    }\r\n    /** xs breakpoint */\r\n    @media(max-width: 600px) {\r\n        .margin-bottom-0 {\r\n            margin-bottom: 18px !important;\r\n        }\r\n    }</style> <md-dialog aria-label="add question dialog" flex> <md-toolbar style="min-height: max-content"> <div class="md-toolbar-tools" flex> <h2 flex style="word-break: break-word">{{currentLanguageNameField(formState.name) + \' (\' + (criteria.startDate | hoisDate) + \' - \' + (criteria.endDate | hoisDate) + \')\'}}</h2> <md-button class="md-icon-button" ng-click="close()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <div class="md-dialog-content" flex> <div layout="column" ng-cloak> <form name="responseForm" ng-submit="confirm()" ng-cloak novalidate> <div flex> <div ng-if="criteria.themes" layout="column"> <div ng-repeat="item in criteria.themes track by $index" layout="column" flex ng-style="{\'margin-top\': $first ? \'0px\' : \'16px\'}"> <div layout="column" ng-if="$first" class="form-readonly"> <div layout="row" ng-if="criteria.school !== null"> <md-input-container flex="50" flex-xs="100" ng-if="criteria.school"> <label>{{\'poll.response.school\' | translate}}</label> <hois-value value="currentLanguageNameField(criteria.school)"></hois-value> </md-input-container> <div flex="50" flex-xs="0" ng-if="criteria.school" flex-offset="5" flex-offset-xs="0"></div> </div> <div layout="row" layout-xs="column" ng-if="criteria.student !== null && criteria.studentGroup !== null"> <md-input-container flex="50" flex-xs="100" ng-if="criteria.student"> <label>{{\'poll.response.student\' | translate}}</label> <hois-value value="criteria.student"></hois-value> </md-input-container> <md-input-container flex="50" flex-xs="100" ng-if="criteria.studentGroup" flex-offset="5" flex-offset-xs="0"> <label>{{\'poll.studentgroup\' | translate}}</label> <hois-value value="currentLanguageNameField(criteria.studentGroup)"></hois-value> </md-input-container> <div flex="50" flex-xs="0" ng-if="!criteria.student" flex-offset="5" flex-offset-xs="0"></div> </div> <div layout="row" layout-xs="column" ng-if="criteria.enterprise !== null || (criteria.practiceFrom !== null && criteria.practiceThru != null)"> <md-input-container flex="50" flex-xs="100" class="margin-bottom-0" ng-if="criteria.enterprise"> <label>{{\'poll.response.enterprise\' | translate}}</label> <hois-value value="criteria.enterprise"></hois-value> </md-input-container> <md-input-container flex="50" flex-xs="100" style="margin-bottom: 0px" ng-if="criteria.practiceFrom && criteria.practiceThru" flex-offset="{{criteria.enterprise ? \'5\' : \'0\'}}" flex-offset-xs="0"> <label>{{\'poll.response.practiceDuration\' | translate}}</label> <hois-value value="(criteria.practiceFrom | hoisDate) + \' - \' + (criteria.practiceThru | hoisDate)"></hois-value> </md-input-container> <div flex="50" flex-xs="0" ng-if="!criteria.enterprise" flex-offset="5" flex-offset-xs="0"></div> </div> <div layout="row" ng-if="criteria.foreword !== null"> <p style="word-break: break-word; font-size: 15px">{{criteria.foreword}}</p> </div> </div> <fieldset flex="100"> <legend md-colors="{color: \'primary-800\'}" style="word-break: break-word" class="md-title-small">{{item.orderNr + \' \' + item.nameEt}}</legend> <div ng-repeat="question in item.questions track by $index" layout="row" flex> <div flex="100"> <fieldset> <div layout="row"> <div layout="column" flex="100"> <div layout="row" layout-align="start center"> <h2 style="word-break: break-word; margin-bottom: 0px">{{item.orderNr + \'.\' + question.orderNr + \' \' + (question.isRequired ? \'*\' : \'\') + question.nameEt}}</h2> </div> </div> </div> <div layout="{{question.pictures.length !== 0 ? \'row\' : \'column\'}}" layout-xs="column"> <div layout="column" flex="35" flex-xs="100"> <div ng-repeat="file in question.files track by $index"> <img ng-if="file.ftype.indexOf(\'image\') !== -1" flex style="display: block; margin-left: auto; margin-right: auto; max-width: 100%; max-height: 100%" ng-src="{{getUrl(file)}}"> <div ng-if="file.ftype.indexOf(\'image\') === -1"> {{file.fname}} <a ng-href="{{getUrl(file)}}" target="_blank" rel="noopener noreferrer" download> <md-icon md-font-set="material-icons">file_download</md-icon> </a> </div> </div> </div> <div layout="column" flex="{{question.pictures.length !== 0 ? \'60\' : \'100\'}}" flex-xs="100" flex-offset="{{question.pictures.length !== 0 ? \'5\' : \'0\'}}"> <p style="word-break: break-word; margin-top: 0px;font-style: italic;font-size: 13px">{{question.addInfoEt}}</p> <div ng-if="question.type === \'VASTUS_S\'" layout="{{question.isInRow ? \'row\' : \'column\'}}" flex="100" class="{{question.requiredError ? \'red-border\' : \'\'}}"> <div ng-repeat="answer in question.answers track by $index" flex> <md-input-container flex> <md-checkbox ng-model="answer.chosen" ng-disabled="formState.viewOnly" aria-label="required" ng-change="question.requiredError && checkErrors()" ng-blur="save(question)"> <span style="word-break: break-word">{{answer.nameEt}}</span> </md-checkbox> </md-input-container> </div> </div> <div ng-if="question.type === \'VASTUS_R\'" layout="row" class="{{question.requiredError ? \'red-border\' : \'\'}}"> <md-input-container flex> <md-radio-group name="radio" ng-model="question.answerTxt" ng-disabled="formState.viewOnly" layout="{{question.isInRow ? \'row\' : \'column\'}}" layout-xs="column" flex="100" ng-change="question.requiredError && checkErrors()" ng-blur="save(question)"> <md-input-container ng-repeat="answer in question.answers track by $index"> <md-radio-button ng-value="answer.nameEt" aria-label="period" flex> <span style="word-break: break-word">{{answer.nameEt}}</span> </md-radio-button> </md-input-container> </md-radio-group> <div ng-if="responseForm.$submitted" ng-messages="pollForm.radio.$error"> <div ng-message="required">{{\'main.messages.error.inputFieldIsRequired\' | translate}}</div> </div> <md-button ng-if="!question.isRequired && !formState.viewOnly" ng-click="clearRadio(question)" class="md-raised">{{\'main.button.clear\' | translate}}</md-button> </md-input-container> </div> <div ng-if="question.type === \'VASTUS_M\'" layout="{{question.isInRow ? \'row\' : \'column\'}}" layout-xs="column" class="{{question.requiredError ? \'red-border\' : \'\'}}"> <div ng-repeat="answer in question.answers track by $index" flex> <md-input-container flex> <md-checkbox ng-model="answer.chosen" ng-disabled="formState.viewOnly" aria-label="checkBox" name="checkBox" ng-change="question.requiredError && checkErrors()" ng-blur="save(question)"> <span style="word-break: break-word">{{answer.nameEt}}</span> </md-checkbox> </md-input-container> </div> </div> <div ng-if="question.type === \'VASTUS_T\'" layout="row"> <md-input-container flex> <label>{{answer.nameEt}}</label> <textarea ng-model="question.answerTxt" ng-disabled="formState.viewOnly" type="text" ng-required="question.isRequired" md-maxlength="4000" max-rows="5" ng-blur="save(question)"></textarea> </md-input-container> </div> <div ng-if="question.type === \'VASTUS_V\'" layout="row"> <md-input-container flex> <label>{{answer.nameEt}}</label> <hois-select ng-model="question.answerTxt" ng-disabled="formState.viewOnly" values="question.answers" ng-required="question.isRequired" sorted-query="true" order-by-property="orderNr" ng-blur="save(question)" value-property="nameEt" aria-label="answers"></hois-select> </md-input-container> </div> </div> </div> </fieldset> <br ng-if="!$last"> </div> </div> </fieldset> <br ng-if="!$last"> </div> </div> <div layout="row"> <p style="word-break: break-word; font-size: 15px">{{criteria.afterword}}</p> </div> </div> <div layout="row" ng-if="!formState.viewOnly"> <md-button flex-xs="100" type="submit" class="md-raised">{{\'main.button.confirm\' | translate}}</md-button> </div> </form> </div> </div> </md-dialog-content> </md-dialog>'),a.put("poll/poll.response.html",'<style>md-checkbox .md-container {\r\n        top: 10px;\r\n    }\r\n    md-radio-button .md-container {\r\n        top: 10px;\r\n    }\r\n    .red-border {\r\n        border: 1px solid red;\r\n        border-radius: 5px;\r\n    }\r\n    .margin-bottom-0 {\r\n        margin-bottom: 0px !important;\r\n    }\r\n    /** xs breakpoint */\r\n    @media(max-width: 600px) {\r\n        .margin-bottom-0 {\r\n            margin-bottom: 18px !important;\r\n        }\r\n    }</style> <div class="ois-form-layout-padding ois-form-layout" layout="column" ng-cloak> <form name="responseForm" ng-submit="confirm()" ng-cloak novalidate> <div flex> <div ng-if="criteria.themes" layout="column"> <div ng-repeat="item in criteria.themes track by $index" layout="column" flex ng-if="!criteria.isThemePageable || item.show"> <div layout="column" ng-if="$first" class="form-readonly"> <div layout="row" ng-if="criteria.school !== null"> <md-input-container flex="50" flex-xs="100" ng-if="criteria.school"> <label>{{\'poll.response.school\' | translate}}</label> <hois-value value="currentLanguageNameField(criteria.school)"></hois-value> </md-input-container> <md-input-container flex="50" flex-xs="100" ng-if="criteria.startDate && criteria.endDate" flex-offset="5" flex-offset-xs="0"> <label>{{\'poll.response.duration\' | translate}}</label> <hois-value value="(criteria.startDate | hoisDate) + \' - \' + (criteria.endDate | hoisDate)"></hois-value> </md-input-container> </div> <div layout="row" layout-xs="column" ng-if="criteria.student !== null && criteria.studentGroup !== null"> <md-input-container flex="50" flex-xs="100" ng-if="criteria.student"> <label>{{\'poll.response.student\' | translate}}</label> <hois-value value="criteria.student"></hois-value> </md-input-container> <md-input-container flex="50" flex-xs="100" ng-if="criteria.studentGroup" flex-offset="5" flex-offset-xs="0"> <label>{{\'poll.studentgroup\' | translate}}</label> <hois-value value="currentLanguageNameField(criteria.studentGroup)"></hois-value> </md-input-container> </div> <div layout="row" layout-xs="column" ng-if="criteria.enterprise !== null || (criteria.practiceFrom !== null && criteria.practiceThru != null)"> <md-input-container flex="50" flex-xs="100" class="margin-bottom-0" ng-if="criteria.enterprise"> <label>{{\'poll.response.enterprise\' | translate}}</label> <hois-value value="criteria.enterprise"></hois-value> </md-input-container> <md-input-container flex="50" flex-xs="100" ng-if="criteria.practiceFrom && criteria.practiceThru" style="margin-bottom: 0px" flex-offset="5" flex-offset-xs="0"> <label>{{\'poll.response.practiceDuration\' | translate}}</label> <hois-value value="(criteria.practiceFrom | hoisDate) + \' - \' + (criteria.practiceThru | hoisDate)"></hois-value> </md-input-container> </div> <div layout="row" ng-if="criteria.foreword !== null"> <p style="word-break: break-word; font-size: 15px">{{criteria.foreword}}</p> </div> </div> <fieldset flex="100"> <legend md-colors="{color: \'primary-800\'}" style="word-break: break-word" class="md-title-small">{{item.orderNr + \' \' + item.nameEt}}</legend> <div ng-repeat="question in item.questions track by $index" layout="row" flex ng-style="{\'margin-top\': $first ? \'0px\' : \'16px\'}"> <div flex="100"> <fieldset> <div layout="row"> <div layout="column" flex="100"> <div layout="row" layout-align="start center"> <h2 style="word-break: break-word; margin-bottom: 0px">{{item.orderNr + \'.\' + question.orderNr + \' \' + (question.isRequired ? \'*\' : \'\') + question.nameEt}}</h2> </div> </div> </div> <div layout="{{question.pictures.length !== 0 ? \'row\' : \'column\'}}" layout-xs="column"> <div layout="column" flex="35" flex-xs="100"> <div ng-repeat="file in question.files track by $index"> <img ng-if="file.ftype.indexOf(\'image\') !== -1" flex style="display: block; margin-left: auto; margin-right: auto; max-width: 100%; max-height: 100%" ng-src="{{getUrl(file)}}"> <div ng-if="file.ftype.indexOf(\'image\') === -1"> {{file.fname}} <a ng-href="{{getUrl(file)}}" target="_blank" rel="noopener noreferrer" download> <md-icon md-font-set="material-icons">file_download</md-icon> </a> </div> </div> </div> <div layout="column" flex="{{question.pictures.length !== 0 ? \'60\' : \'100\'}}" flex-xs="100" flex-offset="{{question.pictures.length !== 0 ? \'5\' : \'0\'}}"> <p style="word-break: break-word; margin-top: 0px;font-style: italic">{{question.addInfoEt}}</p> <div ng-if="question.type === \'VASTUS_S\'" layout="{{question.isInRow ? \'row\' : \'column\'}}" flex="100" class="{{question.requiredError ? \'red-border\' : \'\'}}"> <div ng-repeat="answer in question.answers track by $index" flex> <md-input-container flex> <md-checkbox ng-model="answer.chosen" aria-label="required" ng-blur="save(question)" ng-change="question.requiredError && checkErrors()"> <span style="word-break: break-word">{{answer.nameEt}}</span> </md-checkbox> </md-input-container> </div> </div> <div ng-if="question.type === \'VASTUS_R\'" layout="row" class="{{question.requiredError ? \'red-border\' : \'\'}}"> <md-input-container flex> <md-radio-group name="radio" ng-model="question.answerTxt" ng-required="question.isRequired" layout="{{question.isInRow ? \'row\' : \'column\'}}" layout-xs="column" flex="100" ng-blur="save(question)" ng-change="question.requiredError && checkErrors()"> <md-input-container ng-repeat="answer in question.answers track by $index"> <md-radio-button ng-value="answer.nameEt" aria-label="period" flex> <span style="word-break: break-word">{{answer.nameEt}}</span> </md-radio-button> </md-input-container> </md-radio-group> <div ng-if="responseForm.$submitted" ng-messages="pollForm.radio.$error"> <div ng-message="required">{{\'main.messages.error.inputFieldIsRequired\' | translate}}</div> </div> <md-button ng-if="!question.isRequired" ng-click="clearRadio(question)" class="md-raised">{{\'main.button.clear\' | translate}}</md-button> </md-input-container> </div> <div ng-if="question.type === \'VASTUS_M\'" layout="{{question.isInRow ? \'row\' : \'column\'}}" class="{{question.requiredError ? \'red-border\' : \'\'}}"> <div ng-repeat="answer in question.answers track by $index" flex> <md-input-container flex> <md-checkbox ng-model="answer.chosen" aria-label="checkBox" name="checkBox" ng-blur="save(question)" ng-change="question.requiredError && checkErrors()"> <span style="word-break: break-word">{{answer.nameEt}}</span> </md-checkbox> </md-input-container> </div> </div> <div ng-if="question.type === \'VASTUS_T\'" layout="row"> <md-input-container flex> <label>{{answer.nameEt}}</label> <textarea ng-model="question.answerTxt" type="text" ng-required="question.isRequired" md-maxlength="4000" max-rows="5" ng-blur="save(question)"></textarea> </md-input-container> </div> <div ng-if="question.type === \'VASTUS_V\'" layout="row"> <md-input-container flex> <label>{{answer.nameEt}}</label> <hois-select ng-model="question.answerTxt" values="question.answers" ng-required="question.isRequired" sorted-query="true" order-by-property="orderNr" value-property="nameEt" ng-blur="save(question)" aria-label="answers"></hois-select> </md-input-container> </div> </div> </div> </fieldset> <br ng-if="!$last"> </div> </div> </fieldset> <br ng-if="!criteria.isThemePageable && !$last"> <div layout="row" layout-align="space-between" ng-if="criteria.isThemePageable"> <div> <md-button class="md-raised" ng-click="previousTheme($index)" ng-if="!$first"> <md-icon md-font-set="material-icons">keyboard_arrow_left</md-icon> {{\'poll.questions.previousTheme\' | translate}} </md-button> </div> <div> <md-button class="md-raised" ng-click="nextTheme($index)" ng-if="!$last"> {{\'poll.questions.nextTheme\' | translate}} <md-icon md-font-set="material-icons">keyboard_arrow_right</md-icon> </md-button> </div> </div> <div layout="column" ng-if="criteria.isThemePageable && $last"> <div layout="row"> <p style="word-break: break-word; font-size: 15px">{{criteria.afterword}}</p> </div> <div layout="row"> <md-button flex-xs="100" type="submit" class="md-raised">{{\'main.button.confirm\' | translate}}</md-button> </div> </div> </div> </div> <div layout="row" ng-if="!criteria.isThemePageable"> <p style="word-break: break-word; font-size: 15px">{{criteria.afterword}}</p> </div> </div> <div layout="row" ng-if="!criteria.isThemePageable"> <md-button flex-xs="100" type="submit" class="md-raised">{{\'main.button.confirm\' | translate}}</md-button> </div> </form> </div>'),a.put("poll/poll.response.list.dialog.html",'<md-dialog aria-label="add enterprise dialog" flex="80"> <md-toolbar> <div class="md-toolbar-tools"> <h2 flex>{{"poll.questions.label" | translate}}</h2> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <div class="ois-form-layout" layout="column" layout-margin ng-cloak> <div ng-if="polls !== undefined && polls !== null && polls.length !== 0"> <md-table-container class="secondary-table" style="max-height: 400px"> <table md-table> <thead md-head> <tr md-row> <th md-column>{{\'poll.type\' | translate}}</th> <th md-column>{{\'poll.name\' | translate}}</th> <th md-column>{{\'poll.responseTime\' | translate}}</th> <th md-column>{{\'poll.responseStatus\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in polls | orderBy:\'validThru\'" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{row.type ? currentLanguageNameField(row.type) : \'-\'}}</td> <td md-cell> <a ng-click="openResponse(row)">{{row.name ? currentLanguageNameField(row.name) : \'-\'}}</a> </td> <td md-cell>{{(row.validFrom | hoisDate) + \' - \' + (row.validThru | hoisDate)}}</td> <td md-cell>{{row.status ? currentLanguageNameField(row.status) : \'-\'}}</td> <td md-cell> <div> <md-button md-no-ink class="md-primary change-button" ng-click="openResponse(row)">{{\'poll.respond\' | translate}}</md-button> </div> </td> </tr> </tbody> </table> </md-table-container> </div> </div> </md-dialog-content> <md-dialog-actions layout="row" layout-align="start start"> <md-button class="md-raised md-primary" ng-click="cancel()">{{"main.button.close" | translate}}</md-button> </md-dialog-actions> </md-dialog>'),a.put("poll/poll.results.edit.html",'<div id="scrolling_div" style="overflow: auto"> <md-nav-bar md-selected-nav-item="currentNavItem" nav-bar-aria-label="main selection" ng-cloak> <md-nav-item ng-if="!id" md-nav-href="#/poll/new?_noback" name="poll.data"> {{\'poll.basicData.label\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && id" md-nav-href="#/poll/{{::id}}/edit?_noback" name="poll.data"> {{\'poll.basicData.label\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && id" md-nav-href="#/poll/questions/{{::id}}/edit?_noback" name="poll.questions"> {{\'poll.questions.label\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && id" md-nav-href="#/poll/results/{{::id}}/edit?_noback" name="poll.results"> {{\'poll.results\' | translate}}</md-nav-item> </md-nav-bar> </div> <div class="ois-form-layout-padding ois-form-layout" layout="column" ng-include="\'poll/poll.results.html\'" ng-cloak></div>'),a.put("poll/poll.results.html",'<div layout="column" class="form-readonly" flex> <div layout="row"> <md-input-container flex> <label>{{\'poll.answers.amount\' | translate}}</label> <hois-value value="formState.allResponses"></hois-value> </md-input-container> <md-input-container flex flex-offset="5"> <label>{{\'poll.answers.notCompleted\' | translate}}</label> <hois-value value="formState.partialResponses"></hois-value> </md-input-container> </div> <div flex ng-if="formState.type === \'KYSITLUS_O\'"> <md-table-container> <table md-table md-progress="tabledata.$promise" class="secondary-table"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column>{{\'main.order\' | translate}}</th> <th md-column md-order-by="{{auth.higher ? \'s.name_et\' : \'j.name_et\'}}"> {{(auth.higher ? \'poll.response.subject\' : \'poll.response.journal\') | translate}} </th> <th md-column md-order-by="teachers">{{\'poll.answers.teachers\' | translate}}</th> <th md-column></th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{$index + 1}}.</td> <td md-cell><a ng-click="openAnswers(row)">{{row.name ? currentLanguageNameField(row.name) : \'-\'}}</a></td> <td md-cell>{{row.teachers ? row.teachers : \'-\'}}</td> <td md-cell> <md-button md-no-ink class="md-primary change-button" target="_blank" ng-click="subjectToExcel(row)"> {{\'document.button.excel\' | translate}} </md-button> </td> <td md-cell> <md-button md-no-ink class="md-primary change-button" ng-click="checkAnswer(row)"> {{\'poll.answers.checkAnswer\' | translate}} </md-button> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> <div flex ng-if="formState.type === \'KYSITLUS_P\'"> <md-table-container ng-if="hasStudentResponse || hasTeacherResponse"> <table md-table md-progress="tabledata.$promise" class="secondary-table"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column> {{\'poll.answers.target\' | translate}} </th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-class-odd="\'odd\'" ng-class-even="\'even\'" ng-if="hasStudentResponse"> <td md-cell><a ng-click="openStudentAnswers()">{{\'poll.answers.students\' | translate}}</a></td> <td md-cell> <md-button md-no-ink class="md-primary change-button" target="_blank" ng-click="studentToExcel()"> {{\'document.button.excel\' | translate}} </md-button> </td> </tr> <tr md-row ng-class-odd="\'odd\'" ng-class-even="\'even\'" ng-if="hasTeacherResponse"> <td md-cell><a ng-click="openTeacherAnswers()">{{\'poll.answers.teachers\' | translate}}</a></td> <td md-cell> <md-button md-no-ink class="md-primary change-button" target="_blank" ng-click="teacherToExcel()"> {{\'document.button.excel\' | translate}} </md-button> </td> </tr> </tbody> </table> </md-table-container> <md-table-container> <table md-table md-progress="tabledata.$promise" class="secondary-table"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column>{{\'main.order\' | translate}}</th> <th md-column md-order-by="ccss.name"> {{\'poll.answers.enterprise\' | translate}} </th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{$index + 1}}.</td> <td md-cell><a ng-click="openEnterpriseAnswer(row)">{{row ? currentLanguageNameField(row) : \'-\'}}</a></td> <td md-cell> <md-button md-no-ink class="md-primary change-button" target="_blank" ng-click="enterpriseToExcel(row)"> {{\'document.button.excel\' | translate}} </md-button> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> <div layout="row"> <md-button class="md-raised" target="_blank" download ng-click="allToExcel(row)"> {{\'document.button.excel\' | translate}} </md-button> <md-button class="md-raised" ng-click="openAllAnswers()"> {{\'poll.answers.graph\' | translate}} </md-button> </div> </div>'),a.put("poll/poll.results.student.dialog.html",'<md-dialog aria-label="add question dialog" flex="50"> <form name="dialogForm" ng-submit="search()" novalidate ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2 flex>{{higher ? (\'poll.answers.dialog.studentResponsesSubject\' | translate:criteria) : (\'poll.answers.dialog.studentResponsesJournal\' | translate:criteria)}}</h2> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <div class="md-dialog-content" flex> <div layout="row"> <md-input-container flex="80"> <label>{{\'poll.answers.dialog.student\' | translate}}</label> <input ng-model="criteria.studentName" md-maxlength="255"> </md-input-container> <md-button style="margin-bottom: 10px" flex="20" class="md-raised md-primary" ng-click="search()">{{"main.button.search" | translate}}</md-button> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise" class="secondary-table"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column>{{\'main.order\' | translate}}</th> <th md-column md-order-by="studentName">{{\'poll.answers.dialog.student\' | translate}}</th> <th md-column md-order-by="sg.code">{{\'poll.answers.dialog.studentGroup\' | translate}}</th> <th md-column md-order-by="r.status_code">{{\'poll.answers.dialog.status\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{$index + 1}}.</td> <td md-cell>{{row.name ? row.name : \'-\'}}</td> <td md-cell>{{row.studentGroup ? row.studentGroup : \'-\'}}</td> <td md-cell>{{row.status ? currentLanguageNameField(row.status) : \'-\'}}</td>  </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select> </md-table-pagination> </div> </div> </div> </md-dialog-content> <md-dialog-actions layout="row" layout-xs="column" layout-align="start start" layout-align-xs="none none"> <md-button flex-xs="100" class="md-raised" ng-click="cancel()">{{"main.button.close" | translate}}</md-button> </md-dialog-actions> </form> </md-dialog>'),a.put("poll/poll.results.view.html",'<div id="scrolling_div" style="overflow: auto"> <md-nav-bar md-selected-nav-item="currentNavItem" nav-bar-aria-label="main selection" ng-cloak> <md-nav-item ng-if="!id" md-nav-href="#/poll/new?_noback" name="poll.data"> {{\'poll.basicData.label\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && id" md-nav-href="#/poll/{{::id}}/view?_noback" name="poll.data"> {{\'poll.basicData.label\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && id" md-nav-href="#/poll/questions/{{::id}}/view?_noback" name="poll.questions"> {{\'poll.questions.label\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && id" md-nav-href="#/poll/results/{{::id}}/view?_noback" name="poll.results"> {{\'poll.results\' | translate}}</md-nav-item> </md-nav-bar> </div> <div class="ois-form-layout-padding ois-form-layout" layout="column" ng-include="\'poll/poll.results.html\'" ng-cloak></div>'),a.put("poll/poll.statistics.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <div layout="column"> <div layout="row"> <md-input-container flex="100"> <label>{{\'poll.type\' | translate}}</label> <hois-classifier-select ng-model="criteria.typeCode" ng-change="loadPolls()" required model-value-attr="code" main-classifier-code="KYSITLUS"></hois-classifier-select> </md-input-container> </div> <div layout="column" ng-if="criteria.typeCode"> <div layout="row"> <md-input-container flex="100"> <label>{{\'poll.statistics.pickPoll\' | translate}}</label> <md-select ng-model="criteria.poll" ng-model-options="{trackBy: \'$value.id\'}" ng-change="pollChanged()" aria-label="polls"> <md-option ng-repeat="val in polls" ng-value="val">{{currentLanguageNameField(val)}}</md-option> </md-select> </md-input-container> </div> <div ng-if="criteria.polls.length > 0" layout="row"> <md-table-container flex="100" style="max-height: 200px"> <table md-table class="secondary-table"> <thead md-head ng-hide="true"> <tr md-row> <th md-column width="90%"></th> <th md-column width="10%"></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="poll in criteria.polls" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{currentLanguageNameField(poll)}}</td> <td md-cell> <a ng-click="removeElement(criteria.polls, poll, true)" class="remove">&times;</a> </td> </tr> </tbody> </table> </md-table-container> </div> </div> <div layout="row" ng-if="criteria.polls.length > 0"> <md-input-container flex="70"> <label>{{\'poll.statistics.pickQuestion\' | translate}}</label> <md-select ng-model="criteria.question" ng-model-options="{trackBy: \'$value.id\'}" ng-change="questionChanged()" aria-label="questions"> <md-option ng-repeat="val in questions" ng-value="val">{{currentLanguageNameField(val)}}</md-option> </md-select> </md-input-container> <div layout="row" flex="30" layout-align="center center"> <md-input-container> <md-checkbox ng-model="criteria.allQuestions" ng-change="pickAllQuestions(criteria.allQuestions)" aria-label="all questions" style="margin-bottom: 0px"> {{\'poll.statistics.allQuestions\' | translate}} </md-checkbox> </md-input-container> </div> </div> <div ng-if="criteria.questions.length > 0" layout="row"> <md-table-container flex="100" style="max-height: 200px"> <table md-table class="secondary-table"> <thead md-head ng-hide="true"> <tr md-row> <th md-column width="90%"></th> <th md-column width="10%"></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="question in criteria.questions" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{currentLanguageNameField(question)}}</td> <td md-cell> <a ng-click="removeElement(criteria.questions, question)" class="remove">&times;</a> </td> </tr> </tbody> </table> </md-table-container> </div> </div> <div flex-xs="0" flex-gt-xs="0" flex-gt-sm="50"></div> <md-button ng-if="criteria.polls !== undefined && criteria.polls.length !== 0 && criteria.questions !== undefined && criteria.questions.length !== 0" class="md-raised" target="_blank" download ng-click="allToExcel()"> {{\'document.button.excel\' | translate}} </md-button> </div> </div>'),a.put("poll/poll.test.by.subjectOrJournal.dialog.html",'<style>.link-no-underline {\r\n        text-decoration: none;\r\n    }\r\n    .link-disabled {\r\n        color: #d7dde5;\r\n    }\r\n    md-checkbox .md-container {\r\n        top: 10px;\r\n    }\r\n    md-radio-button .md-container {\r\n        top: 10px;\r\n    }\r\n    .red-border {\r\n        border: 1px solid red;\r\n        border-radius: 5px;\r\n    }</style> <md-dialog aria-label="add question dialog" flex> <md-toolbar> <div class="md-toolbar-tools"> <h2 flex style="word-break: break-word">{{criteria.nameEt}}</h2> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <div class="md-dialog-content" flex> <div layout="column" ng-cloak> <form name="responseForm" ng-submit="confirm()" ng-cloak novalidate> <div flex> <div ng-if="formState.themeBySubjectOrJournalId" layout="column"> <div ng-repeat="(key, themeList) in formState.themeBySubjectOrJournalId track by $index" layout="column" flex ng-style="{\'margin-top\': $first ? \'0px\' : \'16px\'}" ng-if="themeList.show"> <div layout="row" ng-if="themeList.length === 0"> <p style="word-break: break-word; font-size: 15px">{{criteria.foreword}}</p> </div> <div ng-repeat="item in themeList" layout="column" flex> <div layout="column" ng-if="first($index)"> <div layout="row" ng-if="key === \'null\' && criteria.type === \'KYSITLUS_O\' && hasSubjectOrJournal" class="form-readonly"> <p style="margin-top: 0px">{{\'poll.response.other\' | translate}}</p> </div> <div layout="row" ng-if="themeList.journal !== undefined" class="form-readonly"> <md-input-container flex="50"> <label>{{\'poll.response.journal\' | translate}}</label> <hois-value value="currentLanguageNameField(themeList.journal)"></hois-value> </md-input-container> </div> <div layout="row" ng-if="themeList.subject !== undefined" class="form-readonly"> <md-input-container flex="50"> <label>{{\'poll.response.subject\' | translate}}</label> <hois-value value="currentLanguageNameField(themeList.subject)"></hois-value> </md-input-container> </div> <div layout="row" ng-if="criteria.foreword !== null && firstPage(themeList)"> <p style="word-break: break-word; font-size: 15px">{{criteria.foreword}}</p> </div> </div> <fieldset> <legend md-colors="{color: \'primary-800\'}" style="word-break: break-word" class="md-title-small">{{item.orderNr + \' \' + item.nameEt}}</legend> <div ng-repeat="question in item.questions track by $index" layout="row" flex> <div flex="100"> <fieldset> <div layout="row"> <div layout="column" flex="100"> <div layout="row" layout-align="start center"> <h2 style="word-break: break-word; margin-bottom: 0px">{{item.orderNr + \'.\' + question.orderNr + \' \' + (question.isRequired ? \'*\' : \'\') + question.nameEt}}</h2> </div> </div> </div> <div layout="{{question.pictures.length !== 0 ? \'row\' : \'column\'}}"> <div layout="column" flex="35"> <div ng-repeat="file in question.files track by $index"> <img ng-if="file.ftype.indexOf(\'image\') !== -1" flex style="display: block; margin-left: auto; margin-right: auto; max-width: 100%; max-height: 100%" ng-src="{{getUrl(file)}}"> <div ng-if="file.ftype.indexOf(\'image\') === -1"> {{file.fname}} <a ng-href="{{getUrl(file)}}" target="_blank" rel="noopener noreferrer" download> <md-icon md-font-set="material-icons">file_download</md-icon> </a> </div> </div> </div> <div layout="column" flex="{{question.pictures.length !== 0 ? \'60\' : \'100\'}}" flex-offset="{{question.pictures.length !== 0 ? \'5\' : \'0\'}}"> <p style="word-break: break-word; margin-top: 0px;font-style: italic;font-size: 13px">{{question.addInfoEt}}</p> <div ng-if="question.type === \'VASTUS_S\'" layout="{{question.isInRow ? \'row\' : \'column\'}}" flex="100" class="{{question.requiredError ? \'red-border\' : \'\'}}"> <div ng-repeat="answer in question.answers track by $index" flex> <md-input-container flex> <md-checkbox ng-model="answer.chosen" aria-label="required" ng-change="question.requiredError && checkErrors()" ng-blur="save(question)"> <span style="word-break: break-word">{{answer.nameEt}}</span> </md-checkbox> </md-input-container> </div> </div> <div ng-if="question.type === \'VASTUS_R\'" layout="row" class="{{question.requiredError ? \'red-border\' : \'\'}}"> <md-input-container flex> <md-radio-group name="radio" ng-model="question.answerTxt" layout="{{question.isInRow ? \'row\' : \'column\'}}" flex="100" ng-change="question.requiredError && checkErrors()" ng-blur="save(question)"> <md-radio-button ng-value="answer.nameEt" aria-label="period" ng-repeat="answer in question.answers track by $index" flex> <span style="word-break: break-word">{{answer.nameEt}}</span></md-radio-button> </md-radio-group> <div ng-if="responseForm.$submitted" ng-messages="pollForm.radio.$error"> <div ng-message="required">{{\'main.messages.error.inputFieldIsRequired\' | translate}}</div> </div> <md-button ng-if="!question.isRequired" ng-click="clearRadio(question)" class="md-raised">{{\'main.button.clear\' | translate}}</md-button> </md-input-container> </div> <div ng-if="question.type === \'VASTUS_M\'" layout="{{question.isInRow ? \'row\' : \'column\'}}" class="{{question.requiredError ? \'red-border\' : \'\'}}"> <div ng-repeat="answer in question.answers track by $index" flex> <md-input-container flex> <md-checkbox ng-model="answer.chosen" aria-label="checkBox" name="checkBox" ng-change="question.requiredError && checkErrors()" ng-blur="save(question)"> <span style="word-break: break-word">{{answer.nameEt}}</span> </md-checkbox> </md-input-container> </div> </div> <div ng-if="question.type === \'VASTUS_T\'" layout="row"> <md-input-container flex> <label>{{answer.nameEt}}</label> <textarea ng-model="question.answerTxt" type="text" ng-required="question.isRequired" md-maxlength="4000" max-rows="5" ng-blur="save(question)"></textarea> </md-input-container> </div> <div ng-if="question.type === \'VASTUS_V\'" layout="row"> <md-input-container flex> <label>{{answer.nameEt}}</label> <hois-select ng-model="question.answerTxt" values="question.answers" ng-required="question.isRequired" sorted-query="true" order-by-property="orderNr" ng-blur="save(question)" aria-label="answers"></hois-select> </md-input-container> </div> </div> </div> </fieldset> <br ng-if="!$last"> </div> </div> </fieldset> <br ng-if="!$last"> </div> <div layout="row" layout-align="space-between"> <div> <md-button class="md-raised" ng-click="previousSubjectOrJournal($index)" ng-if="!first($index)"> <md-icon md-font-set="material-icons">keyboard_arrow_left</md-icon> {{\'poll.questions.previous\' | translate}} </md-button> </div> <div> <md-button class="md-raised" ng-click="nextSubjectOrJournal($index)" ng-if="!last($index)"> {{\'poll.questions.next\' | translate}} <md-icon md-font-set="material-icons">keyboard_arrow_right</md-icon> </md-button> </div> </div> <div layout="column" ng-if="last($index)"> <div layout="row"> <p style="word-break: break-word; font-size: 15px">{{criteria.afterword}}</p> </div> </div> </div> </div> </div> </form> </div> </div> </md-dialog-content> <md-dialog-actions layout="row" layout-xs="column" layout-align="start start" layout-align-xs="none none"> <md-button flex-xs="100" class="md-raised" ng-click="cancel()">{{"main.button.close" | translate}}</md-button> </md-dialog-actions> </md-dialog>'),
a.put("poll/poll.test.by.theme.dialog.html",'<style>md-checkbox .md-container {\r\n        top: 10px;\r\n    }\r\n    md-radio-button .md-container {\r\n        top: 10px;\r\n    }</style> <md-dialog aria-label="add question dialog" flex="80"> <form name="dialogForm" novalidate ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2 flex style="word-break: break-word">{{criteria.nameEt}}</h2> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <div class="md-dialog-content" flex> <div ng-if="criteria.themes" layout="column"> <div ng-repeat="item in criteria.themes track by $index" layout="column" flex ng-style="{\'margin-top\': $first ? \'0px\' : \'16px\'}" ng-if="item.show"> <div layout="row" ng-if="$first"> <p style="word-break: break-word; font-size: 15px;margin-top: 0px">{{criteria.foreword}}</p> </div> <div layout="row" ng-if="item.journal !== null" class="form-readonly"> <md-input-container flex="50"> <label>{{\'poll.response.journal\' | translate}}</label> <hois-value value="currentLanguageNameField(item.journal)"></hois-value> </md-input-container> </div> <div layout="row" ng-if="item.subject !== null" class="form-readonly"> <md-input-container flex="50"> <label>{{\'poll.response.subject\' | translate}}</label> <hois-value value="currentLanguageNameField(item.subject)"></hois-value> </md-input-container> </div> <div layout="row" ng-if="item.journal === null && item.subject === null && criteria.type === \'KYSITLUS_O\' && criteria.themes.length !== 1" class="form-readonly"> <p style="margin-top: 0px">{{\'poll.response.other\' | translate}}</p> </div> <fieldset> <legend md-colors="{color: \'primary-800\'}" style="word-break: break-word" class="md-title-small">{{item.orderNr + \' \' + item.nameEt}}</legend> <div ng-repeat="question in item.questions track by $index" layout="row" flex> <div flex="100"> <fieldset> <div layout="row"> <div layout="column" flex="100"> <div layout="row" layout-align="start center"> <h2 style="word-break: break-word; margin-bottom: 0px">{{item.orderNr + \'.\' + question.orderNr + \' \' + (question.isRequired ? \'*\' : \'\') + question.nameEt}}</h2> </div> </div> </div> <div layout="{{question.pictures.length !== 0 ? \'row\' : \'column\'}}"> <div layout="column" flex="35"> <div ng-repeat="file in question.files track by $index"> <img ng-if="file.ftype.indexOf(\'image\') !== -1" flex style="display: block; margin-left: auto; margin-right: auto; max-width: 100%; max-height: 100%" ng-src="{{getUrl(file)}}"> <div ng-if="file.ftype.indexOf(\'image\') === -1"> {{file.fname}} <a ng-href="{{getUrl(file)}}" target="_blank" rel="noopener noreferrer" download> <md-icon md-font-set="material-icons">file_download</md-icon> </a> </div> </div> </div> <div layout="column" flex="{{question.pictures.length !== 0 ? \'60\' : \'100\'}}" flex-offset="{{question.pictures.length !== 0 ? \'5\' : \'0\'}}"> <p style="word-break: break-word; margin-top: 0px;font-style: italic;font-size: 13px">{{question.addInfoEt}}</p> <div ng-if="question.type === \'VASTUS_S\'" layout="{{question.isInRow ? \'row\' : \'column\'}}" flex="100"> <div ng-repeat="answer in question.answers track by $index" flex> <md-input-container flex> <md-checkbox ng-model="s" aria-label="required"> <span style="word-break: break-word">{{answer.nameEt}}</span> </md-checkbox> </md-input-container> </div> </div> <div ng-if="question.type === \'VASTUS_R\'" layout="row"> <md-input-container flex> <md-radio-group name="radio" ng-model="question.radio1" required layout="{{question.isInRow ? \'row\' : \'column\'}}" flex="100"> <md-radio-button ng-value="answer.nameEt" aria-label="period" ng-repeat="answer in question.answers track by $index" flex> <span style="word-break: break-word">{{answer.nameEt}}</span></md-radio-button> </md-radio-group> <div ng-if="pollForm.$submitted" ng-messages="pollForm.radio.$error"> <div ng-message="required">{{\'main.messages.error.inputFieldIsRequired\' | translate}}</div> </div> <md-button ng-if="!question.isRequired" ng-click="clearRadio(question)" class="md-raised">{{\'main.button.clear\' | translate}}</md-button> </md-input-container> </div> <div ng-if="question.type === \'VASTUS_M\'" layout="{{question.isInRow ? \'row\' : \'column\'}}"> <div ng-repeat="answer in question.answers track by $index" flex> <md-input-container flex> <md-checkbox ng-model="s" aria-label="required"> <span style="word-break: break-word">{{answer.nameEt}}</span> </md-checkbox> </md-input-container> </div> </div> <div ng-if="question.type === \'VASTUS_T\'" layout="row"> <md-input-container flex> <label>{{answer.nameEt}}</label> <textarea ng-model="s" type="text" required md-maxlength="4000" max-rows="5"></textarea> </md-input-container> </div> <div ng-if="question.type === \'VASTUS_V\'" layout="row"> <md-input-container flex> <label>{{answer.nameEt}}</label> <hois-select ng-model="s" values="question.answers" sorted-query="true" order-by-property="orderNr" required aria-label="selectAnswer"></hois-select> </md-input-container> </div> </div> </div> </fieldset> <br ng-if="!$last"> </div> </div> </fieldset> <div layout="row" layout-align="space-between"> <div> <md-button class="md-raised" ng-click="previousTheme($index)" ng-if="!$first"> <md-icon md-font-set="material-icons">keyboard_arrow_left</md-icon> {{\'poll.questions.previousTheme\' | translate}} </md-button> </div> <div> <md-button class="md-raised" ng-click="nextTheme($index)" ng-if="!$last"> {{\'poll.questions.nextTheme\' | translate}} <md-icon md-font-set="material-icons">keyboard_arrow_right</md-icon> </md-button> </div> </div> <div layout="row" ng-if="$last"> <p style="word-break: break-word; font-size: 15px">{{criteria.afterword}}</p> </div> </div> </div> </div> </md-dialog-content> <md-dialog-actions layout="row" layout-xs="column" layout-align="start start" layout-align-xs="none none"> <md-button flex-xs="100" class="md-raised" ng-click="cancel()">{{"main.button.close" | translate}}</md-button> </md-dialog-actions> </form> </md-dialog>'),a.put("poll/poll.test.dialog.html",'<style>md-checkbox .md-container {\r\n        top: 10px;\r\n    }\r\n    md-radio-button .md-container {\r\n        top: 10px;\r\n    }</style> <md-dialog aria-label="add question dialog" flex="80"> <form name="dialogForm" novalidate ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2 flex style="word-break: break-word">{{criteria.nameEt}}</h2> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <div class="md-dialog-content" flex> <div layout="row"> <p style="word-break: break-word; font-size: 15px;margin-top: 0px">{{criteria.foreword}}</p> </div> <div ng-if="criteria.themes" layout="column"> <div ng-repeat="item in criteria.themes track by $index" class="occupation-row align-center" layout="row" flex ng-style="{\'margin-top\': $first ? \'0px\' : \'16px\'}"> <fieldset flex="100"> <legend md-colors="{color: \'primary-800\'}" style="word-break: break-word" class="md-title-small">{{item.orderNr + \' \' + item.nameEt}}</legend> <div ng-repeat="question in item.questions track by $index" layout="row" flex> <div flex="100"> <fieldset> <div layout="row"> <div layout="column" flex="100"> <div layout="row" layout-align="start center"> <h2 style="word-break: break-word; margin-bottom: 0px">{{item.orderNr + \'.\' + question.orderNr + \' \' + (question.isRequired ? \'*\' : \'\') + question.nameEt}}</h2> </div> </div> </div> <div layout="{{question.pictures.length !== 0 ? \'row\' : \'column\'}}"> <div layout="column" flex="35"> <div ng-repeat="file in question.files track by $index"> <img ng-if="file.ftype.indexOf(\'image\') !== -1" flex style="display: block; margin-left: auto; margin-right: auto; max-width: 100%; max-height: 100%" ng-src="{{getUrl(file)}}"> <div ng-if="file.ftype.indexOf(\'image\') === -1"> {{file.fname}} <a ng-href="{{getUrl(file)}}" target="_blank" rel="noopener noreferrer" download> <md-icon md-font-set="material-icons">file_download</md-icon> </a> </div> </div> </div> <div layout="column" flex="{{question.pictures.length !== 0 ? \'60\' : \'100\'}}" flex-offset="{{question.pictures.length !== 0 ? \'5\' : \'0\'}}"> <p style="word-break: break-word; margin-top: 0px;font-style: italic;font-size: 13px">{{question.addInfoEt}}</p> <div ng-if="question.type === \'VASTUS_S\'" layout="{{question.isInRow ? \'row\' : \'column\'}}" flex="100"> <div ng-repeat="answer in question.answers track by $index" flex> <md-input-container flex> <md-checkbox ng-model="s" aria-label="required"> <span style="word-break: break-word">{{answer.nameEt}}</span> </md-checkbox> </md-input-container> </div> </div> <div ng-if="question.type === \'VASTUS_R\'" layout="row"> <md-input-container flex> <md-radio-group name="radio" ng-model="question.radio1" required layout="{{question.isInRow ? \'row\' : \'column\'}}" flex="100"> <md-radio-button ng-value="answer.nameEt" aria-label="period" ng-repeat="answer in question.answers track by $index" flex> <span style="word-break: break-word">{{answer.nameEt}}</span></md-radio-button> </md-radio-group> <div ng-if="pollForm.$submitted" ng-messages="pollForm.radio.$error"> <div ng-message="required">{{\'main.messages.error.inputFieldIsRequired\' | translate}}</div> </div> <md-button ng-if="!question.isRequired" ng-click="clearRadio(question)" class="md-raised">{{\'main.button.clear\' | translate}}</md-button> </md-input-container> </div> <div ng-if="question.type === \'VASTUS_M\'" layout="{{question.isInRow ? \'row\' : \'column\'}}"> <div ng-repeat="answer in question.answers track by $index" flex> <md-input-container flex> <md-checkbox ng-model="s" aria-label="required"> <span style="word-break: break-word">{{answer.nameEt}}</span> </md-checkbox> </md-input-container> </div> </div> <div ng-if="question.type === \'VASTUS_T\'" layout="row"> <md-input-container flex> <label>{{answer.nameEt}}</label> <textarea ng-model="s" type="text" required md-maxlength="4000" max-rows="5"></textarea> </md-input-container> </div> <div ng-if="question.type === \'VASTUS_V\'" layout="row"> <md-input-container flex> <label>{{answer.nameEt}}</label> <hois-select ng-model="s" values="question.answers" sorted-query="true" order-by-property="orderNr" required></hois-select> </md-input-container> </div> </div> </div> </fieldset> <br ng-if="!$last"> </div> </div> </fieldset> <br ng-if="!$last"> </div> </div> <div layout="row"> <p style="word-break: break-word; font-size: 15px">{{criteria.afterword}}</p> </div> </div> </md-dialog-content> <md-dialog-actions layout="row" layout-xs="column" layout-align="start start" layout-align-xs="none none"> <md-button flex-xs="100" class="md-raised" ng-click="cancel()">{{"main.button.close" | translate}}</md-button> </md-dialog-actions> </form> </md-dialog>'),a.put("poll/poll.theme.add.dialog.html",'<md-dialog aria-label="add question dialog" flex="50"> <form name="dialogForm" ng-submit="submit()" novalidate ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2 flex>{{"poll.questions.themes" | translate}}</h2> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <div class="md-dialog-content" flex> <div layout="column"> <div layout="row"> <md-input-container flex> <label>{{\'poll.questions.theme\' | translate}}</label> <input ng-model="criteria.nameEt" type="text" md-maxlength="255" ng-change="checkTheme()" name="nameEt" required> <ng-messages for="dialogForm.nameEt.$error" role="alert"> <ng-message when="nameEtError">{{\'poll.questions.sameThemeError\' | translate}}</ng-message> </ng-messages> </md-input-container> </div> </div> </div> </md-dialog-content> <md-dialog-actions layout="row" layout-xs="column" layout-align="start start" layout-align-xs="none none"> <md-button flex-xs="100" class="md-raised md-primary" type="submit">{{\'main.button.save\' | translate}}</md-button> <md-button ng-if="criteria.id" flex-xs="100" class="md-raised" ng-click="delete()">{{\'main.button.delete\' | translate}}</md-button> <md-button flex-xs="100" class="md-raised" ng-click="cancel()">{{"main.button.close" | translate}}</md-button> </md-dialog-actions> </form> </md-dialog>'),a.put("poll/poll.view.html",'<div id="scrolling_div" style="overflow: auto"> <md-nav-bar md-selected-nav-item="currentNavItem" nav-bar-aria-label="main selection" ng-cloak> <md-nav-item ng-if="auth.isAdmin() && criteria.id" md-nav-href="#/poll/{{::criteria.id}}/view?_noback" name="poll.data"> {{\'poll.basicData.label\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && criteria.id" md-nav-href="#/poll/questions/{{::criteria.id}}/view?_noback" name="enterprise.questions"> {{\'poll.questions.label\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && criteria.id" md-nav-href="#/poll/results/{{::criteria.id}}/view?_noback" name="enterprise.results"> {{\'poll.results\' | translate}}</md-nav-item> </md-nav-bar> </div> <div class="ois-form-layout-padding ois-form-layout" layout="row" ng-cloak> <form name="pollForm" role="form" ng-submit="save()" flex novalidate> <div layout="column" class="form-readonly" flex> <div layout="row"> <md-input-container flex="50" flex-xs="100"> <label>{{\'poll.type\' | translate}}</label> <hois-classifier-value ng-model="criteria.type" main-classifier-code="KYSITLUS"></hois-classifier-value> </md-input-container> </div> <div layout="row"> <md-input-container flex="100"> <label class="textInput">{{\'poll.basicData.name\' | translate}}</label> <hois-value value="criteria.nameEt"></hois-value> </md-input-container> </div> <div layout="row" flex="100"> <md-input-container flex> <label class="textInput">{{\'poll.basicData.foreWord\' | translate}}</label> <hois-value value="criteria.foreword"></hois-value> </md-input-container> </div> <div layout="row" flex> <md-input-container flex> <label class="textInput">{{\'poll.basicData.afterWord\' | translate}}</label> <hois-value value="criteria.afterword"></hois-value> </md-input-container> </div> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'poll.basicData.target\' | translate}}</legend> <div ng-if="formState.targetCodes.length > 0" layout="row"> <md-table-container flex="50" style="max-height: 200px"> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column width="90%">{{\'poll.targets\' | translate}}</th> <th md-column width="10%"></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="targetCode in formState.targetCodes" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{currentLanguageNameField(targetCode)}}</td> <td md-cell> </td> </tr> </tbody> </table> </md-table-container> <div layout="row" flex="45" flex-offset="5"> <div layout="column" flex> <div ng-if="criteria.type === \'KYSITLUS_T\' || (criteria.type === \'KYSITLUS_Y\' && showOccupations)" layout="row"> <md-input-container flex> <label>{{auth.isHigher ? (\'main.menu.settings.teacheroccupationsHigher\' | translate) : (\'main.menu.settings.teacheroccupationsVocational\' | translate)}} </label> <hois-select ng-model="criteria.teacherOccupations" values="formState.occupations" multiple disabled></hois-select> </md-input-container> </div> <div layout="row" layout-xs="column" ng-if="criteria.type === \'KYSITLUS_P\' || (criteria.type === \'KYSITLUS_Y\' && showJournalDates)"> <md-input-container flex> <label>{{\'poll.basicData.journalFrom\' | translate}}</label> <hois-value name="from" value="criteria.journalFrom | hoisDate"></hois-value> </md-input-container> <md-input-container flex flex-offset="5" flex-offset-xs="0"> <label>{{\'poll.basicData.journalThru\' | translate}}</label> <hois-value name="thru" value="criteria.journalThru | hoisDate"></hois-value> </md-input-container> </div> <div layout="row" ng-if="auth.higher && criteria.type === \'KYSITLUS_O\'"> <md-input-container flex> <label>{{\'poll.basicData.declarationPeriod\' | translate}}</label> <hois-select ng-model="criteria.studyPeriod" type="studyperiodyear" disabled></hois-select> </md-input-container> </div> <div layout="row" layout-xs="column" style="margin-top: 5px" ng-if="showExpertUrl && criteria.id"> <md-input-container flex> <label>{{\'poll.basicData.outsiderUrl\' | translate}}</label> <hois-value value="criteria.pollUrl"></hois-value> </md-input-container> <md-button copy-to-clipboard="{{criteria.pollUrl}}">{{\'poll.basicData.copy\' | translate}}</md-button> </div> </div> </div> </div> <div ng-if="formState.studentGroups.length > 0" layout="row"> <md-table-container flex="50" flex-xs="100" style="max-height: 200px"> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column width="90%">{{\'poll.studentgroups\' | translate}}</th> <th md-column width="10%"></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="studentgroup in formState.studentGroups" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{currentLanguageNameField(studentgroup)}}</td> <td md-cell> </td> </tr> </tbody> </table> </md-table-container> </div> <div layout="column" ng-if="criteria.type === \'KYSITLUS_O\' && criteria.journals.length !== 0"> <div layout="row" ng-if="!auth.higher || (auth.higher && auth.vocational)"> <md-table-container flex="50" style="max-height: 200px"> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'poll.journals\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="journal in criteria.journals" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{currentLanguageNameField(journal)}}</td> </tr> </tbody> </table> </md-table-container> </div> </div> </fieldset> <br> <md-input-container flex="45" ng-if="criteria.type === \'KYSITLUS_O\'"> <md-checkbox ng-model="criteria.isTeacherComment" aria-label="required" disabled style="margin-bottom: 0px"> {{\'poll.basicData.teacherCanComment\' | translate}} </md-checkbox> </md-input-container> <md-input-container flex="45" ng-if="criteria.type === \'KYSITLUS_O\' && criteria.isTeacherComment"> <md-checkbox ng-model="criteria.isTeacherCommentVisible" aria-label="required" disabled style="margin-bottom: 0px"> {{\'poll.basicData.teacherCommentVisible\' | translate}} </md-checkbox> </md-input-container> <md-input-container flex="45" ng-if="criteria.type === \'KYSITLUS_O\'"> <md-checkbox ng-model="criteria.isStudentVisible" aria-label="required" disabled style="margin-bottom: 0px"> {{\'poll.basicData.studentCanSeeResponse\' | translate}} </md-checkbox> </md-input-container> <div ng-if="!displayDates"> <div layout="column"> <br> <div layout="row"> <md-input-container flex="20" flex-xs="50"> <label>{{\'main.validFrom\' | translate}}</label> <hois-value value="criteria.validFrom | hoisDate"></hois-value> </md-input-container> <md-input-container flex="20" flex-xs="50" flex-offset="5"> <label>{{\'main.validThru\' | translate}}</label> <hois-value value="criteria.validThru | hoisDate"></hois-value> </md-input-container> </div> </div> <div layout="row"> <md-input-container flex="25" flex-xs="50"> <label>{{\'poll.basicData.notificationDate\' | translate}}</label> <hois-value value="criteria.reminderDt | hoisDate"></hois-value> </md-input-container> </div> </div> </div> <div ng-if="displayDates"> <div layout="row"> <div flex="50" flex-xs="100"> <md-input-container flex="50"> <label>{{\'main.validFrom\' | translate}}</label> <md-datepicker name="from" ng-model="criteria.validFrom" md-max-date="earlierDate(criteria.reminderDt, criteria.validThru)" required ng-change="checkReminder()"></md-datepicker> </md-input-container> <md-input-container flex="50" flex-offset="5" flex-offset-xs="0"> <label>{{\'main.validThru\' | translate}}</label> <md-datepicker name="thru" ng-model="criteria.validThru" md-min-date="laterDate(criteria.reminderDt, criteria.validFrom)" required ng-change="checkReminder()"></md-datepicker> </md-input-container> </div> </div> <div layout="row"> <md-input-container flex="25" flex-xs="50"> <label>{{\'poll.basicData.notificationDate\' | translate}}</label> <md-datepicker id="notificationDate" name="reminderDt" ng-model="criteria.reminderDt" md-min-date="criteria.validFrom" md-max-date="criteria.validThru" ng-change="checkReminder()" required></md-datepicker> <ng-messages for="pollForm.reminderDt.$error" role="alert"> <ng-message when="incorrect">{{\'poll.basicData.reminderError\' | translate}}</ng-message> </ng-messages> </md-input-container> </div> </div> <div layout="column" class="form-readonly" flex> <div layout="row"> <md-input-container flex="25" flex-xs="100"> <label>{{\'poll.basicData.insertedBy\' | translate}}</label> <hois-value value="formState.insertedBy"></hois-value> </md-input-container> </div> <div layout="row"> <md-input-container flex="25" flex-xs="100"> <label>{{\'poll.basicData.changedBy\' | translate}}</label> <hois-value value="formState.changedBy"></hois-value> </md-input-container> </div> <div layout="row"> <md-input-container flex="25" flex-xs="100"> <label>{{\'poll.basicData.status\' | translate}}</label> <hois-value value="currentLanguageNameField(formState.status)"></hois-value> </md-input-container> </div> </div> <div layout="row" layout-xs="column"> <md-button flex-xs="100" ng-if="auth.isAdmin() && formState.status.code !== \'KYSITLUS_STAATUS_K\' && isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_KYSITLUS\')" ng-href="#/poll/{{::criteria.id}}/edit" class="md-raised md-primary">{{\'main.button.change\' | translate}}</md-button> <md-button flex-xs="100" ng-if="auth.isAdmin() && formState.status.code === \'KYSITLUS_STAATUS_K\' && formState.responded && displayDates && isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_KYSITLUS\')" ng-click="saveDates()" class="md-raised md-primary">{{\'main.button.save\' | translate}}</md-button> <md-button flex-xs="100" ng-if="auth.isAdmin() && formState.status.code === \'KYSITLUS_STAATUS_K\' && formState.responded && !displayDates && isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_KYSITLUS\')" ng-click="changeDisplayDates()" class="md-raised md-primary">{{\'poll.basicData.changeDates\' | translate}}</md-button> <md-button flex-xs="100" ng-if="auth.isAdmin() && criteria.id  && isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_KYSITLUS\')" ng-click="saveAndLoad()" class="md-raised">{{\'poll.copy\' | translate}}</md-button> <md-button flex-xs="100" ng-if="auth.isAdmin() && formState.status.code === \'KYSITLUS_STAATUS_K\' && !formState.responded  && isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_KYSITLUS\')" ng-click="removeConfirm()" class="md-raised">{{\'poll.basicData.removeConfirm\' | translate}}</md-button> <md-button flex-xs="100" ng-if="auth.isAdmin()" ng-click="test()" class="md-raised">{{\'poll.test\' | translate}}</md-button> <md-button flex-xs="100" ng-if="auth.isAdmin()" ng-click="back(\'#/poll\')" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </div> </form> </div>'),a.put("practiceApplication/practice.application.apply.dialog.html",'<md-dialog aria-label="apply for practice dialog" flex="50"> <form name="dialogForm" ng-submit="submit()" novalidate ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2 flex>{{"practiceApplication.applyFor" | translate}}</h2> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <div class="md-dialog-content" flex> <div layout="row">{{\'practiceApplication.prompt.applyConfirm\' | translate}}</div> <br> <div layout="row"> <md-input-container flex> <label class="textInput">{{\'practiceApplication.studentAddInfo\' | translate}}</label> <textarea ng-model="application.addInfo" name="addInfo" md-maxlength="4000" max-rows="5"></textarea> </md-input-container> </div> </div> </md-dialog-content> <md-dialog-actions layout="row" layout-align="start start"> <md-button class="md-raised md-primary" type="submit">{{\'main.yes\' | translate}}</md-button> <md-button class="md-raised" ng-click="cancel()">{{"main.no" | translate}}</md-button> </md-dialog-actions> </form> </md-dialog>'),a.put("practiceApplication/practice.application.list.html",'<md-nav-bar md-selected-nav-item="currentNavItem"> <md-nav-item md-nav-href="#/practice/applications?_menu" name="practice.application">{{\'practiceApplication.tabLabel\' | translate}}</md-nav-item> <md-nav-item md-nav-href="#/practice/applicationPeriods?_menu" name="practice.application-period">{{\'practiceApplication.periods.tabLabel\' | translate}}</md-nav-item> </md-nav-bar> <div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <form name="searchForm" ng-submit="searchForm.$valid && loadData()" novalidate class="nomargin" ng-model-options="{allowInvalid: true}"> <div layout="row" layout-sm="column" layout-xs="column"> <div flex="45" flex-sm="100" flex-xs="100"> <hois-autocomplete flex ng-model="criteria.studentGroup" ha-attribute="id" ha-controller="directiveControllers" method="studentgroups" label="{{\'practiceApplication.studentGroup\'}}"></hois-autocomplete> </div> <md-input-container flex="25" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-sm="0" flex-offset-xs="0"> <label>{{\'practiceApplication.submitFrom\' | translate}}</label> <md-datepicker ng-model="criteria.submitFrom" md-max-date="criteria.submitThru" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> <md-input-container flex="25" flex-sm="100" flex-xs="100"> <label>{{\'practiceApplication.submitThru\' | translate}}</label> <md-datepicker ng-model="criteria.submitThru" md-min-date="criteria.submitFrom" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'practiceApplication.studentName\' | translate}}</label> <input ng-model="criteria.studentName" name="studentName" type="text" md-maxlength="255"> </md-input-container> <md-input-container flex="45" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'practiceApplication.status\' | translate}}</label> <hois-classifier-select ng-model="criteria.status" name="status" model-value-attr="code" main-classifier-code="PR_TAOTLUS"></hois-classifier-select> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <div flex="45" flex-sm="100" flex-xs="100"> <hois-autocomplete flex ng-model="criteria.enterprise" method="enterprises" name="enterprise" label="enterprise.label" ha-attribute="id" ha-controller="directiveControllers"></hois-autocomplete> </div> </div> <div layout="row"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> </div> <div flex-xs="0" flex-gt-xs="0" flex-gt-sm="50"></div> </form> </fieldset> </div> </div> <div layout-padding> <div flex> <md-table-container> <table md-table> <thead md-head> <tr md-row> <th md-column>{{\'practiceApplication.studentName\' | translate}}</th> <th md-column>{{\'practiceApplication.studentGroup\' | translate}}</th> <th md-column>{{\'practiceApplication.status\' | translate}}</th> <th md-column>{{\'practiceApplication.submitDate\' | translate}}</th> <th md-column>{{\'practiceApplication.addInfoFromStudent\' | translate}}</th> <th md-column>{{\'practiceApplication.enterpriseName\' | translate}}</th> <th md-column>{{\'practiceApplication.applyPeriod\' | translate}}</th> <th md-column>&nbsp;</th> <th md-column>&nbsp;</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="application in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell> <div layout="row" layout-align="start center" flex> <a href="#/students/{{application.studentId}}/main">{{::application.studentName}}</a> </div> </td> <td md-cell>{{::application.studentGroup}}</td> <td md-cell>{{currentLanguageNameField(application.status)}} <md-tooltip ng-if="\'PR_TAOTLUS_T\' === application.status.code && application.rejectReason">{{::application.rejectReason}}</md-tooltip> </td> <td md-cell>{{application.submitDate | hoisDate}}</td> <td md-cell>{{::application.addInfo}}</td> <td md-cell>{{::application.enterpriseName}}</td> <td md-cell>{{application.validFrom | hoisDate}} - {{application.validThru | hoisDate}}</td> <td md-cell> <span ng-if="[\'PR_TAOTLUS_E\', \'PR_TAOTLUS_T\'].indexOf(application.status.code) !== -1"> <md-button md-no-ink class="md-primary change-button" ng-click="accept(application)">{{\'main.button.accept\' | translate}}</md-button> </span> <span ng-if="\'PR_TAOTLUS_A\' === application.status.code && !application.contractId"> <md-button md-no-ink class="md-primary change-button" ng-href="#/contracts/new?practiceApplication={{::application.id}}">{{\'practiceApplication.addContract\' | translate}}</md-button> </span> <span ng-if="\'PR_TAOTLUS_A\' === application.status.code && application.contractId"> <md-button md-no-ink class="md-primary change-button" ng-href="#/contracts/{{::application.contractId}}/view">{{\'practiceApplication.viewContract\' | translate}}</md-button> </span> </td> <td md-cell> <span ng-if="\'PR_TAOTLUS_E\' === application.status.code || (\'PR_TAOTLUS_A\' === application.status.code && !application.contractId)"> <md-button md-no-ink class="md-primary change-button" ng-click="reject(application)">{{\'main.button.reject\' | translate}}</md-button> </span> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> </div>'),a.put("practiceApplication/practice.application.period.list.html",'<md-nav-bar md-selected-nav-item="currentNavItem"> <md-nav-item md-nav-href="#/practice/applications?_menu" name="practice.application">{{\'practiceApplication.tabLabel\' | translate}}</md-nav-item> <md-nav-item md-nav-href="#/practice/applicationPeriods?_menu" name="practice.application-period">{{\'practiceApplication.periods.tabLabel\' | translate}}</md-nav-item> </md-nav-bar> <div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <form name="searchForm" ng-submit="searchForm.$valid && loadData()" novalidate class="nomargin" ng-model-options="{allowInvalid: true}"> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'practiceApplication.periods.enterpriseName\' | translate}}</label> <input ng-model="criteria.enterpriseName" name="enterpriseName" type="text" md-maxlength="255"> </md-input-container> <md-input-container flex="25" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-sm="0" flex-offset-xs="0"> <label>{{\'main.from\' | translate}}</label> <md-datepicker name="from" ng-model="criteria.validFrom" md-max-date="criteria.validThru" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> <md-input-container flex="25" flex-sm="100" flex-xs="100"> <label>{{\'main.thru\' | translate}}</label> <md-datepicker name="thru" ng-model="criteria.validThru" md-min-date="criteria.validFrom" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> </div> <div layout="column"> <md-input-container> <md-checkbox ng-model="criteria.opened" aria-label="{{\'practiceApplication.periods.openedAtTheMoment\' | translate}}"> {{\'practiceApplication.periods.openedAtTheMoment\' | translate}} </md-checkbox> </md-input-container> </div> <div layout="row"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> </div> </form> </fieldset> </div> </div> <div layout-padding> <div flex> <md-table-container> <table md-table> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="e.name">{{\'practiceApplication.periods.enterpriseName\' | translate}}</th> <th md-column md-order-by="padm.places">{{\'practiceApplication.periods.places\' | translate}}</th> <th md-column md-order-by="padm.valid_from, padm.valid_thru">{{\'practiceApplication.period\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{row.enterpriseName}}</td> <td md-cell>{{row.places}}</td> <td md-cell>{{row.validFrom | hoisDate}} - {{row.validThru | hoisDate}}</td> <td md-cell> <span> <md-button md-no-ink class="md-primary change-button" ng-click="edit(row)">{{\'main.button.edit\' | translate}}</md-button> </span> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> </div>'),
a.put("practiceApplication/practice.application.reject.dialog.html",'<md-dialog aria-label="apply for practice dialog" flex="50"> <form name="dialogForm" ng-submit="submit()" novalidate ng-cloak> <md-dialog-content> <div class="md-dialog-content" flex> <div layout="row">{{\'practiceApplication.prompt.rejectConfirm\' | translate}}</div> <br> <div layout="row"> <md-input-container flex> <label class="textInput">{{\'practiceApplication.rejectReason\' | translate}}</label> <textarea ng-model="application.rejectReason" name="rejectReason" md-maxlength="4000" max-rows="5" required></textarea> </md-input-container> </div> </div> </md-dialog-content> <md-dialog-actions layout="row" layout-align="start start"> <md-button class="md-raised md-primary" type="submit">{{\'main.yes\' | translate}}</md-button> <md-button class="md-raised" ng-click="cancel()">{{"main.no" | translate}}</md-button> </md-dialog-actions> </form> </md-dialog>'),a.put("practiceApplication/practice.application.student.html","<div class=\"ois-form-layout-padding\" ng-cloak> <fieldset> <legend md-colors=\"{color: 'primary-800'}\" class=\"md-title-small\">{{'practiceApplication.openAdmissions' | translate}}</legend> <md-table-container> <table md-table class=\"secondary-table\"> <thead md-head> <tr md-row> <th md-column>{{'practiceApplication.enterpriseName' | translate}}</th> <th md-column>{{'practiceApplication.period' | translate}}</th> <th md-column>{{'practiceApplication.places' | translate}}</th> <th md-column>{{'practiceApplication.submittedApplications' | translate}}</th> <th md-column>{{'practiceApplication.addInfo' | translate}}</th> <th md-column>{{'practiceApplication.submitDate' | translate}}</th> <th md-column>{{'practiceApplication.status' | translate}}</th> <th md-column>&nbsp;</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat=\"admission in openAdmissions\" ng-class-odd=\"'odd'\" ng-class-even=\"'even'\"> <td md-cell>{{admission.enterpriseName}}</td> <td md-cell>{{admission.validFrom | hoisDate}} - {{admission.validThru | hoisDate}}</td> <td md-cell>{{admission.places}}</td> <td md-cell>{{admission.submittedApplications}}</td> <td md-cell>{{admission.addInfo}}</td> <td md-cell>{{admission.submitDate | hoisDate}}</td> <td md-cell>{{currentLanguageNameField(admission.status)}} <md-tooltip ng-if=\"'PR_TAOTLUS_T' === admission.status.code && admission.rejectReason\">{{admission.rejectReason}}</md-tooltip> </td> <td md-cell> <span ng-if=\"canApply(admission)\"> <md-button md-no-ink class=\"md-primary change-button\" ng-click=\"apply(admission)\">{{'practiceApplication.applyFor' | translate}}</md-button> </span> <span ng-if=\"'PR_TAOTLUS_E' === admission.status.code || ('PR_TAOTLUS_A' === admission.status.code && !admission.contractId)\"> <md-button md-no-ink class=\"md-primary change-button\" ng-click=\"annul(admission)\">{{'practiceApplication.annul' | translate}}</md-button> </span> <span ng-if=\"'PR_TAOTLUS_A' === admission.status.code && admission.contractId\"> <md-button md-no-ink class=\"md-primary change-button\" ng-href=\"#/contracts/{{admission.contractId}}/view\">{{'practiceApplication.viewContract' | translate}}</md-button> </span> </td> </tr> </tbody> </table> </md-table-container> </fieldset> <br> <fieldset> <legend md-colors=\"{color: 'primary-800'}\" class=\"md-title-small\">{{'practiceApplication.passedAdmissions' | translate}}</legend> <md-table-container> <table md-table class=\"secondary-table\"> <thead md-head> <tr md-row> <th md-column>{{'practiceApplication.enterpriseName' | translate}}</th> <th md-column>{{'practiceApplication.period' | translate}}</th> <th md-column>{{'practiceApplication.places' | translate}}</th> <th md-column>{{'practiceApplication.submittedApplications' | translate}}</th> <th md-column>{{'practiceApplication.addInfo' | translate}}</th> <th md-column>{{'practiceApplication.submitDate' | translate}}</th> <th md-column>{{'practiceApplication.status' | translate}}</th> <th md-column>&nbsp;</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat=\"admission in passedAdmissions\" ng-class-odd=\"'odd'\" ng-class-even=\"'even'\"> <td md-cell>{{admission.enterpriseName}}</td> <td md-cell>{{admission.validFrom | hoisDate}} - {{admission.validThru | hoisDate}}</td> <td md-cell>{{admission.places}}</td> <td md-cell>{{admission.submittedApplications}}</td> <td md-cell>{{admission.addInfo}}</td> <td md-cell>{{admission.submitDate | hoisDate}}</td> <td md-cell>{{currentLanguageNameField(admission.status)}} <md-tooltip ng-if=\"'PR_TAOTLUS_T' === admission.status.code && admission.rejectReason\">{{admission.rejectReason}}</md-tooltip> </td> <td md-cell> <span ng-if=\"'PR_TAOTLUS_A' === admission.status.code && admission.contractId\"> <md-button md-no-ink class=\"md-primary change-button\" ng-href=\"#/contracts/{{admission.contractId}}/view\">{{'practiceApplication.viewContract' | translate}}</md-button> </span> </td> </tr> </tbody> </table> </md-table-container> </fieldset> </div>"),a.put("practiceEnterprise/practice.enterprise.admission.add.dialog.html",'<md-dialog aria-label="add enterprise dialog" flex="50" flex-md="70" flex-sm="80" flex-xs="100"> <form name="dialogForm" ng-submit="submit()" novalidate ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2 flex>{{header ? (header | translate) : (\'enterprise.admissionTab.addNew\' | translate)}}</h2> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <div class="md-dialog-content" flex> <div layout="row" class="form-readonly"> <div layout="column" flex="50"> <md-input-container flex> <label>{{\'enterprise.name\' | translate}}</label> <hois-value value="enterprise.name"></hois-value> </md-input-container> </div> <div layout="column" flex="50"> <md-input-container flex> <label>{{\'enterprise.personsTab.regCode\' | translate}}</label> <hois-value value="enterprise.regCode"></hois-value> </md-input-container> </div> </div> <div layout="row" layout-xs="column" layout-sm="column"> <div layout="row" flex="50" flex-xs="100" flex-sm="100"> <md-input-container flex> <label class="textInput">{{\'enterprise.admissionTab.startDate\' | translate}}</label> <md-datepicker name="date" ng-model="enterprise.validFrom" md-min-date="now" md-max-date="enterprise.validThru" required md-open-on-focus></md-datepicker> </md-input-container> <md-input-container flex> <label class="textInput">{{\'enterprise.admissionTab.endDate\' | translate}}</label> <md-datepicker name="date" ng-model="enterprise.validThru" md-min-date="enterprise.validFrom ? enterprise.validFrom : now" required md-open-on-focus></md-datepicker> </md-input-container> </div> <div layout="row" flex="50" flex-xs="100" flex-sm="100"> <div layout="column"> <md-input-container flex> <label class="textInput">{{\'enterprise.admissionTab.internSpots\' | translate}}</label> <input ng-model="enterprise.places" name="places" type="text" pattern="^\\d+$" md-maxlength="4" md-minlength="0"> <div ng-messages="dialogForm.places.$error"> <div ng-message="md-maxlength"> {{\'main.messages.error.maxlength\' | translate}} </div> <div ng-message="pattern"> {{\'enterprise.personsTab.number\' | translate}} </div> <div ng-message="md-minlength"> {{\'main.messages.error.minlength\' | translate}} </div> </div> </md-input-container> </div> <md-input-container flex layout="column" layout-align="center center" layout-align-xs="start center" layout-align-sm="start center"> <md-checkbox ng-model="enterprise.isStrict"> {{\'enterprise.strict\' | translate}} </md-checkbox> </md-input-container> </div> </div> <div layout="row"> <div layout="column" flex="100"> <md-input-container flex> <label class="textInput">{{\'enterprise.admissionTab.addInfo\' | translate}}</label> <textarea ng-model="enterprise.addInfo" md-maxlength="4000" max-rows="5" required md-autofocus name="info"></textarea> <div ng-messages="dialogForm.info.$error"> <div ng-message="md-maxlength"> {{\'main.messages.error.maxlength\' | translate}} </div> </div> </md-input-container> </div> </div> <div layout="row" flex="100"> <hois-autocomplete ng-if="!enterprise.allStudentGroups" label="timetable.timetableEvent.studentGroup" ng-model="enterprise.studentGroup" method="studentgroups" additional-query-params="{valid: true}" flex></hois-autocomplete> <md-button flex-offset="5" ng-click="addAllStudentGroups()" class="md-raised">{{"enterprise.admissionTab.allStudentGroups" | translate}}</md-button> </div> <md-table-container ng-if="enterprise.studentGroups.length > 0" layout="row" flex="100" style="max-height: 100px"> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column width="90%">{{\'enterprise.admissionTab.studentGroups\' | translate}}</th> <th md-column width="10%"></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="studentGroup in enterprise.studentGroups" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{studentGroup.nameEt}}</td> <td md-cell> <a ng-click="deleteStudentGroup(studentGroup)" class="remove">&times;</a> </td> </tr> </tbody> </table> </md-table-container> </div> </md-dialog-content> <md-dialog-actions layout="row" layout-xs="column" layout-align="start start" layout-align-xs="start stretch"> <md-button flex-xs="100" class="md-raised md-primary" type="submit">{{\'main.button.save\' | translate}}</md-button> <md-button ng-show="enterprise.id" flex-xs="100" class="md-raised" ng-click="delete()">{{\'main.button.delete\' | translate}}</md-button> <md-button flex-xs="100" class="md-raised" ng-click="cancel()">{{"main.button.close" | translate}}</md-button> </md-dialog-actions> </form> </md-dialog>'),a.put("practiceEnterprise/practice.enterprise.admission.edit.html",'<md-content> <md-nav-bar md-selected-nav-item="currentNavItem" nav-bar-aria-label="main selection" ng-cloak hois-navbar-overflowed> <md-nav-item ng-if="auth.isAdmin() && enterprise.id" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/edit?_noback" name="enterprise.data"> {{\'enterprise.data\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/persons/edit?_noback" name="enterprise.persons"> {{\'enterprise.persons\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/locations/edit?_noback" name="enterprise.locations"> {{\'enterprise.locations\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/studentGroups/edit?_noback" name="enterprise.studentGroups"> {{\'enterprise.studentGroups\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/contracts/edit?_noback" name="enterprise.contracts"> {{\'enterprise.contracts\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/grades/edit?_noback" name="enterprise.grades"> {{\'enterprise.grades\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId && enterprise.application" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/admission/edit?_noback" name="enterprise.admission"> {{\'enterprise.requests\' | translate}}</md-nav-item> </md-nav-bar> </md-content> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise" class="secondary-table"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="pa.valid_from, pa.valid_thru">{{\'enterprise.admissionTab.period\' | translate}}</th> <th md-column>{{\'enterprise.admissionTab.studentGroups\' | translate}}</th> <th md-column>{{\'enterprise.admissionTab.places\' | translate}}</th> <th md-column>{{\'enterprise.admissionTab.addInfo\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content track by $index" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{row.validFrom | hoisDate}} - {{row.validThru | hoisDate}}</td> <td md-cell>{{row.studentGroups ? row.studentGroups : \'-\'}}</td> <td md-cell>{{row.places ? row.places : \'-\'}}</td> <td md-cell>{{row.addInfo ? row.addInfo : \'-\'}}</td> <td md-cell> <md-button md-no-ink class="md-primary change-button" ng-click="addNewAdmission(row)">{{\'main.button.change\' | translate}}</md-button> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select> </md-table-pagination> </div> </div> <div layout="row" layout-xs="column"> <md-button ng-if="auth.isAdmin()" class="md-raised" ng-click="back(\'#/practice/enterprise\')">{{\'main.button.back\' | translate}}</md-button> <md-button ng-if="auth.isAdmin()" class="md-raised" ng-click="addNewAdmission()">{{\'enterprise.admissionTab.addNew\' | translate}}</md-button> </div>'),a.put("practiceEnterprise/practice.enterprise.admission.view.html",'<md-content> <md-nav-bar md-selected-nav-item="currentNavItem" nav-bar-aria-label="main selection" ng-cloak hois-navbar-overflowed> <md-nav-item ng-if="auth.isAdmin() && enterprise.id" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/view?_noback" name="enterprise.data"> {{\'enterprise.data\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/persons/view?_noback" name="enterprise.persons"> {{\'enterprise.persons\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/locations/view?_noback" name="enterprise.locations"> {{\'enterprise.locations\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/studentGroups/view?_noback" name="enterprise.studentGroups"> {{\'enterprise.studentGroups\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/contracts/view?_noback" name="enterprise.contracts"> {{\'enterprise.contracts\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/grades/view?_noback" name="enterprise.grades"> {{\'enterprise.grades\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId && enterprise.application" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/admission/view?_noback" name="enterprise.admission"> {{\'enterprise.requests\' | translate}}</md-nav-item> </md-nav-bar> </md-content> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise" class="secondary-table"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="pa.valid_from, pa.valid_thru">{{\'enterprise.admissionTab.period\' | translate}}</th> <th md-column>{{\'enterprise.admissionTab.studentGroups\' | translate}}</th> <th md-column>{{\'enterprise.admissionTab.places\' | translate}}</th> <th md-column>{{\'enterprise.admissionTab.addInfo\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content track by $index" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{row.validFrom | hoisDate}} - {{row.validThru | hoisDate}}</td> <td md-cell>{{row.studentGroups ? row.studentGroups : \'-\'}}</td> <td md-cell>{{row.places ? row.places : \'-\'}}</td> <td md-cell>{{row.addInfo ? row.addInfo : \'-\'}}</td> <td md-cell></td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select> </md-table-pagination> </div> </div> <div layout="row" layout-xs="column"> <md-button ng-if="auth.isAdmin() && isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_ETTEVOTE\')" class="md-raised md-primary" ng-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/admission/edit">{{\'main.button.change\' | translate}}</md-button> <md-button ng-if="auth.isAdmin()" class="md-raised" ng-click="back(\'#/practice/enterprise\')">{{\'main.button.back\' | translate}}</md-button> </div>'),a.put("practiceEnterprise/practice.enterprise.contracts.edit.html",'<md-content> <md-nav-bar md-selected-nav-item="currentNavItem" nav-bar-aria-label="main selection" ng-cloak hois-navbar-overflowed> <md-nav-item ng-if="auth.isAdmin() && enterprise.id" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/edit?_noback" name="enterprise.data"> {{\'enterprise.data\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/persons/edit?_noback" name="enterprise.persons"> {{\'enterprise.persons\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/locations/edit?_noback" name="enterprise.locations"> {{\'enterprise.locations\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/studentGroups/edit?_noback" name="enterprise.studentGroups"> {{\'enterprise.studentGroups\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/contracts/edit?_noback" name="enterprise.contracts"> {{\'enterprise.contracts\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/grades/edit?_noback" name="enterprise.grades"> {{\'enterprise.grades\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId && enterprise.application" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/admission/edit?_noback" name="enterprise.admission"> {{\'enterprise.requests\' | translate}}</md-nav-item> </md-nav-bar> </md-content> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise" class="secondary-table"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="c.contract_nr">{{\'enterprise.contractTab.contractNr\' | translate}}</th> <th md-column>{{\'enterprise.contractTab.student\' | translate}}</th> <th md-column>{{\'enterprise.contractTab.duration\' | translate}}</th> <th md-column>{{\'enterprise.contractTab.enterpriseSupervisors\' | translate}}</th> <th md-column>{{\'enterprise.contractTab.schoolSupervisors\' | translate}}</th> <th md-column>{{\'enterprise.contractTab.contractDate\' | translate}}</th> <th md-column>{{\'enterprise.contractTab.status\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell ng-if="!row.contractNr">{{\'-\'}}</td> <td md-cell ng-if="row.contractNr"><a ng-href="#/contracts/{{::row.id}}/view">{{row.contractNr}}</a></td> <td md-cell>{{currentLanguageNameField(row.student)}}</td> <td md-cell>{{row.startDate | hoisDate}} - {{row.endDate | hoisDate}}</td> <td md-cell>{{row.enterpriseContactPersonName ? row.enterpriseContactPersonName : \'-\'}}</td> <td md-cell>{{currentLanguageNameField(row.teacher)}}</td> <td md-cell>{{row.confirmDate | hoisDate}}</td> <td md-cell>{{row.status ? currentLanguageNameField(row.status) : \'-\'}}</td> <td> <md-button md-no-ink class="md-primary view-button" ng-href="#/contracts/{{::row.id}}/view">{{\'main.button.view\' | translate}}</md-button> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select> </md-table-pagination> </div> </div> <div layout="row" layout-xs="column"> <md-button ng-if="auth.isAdmin()" class="md-raised" ng-click="back(\'#/practice/enterprise\')">{{\'main.button.back\' | translate}}</md-button> </div>'),a.put("practiceEnterprise/practice.enterprise.contracts.view.html",'<md-content> <md-nav-bar md-selected-nav-item="currentNavItem" nav-bar-aria-label="main selection" ng-cloak hois-navbar-overflowed> <md-nav-item ng-if="auth.isAdmin() && enterprise.id" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/view?_noback" name="enterprise.data"> {{\'enterprise.data\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/persons/view?_noback" name="enterprise.persons"> {{\'enterprise.persons\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/locations/view?_noback" name="enterprise.locations"> {{\'enterprise.locations\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/studentGroups/view?_noback" name="enterprise.studentGroups"> {{\'enterprise.studentGroups\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/contracts/view?_noback" name="enterprise.contracts"> {{\'enterprise.contracts\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/grades/view?_noback" name="enterprise.grades"> {{\'enterprise.grades\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId && enterprise.application" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/admission/view?_noback" name="enterprise.admission"> {{\'enterprise.requests\' | translate}}</md-nav-item> </md-nav-bar> </md-content> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise" class="secondary-table"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="c.contract_nr">{{\'enterprise.contractTab.contractNr\' | translate}}</th> <th md-column>{{\'enterprise.contractTab.student\' | translate}}</th> <th md-column>{{\'enterprise.contractTab.duration\' | translate}}</th> <th md-column>{{\'enterprise.contractTab.enterpriseSupervisors\' | translate}}</th> <th md-column>{{\'enterprise.contractTab.schoolSupervisors\' | translate}}</th> <th md-column>{{\'enterprise.contractTab.contractDate\' | translate}}</th> <th md-column>{{\'enterprise.contractTab.status\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell ng-if="!row.contractNr">{{\'-\'}}</td> <td md-cell ng-if="row.contractNr"><a ng-href="#/contracts/{{::row.id}}/view">{{row.contractNr}}</a></td> <td md-cell>{{currentLanguageNameField(row.student)}}</td> <td md-cell>{{row.startDate | hoisDate}} - {{row.endDate | hoisDate}}</td> <td md-cell>{{row.enterpriseContactPersonName ? row.enterpriseContactPersonName : \'-\'}}</td> <td md-cell>{{currentLanguageNameField(row.teacher)}}</td> <td md-cell>{{row.confirmDate | hoisDate}}</td> <td md-cell>{{row.status ? currentLanguageNameField(row.status) : \'-\'}}</td> <td md-cell> <md-button md-no-ink class="md-primary view-button" ng-href="#/contracts/{{::row.id}}/view">{{\'main.button.view\' | translate}}</md-button> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select> </md-table-pagination> </div> </div> <div layout="row" layout-xs="column"> <md-button ng-if="auth.isAdmin()" class="md-raised" ng-click="back(\'#/practice/enterprise\')">{{\'main.button.back\' | translate}}</md-button> </div>'),a.put("practiceEnterprise/practice.enterprise.csv.result.dialog.html",'<md-dialog aria-label="add enterprise dialog" flex="50"> <md-toolbar> <div class="md-toolbar-tools"> <h2 flex>{{"enterprise.csv.label" | translate}}</h2> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <div class="ois-form-layout" layout="column" layout-margin ng-cloak> <p md-colors="{color: \'default-primary-800\'}" class="md-title-small">{{\'enterprise.csv.addedEnterprises\' | translate}}</p> <md-table-container> <table md-table> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column>{{\'enterprise.csv.csvFileRow\' | translate}}</th> <th md-column>{{\'enterprise.csv.name\' | translate}}</th> <th md-column>{{\'enterprise.csv.regCode\' | translate}}</th> <th md-column>{{\'enterprise.csv.note\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in enterprise.successful" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{row.rowNr ? row.rowNr : \'-\'}}</td> <td md-cell>{{row.name ? row.name : \'-\'}}</td> <td md-cell>{{row.regCode ? row.regCode : \'-\'}}</td> <td md-cell>{{row.message ? row.message : \'-\'}}</td> </tr> </tbody> </table> </md-table-container> <p md-colors="{color: \'default-primary-800\'}" class="md-title-small">{{\'enterprise.csv.failed\' | translate}}</p> <md-table-container> <table md-table> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column>{{\'enterprise.csv.csvFileRow\' | translate}}</th> <th md-column>{{\'enterprise.csv.note\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in enterprise.failed" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{row.rowNr ? row.rowNr : \'-\'}}</td> <td md-cell>{{row.message ? row.message : \'-\'}}</td> </tr> </tbody> </table> </md-table-container> </div> </md-dialog-content> <md-dialog-actions layout="row" layout-align="start start"> <md-button class="md-raised md-primary" ng-click="cancel()">{{"main.button.close" | translate}}</md-button> </md-dialog-actions> </md-dialog>'),a.put("practiceEnterprise/practice.enterprise.edit.html",'<style>.inaadressSearch {\r\n    margin-top: -5px;\r\n  } \r\n  .ui-input-search {\r\n    margin-bottom: 6px;\r\n  }</style> <md-content> <md-nav-bar md-selected-nav-item="currentNavItem" nav-bar-aria-label="main selection" ng-cloak hois-navbar-overflowed> <md-nav-item ng-if="!enterprise.id" md-nav-href="#/practice/enterprise/new?_noback" name="enterprise.data"> {{\'enterprise.data\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.id" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/edit?_noback" name="enterprise.data"> {{\'enterprise.data\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/persons/edit?_noback" name="enterprise.persons"> {{\'enterprise.persons\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/locations/edit?_noback" name="enterprise.locations"> {{\'enterprise.locations\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/studentGroups/edit?_noback" name="enterprise.studentGroups"> {{\'enterprise.studentGroups\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/contracts/edit?_noback" name="enterprise.contracts"> {{\'enterprise.contracts\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/grades/edit?_noback" name="enterprise.grades"> {{\'enterprise.grades\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId && (enterprise.application && !enterpriseForm.application.$dirty)" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/admission/edit?_noback" name="enterprise.admission"> {{\'enterprise.requests\' | translate}}</md-nav-item> </md-nav-bar> </md-content> <div class="ois-form-layout-padding ois-form-layout" layout="column" ng-cloak> <form name="enterpriseForm" role="form" class="nomargin" novalidate> <fieldset ng-if="auth.isAdmin()"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'enterprise.basicData\' | translate}}</legend> <div layout="column" flex> <div layout="row"> <md-input-container flex="50"> <label>{{\'main.country\' | translate}}</label> <hois-classifier-select ng-change="lookupRegNr()" ng-model="enterprise.country" name="country" model-value-attr="code" only-valid criteria="{higher: auth.school.higher ? true : undefined, vocational: auth.school.vocational ? true : undefined}" main-classifier-code="RIIK" ignore-preselected required ng-disabled="(enterprise.id && enterprise.country === \'RIIK_EST\') || cameFromRegister"></hois-classifier-select> </md-input-container> <md-input-container layout="row" flex="50" layout-align="center"> <md-checkbox ng-model="enterprise.person" ng-change="clearAddressAndRegCode()" ng-disabled="enterprise.id || cameFromRegister"> {{\'enterprise.fie\' | translate}} </md-checkbox> </md-input-container> </div> <div layout="row" ng-if="!enterprise.person && enterprise.country === \'RIIK_EST\'"> <md-input-container flex="50" flex-xs="100"> <label>{{\'enterprise.regCode\' | translate}}</label> <input ng-model="enterprise.regCode" ng-blur="lookupRegNr()" name="enterpriseCode" type="text" pattern="^\\d+$" minlength="8" md-maxlength="8" ng-required="enterprise.country===\'RIIK_EST\'" ng-disabled="(enterprise.id && enterprise.country === \'RIIK_EST\') || cameFromRegister"> <ng-messages for="enterpriseForm.enterpriseCode.$error" role="alert"> <ng-message when="enterpriseCodeError">{{\'enterprise.error\' | translate}}</ng-message> </ng-messages> <div ng-messages="enterpriseForm.enterpriseCode.$error"> <div ng-message="md-maxlength"> {{\'main.messages.error.maxlength\' | translate}} </div> <div ng-message="pattern"> {{\'enterprise.personsTab.number\' | translate}} </div> <div ng-message="minlength"> {{\'enterprise.minlength\' | translate}} </div> </div> </md-input-container> </div> <div layout="row" ng-if="!enterprise.person && enterprise.country !== \'RIIK_EST\'"> <md-input-container flex="50" flex-xs="100"> <label>{{\'enterprise.regCode\' | translate}}</label> <input ng-model="enterprise.regCode" name="enterpriseCode" type="text" md-maxlength="20" ng-blur="sameCountryAndCode()"> <div ng-messages="enterpriseForm.enterpriseCode.$error"> <div ng-message="md-maxlength"> {{\'main.messages.error.maxlength\' | translate}} </div> </div> </md-input-container> </div> <div layout="row"> <md-input-container flex="100" ng-if="enterprise.country === \'RIIK_EST\' && !enterprise.person && !enterpriseForm.enterpriseCode.$error.min && !enterpriseForm.enterpriseCode.$error.max && enterprise.registerAddress"> <label style="height: 26px">{{\'enterprise.address\' | translate}}</label> <hois-value value="enterprise.registerAddress"></hois-value> </md-input-container> </div> <md-input-container flex="100"> <label>{{\'enterprise.name\' | translate}}</label> <input ng-model="enterprise.name" name="enterpriseName" type="text" md-maxlength="100" required ng-disabled="(enterprise.id && enterprise.country === \'RIIK_EST\') || (cameFromRegister && !enterprise.person)"> <div ng-messages="enterpriseForm.enterpriseName.$error"> <div ng-message="md-maxlength"> {{\'main.messages.error.maxlength\' | translate}} </div> </div> </md-input-container> </div> </fieldset> <fieldset ng-if="auth.isAdmin()"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'enterprise.schoolData\' | translate}}</legend> <div layout="row"> <div flex="70" ng-if="enterprise.country === \'RIIK_EST\'"> <hois-ads-adapter flex="100" class="md-text" ng-model="enterprise.addressAds" ads-oid-model="enterprise.addressAdsOid" address-model="enterprise.address" ng-required="enterprise.countryCode === \'RIIK_EST\'"></hois-ads-adapter> </div> <md-input-container flex="70" ng-if="enterprise.country !== \'RIIK_EST\'"> <label>{{\'building.address\' | translate}}</label> <input ng-model="enterprise.address" name="address" type="text" md-maxlength="100"> <div ng-messages="enterpriseForm.address.$error"> <div ng-message="md-maxlength"> {{\'main.messages.error.maxlength\' | translate}} </div> </div> </md-input-container> <md-input-container flex="30"> <label>{{\'enterprise.postcode\' | translate}}</label> <input ng-model="enterprise.postcode" name="postcode" type="text" md-maxlength="8"> <div ng-messages="enterpriseForm.postcode.$error"> <div ng-message="md-maxlength"> {{\'main.messages.error.maxlength\' | translate}} </div> </div> </md-input-container> </div> <div layout="row" layout-xs="column"> <md-input-container flex="40" flex-xs="100"> <label>{{\'teacher.email\' | translate}}</label> <input ng-model="enterprise.email" name="email" type="email" md-maxlength="100"> <div ng-messages="enterpriseForm.email.$error"> <div ng-message="md-maxlength"> {{\'main.messages.error.maxlength\' | translate}} </div> </div> </md-input-container> <md-input-container flex="20" flex-xs="100"> <label>{{\'teacher.phone\' | translate}}</label> <input ng-model="enterprise.phone" name="phone" type="text" md-maxlength="100"> <div ng-messages="enterpriseForm.phone.$error"> <div ng-message="md-maxlength"> {{\'main.messages.error.maxlength\' | translate}} </div> </div> </md-input-container> <md-input-container flex="40" flex-xs="100"> <label>{{\'enterprise.language\' | translate}}</label> <hois-classifier-select ng-model="enterprise.language" name="language" model-value-attr="code" main-classifier-code="OPPEKEEL" ignore-preselected criteria="{higher: auth.school.higher ? true : undefined, vocational: auth.school.vocational ? true : undefined}" aria-label="{{\'enterprise.language\' | translate}}"></hois-classifier-select> <div class="invalid" ng-messages="enterpriseForm.language.$error"> <p ng-message="required">{{\'main.required\' | translate}}</p> </div> </md-input-container> </div> <div layout="row" layout-xs="column"> <md-input-container flex="25" flex-xs="100"> <label>{{\'enterprise.internSpots\' | translate}}</label> <input ng-model="enterprise.places" name="internSpots" type="text" pattern="^\\d+$" md-maxlength="4" md-minlength="0"> <div ng-messages="enterpriseForm.internSpots.$error"> <div ng-message="md-maxlength"> {{\'main.messages.error.maxlength\' | translate}} </div> <div ng-message="pattern"> {{\'enterprise.personsTab.number\' | translate}} </div> <div ng-message="md-minlength"> {{\'main.messages.error.minlength\' | translate}} </div> </div> </md-input-container> <md-input-container flex="75" flex-xs="100"> <label>{{\'enterprise.explanation\' | translate}}</label> <input ng-model="enterprise.placesDescr" name="explanation" type="text" md-maxlength="100"> <div ng-messages="enterpriseForm.explanation.$error"> <div ng-message="md-maxlength"> {{\'main.messages.error.maxlength\' | translate}} </div> </div> </md-input-container> </div> <div layout="row"> <md-input-container flex="100"> <label>{{\'main.notes\' | translate}}</label> <input ng-model="enterprise.addInfo" name="notes" type="text" md-maxlength="255"> <div ng-messages="enterpriseForm.notes.$error"> <div ng-message="md-maxlength"> {{\'main.messages.error.maxlength\' | translate}} </div> </div> </md-input-container> </div> <md-checkbox ng-model="enterprise.application" name="application"> {{\'enterprise.isApplication\' | translate}} </md-checkbox> <md-checkbox ng-model="enterprise.active" ng-checked="true"> {{\'enterprise.isActive\' | translate}} </md-checkbox> </fieldset> <div layout="row" layout-xs="column"> <md-button flex-xs="100" ng-if="auth.isAdmin()" ng-click="update()" class="md-raised md-primary">{{\'main.button.save\' | translate}}</md-button> <md-button flex-xs="100" ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId" ng-click="delete()" class="md-raised">{{\'main.button.delete\' | translate}}</md-button> <md-button flex-xs="100" ng-if="auth.isAdmin()" ng-click="goBack()" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </div> </form> </div>'),
a.put("practiceEnterprise/practice.enterprise.grades.edit.html",'<style>.popup {\r\n    position: absolute;\r\n    z-index: 1;\r\n    border: 1px solid black;\r\n    background-color:whitesmoke;\r\n}\r\n\r\n@keyframes disappear {\r\n    from {\r\n    opacity: 1;\r\n    }\r\n    to {\r\n    opacity: 0;\r\n    }\r\n}\r\n\r\n.popup.ng-leave {\r\n    animation: 1s disappear;\r\n}</style> <md-content> <md-nav-bar md-selected-nav-item="currentNavItem" nav-bar-aria-label="main selection" ng-cloak hois-navbar-overflowed> <md-nav-item ng-if="auth.isAdmin() && enterprise.id" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/edit?_noback" name="enterprise.data"> {{\'enterprise.data\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/persons/edit?_noback" name="enterprise.persons"> {{\'enterprise.persons\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/locations/edit?_noback" name="enterprise.locations"> {{\'enterprise.locations\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/studentGroups/edit?_noback" name="enterprise.studentGroups"> {{\'enterprise.studentGroups\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/contracts/edit?_noback" name="enterprise.contracts"> {{\'enterprise.contracts\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/grades/edit?_noback" name="enterprise.grades"> {{\'enterprise.grades\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId && enterprise.application" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/admission/edit?_noback" name="enterprise.admission"> {{\'enterprise.requests\' | translate}}</md-nav-item> </md-nav-bar> </md-content> <div layout-padding> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'enterprise.gradesTab.schoolGrade\' | translate}}</legend> <form name="gradeForm" ng-submit="gradeForm.$valid && loadData()" novalidate class="nomargin"> <div layout="column" flex> <div layout="row"> <div flex="50" layout="column"> <md-input-container> <label>{{\'enterprise.gradesTab.grade\' | translate}}</label> <hois-classifier-select ng-change="grade.ratingThru = undefined" ng-model="grade.ratingCode" model-value-attr="code" only-valid criteria="{higher: auth.school.higher ? true : undefined, vocational: auth.school.vocational ? true : undefined}" main-classifier-code="PR_HINNANG" filter-values="[\'PR_HINNANG_X\', \'PR_HINNANG_P\']" required ignore-preselected></hois-classifier-select> </md-input-container> </div> <div flex-offset="5"></div> <div flex="45" layout="column"> <md-input-container ng-if="grade.ratingCode === \'PR_HINNANG_A\'"> <label>{{\'enterprise.gradesTab.endDate\' | translate}}</label> <md-datepicker name="date" ng-model="grade.ratingThru" required md-open-on-focus></md-datepicker> </md-input-container> </div> </div> <div layout="row"> <div layout="column" flex> <md-input-container> <label class="textInput">{{\'enterprise.gradesTab.explanation\' | translate}}</label> <input ng-model="grade.ratingInfo" type="text" md-maxlength="100"> </md-input-container> </div> </div> <div layout="row" layout-xs="column"> <md-button ng-if="auth.isAdmin()" class="md-raised md-primary" ng-click="saveGrade()">{{\'main.button.save\' | translate}}</md-button> <md-button ng-if="auth.isAdmin()" class="md-raised" ng-click="back(\'#/practice/enterprise\')">{{\'main.button.back\' | translate}}</md-button> <md-button ng-if="auth.isAdmin() && grade.id" class="md-raised" ng-click="deleteGrade()">{{\'enterprise.gradesTab.delete\' | translate}}</md-button> </div> </div> </form> </fieldset> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise" class="secondary-table"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="s.name_et">{{\'enterprise.gradesTab.school\' | translate}}</th> <th md-column>{{\'enterprise.gradesTab.grade\' | translate}}</th> <th md-column></th> <th md-column>{{\'enterprise.gradesTab.explanation\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{currentLanguageNameField(row.schoolName)}}</td> <td ng-style="{ background: true ? getCurrentColor(row.ratingCode.code, row.ratingThru) : \'white\' }" style="position: relative; padding:3px" ng-mouseover="row.visible=true" ng-mouseleave="row.visible=false" md-cell> <div class="popup" ng-if="row.visible && row.ratingThru"> <span>{{row.ratingThru ? (row.ratingThru | hoisDate) : \'-\'}}</span> </div> <div> <span> {{currentLanguageNameField(row.ratingCode) ? currentLanguageNameField(row.ratingCode) : \'Puudub\'}} </span> </div> </td> <td md-cell></td> <td md-cell>{{row.ratingInfo ? row.ratingInfo : \'-\'}}</td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select> </md-table-pagination> </div> </div>'),a.put("practiceEnterprise/practice.enterprise.grades.view.html",'<style>.popup {\r\n    position: absolute;\r\n    z-index: 1;\r\n    border: 1px solid black;\r\n    background-color:whitesmoke;\r\n}\r\n\r\n@keyframes disappear {\r\n    from {\r\n    opacity: 1;\r\n    }\r\n    to {\r\n    opacity: 0;\r\n    }\r\n}\r\n\r\n.popup.ng-leave {\r\n    animation: 1s disappear;\r\n}</style> <md-content> <md-nav-bar md-selected-nav-item="currentNavItem" nav-bar-aria-label="main selection" ng-cloak hois-navbar-overflowed> <md-nav-item ng-if="auth.isAdmin() && enterprise.id" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/view?_noback" name="enterprise.data"> {{\'enterprise.data\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/persons/view?_noback" name="enterprise.persons"> {{\'enterprise.persons\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/locations/view?_noback" name="enterprise.locations"> {{\'enterprise.locations\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/studentGroups/view?_noback" name="enterprise.studentGroups"> {{\'enterprise.studentGroups\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/contracts/view?_noback" name="enterprise.contracts"> {{\'enterprise.contracts\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/grades/view?_noback" name="enterprise.grades"> {{\'enterprise.grades\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId && enterprise.application" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/admission/view?_noback" name="enterprise.admission"> {{\'enterprise.requests\' | translate}}</md-nav-item> </md-nav-bar> </md-content> <div layout-padding> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'enterprise.gradesTab.schoolGrade\' | translate}}</legend> <form name="gradeForm" ng-submit="gradeForm.$valid && loadData()" novalidate class="nomargin"> <div layout="column" class="form-readonly" flex> <div layout="row"> <div flex="50" layout="column"> <md-input-container> <label>{{\'enterprise.gradesTab.grade\' | translate}}</label> <hois-classifier-value ng-model="grade.ratingCode" model-value-attr="code" main-classifier-code="PR_HINNANG"></hois-classifier-value> </md-input-container> </div> <div flex-offset="5"></div> <div flex="45" layout="column"> <md-input-container ng-if="grade.ratingThru"> <label>{{\'enterprise.gradesTab.endDate\' | translate}}</label> <hois-value value="grade.ratingThru | hoisDate"></hois-value> </md-input-container> </div> </div> <div>&nbsp;</div> <div layout="row"> <div layout="column" flex> <md-input-container> <label>{{\'enterprise.gradesTab.explanation\' | translate}}</label> <hois-value value="grade.ratingInfo"></hois-value> </md-input-container> </div> </div> <div layout="row" layout-xs="column"> <md-button ng-if="auth.isAdmin() && isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_ETTEVOTE\')" class="md-raised md-primary" ng-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/grades/edit">{{\'main.button.change\' | translate}}</md-button> <md-button ng-if="auth.isAdmin()" class="md-raised" ng-click="back(\'#/practice/enterprise\')">{{\'main.button.back\' | translate}}</md-button> </div> </div> </form> </fieldset> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise" class="secondary-table"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="s.name_et">{{\'enterprise.gradesTab.school\' | translate}}</th> <th md-column>{{\'enterprise.gradesTab.grade\' | translate}}</th> <th md-column></th> <th md-column>{{\'enterprise.gradesTab.explanation\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{currentLanguageNameField(row.schoolName)}}</td> <td ng-style="{ background: true ? getCurrentColor(row.ratingCode.code, row.ratingThru) : \'white\' }" style="position: relative; padding:3px" ng-mouseover="row.visible=true" ng-mouseleave="row.visible=false" md-cell> <div class="popup" ng-if="row.visible && row.ratingThru"> <span>{{row.ratingThru ? (row.ratingThru | hoisDate) : \'-\'}}</span> </div> <div> <span> {{currentLanguageNameField(row.ratingCode) ? currentLanguageNameField(row.ratingCode) : \'Puudub\'}} </span> </div> </td> <td md-cell></td> <td md-cell>{{row.ratingInfo ? row.ratingInfo : \'-\'}}</td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select> </md-table-pagination> </div> </div>'),a.put("practiceEnterprise/practice.enterprise.import.csv.file.dialog.html",'<md-dialog aria-label="import csv dialog"> <form name="dialogForm" ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2>{{"main.button.loadCsvFile" | translate}}</h2> <span flex></span> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <span flex></span> <div class="ois-form-layout" layout="column" layout-margin ng-cloak> <div layout="column"> <md-input-container flex> <lf-ng-md-file-input name="file" lf-files="data.file" lf-browse-label="{{\'main.addFile\' | translate}}" lf-remove-label="{{\'main.button.delete\' | translate}}" lf-placeholder="" lf-mimetype="application/vnd.ms-excel|text/csv" accept=".csv" lf-required> </lf-ng-md-file-input> </md-input-container> <div ng-messages="dialogForm.file.$error"> <div class="invalid" ng-message="required">{{\'main.messages.error.selectFile\' | translate}}</div> <div class="invalid" ng-message="mimetype">{{\'main.messages.error.wrongExtension\' | translate}} .csv</div> </div> </div> </div> </md-dialog-content> <span flex></span> <md-dialog-actions layout="row" layout-align="start center"> <md-button class="md-raised md-primary" ng-click="submit()">{{"main.button.add" | translate}}</md-button> <md-button class="md-raised" ng-click="cancel()">{{"main.button.close" | translate}}</md-button> </md-dialog-actions> </form> </md-dialog>'),a.put("practiceEnterprise/practice.enterprise.list.html",'<style>.popup {\r\n  position: absolute;\r\n  z-index: 1;\r\n  border: 1px solid black;\r\n  background-color:whitesmoke;\r\n}\r\n\r\n@keyframes disappear {\r\n  from {\r\n    opacity: 1;\r\n  }\r\n  to {\r\n    opacity: 0;\r\n  }\r\n}\r\n\r\n.popup.ng-leave {\r\n  animation: 1s disappear;\r\n}</style> <div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <form name="searchForm" ng-submit="searchForm.$valid && loadData()" novalidate class="nomargin" ng-model-options="{ allowInvalid: true}"> <fieldset ng-if="auth.isAdmin()"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <div layout="column" flex> <div layout="row"> <div flex="50" flex-xs="100"> <div layout="column" flex> <md-input-container> <label class="textInput">{{\'enterprise.name\' | translate}}</label> <input ng-model="criteria.enterpriseName" type="text" md-maxlength="255"> </md-input-container> </div> </div> </div> <div layout="row"> <div flex="25" flex-xs="100"> <div layout="column" flex> <md-input-container> <label class="textInput">{{\'enterprise.regCode\' | translate}}</label> <input ng-model="criteria.enterpriseCode" type="text" md-maxlength="20"> </md-input-container> </div> </div> </div> <div layout="row"> <div flex="50" flex-xs="100"> <div layout="column" flex> <md-input-container> <label>{{\'enterprise.schoolGrade\' | translate}}</label> <hois-classifier-select ng-model="criteria.ratingCode" model-value-attr="code" main-classifier-code="PR_HINNANG"></hois-classifier-select> </md-input-container> </div> </div> </div> <md-input-container flex="45"> <md-checkbox ng-model="criteria.enterpriseActive" aria-label="required"> {{\'enterprise.isActive\' | translate}} </md-checkbox> </md-input-container> <div layout="row" layout-xs="column"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> <md-button ng-href="#/practice/enterprise/new" ng-if="isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_ETTEVOTE\')" class="md-raised">{{\'main.button.create\' | translate}}</md-button> <md-button class="md-raised" ng-if="isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_ETTEVOTE\')" ng-click="importEnterprise()">{{\'enterprise.import\' | translate}}</md-button> <a ng-href="{{csvSampleFileUrl}}" ng-if="isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_ETTEVOTE\')" class="md-button md-raised">{{\'main.button.csvSampleFile\' | translate}}</a> </div> </div> <div flex-xs="0" flex-gt-xs="0" flex-gt-sm="50"></div> </fieldset> </form> </div> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="en.name">{{\'enterprise.name\' | translate}}</th> <th md-column>{{\'enterprise.regCode\' | translate}}</th> <th md-column>{{\'main.country\' | translate}}</th> <th md-column>{{\'building.address\' | translate}}</th> <th md-column>{{\'enterprise.contactPerson\' | translate}}</th> <th md-column>{{\'enterprise.schoolGrade\' | translate}}</th> <th md-column></th> <th md-column>{{\'enterprise.isActive\' | translate}}</th> <th md-column ng-if="isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_ETTEVOTE\')"></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell><a href="#/practice/enterprise/{{::row.id}}/view">{{row.enterpriseName ? row.enterpriseName : \'-\'}}</a></td> <td md-cell>{{row.regCode ? row.regCode : \'-\'}}</td> <td md-cell>{{row.countryCode ? row.countryCode : \'-\'}}</td> <td md-cell>{{row.address ? row.address : \'-\'}}</td> <td md-cell>{{row.contactPersons ? row.contactPersons : \'-\'}}</td> <td ng-style="{ background: true ? getCurrentColor(row.ratingCode.code, row.ratingThru) : \'white\' }" style="position: relative; padding:3px" ng-mouseover="row.visible=true" ng-mouseleave="row.visible=false" md-cell> <div class="popup" ng-if="row.visible && row.ratingThru"> <span>{{row.ratingThru ? (row.ratingThru | hoisDate) : \'-\'}}</span> </div> <div flex> <span> {{currentLanguageNameField(row.ratingCode) ? currentLanguageNameField(row.ratingCode) : \'Puudub\'}} </span> </div> </td> <td md-cell></td> <td md-cell>{{row.isActive ? (\'main.yes\' | translate) : (\'main.no\' | translate)}}</td> <td ng-if="isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_ETTEVOTE\')" md-cell> <md-button md-no-ink class="md-primary change-button" ng-href="#/practice/enterprise/{{::row.id}}/edit">{{\'main.button.change\' | translate}}</md-button> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> </div>'),a.put("practiceEnterprise/practice.enterprise.location.add.dialog.html",'<md-dialog aria-label="add enterprise dialog" flex="50"> <form name="dialogForm" ng-submit="checkAddress()" novalidate ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2 flex>{{"enterprise.locationsTab.addNew" | translate}}</h2> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <div class="md-dialog-content" flex> <div layout="row" class="form-readonly"> <div layout="column" flex="50"> <md-input-container flex> <label>{{\'enterprise.name\' | translate}}</label> <hois-value value="enterprise.name"></hois-value> </md-input-container> </div> <div layout="column" flex="50"> <md-input-container flex> <label>{{\'enterprise.personsTab.regCode\' | translate}}</label> <hois-value value="enterprise.regCode"></hois-value> </md-input-container> </div> </div> <div layout="row"> <div layout="column" flex="50"> <md-input-container flex> <label class="textInput">{{\'enterprise.locationsTab.name\' | translate}}</label> <input type="text" ng-model="enterprise.nameEt" name="name" md-maxlength="255" required> <div ng-messages="dialogForm.name.$error"> <div ng-message="md-maxlength"> {{\'main.messages.error.maxlength\' | translate}} </div> </div> </md-input-container> </div> <div layout="column" flex="50"> <md-input-container flex> <label class="textInput">{{\'enterprise.locationsTab.language\' | translate}}</label> <hois-classifier-select ng-model="enterprise.language" name="language" model-value-attr="code" main-classifier-code="OPPEKEEL" required ignore-preselected only-valid criteria="{higher: auth.school.higher ? true : undefined, vocational: auth.school.vocational ? true : undefined}"></hois-classifier-select> </md-input-container> </div> </div> <div layout="row"> <div layout="column" flex="30"> <md-input-container flex> <label class="textInput">{{\'enterprise.locationsTab.country\' | translate}}</label> <hois-classifier-select ng-model="enterprise.country" name="country" model-value-attr="code" main-classifier-code="RIIK" required ignore-preselected only-valid criteria="{higher: auth.school.higher ? true : undefined, vocational: auth.school.vocational ? true : undefined}"></hois-classifier-select> </md-input-container> </div> <div flex="70" style="margin-left: 1%" ng-show="enterprise.country === \'RIIK_EST\'"> <hois-ads-adapter flex="100" ng-if="enterprise.country === \'RIIK_EST\'" class="md-text" ng-model="enterprise.addressAds" ads-oid-model="enterprise.addressOid" address-model="enterprise.address"></hois-ads-adapter> </div> <md-input-container flex="70" style="margin-left: 1%" ng-if="enterprise.country !== \'RIIK_EST\'"> <label>{{\'building.address\' | translate}}</label> <input ng-model="enterprise.address" name="address" type="text" md-maxlength="100" required> <div ng-messages="dialogForm.address.$error"> <div ng-message="md-maxlength"> {{\'main.messages.error.maxlength\' | translate}} </div> </div> </md-input-container> </div> </div> </md-dialog-content> <md-dialog-actions layout="row" layout-xs="column" layout-align="start start" layout-align-xs="none none"> <md-button flex-xs="100" class="md-raised md-primary" type="submit">{{\'main.button.save\' | translate}}</md-button> <md-button ng-show="enterprise.id" flex-xs="100" class="md-raised" ng-click="delete()">{{\'main.button.delete\' | translate}}</md-button> <md-button flex-xs="100" class="md-raised" ng-click="cancel()">{{"main.button.close" | translate}}</md-button> </md-dialog-actions> </form> </md-dialog>'),a.put("practiceEnterprise/practice.enterprise.locations.edit.html",'<md-content> <md-nav-bar md-selected-nav-item="currentNavItem" nav-bar-aria-label="main selection" ng-cloak hois-navbar-overflowed> <md-nav-item ng-if="auth.isAdmin() && enterprise.id" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/edit?_noback" name="enterprise.data"> {{\'enterprise.data\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/persons/edit?_noback" name="enterprise.persons"> {{\'enterprise.persons\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/locations/edit?_noback" name="enterprise.locations"> {{\'enterprise.locations\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/studentGroups/edit?_noback" name="enterprise.studentGroups"> {{\'enterprise.studentGroups\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/contracts/edit?_noback" name="enterprise.contracts"> {{\'enterprise.contracts\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/grades/edit?_noback" name="enterprise.grades"> {{\'enterprise.grades\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId && enterprise.application" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/admission/edit?_noback" name="enterprise.admission"> {{\'enterprise.requests\' | translate}}</md-nav-item> </md-nav-bar> </md-content> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise" class="secondary-table"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="esl.name_et">{{\'enterprise.locationsTab.name\' | translate}}</th> <th md-column>{{\'enterprise.locationsTab.language\' | translate}}</th> <th md-column>{{\'enterprise.locationsTab.country\' | translate}}</th> <th md-column>{{\'enterprise.locationsTab.address\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{row.nameEt ? row.nameEt : \'-\'}}</td> <td md-cell>{{row.language ? currentLanguageNameField(row.language) : \'-\'}}</td> <td md-cell>{{row.country ? currentLanguageNameField(row.country) : \'-\'}}</td> <td md-cell>{{row.address ? row.address : \'-\'}}</td> <td md-cell> <md-button md-no-ink class="md-primary change-button" ng-click="addNewLocation(row)">{{\'main.button.change\' | translate}}</md-button> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select> </md-table-pagination> </div> </div> <div layout="row" layout-xs="column"> <md-button ng-if="auth.isAdmin()" class="md-raised" ng-click="back(\'#/practice/enterprise\')">{{\'main.button.back\' | translate}}</md-button> <md-button ng-if="auth.isAdmin()" class="md-raised" ng-click="addNewLocation()">{{\'enterprise.locationsTab.addNew\' | translate}}</md-button> </div>'),a.put("practiceEnterprise/practice.enterprise.locations.view.html",'<md-content> <md-nav-bar md-selected-nav-item="currentNavItem" nav-bar-aria-label="main selection" ng-cloak hois-navbar-overflowed> <md-nav-item ng-if="auth.isAdmin() && enterprise.id" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/view?_noback" name="enterprise.data"> {{\'enterprise.data\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/persons/view?_noback" name="enterprise.persons"> {{\'enterprise.persons\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/locations/view?_noback" name="enterprise.locations"> {{\'enterprise.locations\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/studentGroups/view?_noback" name="enterprise.studentGroups"> {{\'enterprise.studentGroups\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/contracts/view?_noback" name="enterprise.contracts"> {{\'enterprise.contracts\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/grades/view?_noback" name="enterprise.grades"> {{\'enterprise.grades\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId && enterprise.application" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/admission/view?_noback" name="enterprise.admission"> {{\'enterprise.requests\' | translate}}</md-nav-item> </md-nav-bar> </md-content> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise" class="secondary-table"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="esl.name_et">{{\'enterprise.locationsTab.name\' | translate}}</th> <th md-column>{{\'enterprise.locationsTab.language\' | translate}}</th> <th md-column>{{\'enterprise.locationsTab.country\' | translate}}</th> <th md-column>{{\'enterprise.locationsTab.address\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{row.nameEt ? row.nameEt : \'-\'}}</td> <td md-cell>{{row.language ? currentLanguageNameField(row.language) : \'-\'}}</td> <td md-cell>{{row.country ? currentLanguageNameField(row.country) : \'-\'}}</td> <td md-cell>{{row.address ? row.address : \'-\'}}</td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select> </md-table-pagination> </div> </div> <div layout="row" layout-xs="column"> <md-button ng-if="auth.isAdmin() && isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_ETTEVOTE\')" class="md-raised md-primary" ng-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/locations/edit">{{\'main.button.change\' | translate}}</md-button> <md-button ng-if="auth.isAdmin()" class="md-raised" ng-click="back(\'#/practice/enterprise\')">{{\'main.button.back\' | translate}}</md-button> </div>'),a.put("practiceEnterprise/practice.enterprise.person.add.dialog.html",'<style>md-input-container.md-input-focused .md-input {\r\n        border-width: 0 0 2px 0 !important;\r\n    }\r\n    md-input-container .md-input.ng-invalid.ng-dirty {\r\n        border-width: 0 0 1px 0;\r\n    }</style> <md-dialog aria-label="add enterprise dialog" flex="50"> <form name="dialogForm" ng-submit="submit()" novalidate ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2 flex>{{"enterprise.personsTab.addNew" | translate}}</h2> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <div class="md-dialog-content" flex> <div layout="row" class="form-readonly"> <div layout="column" flex="50"> <md-input-container flex> <label>{{\'enterprise.name\' | translate}}</label> <hois-value value="enterprise.name"></hois-value> </md-input-container> </div> <div layout="column" flex="50"> <md-input-container flex> <label>{{\'enterprise.personsTab.regCode\' | translate}}</label> <hois-value value="enterprise.regCode"></hois-value> </md-input-container> </div> </div> <div layout="row"> <div layout="column" flex="50"> <md-input-container flex> <label class="textInput">{{\'person.firstname\' | translate}}</label> <input type="text" ng-model="enterprise.firstname" name="firstname" md-maxlength="50" required> <div ng-messages="dialogForm.firstname.$error"> <div ng-message="md-maxlength"> {{\'main.messages.error.maxlength\' | translate}} </div> </div> </md-input-container> </div> <div layout="column" flex="50"> <md-input-container flex> <label class="textInput">{{\'person.lastname\' | translate}}</label> <input type="text" ng-model="enterprise.lastname" name="lastname" md-maxlength="50" required> <div ng-messages="dialogForm.lastname.$error"> <div ng-message="md-maxlength"> {{\'main.messages.error.maxlength\' | translate}} </div> </div> </md-input-container> </div> </div> <div layout="row"> <div layout="column" flex="50"> <md-input-container flex> <label class="textInput">{{\'enterprise.personsTab.phone\' | translate}}</label> <input ng-model="enterprise.phone" name="phone" type="text" pattern="^\\d+$" md-maxlength="100" required> <div ng-messages="dialogForm.phone.$error"> <div ng-message="md-maxlength"> {{\'main.messages.error.maxlength\' | translate}} </div> <div ng-message="pattern"> {{\'enterprise.personsTab.number\' | translate}} </div> </div> </md-input-container> </div> <div layout="column" flex="50"> <md-input-container flex> <label class="textInput">{{\'enterprise.personsTab.email\' | translate}}</label> <input ng-model="enterprise.email" name="email" type="email" md-maxlength="100" ng-required="enterprise.contact"> <div ng-messages="dialogForm.email.$error"> <div ng-message="md-maxlength"> {{\'main.messages.error.maxlength\' | translate}} </div> </div> </md-input-container> </div> </div> <div layout="row"> <div layout="column" flex="50" ng-if="enterprise.country === \'RIIK_EST\'"> <md-input-container flex style="border-width: 0 0 1px 0"> <label class="textInput">{{\'enterprise.personsTab.personIdCode\' | translate}}</label> <input ng-model="enterprise.idcode" name="idcode" type="text" ng-pattern="\'^[1-6][0-9]{2}[0-1][0-9][0-3][0-9][0-9]{4}\'" minlength="11" md-maxlength="11" ng-change="checkIdCode()"> <div ng-messages="dialogForm.idcodecopy.$error"> <ng-message when="idCodeDuplicate">{{\'enterprise.personsTab.sameIdCodeAndCountry\' | translate}}</ng-message> <div ng-message="pattern"> {{\'certificate.invalidIdcode\' | translate}} </div> <div ng-message="md-maxlength"> {{\'main.messages.error.max\' | translate: {max: 11} }} </div> <div ng-message="minlength"> {{\'main.messages.error.min\' | translate: {min: 11} }} </div> </div> </md-input-container> </div> <div layout="column" flex="50" ng-if="enterprise.country !== \'RIIK_EST\'"> <md-input-container flex> <label class="textInput">{{\'enterprise.personsTab.personIdCode\' | translate}}</label> <input ng-model="enterprise.idcode" name="idcode" ng-change="checkIdCode()" type="text" md-maxlength="50"> <div ng-messages="dialogForm.idcode.$error"> <ng-message when="idCodeDuplicate">{{\'enterprise.personsTab.sameIdCodeAndCountry\' | translate}}</ng-message> <div ng-message="md-maxlength"> {{\'main.messages.error.max\' | translate: {max: 50} }} </div> </div> </md-input-container> </div> <div layout="column" flex="50"> <md-input-container flex> <label class="textInput">{{\'enterprise.personsTab.personIdCodeCountry\' | translate}}</label> <hois-classifier-select ng-blur="checkIdCode()" ng-model="enterprise.country" name="country" model-value-attr="code" main-classifier-code="RIIK" ignore-preselected only-valid criteria="{higher: auth.school.higher ? true : undefined, vocational: auth.school.vocational ? true : undefined}"> </hois-classifier-select> </md-input-container> </div> </div> <div layout="row"> <md-input-container flex> <label class="textInput">{{\'enterprise.personsTab.proffession\' | translate}}</label> <input type="text" ng-model="enterprise.position" name="proffession" md-maxlength="100"> <div ng-messages="dialogForm.proffession.$error"> <div ng-message="md-maxlength"> {{\'main.messages.error.maxlength\' | translate}} </div> </div> </md-input-container> </div> <div layout="row"> <md-checkbox ng-model="enterprise.supervisor"> {{\'enterprise.personsTab.supervisor\' | translate}} </md-checkbox> <md-checkbox ng-model="enterprise.contact"> {{\'enterprise.personsTab.contactPerson\' | translate}} </md-checkbox> </div> </div> </md-dialog-content> <md-dialog-actions layout="row" layout-align="start start"> <md-button class="md-raised md-primary" type="submit">{{\'main.button.save\' | translate}}</md-button> <md-button ng-show="enterprise.id" flex-xs="100" class="md-raised" ng-click="delete()">{{\'main.button.delete\' | translate}}</md-button> <md-button class="md-raised" ng-click="cancel()">{{"main.button.close" | translate}}</md-button> </md-dialog-actions> </form> </md-dialog>'),
a.put("practiceEnterprise/practice.enterprise.person.view.dialog.html",'<md-dialog aria-label="add enterprise dialog" flex="50"> <md-toolbar> <div class="md-toolbar-tools"> <h2 flex>{{"enterprise.personsTab.label" | translate}}</h2> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <div class="md-dialog-content form-readonly" flex> <div layout="row" class="form-readonly"> <div layout="column" flex="50"> <md-input-container flex> <label>{{\'enterprise.name\' | translate}}</label> <hois-value value="enterprise.name"></hois-value> </md-input-container> </div> <div layout="column" flex="50"> <md-input-container flex> <label>{{\'enterprise.personsTab.regCode\' | translate}}</label> <hois-value value="enterprise.regCode"></hois-value> </md-input-container> </div> </div> <div layout="row"> <div layout="column" flex="50"> <md-input-container flex> <label class="textInput">{{\'person.firstname\' | translate}}</label> <hois-value value="enterprise.firstname"></hois-value> </md-input-container> </div> <div layout="column" flex="50"> <md-input-container flex> <label class="textInput">{{\'person.lastname\' | translate}}</label> <hois-value value="enterprise.lastname"></hois-value> </md-input-container> </div> </div> <div layout="row"> <div layout="column" flex="50"> <md-input-container flex> <label class="textInput">{{\'enterprise.personsTab.phone\' | translate}}</label> <hois-value value="enterprise.phone"></hois-value> </md-input-container> </div> <div layout="column" flex="50"> <md-input-container flex> <label class="textInput">{{\'enterprise.personsTab.email\' | translate}}</label> <hois-value value="enterprise.email"></hois-value> </md-input-container> </div> </div> <div layout="row"> <div layout="column" flex="50"> <md-input-container flex> <label class="textInput">{{\'enterprise.personsTab.personIdCode\' | translate}}</label> <hois-value value="enterprise.idcode"></hois-value> </md-input-container> </div> <div layout="column" flex="50"> <md-input-container flex> <label class="textInput">{{\'enterprise.personsTab.personIdCodeCountry\' | translate}}</label> <hois-value value="currentLanguageNameField(enterprise.country)"></hois-value> </md-input-container> </div> </div> <div layout="row"> <md-input-container flex> <label class="textInput">{{\'enterprise.personsTab.proffession\' | translate}}</label> <hois-value type="text" value="enterprise.position"></hois-value> </md-input-container> </div> <div layout="row"> <md-input-container flex> <label>{{\'enterprise.personsTab.supervisor\' | translate}}</label> <hois-value value="enterprise.supervisor ? \'main.yes\' : \'main.no\' | translate"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'enterprise.personsTab.contactPerson\' | translate}}</label> <hois-value value="enterprise.contact ? \'main.yes\' : \'main.no\' | translate"></hois-value> </md-input-container> </div> </div> </md-dialog-content> <md-dialog-actions layout="row" layout-align="start start"> <md-button class="md-raised" ng-click="cancel()">{{"main.button.close" | translate}}</md-button> </md-dialog-actions> </md-dialog>'),a.put("practiceEnterprise/practice.enterprise.persons.edit.html",'<md-content> <md-nav-bar md-selected-nav-item="currentNavItem" nav-bar-aria-label="main selection" ng-cloak hois-navbar-overflowed> <md-nav-item ng-if="auth.isAdmin() && enterprise.id" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/edit?_noback" name="enterprise.data"> {{\'enterprise.data\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/persons/edit?_noback" name="enterprise.persons"> {{\'enterprise.persons\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/locations/edit?_noback" name="enterprise.locations"> {{\'enterprise.locations\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/studentGroups/edit?_noback" name="enterprise.studentGroups"> {{\'enterprise.studentGroups\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/contracts/edit?_noback" name="enterprise.contracts"> {{\'enterprise.contracts\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/grades/edit?_noback" name="enterprise.grades"> {{\'enterprise.grades\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId && enterprise.application" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/admission/edit?_noback" name="enterprise.admission"> {{\'enterprise.requests\' | translate}}</md-nav-item> </md-nav-bar> </md-content> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise" class="secondary-table"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="esp.firstname, esp.lastname">{{\'enterprise.personsTab.name\' | translate}}</th> <th md-column>{{\'enterprise.personsTab.phone\' | translate}}</th> <th md-column>{{\'enterprise.personsTab.email\' | translate}}</th> <th md-column>{{\'enterprise.personsTab.personIdCode\' | translate}}</th> <th md-column>{{\'enterprise.personsTab.personIdCodeCountry\' | translate}}</th> <th md-column>{{\'enterprise.personsTab.proffession\' | translate}}</th> <th md-column>{{\'enterprise.personsTab.mentor\' | translate}}</th> <th md-column>{{\'enterprise.personsTab.contactPerson\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell><a ng-click="viewPerson(row)">{{row.firstname + \' \' + row.lastname}}</a></td> <td md-cell>{{row.phone ? row.phone : \'-\'}}</td> <td md-cell>{{row.email ? row.email : \'-\'}}</td> <td md-cell>{{row.idcode ? row.idcode : \'-\'}}</td> <td md-cell>{{row.country ? currentLanguageNameField(row.country) : \'-\'}}</td> <td md-cell>{{row.position ? row.position : \'-\'}}</td> <td md-cell>{{row.supervisor ? (\'main.yes\' | translate) : (\'main.no\' | translate)}}</td> <td md-cell>{{row.contact ? (\'main.yes\' | translate) : (\'main.no\' | translate)}}</td> <td md-cell> <md-button md-no-ink class="md-primary change-button" ng-click="addNewPerson(row)">{{\'main.button.change\' | translate}}</md-button> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select> </md-table-pagination> </div> </div> <div layout="row" layout-xs="column"> <md-button ng-if="auth.isAdmin()" class="md-raised" ng-click="back(\'#/practice/enterprise\')">{{\'main.button.back\' | translate}}</md-button> <md-button ng-if="auth.isAdmin()" class="md-raised" ng-click="addNewPerson()">{{\'enterprise.personsTab.addNew\' | translate}}</md-button> </div>'),a.put("practiceEnterprise/practice.enterprise.persons.view.html",'<md-content> <md-nav-bar md-selected-nav-item="currentNavItem" nav-bar-aria-label="main selection" ng-cloak hois-navbar-overflowed> <md-nav-item ng-if="auth.isAdmin() && enterprise.id" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/view?_noback" name="enterprise.data"> {{\'enterprise.data\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/persons/view?_noback" name="enterprise.persons"> {{\'enterprise.persons\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/locations/view?_noback" name="enterprise.locations"> {{\'enterprise.locations\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/studentGroups/view?_noback" name="enterprise.studentGroups"> {{\'enterprise.studentGroups\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/contracts/view?_noback" name="enterprise.contracts"> {{\'enterprise.contracts\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/grades/view?_noback" name="enterprise.grades"> {{\'enterprise.grades\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId && enterprise.application" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/admission/view?_noback" name="enterprise.admission"> {{\'enterprise.requests\' | translate}}</md-nav-item> </md-nav-bar> </md-content> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise" class="secondary-table"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="esp.firstname, esp.lastname">{{\'enterprise.personsTab.name\' | translate}}</th> <th md-column>{{\'enterprise.personsTab.phone\' | translate}}</th> <th md-column>{{\'enterprise.personsTab.email\' | translate}}</th> <th md-column>{{\'enterprise.personsTab.personIdCode\' | translate}}</th> <th md-column>{{\'enterprise.personsTab.personIdCodeCountry\' | translate}}</th> <th md-column>{{\'enterprise.personsTab.proffession\' | translate}}</th> <th md-column>{{\'enterprise.personsTab.mentor\' | translate}}</th> <th md-column>{{\'enterprise.personsTab.contactPerson\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell><a ng-click="viewPerson(row)">{{row.firstname + \' \' + row.lastname}}</a></td> <td md-cell>{{row.phone ? row.phone : \'-\'}}</td> <td md-cell>{{row.email ? row.email : \'-\'}}</td> <td md-cell>{{row.idcode ? row.idcode : \'-\'}}</td> <td md-cell>{{row.country ? currentLanguageNameField(row.country) : \'-\'}}</td> <td md-cell>{{row.position ? row.position : \'-\'}}</td> <td md-cell>{{row.supervisor ? (\'main.yes\' | translate) : (\'main.no\' | translate)}}</td> <td md-cell>{{row.contact ? (\'main.yes\' | translate) : (\'main.no\' | translate)}}</td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select> </md-table-pagination> </div> </div> <div layout="row" layout-xs="column"> <md-button ng-if="auth.isAdmin() && isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_ETTEVOTE\')" class="md-raised md-primary" ng-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/persons/edit">{{\'main.button.change\' | translate}}</md-button> <md-button ng-if="auth.isAdmin()" class="md-raised" ng-click="back(\'#/practice/enterprise\')">{{\'main.button.back\' | translate}}</md-button> </div>'),a.put("practiceEnterprise/practice.enterprise.studentGroups.add.dialog.html",'<md-dialog aria-label="add enterprise dialog" flex="50"> <form name="dialogForm" ng-submit="submit()" novalidate ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2 flex>{{"enterprise.iscedTab.addNew" | translate}}</h2> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <div class="md-dialog-content" flex> <div layout="row" class="form-readonly"> <div layout="column" flex="50"> <md-input-container flex> <label>{{\'enterprise.name\' | translate}}</label> <hois-value value="enterprise.name"></hois-value> </md-input-container> </div> <div layout="column" flex="50"> <md-input-container flex> <label>{{\'enterprise.iscedTab.regCode\' | translate}}</label> <hois-value value="enterprise.regCode"></hois-value> </md-input-container> </div> </div> <div layout="row"> <div layout="column" flex="65"> <md-input-container flex> <label class="textInput">{{\'enterprise.iscedTab.iscedClass\' | translate}}</label> <hois-classifier-select ng-model="enterprise.iscedClass" required model-value-attr="code" main-classifier-code="ISCED_RYHM"></hois-classifier-select> </md-input-container> </div> <div layout="column" flex="30" flex-offset="5"> <md-input-container flex> <label>{{\'enterprise.iscedTab.places\' | translate}}</label> <input ng-model="enterprise.places" name="internSpots" type="text" pattern="^\\d+$" md-maxlength="4" md-minlength="0" required> <div ng-messages="dialogForm.internSpots.$error"> <div ng-message="md-maxlength"> {{\'main.messages.error.maxlength\' | translate}} </div> <div ng-message="pattern"> {{\'enterprise.personsTab.number\' | translate}} </div> <div ng-message="md-minlength"> {{\'main.messages.error.minlength\' | translate}} </div> </div> </md-input-container> </div> </div> <div layout="row"> <div layout="column" flex="100"> <md-input-container flex> <label class="textInput">{{\'enterprise.iscedTab.addInfo\' | translate}}</label> <input name="info" ng-model="enterprise.addInfo" md-maxlength="255"> <div ng-messages="dialogForm.info.$error"> <div ng-message="md-maxlength"> {{\'main.messages.error.maxlength\' | translate}} </div> </div> </md-input-container> </div> </div> </div> </md-dialog-content> <md-dialog-actions layout="row" layout-xs="column" layout-align="start start" layout-align-xs="none none"> <md-button flex-xs="100" class="md-raised md-primary" type="submit">{{\'main.button.save\' | translate}}</md-button> <md-button ng-show="enterprise.id" flex-xs="100" class="md-raised" ng-click="delete()">{{\'main.button.delete\' | translate}}</md-button> <md-button flex-xs="100" class="md-raised" ng-click="cancel()">{{"main.button.close" | translate}}</md-button> </md-dialog-actions> </form> </md-dialog>'),a.put("practiceEnterprise/practice.enterprise.studentGroups.edit.html",'<md-content> <md-nav-bar md-selected-nav-item="currentNavItem" nav-bar-aria-label="main selection" ng-cloak hois-navbar-overflowed> <md-nav-item ng-if="auth.isAdmin() && enterprise.id" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/edit?_noback" name="enterprise.data"> {{\'enterprise.data\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/persons/edit?_noback" name="enterprise.persons"> {{\'enterprise.persons\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/locations/edit?_noback" name="enterprise.locations"> {{\'enterprise.locations\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/studentGroups/edit?_noback" name="enterprise.studentGroups"> {{\'enterprise.studentGroups\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/contracts/edit?_noback" name="enterprise.contracts"> {{\'enterprise.contracts\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/grades/edit?_noback" name="enterprise.grades"> {{\'enterprise.grades\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId && enterprise.application" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/admission/edit?_noback" name="enterprise.admission"> {{\'enterprise.requests\' | translate}}</md-nav-item> </md-nav-bar> </md-content> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise" class="secondary-table"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="esic.isced_class_code">{{\'enterprise.iscedTab.iscedClass\' | translate}}</th> <th md-column>{{\'enterprise.iscedTab.places\' | translate}}</th> <th md-column>{{\'enterprise.iscedTab.addInfo\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{row.iscedClass ? currentLanguageNameField(row.iscedClass) : \'-\'}}{{row.iscedValue ? \'(\' + row.iscedValue + \')\' : \'\'}} <span ng-if="!row.exists"> <md-icon md-colors="{color: \'default-warn\'}" md-font-set="material-icons">warning</md-icon> <span md-colors="{color: \'default-warn\'}">{{\'enterprise.iscedTab.warning\' | translate}}</span> </span> </td> <td md-cell>{{row.places ? row.places : \'-\'}}</td> <td md-cell>{{row.addInfo ? row.addInfo : \'-\'}}</td> <td md-cell> <md-button md-no-ink class="md-primary change-button" ng-click="addNewStudentGroup(row)">{{\'main.button.change\' | translate}}</md-button> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select> </md-table-pagination> </div> </div> <div layout="row" layout-xs="column"> <md-button ng-if="auth.isAdmin()" class="md-raised" ng-click="back(\'#/practice/enterprise\')">{{\'main.button.back\' | translate}}</md-button> <md-button ng-if="auth.isAdmin()" class="md-raised" ng-click="addNewStudentGroup()">{{\'enterprise.iscedTab.addNew\' | translate}}</md-button> </div>'),a.put("practiceEnterprise/practice.enterprise.studentGroups.view.html",'<md-content> <md-nav-bar md-selected-nav-item="currentNavItem" nav-bar-aria-label="main selection" ng-cloak hois-navbar-overflowed> <md-nav-item ng-if="auth.isAdmin() && enterprise.id" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/view?_noback" name="enterprise.data"> {{\'enterprise.data\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/persons/view?_noback" name="enterprise.persons"> {{\'enterprise.persons\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/locations/view?_noback" name="enterprise.locations"> {{\'enterprise.locations\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/studentGroups/view?_noback" name="enterprise.studentGroups"> {{\'enterprise.studentGroups\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/contracts/view?_noback" name="enterprise.contracts"> {{\'enterprise.contracts\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/grades/view?_noback" name="enterprise.grades"> {{\'enterprise.grades\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId && enterprise.application" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/admission/view?_noback" name="enterprise.admission"> {{\'enterprise.requests\' | translate}}</md-nav-item> </md-nav-bar> </md-content> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise" class="secondary-table"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="esic.isced_class_code">{{\'enterprise.iscedTab.iscedClass\' | translate}}</th> <th md-column>{{\'enterprise.iscedTab.places\' | translate}}</th> <th md-column>{{\'enterprise.iscedTab.addInfo\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{row.iscedClass ? currentLanguageNameField(row.iscedClass) : \'-\'}}{{row.iscedValue ? \'(\' + row.iscedValue + \')\' : \'\'}} <span ng-if="!row.exists"> <md-icon md-colors="{color: \'default-warn\'}" md-font-set="material-icons">warning</md-icon> <span md-colors="{color: \'default-warn\'}">{{\'enterprise.iscedTab.warning\' | translate}}</span> </span> </td> <td md-cell>{{row.places ? row.places : \'-\'}}</td> <td md-cell>{{row.addInfo ? row.addInfo : \'-\'}}</td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select> </md-table-pagination> </div> </div> <div layout="row" layout-xs="column"> <md-button ng-if="auth.isAdmin() && isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_ETTEVOTE\')" class="md-raised md-primary" ng-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/studentGroups/edit">{{\'main.button.change\' | translate}}</md-button> <md-button ng-if="auth.isAdmin()" class="md-raised" ng-click="back(\'#/practice/enterprise\')">{{\'main.button.back\' | translate}}</md-button> </div>'),a.put("practiceEnterprise/practice.enterprise.view.html",'<md-content> <md-nav-bar md-selected-nav-item="currentNavItem" nav-bar-aria-label="main selection" ng-cloak hois-navbar-overflowed> <md-nav-item ng-if="auth.isAdmin() && enterprise.id" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/view?_noback" name="enterprise.data"> {{\'enterprise.data\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/persons/view?_noback" name="enterprise.persons"> {{\'enterprise.persons\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/locations/view?_noback" name="enterprise.locations"> {{\'enterprise.locations\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/studentGroups/view?_noback" name="enterprise.studentGroups"> {{\'enterprise.studentGroups\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/contracts/view?_noback" name="enterprise.contracts"> {{\'enterprise.contracts\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/grades/view?_noback" name="enterprise.grades"> {{\'enterprise.grades\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && enterprise.enterpriseSchoolId && enterprise.application" md-nav-href="#/practice/enterprise/{{::enterprise.id}}/{{::enterprise.enterpriseSchoolId}}/admission/view?_noback" name="enterprise.admission"> {{\'enterprise.requests\' | translate}}</md-nav-item> </md-nav-bar> </md-content> <div class="ois-form-layout-padding ois-form-layout" layout="column" ng-cloak> <fieldset ng-if="auth.isAdmin()"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'enterprise.basicData\' | translate}}</legend> <div class="ois-form-layout-padding form-readonly" layout="column" flex> <div layout="row"> <md-input-container flex="50"> <label>{{\'main.country\' | translate}}</label> <hois-classifier-value ng-model="enterprise.country" main-classifier-code="RIIK"></hois-classifier-value> </md-input-container> <div flex="50" layout="column"> <md-input-container flex> <label>{{\'enterprise.fie\' | translate}}</label> <hois-value value="enterprise.person ? \'main.yes\' : \'main.no\' | translate"></hois-value> </md-input-container> </div> </div> <div layout="row" ng-show="!enterprise.person"> <md-input-container flex="50" flex-xs="100"> <label>{{\'enterprise.regCode\' | translate}}</label> <hois-value value="enterprise.regCode"></hois-value> </md-input-container> </div> <div layout="row"> <md-input-container flex="100" ng-if="enterprise.country === \'RIIK_EST\' && !enterprise.person"> <label>{{\'enterprise.address\' | translate}}</label> <hois-value value="enterprise.addressRegister"></hois-value> </md-input-container> </div> <md-input-container flex="100"> <label>{{\'enterprise.name\' | translate}}</label> <hois-value value="enterprise.name"></hois-value> </md-input-container> </div> </fieldset> <fieldset ng-if="auth.isAdmin()"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'enterprise.schoolData\' | translate}}</legend> <div class="ois-form-layout-padding form-readonly" style="padding-top: 1em"> <div layout="row"> <md-input-container ng-show="enterprise.countryCode === \'RIIK_EST\'" flex="70"> <label>{{\'building.address\' | translate}}</label> <hois-value value="enterprise.addressAds"></hois-value> </md-input-container> <md-input-container ng-show="enterprise.countryCode !== \'RIIK_EST\'" flex="70"> <label>{{\'building.address\' | translate}}</label> <hois-value value="enterprise.address"></hois-value> </md-input-container> <md-input-container flex="30"> <label>{{\'enterprise.postcode\' | translate}}</label> <hois-value value="enterprise.postcode"></hois-value> </md-input-container> </div> <div layout="row" layout-xs="column"> <md-input-container flex="40" flex-xs="100"> <label>{{\'teacher.email\' | translate}}</label> <hois-value value="enterprise.email"></hois-value> </md-input-container> <md-input-container flex="20" flex-xs="100"> <label>{{\'teacher.phone\' | translate}}</label> <hois-value value="enterprise.phone"></hois-value> </md-input-container> <md-input-container flex="40" flex-xs="100"> <label>{{\'enterprise.language\' | translate}}</label> <hois-classifier-value ng-model="enterprise.language" name="language" model-value-attr="code" main-classifier-code="OPPEKEEL" aria-label="{{\'enterprise.language\' | translate}}"></hois-classifier-value> </md-input-container> </div> <div layout="row" layout-xs="column"> <md-input-container flex="25" flex-xs="100"> <label>{{\'enterprise.internSpots\' | translate}}</label> <hois-value value="enterprise.places"></hois-value> </md-input-container> <md-input-container flex="75" flex-xs="100"> <label>{{\'enterprise.explanation\' | translate}}</label> <hois-value value="enterprise.placesDescr"></hois-value> </md-input-container> </div> <div layout="row"> <md-input-container flex="100"> <label>{{\'main.notes\' | translate}}</label> <hois-value value="enterprise.addInfo"></hois-value> </md-input-container> </div> <div layout="row" flex="100"> <div flex="50" layout="column"> <md-input-container flex> <label>{{\'enterprise.isActive\' | translate}}</label> <hois-value value="enterprise.active !== null ? (enterprise.active ? \'main.yes\' : \'main.no\') : \'\' | translate"></hois-value> </md-input-container> </div> <div flex="50" layout="column"> <md-input-container flex> <label>{{\'enterprise.isApplication\' | translate}}</label> <hois-value value="enterprise.application !== null ? (enterprise.application ? \'main.yes\' : \'main.no\') : \'\' | translate"></hois-value> </md-input-container> </div> </div> </div> </fieldset> <div layout="row" layout-xs="column"> <md-button ng-if="auth.isAdmin() && isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_ETTEVOTE\')" class="md-raised md-primary" ng-href="#/practice/enterprise/{{::enterprise.id}}/edit">{{\'main.button.change\' | translate}}</md-button> <md-button ng-if="auth.isAdmin()" ng-click="back(\'#/practice/enterprise\')" class="md-raised">{{\'main.button.back\' | translate}}</md-button> <md-button ng-if="auth.isAdmin() && enterprise.country === \'RIIK_EST\' && !enterprise.person && isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_ETTEVOTE\')" ng-click="update()" class="md-raised">{{\'enterprise.updateFromRegister\' | translate}}</md-button> <div layout="row" layout-align="center center" ng-show="enterprise.ebusinessUpdated"><span>{{\'enterprise.lastEnterpriseUpdate\' | translate}} {{enterprise.ebusinessUpdated | hoisTimestamp}}</span></div> </div> </div>'),a.put("practiceEvaluation/practice.evaluation.edit.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <form name="practiceEvaluationForm"> <md-input-container class="md-block"> <label class="textInput">{{\'practiceEvaluation.nameEt\' | translate}}</label> <input ng-model="record.nameEt" name="nameEt" type="text" md-maxlength="255" required> </md-input-container> <md-input-container class="md-block"> <label class="textInput">{{\'practiceEvaluation.target\' | translate}}</label> <hois-classifier-select ng-model="record.target" name="target" model-value-attr="code" main-classifier-code="PRAKTIKA_SIHTRYHM" only-valid ignore-preselected criteria="{higher: auth.school.higher ? true : undefined, vocational: auth.school.vocational ? true : undefined}" required></hois-classifier-select> </md-input-container> <md-input-container class="md-block"> <label class="textInput">{{\'practiceEvaluation.addInfo\' | translate}}</label> <textarea ng-model="record.addInfo" name="addInfo" md-maxlength="400" max-rows="10"></textarea> </md-input-container> <md-input-container class="md-block"> <md-checkbox ng-model="record.isActive" name="isActive">{{\'practiceEvaluation.isActive\' | translate}}</md-checkbox> </md-input-container> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'practiceEvaluation.criteria.label\' | translate}} *</legend> <input style="display:none" type="number" readonly name="criteriaLength" ng-model="record.criteria.length" min="1"> <div class="invalid" ng-if="practiceEvaluationForm.$submitted" ng-messages="practiceEvaluationForm.criteriaLength.$error"> <div ng-message="min">{{\'main.messages.error.atLeastOneShouldBeAdded\' | translate}}</div> </div> <div layout="row" flex> <md-input-container flex="30"> <label>{{\'practiceEvaluation.criteria.nameEt\' | translate}} *</label> <input ng-model="criteria.nameEt" name="nameEt" type="text" md-maxlength="100"> </md-input-container> <md-input-container flex="30" flex-offset="5"> <label>{{\'practiceEvaluation.criteria.addInfo\' | translate}}</label> <input ng-model="criteria.addInfo" name="addInfo" type="text" md-maxlength="255"> </md-input-container> <md-input-container flex="30" flex-offset="5"> <label>{{\'practiceEvaluation.criteria.type\' | translate}} *</label> <hois-classifier-select ng-model="criteria.type" name="type" model-value-attr="code" main-classifier-code="PRAKTIKA_KRITEERIUM" only-valid ignore-preselected criteria="{higher: auth.school.higher ? true : undefined, vocational: auth.school.vocational ? true : undefined}" ng-disabled="criteria.disabled"></hois-classifier-select> </md-input-container> <md-button class="md-primary" ng-click="addCriteria()" ng-if="!isEditingCriteria">{{\'main.button.add\' | translate}}</md-button> <md-button class="md-primary" ng-click="saveCriteria()" ng-if="isEditingCriteria">{{\'main.button.change\' | translate}}</md-button> </div> <div layout="column"> <div ng-repeat="item in record.criteria track by $index" class="occupation-row align-center" layout="row" flex> <div flex="30"> <a ng-click="editCriteria(item)"> <p class="scrollable">{{item.nameEt}}</p> </a> </div> <div flex="30" flex-offset="5"> <a ng-click="editCriteria(item)"> <p class="scrollable">{{item.addInfo}}</p> </a> </div> <div flex="30" flex-offset="5"> <a ng-click="editCriteria(item)"> <p class="scrollable">{{currentLanguageNameField(criteriaMap[item.type])}}</p> </a> </div> <div layout="row" layout-align="center center"> <div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div> <div> <a class="remove" ng-click="removeCriteria(record.criteria, item)" ng-if="!item.disabled">&times;&nbsp;&nbsp;</a> <div ng-if="item.disabled">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div> </div> <div> <p ng-if="$first" class="link-disabled">&#9650;&nbsp;</p> <a ng-if="!$first" class="link-no-underline" ng-click="swapCriteria($index, $index - 1)">&#9650;&nbsp;</a> </div> <div> <p ng-if="$last" class="link-disabled">&#9660;&nbsp;</p> <a ng-if="!$last" class="link-no-underline" ng-click="swapCriteria($index, $index + 1)">&#9660;&nbsp;</a> </div> </div> </div> </div> </fieldset> </form> <br> <md-button ng-click="update()" class="md-raised md-primary">{{\'main.button.save\' | translate}}</md-button> <md-button ng-click="delete()" ng-if="record.id && record.canDelete" class="md-raised">{{\'main.button.delete\' | translate}}</md-button> <md-button ng-click="back(\'#/practice/evaluation\', practiceEvaluationForm)" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </div> <style>.link-no-underline {\r\n    text-decoration: none;\r\n  }\r\n  .link-disabled {\r\n    color: #d7dde5;\r\n  }</style>'),
a.put("practiceEvaluation/practice.evaluation.list.html",'<div layout-padding> <div flex> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <form ng-submit="loadData()" novalidate ng-model-options="{allowInvalid: true}"> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'practiceEvaluation.nameEt\' | translate}}</label> <input ng-model="criteria.nameEt" name="nameEt" type="text" md-maxlength="255"> </md-input-container> <md-input-container flex="45" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'practiceEvaluation.target\' | translate}}</label> <hois-classifier-select ng-model="criteria.target" name="target" model-value-attr="code" main-classifier-code="PRAKTIKA_SIHTRYHM"></hois-classifier-select> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <md-checkbox ng-model="criteria.isActive">{{\'practiceEvaluation.isActive\' | translate}}</md-checkbox> </md-input-container> </div> <div layout="row" layout-xs="column"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> <md-button class="md-raised" ng-if="isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_PRHINDAMISVORM\')" href="#/practice/evaluation/new">{{\'main.button.create\' | translate}}</md-button> </div> </form> </fieldset> </div> </div> <div layout-padding> <div flex> <md-table-container> <table md-table> <thead md-head> <tr md-row> <th md-column>{{\'practiceEvaluation.nameEt\' | translate}}</th> <th md-column>{{\'practiceEvaluation.addInfo\' | translate}}</th> <th md-column>{{\'practiceEvaluation.target\' | translate}}</th> <th md-column>{{\'practiceEvaluation.isActive\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell> <a md-no-ink class="md-primary" ng-href="#/practice/evaluation/{{::row.id}}/view">{{::row.nameEt}}</a> </td> <td md-cell>{{::row.addInfo}}</td> <td md-cell>{{currentLanguageNameField(row.target)}}</td> <td md-cell>{{row.isActive ? \'main.yes\' : \'main.no\' | translate}}</td> <td md-cell> <md-button md-no-ink class="md-primary change-button" ng-if="isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_PRHINDAMISVORM\')" ng-href="#/practice/evaluation/{{::row.id}}/edit">{{\'main.button.change\' | translate}}</md-button> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\' }" md-page-select></md-table-pagination> </div> </div>'),a.put("practiceEvaluation/practice.evaluation.view.html",'<div class="ois-form-layout-padding ois-form-layout form-readonly" ng-cloak> <form name="practiceEvaluationForm"> <md-input-container class="md-block"> <label class="textInput">{{\'practiceEvaluation.nameEt\' | translate}}</label> <hois-value value="record.nameEt"></hois-value> </md-input-container> <md-input-container class="md-block"> <label class="textInput">{{\'practiceEvaluation.target\' | translate}}</label> <hois-classifier-value ng-model="record.target" main-classifier-code="PRAKTIKA_SIHTRYHM"></hois-classifier-value> </md-input-container> <md-input-container class="md-block"> <label class="textInput">{{\'practiceEvaluation.addInfo\' | translate}}</label> <hois-value value="record.addInfo"></hois-value> </md-input-container> <md-input-container class="md-block"> <label class="textInput">{{\'practiceEvaluation.isActive\' | translate}}</label> <hois-value value="record.isActive ? \'main.yes\' : \'main.no\' | translate"></hois-value> </md-input-container> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'practiceEvaluation.criteria.label\' | translate}}</legend> <md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'practiceEvaluation.criteria.nameEt\' | translate}}</th> <th md-column>{{\'practiceEvaluation.criteria.addInfo\' | translate}}</th> <th md-column>{{\'practiceEvaluation.criteria.type\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in record.criteria" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{::row.nameEt}}</td> <td md-cell>{{::row.addInfo}}</td> <td md-cell>{{currentLanguageNameField(criteriaMap[row.type])}}</td> </tr> </tbody> </table> </md-table-container> </fieldset> </form> <br> <md-button ng-if="isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_PRHINDAMISVORM\')" ng-href="#/practice/evaluation/{{record.id}}/edit" class="md-raised md-primary">{{\'main.button.change\' | translate}}</md-button> <md-button ng-href="#/practice/evaluation" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </div>'),a.put("practiceJournal/practice.journal.edit.html",'<div class="ois-form-layout-padding" ng-cloak> <div flex> <form name="practiceJournalForm" ng-submit="save()" novalidate layout="column"> <div flex> <hois-autocomplete ng-model="practiceJournal.student" method="students" name="student" label="student.label" additional-query-params="{active: true, higher: formState.isHigher, showStudentGroup: true}" required ng-disabled="practiceJournal.id"></hois-autocomplete> </div> <div ng-if="practiceJournal.student && formState.student" class="form-readonly" layout="column"> <div>&nbsp;</div> <div layout="row" layout-xs="column" flex> <md-input-container flex> <label>{{\'student.name\' | translate}}</label> <hois-value value="formState.student.person.firstname + \' \' + formState.student.person.lastname"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'student.idcode\' | translate}}</label> <hois-value value="formState.student.person.idcode"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'student.schoolEmail\' | translate}}</label> <hois-value value="formState.student.schoolEmail"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'student.course\' | translate}}</label> <hois-value value="formState.student.course"></hois-value> </md-input-container> </div> <div layout="row" layout-xs="column" flex> <md-input-container flex> <label>{{\'student.curriculum\' | translate}}</label> <hois-value value="currentLanguageNameField(formState.student.curriculumVersion)"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'student.studyForm\' | translate}}</label> <hois-value value="currentLanguageNameField(formState.student.studyForm)"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'practiceJournal.status\' | translate}}</label> <hois-classifier-value ng-model="practiceJournal.status" main-classifier-code="PAEVIK_STAATUS"></hois-classifier-value> </md-input-container> </div> </div> <div ng-if="!formState.isHigher" ng-repeat="module in practiceJournal.moduleSubjects track by $index" layout="row" layout-sm="column" layout-xs="column" flex="50"> <md-input-container flex> <label class="textInput">{{\'module.practice\' | translate}}</label> <hois-select ng-model="module.module" values="formState.modules" ng-change="moduleChanged(module.module, module)" required ng-disabled="practiceJournal.contract"></hois-select> </md-input-container> <md-input-container flex flex-offset-gt-md="5"> <label class="textInput">{{\'practiceJournal.theme\' | translate}}</label> <hois-select ng-model="module.theme" values="formState.themesByModuleId[module.module]" ng-change="themeChanged(module.theme, module)" ng-disabled="practiceJournal.contract"></hois-select> </md-input-container> <md-input-container flex="10" flex-sm="100" flex-xs="100" flex-offset-gt-md="5"> <label class="textInput">{{\'practiceJournal.creditsEKAP\' | translate}}</label> <input type="number" name="credits[{{$index}}]" ng-model="module.credits" min="0" max="999.9" ng-change="updateHours(module, $index)" ng-disabled="practiceJournal.contract" required> </md-input-container> <md-input-container flex="10" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'practiceJournal.acadHours\' | translate}}</label> <input type="number" name="hours[{{$index}}]" ng-model="module.hours" min="0" max="32767" pattern="^\\d+$" ng-change="updateCredits(module, $index)" ng-disabled="practiceJournal.contract" required> <div ng-messages="practiceJournalForm[\'hours[\'+$index+\']\'].$error" ng-show="practiceJournalForm[\'hours[\'+$index+\']\'].$dirty"> <div ng-message="pattern"> {{\'main.messages.error.integer\' | translate}} </div> </div> </md-input-container> <md-input-container flex="{{practiceJournal.contract ? \'20\' : \'10\'}}" flex-sm="100" flex-xs="100"> <label>{{\'practiceJournal.astroHours\' | translate}}</label> <br> <hois-value value="getAstronomicalHours(module.hours)"></hois-value> </md-input-container> <div flex="10" flex-sm="100" flex-xs="100" class="center" ng-if="!practiceJournal.contract"> <a class="remove" ng-click="removeModuleSubject(module)">&times;&nbsp;&nbsp;</a> </div> </div> <div ng-if="!formState.isHigher && !practiceJournal.contract" layout="row" layout-sm="column" layout-xs="column" flex> <md-button class="md-raised" ng-click="addModuleSubject()">{{\'practiceJournal.button.addModule\' | translate}}</md-button> </div> <div ng-if="formState.isHigher" ng-repeat="subject in practiceJournal.moduleSubjects track by $index" layout="row" layout-sm="column" layout-xs="column" flex="50"> <md-input-container flex> <label class="textInput">{{\'practiceJournal.subject\' | translate}}</label> <hois-select ng-model="subject.subject" values="formState.subjects" ng-change="subjectChanged(subject.subject, subject)" required ng-disabled="practiceJournal.contract"></hois-select> </md-input-container> <md-input-container flex="10" flex-sm="100" flex-xs="100" flex-offset-gt-md="5"> <label class="textInput">{{\'practiceJournal.creditsEAP\' | translate}}</label> <input type="number" name="credits[{{$index}}]" ng-model="subject.credits" min="0" max="999.9" ng-change="updateHours(subject, $index)" ng-disabled="practiceJournal.contract" required> </md-input-container> <md-input-container flex="10" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'practiceJournal.acadHours\' | translate}}</label> <input type="number" name="hours[{{$index}}]" ng-model="subject.hours" min="0" max="32767" pattern="^\\d+$" ng-change="updateCredits(subject, $index)" ng-disabled="practiceJournal.contract" required> <div ng-messages="practiceJournalForm[\'hours[\'+$index+\']\'].$error" ng-show="practiceJournalForm[\'hours[\'+$index+\']\'].$dirty"> <div ng-message="pattern"> {{\'main.messages.error.integer\' | translate}} </div> </div> </md-input-container> <md-input-container flex="10" flex-sm="100" flex-xs="100"> <label>{{\'practiceJournal.astroHours\' | translate}}</label> <br> <hois-value value="getAstronomicalHours(subject.hours)"></hois-value> </md-input-container> <div flex="{{practiceJournal.contract ? \'20\' : \'10\'}}" flex-sm="100" flex-xs="100" class="center"> <a class="remove" ng-click="removeModuleSubject(subject)">&times;&nbsp;&nbsp;</a> </div> </div> <div layout="row" layout-sm="column" layout-xs="column" flex ng-if="formState.isHigher &&!practiceJournal.contract"> <md-button class="md-raised" ng-click="addModuleSubject()">{{\'practiceJournal.button.addSubject\' | translate}}</md-button> </div> <div layout="row" flex> <md-input-container> <label>{{\'practiceJournal.startDate\' | translate}}</label> <md-datepicker ng-model="practiceJournal.startDate" md-max-date="practiceJournal.endDate" required ng-disabled="practiceJournal.contract"></md-datepicker> </md-input-container> <md-input-container> <label>{{\'practiceJournal.endDate\' | translate}}</label> <md-datepicker ng-model="practiceJournal.endDate" md-min-date="practiceJournal.startDate" required ng-disabled="practiceJournal.contract"></md-datepicker> </md-input-container> </div> <div layout="row" flex> <md-input-container flex> <label class="textInput">{{\'practiceJournal.practicePlace\' | translate}}</label> <input type="text" ng-model="practiceJournal.practicePlace" md-maxlength="255" required ng-disabled="practiceJournal.contract"> </md-input-container> </div> <hois-autocomplete ng-model="practiceJournal.teacher" method="teachers" name="techers" label="contract.schoolSupervisor" additional-query-params="{valid: true}" required ng-disabled="practiceJournal.contract"></hois-autocomplete> <div layout="row" flex> <md-input-container flex> <label class="textInput">{{\'practiceJournal.practicePlan\' | translate}}</label> <textarea ng-model="practiceJournal.practicePlan" required md-maxlength="20000" max-rows="2" ng-disabled="practiceJournal.contract"></textarea> </md-input-container> </div> <div layout="row" flex ng-if="!practiceJournal.contract"> <md-input-container flex> <label>{{\'contract.studentEvaluation\' | translate}}</label> <hois-select ng-model="practiceJournal.practiceEvaluation" type="practiceEvaluation" criteria="{active: true, targetCode: \'PRAKTIKA_SIHTRYHM_O\'}" value-property="id" display-property="nameEt"></hois-select> </md-input-container> </div> <div layout="row" layout-xs="column"> <md-button ng-if="(!practiceJournal.id || (practiceJournal.status !== \'PAEVIK_STAATUS_K\' && practiceJournal.canEdit)) && !practiceJournal.contract" class="md-raised md-primary" type="submit">{{\'main.button.save\' | translate}}</md-button> <md-button ng-if="practiceJournal.id && practiceJournal.canDelete" class="md-raised md-default" ng-click="delete()">{{\'main.button.delete\' | translate}}</md-button> <md-button class="md-raised md-default" ng-click="back(\'#/practiceJournals/\', practiceJournalForm)">{{\'main.button.back\' | translate}}</md-button> </div> </form> </div> </div>'),a.put("practiceJournal/practice.journal.entry.add.file.dialog.html",'<md-dialog aria-label="file select dialog" flex="40" flex-xs="100"> <form name="dialogForm" ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2>{{"main.button.uploadFile" | translate}}</h2> <span flex></span> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <span flex></span> <div class="ois-form-layout" layout="column" layout-margin ng-cloak> <div layout="column"> <md-input-container flex> <lf-ng-md-file-input name="file" lf-files="data.file" lf-browse-label="{{\'main.button.uploadFile\' | translate}}" lf-remove-label="{{\'main.button.delete\' | translate}}" lf-placeholder="" lf-filesize="10MB" disallow-same-file="addedFiles" lf-required> </lf-ng-md-file-input> </md-input-container> <div ng-messages="dialogForm.file.$error"> <div class="invalid" ng-message="required">{{\'main.messages.error.selectFile\' | translate}}</div> <div class="invalid" ng-message="filesize">{{\'main.messages.error.fileTooLarge\' | translate}} 10MB!</div> <div class="invalid" ng-message="samefile">{{\'main.messages.error.fileAlreadyExists\' | translate}}</div> </div> </div> </div> </md-dialog-content> <span flex></span> <md-dialog-actions layout="row" layout-align="start center"> <md-button class="md-raised md-primary" ng-click="submit()">{{"main.button.add" | translate}}</md-button> <md-button class="md-raised" ng-click="cancel()">{{"main.button.close" | translate}}</md-button> </md-dialog-actions> </form> </md-dialog>'),a.put("practiceJournal/practice.journal.entry.html",'<div class="ois-form-layout-padding" ng-cloak> <div flex> <form name="practiceJournalEntryForm" ng-submit="save()" novalidate layout="column"> <div class="form-readonly" layout="column"> <div layout="row" ng-if="auth.isStudent()"> <div md-colors="{color: \'orange\'}"> <md-icon md-colors="{color: \'orange\'}" md-font-set="material-icons">info_outline</md-icon> <span>{{\'practiceJournal.canAddEntries\' | translate}} {{practiceJournal.endDateDisplay | hoisDate}}</span> </div> </div> <br> <div layout="row" layout-xs="column" flex> <md-input-container class="label-only" flex> <label>{{\'student.label\' | translate}}</label> <hois-value value="practiceJournal.student.nameEt"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'student.curriculum\' | translate}}</label> <hois-value value="currentLanguageNameField(practiceJournal.studentCurriculumVersion)"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'student.studyForm\' | translate}}</label> <hois-classifier-value ng-model="practiceJournal.studentStudyForm" main-classifier-code="OPPEVORM"></hois-classifier-value> </md-input-container> <md-input-container flex> <label>{{\'student.studentGroup\' | translate}}</label> <hois-value value="currentLanguageNameField(practiceJournal.studentGroup)"></hois-value> </md-input-container> <br> </div> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'practice.info\' | translate}}</legend> <div ng-if="practiceJournal.contract" layout="row" flex> <md-input-container flex> <label>{{\'enterprise.label\' | translate}}</label> <hois-value value="currentLanguageNameField(practiceJournal.contract.enterprise)"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'contract.supervisors\' | translate}}</label> <hois-value value="getNames(practiceJournal.contract.supervisors)"></hois-value> </md-input-container> </div> <div layout="row" layout-xs="column" flex> <div layout="row" flex> <md-input-container flex> <label>{{\'practiceJournal.startDate\' | translate}}</label> <hois-value value="practiceJournal.startDate | hoisDate"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'practiceJournal.endDate\' | translate}}</label> <hois-value value="practiceJournal.endDate | hoisDate"></hois-value> </md-input-container> </div> <div layout="row" flex> <md-input-container flex> <label>{{\'practiceJournal.schoolSupervisor\' | translate}}</label> <hois-value value="currentLanguageNameField(practiceJournal.teacher)"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'practiceJournal.status\' | translate}}</label> <hois-classifier-value ng-model="practiceJournal.status" main-classifier-code="PAEVIK_STAATUS"></hois-classifier-value> </md-input-container> </div> </div> <div layout="row"> <md-input-container flex> <label>{{\'practiceJournal.practicePlace\' | translate}}</label> <hois-value value="practiceJournal.practicePlace"></hois-value> </md-input-container> </div> <md-table-container ng-if="!practiceJournal.isHigher"> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column width="35%">{{\'practiceJournal.module\' | translate}}</th> <th md-column width="35%">{{\'practiceJournal.theme\' | translate}}</th> <th md-column width="10%">{{\'practiceJournal.creditsEKAP\' | translate}}</th> <th md-column width="10%">{{\'practiceJournal.acadHours\' | translate}}</th> <th md-column width="10%">{{\'practiceJournal.astroHours\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="module in practiceJournal.moduleSubjects" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{currentLanguageNameField(module.module)}}</td> <td md-cell>{{currentLanguageNameField(module.theme)}}</td> <td md-cell>{{::module.credits}}</td> <td md-cell>{{::module.hours}}</td> <td md-cell>{{getAstronomicalHours(module.hours)}}</td> </tr> </tbody> </table> </md-table-container> <md-table-container ng-if="practiceJournal.isHigher"> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column width="70%">{{\'practiceJournal.subject\' | translate}}</th> <th md-column width="10%">{{\'practiceJournal.creditsEAP\' | translate}}</th> <th md-column width="10%">{{\'practiceJournal.acadHours\' | translate}}</th> <th md-column width="10%">{{\'practiceJournal.astroHours\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="subject in practiceJournal.moduleSubjects" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{currentLanguageNameField(subject.subject)}}</td> <td md-cell>{{::subject.credits}}</td> <td md-cell>{{::subject.hours}}</td> <td md-cell>{{getAstronomicalHours(subject.hours)}}</td> </tr> </tbody> </table> </md-table-container> </fieldset> </div> <div>&nbsp;</div> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'practice.fill\' | translate}}</legend> <div flex> <div layout="row" flex> <md-button class="md-raised" ng-click="addNewEntryRow()" ng-if="auth.isStudent()">{{\'main.button.addNewRow\' | translate}}</md-button> </div> <md-table-container class="secondary-table"> <table md-table md-progress="entries.$promise"> <thead md-head md-on-reorder="loadEntries"> <tr md-row flex> <th md-column class="padding-y-5" style="width: 10%; min-width: 50px">{{\'practiceJournal.practiceJournalEntry.practiceDate\' | translate}}</th> <th md-column style="padding: 0 300px 0 5px !important">{{\'practiceJournal.practiceJournalEntry.description\' | translate}}</th> <th md-column class="padding-y-5" style="width: 10%; min-width: 50px">{{\'practiceJournal.practiceJournalEntry.astroHours\' | translate}}</th> <th md-column class="padding-y-5" style="width: 10%; min-width: 50px">{{\'practiceJournal.acadHours\' | translate}}</th> <th ng-if="practiceJournal.contract" md-column class="padding-y-5">{{\'practiceJournal.practiceJournalEntry.supervisorComment\' | translate}}</th> <th md-column class="padding-y-5">{{\'practiceJournal.practiceJournalEntry.teacherComment\' | translate}}</th> <th md-column ng-if="!row.supervisorComment && !row.teacherComment && auth.isStudent()"></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in practiceJournal.practiceJournalEntries | orderBy: \'practiceDate\'" ng-class-odd="\'odd\'" ng-class-even="\'even\'" md-colors="{background: getEntryColor(row)}" flex> <td md-cell class="padding-y-5"> <md-input-container ng-show="row.isStudentEntry && auth.isStudent()" style="width: 100%"> <md-datepicker ng-model="row.practiceDate" md-min-date="practiceJournal.startDate" md-max-date="practiceJournal.endDate" required aria-label="{{\'practiceJournal.practiceJournalEntry.practiceDate\' | translate}}"></md-datepicker> </md-input-container> <div ng-if="!(row.isStudentEntry && auth.isStudent())"> <hois-value value="row.practiceDate | hoisDate"></hois-value> </div> </td> <td md-cell class="padding-y-5" colspan="1.5"> <md-input-container ng-if="row.isStudentEntry && auth.isStudent()" class="padding-y-5" style="width: 100%"> <textarea ng-model="row.description" type="text" aria-label="{{\'practiceJournal.practiceJournalEntry.description\' | translate}}" md-maxlength="10000" max-rows="5"></textarea> </md-input-container> <div ng-if="!(row.isStudentEntry && auth.isStudent())"> <hois-value value="row.description"></hois-value> </div> </td> <td md-cell class="padding-y-5"> <md-input-container ng-if="row.isStudentEntry && auth.isStudent()"> <label>{{\'main.timePlaceholder\' | translate}}</label> <input ng-model="row.astroHours" type="text" aria-label="{{\'practiceJournal.practiceJournalEntry.astroHours\' | translate}}" name="hours[{{$index}}].astroHour" pattern="^([0-9]|0[0-9]|1[0-9]|2[0-3])(:|.)[0-5][0-9]$" ng-change="setAcademicalHours(row)"> <div ng-messages="practiceJournalEntryForm[\'hours[\'+$index+\'].astroHour\'].$error" ng-show="practiceJournalEntryForm[\'hours[\'+$index+\'].astroHour\'].$dirty"> <div ng-message="min"> {{\'practiceJournal.practiceJournalEntry.error.hoursNegative\' | translate}} </div> <div ng-message="max"> {{\'practiceJournal.practiceJournalEntry.error.hourTooLarge\' | translate}} </div> <div ng-message="pattern"> {{\'main.messages.error.hourMin\' | translate}} </div> </div> </md-input-container> <div ng-if="!(row.isStudentEntry && auth.isStudent())"> <hois-value value="row.astroHours"></hois-value> </div> </td> <td md-cell class="padding-y-5"> <md-input-container ng-if="row.isStudentEntry && auth.isStudent()"> <input ng-model="row.acadHours" type="number" aria-label="{{\'practiceJournal.acadHours\' | translate}}" min="0" max="31.99" name="hours[{{$index}}].acadHour" step="0.01" ng-change="setAstronomicalHours(row, row.acadHours)"> <div ng-messages="practiceJournalEntryForm[\'hours[\'+$index+\'].acadHour\'].$error" ng-show="practiceJournalEntryForm[\'hours[\'+$index+\'].acadHour\'].$dirty"> <div ng-message="min"> {{\'practiceJournal.practiceJournalEntry.error.hoursNegative\' | translate}} </div> <div ng-message="max"> {{\'practiceJournal.practiceJournalEntry.error.hourTooLarge\' | translate}} </div> <div ng-message="step"> {{\'main.messages.error.step\' | translate}} </div> </div> </md-input-container> <div ng-if="!(row.isStudentEntry && auth.isStudent())"> <hois-value value="row.acadHours"></hois-value> </div> </td> <td ng-if="practiceJournal.contract" md-cell> <hois-value value="row.supervisorComment"></hois-value> </td> <td md-cell> <md-input-container ng-if="auth.isTeacher()"> <input ng-model="row.teacherComment" type="text" aria-label="{{\'practiceJournal.practiceJournalEntry.teacherComment\' | translate}}" md-maxlength="10000"> </md-input-container> <div ng-if="!auth.isTeacher()"> <hois-value value="row.teacherComment"></hois-value> </div> </td> <td md-cell ng-if="!row.supervisorComment && !row.teacherComment && auth.isStudent()"> <md-button class="remove nomargin" ng-click="deleteEntry(row)">&times;</md-button> </td> </tr> <tr ng-if="practiceJournal.practiceJournalEntries && practiceJournal.practiceJournalEntries.length !== 0" md-row ng-class-odd="\'odd\'" ng-class-even="\'even\'" flex> <td md-cell class="padding-y-5"></td> <td md-cell colspan="1.5"> <label style="font-weight: 700">{{\'main.sum\' | translate}}</label> </td> <td md-cell class="padding-y-5"> <md-input-container> <hois-value style="font-weight: 700" value="totalAstro"></hois-value> </md-input-container> </td> <td md-cell class="padding-y-5"> <md-input-container> <hois-value style="font-weight: 700" value="totalAcad"></hois-value> </md-input-container> </td> <td ng-if="practiceJournal.contract" md-cell></td> <td md-cell></td> <td md-cell ng-if="!row.supervisorComment && !row.teacherComment && auth.isStudent()"></td> </tr> </tbody> </table> </md-table-container> </div> </fieldset> <div>&nbsp;</div> <div ng-if="auth.isStudent()" layout="row" flex> <md-input-container flex> <label>{{\'practiceJournal.myPracticeReport\' | translate}}</label> <textarea ng-model="practiceJournal.practiceReport" md-maxlength="10000" max-rows="5"></textarea> </md-input-container> </div> <div ng-if="!auth.isStudent()" class="form-readonly" layout="row"> <md-input-container flex> <label>{{\'practiceJournal.myPracticeReport\' | translate}}</label> <hois-value value="practiceJournal.practiceReport"></hois-value> </md-input-container> </div> <div layout="column" flex> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'practiceJournal.studentOpinionFile\' | translate}}</legend> <md-button ng-if="auth.isStudent()" class="md-raised" href="" ng-click="openAddFileDialog(true)">{{\'main.button.uploadFile\' | translate}}</md-button> <md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column><span>{{\'file.nameAndFile\' | translate}}</span></th> <th md-column><span>{{\'file.additionDate\' | translate}}</span></th> <th md-column>{{\'file.addedBy\' | translate}}</th> <th md-column ng-if="!auth.isStudent()"></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="file in practiceJournal.practiceJournalStudentFiles | orderBy: \'id\'" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell> {{file.oisFile.fname}} <a ng-href="{{getUrl(file.oisFile, \'practicejournal\')}}" target="_blank" rel="noopener noreferrer"> <md-icon md-font-set="material-icons">file_download</md-icon> </a> </td> <td md-cell> {{file.inserted | hoisDateTime}} </td> <td md-cell> {{file.insertedBy}} </td> <td md-cell ng-if="auth.isStudent()"> <md-button class="remove nomargin" ng-click="deleteStudentFile(file)">&times;</md-button> </td> </tr> </tbody> </table> </md-table-container> </fieldset> </div> <div>&nbsp;</div> <div ng-if="auth.isStudent()" class="form-readonly" layout="row" flex> <md-input-container flex> <label>{{\'practiceJournal.teacherComment\' | translate}}</label> <hois-value value="practiceJournal.teacherComment"></hois-value> </md-input-container> </div> <div ng-if="!auth.isStudent()" layout="row" flex> <md-input-container flex> <label>{{\'practiceJournal.teacherComment\' | translate}}</label> <textarea ng-model="practiceJournal.teacherComment" md-maxlength="10000" max-rows="5"></textarea> </md-input-container> </div> <div ng-if="!auth.isStudent()">&nbsp;</div> <div ng-if="practiceJournal.contract" class="form-readonly" layout="row"> <md-input-container flex> <label>{{\'practiceJournal.supervisorComment\' | translate}}</label> <hois-value value="practiceJournal.supervisorComment"></hois-value> </md-input-container> </div> <div layout="column" flex> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'practiceJournal.supervisorOpinionFile\' | translate}}</legend> <md-button ng-if="!auth.isStudent()" class="md-raised" href="" ng-click="openAddFileDialog(false)">{{\'main.button.uploadFile\' | translate}}</md-button> <md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column><span>{{\'file.nameAndFile\' | translate}}</span></th> <th md-column><span>{{\'file.additionDate\' | translate}}</span></th> <th md-column>{{\'file.addedBy\' | translate}}</th> <th md-column ng-if="!auth.isStudent()"></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="file in practiceJournal.practiceJournalFiles | orderBy: \'id\'" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell> {{file.oisFile.fname}} <a ng-href="{{getUrl(file.oisFile, \'practicejournal\')}}" target="_blank" rel="noopener noreferrer"> <md-icon md-font-set="material-icons">file_download</md-icon> </a> </td> <td md-cell> {{file.inserted | hoisDateTime}} </td> <td md-cell> {{file.insertedBy}} </td> <td md-cell ng-if="!auth.isStudent()"> <md-button class="remove nomargin" ng-click="deleteFile(file)">&times;</md-button> </td> </tr> </tbody> </table> </md-table-container> </fieldset> </div> <div>&nbsp;</div> <div ng-if="auth.isStudent()" class="form-readonly" layout="row"> <md-input-container flex> <label>{{\'practiceJournal.teacherOpinion\' | translate}}</label> <hois-value value="practiceJournal.teacherOpinion"></hois-value> </md-input-container> </div> <div ng-if="!auth.isStudent()" layout="row"> <md-input-container flex> <label>{{\'practiceJournal.teacherOpinion\' | translate}}</label> <input ng-model="practiceJournal.teacherOpinion" type="text" md-maxlength="10000"> </md-input-container> </div> <div ng-if="!auth.isStudent()">&nbsp;</div> <div ng-if="practiceJournal.contract" class="form-readonly" layout="row"> <md-input-container flex> <label>{{\'practiceJournal.supervisorOpinion\' | translate}}</label> <hois-value value="practiceJournal.supervisorOpinion"></hois-value> </md-input-container> </div> <div ng-if="!auth.isStudent()" layout="row"> <md-input-container> <label class="textInput">{{\'practiceJournal.grade\' | translate}}</label> <hois-select ng-model="practiceJournal.grade" values="grades" value-property="code" hide-values="hideInvalid" show-property="{{practiceJournal.isHigher && auth.school.letterGrades ? \'value2\' : \'value\'}}"></hois-select> </md-input-container> </div> <div>&nbsp;</div> <hois-collapsable label="(\'contract.studentEvaluation\' | translate)" ng-if="practiceJournal.studentPracticeEvalCriteria && practiceJournal.studentPracticeEvalCriteria.length !== 0 && auth.isStudent()" expanded="false"> <div layout="column" flex> <fieldset> <div ng-repeat="eval in practiceJournal.studentPracticeEvalCriteria track by $index" layout="column"> <label flex="100" style="font-size: 14px">{{eval.nameEt}}</label> <div ng-if="eval.type === \'PRAKTIKA_KRITEERIUM_T\'" layout="column" flex="100"> <label class="responsiveLabel">{{eval.addInfo}}</label> <md-input-container> <textarea aria-label="{{eval.nameEt}}" ng-model="eval.valueTxt" name="studentEval[{{$index}}]" md-maxlength="4000" max-rows="5"></textarea> <div ng-messages="practiceJournalEntryForm[\'studentEval[\'+$index+\']\'].$error" ng-if="practiceJournalEntryForm[\'studentEval[\'+$index+\']\'].$dirty"> <div ng-message="md-maxlength"> {{\'main.messages.error.maxlength\' | translate}} </div> </div> </md-input-container> </div> <div ng-if="eval.type === \'PRAKTIKA_KRITEERIUM_N\'" layout="column"> <label class="responsiveLabel">{{eval.addInfo}}</label> <md-input-container flex="100"> <input aria-label="{{eval.nameEt}}" ng-model="eval.valueNr" name="studentEval[{{$index}}]" type="text" pattern="^\\d+$" md-maxlength="19"> <div ng-messages="practiceJournalEntryForm[\'studentEval[\'+$index+\']\'].$error" ng-if="practiceJournalEntryForm[\'studentEval[\'+$index+\']\'].$dirty"> <div ng-message="pattern"> {{\'main.messages.error.integer\' | translate}} </div> </div> </md-input-container> </div> <div ng-if="eval.type === \'PRAKTIKA_KRITEERIUM_H\'" layout="column"> <label class="responsiveLabel">{{eval.addInfo}}</label> <md-input-container flex="100"> <hois-select aria-label="{{eval.nameEt}}" ng-model="eval.valueClf" values="grades" value-property="code" show-property="{{auth.school.letterGrades && practiceJournal.isHigher ? \'value2\' : \'value\'}}"></hois-select> </md-input-container> </div> </div> </fieldset> </div> </hois-collapsable> <hois-collapsable label="(\'contract.studentEvaluation\' | translate)" ng-if="practiceJournal.studentPracticeEvalCriteria && practiceJournal.studentPracticeEvalCriteria.length !== 0 && (auth.isTeacher() || auth.isAdmin())" expanded="false"> <div class="form-readonly" layout="column" flex> <fieldset> <div ng-repeat="eval in practiceJournal.studentPracticeEvalCriteria track by $index" layout="column"> <label style="font-size: 14px">{{eval.nameEt}}</label> <div ng-if="eval.type === \'PRAKTIKA_KRITEERIUM_T\'" layout="column"> <label class="responsiveLabel">{{eval.addInfo}}</label> <md-input-container flex="100"> <hois-value value="eval.valueTxt"></hois-value> </md-input-container> </div> <div ng-if="eval.type === \'PRAKTIKA_KRITEERIUM_N\'" layout="column"> <label class="responsiveLabel">{{eval.addInfo}}</label> <md-input-container flex="100"> <hois-value value="eval.valueNr"></hois-value> </md-input-container> </div> <div ng-if="eval.type === \'PRAKTIKA_KRITEERIUM_H\'" layout="column"> <label class="responsiveLabel">{{eval.addInfo}}</label> <md-input-container flex="100"> <hois-value value="practiceJournal.isHigher && auth.school.letterGrades ? getGrade(eval.valueClf).value2 : getGrade(eval.valueClf).value"></hois-value> </md-input-container> </div> <div>&nbsp;</div> </div> </fieldset> </div> </hois-collapsable> <hois-collapsable label="(\'contract.supervisorEvaluation\' | translate)" ng-if="practiceJournal.supervisorPracticeEvalCriteria && practiceJournal.supervisorPracticeEvalCriteria.length !== 0 && (auth.isStudent() || auth.isTeacher() || auth.isAdmin())" expanded="false"> <div class="form-readonly" layout="column" flex> <fieldset> <div ng-repeat="eval in practiceJournal.supervisorPracticeEvalCriteria track by $index" layout="column"> <label style="font-size: 14px">{{eval.nameEt}}</label> <div ng-if="eval.type === \'PRAKTIKA_KRITEERIUM_T\'" layout="column"> <label class="responsiveLabel">{{eval.addInfo}}</label> <md-input-container flex="100"> <hois-value value="eval.valueTxt"></hois-value> </md-input-container> </div> <div ng-if="eval.type === \'PRAKTIKA_KRITEERIUM_N\'" layout="column"> <label class="responsiveLabel">{{eval.addInfo}}</label> <md-input-container flex="100"> <hois-value value="eval.valueNr"></hois-value> </md-input-container> </div> <div ng-if="eval.type === \'PRAKTIKA_KRITEERIUM_H\'" layout="column"> <label class="responsiveLabel">{{eval.addInfo}}</label> <md-input-container flex="100"> <hois-value value="practiceJournal.isHigher && auth.school.letterGrades ? getGrade(eval.valueClf).value2 : getGrade(eval.valueClf).value"></hois-value> </md-input-container> </div> <div>&nbsp;</div> </div> </fieldset> </div> </hois-collapsable> <div layout="row"> <md-button class="md-raised md-primary" type="submit">{{\'main.button.save\' | translate}}</md-button> <md-button ng-if="practiceJournal.canConfirm && practiceJournal.status !== \'PAEVIK_STAATUS_K\'" class="md-raised md-primary" ng-click="confirm()">{{\'main.button.confirm\' | translate}}</md-button> <md-button ng-if="practiceJournal.canConfirm && practiceJournal.status === \'PAEVIK_STAATUS_K\' && auth.isAdmin()" class="md-raised md-primary" ng-click="open()">{{\'practiceJournal.open\' | translate}}</md-button> <md-button class="md-raised md-default" ng-click="back(\'#/practiceJournals/\', practiceJournalEntryForm)">{{\'main.button.back\' | translate}}</md-button> </div> <div>&nbsp;</div> <div flex> <hois-collapsable label="(\'contract.practicePlan\' | translate)" expanded="false"> <p class="practice-plan">{{practiceJournal.contract.practicePlan ? practiceJournal.contract.practicePlan : practiceJournal.practicePlan}}</p> </hois-collapsable> </div> </form> </div> </div> <style>.form-readonly md-input-container, .readonly {\r\n    margin-bottom: 0px !important;\r\n    margin-top: 18px !important;\r\n  }</style>'),
a.put("practiceJournal/practice.journal.list.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex ng-model-options="{allowInvalid: true}"> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <form ng-if="auth.isStudent() || auth.isParent()" name="searchForm" ng-submit="load()" novalidate class="nomargin"> <div layout="row" layout-sm="column" layout-xs="column"> <div flex="100" flex-sm="100" flex-xs="100"> <div layout="column" flex> <md-input-container> <label class="textInput">{{\'studyYear.label\' | translate}}</label> <hois-select ng-model="criteria.studyYear" type="studyyear" select-current-study-year required autofocus></hois-select> </md-input-container> </div> </div> </div> <div layout="row"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> </div> <div flex-xs="0" flex-gt-xs="0" flex-gt-sm="50"></div> </form> <form ng-if="!auth.isStudent() && !auth.isParent()" name="searchForm" ng-submit="load()" novalidate class="nomargin"> <div layout="row" layout-sm="column" layout-xs="column"> <div flex="45" flex-sm="100" flex-xs="100"> <div layout="column" flex> <md-input-container> <label class="textInput">{{\'studyYear.label\' | translate}}</label> <hois-select ng-model="criteria.studyYear" type="studyyear" select-current-study-year required autofocus></hois-select> </md-input-container> </div> </div> <div flex="45" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <div layout="column" flex> <hois-autocomplete ng-model="criteria.studentGroup" ha-attribute="id" ha-controller="directiveControllers" method="studentgroups" label="{{\'studentGroup.label\'}}"></hois-autocomplete> </div> </div> </div> <div layout="row" layout-sm="column" layout-xs="column" ng-if="!auth.isStudent()"> <div layout="column" flex="45" flex-sm="100" flex-xs="100"> <div layout="column" flex> <md-input-container> <label class="textInput">{{\'student.label\' | translate}}</label> <input ng-model="criteria.studentName" type="text" md-maxlength="255"> </md-input-container> </div> </div> <div flex="45" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <div layout="column" flex> <md-input-container> <label class="textInput">{{\'contract.curriculumVersion\' | translate}}</label> <hois-select ng-model="criteria.curriculumVersion" type="curriculumversion"></hois-select> </md-input-container> </div> </div> </div> <div layout="row" layout-sm="column" layout-xs="column"> <div flex="45" flex-sm="100" flex-xs="100"> <div layout="column" flex> <md-input-container> <label class="textInput">{{\'practiceJournal.status\' | translate}}</label> <hois-classifier-select ng-model="criteria.status" main-classifier-code="PAEVIK_STAATUS" model-value-attr="code"></hois-classifier-select> </md-input-container> </div> </div> <div ng-if="!auth.isTeacher()" flex="45" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <div layout="column" flex> <md-input-container> <label class="textInput">{{\'contract.schoolSupervisor\' | translate}}</label> <hois-select ng-model="criteria.teacher" type="teacher"></hois-select> </md-input-container> </div> </div> </div> <div layout="row" layout-xs="column"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> <md-button ng-if="formState.canCreate && isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_PRAKTIKAPAEVIK\')" class="md-raised" ng-click="newPracticeJournal()">{{\'practiceJournal.button.createWithoutContract\' | translate}}</md-button> <md-button md-no-ink class="md-raised" ng-click="sendToEkis()">{{\'contract.sendToEkis\' | translate}}</md-button> </div> <div flex-xs="0" flex-gt-xs="0" flex-gt-sm="50"></div> </form> </fieldset> </div> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column ng-if="auth.isAdmin() || auth.isTeacher()" md-order-by="student_person.lastname,student_person.firstname">{{\'student.label\' | translate}}</th> <th md-column ng-if="auth.isAdmin() || auth.isTeacher()">{{\'studentGroup.label\' | translate}}</th> <th md-column ng-if="auth.school.vocational">{{\'practiceJournal.moduleAndTheme\' | translate}}</th> <th md-column ng-if="auth.school.higher">{{\'practiceJournal.subject\' | translate}}</th> <th md-column>{{\'practiceJournal.practiceStartAndEnd\' | translate}}</th> <th md-column>{{\'enterprise.label\' | translate}}</th> <th md-column>{{\'contract.supervisors\' | translate}}</th> <th md-column>{{\'practiceJournal.practicePlace\' | translate}}</th> <th md-column ng-if="auth.isAdmin()">{{\'practiceJournal.schoolSupervisor\' | translate}}</th> <th md-column>{{\'practiceJournal.studentLastEntryDate\' | translate}}</th> <th md-column>{{\'practiceJournal.status\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell ng-if="auth.isAdmin() || auth.isTeacher()"><a ng-href="/#/practiceJournals/{{::row.id}}/view">{{currentLanguageNameField(row.student)}}</a></td> <td md-cell ng-if="auth.isAdmin() || auth.isTeacher()">{{row.studentGroup}}</td> <td md-cell ng-if="auth.school.vocational"> <div ng-repeat="moduleSubject in row.moduleSubjects"> {{(moduleSubject.module || moduleSubject.theme) ? (currentLanguageNameField(moduleSubject.module) + \' \' + currentLanguageNameField(moduleSubject.theme)) : \'-\'}} </div> </td> <td md-cell ng-if="auth.school.higher"> <div ng-repeat="moduleSubject in row.moduleSubjects"> {{moduleSubject.subject ? currentLanguageNameField(moduleSubject.subject) : \'-\'}} </div> </td> <td md-cell>{{row.startDate | hoisDate}} - {{row.endDate | hoisDate}}</td> <td md-cell>{{row.enterpriseName}}</td> <td md-cell>{{row.enterpriseSupervisors}}</td> <td md-cell>{{row.practicePlace}}</td> <td md-cell ng-if="auth.isAdmin()">{{currentLanguageNameField(row.teacher)}}</td> <td md-cell>{{row.studentLastEntryDate | hoisDate}}</td> <td md-cell>{{currentLanguageNameField(row.status)}}</td> <td md-cell> <div layout="column"> <md-button ng-if="!(auth.isAdmin() || auth.isTeacher())" md-no-ink class="md-primary change-button" ng-href="#/practiceJournals/{{::row.id}}/view">{{\'main.button.view\' | translate}}</md-button> <md-button ng-if="row.canAddEntries" md-no-ink class="md-primary change-button" ng-href="#/practiceJournals/{{::row.id}}/entries/edit">{{\'practiceJournal.button.fill\' | translate}}</md-button> <md-button ng-if="auth.isAdmin() && row.canEdit && ((row.status !== \'PAEVIK_STAATUS_K\') || (row.canConfirm && row.status === \'PAEVIK_STAATUS_K\'))" md-no-ink class="md-primary change-button" ng-href="#/practiceJournals/{{::row.id}}/edit">{{\'main.button.change\' | translate}}</md-button> </div> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> </div>'),a.put("practiceJournal/practice.journal.student.list.html","<div layout-padding> <div flex> <md-table-container> <table md-table md-progress=\"tabledata.$promise\"> <thead md-head md-order=\"criteria.order\" md-on-reorder=\"loadData\"> <tr md-row> <th md-column>{{'student.label' | translate}}</th> <th md-column>{{'studentGroup.label' | translate}}</th> <th md-column ng-if=\"auth.school.vocational\">{{'practiceJournal.moduleAndTheme' | translate}}</th> <th md-column ng-if=\"auth.school.higher\">{{'practiceJournal.subject' | translate}}</th> <th md-column>{{'practiceJournal.practiceStartAndEnd' | translate}}</th> <th md-column>{{'enterprise.label' | translate}}</th> <th md-column>{{'enterprise.supervisor' | translate}}</th> <th md-column>{{'practiceJournal.practicePlace' | translate}}</th> <th md-column>{{'practiceJournal.schoolSupervisor' | translate}}</th> <th md-column>{{'practiceJournal.studentLastEntryDate' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat=\"row in tabledata.content\" ng-class-odd=\"'odd'\" ng-class-even=\"'even'\"> <td md-cell><a ng-href=\"/#/practiceJournals/{{::row.id}}/view\">{{currentLanguageNameField(row.student)}}</a></td> <td md-cell>{{row.studentGroup}}</td> <td md-cell ng-if=\"auth.school.vocational\">{{(row.module || row.theme) ? (currentLanguageNameField(row.module) + ' ' + currentLanguageNameField(row.theme)) : '-'}}</td> <td md-cell ng-if=\"auth.school.higher\">{{row.subject ? currentLanguageNameField(row.subject) : '-'}}</td> <td md-cell>{{row.startDate | hoisDate}} - {{row.endDate | hoisDate}}</td> <td md-cell>{{row.enterpriseName}}</td> <td md-cell>{{row.enterpriseContactPersonName}}</td> <td md-cell>{{row.practicePlace}}</td> <td md-cell>{{currentLanguageNameField(row.teacher)}}</td> <td md-cell>{{row.studentLastEntryDate | hoisDate}}</td> <td md-cell> <md-button ng-if=\"(auth.isStudent() && row.canStudentAddEntries) || (auth.isTeacher() && row.canTeacherAddEntries)\" md-no-ink class=\"md-primary change-button\" ng-href=\"#/practiceJournals/{{::row.id}}/entries/edit\">{{'practiceJournal.button.fill' | translate}}</md-button> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit=\"criteria.size\" md-limit-options=\"[10, 20, 50]\" md-page=\"criteria.page\" md-total=\"{{tabledata.totalElements}}\" md-on-paginate=\"loadData\" md-label=\"{page: '{{'main.page' | translate}}:', rowsPerPage: '{{'main.rowPerPage' | translate}}:', of: '{{'main.of' | translate}}'}\" md-page-select></md-table-pagination> </div> </div>"),a.put("practiceJournal/practice.journal.supervisor.entry.html",'<div class="ois-form-layout-padding" ng-cloak> <div flex> <form name="practiceJournalEntryForm" ng-submit="practiceJournalEntryForm.$valid && save()" novalidate layout="column"> <div class="form-readonly" layout="column"> <br> <div layout="row"> <div md-colors="{color: \'orange\'}"> <md-icon md-colors="{color: \'orange\'}" md-font-set="material-icons">info_outline</md-icon> <span>{{\'practiceJournal.canAddEntries\' | translate}} {{practiceJournal.endDateDisplay | hoisDate}}</span> </div> </div> <br> <div layout="row" flex> <md-input-container class="label-only" flex> <label>{{\'student.label\' | translate}}</label> <hois-value value="practiceJournal.student.nameEt"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'practiceJournal.school\' | translate}}</label> <hois-value value="currentLanguageNameField(practiceJournal.school)"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'student.curriculum\' | translate}}</label> <hois-value value="currentLanguageNameField(practiceJournal.studentCurriculumVersion)"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'student.studyForm\' | translate}}</label> <hois-classifier-value ng-model="practiceJournal.studentStudyForm" main-classifier-code="OPPEVORM"></hois-classifier-value> </md-input-container> <md-input-container flex> <label>{{\'student.studentGroup\' | translate}}</label> <hois-value value="currentLanguageNameField(practiceJournal.studentGroup)"></hois-value> </md-input-container> <br> </div> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'practice.info\' | translate}}</legend> <br> <div layout="row" flex> <md-input-container flex> <label>{{\'enterprise.label\' | translate}}</label> <hois-value value="currentLanguageNameField(practiceJournal.contract.enterprise)"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'contract.supervisors\' | translate}}</label> <hois-value value="getNames(practiceJournal.contract.supervisors)"></hois-value> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="25"> <label>{{\'practiceJournal.startDate\' | translate}}</label> <hois-value value="practiceJournal.startDate | hoisDate"></hois-value> </md-input-container> <md-input-container flex="25"> <label>{{\'practiceJournal.endDate\' | translate}}</label> <hois-value value="practiceJournal.endDate | hoisDate"></hois-value> </md-input-container> <md-input-container flex="25"> <label>{{\'practiceJournal.schoolSupervisor\' | translate}}</label> <hois-value value="currentLanguageNameField(practiceJournal.teacher)"></hois-value> </md-input-container> <md-input-container flex="25"> <label>{{\'practiceJournal.status\' | translate}}</label> <hois-classifier-value ng-model="practiceJournal.status" main-classifier-code="PAEVIK_STAATUS"></hois-classifier-value> </md-input-container> </div> <div layout="row"> <md-input-container flex> <label>{{\'practiceJournal.practicePlace\' | translate}}</label> <hois-value value="practiceJournal.practicePlace"></hois-value> </md-input-container> </div> <md-table-container ng-if="!practiceJournal.isHigher"> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column width="35%">{{\'practiceJournal.module\' | translate}}</th> <th md-column width="35%">{{\'practiceJournal.theme\' | translate}}</th> <th md-column width="10%">{{\'practiceJournal.creditsEKAP\' | translate}}</th> <th md-column width="10%">{{\'practiceJournal.acadHours\' | translate}}</th> <th md-column width="10%">{{\'practiceJournal.astroHours\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="module in practiceJournal.moduleSubjects" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{currentLanguageNameField(module.module)}}</td> <td md-cell>{{currentLanguageNameField(module.theme)}}</td> <td md-cell>{{::module.credits}}</td> <td md-cell>{{::module.hours}}</td> <td md-cell>{{getAstronomicalHours(module.hours)}}</td> </tr> </tbody> </table> </md-table-container> <md-table-container ng-if="practiceJournal.isHigher"> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column width="70%">{{\'practiceJournal.subject\' | translate}}</th> <th md-column width="10%">{{\'practiceJournal.creditsEAP\' | translate}}</th> <th md-column width="10%">{{\'practiceJournal.acadHours\' | translate}}</th> <th md-column width="10%">{{\'practiceJournal.astroHours\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="subject in practiceJournal.moduleSubjects" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{currentLanguageNameField(subject.subject)}}</td> <td md-cell>{{::subject.credits}}</td> <td md-cell>{{::subject.hours}}</td> <td md-cell>{{getAstronomicalHours(subject.hours)}}</td> </tr> </tbody> </table> </md-table-container> </fieldset> </div> <br> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'practice.fill\' | translate}}</legend> <div flex> <md-table-container> <table md-table md-progress="entries.$promise" class="secondary-table"> <thead md-head md-on-reorder="loadEntries"> <tr md-row flex> <th md-column>{{\'practiceJournal.practiceJournalEntry.practiceDate\' | translate}}</th> <th md-column>{{\'practiceJournal.practiceJournalEntry.description\' | translate}}</th> <th md-column>{{\'practiceJournal.practiceJournalEntry.astroHours\' | translate}}</th> <th md-column>{{\'practiceJournal.acadHours\' | translate}}</th> <th md-column>{{\'practiceJournal.practiceJournalEntry.supervisorComment\' | translate}}</th> <th md-column>{{\'practiceJournal.practiceJournalEntry.teacherComment\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in practiceJournal.practiceJournalEntries | orderBy: \'practiceDate\'" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell> <div> <hois-value value="row.practiceDate | hoisDate"></hois-value> </div> </td> <td md-cell> <div> <hois-value value="row.description"></hois-value> </div> </td> <td md-cell> <div> <hois-value value="row.astroHours"></hois-value> </div> </td> <td md-cell> <div> <hois-value value="row.acadHours"></hois-value> </div> </td> <td md-cell> <md-input-container> <input ng-model="row.supervisorComment" type="text" aria-label="{{\'practiceJournal.practiceJournalEntry.supervisorComment\' | translate}}" md-maxlength="10000"> </md-input-container> </td> <td md-cell> <div> <hois-value value="row.teacherComment"></hois-value> </div> </td> </tr> <tr ng-if="practiceJournal.practiceJournalEntries && practiceJournal.practiceJournalEntries.length !== 0" md-row ng-class-odd="\'odd\'" ng-class-even="\'even\'" flex> <td md-cell></td> <td md-cell> <label style="font-weight: 700">{{\'main.sum\' | translate}}</label> </td> <td md-cell> <md-input-container> <hois-value style="font-weight: 700" value="totalAstro"></hois-value> </md-input-container> </td> <td md-cell> <md-input-container> <hois-value style="font-weight: 700" value="totalAcad"></hois-value> </md-input-container> </td> <td md-cell></td> <td md-cell></td> </tr> </tbody> </table> </md-table-container> </div> </fieldset> <br><br> <div class="form-readonly" layout="row"> <md-input-container flex> <label>{{\'practiceJournal.myPracticeReport\' | translate}}</label> <hois-value value="practiceJournal.practiceReport"></hois-value> </md-input-container> </div> <div layout="column" flex> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'practiceJournal.studentOpinionFile\' | translate}}</legend> <md-button ng-if="auth.isStudent()" class="md-raised" href="" ng-click="openAddFileDialog(true)">{{\'main.button.uploadFile\' | translate}}</md-button> <md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column><span>{{\'file.nameAndFile\' | translate}}</span></th> <th md-column><span>{{\'file.additionDate\' | translate}}</span></th> <th md-column>{{\'file.addedBy\' | translate}}</th> <th md-column ng-if="!auth.isStudent()"></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="file in practiceJournal.practiceJournalStudentFiles | orderBy: \'id\'" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell> {{file.oisFile.fname}} <a ng-href="{{getUrl(file.oisFile, \'practicejournal\')}}" target="_blank" rel="noopener noreferrer"> <md-icon md-font-set="material-icons">file_download</md-icon> </a> </td> <td md-cell> {{file.inserted | hoisDateTime}} </td> <td md-cell> {{file.insertedBy}} </td> <td md-cell ng-if="auth.isStudent()"> <md-button class="remove nomargin" ng-click="deleteStudentFile(file)">&times;</md-button> </td> </tr> </tbody> </table> </md-table-container> </fieldset> </div> <br> <div class="form-readonly" layout="row" flex> <md-input-container flex> <label>{{\'practiceJournal.teacherComment\' | translate}}</label> <hois-value value="practiceJournal.teacherComment"></hois-value> </md-input-container> </div> <div class="form-readonly" layout="row" flex> <md-input-container flex> <label>{{\'practiceJournal.supervisorComment\' | translate}}</label> <textarea ng-model="practiceJournal.supervisorComment" md-maxlength="10000" max-rows="5"></textarea> </md-input-container> </div> <div layout="column" flex> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'practiceJournal.supervisorOpinionFile\' | translate}}</legend> <md-button ng-if="!auth.isStudent()" class="md-raised" href="" ng-click="openAddFileDialog()">{{\'main.button.uploadFile\' | translate}}</md-button> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column><span>{{\'file.nameAndFile\' | translate}}</span></th> <th md-column><span>{{\'file.additionDate\' | translate}}</span></th> <th md-column>{{\'file.addedBy\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="file in practiceJournal.practiceJournalFiles | orderBy: \'id\'" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell> {{file.oisFile.fname}} <a ng-href="{{getUrl(file.oisFile, \'practicejournal\')}}" target="_blank" rel="noopener noreferrer"> <md-icon md-font-set="material-icons">file_download</md-icon> </a> </td> <td md-cell> {{file.inserted | hoisDateTime}} </td> <td md-cell> {{file.insertedBy}} </td> <td md-cell> <md-button class="remove nomargin" ng-click="removeFromArray(practiceJournal.practiceJournalFiles, file)">&times;</md-button> </td> </tr> </tbody> </table> </fieldset> </div> <br> <div class="form-readonly" layout="row"> <md-input-container flex> <label>{{\'practiceJournal.teacherOpinion\' | translate}}</label> <hois-value value="practiceJournal.teacherOpinion"></hois-value> </md-input-container> </div> <div layout="row"> <md-input-container flex> <label>{{\'practiceJournal.supervisorOpinion\' | translate}}</label> <input ng-model="practiceJournal.supervisorOpinion" type="text" md-maxlength="10000"> </md-input-container> </div> <br> <hois-collapsable label="(\'contract.studentEvaluation\' | translate)" ng-if="practiceJournal.studentPracticeEvalCriteria && practiceJournal.studentPracticeEvalCriteria.length !== 0" expanded="false"> <div class="form-readonly" layout="column" flex> <fieldset> <div ng-repeat="eval in practiceJournal.studentPracticeEvalCriteria track by $index" layout="column"> <label style="font-size: 14px">{{eval.nameEt}}</label> <div ng-if="eval.type === \'PRAKTIKA_KRITEERIUM_T\'" layout="column"> <label class="responsiveLabel">{{eval.addInfo}}</label> <md-input-container flex> <hois-value value="eval.valueTxt"></hois-value> </md-input-container> </div> <div ng-if="eval.type === \'PRAKTIKA_KRITEERIUM_N\'" layout="column"> <label class="responsiveLabel">{{eval.addInfo}}</label> <md-input-container flex="100"> <hois-value value="eval.valueNr"></hois-value> </md-input-container> </div> <div ng-if="eval.type === \'PRAKTIKA_KRITEERIUM_H\'" layout="column"> <label class="responsiveLabel">{{eval.addInfo}}</label> <md-input-container flex="100"> <hois-value value="practiceJournal.isHigher && auth.school.letterGrades ? getGrade(eval.valueClf).value2 : getGrade(eval.valueClf).value"></hois-value> </md-input-container> </div> </div> </fieldset> </div> </hois-collapsable> <hois-collapsable label="(\'contract.supervisorEvaluation\' | translate)" ng-if="practiceJournal.supervisorPracticeEvalCriteria && practiceJournal.supervisorPracticeEvalCriteria.length !== 0" expanded="false"> <div layout="column" flex> <fieldset> <div ng-repeat="eval in practiceJournal.supervisorPracticeEvalCriteria track by $index" layout="column"> <label style="font-size: 14px">{{eval.nameEt}}</label> <div ng-if="eval.type === \'PRAKTIKA_KRITEERIUM_T\'" layout="column"> <label class="responsiveLabel">{{eval.addInfo}}</label> <md-input-container flex> <textarea aria-label="{{eval.nameEt}}" ng-model="eval.valueTxt" name="superEval[{{$index}}]" type="text" md-maxlength="4000" max-rows="5"></textarea> <div ng-messages="practiceJournalEntryForm[\'superEval[\'+$index+\']\'].$error" ng-show="practiceJournalEntryForm[\'superEval[\'+$index+\']\'].$dirty"> <div ng-message="md-maxlength"> {{\'main.messages.error.maxlength\' | translate}} </div> </div> </md-input-container> </div> <div ng-if="eval.type === \'PRAKTIKA_KRITEERIUM_N\'" layout="column"> <label class="responsiveLabel">{{eval.addInfo}}</label> <md-input-container flex="100"> <input aria-label="{{eval.nameEt}}" ng-model="eval.valueNr" name="superEval[{{$index}}]" type="text" pattern="^\\d+$" md-maxlength="19"> <div ng-messages="practiceJournalEntryForm[\'superEval[\'+$index+\']\'].$error" ng-show="practiceJournalEntryForm[\'superEval[\'+$index+\']\'].$dirty"> <div ng-message="pattern"> {{\'main.messages.error.integer\' | translate}} </div> </div> </md-input-container> </div> <div ng-if="eval.type === \'PRAKTIKA_KRITEERIUM_H\'" layout="column"> <label class="responsiveLabel">{{eval.addInfo}}</label> <md-input-container flex="100"> <hois-select aria-label="{{eval.nameEt}}" ng-model="eval.valueClf" values="grades" value-property="code" hide-values="hideInvalid" show-property="{{auth.school.letterGrades && practiceJournal.isHigher ? \'value2\' : \'value\'}}"></hois-select> </md-input-container> </div> </div> </fieldset> </div> </hois-collapsable> <div layout="row"> <md-button class="md-raised md-primary" type="submit">{{\'main.button.save\' | translate}}</md-button> </div> </form> <br> <div flex> <hois-collapsable label="(\'contract.practicePlan\' | translate)" expanded="false"> <p class="practice-plan"> {{practiceJournal.contract.practicePlan}} </p> </hois-collapsable> </div> </div> </div>'),a.put("practiceJournal/practice.journal.view.html",'<div class="ois-form-layout-padding" ng-cloak> <div flex> <form name="practiceJournalEntryForm" ng-submit="practiceJournalEntryForm.$valid && save()" novalidate layout="column"> <div class="form-readonly" layout="column"> <div layout="row" ng-if="auth.isStudent()"> <div md-colors="{color: \'orange\'}"> <md-icon md-colors="{color: \'orange\'}" md-font-set="material-icons">info_outline</md-icon> <span>{{\'practiceJournal.canAddEntries\' | translate}} {{practiceJournal.endDateDisplay | hoisDate}}</span> </div> </div> <br> <div layout="row" flex> <md-input-container class="label-only" flex> <label>{{\'student.label\' | translate}}</label> <hois-value value="practiceJournal.student.nameEt"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'student.curriculum\' | translate}}</label> <hois-value value="currentLanguageNameField(practiceJournal.studentCurriculumVersion)"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'student.studyForm\' | translate}}</label> <hois-classifier-value ng-model="practiceJournal.studentStudyForm" main-classifier-code="OPPEVORM"></hois-classifier-value> </md-input-container> <md-input-container flex> <label>{{\'student.studentGroup\' | translate}}</label> <hois-value value="currentLanguageNameField(practiceJournal.studentGroup)"></hois-value> </md-input-container> <div>&nbsp;</div> </div> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'practice.info\' | translate}}</legend> <div ng-if="practiceJournal.contract" layout="row" flex> <md-input-container flex> <label>{{\'enterprise.label\' | translate}}</label> <hois-value value="currentLanguageNameField(practiceJournal.contract.enterprise)"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'contract.supervisors\' | translate}}</label> <hois-value value="getNames(practiceJournal.contract.supervisors)"></hois-value> </md-input-container> </div> <div layout="row" layout-xs="column" flex> <div layout="row" flex> <md-input-container flex> <label>{{\'practiceJournal.startDate\' | translate}}</label> <hois-value value="practiceJournal.startDate | hoisDate"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'practiceJournal.endDate\' | translate}}</label> <hois-value value="practiceJournal.endDate | hoisDate"></hois-value> </md-input-container> </div> <div layout="row" flex> <md-input-container flex> <label>{{\'practiceJournal.schoolSupervisor\' | translate}}</label> <hois-value value="currentLanguageNameField(practiceJournal.teacher)"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'practiceJournal.status\' | translate}}</label> <hois-classifier-value ng-model="practiceJournal.status" main-classifier-code="PAEVIK_STAATUS"></hois-classifier-value> </md-input-container> </div> </div> <div layout="row" flex> <md-input-container flex> <label>{{\'practiceJournal.practicePlace\' | translate}}</label> <hois-value value="practiceJournal.practicePlace"></hois-value> </md-input-container> </div> <md-table-container ng-if="!practiceJournal.isHigher"> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column width="35%">{{\'practiceJournal.module\' | translate}}</th> <th md-column width="35%">{{\'practiceJournal.theme\' | translate}}</th> <th md-column width="10%">{{\'practiceJournal.creditsEKAP\' | translate}}</th> <th md-column width="10%">{{\'practiceJournal.acadHours\' | translate}}</th> <th md-column width="10%">{{\'practiceJournal.astroHours\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="module in practiceJournal.moduleSubjects" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{currentLanguageNameField(module.module)}}</td> <td md-cell>{{currentLanguageNameField(module.theme)}}</td> <td md-cell>{{::module.credits}}</td> <td md-cell>{{::module.hours}}</td> <td md-cell>{{getAstronomicalHours(module.hours)}}</td> </tr> </tbody> </table> </md-table-container> <md-table-container ng-if="practiceJournal.isHigher"> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column width="70%">{{\'practiceJournal.subject\' | translate}}</th> <th md-column width="10%">{{\'practiceJournal.creditsEAP\' | translate}}</th> <th md-column width="10%">{{\'practiceJournal.acadHours\' | translate}}</th> <th md-column width="10%">{{\'practiceJournal.astroHours\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="subject in practiceJournal.moduleSubjects" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{currentLanguageNameField(subject.subject)}}</td> <td md-cell>{{::subject.credits}}</td> <td md-cell>{{::subject.hours}}</td> <td md-cell>{{getAstronomicalHours(subject.hours)}}</td> </tr> </tbody> </table> </md-table-container> </fieldset> </div> <div>&nbsp;</div> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'practice.fill\' | translate}}</legend> <div flex> <md-table-container> <table md-table md-progress="entries.$promise" class="secondary-table"> <thead md-head md-on-reorder="loadEntries"> <tr md-row flex> <th md-column>{{\'practiceJournal.practiceJournalEntry.practiceDate\' | translate}}</th> <th md-column style="padding: 0 300px 0 5px !important">{{\'practiceJournal.practiceJournalEntry.description\' | translate}}</th> <th md-column>{{\'practiceJournal.practiceJournalEntry.astroHours\' | translate}}</th> <th md-column>{{\'practiceJournal.acadHours\' | translate}}</th> <th ng-if="practiceJournal.contract" md-column>{{\'practiceJournal.practiceJournalEntry.supervisorComment\' | translate}}</th> <th md-column>{{\'practiceJournal.practiceJournalEntry.teacherComment\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in practiceJournal.practiceJournalEntries | orderBy: \'practiceDate\'" ng-class-odd="\'odd\'" ng-class-even="\'even\'" md-colors="{background: getEntryColor(row)}"> <td md-cell> <hois-value value="row.practiceDate | hoisDate"></hois-value> </td> <td md-cell colspan="1.5" style="word-break: break-all"> <hois-value value="row.description"></hois-value> </td> <td md-cell> <hois-value value="row.astroHours"></hois-value> </td> <td md-cell> <hois-value value="row.acadHours"></hois-value> </td> <td ng-if="practiceJournal.contract" md-cell> <hois-value value="row.supervisorComment"></hois-value> </td> <td md-cell> <hois-value value="row.teacherComment"></hois-value> </td> </tr> <tr ng-if="practiceJournal.practiceJournalEntries && practiceJournal.practiceJournalEntries.length !== 0" md-row ng-class-odd="\'odd\'" ng-class-even="\'even\'" flex> <td md-cell></td> <td md-cell> <label style="font-weight: 700">{{\'main.sum\' | translate}}</label> </td> <td md-cell> <md-input-container> <hois-value style="font-weight: 700" value="totalAstro"></hois-value> </md-input-container> </td> <td md-cell> <md-input-container> <hois-value style="font-weight: 700" value="totalAcad"></hois-value> </md-input-container> </td> <td ng-if="practiceJournal.contract" md-cell></td> <td md-cell></td> </tr> </tbody> </table> </md-table-container> </div> </fieldset> <div>&nbsp;</div> <div class="form-readonly" layout="row"> <md-input-container flex> <label>{{\'practiceJournal.myPracticeReport\' | translate}}</label> <hois-value value="practiceJournal.practiceReport"></hois-value> </md-input-container> </div> <div layout="column" flex> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'practiceJournal.studentOpinionFile\' | translate}}</legend> <md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column><span>{{\'file.nameAndFile\' | translate}}</span></th> <th md-column><span>{{\'file.additionDate\' | translate}}</span></th> <th md-column>{{\'file.addedBy\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="file in practiceJournal.practiceJournalStudentFiles | orderBy: \'id\'" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell> {{file.oisFile.fname}} <a ng-href="{{getUrl(file.oisFile, \'practicejournal\')}}" target="_blank" rel="noopener noreferrer"> <md-icon md-font-set="material-icons">file_download</md-icon> </a> </td> <td md-cell> {{file.inserted | hoisDateTime}} </td> <td md-cell> {{file.insertedBy}} </td> </tr> </tbody> </table> </md-table-container> </fieldset> </div> <br> <div class="form-readonly" layout="row" flex> <md-input-container flex> <label>{{\'practiceJournal.teacherComment\' | translate}}</label> <hois-value value="practiceJournal.teacherComment"></hois-value> </md-input-container> </div> <div ng-if="practiceJournal.contract" class="form-readonly" layout="row"> <md-input-container flex> <label>{{\'practiceJournal.supervisorComment\' | translate}}</label> <hois-value value="practiceJournal.supervisorComment"></hois-value> </md-input-container> </div> <div>&nbsp;</div> <div layout="row"> <md-button class="md-raised md-default" ng-click="back(\'#/practiceJournals/\')">{{\'main.button.back\' | translate}}</md-button> </div> <div>&nbsp;</div> </form> <div layout="column" flex> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'practiceJournal.supervisorOpinionFile\' | translate}}</legend> <md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column> <span>{{\'file.nameAndFile\' | translate}}</span> </th> <th md-column> <span>{{\'file.additionDate\' | translate}}</span> </th> <th md-column>{{\'file.addedBy\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="file in practiceJournal.practiceJournalFiles | orderBy: \'id\'" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell> {{file.oisFile.fname}} <a ng-href="{{getUrl(file.oisFile, \'practicejournal\')}}" target="_blank" rel="noopener noreferrer"> <md-icon md-font-set="material-icons">file_download</md-icon> </a> </td> <td md-cell> {{file.inserted | hoisDateTime}} </td> <td md-cell> {{file.insertedBy}} </td> </tr> </tbody> </table> </md-table-container> </fieldset> </div> <div class="form-readonly" layout="row"> <md-input-container flex> <label>{{\'practiceJournal.teacherOpinion\' | translate}}</label> <hois-value value="practiceJournal.teacherOpinion"></hois-value> </md-input-container> </div> <div ng-if="practiceJournal.contract" class="form-readonly" layout="row"> <md-input-container flex> <label>{{\'practiceJournal.supervisorOpinion\' | translate}}</label> <hois-value value="practiceJournal.supervisorOpinion"></hois-value> </md-input-container> </div> <div class="form-readonly" layout="row"> <md-input-container flex> <label class="textInput">{{\'practiceJournal.grade\' | translate}}</label> <hois-value value="practiceJournal.isHigher && auth.school.letterGrades ? getGrade(practiceJournal.grade).value2 : getGrade(practiceJournal.grade).value"></hois-value> </md-input-container> </div> <div>&nbsp;</div> <div flex> <hois-collapsable label="(\'contract.studentEvaluation\' | translate)" ng-if="practiceJournal.studentPracticeEvalCriteria && practiceJournal.studentPracticeEvalCriteria.length !== 0" expanded="false"> <div class="form-readonly" layout="column" flex> <fieldset> <div ng-repeat="eval in practiceJournal.studentPracticeEvalCriteria track by $index" layout="column"> <label style="font-size: 14px; padding-bottom: 10px">{{eval.nameEt}}</label> <div ng-if="eval.type === \'PRAKTIKA_KRITEERIUM_T\'" layout="column"> <label class="responsiveLabel">{{eval.addInfo}}</label> <md-input-container flex="100"> <hois-value value="eval.valueTxt"></hois-value> </md-input-container> </div> <div ng-if="eval.type === \'PRAKTIKA_KRITEERIUM_N\'" layout="column"> <label class="responsiveLabel">{{eval.addInfo}}</label> <md-input-container flex="100"> <hois-value value="eval.valueNr"></hois-value> </md-input-container> </div> <div ng-if="eval.type === \'PRAKTIKA_KRITEERIUM_H\'" layout="column"> <label class="responsiveLabel">{{eval.addInfo}}</label> <md-input-container flex="100"> <hois-value value="practiceJournal.isHigher && auth.school.letterGrades ? getGrade(eval.valueClf).value2 : getGrade(eval.valueClf).value"></hois-value> </md-input-container> </div> <div>&nbsp;</div> </div> </fieldset> </div> </hois-collapsable> <hois-collapsable label="(\'contract.supervisorEvaluation\' | translate)" ng-if="practiceJournal.supervisorPracticeEvalCriteria && practiceJournal.supervisorPracticeEvalCriteria.length !== 0" expanded="false"> <div class="form-readonly" layout="column" flex> <fieldset> <div ng-repeat="eval in practiceJournal.supervisorPracticeEvalCriteria track by $index" layout="column"> <label style="font-size: 14px; padding-bottom: 10px">{{eval.nameEt}}</label> <div ng-if="eval.type === \'PRAKTIKA_KRITEERIUM_T\'" layout="column"> <label class="responsiveLabel">{{eval.addInfo}}</label> <md-input-container flex="100"> <hois-value value="eval.valueTxt"></hois-value> </md-input-container> </div> <div ng-if="eval.type === \'PRAKTIKA_KRITEERIUM_N\'" layout="column"> <label class="responsiveLabel">{{eval.addInfo}}</label> <md-input-container flex="100"> <hois-value value="eval.valueNr"></hois-value> </md-input-container> </div> <div ng-if="eval.type === \'PRAKTIKA_KRITEERIUM_H\'" layout="column"> <label class="responsiveLabel">{{eval.addInfo}}</label> <md-input-container flex="100"> <hois-value value="practiceJournal.isHigher && auth.school.letterGrades ? getGrade(eval.valueClf).value2 : getGrade(eval.valueClf).value"></hois-value> </md-input-container> </div> </div> </fieldset> </div> </hois-collapsable> <hois-collapsable label="(\'contract.practicePlan\' | translate)" expanded="false"> <p class="practice-plan">{{practiceJournal.practicePlan}}</p> </hois-collapsable> </div> </div> </div> <style>.form-readonly md-input-container, .readonly {\r\n    margin-bottom: 0px !important;\r\n    margin-top: 18px !important;\r\n  }</style>'),
a.put("practiceJournal/vocational.higher.select.dialog.html",'<md-dialog aria-label="vaocational higher select dialog"> <form name="dialogForm" ng-submit="dialogForm.$valid && submit()" novalidate ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2 flex>{{"practiceJournal.vocationalOrHigherSelect" | translate}}</h2> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <div class="md-dialog-content"> {{"practiceJournal.vocationalOrHigherPracticeJournal" | translate}} </div> </md-dialog-content> <md-dialog-actions layout="row" layout-align="start start"> <md-button class="md-raised" type="submit">{{\'practiceJournal.button.vocational\' | translate}}</md-button> <md-button class="md-raised" type="submit" ng-click="higher=true">{{"practiceJournal.button.higher" | translate}}</md-button> </md-dialog-actions> </form> </md-dialog>'),a.put("practiceStatistics/practice.contract.list.html",'<style>/** Autocomplete responsive */\r\n  md-autocomplete {\r\n    min-width: 0;\r\n  }\r\n  /** Datepicker responsive */\r\n  .md-datepicker-input-mask-opaque {\r\n    width: 100% !important;\r\n  }\r\n  .md-datepicker-input-mask {\r\n    width: 100% !important;\r\n  }\r\n  .md-datepicker-input-container {\r\n    width: 100%;\r\n  }\r\n  .md-datepicker-input {\r\n    min-width: 0;\r\n    max-width: 100%;\r\n  }\r\n  /** xs breakpoint */\r\n  @media(max-width: 600px) {\r\n    .padding-top-4 {\r\n      padding-top: 4px;\r\n    }\r\n  }</style> <md-content> <md-nav-bar md-selected-nav-item="currentNavItem" nav-bar-aria-label="main selection" ng-cloak hois-navbar-overflowed> <md-nav-item ng-if="auth.isAdmin()" md-nav-href="#/practice/student/statistics" name="practice.students"> {{\'practice.student.statistics\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin()" md-nav-href="#/practice/contract/statistics{{::contractParam}}" name="practice.contracts"> {{\'practice.contract.statistics\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin()" md-nav-href="#/practice/studyYear/statistics{{::studyYearParam}}" name="practice.studyYear"> {{\'practice.studyYear.statistics\' | translate}}</md-nav-item> </md-nav-bar> </md-content> <div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <fieldset ng-if="auth.isAdmin()"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <form name="searchForm" ng-submit="searchForm.$valid && loadData()" novalidate> <div layout="column" flex> <div layout="row" flex> <div layout="column" flex="50"> <hois-autocomplete flex ng-model="criteria.enterprise" method="enterprises" name="enterprise" label="enterprise.label" ha-attribute="id" ha-controller="directiveControllers"></hois-autocomplete> <hois-autocomplete flex ng-model="criteria.student" method="students" name="student" label="apel.student" ha-attribute="id" ha-controller="directiveControllers"></hois-autocomplete> <hois-autocomplete flex ng-model="criteria.studentGroup" ha-attribute="id" ha-controller="directiveControllers" method="studentgroups" name="studentGroup" label="{{\'lessonplan.studentGroup\'}}"></hois-autocomplete> </div> <div layout="column" flex="50"> <md-input-container layout="row" style="padding-bottom: 6px"> <label class="textInput">{{\'practice.contract.cancelReason\' | translate}}</label> <hois-classifier-select ng-model="criteria.cancelReason" model-value-attr="code" main-classifier-code="LEPING_TYH_POHJUS"></hois-classifier-select> </md-input-container> <div layout="row" layout-xs="column"> <div flex="50" flex-xs="100"> <md-input-container flex class="padding-top-4" style="width: 100%"> <label style="width: 90%;text-overflow: ellipsis;overflow: hidden !important; width:100% important">{{\'practice.contract.startDate\' | translate}}</label> <md-datepicker name="date" ng-model="criteria.startDate" md-max-date="criteria.endDate" md-open-on-focus hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> </div> <div flex="50" flex-xs="100"> <md-input-container flex style="width: 100%"> <label style="width: 90%;text-overflow: ellipsis;overflow: hidden !important; width:100% important">{{\'practice.contract.endDate\' | translate}}</label> <md-datepicker name="date" ng-model="criteria.endDate" md-min-date="criteria.startDate" md-open-on-focus hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> </div> </div> </div> </div> <div layout="row" layout-xs="column"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> <a ng-href="{{excel(formState.xlsUrl, criteria)}}" target="_blank" class="md-button md-raised">{{\'document.button.excel\' | translate}}</a> </div> </div> <div flex-xs="0" flex-gt-xs="0" flex-gt-sm="50"></div> </form> </fieldset> </div> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="p.firstname, p.lastname">{{\'practice.student.label\' | translate}}</th> <th md-column>{{\'practice.student.studentGroup\' | translate}}</th> <th md-column>{{\'practice.student.contractNr\' | translate}}</th> <th md-column>{{\'practice.student.contractDate\' | translate}}</th> <th md-column>{{\'practice.student.enterprise\' | translate}}</th> <th md-column>{{\'practice.contract.date\' | translate}}</th> <th md-column>{{\'practice.contract.cancelReason\' | translate}}</th> <th md-column>{{\'practice.contract.info\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{row.student ? row.student : \'-\'}}</td> <td md-cell>{{row.studentGroup ? row.studentGroup : \'-\'}}</td> <td md-cell ng-if="!row.contractNr">{{\'-\'}}</td> <td md-cell ng-if="row.contractNr"><a ng-href="#/contracts/{{::row.id}}/view">{{row.contractNr}}</a></td> <td md-cell>{{row.startDate | hoisDate}} - {{row.endDate | hoisDate}}</td> <td md-cell>{{row.enterprise ? row.enterprise : \'-\'}}</td> <td md-cell>{{row.cancelDate ? (row.cancelDate | hoisDate) : \'-\'}}</td> <td md-cell>{{row.cancelCode ? currentLanguageNameField(row.cancelCode) : \'-\'}}</td> <td md-cell>{{row.cancelReason ? row.cancelReason : \'-\'}}</td> <td md-cell> <md-button md-no-ink class="md-primary change-button" ng-href="#/contracts/{{::row.id}}/view">{{\'main.button.view\' | translate}}</md-button> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> </div>'),a.put("practiceStatistics/practice.student.list.html",'<style>/** Autocomplete responsive */\r\n  md-autocomplete {\r\n    min-width: 0;\r\n  }\r\n  /** Datepicker responsive */\r\n  .md-datepicker-input-mask-opaque {\r\n    width: 100% !important;\r\n  }\r\n  .md-datepicker-input-mask {\r\n    width: 100% !important;\r\n  }\r\n  .md-datepicker-input-container {\r\n    width: 100%;\r\n  }\r\n  .md-datepicker-input {\r\n    min-width: 0;\r\n    max-width: 100%;\r\n  }\r\n  .padding-top-0-to-2 {\r\n      padding-top: 0px;\r\n    }\r\n  /** xs breakpoint */\r\n  @media(max-width: 600px) {\r\n    .padding-top-bottom-0 {\r\n      padding-top: 0px;\r\n      padding-bottom: 0px;\r\n    }\r\n    .padding-top-0-to-2 {\r\n      padding-top: 2px;\r\n    }\r\n  }</style> <md-content> <md-nav-bar md-selected-nav-item="currentNavItem" nav-bar-aria-label="main selection" ng-cloak hois-navbar-overflowed> <md-nav-item ng-if="auth.isAdmin()" md-nav-href="#/practice/student/statistics" name="practice.students"> {{\'practice.student.statistics\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin()" md-nav-href="#/practice/contract/statistics{{::contractParam}}" name="practice.contracts"> {{\'practice.contract.statistics\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin()" md-nav-href="#/practice/studyYear/statistics{{::studyYearParam}}" name="practice.studyYear"> {{\'practice.studyYear.statistics\' | translate}}</md-nav-item> </md-nav-bar> </md-content> <div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <fieldset ng-if="auth.isAdmin()"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <form name="searchForm" ng-submit="searchForm.$valid && loadData()" novalidate> <div layout="column"> <div layout="row"> <div layout="column" flex="50"> <hois-autocomplete flex ng-model="criteria.enterprise" method="enterprises" name="enterprise" label="enterprise.label" ha-attribute="id" ha-controller="directiveControllers"></hois-autocomplete> <hois-autocomplete flex ng-model="criteria.student" method="students" name="student" label="apel.student" ha-attribute="id" ha-controller="directiveControllers"></hois-autocomplete> <hois-autocomplete flex ng-model="criteria.studentGroup" ha-attribute="id" ha-controller="directiveControllers" method="studentgroups" name="studentGroup" label="{{\'lessonplan.studentGroup\'}}"></hois-autocomplete> </div> <div layout="column" flex="50"> <div layout="row" layout-xs="column"> <div layout="row" flex="50" flex-xs="100"> <md-input-container flex style="width: 100%"> <label>{{\'practice.student.startDate\' | translate}}</label> <md-datepicker name="date" ng-model="criteria.startDate" md-max-date="criteria.endDate" md-open-on-focus hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> </div> <div layout="row" flex="50" flex-xs="100"> <md-input-container flex style="width: 100%" class="padding-top-bottom-0"> <label>{{\'practice.student.endDate\' | translate}}</label> <md-datepicker name="date" ng-model="criteria.endDate" md-min-date="criteria.startDate" md-open-on-focus hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> </div> </div> <md-input-container flex class="padding-top-0-to-2"> <label>{{\'practice.student.contractStatus\' | translate}}</label> <hois-classifier-select ng-model="criteria.status" main-classifier-code="LEPING_STAATUS" model-value-attr="code"></hois-classifier-select> </md-input-container> </div> </div> <div layout="row" layout-xs="column"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> <a ng-href="{{excel(formState.xlsUrl, criteria)}}" target="_blank" class="md-button md-raised">{{\'document.button.excel\' | translate}}</a> </div> </div> <div flex-xs="0" flex-gt-xs="0" flex-gt-sm="50"></div> </form> </fieldset> </div> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="p.firstname, p.lastname">{{\'practice.student.label\' | translate}}</th> <th md-column>{{\'practice.student.studentGroup\' | translate}}</th> <th md-column>{{\'practice.student.contractNr\' | translate}}</th> <th md-column>{{\'practice.student.contractDate\' | translate}}</th> <th md-column>{{\'practice.student.enterprise\' | translate}}</th> <th md-column>{{\'practice.student.status\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{row.student ? row.student : \'-\'}}</td> <td md-cell>{{row.studentGroup ? row.studentGroup : \'-\'}}</td> <td md-cell>{{row.contractNr ? row.contractNr : \'-\'}}</td> <td md-cell>{{row.startDate | hoisDate}} - {{row.endDate | hoisDate}}</td> <td md-cell>{{row.enterprise ? row.enterprise : \'-\'}}</td> <td md-cell>{{row.status ? currentLanguageNameField(row.status) : "-"}}</td> <td md-cell> <md-button md-no-ink class="md-primary change-button" ng-href="#/contracts/{{::row.id}}/view">{{\'main.button.view\' | translate}}</md-button> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> </div>'),a.put("practiceStatistics/practice.studyYear.list.html",'<md-content> <md-nav-bar md-selected-nav-item="currentNavItem" nav-bar-aria-label="main selection" ng-cloak hois-navbar-overflowed> <md-nav-item ng-if="auth.isAdmin()" md-nav-href="#/practice/student/statistics" name="practice.students"> {{\'practice.student.statistics\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin()" md-nav-href="#/practice/contract/statistics{{::contractParam}}" name="practice.contracts"> {{\'practice.contract.statistics\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin()" md-nav-href="#/practice/studyYear/statistics{{::studyYearParam}}" name="practice.studyYear"> {{\'practice.studyYear.statistics\' | translate}}</md-nav-item> </md-nav-bar> </md-content> <div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <fieldset ng-if="auth.isAdmin()"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <form name="searchForm" ng-submit="searchForm.$valid && loadData()" novalidate class="nomargin"> <div layout="column" flex> <div layout="row"> <md-input-container> <label class="textInput">{{\'practice.contract.studyYear\' | translate}}</label> <hois-classifier-select ng-model="criteria.studyYear" model-value-attr="code" main-classifier-code="OPPEAASTA"></hois-classifier-select> </md-input-container> </div> <div layout="row" layout-xs="column"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> <a ng-href="{{excel(formState.xlsUrl, criteria)}}" target="_blank" class="md-button md-raised">{{\'document.button.excel\' | translate}}</a> </div> </div> <div flex-xs="0" flex-gt-xs="0" flex-gt-sm="50"></div> </form> </fieldset> </div> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="sg.code">{{\'practice.studyYear.studentGroup\' | translate}}</th> <th md-column>{{\'practice.studyYear.curriculumName\' | translate}}</th> <th md-column>{{\'practice.studyYear.curriculumCode\' | translate}}</th> <th md-column>{{\'practice.studyYear.curriculumGroup\' | translate}}</th> <th md-column>{{\'practice.studyYear.course\' | translate}}</th> <th md-column>{{\'practice.studyYear.totalWent\' | translate}}</th> <th md-column>{{\'practice.studyYear.totalCompleted\' | translate}}</th> <th md-column>{{\'practice.studyYear.totalFailed\' | translate}}</th> <th md-column>{{\'practice.studyYear.nameAndReason\' | translate}}</th> <th md-column>{{\'practice.studyYear.grade\' | translate}}</th> <th md-column>{{\'practice.studyYear.enterprises\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{row.studentGroup}}</td> <td md-cell>{{currentLanguageNameField(row.curriculumName)}}</td> <td md-cell>{{row.curriculumCode ? row.curriculumCode : \'-\'}}</td> <td md-cell>{{row.curriculumGroup ? currentLanguageNameField(row.curriculumGroup) : \'-\'}}</td> <td md-cell>{{row.course ? row.course : \'-\'}}</td> <td md-cell>{{row.totalWent ? row.totalWent : \'0\'}}</td> <td md-cell>{{row.totalCompleted ? row.totalCompleted : \'0\'}}</td> <td md-cell>{{row.totalFailed ? row.totalFailed : \'0\'}}</td> <td md-cell>{{row.nameAndReason ? row.nameAndReason : \'-\'}}</td> <td md-cell>{{row.grade ? row.grade : \'-\'}}</td> <td md-cell>{{row.enterprises ? row.enterprises : \'-\'}}</td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> </div>'),a.put("protocol/module.protocol.addStudent.dialog.html",'<md-dialog aria-label="add student dialog" flex="60" flex-sm="100" flex-xs="100"> <form name="dialogForm" ng-submit="loadData()" novalidate ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2>{{\'moduleProtocol.addStudents\' | translate}}</h2> <span flex></span> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <div class="md-dialog-content"> <div flex> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex> <label>{{\'student.name\' | translate}}</label> <input type="text" ng-model="criteria.studentName" md-autofocus> </md-input-container> </div> <div layout="row"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> </div> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise" md-row-select multiple ng-model="selectedStudents"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row flex> <th md-column><span>{{\'student.label\' | translate}}</span></th> <th md-column><span>{{\'student.idcode\' | translate}}</span></th> <th md-column><span>{{\'journal.studentGroup\' | translate}}</span></th> <th md-column><span>{{\'curriculum.code\' | translate}}</span></th> </tr> </thead> <tbody md-body> <tr md-row md-select="row.studentId" ng-repeat="row in tabledata.content | orderBy: \'fullname\'" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{row.fullname}}</td> <td md-cell>{{row.idcode}}</td> <td md-cell>{{row.studentGroup}}</td> <td md-cell>{{currentLanguageNameField(row.curriculum)}}</td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> </div> </div> </md-dialog-content> <span flex></span> <md-dialog-actions layout="row" layout-align="start center"> <md-button class="md-raised md-primary" ng-click="submit()" ng-disabled="selectedStudents.length === 0">{{\'moduleProtocol.addStudents\' | translate}}</md-button> <md-button class="md-raised" ng-click="cancel()">{{"main.button.close" | translate}}</md-button> </md-dialog-actions> </form> </md-dialog>'),a.put("protocol/module.protocol.edit.html",'<div class="ois-form-layout-padding" ng-cloak> <div flex> <div ng-include="\'protocol/templates/module.protocol.header.tmpl.html\'"></div> <form ng-submit="save()" novalidate layout="column" name="moduleProtocolForm"> <div> <div flex> <md-table-container> <table md-table md-progress="protocol.$promise"> <thead md-head> <tr md-row> <th md-column ng-if="formState.canEditProtocol" width="10"> <md-input-container> <md-checkbox ng-model="formState.selectAllStudents" aria-label="selectAllStudents" ng-change="updateAllStudentsCheckBoxes(formState.selectAllStudents)"> </md-checkbox> </md-input-container> </th> <th md-column>{{\'student.label\' | translate}}</th> <th md-column>{{\'student.idcode\' | translate}}</th> <th md-column ng-if="protocol.protocolVdata.isPractice">{{\'moduleProtocol.practiceResult\' | translate}}</th> <th md-column ng-if="formState.showJournals" ng-repeat="journal in journals | orderBy: \'nameEt\'"> <div> <a md-colors="{color: \'grey-50\'}" ng-href="/#/journal/{{::journal.id}}/view">{{\'P\' + ($index + 1)}}</a> <md-tooltip> {{journal.nameEt}} - {{\'moduleProtocol.journalCapacity\' | translate:journal}} </md-tooltip> </div> </th> <th md-column ng-if="formState.showOutcomes && formState.outcomesAsEntries" ng-repeat="outcome in outcomes | orderBy: \'orderNr\'"> <div> {{\'moduleProtocol.outcome\' | translate}}{{outcome.orderNr + 1}} <md-tooltip>{{outcome.nameEt}}</md-tooltip> </div> </th> <th md-column>{{\'moduleProtocol.moduleGrade\' | translate}}</th> <th md-column ng-if="formState.canChangeConfirmedProtocolGrade">{{\'moduleProtocol.changeReason\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in protocol.protocolStudents | orderBy: \'fullname\'" ng-class-odd="\'odd\'" ng-class-even="\'even\'" md-select="row.id" md-select-id="row.id"> <td md-cell ng-if="formState.canEditProtocol"> <md-input-container> <md-checkbox ng-model="calculateGrades.protocolStudents[row.id]" ng-hide="!row.canBeDeleted" aria-label="selectStudent"> </md-checkbox> </md-input-container> </td> <td md-cell>{{row.fullname}}</td> <td md-cell>{{row.idcode}}</td> <td md-cell ng-if="protocol.protocolVdata.isPractice"> <span ng-repeat="journalResult in row.practiceJournalResults | orderBy: \'inserted\'"> <span> <span ng-class="{badResult: !gradeUtil.isPositive(journalResult.grade)}">{{gradeValue(journalResult.grade)}}</span> <md-tooltip> <span ng-if="journalResult.themes.length === 0">{{currentLanguageNameField(protocol.protocolVdata.curriculumVersionOccupationModule)}}</span> <span ng-if="journalResult.themes.length > 0" ng-repeat="theme in journalResult.themes track by $index"> <span ng-if="!$first">,</span> <span>{{currentLanguageNameField(theme)}}</span> </span> </md-tooltip> <span ng-if="!$last">/</span> </span> </span> </td> <td md-cell ng-if="formState.showJournals" ng-repeat="journal in journals | orderBy: \'nameEt\'"> <span ng-if="protocolStudentJournalResults[row.id] && protocolStudentJournalResults[row.id][journal.id]" ng-repeat="grade in protocolStudentJournalResults[row.id][journal.id]"> <span ng-class="{badResult: !gradeUtil.isPositive(grade.code)}">{{grade.value}}</span> <span ng-if="!$last">/</span> </span> </td> <td md-cell ng-if="formState.showOutcomes && formState.outcomesAsEntries" ng-repeat="outcome in outcomes | orderBy: \'orderNr\'"> <span ng-if="protocolStudentOutcomeResults[row.id] && protocolStudentOutcomeResults[row.id][outcome.id]"> <span ng-class="{badResult: !gradeUtil.isPositive(protocolStudentOutcomeResults[row.id][outcome.id].code)}">{{protocolStudentOutcomeResults[row.id][outcome.id].value}}</span> </span> </td> <td md-cell> <hois-select class="protocolGradeSelect" ng-model="row.grade" values="grades" show-property="value" value-property="code" hide-values="hideInvalid" aria-label="grade" ng-change="gradeChanged(row)" ng-disabled="!formState.canEditProtocol || !row.canBeDeleted"></hois-select> </td> <td md-cell ng-if="formState.canChangeConfirmedProtocolGrade"> <md-input-container ng-if="row.gradeHasChanged"> <input ng-model="row.addInfo" aria-label="addInfo" type="text" md-maxlength="255" ng-change="addInfoChanged(row);" required> </md-input-container> <span ng-if="row.addInfo && !row.gradeHasChanged"> {{row.addInfo}} </span> </td> <td md-cell> <a ng-if="row.canBeDeleted && formState.canAddDeleteStudents" ng-click="deleteProtocolStudent(row)" class="remove">&times;</a> </td> </tr> </tbody> </table> </md-table-container> </div> </div> <br> <div layout="row"> <md-button ng-if="formState.canEditProtocol" class="md-raised" ng-click="calculate()" ng-disabled="!formState.selectedStudentsExist">{{\'higherProtocol.calculate\' | translate}}</md-button> </div> <br> <div> <md-button ng-if="formState.canEditProtocol && protocol.status.code !== \'PROTOKOLL_STAATUS_K\'" class="md-raised md-primary" type="submit">{{\'main.button.save\' | translate}}</md-button> <md-button ng-if="formState.canAddDeleteStudents" class="md-raised" ng-click="addProtocolStudents()">{{\'moduleProtocol.addStudents\' | translate}}</md-button> <hois-button ng-if="formState.canConfirm===true" class="md-primary md-raised" hb-click="confirm()" hb-label="{{\'main.button.confirm\' | translate}}" hb-loading hb-promise></hois-button> <md-button ng-if="protocol.canBeDeleted" class="md-raised" ng-click="delete()">{{\'main.button.delete\' | translate}}</md-button> <a ng-show="formState.protocolPdfUrl" ng-href="{{formState.protocolPdfUrl}}" target="_blank" class="md-button md-raised">{{\'main.button.print\' | translate}}</a> <a ng-show="protocol.oisFile" ng-href="{{getUrl(protocol.oisFile, \'protocol\')}}" target="_blank" rel="noopener noreferrer" class="md-button md-raised">{{\'moduleProtocol.downloadSigned\' | translate}}</a> <md-button class="md-raised" ng-click="back(\'#/moduleProtocols/\', moduleProtocolForm)">{{\'main.button.back\' | translate}}</md-button> </div> </form> </div> <br> <div flex> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'moduleProtocol.studyOutcomes\' | translate}}</legend> <div ng-repeat="outcome in protocol.protocolVdata.outcomes | orderBy: \'orderNr\'" flex class="md-body-1"> <div>{{currentLanguageNameField(outcome)}}</div> </div> </fieldset> </div> </div>'),a.put("protocol/module.protocol.list.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <form name="searchForm" ng-submit="load()" novalidate class="nomargin"> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="50" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'moduleProtocol.studyYear\' | translate}}</label> <hois-select ng-model="criteria.studyYear" type="studyyear" name="studyyear" select-current-study-year required autofocus></hois-select> </md-input-container> <hois-autocomplete flex="50" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0" ng-model="criteria.studentGroup" ha-attribute="id" ha-controller="directiveControllers" method="studentgroups" label="{{\'studentGroup.label\'}}"></hois-autocomplete> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="50" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'moduleProtocol.curriculumVersion\' | translate}}</label> <hois-select ng-model="criteria.curriculumVersion" type="curriculumversion" criteria="{higher: false}"></hois-select> </md-input-container> <div flex="50" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <hois-autocomplete label="module.label" ha-controller="directiveControllers" ng-model="criteria.moduleObject" method="vocationalmodules"></hois-autocomplete> </div> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="50" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'moduleProtocol.status\' | translate}}</label> <hois-classifier-select ng-model="criteria.status" main-classifier-code="PROTOKOLL_STAATUS" model-value-attr="code"></hois-classifier-select> </md-input-container> <md-input-container flex="50" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label class="textInput">{{\'moduleProtocol.protocolNumber\' | translate}}</label> <input type="text" ng-model="criteria.protocolNr" md-maxlength="255"> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <div flex="50" flex-sm="100" flex-xs="100"> <div layout="column" flex> <div layout="row" layout-xs="column" flex> <md-input-container> <label>{{\'moduleProtocol.insertedFrom\' | translate}}</label> <md-datepicker ng-model="criteria.insertedFrom" md-max-date="criteria.insertedThru" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> <md-input-container flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'moduleProtocol.insertedThru\' | translate}}</label> <md-datepicker ng-model="criteria.insertedThru" md-min-date="criteria.insertedFrom" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> </div> </div> </div> <div flex="50" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <div layout="column" flex> <div layout="row" layout-xs="column" flex> <md-input-container> <label>{{\'moduleProtocol.confirmedFrom\' | translate}}</label> <md-datepicker ng-model="criteria.confirmDateFrom" md-max-date="criteria.confirmDateThru" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> <md-input-container flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'moduleProtocol.confirmedThru\' | translate}}</label> <md-datepicker ng-model="criteria.confirmDateThru" md-min-date="criteria.confirmDateFrom" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> </div> </div> </div> </div> <div layout="row" layout-xs="column"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearSearch()">{{\'main.button.clear\' | translate}}</md-button> <md-button class="md-raised" ng-href="#/moduleProtocols/new" ng-if="formState.canCreateProtocol">{{\'main.button.create\' | translate}}</md-button> <md-button class="md-raised" ng-click="myModules()" ng-if="auth.isTeacher()">{{\'moduleProtocol.myModules\' | translate}}</md-button> </div> <div flex-xs="0" flex-gt-xs="0" flex-gt-sm="50"></div> </form> </fieldset> </div> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column>{{\'moduleProtocol.protocolNr\' | translate}}</th> <th md-column>{{\'moduleProtocol.studentGroup\' | translate}}</th> <th md-column>{{\'moduleProtocol.curriculumVersionModule\' | translate}}</th> <th md-column>{{\'main.status\' | translate}}</th> <th md-column>{{\'moduleProtocol.insertedDate\' | translate}}</th> <th md-column>{{\'moduleProtocol.confirmDate\' | translate}}</th> <th md-column>{{\'moduleProtocol.confirmer\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell><a ng-href="#/moduleProtocols/{{::row.id}}/view">{{::row.protocolNr}}</a></td> <td md-cell>{{row.studentGroups.join(\', \')}}</td> <td md-cell>{{curriculumVersionModule(row)}}</td> <td md-cell>{{currentLanguageNameField(row.status)}}</td> <td md-cell>{{row.inserted | hoisDate}}</td> <td md-cell>{{row.confirmDate | hoisDate}}</td> <td md-cell>{{::row.confirmer}}</td> <td md-cell> <md-button ng-if="row.canEdit && row.status.code !== \'PROTOKOLL_STAATUS_K\'" md-no-ink class="md-primary change-button" ng-href="#/moduleProtocols/{{::row.id}}/edit">{{\'main.button.change\' | translate}}</md-button> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> </div>'),
a.put("protocol/module.protocol.mobileSign.dialog.html",'<md-dialog> <form> <md-dialog-content> <div class="md-dialog-content" layout="column" layout-align="center center"> <p>{{ \'moduleProtocol.mobileSign.instructions\' | translate }}</p> <h1>{{challengeID}}</h1> </div> </md-dialog-content> </form> </md-dialog>'),a.put("protocol/module.protocol.module.history.dialog.html",'<md-dialog aria-label="add student dialog" flex="60" flex-md="80" flex-sm="100" flex-xs="100" ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2 translate="moduleProtocol.moduleInfoHeader" translate-values="{ module: currentLanguageNameField(result.module),\r\n        credits: result.credits, curriculumVersion: currentLanguageNameField(result.curriculumVersion)}" ng-if="result"></h2> <span flex></span> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <div class="md-dialog-content"> <div layout-padding> <div flex> <md-table-container style="padding: 1px"> <table class="custom-table"> <thead class="secondary-table-header"> <th colspan="{{maxPeriods + 3}}"><span translate="moduleProtocol.moduleInfoHeader" translate-values="{ module: currentLanguageNameField(result.module),\r\n                  credits: result.credits, curriculumVersion: currentLanguageNameField(result.curriculumVersion)}" ng-if="result"></span></th> </thead> <tbody ng-repeat="module in result.lessonPlanModules"> <tr class="sub-header1"> <td style="width: 450px"> <p translate="{{ module.representative ? \'moduleProtocol.lessonPlanModuleHeaderWithRepresentative\' : \'moduleProtocol.lessonPlanModuleHeader\'}}" translate-values="{ year: currentLanguageNameField(module.studyYear.year), representative: currentLanguageNameField(module.representative) }"></p> </td> <td>{{\'main.OF\' | translate}}</td> <td ng-repeat="period in module.periods">{{currentLanguageNameField(period)}}</td> <td colspan="{{maxPeriods - module.periods.length + 1}}"></td> </tr> <tr class="journal-row" ng-repeat="journal in module.journals"> <td>{{currentLanguageNameField(journal)}}{{module.journalTeachers[journal.id].length &GT; 0 ? \': \' : \'\'}}{{module.journalTeachers[journal.id].join(\', \')}}</td> <td style="font-weight: bold">{{module.mappedHoursByJournal[journal.id] ? (module.mappedHoursByJournal[journal.id] | hoisNumber:1) : 0}}</td> <td ng-repeat="period in module.periods">{{module.mappedHours[journal.id][period.id] ? (module.mappedHours[journal.id][period.id] | hoisNumber:1) : 0}}</td> <td colspan="{{maxPeriods - module.periods.length + 1}}"></td> </tr> <tr class="journal-row"> <td>{{\'main.OF\' | translate}}</td> <td>{{module.totalHours ? (module.totalHours | hoisNumber:1) : 0}}</td> <td ng-repeat="period in module.periods">{{module.mappedHoursByPeriod[period.id] ? (module.mappedHoursByPeriod[period.id] | hoisNumber:1) : 0}}</td> <td colspan="{{maxPeriods - module.periods.length + 1}}"></td> </tr> </tbody> </table> </md-table-container> <!-- <md-table-container ng-repeat="module in result.lessonPlanModules">\r\n            <table md-table class="secondary-table">\r\n              <thead md-head>\r\n                <tr md-row>\r\n                  <th md-column style="width: 350px;">\r\n                    <p translate="moduleProtocol.lessonPlanModuleHeader" translate-values="{ year: currentLanguageNameField(module.studyYear.year)}"></p>\r\n                  </th>\r\n                  <th md-column style="width: 70px;">{{\'main.OF\' | translate}}</th>\r\n                  <th md-column style="width: 120px;" ng-repeat="period in module.periods">{{currentLanguageNameField(period)}}</th>\r\n                  <th md-column></th>\r\n                </tr>\r\n              </thead>\r\n              <tbody md-body>\r\n                <tr md-row ng-repeat="journal in module.journals" ng-class-odd="\'even\'" ng-class-even="\'odd\'">\r\n                  <td md-cell>{{currentLanguageNameField(journal)}}: {{module.journalTeachers[journal.id].join(\', \')}}</td>\r\n                  <td md-cell style="font-weight: bold;">{{module.mappedHoursByJournal[journal.id] ? (module.mappedHoursByJournal[journal.id] | hoisNumber:1) : 0}}</td>\r\n                  <td md-cell ng-repeat="period in module.periods">{{module.mappedHours[journal.id][period.id] ? (module.mappedHours[journal.id][period.id] | hoisNumber:1) : 0}}</td>\r\n                  <td md-cell></td>\r\n                </tr>\r\n                <tr md-row class="{{module.journals.length % 2  === 0? \'even\' : \'odd\'}}" style="height: 42px; font-weight: bold;">\r\n                  <td md-cell>{{\'main.OF\' | translate}}</td>\r\n                  <td md-cell>{{module.totalHours ? (module.totalHours | hoisNumber:1) : 0}}</td>\r\n                  <td md-cell ng-repeat="period in module.periods">{{module.mappedHoursByPeriod[period.id] ? (module.mappedHoursByPeriod[period.id] | hoisNumber:1) : 0}}</td>\r\n                  <td md-cell></td>\r\n                </tr>\r\n              </tbody>\r\n            </table>\r\n          </md-table-container> --> </div> </div> </div> </md-dialog-content> <md-dialog-actions layout="row" layout-align="start center"> <md-button class="md-raised" ng-click="cancel()">{{"main.button.back" | translate}}</md-button> </md-dialog-actions> </md-dialog> <style>table.custom-table {\r\n    border-collapse: collapse;\r\n    width: 100%;\r\n  }\r\n  \r\n  table.custom-table th:first-child,\r\n  table.custom-table td:first-child {\r\n    padding-left: 2.5em;\r\n  }\r\n  \r\n  table.custom-table th:last-child,\r\n  table.custom-table td:last-child {\r\n    padding-right: 1.5em;\r\n  }\r\n  \r\n  table.custom-table th,\r\n  table.custom-table td{\r\n    padding-right: 0.5em;\r\n    text-align: left;\r\n  }\r\n  \r\n  table.custom-table tr.occupation-header {\r\n    height: 38px !important;\r\n  }\r\n  \r\n  table.custom-table tr.occupation-header td:first-child {\r\n    padding-left: 0.5em !important;\r\n  }\r\n  \r\n  table.custom-table tr.sub-header1 {\r\n    height: 32px !important;\r\n    font-weight: bold !important;\r\n  }\r\n  \r\n  table.custom-table tr.sub-header1 td:first-child {\r\n    padding-left: 1.5em !important;\r\n  }\r\n  \r\n  table.custom-table tr {\r\n    height: 28px;\r\n  }\r\n  \r\n  table.custom-table td md-checkbox {\r\n    margin: auto;\r\n  }\r\n\r\n  table.custom-table tr.journal-row {\r\n    font-size: 13px;\r\n    font-weight: normal !important;\r\n    min-height: 31px !important;\r\n    border-bottom: 1px #eee solid;\r\n  }\r\n\r\n  table.custom-table tr:last-child {\r\n    font-size: 13px;\r\n    font-weight: bold !important;\r\n    min-height: 31px !important;\r\n    border-bottom: 1px #eee solid;\r\n  }</style>'),a.put("protocol/module.protocol.myModules.dialog.html",'<md-dialog aria-label="add student dialog" flex="60" flex-sm="100" flex-xs="100" ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2>{{\'moduleProtocol.myModules\' | translate}} - {{currentLanguageNameField(studyYear)}}</h2> <span flex></span> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <div class="md-dialog-content"> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise" class="secondary-table"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row flex> <th md-column><span>{{\'moduleProtocol.moduleName\' | translate}}</span></th> <th md-column><span>{{\'moduleProtocol.addProtocol\' | translate}}</span></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell><a ng-click="loadModuleHistory(row.module.id)">{{currentLanguageNameField(row.module)}}</a></td> <td md-cell> <md-button ng-if="true" md-no-ink class="md-primary change-button" style="padding: 0 !important; margin: 0 !important; min-width: 0" ng-click="addModuleProtocol(row)">{{\'main.button.add\' | translate}}</md-button></td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[5, 10, 20]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> </div> </div> </md-dialog-content> </md-dialog>'),a.put("protocol/module.protocol.new.html",'<div class="ois-form-layout-padding" ng-cloak> <div flex> <form ng-submit="submit()" novalidate layout="column" name="moduleProtocolNewForm"> <div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="50" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'moduleProtocol.studyYear\' | translate}}</label> <hois-select ng-model="formState.studyYear" type="studyyear" select-current-study-year required autofocus></hois-select> </md-input-container> <div flex="50" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <hois-autocomplete flex ng-model="formState.teacher" ha-attribute="id" ha-controller="directiveControllers" method="teachers" label="{{auth.higher ? \'teacher.labelHigher\' : \'teacher.labelVocational\'}}" additional-query-params="{valid: true, id: auth.isTeacher() ? auth.teacher : null,\r\n                selectedTeacherId: auth.isTeacher() ? auth.teacher : null}" ng-disabled="auth.isTeacher()" required></hois-autocomplete> </div> </div> <div layout="row" layout-sm="column" layout-xs="column"> <div flex> <hois-autocomplete flex ng-model="formState.curriculumVersionObject" method="curriculumversions" label="moduleProtocol.curriculumVersion" additional-query-params="{higher: false, closed: false}" required></hois-autocomplete> </div> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex flex-sm="100"> <label class="textInput">{{\'module.label\' | translate}}</label> <hois-select ng-model="formState.curriculumVersionOccupationModule" values="formState.curriculumVersionOccupationModules" ng-change="curriculumVersionOccupationModuleChange()" required></hois-select> </md-input-container> </div> <br> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise" md-row-select multiple ng-model="formState.selectedStudents"> <thead md-head> <tr md-row flex> <th md-column><span>{{\'student.label\' | translate}}</span></th> <th md-column><span>{{\'student.idcode\' | translate}}</span></th> <th md-column><span>{{\'main.status\' | translate}}</span></th> <th md-column><span>{{\'moduleProtocol.journalResults\' | translate}}</span></th> </tr> </thead> <tbody md-body> <tr md-row md-select="row.studentId" ng-repeat="row in tabledata.content | orderBy: \'fullname\'" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{row.fullname}}</td> <td md-cell>{{row.idcode}}</td> <td md-cell>{{currentLanguageNameField(row.status)}}</td> <td md-cell>{{journalResultsView(row.journalResults)}}</td> </tr> </tbody> </table> </md-table-container> </div> <br> <div layout="row"> <md-button class="md-raised md-primary" type="submit">{{\'moduleProtocol.create\' | translate}}</md-button> <md-button class="md-raised" ng-click="back(\'#/moduleProtocols/\')">{{\'main.button.back\' | translate}}</md-button> </div> </div> </form> </div> </div>'),a.put("protocol/module.protocol.view.html",'<div class="ois-form-layout-padding" ng-cloak> <div flex> <div> <form layout="column" name="moduleProtocolForm"> <div ng-include="\'protocol/templates/module.protocol.header.tmpl.html\'"></div> <div flex> <md-table-container> <table md-table md-progress="protocol.$promise"> <thead md-head> <tr md-row> <th md-column>{{\'student.label\' | translate}}</th> <th md-column>{{\'student.idcode\' | translate}}</th> <th md-column ng-if="protocol.protocolVdata.isPractice">{{\'moduleProtocol.practiceResult\' | translate}}</th> <th md-column ng-if="formState.showJournals" ng-repeat="journal in journals | orderBy: \'nameEt\'"> <div> <a md-colors="{color: \'grey-50\'}" ng-href="/#/journal/{{::journal.id}}/view">{{\'P\' + ($index + 1)}}</a> <md-tooltip> {{journal.nameEt}} - {{\'moduleProtocol.journalCapacity\' | translate:journal}} </md-tooltip> </div> </th> <th md-column ng-if="formState.showOutcomes && formState.outcomesAsEntries" ng-repeat="outcome in outcomes | orderBy: \'orderNr\'"> <div> {{\'moduleProtocol.outcome\' | translate}}{{outcome.orderNr + 1}} <md-tooltip>{{outcome.nameEt}}</md-tooltip> </div> </th> <th md-column>{{\'moduleProtocol.moduleGrade\' | translate}}</th> <th md-column>{{\'moduleProtocol.changeReason\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in protocol.protocolStudents | orderBy: \'fullname\'" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{row.fullname}}</td> <td md-cell>{{row.idcode}}</td> <td md-cell ng-if="protocol.protocolVdata.isPractice"> <span ng-repeat="journalResult in row.practiceJournalResults | orderBy: \'inserted\'"> <span> <span ng-class="{badResult: !gradeUtil.isPositive(journalResult.grade)}">{{gradeValue(journalResult.grade)}}</span> <md-tooltip>{{journalResult.theme ? currentLanguageNameField(journalResult.theme) : currentLanguageNameField(protocol.protocolVdata.curriculumVersionOccupationModule)}}</md-tooltip> <span ng-if="!$last">/</span> </span> </span> </td> <td md-cell ng-if="formState.showJournals" ng-repeat="journal in journals | orderBy: \'nameEt\'"> <span ng-if="protocolStudentJournalResults[row.id] && protocolStudentJournalResults[row.id][journal.id]" ng-repeat="grade in protocolStudentJournalResults[row.id][journal.id]"> <span ng-class="{badResult: !gradeUtil.isPositive(grade.code)}">{{grade.value}}</span> <span ng-if="!$last">/</span> </span> </td> <td md-cell ng-if="formState.showOutcomes && formState.outcomesAsEntries" ng-repeat="outcome in outcomes | orderBy: \'orderNr\'"> <span ng-if="protocolStudentOutcomeResults[row.id] && protocolStudentOutcomeResults[row.id][outcome.id]"> <span ng-class="{badResult: !gradeUtil.isPositive(protocolStudentOutcomeResults[row.id][outcome.id].code)}">{{protocolStudentOutcomeResults[row.id][outcome.id].value}}</span> </span> </td> <td md-cell> <span ng-class="{badResult: !gradeUtil.isPositive(row.grade)}">{{gradeValue(row.grade)}}</span> </td> <td md-cell>{{row.addInfo}}</td> </tr> </tbody> </table> </md-table-container> </div> <br> <div> <md-button ng-if="formState.canEditProtocol" class="md-primary md-raised" ng-href="#/moduleProtocols/{{::protocol.id}}/edit">{{\'main.button.change\' | translate}}</md-button> <a ng-show="formState.protocolPdfUrl" ng-href="{{formState.protocolPdfUrl}}" target="_blank" class="md-button md-raised">{{\'main.button.print\' | translate}}</a> <a ng-show="protocol.oisFile" ng-href="{{getUrl(protocol.oisFile, \'protocol\')}}" target="_blank" rel="noopener noreferrer" class="md-button md-raised">{{\'moduleProtocol.downloadSigned\' | translate}}</a> <md-button class="md-raised" ng-click="back(\'#/moduleProtocols\')">{{\'main.button.back\' | translate}}</md-button> </div> </form> </div> </div> </div>'),a.put("reception/reception.saisAdmission.archive.confirm.html",'<md-dialog aria-label="archive confirmation" flex="40" flex-sm="100" flex-xs="100"> <md-dialog-content> <div class="md-dialog-content" layout="row"> <label>{{\'reception.archive.archiveConfirm\' | translate}}{{archive}}?</label> </div> </md-dialog-content> <md-dialog-actions layout="row" layout-align="start center"> <md-button ng-click="submit()" class="md-raised md-primary">{{\'main.yes\' | translate}}</md-button> <md-button ng-click="cancel()" class="md-raised">{{\'main.no\' | translate}}</md-button> </md-dialog-actions> </md-dialog>'),a.put("reception/reception.saisAdmission.archive.html",'<div class="ois-form-layout-padding" ng-cloak> <div flex> <form name="archiveForm" ng-submit="save()" novalidate layout="column"> <div layout="row" flex> <label>{{\'reception.archive.archiveDateTo\' | translate}}</label> <md-input-container flex="100"> <label>{{\'academicCalendar.date\' | translate}}</label> <md-datepicker ng-model="archive.endDate" required flex="100"></md-datepicker> </md-input-container> </div> <div layout="row" flex> <md-button class="md-raised" type="submit">{{\'main.button.archive\' | translate}}</md-button> <md-button class="md-raised" ng-click="back(\'#/saisAdmission/search\')">{{\'main.button.back\' | translate}}</md-button> </div> </form> </div> </div>'),a.put("reception/reception.saisAdmission.import.html",'<div layout-padding> <div flex> <form ng-submit="importAdmissions()" layout="column" name="admissionImportForm"> <div flex> <div flex-xs="100" flex-gt-xs="100" layout="column"> <div layout="row"> <md-input-container flex="25" flex-md="100" flex-sm="100" flex-xs="100"> <label>{{\'reception.admission.saisImportRange\' | translate}}</label> <input type="hidden"> </md-input-container> <md-input-container flex="15" flex-md="100" flex-sm="100" flex-xs="100"> <label>{{\'main.from\' | translate}}</label> <md-datepicker required ng-model="criteria.createDateFrom" md-max-date="criteria.createDateTo"></md-datepicker> </md-input-container> <md-input-container flex="15" flex-md="100" flex-sm="100" flex-xs="100"> <label>{{\'main.thru\' | translate}}</label> <md-datepicker required ng-model="criteria.createDateTo" md-min-date="criteria.createDateFrom"></md-datepicker> </md-input-container> </div> <div layout="row"> <md-button type="submit" class="md-raised md-primary">{{\'reception.admission.saisImportAdmissions\' | translate}}</md-button> </div> </div> </div> </form> </div> </div> <div layout-padding ng-hide="failEmpty"> <div flex> {{\'reception.admission.failedImport\' | translate}} </div> </div> <div layout-padding ng-hide="failEmpty"> <div flex> <md-table-container> <table md-table md-progress="fail"> <thead md-head> <tr md-row> <th md-column>{{\'reception.admission.code\' | translate}}</th> <th md-column>{{\'reception.admission.error\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in fail" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{::row.code}}</td> <td md-cell>{{row.error | translate}}</td> </tr> </tbody> </table> </md-table-container> </div> </div> <div layout-padding ng-hide="successEmpty"> <div flex> {{\'reception.admission.successfullyImported\' | translate}} </div> </div> <div layout-padding ng-hide="successEmpty"> <div flex> <md-table-container> <table md-table> <thead md-head> <tr md-row> <th md-column>{{\'reception.admission.code\' | translate}}</th> <th md-column>{{\'reception.admission.curriculumVersion\' | translate}}</th> <th md-column>{{\'reception.admission.places\' | translate}}</th> <th md-column>{{\'reception.admission.language\' | translate}}</th> <th md-column>{{\'reception.admission.startDate\' | translate}}</th> <th md-column>{{\'reception.admission.endDate\' | translate}}</th> <th md-column>{{\'reception.admission.studyForm\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in success" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{::row.code}}</td> <td md-cell>{{::row.curriculumVersion.nameEt}}</td> <td md-cell>{{::row.places}}</td> <td md-cell>{{currentLanguageNameField(row.language)}}</td> <td md-cell>{{row.periodStart | hoisDate}}</td> <td md-cell>{{row.periodEnd | hoisDate}}</td> <td md-cell>{{currentLanguageNameField(row.studyForm)}}</td> </tr> </tbody> </table> </md-table-container> </div> </div>'),a.put("reception/reception.saisAdmission.list.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <form ng-submit="loadData()" layout="column"> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="100"> <label>{{\'reception.admission.code\' | translate}}</label> <hois-select ng-model="criteria.code" type="saisadmissioncode" value-property="nameEt"></hois-select> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="100"> <label>{{\'student.curriculum\' | translate}}</label> <hois-select ng-model="criteria.curriculumVersion" type="curriculumversion" criteria="{sais: true}"></hois-select> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="100"> <label>{{\'student.studyForm\' | translate}}</label> <hois-classifier-select ng-model="criteria.studyForm" model-value-attr="code" main-classifier-code="OPPEVORM"></hois-classifier-select> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="100"> <label>{{\'student.fin\' | translate}}</label> <hois-classifier-select ng-model="criteria.fin" model-value-attr="code" main-classifier-code="FINALLIKAS"></hois-classifier-select> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column" class="top-margin"> <md-input-container> <md-checkbox ng-model="criteria.archived" aria-label="{{\'reception.archive.displayArchived\' | translate}}"> {{\'reception.archive.displayArchived\' | translate}} </md-checkbox> </md-input-container> </div> <div layout="row"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> <md-button class="md-raised" ng-href="#/reception/saisAdmission/archive" ng-if="archiveButton">{{\'main.button.archive\' | translate}}</md-button> </div> <div flex-xs="0" flex-gt-xs="0" flex-gt-sm="50"></div> </form> </fieldset> </div> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="code">{{\'reception.admission.code\' | translate}}</th> <th md-column md-order-by="curriculumVersion.curriculum.{{currentLanguageNameField()}}">{{\'student.curriculum\' | translate}}</th> <th md-column md-order-by="places">{{\'reception.admission.places\' | translate}}</th> <th md-column md-order-by="language.{{currentLanguageNameField()}}">{{\'reception.admission.language\' | translate}}</th> <th md-column md-order-by="periodStart">{{\'studyYear.startDate\' | translate}}</th> <th md-column md-order-by="periodEnd">{{\'studyYear.endDate\' | translate}}</th> <th md-column md-order-by="studyForm.{{currentLanguageNameField()}}">{{\'student.studyForm\' | translate}}</th> <th md-column md-order-by="is_archived">{{\'reception.archive.archived\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell><a ng-href="#/reception/saisAdmission/{{::row.id}}/view">{{::row.code}}</a></td> <td md-cell>{{currentLanguageNameField(row.curriculumVersion)}}</td> <td md-cell>{{::row.places}}</td> <td md-cell>{{currentLanguageNameField(row.language)}}</td> <td md-cell>{{row.periodStart | hoisDate}}</td> <td md-cell>{{row.periodEnd | hoisDate}}</td> <td md-cell>{{currentLanguageNameField(row.studyForm)}}</td> <td md-cell>{{row.archived ? (\'main.yes\' | translate) : (\'main.no\' | translate)}}</td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> </div>'),a.put("reception/reception.saisAdmission.view.html",'<div class="ois-form-layout-padding form-readonly" ng-cloak> <div flex> <form layout="column"> <div style="padding-top: 1em"> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container class="label-only" flex="30" flex-sm="100" flex-xs="100"> <label>{{\'reception.admission.code\' | translate}}</label> <hois-value value="saisAdmission.code"></hois-value> </md-input-container> <md-input-container flex="30" flex-sm="100" flex-xs="100"> <label>{{\'student.curriculum\' | translate}}</label> <hois-value value="currentLanguageNameField(saisAdmission.curriculumVersion)"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="30" flex-sm="100" flex-xs="100"> <label>{{\'student.fin\' | translate}}</label> <hois-classifier-value ng-model="saisAdmission.fin" main-classifier-code="FINALLIKAS"></hois-classifier-value> </md-input-container> <md-input-container flex="30" flex-sm="100" flex-xs="100"> <label>{{\'reception.admission.language\' | translate}}</label> <hois-classifier-value ng-model="saisAdmission.language" main-classifier-code="OPPEKEEL"></hois-classifier-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="30" flex-sm="100" flex-xs="100"> <label>{{\'reception.admission.places\' | translate}}</label> <hois-value value="saisAdmission.places"></hois-value> </md-input-container> <md-input-container flex="30" flex-sm="100" flex-xs="100"> <label>{{\'student.studyForm\' | translate}}</label> <hois-classifier-value ng-model="saisAdmission.studyForm" main-classifier-code="OPPEVORM"></hois-classifier-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="30" flex-sm="100" flex-xs="100"> <label>{{\'student.studyLoad\' | translate}}</label> <hois-classifier-value ng-model="saisAdmission.loads" main-classifier-code="OPPEKOORMUS"></hois-classifier-value> </md-input-container> <md-input-container flex="30" flex-sm="100" flex-xs="100"> <label>{{\'student.studyLevel\' | translate}}</label> <hois-classifier-value ng-model="saisAdmission.studyLevel" main-classifier-code="OPPEASTE"></hois-classifier-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container class="label-only" flex="30" flex-sm="100" flex-xs="100"> <label>{{\'studyYear.startDate\' | translate}}</label> <hois-value value="saisAdmission.periodStart | hoisDate"></hois-value> </md-input-container> <md-input-container flex="30" flex-sm="100" flex-xs="100"> <label>{{\'studyYear.endDate\' | translate}}</label> <hois-value value="saisAdmission.periodEnd | hoisDate"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container class="label-only" flex="30" flex-sm="100" flex-xs="100"> <md-checkbox ng-model="saisAdmission.archived" disabled>{{\'reception.archive.archived\' | translate}}</md-checkbox> </md-input-container> </div> <br> <div layout="row"> <md-button ng-href="#/reception/saisAdmission/search" class="md-raised">{{\'main.button.back\' | translate}}</md-button> <md-button ng-click="revertArchived()" ng-if="auth.isAdmin() && saisAdmission.archived" class="md-raised">{{\'reception.archive.revertArchived\' | translate}}</md-button> </div> </div> </form> </div> </div>'),a.put("reception/reception.saisApplication.import.csv.file.dialog.html",'<md-dialog aria-label="import csv dialog"> <form name="dialogForm" ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2>{{"main.button.loadCsvFile" | translate}}</h2> <span flex></span> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <span flex></span> <div class="ois-form-layout" layout="column" layout-margin ng-cloak> <div layout="column"> <md-input-container flex> <lf-ng-md-file-input name="file" lf-files="data.file" lf-browse-label="{{\'main.addFile\' | translate}}" lf-remove-label="{{\'main.button.delete\' | translate}}" lf-placeholder="" lf-mimetype="application/vnd.ms-excel|text/csv" accept=".csv" lf-required> </lf-ng-md-file-input> </md-input-container> <div ng-messages="dialogForm.file.$error"> <div class="invalid" ng-message="required">{{\'main.messages.error.selectFile\' | translate}}</div> <div class="invalid" ng-message="mimetype">{{\'main.messages.error.wrongExtension\' | translate}} .csv</div> </div> </div> </div> </md-dialog-content> <span flex></span> <md-dialog-actions layout="row" layout-align="start center"> <md-button class="md-raised md-primary" ng-click="submit()">{{"main.button.add" | translate}}</md-button> <md-button class="md-raised" ng-click="cancel()">{{"main.button.close" | translate}}</md-button> </md-dialog-actions> </form> </md-dialog>'),a.put("reception/reception.saisApplication.import.html",'<div layout-padding> <div flex> <form ng-submit="importApplications()" layout="column" name="applicationImportForm" novalidate> <div flex> <div flex-xs="100" flex-gt-xs="100" layout="column"> <!--div class="indentForToast"></div--> <div layout="row"> <md-input-container flex="35" flex-md="100" flex-sm="100" flex-xs="100"> <label>{{\'reception.application.saisImportRange\' | translate}}</label> <input type="hidden"> </md-input-container> <md-input-container flex="15" flex-md="100" flex-sm="100" flex-xs="100"> <label>{{\'main.from\' | translate}}</label> <md-datepicker ng-required="!((criteria.applicationDateFrom && criteria.applicationDateTo)|| criteria.idCode.length || criteria.admissionCode.length)" ng-model="criteria.applicationDateFrom" md-max-date="criteria.applicationDateTo"></md-datepicker> </md-input-container> <md-input-container flex="15" flex-md="100" flex-sm="100" flex-xs="100"> <label>{{\'main.thru\' | translate}}</label> <md-datepicker ng-required="!((criteria.applicationDateFrom && criteria.applicationDateTo)|| criteria.idCode.length || criteria.admissionCode.length)" ng-model="criteria.applicationDateTo" md-min-date="criteria.applicationDateFrom"></md-datepicker> </md-input-container> </div> <div> <md-list flex-xs="100" flex-gt-xs="100" flex="60"> <md-list-item ng-repeat="status in statusList"> <span> <md-checkbox ng-model="status._selected"> {{currentLanguageNameField(status)}} </md-checkbox> </span> </md-list-item> </md-list> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="60" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'reception.application.candidateIdCode\' | translate}}</label> <input ng-model="criteria.idCode" type="text" ng-required="!((criteria.applicationDateFrom && criteria.applicationDateTo)|| criteria.idCode.length || criteria.admissionCode.length)"> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="60" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'reception.admission.code\' | translate}}</label> <hois-select ng-model="criteria.admissionCode" type="saisadmissioncodearchived" value-property="nameEt" ng-required="!((criteria.applicationDateFrom && criteria.applicationDateTo)|| criteria.idCode.length || criteria.admissionCode.length)"></hois-select> </md-input-container> </div> <div layout="row"> <md-button type="submit" class="md-raised md-primary">{{\'reception.application.saisImportApplications\' | translate}}</md-button> </div> </div> </div> </form> </div> </div> <div ng-if="failed.length > 0"> <div layout-padding> <div flex> {{\'reception.admission.failedImport\' | translate}} </div> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="fail"> <thead md-head> <tr md-row> <th md-column>{{\'reception.application.date\' | translate}}</th> <th md-column>{{\'reception.application.message\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in failed" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{row.applicationDate | hoisDate}}</td> <td md-cell>{{row.message | translate}}</td> </tr> </tbody> </table> </md-table-container> </div> </div> </div> <div ng-if="successful.length > 0"> <div layout-padding> <div flex> {{\'reception.application.successfullyImported\' | translate}} </div> </div> <div layout-padding> <div flex> <md-table-container> <table md-table> <thead md-head> <tr md-row> <th md-column>{{\'reception.application.nr\' | translate}}</th> <th md-column>{{\'reception.application.idCode\' | translate}}</th> <th md-column>{{\'reception.application.firstName\' | translate}}</th> <th md-column>{{\'reception.application.lastName\' | translate}}</th> <th md-column>{{\'reception.application.admissionCode\' | translate}}</th> <th md-column>{{\'reception.application.status\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in successful" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{::row.applicationNr}}</td> <td md-cell>{{::row.idCode}}</td> <td md-cell>{{::row.firstName}}</td> <td md-cell>{{::row.lastName}}</td> <td md-cell>{{::row.admissionCode}}</td> <td md-cell>{{currentLanguageNameField(row.applicationStatus)}}</td> </tr> </tbody> </table> </md-table-container> </div> </div> </div>'),
a.put("reception/reception.saisApplication.import.result.dialog.html",'<md-dialog aria-label="import csv result dialog"> <form name="dialogForm" ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2>{{"reception.application.importFromCsvFile" | translate}}</h2> </div> </md-toolbar> <md-dialog-content> <span flex></span> <div class="ois-form-layout" layout="column" layout-margin ng-cloak> <div ng-show="!result"> <p>{{"main.proccessingFile" | translate}}</p> <div layout="row" layout-align="space-around"> <md-progress-circular md-mode="indeterminate"></md-progress-circular> </div> </div> <div ng-show="result"> <h2>{{\'reception.application.added\' | translate}}</h2> <md-table-container> <table md-table> <thead md-head> <tr md-row> <th md-column>{{\'reception.application.csvFileRowNr\' | translate}}</th> <th md-column>{{\'reception.application.nr\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in result.successful" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{::row.rowNr}}</td> <td md-cell>{{::row.message}}</td> </tr> </tbody> </table> </md-table-container> <span flex></span> <h2>{{\'reception.application.failed\' | translate}}</h2> <md-table-container> <table md-table> <thead md-head> <tr md-row> <th md-column>{{\'reception.application.csvFileRowNr\' | translate}}</th> <th md-column>{{\'message.label\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in result.failed" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{::row.rowNr}}</td> <td md-cell>{{::row.message}}</td> </tr> </tbody> </table> </md-table-container> </div> </div> </md-dialog-content> <span flex></span> <md-dialog-actions layout="row" layout-align="start center"> <md-button ng-if="result" class="md-raised md-primary" ng-click="cancel()">{{"main.button.close" | translate}}</md-button> </md-dialog-actions> </form> </md-dialog>'),a.put("reception/reception.saisApplication.list.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <form name="searchForm" ng-submit="searchForm.$valid && loadData()" ng-model-options="{allowInvalid: true}" layout="column"> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="100"> <label>{{\'reception.admission.code\' | translate}}</label> <hois-select ng-model="criteria.code" type="saisadmissioncode" value-property="nameEt" multiple></hois-select> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="100"> <label>{{\'reception.application.status\' | translate}}</label> <hois-classifier-select ng-model="criteria.status" model-value-attr="code" main-classifier-code="SAIS_AVALDUSESTAATUS" multiple></hois-classifier-select> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="100"> <label class="textInput">{{\'reception.application.candidateName\' | translate}}</label> <input ng-model="criteria.name" type="text" md-maxlength="255"> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="100"> <label class="textInput">{{\'reception.application.candidateIdCode\' | translate}}</label> <input ng-model="criteria.idcode" type="text" minlength="11" md-maxlength="11"> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="30" flex-sm="100" flex-xs="100"> <md-checkbox ng-model="criteria.showRevoked" aria-label="show revoked"> {{\'reception.application.showRevoked\' | translate}} </md-checkbox> </md-input-container> <md-input-container flex="30" flex-sm="100" flex-xs="100"> <md-checkbox ng-model="criteria.addedToDirective" aria-label="added to directive"> {{\'reception.application.showAddedToDirective\' | translate}} </md-checkbox> </md-input-container> <md-input-container flex="30" flex-sm="100" flex-xs="100"> <md-checkbox ng-model="criteria.archived" aria-label="archived"> {{\'reception.archive.displayArchived\' | translate}} </md-checkbox> </md-input-container> </div> <div layout="row"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> <md-button class="md-raised" ng-if="canEdit" ng-click="importFromCsvFile()">{{\'main.button.importFromCsvFile\' | translate}}</md-button> <a ng-href="{{classifiersFileUrl}}" class="md-button md-raised">{{\'main.button.classifiersFile\' | translate}}</a> <a ng-href="{{csvSampleFileUrl}}" class="md-button md-raised">{{\'main.button.csvSampleFile\' | translate}}</a> </div> <div flex-xs="0" flex-gt-xs="0" flex-gt-sm="50"></div> </form> </fieldset> </div> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="applicationNr">{{\'reception.application.nr\' | translate}}</th> <th md-column md-order-by="idcode">{{\'student.idcode\' | translate}}</th> <th md-column md-order-by="firstname">{{\'student.firstname\' | translate}}</th> <th md-column md-order-by="lastname">{{\'student.lastname\' | translate}}</th> <th md-column md-order-by="saisAdmissionCode">{{\'reception.admission.code\' | translate}}</th> <th md-column md-order-by="statusCode">{{\'reception.application.status\' | translate}}</th> <th md-column md-order-by="addedToDirective">{{\'reception.application.addedToDirective\' | translate}}</th> <th md-column md-order-by="is_archived">{{\'reception.archive.archived\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell><a ng-href="/#/reception/saisApplication/{{::row.id}}/view">{{::row.applicationNr}}</a></td> <td md-cell>{{::row.idcode}}</td> <td md-cell>{{::row.firstname}}</td> <td md-cell>{{::row.lastname}}</td> <td md-cell>{{::row.saisAdmissionCode}}</td> <td md-cell>{{currentLanguageNameField(row.status)}}</td> <td md-cell>{{(row.addedToDirective ? \'main.yes\' : \'main.no\') | translate}}</td> <td md-cell>{{row.archived ? (\'main.yes\' | translate) : (\'main.no\' | translate)}}</td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> </div>'),a.put("reception/reception.saisApplication.view.html",'<div class="ois-form-layout-padding form-readonly" ng-cloak> <div> <form> <div style="padding-top: 1em"> <div layout="column"> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex> <label>{{\'reception.application.nr\' | translate}}</label> <hois-value value="saisApplication.applicationNr"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'person.idcode\' | translate}}</label> <hois-value value="saisApplication.idcode"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex> <label>{{\'person.firstname\' | translate}}</label> <hois-value value="saisApplication.firstname"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'person.lastname\' | translate}}</label> <hois-value value="saisApplication.lastname"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex> <label>{{\'person.sex\' | translate}}</label> <hois-classifier-value ng-model="saisApplication.sex" main-classifier-code="SUGU"></hois-classifier-value> </md-input-container> <md-input-container flex> <label>{{\'student.residenceCountry\' | translate}}</label> <hois-classifier-value ng-model="saisApplication.residenceCountry" main-classifier-code="RIIK"></hois-classifier-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex> <label>{{\'student.citizenship\' | translate}}</label> <hois-classifier-value ng-model="saisApplication.citizenship" main-classifier-code="RIIK"></hois-classifier-value> </md-input-container> <md-input-container flex> <label>{{\'student.studyLanguage\' | translate}}</label> <hois-classifier-value ng-model="saisApplication.language" main-classifier-code="OPPEKEEL"></hois-classifier-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex> <label>{{\'reception.application.email\' | translate}}</label> <hois-value value="saisApplication.email"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'reception.application.address\' | translate}}</label> <hois-value value="getAddress(saisApplication.address, saisApplication.postcode)"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex> <label>{{\'student.phone\' | translate}}</label> <hois-value value="saisApplication.phone"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'reception.application.status\' | translate}}</label> <hois-classifier-value ng-model="saisApplication.status" main-classifier-code="SAIS_AVALDUSESTAATUS"></hois-classifier-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex> <label>{{\'student.studyForm\' | translate}}</label> <hois-classifier-value ng-model="saisApplication.studyForm" main-classifier-code="OPPEVORM"></hois-classifier-value> </md-input-container> <md-input-container ng-if="saisApplication.isHigher" flex> <label>{{\'student.studyLoad\' | translate}}</label> <hois-classifier-value ng-model="saisApplication.studyLoad" main-classifier-code="OPPEKOORMUS"></hois-classifier-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex> <label>{{\'reception.application.submissionDate\' | translate}}</label> <hois-value value="saisApplication.submitted | hoisDate"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'reception.application.changeDate\' | translate}}</label> <hois-value value="saisApplication.saisChanged | hoisDate"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex> <label>{{\'reception.admission.code\' | translate}}</label> <hois-value value="saisApplication.saisAdmissionCode"></hois-value> </md-input-container> </div> </div> <div layout="column"> <div layout="row" class="top-margin"> <h2>{{\'reception.application.graduationHistory\' | translate}} </h2> </div> <table md-table> <thead md-head> <tr md-row> <th md-column>{{\'school.label\' | translate}}</th> <th md-column>{{\'student.studyStart\' | translate}}</th> <th md-column>{{\'student.studyEnd\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row flex ng-repeat="graduatedSchool in saisApplication.graduatedSchools | orderBy: \'id\'" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{graduatedSchool.name}}</td> <td md-cell>{{graduatedSchool.startDate | hoisDate}}</td> <td md-cell>{{graduatedSchool.endDate | hoisDate}}</td> </tr> </tbody> </table> </div> <div layout="column"> <div layout="row" class="top-margin"> <h2>{{\'reception.application.gradesResults\' | translate}} </h2> </div> <table md-table> <thead md-head> <tr md-row> <th md-column>{{\'subject.name\' | translate}}</th> <th md-column>{{\'subject.type\' | translate}}</th> <th md-column>{{\'main.result\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="grade in saisApplication.grades | orderBy: \'id\'" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{grade.subjectName}}</td> <td md-cell>{{grade.subjectType}}</td> <td md-cell>{{grade.grade}}</td> </tr> </tbody> </table> </div> <div layout="column"> <div layout="row" class="top-margin"> <h2>{{\'reception.application.otherData\' | translate}} </h2> </div> <table md-table> <thead md-head> <tr md-row> <th md-column>{{\'main.name\' | translate}}</th> <th md-column>{{\'main.value\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="otherData in saisApplication.otherData | orderBy: \'id\'" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{otherData.otherDataName}}</td> <td md-cell>{{otherData.otherDataValue}}</td> </tr> </tbody> </table> </div> <br> <div layout="row"> <md-button ng-href="#/reception/saisApplication/search" class="md-raised">{{\'main.button.back\' | translate}}</md-button> <md-button ng-click="confirm()" ng-if="auth.isAdmin() && !saisApplication.relatedToDirective" class="md-raised">{{\'main.button.delete\' | translate}}</md-button> </div> </div> </form> </div> </div>'),a.put("remark/remark.edit.html",'<div class="ois-form-layout-padding" ng-cloak> <div flex> <form layout="column" name="remarkForm"> <div ng-if="!record.student" flex="45" flex-sm="100" flex-xs="100"> <hois-autocomplete ng-model="record.student" method="students" name="student" label="student.label" additional-query-params="{active: true, higher: false, studentGroupTeacher: teacherId}"></hois-autocomplete> </div> <div ng-if="record.student" layout="row" class="form-readonly"> <md-input-container class="label-only" flex> <label>{{\'student.label\' | translate}}</label> <hois-value value="record.student.nameEt" href-value="\'#/students/\' + record.student.id + \'/main\'"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container> <label>{{\'remark.date\' | translate}}</label> <md-datepicker ng-model="record.remarkDate" required></md-datepicker> </md-input-container> <md-input-container flex-offset="5"> <label>{{\'remark.time\' | translate}}</label> <hois-time ng-model="record.remarkTime" placeholder="{{\'main.timePlaceholder\' | translate}}"></hois-time> </md-input-container> </div> <div layout="row"> <md-input-container flex> <label>{{\'remark.reason\' | translate}}</label> <hois-classifier-select ng-model="record.reason" main-classifier-code="MARKUS" model-value-attr="code" required></hois-classifier-select> </md-input-container> </div> <div layout="row"> <md-input-container flex> <label>{{\'remark.label\' | translate}}</label> <textarea ng-model="record.remark" md-maxlength="4000" max-rows="5" required></textarea> </md-input-container> </div> <div layout="row" layout-xs="column"> <md-button class="md-raised md-primary" ng-click="update()">{{\'main.button.save\' | translate}}</md-button> <md-button class="md-raised" ng-if="record.id" ng-click="delete()">{{\'main.button.delete\' | translate}}</md-button> <md-button class="md-raised" ng-click="back(\'#/remarks/\', remarkForm)">{{\'main.button.back\' | translate}}</md-button> </div> </form> </div> </div>'),a.put("remark/remark.list.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <form name="searchForm" ng-submit="load()" novalidate> <fieldset tabindex="1"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <div flex layout="column"> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'remark.studyYear\' | translate}}</label> <hois-select ng-model="criteria.studyYear" values="formState.studyYears" required autofocus></hois-select> </md-input-container> <md-input-container flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'main.from\' | translate}}</label> <md-datepicker ng-model="criteria.from" md-max-date="criteria.thru" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> <md-input-container flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'main.thru\' | translate}}</label> <md-datepicker ng-model="criteria.thru" md-min-date="criteria.from" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label>{{\'remark.studentGroup\' | translate}}</label> <hois-select ng-model="criteria.studentGroup" ng-change="studentGroupChanged()" values="formState.studentGroups" aria-label="studentGroup"></hois-select> </md-input-container> <hois-autocomplete flex="50" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0" ng-model="criteria.studentObject" method="students" name="student" label="{{\'remark.student\'}}" additional-query-params="{studentGroup: criteria.studentGroup ? [criteria.studentGroup] : [], studentGroupTeacher: teacherId}"> </hois-autocomplete> </div> <div layout="row" flex> <md-input-container class="md-block"> <md-checkbox ng-model="criteria.showJournalRemarks" name="showJournalRemarks"> {{\'remark.showJournalRemarks\' | translate}}</md-checkbox> </md-input-container> </div> <div layout="row"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> <md-button class="md-raised" ng-if="isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_MARKUS\')" ng-href="#/remarks/new"> {{\'main.button.create\' | translate}}</md-button> </div> </div> </fieldset> </form> </div> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="lastname, firstname" width="15%">{{\'remark.student\' | translate}}</th> <th md-column md-order-by="student_group">{{\'remark.studentGroup\' | translate}}</th> <th md-column width="15%">{{\'remark.reason\' | translate}} / {{\'remark.journal\' | translate}}</th> <th md-column width="35%">{{\'remark.label\' | translate}}</th> <th md-column></th> <th md-column md-order-by="remark_time">{{\'remark.date\' | translate}}</th> <th md-column md-order-by="remark_inserted_by">{{\'remark.addedBy\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell> <a ng-href="{{row.id ? \'#/remarks/\' + row.id + \'/view\' : \'#/remarks/journal/\' + row.journalStudentEntryId + \'/view\'}}"> {{currentLanguageNameField(row.student)}} </a> </td> <td md-cell>{{row.studentGroup}}</td> <td md-cell> <span ng-if="row.reason">{{currentLanguageNameField(row.reason)}}</span> <a ng-if="row.journal" ng-href="#/journal/{{::row.journal.id}}/view">{{currentLanguageNameField(row.journal)}}</a> </td> <td md-cell> <span>{{row.remark | hoisLimitTo: 150:!row.showAll}}</span> </td> <td md-cell> <span class="custom-tooltip" ng-if="!row.showAll && row.remark.length > 150" ng-click="row.showAll = true">{{\'remark.showMore\' | translate}}</span> <span class="custom-tooltip" ng-if="row.showAll" ng-click="row.showAll = false">{{\'remark.showLess\' | translate}}</span> </td> <td md-cell>{{row.remarkDate | hoisDate}}</td> <td md-cell>{{row.remarkInsertedBy}}</td> <td md-cell> <md-button md-no-ink class="md-primary change-button" ng-if="isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_MARKUS\') && row.id" ng-href="#/remarks/{{::row.id}}/edit"> {{\'main.button.change\' | translate}}</md-button> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> </div>'),a.put("remark/remark.view.html",'<div class="ois-form-layout-padding" ng-cloak> <div flex class="form-readonly"> <form layout="column" name="remarkForm"> <div layout="row" class="form-readonly"> <md-input-container class="label-only" flex> <label>{{\'student.label\' | translate}}</label> <hois-value value="record.student.nameEt" href-value="\'#/students/\' + record.student.id + \'/main\'"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="10" flex-sm="100" flex-xs="100"> <label>{{\'remark.date\' | translate}}</label> <hois-value value="record.remarkDate | hoisDate"></hois-value> </md-input-container> <md-input-container flex="10" flex-sm="100" flex-xs="100" flex-offset="10" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'remark.time\' | translate}}</label> <hois-value value="record.remarkTime | hoisTime"></hois-value> </md-input-container> </div> <div layout="row"> <md-input-container flex ng-if="record.reason"> <label>{{\'remark.reason\' | translate}}</label> <hois-classifier-value ng-model="record.reason" main-classifier-code="MARKUS"></hois-classifier-value> </md-input-container> <md-input-container flex ng-if="record.journal"> <label>{{\'remark.reason\' | translate}}</label> <hois-value value="currentLanguageNameField(record.journal)" href-value="\'#/journal/\' + record.journal.id + \'/view\'"></hois-value> </md-input-container> </div> <div layout="row"> <md-input-container flex> <label>{{\'remark.label\' | translate}}</label> <hois-value value="record.remark"></hois-value> </md-input-container> </div> <div layout="row" layout-xs="column"> <md-button ng-if="record.id" class="md-raised md-primary" ng-href="#/remarks/{{record.id}}/edit">{{\'main.button.change\' | translate}}</md-button> <md-button class="md-raised" ng-click="back(\'#/remarks/\')">{{\'main.button.back\' | translate}}</md-button> </div> </form> </div> </div>'),a.put("report/curriculums.completion.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <form name="searchForm" ng-submit="searchForm.$valid && loadData()" novalidate ng-model-options="{allowInvalid: true}"> <div layout="row"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'report.curriculumscompletion.name\' | translate}}</label> <input ng-model="criteria.name" name="name" type="text" md-maxlength="255" autofocus> </md-input-container> <div flex="50" flex-offset="5"> <hois-autocomplete ha-controller="directiveControllers" ng-model="criteria.curriculumVersion" method="curriculumversions" label="report.curriculumscompletion.curriculum"></hois-autocomplete> </div> </div> <div layout="row" layout-sm="column" layout-xs="column"> <hois-autocomplete flex="45" ng-model="criteria.studentGroup" ha-attribute="id" ha-controller="directiveControllers" method="studentgroups" label="{{\'report.curriculumscompletion.studentgroup\'}}"></hois-autocomplete> <md-input-container flex="45" flex-offset="5" flex-sm="100" flex-xs="100"> <label>{{\'report.curriculumscompletion.studyForm\' | translate}}</label> <hois-classifier-select ng-model="criteria.studyForm" model-value-attr="code" main-classifier-code="OPPEVORM"></hois-classifier-select> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" ng-if="auth.higher"> <label>{{\'report.curriculumscompletion.studyLoad\' | translate}}</label> <hois-classifier-select ng-model="criteria.studyLoad" model-value-attr="code" main-classifier-code="OPPEKOORMUS"></hois-classifier-select> </md-input-container> </div> <div layout="row"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> <a ng-href="{{excel(formState.xlsUrl, criteria)}}" target="_blank" class="md-button md-raised">{{\'report.excel\' | translate}}</a> </div> <div flex-xs="0" flex-gt-xs="0" flex-gt-sm="50"></div> </form> </fieldset> </div> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="p.lastname,p.firstname">{{\'report.curriculumscompletion.name\' | translate}}</th> <th md-column md-order-by="cv.code">{{\'report.curriculumscompletion.curriculum\' | translate}}</th> <th md-column md-order-by="sg.code">{{\'report.curriculumscompletion.studentgroup\' | translate}}</th> <th md-column>{{\'report.curriculumscompletion.studyPeriodCount\' | translate}}</th> <th md-column>{{\'report.curriculumscompletion.studyYearCount\' | translate}}</th> <th md-column><span translate="report.curriculumscompletion.creditsLastStudyPeriod"></span></th> <th md-column><span translate="report.curriculumscompletion.credits"></span></th> <th md-column><span translate="report.curriculumscompletion.curriculumCompletion"></span></th> <th md-column ng-if="auth.higher">{{\'report.curriculumscompletion.studyLoad\' | translate}}</th> <th md-column>{{\'report.curriculumscompletion.studyForm\' | translate}}</th> <th md-column>{{\'report.curriculumscompletion.status\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell> <a md-no-ink class="md-primary" ng-href="#/students/{{::row.id}}/main">{{::row.fullName}}</a> </td> <td md-cell>{{currentLanguageNameField(row.curriculumVersion)}}</td> <td md-cell>{{::row.studentGroup}}</td> <td md-cell>{{::row.studyPeriodCount}}</td> <td md-cell>{{::row.studyYearCount}}</td> <td md-cell>{{::row.creditsLastStudyPeriod}}</td> <td md-cell>{{::row.credits}}</td> <td md-cell>{{::row.curriculumCompletion}}</td> <td md-cell ng-if="auth.higher">{{currentLanguageNameField(row.studyLoad)}}</td> <td md-cell>{{currentLanguageNameField(row.studyForm)}}</td> <td md-cell>{{currentLanguageNameField(row.status)}}</td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> </div>'),a.put("report/individual.curriculum.statistics.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <form name="searchForm" ng-submit="loadData()" ng-model-options="{allowInvalid: true}" novalidate> <div layout="row" layout-sm="column" layout-xs="column"> <div flex="45" flex-sm="100" flex-xs="100"> <hois-autocomplete ng-model="criteria.studentObject" method="students" ha-controller="directiveControllers" name="student" label="report.individualCurriculumStatistics.student" additional-query-params="{higher: false, studentGroupTeacher: teacherId}"> </hois-autocomplete> </div> <div ng-if="auth.isAdmin()" flex="50" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <hois-autocomplete ng-model="criteria.studentGroup" ha-attribute="id" ha-controller="directiveControllers" method="studentgroups" name="studentGroup" label="report.individualCurriculumStatistics.studentGroup" additional-query-params="{higher: false, studentGroupTeacherId: teacherId}"></hois-autocomplete> </div> <md-input-container ng-if="auth.isTeacher()" flex="50" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label class="textInput">{{\'report.individualCurriculumStatistics.studentGroup\' | translate}}</label> <md-select ng-model="criteria.studentGroup"> <md-option md-option-empty></md-option> <md-option ng-value="studentGroup.id" ng-repeat="studentGroup in formState.studentGroups | orderBy: currentLanguageNameField()"> {{currentLanguageNameField(studentGroup)}} </md-option> </md-select> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label>{{\'report.individualCurriculumStatistics.moduleName\' | translate}}</label> <input type="text" ng-model="criteria.moduleName" md-maxlength="255"> </md-input-container> <div flex="50" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <hois-autocomplete ng-model="criteria.curriculumVersion" ha-attribute="id" ha-controller="directiveControllers" method="curriculumversions" name="curriculumVersion" label="moduleProtocol.curriculumVersion" additional-query-params="{higher: false, closed: false}"></hois-autocomplete> </div> </div> <div layout="row"> <md-input-container> <label>{{\'main.from\' | translate}}</label> <md-datepicker ng-model="criteria.from" md-max-date="criteria.thru" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> <md-input-container flex-offset="5"> <label>{{\'main.thru\' | translate}}</label> <md-datepicker ng-model="criteria.thru" md-min-date="criteria.from" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> </div> <div layout="row"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> <md-button ng-href="{{excel(formState.xlsUrl, criteria)}}" class="md-button md-raised">{{\'main.button.printXls\'| translate}}</md-button> </div> <div flex-xs="0" flex-gt-xs="0" flex-gt-sm="50"></div> </form> </fieldset> </div> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="lastname, firstname">{{\'report.individualCurriculumStatistics.name\' | translate}}</th> <th md-column md-order-by="group_code">{{\'report.individualCurriculumStatistics.group\' | translate}}</th> <th md-column md-order-by="{{currentLanguage()===\'en\' ? \'cm_name_en\' : \'cm_name_et\'}}">{{\'report.individualCurriculumStatistics.module\' | translate}}</th> <th md-column>{{\'report.individualCurriculumStatistics.distinction\' | translate}}</th> <th md-column></th> <th md-column md-order-by="start_date, end_date" style="width: 150px">{{\'report.individualCurriculumStatistics.dates\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell> <a md-no-ink class="md-primary" ng-href="#/students/{{::row.studentId}}/main">{{::row.fullname}}</a> </td> <td md-cell>{{currentLanguageNameField(row.studentGroup)}}</td> <td md-cell>{{currentLanguageNameField(row.curriculumModule)}}</td> <td md-cell>{{row.addInfo ? (row.addInfo | hoisLimitTo: 100: !row.showAll) : \'-\'}}</td> <td md-cell> <span class="custom-tooltip" ng-if="!row.showAll && row.addInfo.length > 150" ng-click="row.showAll = true"> {{\'report.individualCurriculumStatistics.showMore\' | translate}}</span> <span class="custom-tooltip" ng-if="row.showAll" ng-click="row.showAll = false"> {{\'report.individualCurriculumStatistics.showLess\' | translate}}</span> </td> <td md-cell>{{row.startDate | hoisDate}} - {{row.endDate | hoisDate}}</td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> </div>'),
a.put("report/scholarship.statistics.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <form name="scholarshipStatisticExportForm" novalidate> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex> <label class="textInput">{{\'report.scholarships.types\' | translate}}</label> <md-select ng-model="criteria.types" multiple> <md-option ng-value="opt.code" ng-repeat="opt in types"> {{currentLanguageNameField(opt)}} </md-option> </md-select> </md-input-container> </div> <div layout="row"> <md-input-container> <label>{{\'report.scholarships.entriesFrom\' | translate}}</label> <md-datepicker ng-model="criteria.from" md-max-date="criteria.thru" required></md-datepicker> </md-input-container> <md-input-container flex-offset="5"> <label>{{\'report.scholarships.entriesThru\' | translate}}</label> <md-datepicker ng-model="criteria.thru" md-min-date="criteria.from" required></md-datepicker> </md-input-container> </div> <div layout="row"> <md-button ng-href="{{excel(url, criteria)}}" class="md-button md-primary md-raised" ng-disabled="!scholarshipStatisticExportForm || !scholarshipStatisticExportForm.$valid">{{\'main.button.printXls\' | translate}}</md-button> </div> <div flex-xs="0" flex-gt-xs="0" flex-gt-sm="50"></div> </form> </fieldset> </div> </div>'),a.put("report/student.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <form name="searchForm" ng-submit="searchForm.$valid && loadData()" ng-model-options="{allowInvalid: true}"> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'report.student.name\' | translate}}</label> <input ng-model="criteria.name" name="name" type="text" md-maxlength="255" autofocus> </md-input-container> <md-input-container flex="50" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label class="textInput">{{\'report.student.idcode\' | translate}}</label> <input ng-model="criteria.idcode" name="idcode" type="text" minlength="11" md-maxlength="11"> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <div layout="row" flex="45"> <md-input-container> <label>{{\'report.student.birthdate_from\' | translate}}</label> <md-datepicker ng-model="criteria.birthdateFrom" md-max-date="criteria.birthdateThru" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> <md-input-container flex-offset="5"> <label>{{\'report.student.birthdate_thru\' | translate}}</label> <md-datepicker ng-model="criteria.birthdateThru" md-min-date="criteria.birthdateFrom" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> </div> <div layout="row" flex="50" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <md-input-container> <label>{{\'report.student.studyStart_from\' | translate}}</label> <md-datepicker ng-model="criteria.studyStartFrom" md-max-date="criteria.studyStartThru" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> <md-input-container flex-offset="5"> <label>{{\'report.student.studyStart_thru\' | translate}}</label> <md-datepicker ng-model="criteria.studyStartThru" md-min-date="criteria.studyStartFrom" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> </div> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label>{{\'report.student.studyLevel\' | translate}}</label> <hois-classifier-select ng-model="criteria.studyLevel" model-value-attr="code" main-classifier-code="OPPEASTE"></hois-classifier-select> </md-input-container> <div flex="45" flex-offset="5"> <hois-autocomplete ng-model="criteria.curriculumVersion" ha-controller="directiveControllers" method="curriculumversions" label="report.student.curriculum" md-selected-item-change="curriculumVersionChanged"></hois-autocomplete> </div> </div> <div layout="row" layout-sm="column" layout-xs="column"> <hois-autocomplete flex="45" ng-model="criteria.studentGroup" ha-attribute="id" ha-controller="directiveControllers" ng-search-text="studentGroupName" method="studentgroups" name="studentGroup" label="{{\'report.student.studentGroup\'}}" additional-query-params="{curriculumVersionId: criteria.curriculumVersion.id}"></hois-autocomplete> <md-input-container flex="45" flex-offset="5" flex-sm="100" flex-xs="100" ng-if="auth.higher"> <label>{{\'report.student.studyLoad\' | translate}}</label> <hois-classifier-select ng-model="criteria.studyLoad" model-value-attr="code" main-classifier-code="OPPEKOORMUS"></hois-classifier-select> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45"> <label class="textInput">{{\'report.student.studyForm\' | translate}}</label> <hois-classifier-select ng-model="criteria.studyForm" model-value-attr="code" main-classifier-code="OPPEVORM"></hois-classifier-select> </md-input-container> <md-input-container flex="45" flex-offset="5" flex-sm="100" flex-xs="100"> <label>{{\'report.student.status\' | translate}}</label> <hois-classifier-select ng-model="criteria.status" model-value-attr="code" main-classifier-code="OPPURSTAATUS"></hois-classifier-select> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45"> <label class="textInput">{{\'report.student.fin\' | translate}}</label> <hois-classifier-select ng-model="criteria.fin" model-value-attr="code" main-classifier-code="FINALLIKAS"></hois-classifier-select> </md-input-container> <md-input-container flex="45" flex-offset="5" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'report.student.finSpecific\' | translate}}</label> <hois-classifier-select ng-model="criteria.finSpecific" model-value-attr="code" main-classifier-code="FINTAPSUSTUS"></hois-classifier-select> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45"> <label>{{\'report.student.language\' | translate}}</label> <hois-classifier-select ng-model="criteria.language" model-value-attr="code" main-classifier-code="OPPEKEEL"></hois-classifier-select> </md-input-container> <md-input-container flex="45" flex-offset="5" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'report.student.dormitory\' | translate}}</label> <hois-classifier-select ng-model="criteria.dormitory" model-value-attr="code" main-classifier-code="YHISELAMU"></hois-classifier-select> </md-input-container> </div> <div layout="row"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> <a ng-href="{{excel(formState.xlsUrl, criteria)}}" target="_blank" class="md-button md-raised">{{\'report.excel\' | translate}}</a> </div> <div flex-xs="0" flex-gt-xs="0" flex-gt-sm="50"></div> </form> </fieldset> </div> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="p.lastname,p.firstname">{{\'report.student.name\' | translate}}</th> <th md-column md-order-by="p.idcode">{{\'report.student.idcode\' | translate}}</th> <th md-column md-order-by="s.email">{{\'report.student.email\' | translate}}</th> <th md-column md-order-by="s.studyStart">{{\'report.student.studyStart\' | translate}}</th> <th md-column>{{\'report.student.studyLevel\' | translate}}</th> <th md-column md-order-by="cv.code">{{\'report.student.curriculum\' | translate}}</th> <th md-column md-order-by="c.merCode">{{\'report.student.merCode\' | translate}}</th> <th md-column md-order-by="sg.code">{{\'report.student.studentGroup\' | translate}}</th> <th md-column ng-if="auth.higher">{{\'report.student.studyLoad\' | translate}}</th> <th md-column>{{\'report.student.studyForm\' | translate}}</th> <th md-column>{{\'report.student.status\' | translate}}</th> <th md-column>{{\'report.student.fin\' | translate}}</th> <th md-column>{{\'report.student.finSpecific\' | translate}}</th> <th md-column>{{\'report.student.dormitory\' | translate}}</th> <th md-column>{{\'report.student.language\' | translate}}</th> <th md-column>{{\'report.student.credits\' | translate}}</th> <th md-column>{{\'report.student.occupationcertificate\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell> <a md-no-ink class="md-primary" ng-href="#/students/{{::row.id}}/main">{{::row.fullName}}</a> </td> <td md-cell>{{::row.idcode}}</td> <td md-cell>{{::row.email}}</td> <td md-cell>{{row.studyStart | hoisDate}}</td> <td md-cell>{{currentLanguageNameField(row.studyLevel)}}</td> <td md-cell>{{currentLanguageNameField(row.curriculumVersion)}}</td> <td md-cell>{{::row.merCode}}</td> <td md-cell>{{::row.studentGroup}}</td> <td md-cell ng-if="auth.higher">{{currentLanguageNameField(row.studyLoad)}}</td> <td md-cell>{{currentLanguageNameField(row.studyForm)}}</td> <td md-cell>{{currentLanguageNameField(row.status)}}</td> <td md-cell>{{currentLanguageNameField(row.fin)}}</td> <td md-cell>{{currentLanguageNameField(row.finSpecific)}}</td> <td md-cell>{{currentLanguageNameField(row.dormitory)}}</td> <td md-cell>{{currentLanguageNameField(row.language)}}</td> <td md-cell>{{::row.credits}}</td> <td md-cell> <div ng-repeat="cert in row.occupationCertificates"> <hr ng-if="!$first"> {{::cert.certificateNr}}&nbsp;{{currentLanguageNameField(cert.occupation)}} </div> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> </div>'),a.put("report/student.statistics.byperiod.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <form ng-submit="loadData()" novalidate ng-model-options="{allowInvalid: true}"> <div layout="row"> <div layout="row" flex="45"> <md-input-container> <label>{{\'main.from\' | translate}}</label> <md-datepicker ng-model="criteria.from" md-max-date="criteria.thru" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> <md-input-container flex-offset="5"> <label>{{\'main.thru\' | translate}}</label> <md-datepicker ng-model="criteria.thru" md-min-date="criteria.from" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> </div> </div> <div layout="row"> <div flex="45"> <hois-autocomplete ng-model="criteria.curriculum" ha-controller="directiveControllers" method="curriculums" label="report.studentstatisticsbyperiod.curriculum" multiple></hois-autocomplete> </div> <md-input-container flex="50" flex-offset="5"> <label>{{\'report.studentstatisticsbyperiod.result\' | translate}}</label> <md-select ng-model="criteria.result"> <md-option md-option-empty></md-option> <md-option value="OPPURSTAATUS_A">{{\'report.studentstatisticsbyperiod.OPPURSTAATUS_A\' | translate}}</md-option> <md-option value="OPPURSTAATUS_K">{{\'report.studentstatisticsbyperiod.OPPURSTAATUS_K\' | translate}}</md-option> <md-option value="OPPURSTAATUS_L">{{\'report.studentstatisticsbyperiod.OPPURSTAATUS_L\' | translate}}</md-option> </md-select> </md-input-container> </div> <div layout="row"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> <a ng-href="{{excel(formState.xlsUrl, criteria)}}" target="_blank" class="md-button md-raised">{{\'report.excel\' | translate}}</a> </div> <div flex-xs="0" flex-gt-xs="0" flex-gt-sm="50"></div> </form> </fieldset> </div> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="c.merCode">{{\'report.studentstatisticsbyperiod.merCode\' | translate}}</th> <th md-column md-order-by="{{currentLanguage() === \'en\' ? \'c.nameEn\' : \'c.nameEt\'}}">{{\'report.studentstatisticsbyperiod.curriculum\' | translate}}</th> <th md-column md-numeric ng-if="formState.resultType !== \'OPPURSTAATUS_L\'" ng-repeat="cl in formState.resultDef">{{currentLanguageNameField(cl)}}</th> <th md-column md-numeric>{{formState.resultType === \'OPPURSTAATUS_L\' ? \'report.studentstatisticsbyperiod.finished\' : \'report.studentstatisticsbyperiod.total\' | translate}}</th> <th md-column md-numeric ng-if="formState.resultType === \'OPPURSTAATUS_L\'">{{auth.higher ? \'report.studentstatisticsbyperiod.isCumLaude\' : \'report.studentstatisticsbyperiod.isCumLaudeVoc\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{row.merCode}}</td> <td md-cell>{{currentLanguageNameField(row)}}</td> <td md-cell ng-if="formState.resultType !== \'OPPURSTAATUS_L\'" ng-repeat="cl in formState.resultDef">{{::row.result[cl.code] || 0}}</td> <td md-cell>{{::row.total}}</td> <td md-cell ng-if="formState.resultType === \'OPPURSTAATUS_L\'">{{::row.result[\'true\'] || 0}}</td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> </div>'),a.put("report/student.statistics.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <form name="searchForm" ng-submit="load()" novalidate ng-model-options="{allowInvalid: true}"> <div layout="row"> <div layout="row" flex="45"> <md-input-container> <label>{{\'main.date\' | translate}}</label> <md-datepicker ng-model="criteria.date" required hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> </div> </div> <div layout="row"> <div flex="45"> <hois-autocomplete ng-model="criteria.curriculum" ha-controller="directiveControllers" method="curriculums" label="report.studentstatistics.curriculum" multiple></hois-autocomplete> </div> <md-input-container flex="50" flex-offset="5"> <label>{{\'report.studentstatistics.result\' | translate}}</label> <md-select ng-model="criteria.result"> <md-option md-option-empty></md-option> <md-option value="FINALLIKAS">{{\'report.studentstatistics.FINALLIKAS\' | translate}}</md-option> <md-option value="OPPEVORM">{{\'report.studentstatistics.OPPEVORM\' | translate}}</md-option> <md-option value="OPPURSTAATUS">{{\'report.studentstatistics.OPPURSTAATUS\' | translate}}</md-option> </md-select> </md-input-container> </div> <div layout="row"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> <a ng-href="{{excel(formState.xlsUrl, savedCriteria)}}" target="_blank" class="md-button md-raised">{{\'report.excel\' | translate}}</a> </div> <div flex-xs="0" flex-gt-xs="0" flex-gt-sm="50"></div> </form> </fieldset> </div> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="c.merCode">{{\'report.studentstatistics.merCode\' | translate}}</th> <th md-column md-order-by="{{currentLanguage() === \'en\' ? \'c.nameEn\' : \'c.nameEt\'}}">{{\'report.studentstatistics.curriculum\' | translate}}</th> <th md-column md-numeric ng-repeat="cl in formState.resultDef">{{currentLanguageNameField(cl)}}</th> <th md-column md-numeric>{{\'report.studentstatistics.total\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{row.merCode}}</td> <td md-cell>{{currentLanguageNameField(row)}}</td> <td md-cell ng-repeat="cl in formState.resultDef">{{::row.result[cl.code] || 0}}</td> <td md-cell>{{::row.total}}</td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> </div>'),a.put("report/studentgroup.teacher.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <form name="studentGroupTeacherReportForm" novalidate> <div layout="row" layout-sm="column" layout-xs="column"> <hois-autocomplete ng-if="auth.isAdmin()" flex="45" flex-sm="100" flex-xs="100" ng-model="formState.studentGroup" ha-controller="directiveControllers" md-selected-item-change="studentGroupChanged()" method="studentgroups" name="studentGroup" label="{{\'report.studentGroupTeacher.studentGroup\'}}" additional-query-params="{valid: true, higher: false, studentGroupTeacherId: teacherId}" required></hois-autocomplete> <md-input-container ng-if="auth.isTeacher()" flex="45" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'report.studentGroupTeacher.studentGroup\' | translate}}</label> <md-select ng-model="formState.studentGroup" ng-change="studentGroupChanged()" ng-model-options="{trackBy: \'$value.id\'}" required> <md-option ng-value="studentGroup" ng-repeat="studentGroup in formState.studentGroups | orderBy: currentLanguageNameField()"> {{currentLanguageNameField(studentGroup)}} </md-option> </md-select> </md-input-container> <hois-autocomplete flex="50" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-sm="0" flex-offset-xs="0" ng-model="formState.student" ng-disabled="!criteria.studentGroup" ha-controller="directiveControllers" md-selected-item-change="studentChanged()" method="students" name="student" label="{{\'report.studentGroupTeacher.student\'}}" additional-query-params="{studentGroup: criteria.studentGroup ? [criteria.studentGroup] : []}"></hois-autocomplete> </div> <div ng-show="formState.showAllParameters" layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'report.studentGroupTeacher.studyYear\' | translate}}</label> <hois-select ng-model="criteria.studyYear" values="formState.studyYears"></hois-select> </md-input-container> <md-input-container flex="50" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-sm="0" flex-offset-xs="0"> <label class="textInput">{{\'report.studentGroupTeacher.studyPeriod\' | translate}}</label> <md-select ng-model="formState.studyPeriod" ng-change="studyPeriodChanged()" ng-model-options="{trackBy: \'$value.id\'}"> <md-option md-option-empty></md-option> <md-option ng-value="period" ng-repeat="period in criteria.studyYear ? formState.studyPeriods[criteria.studyYear] : formState.allStudyPeriods | orderBy: currentLanguageNameField()"> {{currentLanguageNameField(period)}} </md-option> </md-select> </md-input-container> </div> <div ng-show="formState.showAllParameters" layout="row"> <md-input-container> <label>{{\'report.studentGroupTeacher.entriesFrom\' | translate}}</label> <md-datepicker ng-model="criteria.from" md-max-date="criteria.thru" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> <md-input-container flex-offset="5"> <label>{{\'report.studentGroupTeacher.entriesThru\' | translate}}</label> <md-datepicker ng-model="criteria.thru" md-min-date="criteria.from" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> </div> <div ng-show="formState.showAllParameters" layout="row" layout-md="column" layout-sm="column" layout-xs="column"> <md-checkbox ng-repeat="entryType in entryTypes | orderBy: getEntryTypeOrderNr" ng-model="criteria.entryType[entryType.code]" ng-change="entryTypeChanged()" aria-label="{{\'directive.student.foreign\' | translate}}"> <span ng-if="getEntryColor(entryType.code)" md-colors="{color: getEntryColor(entryType.code)}">{{currentLanguageNameField(entryType)}}</span> <span ng-if="!getEntryColor(entryType.code)">{{currentLanguageNameField(entryType)}}</span> </md-checkbox> </div> <div hide-gt-md>&nbsp;</div> <div ng-show="formState.showAllParameters" layout="row" layout-md="column" layout-sm="column" layout-xs="column"> <md-checkbox ng-model="criteria.moduleGrade" ng-disabled="criteria.onlyModuleGrades" aria-label="{{\'report.studentGroupTeacher.moduleGrade\' | translate}}"> {{\'report.studentGroupTeacher.moduleGrade\' | translate}} </md-checkbox> <md-checkbox ng-model="criteria.absencesPerJournals" aria-label="{{\'report.studentGroupTeacher.absencesPerJournals\' | translate}}"> {{\'report.studentGroupTeacher.absencesPerJournals\' | translate}} </md-checkbox> <md-checkbox ng-model="criteria.journalsWithEntries" ng-disabled="criteria.negativeResults" aria-label="{{\'report.studentGroupTeacher.journalsWithEntries\' | translate}}"> {{\'report.studentGroupTeacher.journalsWithEntries\' | translate}} </md-checkbox> <md-checkbox ng-model="criteria.negativeResults" ng-change="negativeResultsChanged()" aria-label="{{\'report.studentGroupTeacher.negativeResults\' | translate}}"> {{\'report.studentGroupTeacher.negativeResults\' | translate}} </md-checkbox> <md-checkbox ng-model="criteria.averageGrade" aria-label="{{\'report.studentGroupTeacher.averageGrade\' | translate}}"> {{\'report.studentGroupTeacher.averageGrade\' | translate}} </md-checkbox> <md-checkbox ng-model="criteria.weightedAverageGrade" aria-label="{{\'report.studentGroupTeacher.showWeightedAverageGrade\' | translate}}"> {{\'report.studentGroupTeacher.showWeightedAverageGrade\' | translate}} </md-checkbox> </div> <div ng-show="formState.showAllParameters"> <md-checkbox ng-model="criteria.onlyModuleGrades" ng-change="onlyModuleGradesChanged()" aria-label="{{\'report.studentGroupTeacher.showOnlyModuleGrades\' | translate}}"> {{\'report.studentGroupTeacher.showOnlyModuleGrades\' | translate}} </md-checkbox> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-button class="md-raised md-primary" ng-click="search()">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> <md-button ng-href="{{pdf(formState.pdfUrl, criteria)}}" class="md-button md-raised" ng-disabled="!criteria.studentGroup || (!criteria.studyYear && !criteria.from)">{{\'report.studentGroupTeacher.printPdf\' | translate}}</md-button> <md-button ng-href="{{excel(formState.xlsUrl, criteria)}}" class="md-button md-raised" ng-disabled="!criteria.studentGroup || (!criteria.studyYear && !criteria.from)">{{\'report.studentGroupTeacher.printXls\' | translate}}</md-button> <md-button ng-href="{{pdf(formState.negativeResultsPdfUrl, criteria)}}" class="md-button md-raised" ng-disabled="!criteria.studentGroup || (!criteria.studyYear && !criteria.from)">{{\'report.studentGroupTeacher.printNegativeResultsPdf\' | translate}}</md-button> <md-button ng-href="{{excel(formState.negativeResultsXlsUrl, criteria)}}" class="md-button md-raised" ng-disabled="!criteria.studentGroup || (!criteria.studyYear && !criteria.from)">{{\'report.studentGroupTeacher.printNegativeResultsXls\' | translate}}</md-button> <a ng-click="toggleShowAllParameters()" style="margin-top: 20px"> {{formState.showAllParameters ? (\'report.studentGroupTeacher.lessParameters\' | translate) : (\'report.studentGroupTeacher.moreParameters\' | translate)}} </a> </div> <div flex-xs="0" flex-gt-xs="0" flex-gt-sm="50"></div> </form> </fieldset> </div> </div> <div layout-padding ng-if="record"> <div layout="row"> <div class="common-label" flex> <i>{{\'journal.absencesLegend\' | translate}}</i> </div> <div class="common-label" flex> <i> <span>{{\'student.statuses.academicLeaveShort\' | translate}} - {{\'student.statuses.academicLeave\' | translate}}, </span> <span>{{\'student.statuses.individualCurriculumShort\' | translate}} - {{\'student.statuses.individualCurriculum\' | translate}}, </span> <span>{{\'student.statuses.exmatriculatedShort\' | translate}} - {{\'student.statuses.exmatriculated\' | translate}}, </span> <span>{{\'student.statuses.finishedShort\' | translate}} - {{\'student.statuses.finished\' | translate}}</span> </i> </div> </div> <div flex class="student-group-teacher-container"> <div class="container" fixed-column-table fixed-columns="1" resize-table search-criteria-height="{{formState.showAllParameters ? 550 : 350}}"> <div ng-if="!record.showOnlyModuleGrades" ng-include="\'report/studentgroup.teacher.table.html\'"></div> <div ng-if="record.showOnlyModuleGrades" ng-include="\'report/studentgroup.teacher.module.table.html\'"></div> </div> </div> </div> <style>/* Mozilla Firefox Bug 688556: `border-collapse: collapse` shows a table without borders (if there is position relative or transform on cells) */\r\n  @-moz-document url-prefix() {\r\n    table {\r\n        border-collapse: separate !important;\r\n    }\r\n  }</style>'),a.put("report/studentgroup.teacher.module.table.html",'<table ng-if="record.moduleTypes.length > 0" class="tertiary-table student-group-teacher-table"> <thead> <tr> <th></th> <th ng-repeat="type in record.moduleTypes" colspan="{{type.colspan}}"> <hois-classifier-value ng-model="type.code" main-classifier-code="KUTSEMOODUL"></hois-classifier-value> </th> </tr> <tr> <th>{{\'report.studentGroupTeacher.studentName\' | translate}}</th> <th ng-repeat="module in record.modules" colspan="{{module.colspan}}"> {{currentLanguageNameField(module) | hoisLimitTo: 10}} <md-tooltip class="tooltip-multiline">{{currentLanguageNameField(module)}}</md-tooltip> </th> </tr> </thead> <tbody> <tr ng-repeat="row in record.students" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td> <div> <i> <span ng-if="row.status === \'OPPURSTAATUS_A\'">{{\'student.statuses.academicLeaveShort\' | translate}}</span> <span ng-if="row.status === \'OPPURSTAATUS_L\'">{{\'student.statuses.finishedShort\' | translate}}</span> <span ng-if="row.status === \'OPPURSTAATUS_K\'">{{\'student.statuses.exmatriculatedShort\' | translate}}</span> <span ng-if="row.isIndividualCurriculum"> <span ng-if="row.status !== \'OPPURSTAATUS_O\' && row.status !== \'OPPURSTAATUS_V\'">, </span> <span>{{\'student.statuses.individualCurriculumShort\' | translate}}</span> </span> </i> <span>{{row.fullname}}</span> <a ng-if="row.remarks.length > 0" ng-click="openRemarkDialog(row)"> <md-icon class="md-icon-button">message</md-icon> </a> </div> </td> <td ng-repeat="resultColumn in row.resultColumns" md-colors="!resultColumn.moduleResult.itendedModule ? {background: \'deep-orange-100\'} : null"> <div> <div ng-class="{badResult: !gradeUtil.isPositive(resultColumn.moduleResult.grade.code)}">{{resultColumn.moduleResult.grade.value}}</div> <md-tooltip> <span>{{resultColumn.moduleGrade.gradeInserted ? (resultColumn.moduleGrade.gradeInserted | hoisDate) : \'-\'}}</span> </md-tooltip> </div> </td> </tr> </tbody> </table>'),a.put("report/studentgroup.teacher.remark.dialog.html",'<md-dialog aria-label="comment edit dialog" flex="50" flex-sm="50" flex-xs="100"> <md-toolbar> <div class="md-toolbar-tools"> <h2>{{student.fullname}} {{"report.studentGroupTeacher.remarks" | translate}}</h2> <span flex></span> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <div layout-padding> <md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'report.studentGroupTeacher.reason\' | translate}} / {{\'report.studentGroupTeacher.journal\' | translate}}</th> <th md-column>{{\'report.studentGroupTeacher.remark\' | translate}}</th> <th md-column></th> <th md-column>{{\'report.studentGroupTeacher.date\' | translate}}</th> <th md-column>{{\'report.studentGroupTeacher.addedBy\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in student.remarks | orderBy: [\'-remarkDate\', \'-remarkTime\']" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell> <span ng-if="row.reason"> <hois-classifier-value ng-model="row.reason" main-classifier-code="MARKUS"></hois-classifier-value> </span> <span ng-if="row.journal">{{currentLanguageNameField(row.journal)}}</span> </td> <td md-cell> <span>{{row.remark | hoisLimitTo: 150:!row.showAll}}</span> </td> <td md-cell> <span class="custom-tooltip" ng-if="!row.showAll && row.remark.length > 150" ng-click="row.showAll = true"> {{\'report.studentGroupTeacher.showMore\' | translate}} </span> <span class="custom-tooltip" ng-if="row.showAll" ng-click="row.showAll = false"> {{\'report.studentGroupTeacher.showLess\' | translate}} </span> </td> <td md-cell>{{row.remarkDate | hoisDate}} {{row.remarkTime | hoisTime}}</td> <td md-cell>{{row.remarkInsertedBy}}</td> </tr> </tbody> </table> </md-table-container> </div> </md-dialog-content> <span flex></span> <md-dialog-actions layout="row" layout-align="start center"> <md-button class="md-raised" ng-click="cancel()">{{"main.button.close" | translate}}</md-button> </md-dialog-actions> </md-dialog>'),a.put("report/studentgroup.teacher.table.html",'<table class="tertiary-table student-group-teacher-table"> <thead> <tr> <th></th> <th ng-repeat="type in record.moduleTypes" colspan="{{type.colspan}}"> <hois-classifier-value ng-model="type.code" main-classifier-code="KUTSEMOODUL"></hois-classifier-value> </th> <th colspan="{{tableTotalColumnsColspan}}"></th> </tr> <tr> <th></th> <th ng-repeat="module in record.modules" colspan="{{module.colspan}}"> {{currentLanguageNameField(module) | hoisLimitTo: 10}} <md-tooltip class="tooltip-multiline">{{currentLanguageNameField(module)}}</md-tooltip> </th> <th colspan="{{tableTotalColumnsColspan}}"> <span ng-if="record.averageGrade">{{\'report.studentGroupTeacher.studentAverageGrade\' | translate}}: {{record.averageGrade}}</span> </th> </tr> <tr> <th>{{\'report.studentGroupTeacher.studentName\' | translate}}</th> <th ng-repeat="column in record.resultColumns"> <span ng-if="column.journal"> <a ng-href="#/journal/{{column.journal.id}}/view" class="md-primary change-button"> {{currentLanguageNameField(column.journal) | hoisLimitTo: 10}}</a> <md-tooltip class="tooltip-multiline">{{currentLanguageNameField(column.journal)}}</md-tooltip> </span> <span ng-if="column.module">M</span> <span ng-if="column.practiceModuleTheme"> <span>{{currentLanguageNameField(column.practiceModuleTheme) | hoisLimitTo: 10}}</span> <md-tooltip class="tooltip-multiline">{{currentLanguageNameField(column.practiceModuleTheme)}}</md-tooltip> </span> <span ng-if="column.fullPracticeModule">{{\'report.studentGroupTeacher.wholePracticeModule\' | translate}}</span> </th> <th>{{\'report.studentGroupTeacher.journalEntryLessons\' | translate}}</th> <th>{{\'report.studentGroupTeacher.totalAbsences\' | translate}}</th> <th>{{\'report.studentGroupTeacher.totalAbsencesPercentage\' | translate}}</th> <th>{{\'report.studentGroupTeacher.withoutReasonAbsences\' | translate}}</th> <th>{{\'report.studentGroupTeacher.withReasonAbsences\' | translate}}</th> <th>{{\'report.studentGroupTeacher.beingLate\' | translate}}</th> <th ng-if="record.showAverageGrade">{{\'report.studentGroupTeacher.averageGrade\' | translate}}</th> <th ng-if="record.showWeightedAverageGrade">{{\'report.studentGroupTeacher.weightedAverageGrade\' | translate}}</th> </tr> </thead> <tbody> <tr ng-repeat="row in record.students" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td> <div> <i> <span ng-if="row.status === \'OPPURSTAATUS_A\'">{{\'student.statuses.academicLeaveShort\' | translate}}</span> <span ng-if="row.status === \'OPPURSTAATUS_L\'">{{\'student.statuses.finishedShort\' | translate}}</span> <span ng-if="row.status === \'OPPURSTAATUS_K\'">{{\'student.statuses.exmatriculatedShort\' | translate}}</span> <span ng-if="row.isIndividualCurriculum"> <span ng-if="row.status !== \'OPPURSTAATUS_O\' && row.status !== \'OPPURSTAATUS_V\'">, </span> <span>{{\'student.statuses.individualCurriculumShort\' | translate}}</span> </span> </i> <span>{{row.fullname}}</span> <a ng-if="row.remarks.length > 0" ng-click="openRemarkDialog(row)"> <md-icon class="md-icon-button">message</md-icon> </a> </div> </td> <td ng-repeat="resultColumn in row.resultColumns" md-colors="resultColumn.journalResult && !resultColumn.journalResult.existsInJournal ? {background: \'deep-orange-100\'} : null"> <div ng-if="resultColumn.journalResult" layout="row"> <div ng-repeat="result in resultColumn.journalResult.results"> <span ng-if="!gradeUtil.isPositive(result.grade.code)" class="badResult">{{result.grade.value}}</span> <span ng-if="gradeUtil.isPositive(result.grade.code) && entryTypeColors[result.entryType.code]" md-colors="{color: getEntryColor(result.entryType.code)}">{{result.grade.value}}</span> <span ng-if="gradeUtil.isPositive(result.grade.code) && !entryTypeColors[result.entryType.code]">{{result.grade.value}}</span> <md-tooltip class="tooltip-multiline"> <span>{{result.gradeInserted ? (result.gradeInserted | hoisDate) : \'-\'}},</span> <span>{{result.gradeInsertedBy}},</span> <span>{{currentLanguageNameField(result.entryType)}}</span> <br> <span ng-if="entry.addInfo">{{result.addInfo}}</span> </md-tooltip> </div> <div ng-if="resultColumn.journalResult.absenceTotals[\'PUUDUMINE_H\']"> <span>H: {{resultColumn.journalResult.absenceTotals[\'PUUDUMINE_H\']}}</span> <md-tooltip class="tooltip-multiline"> <span ng-repeat="(date, dateAbsences) in resultColumn.journalResult.absencesByDate[\'PUUDUMINE_H\']"> <div>{{date | hoisDate}}, {{dateAbsences}}</div> </span> </md-tooltip> </div> <div ng-if="resultColumn.journalResult.absenceTotals[\'PUUDUMINE_P\']"> <span>P: {{resultColumn.journalResult.absenceTotals[\'PUUDUMINE_P\']}}</span> <md-tooltip class="tooltip-multiline"> <span ng-repeat="(date, dateAbsences) in resultColumn.journalResult.absencesByDate[\'PUUDUMINE_P\']"> <div>{{date | hoisDate}}, {{dateAbsences}}</div> </span> </md-tooltip> </div> <div ng-if="resultColumn.journalResult.absenceTotals[\'PUUDUMINE_V\']"> <span>V: {{resultColumn.journalResult.absenceTotals[\'PUUDUMINE_V\']}}</span> <md-tooltip class="tooltip-multiline"> <span ng-repeat="(date, dateAbsences) in resultColumn.journalResult.absencesByDate[\'PUUDUMINE_V\']"> <div>{{date | hoisDate}}, {{dateAbsences}}</div> </span> </md-tooltip> </div> <div ng-if="resultColumn.journalResult.absenceTotals[\'PUUDUMINE_PR\']"> <span>PR: {{resultColumn.journalResult.absenceTotals[\'PUUDUMINE_PR\']}}</span> <md-tooltip class="tooltip-multiline"> <span ng-repeat="(date, dateAbsences) in resultColumn.journalResult.absencesByDate[\'PUUDUMINE_PR\']"> <div>{{date | hoisDate}}, {{dateAbsences}}</div> </span> </md-tooltip> </div> </div> <div ng-if="resultColumn.practiceModuleThemeResult"> <div ng-class="{badResult: !gradeUtil.isPositive(resultColumn.practiceModuleThemeResult.grade.code)}">{{resultColumn.practiceModuleThemeResult.grade.value}}</div> <md-tooltip> <span>{{resultColumn.practiceModuleThemeResult.gradeInserted ? (resultColumn.practiceModuleThemeResult.gradeInserted | hoisDate) : \'-\'}}</span> </md-tooltip> </div> <div ng-if="resultColumn.practiceModuleResult"> <div ng-class="{badResult: !gradeUtil.isPositive(resultColumn.practiceModuleResult.grade.code)}">{{resultColumn.practiceModuleResult.grade.value}}</div> <md-tooltip> <span>{{resultColumn.practiceModuleResult.gradeInserted ? (resultColumn.practiceModuleResult.gradeInserted | hoisDate) : \'-\'}}</span> </md-tooltip> </div> <div ng-if="resultColumn.moduleResult"> <div ng-class="{badResult: !gradeUtil.isPositive(resultColumn.moduleResult.grade.code)}">{{resultColumn.moduleResult.grade.value}}</div> <md-tooltip> <span>{{resultColumn.moduleGrade.gradeInserted ? (resultColumn.moduleGrade.gradeInserted | hoisDate) : \'-\'}}</span> </md-tooltip> </div> </td> <td>{{row.journalEntryLessons}}</td> <td>{{row.totalAbsences}}</td> <td>{{row.lessonAbsencePercentage}}</td> <td>{{row.withoutReasonAbsences}}</td> <td>{{row.withReasonAbsences}}</td> <td>{{row.beingLate}}</td> <td ng-if="record.showAverageGrade">{{row.averageGrade}}</td> <td ng-if="record.showWeightedAverageGrade">{{row.weightedAverageGrade}}</td> </tr> </tbody> </table>'),
a.put("report/teachers.detail.load.higher.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <form name="searchForm" ng-submit="loadData()" novalidate> <div layout="row"> <md-input-container flex="30" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'report.teachersDetailLoad.studyYear\' | translate}}</label> <hois-select ng-model="criteria.studyYear" values="formState.studyYears" required></hois-select> </md-input-container> <md-input-container flex="30" flex-offset="5" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'report.teachersDetailLoad.studyPeriod\' | translate}}</label> <hois-select ng-model="criteria.studyPeriod" ng-change="studyPeriodChanged()" values="formState.studyPeriods[criteria.studyYear]"></hois-select> </md-input-container> <div flex="30" flex-offset="5" flex-sm="100" flex-xs="100"> <hois-autocomplete ng-model="criteria.teacher" ha-controller="directiveControllers" ha-attribute="id" method="teachers" additional-query-params="{valid: true, higher: true}" label="teacher.labelHigher"></hois-autocomplete> </div> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-checkbox flex="15" flex-md="30" flex-sm="100" flex-xs="100" ng-model="criteria.byCapacities" aria-label="{{\'report.teachersDetailLoad.byCapacities\' | translate}}"> {{\'report.teachersDetailLoad.byCapacities\' | translate}} </md-checkbox> <md-checkbox flex="15" flex-md="30" flex-sm="100" flex-xs="100" ng-model="criteria.showPlannedLessons" aria-label="{{\'report.teachersDetailLoad.showPlannedLessons\' | translate}}"> {{\'report.teachersDetailLoad.showPlannedLessons\' | translate}} </md-checkbox> <md-checkbox flex="15" flex-md="30" flex-sm="100" flex-xs="100" ng-model="criteria.showSingleEvents" aria-label="{{\'report.teachersDetailLoad.showSingleEvents\' | translate}}"> {{\'report.teachersDetailLoad.showSingleEvents\' | translate}} </md-checkbox> </div> <div layout="row"> <md-button class="md-raised md-primary" type="submit">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> <md-button ng-href="{{excelUrl()}}" ng-disabled="!criteria.studyYear" class="md-button md-raised">{{\'main.button.printXls\'| translate}}</md-button> </div> <div flex-xs="0" flex-gt-xs="0" flex-gt-sm="50"></div> </form> </fieldset> </div> </div> <div layout-padding ng-if="reportData"> <div layout="column" layout-align="start"> <div flex layout="row"> <div layout="row" class="common-label" md-colors="{color: \'background-400\'}"> <span ng-repeat="c in reportData.teacherCapacities"> <span ng-if="!$first">|</span> <span>{{::c.value.toUpperCase()}} - {{currentLanguageNameField(c)}}</span> </span> <span ng-if="entriesWithoutCapacity"> <span>|</span> <span> ? - {{\'report.teachersDetailLoad.capacityMissing\' | translate}}</span> </span> </div> </div> </div> <div flex> <div ng-include="\'report/teachers.detail.load.table.higher.tmpl.html\'"></div> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> </div>'),a.put("report/teachers.detail.load.table.higher.tmpl.html",'<div ng-if="periodCapacitiesRow" class="tertiary-table-container" fixed-column-table fixed-columns="{{reportData.byStudyPeriods ? 2 : 1}}"> <table class="tertiary-table detail-load-table"> <thead> <tr> <th class="dividerBorder" colspan="{{reportData.byStudyPeriods ? 2 : 1}}"></th> <!-- PERIODS --> <th colspan="{{periodColspan}}" class="dividerBorder" ng-repeat="sp in reportData.studyPeriods"> {{currentLanguageNameField(sp)}} ({{sp.startDate | hoisDayMonth}}-{{sp.endDate | hoisDayMonth}})</th> <!-- TOTALS --> <th colspan="{{totalsColspan}}" class="dividerBorder">{{\'report.teachersDetailLoad.total\' | translate}}</th> </tr> <tr> <th class="dividerBorder" colspan="{{reportData.byStudyPeriods ? 2 : 1}}"></th> <!-- PERIODS --> <th colspan="{{column.colspan}}" ng-repeat="column in periodTypesRow" class="fix" ng-class="{dividerBorder: column.divider}"> <span ng-if="column.plannedLessons">{{\'report.teachersDetailLoad.planned\' | translate}}</span> <span ng-if="column.timetableOccurredLessons">{{\'report.teachersDetailLoad.occurred\' | translate}}</span> </th> <!-- TOTALS --> <th ng-if="reportData.criteria.showPlannedLessons" colspan="{{plannedLessonsColspan}}">{{\'report.teachersDetailLoad.planned\' | translate}}</th> <th colspan="{{timetableOccurredLessonsColspan + 1}}" class="dividerBorder">{{\'report.teachersDetailLoad.occurred\' | translate}}</th> </tr> <tr> <th ng-class="{dividerBorder: reportData.byTeachers}"> <span ng-if="reportData.byTeachers">{{\'teacher.labelHigher\' | translate}}</span> <span ng-if="reportData.byStudyPeriods">{{\'report.teachersDetailLoad.subject\' | translate}}</span> </th> <!-- PERIODS --> <th ng-if="reportData.byStudyPeriods" class="dividerBorder">{{\'report.teachersDetailLoad.studentGroups\' | translate}}</th> <th ng-repeat="column in periodCapacitiesRow track by $index" ng-class="{dividerBorder: column.divider}"> <span ng-if="column.value">{{column.value.toUpperCase()}}</span> <span ng-if="column.name">{{\'report.teachersDetailLoad.\' + column.name | translate}}</span> </th> <!-- TOTALS --> <th ng-if="!reportData.criteria.byCapacities && reportData.criteria.showPlannedLessons">{{\'report.teachersDetailLoad.study\' | translate}}</th> <th ng-if="!reportData.criteria.byCapacities">{{\'report.teachersDetailLoad.study\' | translate}}</th> <th ng-if="reportData.criteria.byCapacities && reportData.criteria.showPlannedLessons" ng-repeat="c in reportData.teacherCapacities">{{c.value.toUpperCase()}}</th> <th ng-if="reportData.criteria.byCapacities" ng-repeat="c in reportData.teacherCapacities">{{c.value.toUpperCase()}}</th> <th ng-if="reportData.criteria.byCapacities && entriesWithoutCapacity">?</th> <th>{{\'report.teachersDetailLoad.substitute\' | translate}}</th> <th ng-if="reportData.criteria.showSingleEvents">{{\'report.teachersDetailLoad.singleEvent\' | translate}}</th> <th class="dividerBorder">{{(\'report.teachersDetailLoad.total\' | translate).toUpperCase()}}</th> </tr> </thead> <tbody> <tr ng-repeat="row in content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td ng-class="{dividerBorder: reportData.byTeachers}"> <a ng-if="reportData.byTeachers" ng-click="teacherSubjectsDialog(row.teacher)">{{currentLanguageNameField(row.teacher)}}</a> <span ng-if="reportData.byStudyPeriods">{{currentLanguageNameField(row.journalSubject)}}</span> </td> <td ng-if="reportData.byStudyPeriods" class="dividerBorder" style="text-align: left"> <div ng-repeat="group in row.studentGroups | orderBy">{{group}}</div> </td> <!-- PERIODS --> <td ng-repeat="column in periodCapacitiesRow track by $index" ng-class="{dividerBorder: column.divider}"> <span ng-if="reportData.criteria.byCapacities"> <span ng-if="column.plannedLessons">{{row.capacityPlannedHours[column.index][column.code] || \'\'}}</span> <span ng-if="column.timetableOccurredLessons">{{row.capacityTimetableOccurredLessons[column.index][column.code] || \'\'}}</span> </span> <span ng-if="!reportData.criteria.byCapacities"> <span ng-if="column.plannedLessons">{{row.plannedHours[column.index] || \'\'}}</span> <span ng-if="column.timetableOccurredLessons">{{row.timetableOccurredLessons[column.index] || \'\'}}</span> </span> <span ng-if="column.substitutableEvents">{{row.substitutedLessons[column.index] || \'\'}}</span> <span ng-if="column.singleEvent">{{row.singleEvents[column.index] || \'\'}}</span> </td> <!-- TOTALS --> <td ng-if="!reportData.criteria.byCapacities && reportData.criteria.showPlannedLessons">{{row.totalPlannedHours || \'\'}}</td> <td ng-if="!reportData.criteria.byCapacities">{{row.timetableTotalOccurredLessons || \'\'}}</td> <td ng-if="reportData.criteria.byCapacities && reportData.criteria.showPlannedLessons" ng-repeat="c in reportData.teacherCapacities"> {{row.totalCapacityPlannedHours[c.code] || \'\'}}</td> <td ng-if="reportData.criteria.byCapacities" ng-repeat="c in reportData.teacherCapacities">{{row.timetableTotalCapacityOccurredLessons[c.code] || \'\'}}</td> <td ng-if="reportData.criteria.byCapacities && entriesWithoutCapacity">{{row.timetableTotalCapacityOccurredLessons[\'?\'] || \'\'}}</td> <td>{{row.totalSubstitutedLessons || \'\'}}</td> <td ng-if="reportData.criteria.showSingleEvents">{{row.totalSingleEvents || \'\'}}</td> <td class="dividerBorder">{{row.timetableTotalOccurredLessons + row.totalSubstitutedLessons + row.totalSingleEvents || \'\'}}</td> </tr> </tbody> </table> </div>'),a.put("report/teachers.detail.load.table.vocational.tmpl.html",'<div ng-if="periodCapacitiesRow" class="tertiary-table-container" fixed-column-table fixed-columns="{{reportData.byJournals ? 2 : 1}}"> <table class="tertiary-table detail-load-table"> <thead> <tr> <th class="dividerBorder" colspan="{{reportData.byJournals ? 2 : 1}}"></th> <!-- PERIODS --> <th ng-if="reportData.criteria.byStudyPeriods" colspan="{{periodColspan}}" class="dividerBorder" ng-repeat="sp in reportData.studyPeriods">{{currentLanguageNameField(sp)}} ({{sp.startDate | hoisDayMonth}}-{{sp.endDate | hoisDayMonth}})</th> <th ng-if="reportData.criteria.byMonths" colspan="{{periodColspan}}" class="dividerBorder" ng-repeat="month in months">{{\'main.month.\' + month.name | translate}}</th> <th ng-if="reportData.criteria.byWeeks" colspan="{{periodColspan}}" class="dividerBorder" ng-repeat="weekNr in weekNrs"> <span>{{weekNr}}. {{\'report.teachersDetailLoad.week\' | translate}}</span> <md-tooltip>{{reportData.weekBeginningDateMap[weekNr] | hoisDate}}</md-tooltip> </th> <!-- TOTALS --> <th colspan="{{totalsColspan}}" class="dividerBorder">{{\'report.teachersDetailLoad.total\' | translate}}</th> </tr> <tr> <th class="dividerBorder" colspan="{{reportData.byJournals ? 2 : 1}}"></th> <!-- PERIODS --> <th colspan="{{column.colspan}}" ng-repeat="column in periodTypesRow" class="fix" ng-class="{dividerBorder: column.divider}"> <span ng-if="column.plannedLessons">{{\'report.teachersDetailLoad.planned\' | translate}}</span> <span ng-if="column.journalOccurredLessons || column.timetableOccurredLessons">{{\'report.teachersDetailLoad.occurred\' | translate}}</span> <span ng-if="column.timetableOccurredLessons">{{\'report.teachersDetailLoad.timetableShort\' | translate}}</span> </th> <!-- TOTALS --> <th ng-if="reportData.criteria.showPlannedLessons" colspan="{{plannedLessonsColspan}}">{{\'report.teachersDetailLoad.planned\' | translate}}</th> <th colspan="{{journalOccurredLessonsColspan + (reportData.criteria.byCapacities ? 1 : 0)}}" ng-class="{dividerBorder: !reportData.criteria.showTimetableLoad}">{{\'report.teachersDetailLoad.occurred\' | translate}}</th> <th ng-if="reportData.criteria.showTimetableLoad" colspan="{{timetableOccurredLessonsColspan + 1}}" class="dividerBorder"> {{\'report.teachersDetailLoad.occurred\' | translate}} {{\'report.teachersDetailLoad.timetableShort\' | translate}}</th> </tr> <tr> <th ng-class="{dividerBorder: reportData.byTeachers}"> <span ng-if="reportData.byTeachers">{{auth.higher ? (\'teacher.labelHigher\' | translate) : (\'teacher.labelVocational\' | translate)}}</span> <span ng-if="reportData.byJournals">{{\'report.teachersDetailLoad.journal\' | translate}}</span> </th> <th ng-if="reportData.byJournals" class="dividerBorder">{{\'report.teachersDetailLoad.studentGroups\' | translate}}</th> <!-- PERIODS --> <th ng-repeat="column in periodCapacitiesRow track by $index" ng-class="{dividerBorder: column.divider}"> <span ng-if="column.value">{{column.value.toUpperCase()}}</span> <span ng-if="column.name">{{\'report.teachersDetailLoad.\' + column.name | translate}}</span> <span ng-if="column.timetableOccurredLessons">{{\'report.teachersDetailLoad.timetableShort\' | translate}}</span> </th> <!-- TOTALS --> <th ng-if="!reportData.criteria.byCapacities && reportData.criteria.showPlannedLessons">{{\'report.teachersDetailLoad.study\' | translate}}</th> <th ng-if="!reportData.criteria.byCapacities" ng-class="{dividerBorder: !reportData.criteria.showTimetableLoad}"> {{\'report.teachersDetailLoad.study\' | translate}}</th> <th ng-if="!reportData.criteria.byCapacities && reportData.criteria.showTimetableLoad"> {{\'report.teachersDetailLoad.study\' | translate}} {{\'report.teachersDetailLoad.timetableShort\' | translate}} </th> <th ng-if="reportData.criteria.byCapacities && reportData.criteria.showPlannedLessons" ng-repeat="c in reportData.teacherCapacities">{{c.value.toUpperCase()}}</th> <th ng-if="reportData.criteria.byCapacities" ng-repeat="c in reportData.teacherCapacities">{{c.value.toUpperCase()}}</th> <th ng-if="reportData.criteria.byCapacities && entriesWithoutCapacity">?</th> <th ng-if="reportData.criteria.byCapacities" ng-class="{dividerBorder: !reportData.criteria.showTimetableLoad}"> {{(\'report.teachersDetailLoad.total\' | translate).toUpperCase()}}</th> <th ng-if="reportData.criteria.byCapacities && reportData.criteria.showTimetableLoad" ng-repeat="c in reportData.teacherCapacities">{{c.value.toUpperCase()}} {{\'report.teachersDetailLoad.timetableShort\' | translate}}</th> <th ng-if="reportData.criteria.byCapacities && reportData.criteria.showTimetableLoad && entriesWithoutCapacity"> ? {{\'report.teachersDetailLoad.timetableShort\' | translate}}</th> <th ng-if="reportData.criteria.showTimetableLoad">{{\'report.teachersDetailLoad.substitute\' | translate}}</th> <th ng-if="reportData.criteria.showSingleEvents"> {{\'report.teachersDetailLoad.singleEvent\' | translate}}</th> <th ng-if="reportData.criteria.showTimetableLoad" class="dividerBorder">{{(\'report.teachersDetailLoad.total\' | translate).toUpperCase()}} {{\'report.teachersDetailLoad.timetableShort\' | translate}}</th> </tr> </thead> <tbody> <tr ng-repeat="row in content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td ng-class="{dividerBorder: reportData.byTeachers}"> <a ng-if="reportData.byTeachers" ng-click="teacherJournalsDialog(row.teacher)">{{currentLanguageNameField(row.teacher)}}</a> <span ng-if="reportData.byJournals">{{currentLanguageNameField(row.journalSubject)}}</span> </td> <td ng-if="reportData.byJournals" class="dividerBorder" style="text-align: left"> <div ng-repeat="group in row.studentGroups | orderBy">{{group}}</div> </td> <!-- PERIODS --> <td ng-repeat="column in periodCapacitiesRow track by $index" ng-class="{dividerBorder: column.divider}"> <span ng-if="reportData.criteria.byCapacities"> <span ng-if="column.plannedLessons">{{row.capacityPlannedHours[column.index][column.code] || \'\'}}</span> <span ng-if="column.journalOccurredLessons">{{row.capacityJournalOccurredLessons[column.index][column.code] || \'\'}}</span> <span ng-if="column.timetableOccurredLessons">{{row.capacityTimetableOccurredLessons[column.index][column.code] || \'\'}}</span> </span> <span ng-if="!reportData.criteria.byCapacities"> <span ng-if="column.plannedLessons">{{row.plannedHours[column.index] || \'\'}}</span> <span ng-if="column.journalOccurredLessons">{{row.journalOccurredLessons[column.index] || \'\'}}</span> <span ng-if="column.timetableOccurredLessons">{{row.timetableOccurredLessons[column.index] || \'\'}}</span> </span> <span ng-if="column.substitutableEvents">{{row.substitutedLessons[column.index] || \'\'}}</span> <span ng-if="column.singleEvent">{{row.singleEvents[column.index] || \'\'}}</span> </td> <!-- TOTALS --> <td ng-if="!reportData.criteria.byCapacities && reportData.criteria.showPlannedLessons">{{row.totalPlannedHours || \'\'}}</td> <td ng-if="!reportData.criteria.byCapacities" ng-class="{dividerBorder: !reportData.criteria.showTimetableLoad}"> {{row.journalTotalOccurredLessons || \'\'}}</td> <td ng-if="!reportData.criteria.byCapacities && reportData.criteria.showTimetableLoad">{{row.timetableTotalOccurredLessons || \'\'}}</td> <td ng-if="reportData.criteria.byCapacities && reportData.criteria.showPlannedLessons" ng-repeat="c in reportData.teacherCapacities"> {{row.totalCapacityPlannedHours[c.code] || \'\'}}</td> <td ng-if="reportData.criteria.byCapacities" ng-repeat="c in reportData.teacherCapacities"> {{row.journalTotalCapacityOccurredLessons[c.code] || \'\'}}</td> <td ng-if="reportData.criteria.byCapacities && entriesWithoutCapacity">{{row.journalTotalCapacityOccurredLessons[\'?\'] || \'\'}}</td> <td ng-if="reportData.criteria.byCapacities" ng-class="{dividerBorder: !reportData.criteria.showTimetableLoad}"> {{row.journalTotalOccurredLessons || \'\'}}</td> <td ng-if="reportData.criteria.byCapacities && reportData.criteria.showTimetableLoad" ng-repeat="c in reportData.teacherCapacities">{{row.timetableTotalCapacityOccurredLessons[c.code] || \'\'}}</td> <td ng-if="reportData.criteria.byCapacities && reportData.criteria.showTimetableLoad && entriesWithoutCapacity"> {{row.timetableTotalCapacityOccurredLessons[\'?\'] || \'\'}}</td> <td ng-if="reportData.criteria.showTimetableLoad">{{row.totalSubstitutedLessons || \'\'}}</td> <td ng-if="reportData.criteria.showSingleEvents">{{row.totalSingleEvents || \'\'}}</td> <td ng-if="reportData.criteria.showTimetableLoad" class="dividerBorder">{{row.timetableTotalOccurredLessons + row.totalSubstitutedLessons + row.totalSingleEvents || \'\'}}</td> </tr> </tbody> </table> </div>'),a.put("report/teachers.detail.load.teacher.dialog.tmpl.html",'<md-dialog aria-label="teacher detail load dialog" flex="80" flex-xs="100"> <md-toolbar> <div class="md-toolbar-tools"> <h2> <span>{{currentLanguageNameField(teacher)}}</span> <span ng-if="!criteria.isHigher">{{\'report.teachersDetailLoad.journals\' | translate}}</span> <span ng-if="criteria.isHigher">{{\'report.teachersDetailLoad.subjects\' | translate}}</span> </h2> <span flex></span> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <span flex></span> <div class="ois-form-layout" layout="column" layout-margin ng-cloak> <div layout="column" layout-align="start"> <div flex layout="row"> <div layout="row" class="common-label" md-colors="{color: \'default-background-400\'}"> <span ng-repeat="c in reportData.teacherCapacities"> <span ng-if="!$first">|</span> <span>{{::c.value.toUpperCase()}} - {{currentLanguageNameField(c)}}</span> </span> <span ng-if="entriesWithoutCapacity"> <span>|</span> <span> ? - {{\'report.teachersDetailLoad.capacityMissing\' | translate}}</span> </span> </div> </div> </div> <div ng-if="!periodCapacitiesRow" layout="row" layout-sm="column" layout-align="space-around"> <md-progress-circular md-mode="indeterminate"></md-progress-circular> </div> <div ng-if="!criteria.isHigher" ng-include="\'report/teachers.detail.load.table.vocational.tmpl.html\'"></div> <div ng-if="criteria.isHigher" ng-include="\'report/teachers.detail.load.table.higher.tmpl.html\'"></div> </div> </md-dialog-content> <md-dialog-actions layout="row" layout-align="start center"> <md-button ng-href="{{$root.excel(xlsUrl, criteria)}}" class="md-button md-raised">{{\'main.button.printXls\'| translate}}</md-button> <md-button class="md-raised" ng-click="cancel()">{{"main.button.close" | translate}}</md-button> </md-dialog-actions> </md-dialog>'),a.put("report/teachers.detail.load.vocational.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <form name="searchForm" ng-submit="loadData()" novalidate> <div layout="row"> <md-input-container flex="30" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'report.teachersDetailLoad.studyYear\' | translate}}</label> <hois-select ng-model="criteria.studyYear" values="formState.studyYears" required></hois-select> </md-input-container> <md-input-container flex="30" flex-offset="5" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'report.teachersDetailLoad.studyPeriod\' | translate}}</label> <hois-select ng-model="criteria.studyPeriod" ng-change="studyPeriodChanged()" values="formState.studyPeriods[criteria.studyYear]"></hois-select> </md-input-container> <div flex="30" flex-offset="5" flex-sm="100" flex-xs="100"> <hois-autocomplete ng-model="criteria.teacher" ha-controller="directiveControllers" ha-attribute="id" method="teachers" additional-query-params="{valid: true, vocational: true}" label="{{auth.higher ? \'teacher.labelHigher\' : \'teacher.labelVocational\'}}"></hois-autocomplete> </div> </div> <div layout="row"> <md-input-container> <label>{{\'main.from\' | translate}}</label> <md-datepicker ng-model="criteria.from" ng-change="dateFromThruChange()" md-min-date="criteria.studyYearStart" md-max-date="criteria.thru" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> <md-input-container flex-offset="5"> <label>{{\'main.thru\' | translate}}</label> <md-datepicker ng-model="criteria.thru" ng-change="dateFromThruChange()" md-min-date="criteria.from" md-max-date="criteria.studyYearEnd" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-checkbox flex="15" flex-md="30" flex-sm="100" flex-xs="100" ng-model="criteria.byStudyPeriods" ng-change="periodChanged(\'byStudyPeriods\')" ng-disabled="criteria.thru || criteria.from" aria-label="{{\'report.teachersDetailLoad.byStudyPeriods\' | translate}}"> {{\'report.teachersDetailLoad.byStudyPeriods\' | translate}} </md-checkbox> <md-checkbox flex="15" flex-md="30" flex-sm="100" flex-xs="100" ng-model="criteria.byWeeks" ng-change="periodChanged(\'byWeeks\')" ng-disabled="criteria.thru || criteria.from" aria-label="{{\'report.teachersDetailLoad.byWeeks\' | translate}}"> {{\'report.teachersDetailLoad.byWeeks\' | translate}} </md-checkbox> <md-checkbox flex="15" flex-md="30" flex-sm="100" flex-xs="100" ng-model="criteria.byMonths" ng-change="periodChanged(\'byMonths\')" ng-disabled="criteria.studyPeriod" aria-label="{{\'report.teachersDetailLoad.byMonths\' | translate}}"> {{\'report.teachersDetailLoad.byMonths\' | translate}} </md-checkbox> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-checkbox flex="15" flex-md="30" flex-sm="100" flex-xs="100" ng-model="criteria.byCapacities" aria-label="{{\'report.teachersDetailLoad.byCapacities\' | translate}}"> {{\'report.teachersDetailLoad.byCapacities\' | translate}} </md-checkbox> <md-checkbox flex="15" flex-md="30" flex-sm="100" flex-xs="100" ng-model="criteria.showPlannedLessons" aria-label="{{\'report.teachersDetailLoad.showPlannedLessons\' | translate}}"> {{\'report.teachersDetailLoad.showPlannedLessons\' | translate}} </md-checkbox> <md-checkbox flex="15" flex-md="30" flex-sm="100" flex-xs="100" ng-model="criteria.showTimetableLoad" ng-change="showTimetableLoadChanged()" aria-label="{{\'report.teachersDetailLoad.showTimetableLoad\' | translate}}"> {{\'report.teachersDetailLoad.showTimetableLoad\' | translate}} </md-checkbox> <md-checkbox flex="15" flex-md="30" flex-sm="100" flex-xs="100" ng-model="criteria.showSingleEvents" ng-disabled="!criteria.showTimetableLoad" aria-label="{{\'report.teachersDetailLoad.showSingleEvents\' | translate}}"> {{\'report.teachersDetailLoad.showSingleEvents\' | translate}} </md-checkbox> </div> <div layout="row"> <md-button class="md-raised md-primary" type="submit">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> <md-button ng-href="{{excelUrl()}}" ng-disabled="!criteria.studyYear" class="md-button md-raised">{{\'main.button.printXls\'| translate}}</md-button> </div> <div flex-xs="0" flex-gt-xs="0" flex-gt-sm="50"></div> </form> </fieldset> </div> </div> <div layout-padding ng-if="reportData"> <div layout="column" layout-align="start"> <div flex layout="row"> <div layout="row" class="common-label" md-colors="{color: \'background-400\'}"> <span ng-repeat="c in reportData.teacherCapacities"> <span ng-if="!$first">|</span> <span>{{::c.value.toUpperCase()}} - {{currentLanguageNameField(c)}}</span> </span> <span ng-if="entriesWithoutCapacity"> <span>|</span> <span> ? - {{\'report.teachersDetailLoad.capacityMissing\' | translate}}</span> </span> </div> </div> </div> <div flex> <div ng-include="\'report/teachers.detail.load.table.vocational.tmpl.html\'"></div> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> </div>'),a.put("report/teachers.load.higher.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <form name="teacherLoadReportForm" ng-submit="loadData()" novalidate> <div layout="row"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'report.teachersload.studyYear\' | translate}}</label> <hois-select ng-model="criteria.studyYear" values="formState.studyYears" required autofocus></hois-select> </md-input-container> <md-input-container flex="50" flex-offset="5" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'report.teachersload.studyPeriod\' | translate}}</label> <hois-select ng-model="criteria.studyPeriod" values="criteria.studyYear ? formState.studyPeriods[criteria.studyYear] : formState.allStudyPeriods"></hois-select> </md-input-container> </div> <div layout="row"> <div flex="45" flex-sm="100" flex-xs="100"> <hois-autocomplete ha-controller="directiveControllers" ng-model="criteria.subject" method="subjects" label="{{\'report.teachersload.subject\' | translate}}"></hois-autocomplete> </div> <div flex="50" flex-offset="5"> <hois-autocomplete ha-controller="directiveControllers" ng-model="criteria.teacher" method="teachers" label="{{auth.higher ? (\'report.teachersload.teacherHigher\' | translate) : (\'report.teachersload.teacherVocational\' | translate)}}"></hois-autocomplete> </div> </div> <div layout="row"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> <a ng-href="{{excel(formState.xlsUrl, criteria)}}" target="_blank" class="md-button md-raised">{{\'report.excel\' | translate}}</a> </div> <div flex-xs="0" flex-gt-xs="0" flex-gt-sm="50"></div> </form> </fieldset> </div> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column>{{\'report.teachersload.studyYear\' | translate}}</th> <th md-column>{{\'report.teachersload.studyPeriod\' | translate}}</th> <th md-column>{{\'report.teachersload.subject\' | translate}}</th> <th md-column>{{\'report.teachersload.subjectcode\' | translate}}</th> <th md-column>{{auth.higher ? (\'report.teachersload.teacherHigher\' | translate) : (\'report.teachersload.teacherVocational\' | translate)}}</th> <th md-column>{{auth.higher ? (\'report.teachersload.plannedHoursHigher\' | translate) : (\'report.teachersload.plannedHoursVocational\' | translate)}}</th> <th md-column>{{auth.higher ? (\'report.teachersload.actualHoursHigher\' | translate) : (\'report.teachersload.actualHoursVocational\' | translate)}}</th> <th md-column>{{auth.higher ? (\'report.teachersload.coefficientHoursHigher\' | translate) : (\'report.teachersload.coefficientHoursVocational\' | translate)}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{currentLanguageNameField(row.studyYear)}}</td> <td md-cell>{{currentLanguageNameField(row.studyPeriod)}}</td> <td md-cell> <div ng-repeat="subject in row.subjects"> <hr ng-if="!$first"> {{currentLanguageNameField(subject.subject)}} </div> </td> <td md-cell> <div ng-repeat="subject in row.subjects"> <hr ng-if="!$first"> {{::subject.code}} </div> </td> <td md-cell>{{::row.teacher}}</td> <td md-cell>{{::row.plannedHours}}</td> <td md-cell>{{::row.actualHours}}</td> <td md-cell>{{::row.coefficientHours}}</td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> </div>'),a.put("report/teachers.load.vocational.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <form name="teacherLoadReportForm" ng-submit="loadData()" novalidate> <div layout="row"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'report.teachersload.studyYear\' | translate}}</label> <hois-select ng-model="criteria.studyYear" values="formState.studyYears" required autofocus></hois-select> </md-input-container> <md-input-container flex="50" flex-offset="5" flex-sm="100" flex-xs="100" flex-offset-xs="0" flex-offset-sm="0"> <label class="textInput">{{\'report.teachersload.studyPeriod\' | translate}}</label> <hois-select ng-model="criteria.studyPeriod" values="criteria.studyYear ? formState.studyPeriods[criteria.studyYear] : formState.allStudyPeriods"></hois-select> </md-input-container> </div> <div layout="row"> <div flex="45"> <hois-autocomplete ha-controller="directiveControllers" ng-model="criteria.module" method="vocationalmodules" label="{{\'report.teachersload.module\' | translate}}"></hois-autocomplete> </div> <div flex="50" flex-offset="5" flex-sm="100" flex-offset-xs="0" flex-offset-sm="0"> <hois-autocomplete ha-controller="directiveControllers" ng-model="criteria.teacher" method="teachers" label="{{auth.higher ? (\'report.teachersload.teacherHigher\' | translate) : (\'report.teachersload.teacherVocational\' | translate)}}"></hois-autocomplete> </div> </div> <div layout="row"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> <a ng-href="{{excel(formState.xlsUrl, criteria)}}" target="_blank" class="md-button md-raised">{{\'report.excel\' | translate}}</a> </div> <div flex-xs="0" flex-gt-xs="0" flex-gt-sm="50"></div> </form> </fieldset> </div> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column>{{\'report.teachersload.studyYear\' | translate}}</th> <th md-column>{{\'report.teachersload.studyPeriod\' | translate}}</th> <th md-column>{{auth.higher ? (\'report.teachersload.teacherHigher\' | translate) : (\'report.teachersload.teacherVocational\' | translate)}}</th> <th md-column>{{\'report.teachersload.module\' | translate}}</th> <th md-column>{{auth.higher ? (\'report.teachersload.plannedHoursHigher\' | translate) : (\'report.teachersload.plannedHoursVocational\' | translate)}}</th> <th md-column>{{auth.higher ? (\'report.teachersload.actualHoursHigher\' | translate) : (\'report.teachersload.actualHoursVocational\' | translate)}}</th> <th md-column>{{auth.higher ? (\'report.teachersload.coefficientHoursHigher\' | translate) : (\'report.teachersload.coefficientHoursVocational\' | translate)}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{currentLanguageNameField(row.studyYear)}}</td> <td md-cell>{{currentLanguageNameField(row.studyPeriod)}}</td> <td md-cell>{{::row.teacher}}</td> <td md-cell> <div ng-repeat="module in row.modules"> <hr ng-if="!$first"> {{currentLanguageNameField(module.module)}} </div> </td> <td md-cell>{{::row.plannedHours}}</td> <td md-cell>{{::row.actualHours}}</td> <td md-cell>{{::row.coefficientHours}}</td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> </div>'),
a.put("report/vota.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <form name="votaReportForm" ng-submit="loadData()" novalidate> <div layout="row"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'report.teachersload.studyYear\' | translate}}</label> <hois-select ng-model="criteria.studyYear" values="formState.studyYears" required autofocus></hois-select> </md-input-container> <md-input-container flex="50" flex-offset="5" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'report.teachersload.studyPeriod\' | translate}}</label> <hois-select ng-model="criteria.studyPeriod" values="criteria.studyYear ? formState.studyPeriods[criteria.studyYear] : formState.allStudyPeriods"></hois-select> </md-input-container> </div> <div layout="row"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> </div> <div flex-xs="0" flex-gt-xs="0" flex-gt-sm="50"></div> </form> </fieldset> </div> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column></th> <th md-column>{{\'report.vota.studyYear\' | translate}}</th> <th md-column>{{\'report.vota.studyPeriod\' | translate}}</th> <th md-column>{{\'report.vota.curriculum\' | translate}}</th> <th md-column><span translate="report.vota.applicationCount"></span></th> <th md-column><span translate="report.vota.totalCredits"></span></th> <th md-column><span translate="report.vota.acceptedCredits"></span></th> <th md-column><span translate="report.vota.totalLocalCredits"></span></th> <th md-column><span translate="report.vota.acceptedLocalCredits"></span></th> <th md-column><span translate="report.vota.totalAbroadCredits"></span></th> <th md-column><span translate="report.vota.acceptedAbroadCredits"></span></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content"> <td md-cell style="border-top:none"></td> <td md-cell rowspan="{{tabledata.content.length}}" ng-if="$first">{{currentLanguageNameField(row.studyYear)}}</td> <td md-cell rowspan="{{studyPeriodRows($index)}}" ng-if="studyPeriodVisible($index)">{{currentLanguageNameField(row.studyPeriod)}}</td> <td md-cell ng-class-odd="\'odd\'" ng-class-even="\'even\'">{{currentLanguageNameField(row.curriculum)}}</td> <td md-cell ng-class-odd="\'odd\'" ng-class-even="\'even\'">{{row.applicationCount}}</td> <td md-cell ng-class-odd="\'odd\'" ng-class-even="\'even\'">{{row.totalCredits}}</td> <td md-cell ng-class-odd="\'odd\'" ng-class-even="\'even\'">{{row.acceptedCredits}}</td> <td md-cell ng-class-odd="\'odd\'" ng-class-even="\'even\'">{{row.totalLocalCredits}}</td> <td md-cell ng-class-odd="\'odd\'" ng-class-even="\'even\'">{{row.acceptedLocalCredits}}</td> <td md-cell ng-class-odd="\'odd\'" ng-class-even="\'even\'">{{row.totalAbroadCredits}}</td> <td md-cell ng-class-odd="\'odd\'" ng-class-even="\'even\'">{{row.acceptedAbroadCredits}}</td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> </div>'),a.put("room/room.edit.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <form name="roomForm"> <div layout="column"> <md-input-container class="md-block"> <label>{{\'room.building\' | translate}}</label> <hois-select ng-model="record.building" name="building" ng-change="buildingChanged()" type="building" required></hois-select> </md-input-container> <div layout="row" flex> <md-input-container class="md-block" flex="20"> <label class="textInput">{{\'room.code\' | translate}}</label> <input ng-model="record.code" name="code" type="text" md-maxlength="20" ng-model-options="{debounce: 250}" unique="formState.roomUniqueQuery" required> <div ng-messages="roomForm.code.$error"> <div ng-message="md-maxlength"> {{\'main.messages.error.maxlength\' | translate}} </div> <div ng-message="notUnique"> {{\'room.alreadyexist\' | translate}} </div> </div> </md-input-container> <md-input-container class="md-block" flex-offset="5" flex> <label>{{\'room.name\' | translate}}</label> <input ng-model="record.name" name="name" type="text" md-maxlength="100"> <div ng-messages="roomForm.name.$error"> <div ng-message="md-maxlength"> {{\'main.messages.error.maxlength\' | translate}} </div> </div> </md-input-container> </div> <div layout="row" flex> <md-input-container class="md-block" flex="20"> <label class="textInput">{{\'room.seats\' | translate}}</label> <input ng-model="record.seats" name="seats" type="number" min="0" max="100000000"> <div ng-messages="roomForm.seats.$error"> <div ng-message="max"> {{\'main.messages.error.max\' | translate: {max: 100000000} }} </div> <div ng-message="min"> {{\'main.messages.error.min\' | translate: {min: 0} }} </div> </div> </md-input-container> <div flex="50" layout-align="start center" layout="row" flex-offset="5"> <md-checkbox ng-model="record.isStudy" name="isStudy"> {{\'room.isStudy\' | translate}} </md-checkbox> </div> </div> <div layout="row"> <md-input-container flex> <label>{{\'room.equipment\' | translate}}</label> <hois-classifier-select ng-model="formState.newEquipment" main-classifier-code="SEADMED"></hois-classifier-select> </md-input-container> <md-input-container flex> <md-button ng-show="formState.newEquipment" ng-click="addEquipment()" class="md-primary"> <md-icon ng-class="\'md-primary md-hue-2\'" md-font-set="material-icons">add</md-icon></md-button> </md-input-container> </div> <md-list> <md-list-item ng-repeat="equipment in formState.roomEquipment"> <md-input-container flex="10"> <label class="textInput">{{currentLanguageNameField(equipment.equipment)}}</label> <input ng-model="equipment.equipmentCount" name="equipment[{{$index}}].equipmentCount" type="number" min="0" max="100000000"> <div ng-messages="roomForm[\'equipment[\'+$index+\'].equipmentCount\'].$error"> <div ng-message="max"> {{\'main.messages.error.max\' | translate: {max: 100000000} }} </div> <div ng-message="min"> {{\'main.messages.error.min\' | translate: {min: 0} }} </div> </div> </md-input-container> <md-input-container flex> &nbsp;<a ng-click="deleteEquipment(equipment.equipment.code)" class="remove">&times;</a> </md-input-container> </md-list-item> </md-list> </div> </form> <md-button ng-click="update()" class="md-raised md-primary">{{\'main.button.save\' | translate}}</md-button> <md-button ng-click="delete()" ng-show="record.id" class="md-raised">{{\'main.button.delete\' | translate}}</md-button> <md-button ng-click="back(\'#/rooms/search\', roomForm)" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </div> </div>'),a.put("room/room.search.html",'<div class="ois-form-layout-padding"> <div flex> <form name="searchForm" ng-submit="searchForm.$valid && loadData()" novalidate layout="column" class="nomargin" ng-model-options="{allowInvalid: true}"> <fieldset tabindex="1"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <div layout="row" layout-sm="column" layout-xs="column"> <!--div class="indentForToast"></div--> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'building.name\' | translate}}</label> <input ng-model="criteria.buildingName" name="buildingName" type="text" md-maxlength="255"> </md-input-container> <md-input-container flex="50" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label class="textInput">{{\'building.code\' | translate}}</label> <input ng-model="criteria.buildingCode" name="buildingCode" type="text" md-maxlength="20" autofocus> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'room.name\' | translate}}</label> <input ng-model="criteria.name" name="name" type="text" md-maxlength="100"> </md-input-container> <md-input-container flex="50" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label class="textInput">{{\'room.code\' | translate}}</label> <input ng-model="criteria.code" name="code" type="text" md-maxlength="20"> </md-input-container> </div> </fieldset> <div layout="row"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> <md-button class="md-raised" ng-if="isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_HOONERUUM\')" ng-href="#/rooms/new">{{\'room.add\' | translate}}</md-button> <md-button class="md-raised" ng-if="isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_HOONERUUM\')" ng-href="#/buildings/new">{{\'building.add\' | translate}}</md-button> </div> <div flex-xs="0" flex-gt-xs="0" flex-gt-sm="50"></div> </form> </div> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="b.name">{{\'building.name\' | translate}}</th> <th md-column md-order-by="b.code">{{\'building.code\' | translate}}</th> <th md-column>{{\'room.isBoardingSchool\' | translate}}</th> <th md-column md-order-by="b.address">{{\'building.address\' | translate}}</th> <th md-column md-order-by="r.name">{{\'room.name\' | translate}}</th> <th md-column md-order-by="r.code">{{\'room.code\' | translate}}</th> <th md-column md-numeric md-order-by="r.seats">{{\'room.seats\' | translate}}</th> <th md-column>{{\'room.isStudyInTable\' | translate}}</th> <th md-column>{{\'room.equipment\' | translate}}</th> <th md-column></th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{::row.buildingName}}</td> <td md-cell>{{::row.buildingCode}}</td> <td md-cell>{{row.isBoardingSchool ? \'main.yes\' : \'main.no\' | translate}}</td> <td md-cell>{{::row.buildingAddress}}</td> <td md-cell>{{::row.name}}</td> <td md-cell>{{::row.code}}</td> <td md-cell>{{::row.seats}}</td> <td md-cell>{{row.isStudy ? \'main.yes\' : \'main.no\' | translate}}</td> <td md-cell> <table> <tr ng-repeat="device in row.equipment"> <td>{{currentLanguageNameField(device.equipment)}}</td> <td>{{::device.equipmentCount}}</td> </tr> </table> </td> <td md-cell> <md-button md-no-ink class="md-primary change-button" ng-if="row.id && isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_HOONERUUM\')" ng-href="#/rooms/{{::row.id}}/edit">{{\'room.change\' | translate}}</md-button> </td> <td md-cell> <md-button md-no-ink class="md-primary change-button" ng-if="isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_HOONERUUM\')" ng-href="#/buildings/{{::row.building}}/edit">{{\'building.change\' | translate}}</md-button> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> </div>'),a.put("rr/rr.changes.list.html",'<div layout-padding> <div flex> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <form ng-submit="searchForm.$valid && loadData()" layout="column" name="searchForm" ng-model-options="{allowInvalid: true}"> <div flex> <div layout="column"> <div flex layout-gt-sm="row" layout="column"> <hois-autocomplete flex="45" ng-model="criteria.student" ha-controller="directiveControllers" url="/autocomplete/students" label="{{\'rr.student.student\' | translate}}"></hois-autocomplete> <hois-autocomplete flex="50" flex-offset="0" flex-offset-gt-sm="5" ng-model="criteria.group" ha-controller="directiveControllers" url="/autocomplete/studentgroups" label="{{\'rr.student.group\' | translate}}"></hois-autocomplete> </div> <div flex layout="column"> <label class="common-label">{{\'rr.student.changeDatesRange\' | translate}}</label> <div flex layout="row"> <md-input-container> <label>{{\'main.from\' | translate}}</label> <md-datepicker ng-model="criteria.from" md-max-date="criteria.thru" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> <md-input-container> <label>{{\'main.thru\' | translate}}</label> <md-datepicker ng-model="criteria.thru" md-min-date="criteria.from" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> </div> </div> </div> </div> <div layout="row"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> </div> </form> </fieldset> </div> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="p.firstname, p.lastname">{{\'rr.student.studentName\' | translate}}</th> <th md-column md-order-by="sg.code">{{\'rr.student.group\' | translate}}</th> <th md-column>{{\'rr.student.oldName\' | translate}}</th> <th md-column>{{\'rr.student.newName\' | translate}}</th> <th md-column>{{\'rr.student.oldAddress\' | translate}}</th> <th md-column>{{\'rr.student.newAddress\' | translate}}</th> <th md-column md-order-by="wrcl.inserted">{{\'rr.student.changed\' | translate}}</th> <th md-column>{{\'rr.student.changedBy\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell><a ng-href="#/students/{{::row.student.id}}/main">{{currentLanguageNameField(row.student)}}</a></td> <td md-cell>{{currentLanguageNameField(row.group)}}</td> <td md-cell>{{row.oldName}}</td> <td md-cell>{{row.newName}}</td> <td md-cell>{{row.oldAddress}}</td> <td md-cell>{{row.newAddress}}</td> <td md-cell>{{::row.changed | hoisDateTime}}</td> <td md-cell>{{::row.changedBy}}</td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> </div>'),a.put("rtip/rtip.sync.html",'<div layout-padding> <div flex> <form layout="column" name="rtipSyncForm"> <div layout="row"> <md-input-container flex="20" flex-sm="100" flex-xs="100"> <label>{{\'rtip.dateRange\' | translate}}</label> <input type="hidden"> </md-input-container> <div flex="33"> <md-input-container flex> <label>{{\'main.from\' | translate}}</label> <md-datepicker ng-model="criteria.from" md-max-date="criteria.thru" required></md-datepicker> </md-input-container> <md-input-container flex> <label>{{\'main.thru\' | translate}}</label> <md-datepicker ng-model="criteria.thru" md-min-date="criteria.from" required></md-datepicker> </md-input-container> </div> </div> <div layout="row"> <md-button class="md-raised" ng-click="rtipSync()">{{\'rtip.contract\' | translate}}</md-button> <md-button class="md-raised" ng-click="rtipZemploees()">{{\'rtip.sync\' | translate}}</md-button> </div> </form> </div> </div>'),a.put("saisClassifier/saisClassifier.content.list.html",'<div layout-padding> <form ng-submit="loadData()" novalidate> <div flex> <div layout="row"> <div flex-xs="100" flex-gt-xs="100" flex-gt-sm="50" layout="column"> <!--div class="indentForToast"></div--> <h3>{{currentLanguageNameField(mainClass)}}</h3> <md-input-container> <label class="textInput">{{\'saisClassifier.value\' | translate}}</label> <input ng-model="criteria.value" type="text" autofocus> </md-input-container> <md-input-container> <label class="textInput">{{\'saisClassifier.name\' | translate}}</label> <input ng-model="criteria.name" type="text"> </md-input-container> <div layout="row"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> <md-button class="md-raised" ng-href="#/saisClassifier">{{\'main.button.back\' | translate}}</md-button> </div> </div> <div flex-xs="0" flex-gt-xs="0" flex-gt-sm="50"></div> </div> </div> </form> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="value">{{\'saisClassifier.value\' | translate}}</th> <th md-column md-order-by="nameEt">{{\'saisClassifier.nameEt\' | translate}}</th> <th md-column md-order-by="nameEn">{{\'saisClassifier.nameEn\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{::row.value}}</td> <td md-cell>{{::row.nameEt}}</td> <td md-cell>{{::row.nameEn}}</td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\' }" md-page-select></md-table-pagination> </div> </div>'),a.put("saisClassifier/saisClassifier.list.html",'<div layout-padding> <div flex> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <form ng-submit="loadData()"> <div flex> <div layout="row"> <div flex-xs="100" flex-gt-xs="100" flex-gt-sm="50" layout="column"> <!--div class="indentForToast"></div--> <md-input-container> <label class="textInput">{{\'saisClassifier.name\' | translate}}</label> <input ng-model="criteria.name" type="text" autofocus> </md-input-container> <div layout="row"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> <md-button class="md-raised" ng-click="saisImport()">{{\'saisClassifier.saisImport\' | translate}}</md-button> </div> </div> <div flex-xs="0" flex-gt-xs="0" flex-gt-sm="50"></div> </div> </div> </form> </fieldset> </div> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="nameEt">{{\'saisClassifier.klassifikaator\' | translate}}</th> <th md-column md-order-by="count">{{\'saisClassifier.count\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell><a ng-href="#/saisClassifier/{{::row.code}}?_menu">{{::row.nameEt}}</a></td> <td md-cell>{{::row.count}}</td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\' }" md-page-select></md-table-pagination> </div> </div>'),a.put("scholarship/scholarship.application.annul.edit.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div layout="column"> <div layout="row" flex="100" flex-sm="100" flex-xs="100"> {{scholarshipType === \'scholarships\' ? \'stipend.annul.stipendStudentList\' : \'stipend.annul.grantStudentList\' | translate}} </div> </div> <form name="annulForm"> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'stipend.fullName\' | translate}}</th> <th md-column>{{\'stipend.student.idCode\' | translate}}</th> <th md-column>{{\'stipend.rejectComment\' | translate}}</th> <th md-column>&nbsp;</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="rejection in rejections" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{rejection.fullName}}</td> <td md-cell>{{rejection.idCode}}</td> <td md-cell> <md-input-container flex> <input flex type="text" ng-model="rejection.rejectComment" style="width: 100%" autofocus md-maxlength="100"> </md-input-container> </td> <td md-cell> <md-button class="remove nomargin" ng-click="removeFromArray(rejections, rejection)">&times;</md-button> </td> </tr> </tbody> </table> </form> <div layout="row"> <md-button class="md-raised md-primary" ng-if="rejections.length > 0" ng-click="annul()">{{\'main.button.annul\' | translate}}</md-button> <md-button class="md-raised" ng-click="back(\'#/scholarships/applications/\' + scholarshipType)">{{\'main.button.back\' | translate}}</md-button> </div> </div>'),a.put("scholarship/scholarship.application.list.drGrants.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div layout="column"> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <form ng-submit="reloadTable()" name="applicationSearchForm" ng-model-options="{allowInvalid: true}"> <div layout="row" flex> <md-input-container flex="20"> <label class="textInput">{{\'stipend.grantType\' | translate}}</label> <hois-classifier-select required ng-model="criteria.type" name="type" model-value-attr="code" main-classifier-code="STIPTOETUS" show-only-values="formState.allowedStipendTypes" ng-change="resetCurriculum()"></hois-classifier-select> </md-input-container> <div layout="row" flex="20" flex-offset="5"> <md-input-container flex> <label class="textInput">{{\'stipend.curriculums\' | translate}}</label> <hois-select flex ng-model="criteria.curriculum" type="curriculum" label="stipend.curriculum" criteria="{higher: true, closed: false}" sorted-query="true" multiple></hois-select> </md-input-container> </div> <md-input-container flex="20" flex-offset="5"> <label class="textInput">{{\'stipend.courses\' | translate}}</label> <hois-classifier-select ng-model="criteria.courses" name="type" model-value-attr="code" main-classifier-code="KURSUS" multiple></hois-classifier-select> </md-input-container> <div layout="row" flex="20" flex-offset="5"> <md-input-container flex> <label class="textInput">{{\'stipend.applicant\' | translate}}</label> <input type="text" ng-model="criteria.studentName" name="nameEt" md-maxlength="500"> </md-input-container> </div> </div> <div layout="row" flex> <md-input-container flex="20"> <label class="textInput">{{\'stipend.grantName\' | translate}}</label> <input type="text" ng-model="criteria.nameEt" name="nameEt" md-maxlength="500"> </md-input-container> <md-input-container flex="20" flex-offset="5"> <label class="textInput">{{\'stipend.studyPeriod\' | translate}}</label> <hois-select ng-model="criteria.studyPeriod" type="studyperiodyear" sorted-query="true" preselect-current></hois-select> </md-input-container> <md-input-container flex="20" flex-offset="5"> <label class="textInput">{{\'stipend.status\' | translate}}</label> <hois-classifier-select ng-model="criteria.status" name="type" model-value-attr="code" main-classifier-code="STIPTOETUS_STAATUS"></hois-classifier-select> </md-input-container> </div> <div layout="row"> <md-button ng-click="reloadTable()" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> </div> </form> </fieldset> <br> <div ng-include="\'scholarship/templates/scholarship.applications.drGrants.html\'"></div> <div layout="row" ng-if="applications.length > 0"> <md-button class="md-raised md-primary" ng-click="accept()" ng-if="auth.isAdmin() && canManage">{{\'main.button.accept\' | translate}}</md-button> <md-button class="md-raised" ng-click="annul()" ng-if="auth.isAdmin() && canManage">{{\'main.button.annul\' | translate}}</md-button> <md-button class="md-raised" ng-click="reject()" ng-if="auth.isAdmin() && canManage">{{\'main.button.reject\' | translate}}</md-button> <md-button class="md-raised" ng-click="checkComplies()" ng-if="auth.isAdmin()">{{\'main.button.checkComplies\' | translate}}</md-button> <md-button class="md-raised" ng-click="committeeDecision()" ng-if="auth.isAdmin() && canManage">{{\'main.button.committeeDecision\' | translate}}</md-button> </div> </div> </div>'),a.put("scholarship/scholarship.application.list.grants.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div layout="column"> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <form ng-submit="reloadTable()" name="applicationSearchForm" ng-model-options="{allowInvalid: true}"> <div layout="row" layout-xs="column" flex> <md-input-container flex="20" flex-xs="100"> <label class="textInput">{{\'stipend.grantType\' | translate}}</label> <hois-classifier-select required ng-model="criteria.type" name="type" model-value-attr="code" main-classifier-code="STIPTOETUS" show-only-values="formState.allowedStipendTypes" ng-change="resetCurriculum()"></hois-classifier-select> </md-input-container> <div layout="row" flex="20" flex-xs="100" flex-offset-xs="0" flex-offset="5"> <md-input-container flex ng-if="criteria.type !== \'STIPTOETUS_POHI\'"> <label class="textInput">{{\'stipend.curriculums\' | translate}}</label> <hois-select flex ng-model="criteria.curriculum" type="curriculum" label="stipend.curriculum" criteria="{higher: false, closed: false, teacher: auth.teacher}" sorted-query="true" multiple></hois-select> </md-input-container> <md-input-container flex ng-if="criteria.type === \'STIPTOETUS_POHI\'"> <label class="textInput">{{\'stipend.curriculum\' | translate}}</label> <hois-select flex ng-model="criteria.curriculum" type="curriculum" label="stipend.curriculum" criteria="{higher: false, closed: false, teacher: auth.teacher}" sorted-query="true" required></hois-select> </md-input-container> </div> <md-input-container flex="20" flex-xs="100" flex-offset-xs="0" flex-offset="5"> <label class="textInput">{{\'stipend.courses\' | translate}}</label> <hois-classifier-select ng-model="criteria.courses" name="type" model-value-attr="code" main-classifier-code="KURSUS" multiple></hois-classifier-select> </md-input-container> <div layout="row" flex="20" flex-xs="100" flex-offset-xs="0" flex-offset="5"> <md-input-container flex> <label class="textInput">{{\'stipend.applicant\' | translate}}</label> <input type="text" ng-model="criteria.studentName" name="nameEt" md-maxlength="500"> </md-input-container> </div> </div> <div layout="row" layout-xs="column" flex> <md-input-container flex="20" flex-xs="100"> <label class="textInput">{{\'stipend.grantName\' | translate}}</label> <input type="text" ng-model="criteria.nameEt" name="nameEt" md-maxlength="500"> </md-input-container> <md-input-container flex="20" flex-xs="100" flex-offset-xs="0" flex-offset="5"> <label class="textInput">{{\'stipend.studyPeriod\' | translate}}</label> <hois-select ng-model="criteria.studyPeriod" type="studyperiodyear" sorted-query="true" preselect-current></hois-select> </md-input-container> <md-input-container flex="20" flex-xs="100" flex-offset-xs="0" flex-offset="5"> <label class="textInput">{{\'stipend.status\' | translate}}</label> <hois-classifier-select ng-model="criteria.status" name="type" model-value-attr="code" main-classifier-code="STIPTOETUS_STAATUS"></hois-classifier-select> </md-input-container> </div> <div layout="row"> <md-button ng-click="reloadTable()" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> </div> </form> </fieldset> <br> <div ng-include="\'scholarship/templates/scholarship.applications.grants.html\'"></div> <div layout="row" layout-xs="column" ng-if="applications.length > 0"> <md-button class="md-raised md-primary" ng-click="accept()" ng-if="auth.isAdmin() && canManage">{{\'main.button.accept\' | translate}}</md-button> <md-button class="md-raised" ng-click="annul()" ng-if="auth.isAdmin() && canManage">{{\'main.button.annul\' | translate}}</md-button> <md-button class="md-raised" ng-click="reject()" ng-if="auth.isAdmin() && canManage">{{\'main.button.reject\' | translate}}</md-button> <md-button class="md-raised" ng-click="refreshResults()" ng-if="auth.isAdmin() && canManage">{{\'main.button.refreshResults\' | translate}}</md-button> <md-button class="md-raised" ng-click="checkComplies()" ng-if="auth.isAdmin()">{{\'main.button.checkComplies\' | translate}}</md-button> <md-button class="md-raised" ng-click="committeeDecision()" ng-if="auth.isAdmin() && canManage">{{\'main.button.committeeDecision\' | translate}}</md-button> <md-button class="md-raised md-primary" ng-click="teacherConfirm(\'yes\')" ng-if="isStudentGroupTeacher">{{\'main.button.confirm\' | translate}}</md-button> <md-button class="md-raised" ng-click="teacherConfirm(\'no\')" ng-if="isStudentGroupTeacher">{{\'main.button.noConfirm\' | translate}}</md-button> <md-button class="md-raised" ng-click="annul()" ng-if="isStudentGroupTeacher">{{\'main.button.annul\' | translate}}</md-button> </div> </div> </div>'),a.put("scholarship/scholarship.application.list.scho.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div layout="column"> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <form ng-submit="reloadTable()" name="applicationSearchForm" ng-model-options="{allowInvalid: true}"> <div layout="row" flex> <md-input-container flex="20"> <label class="textInput">{{\'stipend.scholarshipType\' | translate}}</label> <hois-classifier-select required ng-model="criteria.type" name="type" model-value-attr="code" main-classifier-code="STIPTOETUS" show-only-values="formState.allowedStipendTypes" ng-change="resetCurriculum()"></hois-classifier-select> </md-input-container> <div layout="row" flex="20" flex-offset="5"> <md-input-container flex ng-if="criteria.type !== \'STIPTOETUS_ERIALA\'"> <label class="textInput">{{\'stipend.curriculums\' | translate}}</label> <hois-select flex ng-model="criteria.curriculum" type="curriculum" label="stipend.curriculum" criteria="{higher: true, closed: false}" sorted-query="true" multiple></hois-select> </md-input-container> <md-input-container flex ng-if="criteria.type === \'STIPTOETUS_ERIALA\'"> <label class="textInput">{{\'stipend.curriculum\' | translate}}</label> <hois-select flex ng-model="criteria.curriculum" type="curriculum" label="stipend.curriculum" criteria="{higher: true, closed: false}" sorted-query="true" multiple required></hois-select> </md-input-container> </div> <md-input-container flex="20" flex-offset="5"> <label class="textInput">{{\'stipend.courses\' | translate}}</label> <hois-classifier-select ng-model="criteria.courses" name="type" model-value-attr="code" main-classifier-code="KURSUS" multiple></hois-classifier-select> </md-input-container> <div layout="row" flex="20" flex-offset="5"> <md-input-container flex> <label class="textInput">{{\'stipend.applicant\' | translate}}</label> <input type="text" ng-model="criteria.studentName" name="nameEt" md-maxlength="500"> </md-input-container> </div> </div> <div layout="row" flex> <md-input-container flex="20"> <label class="textInput">{{\'stipend.scholarshipName\' | translate}}</label> <input type="text" ng-model="criteria.nameEt" name="nameEt" md-maxlength="500"> </md-input-container> <md-input-container flex="20" flex-offset="5"> <label class="textInput">{{\'stipend.studyPeriod\' | translate}}</label> <hois-select ng-model="criteria.studyPeriod" type="studyperiodyear" sorted-query="true" preselect-current></hois-select> </md-input-container> <md-input-container flex="20" flex-offset="5"> <label class="textInput">{{\'stipend.status\' | translate}}</label> <hois-classifier-select ng-model="criteria.status" name="type" model-value-attr="code" main-classifier-code="STIPTOETUS_STAATUS"></hois-classifier-select> </md-input-container> </div> <div layout="row"> <md-button ng-click="reloadTable()" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> </div> </form> </fieldset> <br> <div ng-include="\'scholarship/templates/scholarship.applications.scholarships.html\'"></div> <div layout="row" ng-if="applications.length > 0"> <md-button ng-click="accept()" class="md-raised md-primary" ng-if="auth.isAdmin() && canManage">{{\'main.button.accept\' | translate}}</md-button> <md-button class="md-raised" ng-click="annul()" ng-if="auth.isAdmin() && canManage">{{\'main.button.annul\' | translate}}</md-button> <md-button class="md-raised" ng-click="reject()" ng-if="auth.isAdmin() && canManage">{{\'main.button.reject\' | translate}}</md-button> <md-button class="md-raised" ng-click="refreshResults()" ng-if="auth.isAdmin() && canManage">{{\'main.button.refreshResults\' | translate}}</md-button> <md-button class="md-raised" ng-click="checkComplies()" ng-if="auth.isAdmin()">{{\'main.button.checkComplies\' | translate}}</md-button> <md-button class="md-raised" ng-click="committeeDecision()" ng-if="auth.isAdmin() && canManage">{{\'main.button.committeeDecision\' | translate}}</md-button> </div> </div> </div>'),
a.put("scholarship/scholarship.application.reject.edit.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div layout="column"> <div layout="row" flex="100" flex-sm="100" flex-xs="100"> {{scholarshipType === \'scholarships\' ? \'stipend.reject.stipendStudentList\' : \'stipend.reject.grantStudentList\' | translate}} </div> </div> <form name="rejectForm"> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'stipend.fullName\' | translate}}</th> <th md-column>{{\'stipend.student.idCode\' | translate}}</th> <th md-column>{{\'stipend.student.studentGroup\' | translate}}</th> <th md-column class="required">{{\'stipend.rejectComment\' | translate}}</th> <th md-column>&nbsp;</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="rejection in rejections" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{rejection.fullName}}</td> <td md-cell>{{rejection.idCode}}</td> <td md-cell>{{rejection.studentGroup}}</td> <td md-cell> <md-input-container flex> <input flex type="text" ng-model="rejection.rejectComment" style="width: 100%" autofocus md-maxlength="100" required> </md-input-container> </td> <td md-cell> <md-button class="remove nomargin" ng-click="removeFromArray(rejections, rejection)">&times;</md-button> </td> </tr> </tbody> </table> </form> <div layout="row"> <md-button class="md-raised md-primary" ng-if="rejections.length > 0" ng-click="reject()">{{\'main.button.reject\' | translate}}</md-button> <md-button class="md-raised" ng-click="back(\'#/scholarships/applications/\' + scholarshipType)">{{\'main.button.back\' | translate}}</md-button> </div> </div>'),a.put("scholarship/scholarship.decision.edit.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <form name="decisionForm"> <div layout="row"> <md-input-container flex> <label>{{\'stipend.decision.protocolNr\' | translate}}</label> <input type="text" ng-model="decision.protocolNr" md-maxlength="50"> </md-input-container> </div> <div layout="row"> <md-input-container flex> <label>{{\'stipend.decision.decided\' | translate}}</label> <md-datepicker ng-model="decision.decided" required></md-datepicker> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex> <label>{{\'stipend.decision.addInfo\' | translate}}</label> <textarea ng-model="decision.addInfo" md-maxlength="4000" max-rows="10"></textarea> </md-input-container> </div> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'stipend.committee\' | translate}}</legend> <div flex="30" flex-sm="100" flex-xs="100"> <md-input-container> <label>{{\'stipend.committee\' | translate}}</label> <hois-select ng-model="formState.committee" values="formState.committees" ng-change="selectedCommitteeChanged()" required></hois-select> </md-input-container> </div> <md-table-container ng-if="formState.committeeMembers"> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'stipend.decision.name\' | translate}}</th> <th md-column>{{\'stipend.decision.role\' | translate}}</th> <th md-column>{{\'stipend.decision.present\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in formState.committeeMembers | orderBy: \'memberName\'" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{row.memberName}}</td> <td md-cell ng-if="row.isChairman">{{\'stipend.decision.chairman\' | translate}}</td> <td md-cell ng-if="!row.isChairman">{{\'stipend.decision.member\' | translate}}</td> <td md-cell> <md-checkbox aria-label="module" ng-model="row.isPresent"></md-checkbox> </td> </tr> </tbody> </table> </md-table-container> </fieldset> </form> <div ng-include="\'scholarship/templates/scholarship.applications.\'+scholarshipType+\'.html\'"></div> <div layout="row"> <md-button class="md-raised md-primary" ng-click="decide()">{{\'main.button.decide\' | translate}}</md-button> <md-button class="md-raised" ng-click="back(\'#/scholarships/applications/\' + scholarshipType, decisionForm)">{{\'main.button.back\' | translate}}</md-button> </div> </div>'),a.put("scholarship/scholarship.decision.view.html",'<div class="ois-form-layout-padding ois-form-layout form-readonly" ng-cloak> <form name="decisionForm"> <div layout="row"> <md-input-container flex> <label>{{\'stipend.decision.protocolNr\' | translate}}</label> <hois-value value="decision.protocolNr"></hois-value> </md-input-container> </div> <div layout="row"> <md-input-container flex> <label>{{\'stipend.decision.decided\' | translate}}</label> <hois-value value="decision.decided | hoisDate"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex> <label>{{\'stipend.decision.addInfo\' | translate}}</label> <hois-value value="decision.addInfo"></hois-value> </md-input-container> </div> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'stipend.committee\' | translate}}</legend> <br> <div layout="row"> <md-input-container flex> <label>{{\'stipend.decision.name\' | translate}}</label> <hois-value value="decision.committeeName"></hois-value> </md-input-container> </div> <md-table-container ng-if="decision.committeeMembers"> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'stipend.decision.name\' | translate}}</th> <th md-column>{{\'stipend.decision.role\' | translate}}</th> <th md-column>{{\'stipend.decision.present\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in decision.committeeMembers | orderBy: \'memberName\'" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{row.memberName}}</td> <td md-cell ng-if="row.isChairman">{{\'stipend.decision.chairman\' | translate}}</td> <td md-cell ng-if="!row.isChairman">{{\'stipend.decision.member\' | translate}}</td> <td md-cell> <md-checkbox aria-label="module" ng-model="row.isPresent" disabled></md-checkbox> </td> </tr> </tbody> </table> </md-table-container> </fieldset> </form> <div ng-include="\'scholarship/templates/scholarship.applications.\'+scholarshipType+\'.html\'"></div> <div layout="row"> <md-button class="md-raised" ng-if="auth.isAdmin()" ng-click="delete()">{{\'main.button.delete\' | translate}}</md-button> <md-button class="md-raised" ng-click="back(\'#/scholarships/applications/\' + scholarshipType)">{{\'main.button.back\' | translate}}</md-button> </div> </div>'),a.put("scholarship/scholarship.edit.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <form name="stipendForm"> <div layout="row" flex> <md-input-container flex> <label class="textInput">{{formState.typeIsScholarship ? \'stipend.scholarshipType\' : \'stipend.grantType\' | translate}}</label> <hois-classifier-select ng-model="stipend.type" name="type" ng-change="stipendTypeChanged()" model-value-attr="code" main-classifier-code="STIPTOETUS" ng-disabled="stipend.type" required show-only-values="formState.allowedStipendTypes"></hois-classifier-select> </md-input-container> </div> <div ng-include="templateName"></div> </form> </div> <div layout="row" ng-if="!stipend.type"> <md-button class="md-raised" ng-click="back(\'#/scholarships/\' + formState.typeIsScholarship ? \'scholarships\' : \'grants\', stipendForm)">{{\'main.button.back\' | translate}}</md-button> </div> </div>'),a.put("scholarship/scholarship.relatedFiles.edit.html",'<legend ng-if="editable || application.files.length > 0" md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.relatedFiles\' | translate}}</legend> <md-button ng-if="editable && application.canApply" class="md-raised" ng-click="openAddFileDialog()">{{\'main.button.uploadFile\' | translate}}</md-button> <br> <md-table-container> <table md-table class="secondary-table" ng-if="application.files.length > 0"> <thead md-head> <tr md-row> <th md-column> <span>{{\'file.nameAndFile\' | translate}}</span> </th> <th md-column ng-if="editable && application.canApply"></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="file in application.files | orderBy: \'id\'" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell> <div layout="row" flex> <div flex="80"> {{file.oisFile.fname ? file.oisFile.fname : file.fname}} </div> <div ng-if="file.oisFile" flex> <a ng-href="{{getUrl(file.oisFile, \'scholarshipapplication\')}}" download target="_blank" rel="noopener noreferrer"> <md-icon md-font-set="material-icons">file_download</md-icon> </a> </div> </div> </td> <td md-cell ng-if="editable && application.canApply"> <md-button class="remove nomargin" ng-click="removeFile(application.files, file)">&times;</md-button> </td> </tr> </tbody> </table> </md-table-container>'),a.put("scholarship/scholarship.search.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div layout="column"> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <form ng-submit="loadData()" novalidate ng-model-options="{allowInvalid: true}"> <div layout="row" flex> <md-input-container flex> <label class="textInput">{{formState.typeIsScholarship ? \'stipend.scholarshipType\' : \'stipend.grantType\' | translate}}</label> <hois-classifier-select ng-model="criteria.type" name="type" model-value-attr="code" main-classifier-code="STIPTOETUS" show-only-values="allowedStipendTypes"></hois-classifier-select> </md-input-container> </div> <div layout="row" flex> <md-input-container flex> <label class="textInput">{{\'stipend.studyPeriod\' | translate}}</label> <hois-select ng-model="criteria.studyPeriod" type="studyperiodyear" sorted-query="true" preselect-current></hois-select> </md-input-container> </div> <div layout="row" flex> <md-input-container flex> <label class="textInput">{{formState.typeIsScholarship ? \'stipend.scholarshipName\' : \'stipend.grantName\' | translate}}</label> <input type="text" ng-model="criteria.nameEt" name="nameEt" md-maxlength="500"> </md-input-container> </div> <div layout="row" flex> <md-input-container flex> <label class="textInput">{{\'stipend.status\' | translate}}</label> <hois-select ng-model="criteria.isOpen" model-value-attr="code" values="statuses"></hois-select> </md-input-container> </div> <div layout="row"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> <md-button class="md-raised" ng-if="canEdit" ng-href="#/scholarships/{{scholarshipType}}/new">{{\'main.button.create\' | translate}}</md-button> </div> </form> </fieldset> <br> <md-table-container ng-cloak layout-padding> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="st.type_code">{{\'stipend.type\' | translate}}</th> <th md-column md-order-by="st.nameEt">{{\'stipend.name\' | translate}}</th> <th md-column md-order-by="st.applicationStart">{{\'stipend.applicationPeriod\' | translate}}</th> <th md-column md-order-by="st.places">{{\'stipend.places\' | translate}}</th> <th md-column md-order-by="st.isOpen">{{\'stipend.status\' | translate}}</th> <th md-column></th> <th></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell class="one-row">{{currentLanguageNameField(row.type)}}</td> <td md-cell> <a ng-href="#/scholarships/{{row.id}}/view">{{::row.nameEt}}</a> </td> <td md-cell>{{::row.applicationStart | hoisDate}} - {{::row.applicationEnd | hoisDate}}</td> <td md-cell>{{::row.places}}</td> <td md-cell>{{::row.isOpen ? \'stipend.published\' : \'stipend.underRevision\' | translate}}</td> <td md-cell> <md-button md-no-ink class="md-primary change-button" ng-if="canEdit" ng-click="changeStipend(row)"> {{\'main.button.change\' | translate}} </md-button> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\' }" md-page-select></md-table-pagination> </div> </div>'),a.put("scholarship/scholarship.view.html",'<div ng-include="templateName"></div>'),a.put("school/final.doc.signer.edit.html",'<div layout="column" layout-padding> <div> <form name="finalDocSignerForm"> <md-input-container class="md-block"> <label>{{\'finalDocSigner.name\' | translate}}</label> <input ng-model="record.name" name="name" type="text" required md-maxlength="100"> </md-input-container> <md-input-container class="md-block"> <label>{{\'finalDocSigner.position\' | translate}}</label> <input ng-model="record.position" name="position" type="text" required md-maxlength="255"> </md-input-container> <md-input-container class="md-block" ng-if="auth.higher"> <label>{{\'finalDocSigner.positionEn\' | translate}}</label> <input ng-model="record.positionEn" name="positionEn" type="text" required md-maxlength="255"> </md-input-container> <div layout="column"> <md-checkbox ng-model="record.isFirst" aria-label="{{\'finalDocSigner.isFirst\' | translate}}"> {{\'finalDocSigner.isFirst\' | translate}} </md-checkbox> <md-checkbox ng-model="record.isValid" aria-label="{{\'finalDocSigner.isValid\' | translate}}"> {{\'finalDocSigner.isValid\' | translate}} </md-checkbox> </div> </form> <md-button ng-click="update()" class="md-raised md-primary">{{\'main.button.save\' | translate}}</md-button> <md-button ng-click="delete()" ng-if="record.id" class="md-raised">{{\'main.button.delete\' | translate}}</md-button> <md-button ng-href="#/school/finaldocsigners" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </div> </div>'),a.put("school/final.doc.signer.search.html",'<div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="name">{{\'finalDocSigner.name\' | translate}}</th> <th md-column md-order-by="position">{{\'finalDocSigner.position\' | translate}}</th> <th md-column md-order-by="positionEn" ng-if="auth.higher">{{\'finalDocSigner.positionEn\' | translate}}</th> <th md-column md-order-by="isFirst">{{\'finalDocSigner.isFirst\' | translate}}</th> <th md-column md-order-by="isValid">{{\'finalDocSigner.isValid\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{::row.name}}</td> <td md-cell>{{::row.position}}</td> <td md-cell ng-if="auth.higher">{{::row.positionEn}}</td> <td md-cell>{{::row.isFirst ? \'main.yes\' : \'main.no\' | translate}}</td> <td md-cell>{{::row.isValid ? \'main.yes\' : \'main.no\' | translate}}</td> <td md-cell> <md-button md-no-ink class="md-primary change-button" ng-if="isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_LOPDOKALLKIRI\')" ng-href="#/school/finaldocsigners/{{::row.id}}/edit">{{\'main.button.change\' | translate}}</md-button> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> <div layout="row"> <md-button class="md-raised" ng-if="isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_LOPDOKALLKIRI\')" ng-href="#/school/finaldocsigners/new">{{\'main.button.create\' | translate}}</md-button> </div> </div>'),a.put("school/school.capacity.type.html",'<div ng-cloak ng-if="auth.higher && auth.vocational"> <div ng-include="\'school/school.capacity.type.navbar.html\'"></div> </div> <div layout="column" layout-padding> <div> <form name="schoolStudyLevelsForm"> <md-tablecontainer> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column> <md-checkbox ng-model="selectAll" ng-change="updateAllCheckBoxes(selectAll)"> </md-checkbox> </th> <th md-column>{{\'schoolCapacityType.type\' | translate}}</th> <th md-column>{{\'schoolCapacityType.isTimetable\' | translate}}</th> <th md-column>{{auth.higher ? (\'schoolCapacityType.teacherLoadPercentageHigher\' | translate) : (\'schoolCapacityType.teacherLoadPercentageVocational\' | translate)}}</th> <th md-column>&nbsp;</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="capacityType in capacityTypes" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell> <md-checkbox ng-model="capacityType.isUsable" ng-change="isUsableChanged(capacityType)"> </md-checkbox> </td> <td md-cell>{{currentLanguageNameField(capacityMap[capacityType.typeCode])}}</td> <td md-cell> <md-checkbox ng-model="capacityType.isTimetable" ng-disabled="!capacityType.isUsable"> </md-checkbox> </td> <td md-cell> <div ng-repeat="load in capacityType.loads"> {{load.loadPercentage}} ({{currentLanguageNameField(studyYearMap[load.studyYearId])}}) </div> </td> <td md-cell> <md-button md-no-ink class="md-primary change-button" ng-if="canEdit && capacityType.id && capacityType.isUsable" ng-click="changeLoads(capacityType)">{{\'main.button.change\' | translate}}</md-button> </td> </tr> </tbody> </table> </md-tablecontainer> </form> <md-button ng-if="canEdit" ng-click="update()" class="md-raised md-primary">{{\'main.button.save\' | translate}}</md-button> </div> </div>'),a.put("school/school.capacity.type.load.dialog.html",'<md-dialog aria-label="capacity type load dialog" flex="50" flex-xs="100"> <form name="dialogForm" ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2>{{currentLanguageNameField(capacityType)}}</h2> <span flex></span> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <span flex></span> <div class="ois-form-layout md-dialog-content" layout="column" flex ng-cloak> <md-table-container> <table md-table> <thead md-head> <tr md-row> <th md-column>{{\'schoolCapacityType.studyYear\' | translate}}</th> <th md-column>{{\'schoolCapacityType.loadPercentage\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in studyYears" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{currentLanguageNameField(studyYearMap[row.studyYearId])}}</td> <td md-cell> <md-input-container class="md-block"> <input ng-model="row.loadPercentage" name="loadPercentage" type="number" min="0" max="100"> </md-input-container> </td> </tr> </tbody> </table> </md-table-container> </div> </md-dialog-content> <md-dialog-actions layout="row" layout-align="start center"> <md-button class="md-raised md-primary" ng-click="submit()">{{"main.button.save" | translate}}</md-button> <md-button class="md-raised" ng-click="cancel()">{{"main.button.close" | translate}}</md-button> </md-dialog-actions> </form> </md-dialog>'),a.put("school/school.capacity.type.navbar.html",'<md-nav-bar md-selected-nav-item="currentNavItem" nav-bar-aria-label="main selection"> <md-nav-item md-nav-click="switchHigher(false)" name="school.capacityType.vocational">{{\'main.vocational\' | translate}}</md-nav-item> <md-nav-item md-nav-click="switchHigher(true)" name="school.capacityType.higher">{{\'main.higher\' | translate}}</md-nav-item> </md-nav-bar>'),a.put("school/school.department.edit.html",'<div layout="column" layout-padding> <div> <form name="schoolDepartmentForm"> <md-input-container class="md-block"> <label>{{\'school.department.code\' | translate}}</label> <input ng-model="schoolDepartment.code" name="code" type="text" required md-maxlength="50"> </md-input-container> <md-input-container class="md-block"> <label class="textInput">{{\'school.department.nameEt\' | translate}}</label> <input ng-model="schoolDepartment.nameEt" name="nameEt" type="text" required md-maxlength="255"> </md-input-container> <md-input-container class="md-block"> <label class="textInput">{{\'school.department.nameEn\' | translate}}</label> <input ng-model="schoolDepartment.nameEn" name="nameEn" type="text" md-maxlength="255"> </md-input-container> <md-input-container class="md-block"> <label>{{\'school.department.parent\' | translate}}</label> <hois-school-department-select ng-model="schoolDepartment.parentSchoolDepartment" name="parentSchoolDepartment" excluded-id="schoolDepartment.id"></hois-school-department-select> </md-input-container> <div layout="row"> <div flex="100"> <md-input-container flex> <label>{{\'school.department.validFrom\' | translate}}</label> <md-datepicker ng-model="schoolDepartment.validFrom" md-max-date="schoolDepartment.validThru" required></md-datepicker> </md-input-container> <md-input-container flex> <label>{{\'school.department.validThru\' | translate}}</label> <md-datepicker ng-model="schoolDepartment.validThru" md-min-date="schoolDepartment.validFrom"></md-datepicker> </md-input-container> </div> </div> </form> <md-button ng-click="update()" class="md-raised md-primary">{{\'main.button.save\' | translate}}</md-button> <md-button ng-click="delete()" ng-if="schoolDepartment.id" class="md-raised">{{\'main.button.delete\' | translate}}</md-button> <md-button ng-click="back(\'#/school/departments\', schoolDepartmentForm)" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </div> </div>'),a.put("school/school.department.list.html",'<div class="ois-form-layout-padding"> <div flex> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <form name="searchForm" ng-submit="searchForm.$valid && loadData()" novalidate class="nomargin" layout="column" ng-model-options="{allowInvalid: true}"> <div layout="row" layout-sm="column" layout-xs="column"> <!--div class="indentForToast"></div--> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'school.department.code\' | translate}}</label> <input ng-model="criteria.code" name="code" type="text" md-maxlength="50" autofocus> </md-input-container> <md-input-container flex="50" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label class="textInput">{{\'school.department.name\' | translate}}</label> <input ng-model="criteria.name" name="name" type="text" md-maxlength="255"> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container> <md-checkbox ng-model="criteria.valid" name="valid"> {{\'school.department.validTrue\' | translate}} </md-checkbox> </md-input-container> </div> <div layout="row"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> <md-button class="md-raised" ng-if="isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_STRUKTUUR\')" ng-href="#/school/departments/new">{{\'main.button.create\' | translate}}</md-button> </div> <div flex-xs="0" flex-gt-xs="0" flex-gt-sm="50"></div> </form> </fieldset> </div> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="code">{{\'school.department.code\' | translate}}</th> <th md-column md-order-by="{{currentLanguage()===\'en\' ? \'nameEn\' : \'nameEt\'}}">{{\'school.department.name\' | translate}}</th> <th md-column>{{\'school.department.status\' | translate}}</th> <th md-column md-order-by="validFrom">{{\'school.department.validFrom\' | translate}}</th> <th md-column md-order-by="validThru">{{\'school.department.validThru\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{::row.code}}</td> <td md-cell style="padding-left:{{15*row.indent}}px"> <a md-no-ink class="md-primary change-button" ng-href="#/school/departments/{{::row.id}}/view">{{currentLanguageNameField(row)}}</a> </td> <td md-cell>{{row.isValid ? \'school.department.validTrue\' : \'school.department.validFalse\' | translate}}</td> <td md-cell>{{::row.validFrom | hoisDate}}</td> <td md-cell>{{::row.validThru | hoisDate}}</td> <td md-cell> <md-button md-no-ink class="md-primary change-button" ng-if="isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_STRUKTUUR\')" ng-href="#/school/departments/{{::row.id}}/edit">{{\'main.button.change\' | translate}}</md-button> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> </div>'),a.put("school/school.department.view.html",'<div class="form-readonly" layout="column" layout-padding> <div> <form name="schoolDepartmentForm"> <md-input-container class="md-block"> <label>{{\'school.department.code\' | translate}}</label> <hois-value value="schoolDepartment.code"></hois-value> </md-input-container> <md-input-container class="md-block"> <label class="textInput">{{\'school.department.nameEt\' | translate}}</label> <hois-value value="schoolDepartment.nameEt"></hois-value> </md-input-container> <md-input-container class="md-block"> <label class="textInput">{{\'school.department.nameEn\' | translate}}</label> <hois-value value="schoolDepartment.nameEn"></hois-value> </md-input-container> <md-input-container class="md-block"> <label>{{\'school.department.parent\' | translate}}</label> <hois-value value="schoolDepartment.parentSchoolDepartment"></hois-value> </md-input-container> <div layout="row" flex="100"> <md-input-container flex="20"> <label>{{\'school.department.validFrom\' | translate}}</label> <hois-value value="schoolDepartment.validFrom | hoisDate"></hois-value> </md-input-container> <md-input-container flex="20" flex-offset="5"> <label>{{\'school.department.validThru\' | translate}}</label> <hois-value value="schoolDepartment.validThru | hoisDate"></hois-value> </md-input-container> </div> <md-button ng-if="isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_STRUKTUUR\')" ng-href="#/school/departments/{{::schoolDepartment.id}}/edit" class="md-raised md-primary">{{\'main.button.edit\' | translate}}</md-button> <md-button ng-href="#/school/departments" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </form> </div> </div>'),a.put("school/school.edit.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <form name="schoolForm"> <!--p class="textInput">{{\'school.name\' | translate}}&nbsp;*</p--> <md-autocomplete md-floating-label="{{\'school.name\' | translate}}" required md-selected-item="school._ehisSchool" md-search-text="queryText" md-items="item in querySearch(queryText)" md-item-text="currentLanguage()===\'en\' ? (item.nameEn || item.nameEt) : item.nameEt" md-min-length="0" md-no-cache md-selected-item-change="setEhisSchool()"> <md-item-template> <span md-highlight-text="queryText" md-highlight-flags="^i">{{currentLanguage()===\'en\' ?(item.nameEn || item.nameEt) : item.nameEt}}</span> </md-item-template> <md-not-found> {{\'main.messages.error.notFound\' | translate}} </md-not-found> </md-autocomplete> <md-input-container class="md-block"> <label class="textInput">{{\'school.nameGenitiveEt\' | translate}}</label> <input ng-model="school.nameGenitiveEt" name="nameGenitiveEt" type="text" md-maxlength="255"> </md-input-container> <md-input-container class="md-block"> <label class="textInput">{{\'school.code\' | translate}}</label> <input ng-model="school.code" name="code" type="text" required md-maxlength="10"> </md-input-container> <md-input-container class="md-block"> <label class="textInput">{{\'school.regNr\' | translate}}</label> <input ng-model="school.regNr" type="text" readonly> </md-input-container> <md-input-container class="md-block"> <label class="textInput">{{\'school.ehisId\' | translate}}</label> <input ng-model="school.ehisId" type="text" readonly> </md-input-container> <md-input-container class="md-block"> <label class="textInput">{{\'school.nameEn\' | translate}}</label> <input ng-model="school.nameEn" name="nameEn" type="text" required md-maxlength="255"> </md-input-container> <md-input-container class="md-block"> <label class="textInput">{{\'school.email\' | translate}}</label> <input ng-model="school.email" name="email" type="email" required md-maxlength="255"> </md-input-container> <md-input-container class="md-block"> <label class="textInput">{{\'school.phone\' | translate}}</label> <input ng-model="school.phone" name="phone" type="text" md-maxlength="100"> </md-input-container> <div class="md-block"> <hois-ads-adapter class="md-text" ng-model="school.addressAds" ads-oid-model="school.addressAdsOid" address-model="school.address"></hois-ads-adapter> </div> <md-input-container class="md-block"> <md-checkbox ng-model="school.generateUserEmail" name="generateUserEmail"> {{\'school.generateUserEmail\' | translate}} </md-checkbox> </md-input-container> <md-input-container class="md-block"> <label class="textInput">{{\'school.emailDomain\' | translate}}</label> <input ng-model="school.emailDomain" name="emailDomain" type="text" md-maxlength="255"> </md-input-container> <md-input-container class="md-block"> <label class="textInput">{{\'school.rtipSchoolCode\' | translate}}</label> <input ng-model="school.rtipSchoolCode" name="rtipSchoolCode" type="text" md-maxlength="10"> </md-input-container> <md-input-container class="md-block"> <md-checkbox ng-model="school.isMinorStudentAbsence" name="isMinorStudentAbsence"> {{\'school.isMinorStudentAbsence\' | translate}} </md-checkbox> </md-input-container> <md-input-container ng-if="school.type.higher" class="md-block"> <md-checkbox ng-model="school.isLetterGrade" name="isLetterGrade"> {{\'school.isLetterGrade\' | translate}} </md-checkbox> </md-input-container> <md-input-container class="md-block"> <md-checkbox ng-model="school.isWithoutEkis" name="isWithoutEkis"> {{\'school.isWithoutEkis\' | translate}} </md-checkbox> </md-input-container> <md-input-container class="md-block"> <label class="textInput">{{\'school.adUrl\' | translate}}</label> <input ng-model="school.adUrl" name="adUrl" type="text" md-maxlength="255"> </md-input-container> <md-input-container class="md-block"> <label class="textInput">{{\'school.adPort\' | translate}}</label> <input ng-model="school.adPort" name="adPort" type="number" min="0" max="32767"> </md-input-container> <md-input-container class="md-block"> <label class="textInput">{{\'school.adDomain\' | translate}}</label> <input ng-model="school.adDomain" name="adDomain" type="text" md-maxlength="255"> </md-input-container> <md-input-container class="md-block"> <label class="textInput">{{\'school.adBase\' | translate}}</label> <input ng-model="school.adBase" name="adBase" type="text" md-maxlength="255"> </md-input-container> <md-input-container class="md-block"> <label class="textInput">{{\'school.adIdcodeField\' | translate}}</label> <input ng-model="school.adIdcodeField" name="adIdcodeField" type="text" md-maxlength="50"> </md-input-container> <md-input-container class="md-block"> <label class="textInput">{{\'school.finalSchoolType\' | translate}}</label> <input ng-model="school.finalSchoolType" name="finalSchoolType" type="text" md-maxlength="100"> </md-input-container> <md-input-container class="md-block"> <label class="textInput">{{\'school.final62\' | translate}}</label> <textarea ng-model="school.final62" name="final62" md-maxlength="500" max-rows="10"></textarea> </md-input-container> <md-input-container class="md-block"> <label class="textInput">{{\'school.finalSchoolTypeEn\' | translate}}</label> <input ng-model="school.finalSchoolTypeEn" name="finalSchoolType" type="text" md-maxlength="100"> </md-input-container> <md-input-container class="md-block"> <label class="textInput">{{\'school.finalEn62\' | translate}}</label> <textarea ng-model="school.finalEn62" name="finalEn62" md-maxlength="500" max-rows="10"></textarea> </md-input-container> <lf-ng-md-file-input name="logoFiles" lf-files="logoFiles" lf-api="logoFileApi" lf-filesize="100KB" accept=".png, .jpg, .jpeg" lf-mimetype="image/*" preview lf-placeholder="{{\'school.logo.notSelected\' | translate}}" lf-browse-label="{{\'school.logo.selectLogo\' | translate}}" lf-remove-label="{{\'main.button.clear\' | translate}}"></lf-ng-md-file-input> <div ng-messages="schoolForm.logoFiles.$error" style="color:red"> <div ng-message="filesize">{{\'main.messages.error.fileTooLarge\' | translate}} 100KB!</div> <div ng-message="mimetype">{{\'main.messages.error.wrongExtension\' | translate}} png, jpg, jpeg</div> </div> </form> <h3 ng-if="school.logo">{{\'school.logo.currentLogo\' | translate}}</h3> <img ng-if="school.logo" ng-src="{{school.imageUrl}}" id="currentLogoView"> <br> <md-checkbox ng-model="school.deleteCurrentLogo" ng-if="school.id && school.logo && !logoFiles[0]"> {{\'school.logo.delete\' | translate}} </md-checkbox> <br> <md-button ng-click="update()" class="md-raised md-primary">{{\'main.button.save\' | translate}}</md-button> <md-button ng-click="delete()" ng-if="school.id" class="md-raised">{{\'main.button.delete\' | translate}}</md-button> <md-button ng-click="back(\'#/school\', schoolForm)" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </div>'),
a.put("school/school.list.html",'<div layout-padding> <div flex> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <form ng-submit="loadData()" novalidate> <div layout="row"> <div flex-xs="100" flex-gt-xs="100" flex-gt-sm="50" layout="column"> <!--div class="indentForToast"></div--> <md-input-container> <label class="textInput">{{\'school.name\' | translate}}</label> <input ng-model="criteria.name" name="name" type="text" autofocus> </md-input-container> <div layout="row"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> <md-button class="md-raised" ng-href="#/school/new">{{\'main.button.create\' | translate}}</md-button> </div> </div> <div flex-xs="0" flex-gt-xs="0" flex-gt-sm="50"></div> </div> </form> </fieldset> </div> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="code">{{\'school.code\' | translate}}</th> <th md-column md-order-by="{{currentLanguage()===\'en\' ? \'nameEn\' : \'nameEt\'}}">{{\'school.name\' | translate}}</th> <th md-column md-order-by="email">{{\'school.email\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell> <a md-no-ink class="md-primary" ng-href="#/school/{{::row.id}}/view">{{::row.code}}</a> </td> <td md-cell>{{currentLanguageNameField(row)}}</td> <td md-cell>{{::row.email}}</td> <td md-cell> <md-button md-no-ink class="md-primary change-button" ng-href="#/school/{{::row.id}}/edit">{{\'main.button.change\' | translate}}</md-button> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\' }" md-page-select></md-table-pagination> </div> </div>'),a.put("school/school.study.levels.html",'<div layout="column" layout-padding> <div> <form name="schoolStudyLevelsForm"> <!--div class="indentForToast"></div--> <!--h3>{{currentLanguageNameField(studyLevels)}}</h3--> <md-list> <md-list-item ng-repeat="studyLevel in studyLevelDefs"> <span> <md-checkbox ng-model="studyLevel._selected" ng-disabled="!canEdit"> {{currentLanguageNameField(studyLevel)}} </md-checkbox> </span> </md-list-item> </md-list> </form> <md-button ng-if="canEdit" ng-click="update()" class="md-raised md-primary">{{\'main.button.save\' | translate}}</md-button> </div> </div>'),a.put("school/school.view.html",'<div class="ois-form-layout-padding ois-form-layout form-readonly" ng-cloak> <form name="schoolForm"> <md-input-container class="md-block"> <label class="textInput">{{\'school.name\' | translate}}</label> <hois-value value="school.nameEt"></hois-value> </md-input-container> <md-input-container class="md-block"> <label class="textInput">{{\'school.nameGenitiveEt\' | translate}}</label> <hois-value value="school.nameGenitiveEt"></hois-value> </md-input-container> <md-input-container class="md-block"> <label class="textInput">{{\'school.code\' | translate}}</label> <hois-value value="school.code"></hois-value> </md-input-container> <md-input-container class="md-block"> <label class="textInput">{{\'school.regNr\' | translate}}</label> <hois-value value="school.regNr"></hois-value> </md-input-container> <md-input-container class="md-block"> <label class="textInput">{{\'school.ehisId\' | translate}}</label> <hois-value value="school.ehisId"></hois-value> </md-input-container> <md-input-container class="md-block"> <label class="textInput">{{\'school.nameEn\' | translate}}</label> <hois-value value="school.nameEn"></hois-value> </md-input-container> <md-input-container class="md-block"> <label class="textInput">{{\'school.email\' | translate}}</label> <hois-value value="school.email"></hois-value> </md-input-container> <md-input-container class="md-block"> <label class="textInput">{{\'school.phone\' | translate}}</label> <hois-value value="school.phone"></hois-value> </md-input-container> <md-input-container class="md-block"> <label class="textInput">{{\'school.address\' | translate}}</label> <hois-value value="school.address"></hois-value> </md-input-container> <md-input-container class="md-block"> <label class="textInput">{{\'school.generateUserEmail\' | translate}}</label> <hois-value value="school.generateUserEmail ? \'main.yes\' : \'main.no\' | translate"></hois-value> </md-input-container> <md-input-container class="md-block"> <label class="textInput">{{\'school.emailDomain\' | translate}}</label> <hois-value value="school.emailDomain"></hois-value> </md-input-container> <md-input-container class="md-block"> <label class="textInput">{{\'school.rtipSchoolCode\' | translate}}</label> <hois-value value="school.rtipSchoolCode"></hois-value> </md-input-container> <md-input-container class="md-block"> <label class="textInput">{{\'school.isMinorStudentAbsence\' | translate}}</label> <hois-value value="school.isMinorStudentAbsence ? \'main.yes\' : \'main.no\' | translate"></hois-value> </md-input-container> <md-input-container ng-if="school.type.higher" class="md-block"> <label class="textInput">{{\'school.isLetterGrade\' | translate}}</label> <hois-value value="school.isLetterGrade ? \'main.yes\' : \'main.no\' | translate"></hois-value> </md-input-container> <md-input-container class="md-block"> <label class="textInput">{{\'school.isWithoutEkis\' | translate}}</label> <hois-value value="school.isWithoutEkis ? \'school.notUsing\' : \'school.using\' | translate"></hois-value> </md-input-container> <md-input-container class="md-block"> <label class="textInput">{{\'school.adUrl\' | translate}}</label> <hois-value value="school.adUrl"></hois-value> </md-input-container> <md-input-container class="md-block"> <label class="textInput">{{\'school.adPort\' | translate}}</label> <hois-value value="school.adPort"></hois-value> </md-input-container> <md-input-container class="md-block"> <label class="textInput">{{\'school.adDomain\' | translate}}</label> <hois-value value="school.adDomain"></hois-value> </md-input-container> <md-input-container class="md-block"> <label class="textInput">{{\'school.adBase\' | translate}}</label> <hois-value value="school.adBase"></hois-value> </md-input-container> <md-input-container class="md-block"> <label class="textInput">{{\'school.adIdcodeField\' | translate}}</label> <hois-value value="school.adIdcodeField"></hois-value> </md-input-container> <md-input-container class="md-block"> <label class="textInput">{{\'school.finalSchoolType\' | translate}}</label> <hois-value value="school.finalSchoolType"></hois-value> </md-input-container> <md-input-container class="md-block"> <label class="textInput">{{\'school.final62\' | translate}}</label> <hois-value value="school.final62"></hois-value> </md-input-container> <md-input-container class="md-block"> <label class="textInput">{{\'school.finalSchoolTypeEn\' | translate}}</label> <hois-value value="school.finalSchoolTypeEn"></hois-value> </md-input-container> <md-input-container class="md-block"> <label class="textInput">{{\'school.finalEn62\' | translate}}</label> <hois-value value="school.finalEn62"></hois-value> </md-input-container> </form> <h3 ng-if="school.logo">{{\'school.logo.currentLogo\' | translate}}</h3> <div> <img ng-if="school.logo" ng-src="{{school.imageUrl}}"> </div> <br> <md-button ng-href="#/school/{{school.id}}/edit" class="md-raised md-primary">{{\'main.button.change\' | translate}}</md-button> <md-button ng-href="#/school" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </div>'),a.put("stateCurriculum/state.curriculum.html",'<div class="ois-form-layout-padding"> <div flex> <form name="stateCurriculumForm" layout="column" class="nomargin"> <fieldset tabindex="1" flex> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'curriculum.mainData\' | translate}}</legend> <div layout="column"> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="50" flex-sm="100" flex-xs="100"> <label>{{\'stateCurriculum.enter.nameEt\' | translate}}</label> <input ng-model="stateCurriculum.nameEt" type="text" required md-maxlength="255" name="nameEt" ng-model-options="{ debounce: 250 }" unique="nameEtUniqueQuery"> <div ng-messages="stateCurriculumForm.nameEt.$error" ng-show="stateCurriculumForm.nameEt.$dirty"> <div ng-message="notUnique"> {{\'stateCurriculum.error.unique.name\' | translate}} </div> </div> </md-input-container> <md-input-container flex="45" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'stateCurriculum.enter.nameEn\' | translate}}</label> <input ng-model="stateCurriculum.nameEn" type="text" required md-maxlength="255" name="nameEn" ng-model-options="{ debounce: 250 }" unique="nameEnUniqueQuery"> <div ng-messages="stateCurriculumForm.nameEn.$error" ng-show="true"> <div ng-message="notUnique"> {{\'stateCurriculum.error.unique.name\' | translate}} </div> </div> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="25" flex-sm="100" flex-xs="100"> <label>{{\'curriculum.areaOfStudy\' | translate}}</label> <hois-classifier-select ng-model="iscedVald" main-classifier-code="ISCED_VALD" criteria="{vocational: true}" required model-value-attr="code"></hois-classifier-select> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'curriculum.fieldOfStudy\' | translate}}</label> <hois-classifier-select ng-model="iscedSuun" main-classifier-code="ISCED_SUUN" criteria="{vocational: true}" watch-model="iscedVald" model-value-attr="code" filter-values search-from-connect connect-main-classifier-code="ISCED_VALD" required></hois-classifier-select> </md-input-container> <md-input-container flex="45" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'curriculum.group\' | translate}}</label> <hois-classifier-select ng-model="stateCurriculum.iscedClass" main-classifier-code="ISCED_RYHM" criteria="{vocational: true}" watch-model="iscedSuun" model-value-attr="code" filter-values search-from-connect connect-main-classifier-code="ISCED_SUUN" required></hois-classifier-select> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column" class="top-margin"> <md-input-container flex="25" flex-sm="100" flex-xs="100"> <label>{{\'stateCurriculum.enter.credits.credits\' | translate}}</label> <input ng-model="stateCurriculum.credits" type="number" pattern="^\\d+$" required min="0" max="999" name="credits"> <div ng-messages="stateCurriculumForm.credits.$error" ng-show="stateCurriculumForm.credits.$dirty"> <div ng-message="min"> {{\'stateCurriculum.enter.credits.positive\' | translate}} </div> <div ng-message="max"> {{\'stateCurriculum.enter.credits.max\' | translate}} </div> <div ng-message="pattern"> {{\'stateCurriculum.enter.credits.integer\' | translate}} </div> </div> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'stateCurriculum.enter.ROKclassifier\' | translate}}</label> <hois-classifier-select ng-model="stateCurriculum.stateCurrClass" main-classifier-code="EHIS_ROK" criteria="{vocational: true}" required model-value-attr="code"></hois-classifier-select> </md-input-container> </div> </div> </fieldset> <div>&nbsp;</div> <fieldset tabindex="2"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'curriculum.commonData\' | translate}}</legend> <div layout="column"> <md-input-container flex> <label>{{\'stateCurriculum.enter.objectivesEt\' | translate}}{{getStar()}}</label> <textarea ng-model="stateCurriculum.objectivesEt" ng-required="strictValidation()" md-maxlength="20000" max-rows="10"></textarea> </md-input-container> <md-input-container flex> <label>{{\'stateCurriculum.enter.objectivesEn\' | translate}}</label> <textarea ng-model="stateCurriculum.objectivesEn" md-maxlength="20000" max-rows="10"></textarea> </md-input-container> <md-input-container flex> <label>{{\'stateCurriculum.enter.outcome.outcomeLabelEt\' | translate}}{{getStar()}}</label> <textarea ng-model="stateCurriculum.outcomesEt" ng-required="strictValidation()" md-maxlength="20000" max-rows="10"></textarea> </md-input-container> <md-input-container flex> <label>{{\'stateCurriculum.enter.outcome.outcomeLabelEn\' | translate}}</label> <textarea ng-model="stateCurriculum.outcomesEn" md-maxlength="20000" max-rows="10"></textarea> </md-input-container> <md-input-container flex> <label>{{\'stateCurriculum.enter.admission.requirementsEt\' | translate}}{{getStar()}}</label> <textarea ng-model="stateCurriculum.admissionRequirementsEt" ng-required="strictValidation()" md-maxlength="20000" max-rows="10"></textarea> </md-input-container> <md-input-container flex> <label>{{\'stateCurriculum.enter.admission.requirementsEn\' | translate}}</label> <textarea ng-model="stateCurriculum.admissionRequirementsEn" md-maxlength="20000" max-rows="10"></textarea> </md-input-container> <md-input-container flex> <label>{{\'stateCurriculum.enter.graduation.requirementsEt\' | translate}}{{getStar()}}</label> <textarea ng-model="stateCurriculum.graduationRequirementsEt" ng-required="strictValidation()" md-maxlength="20000" max-rows="10"></textarea> </md-input-container> <md-input-container flex> <label>{{\'stateCurriculum.enter.graduation.requirementsEn\' | translate}}</label> <textarea ng-model="stateCurriculum.graduationRequirementsEn" md-maxlength="20000" max-rows="10"></textarea> </md-input-container> </div> </fieldset> <div>&nbsp;</div> <fieldset tabindex="3" flex> <legend md-colors="{color: \'primary-800\'}" class="md-title-small" ng-class="{invalid: stateCurriculumForm.$submitted && stateCurriculum.occupations.length === 0 && strictValidation()}">{{\'stateCurriculum.enter.occupation.acquiredMany\' | translate}}&nbsp;*</legend> <md-autocomplete name="occupationInput" md-selected-item="occupation" md-search-text="queryText" md-items="item in querySearch(queryText, connection.code)" md-item-text="currentLanguageNameField(item)" md-min-length="0" placeholder="{{\'stateCurriculum.enter.occupation.add\' | translate}}" ng-model="queryText" md-no-cache class="small-margin" md-selected-item-change="addOcupation(occupation)"> <md-item-template> <span md-highlight-text="queryText" md-highlight-flags="^i">{{currentLanguageNameField(item)}}</span> </md-item-template> <md-not-found> {{\'main.messages.error.notFound\' | translate}} </md-not-found> </md-autocomplete> <div> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column>Jrk</th> <th md-column>Kutse</th> <th md-column>Osakutsed</th> <th md-column>Spetsialiseerumised</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="occupation in stateCurriculum.occupations | orderBy" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{$index + 1}}</td> <td md-cell> <hois-classifier-value ng-model="occupation" main-classifier-code="KUTSE"></hois-classifier-value> </td> <td md-cell><span ng-repeat="subOccupation in subOccupations[occupation] | filter:{ mainClassCode: \'OSAKUTSE\'}"><span ng-if="$index > 0">; </span>{{currentLanguageNameField(subOccupation)}} </span> </td> <td md-cell><span ng-repeat="subOccupation in subOccupations[occupation] | filter:{ mainClassCode: \'SPETSKUTSE\'}"><span ng-if="$index > 0">; </span>{{currentLanguageNameField(subOccupation)}} </span> </td> <td md-cell><a class="remove" ng-click="removeOcupation(occupation)">&times;</a></td> </tr> </tbody> </table> </div> </fieldset> <div>&nbsp;</div> <fieldset tabindex="3" flex> <legend md-colors="{color: \'primary-800\'}" class="md-title-small" ng-class="{invalid: stateCurriculumForm.$submitted && !modulesValid()}">{{\'stateCurriculum.enter.module.modules\' | translate}}&nbsp;*</legend> <div layout="row" ng-if="stateCurriculum.occupations.length > 0"> <md-button class="md-raised" ng-click="openAddModuleDialog()">{{\'stateCurriculum.enter.module.add\' | translate}}</md-button> </div> <!--KUTSETE MOODULID--> <div ng-repeat="occupation in stateCurriculum.occupations | orderBy" layout="column"> <div class="occupation-header align-center"><span ng-class="{invalid: stateCurriculumForm.$submitted && !isOccutationValid(occupation) && strictValidation()}">{{\'stateCurriculum.enter.occupation.occupation\' | translate}} {{$index + 1}}:&nbsp;</span> <hois-classifier-value ng-model="occupation" main-classifier-code="KUTSE" ng-class="{invalid: stateCurriculumForm.$submitted && !isOccutationValid(occupation)  && strictValidation()}"></hois-classifier-value> </div> <div layout="column"> <div layout="row" flex="100" class="occupation-row align-center border-bottom odd"> <div flex="5">&nbsp;</div> <div flex="20">{{\'stateCurriculum.enter.module.modules1\' | translate}}</div> <div layout="column" flex="75"> <div flex="100" ng-repeat="module in stateCurriculum.modules | filter: filterModules(occupation, MODULE_TYPE.GENERAL) | orderBy: \'nameEt\'" layout="row" class="align-center"> <a flex="30" ng-click="openAddModuleDialog(module)" href="">{{currentLanguageNameField(module)}}</a> <span flex="10">{{module.credits}}&nbsp; EKAP</span> </div> </div> </div> <div layout="row" flex="100" class="occupation-row align-center even"> <div flex="5">&nbsp;</div> <div ng-class="{invalid: stateCurriculumForm.$submitted && hasNoPmodule(occupation) && strictValidation()}" flex="20">{{\'stateCurriculum.enter.module.modules2\' | translate}}&nbsp;*</div> <div layout="column" flex="75"> <div flex="100" ng-repeat="module in stateCurriculum.modules | filter: filterModules(occupation, MODULE_TYPE.BASIC) | orderBy: \'nameEt\'" layout="row" class="align-center"> <a flex="30" ng-click="openAddModuleDialog(module)" href="">{{currentLanguageNameField(module)}}</a> <span flex="10">{{module.credits}}&nbsp; EKAP</span> </div> </div> </div> </div> <!--OSAKUTSETE MOODULID--> <div ng-repeat="suboccupation in subOccupationsList | filter: filterSubOccupations(occupation, \'OSAKUTSE\') | orderBy: \'nameEt\'" layout="column"> <div class="occupation-header2 align-center">{{\'stateCurriculum.enter.occupation.partial\' | translate}} {{$index + 1}}: {{currentLanguageNameField(suboccupation)}}</div> <div layout="column"> <div layout="row" flex="100" class="occupation-row align-center border-bottom odd"> <div flex="5">&nbsp;</div> <div flex="20">{{\'stateCurriculum.enter.module.modules1\' | translate}}</div> <div layout="column" flex="75"> <div flex="100" ng-repeat="module in stateCurriculum.modules | filter: filterModules(suboccupation.code, MODULE_TYPE.GENERAL) | orderBy: \'nameEt\'" layout="row" class="align-center"> <a flex="30" ng-click="openAddModuleDialog(module)" href="">{{currentLanguageNameField(module)}}</a> <span flex="10">{{module.credits}}&nbsp; EKAP</span> </div> </div> </div> <div layout="row" flex="100" class="occupation-row align-center even"> <div flex="5">&nbsp;</div> <div ng-class="{invalid: stateCurriculumForm.$submitted && hasNoPmodule(suboccupation.code) && strictValidation()}" flex="20">{{\'stateCurriculum.enter.module.modules2\' | translate}}&nbsp;*</div> <div layout="column" flex="75"> <div flex="100" ng-repeat="module in stateCurriculum.modules | filter: filterModules(suboccupation.code, MODULE_TYPE.BASIC) | orderBy: \'nameEt\'" layout="row" class="align-center"> <a flex="30" ng-click="openAddModuleDialog(module)" href="">{{currentLanguageNameField(module)}}</a> <span flex="10">{{module.credits}}&nbsp; EKAP</span> </div> </div> </div> </div> </div> <!--SPETSKUTSETE MOODULID--> <div ng-repeat="suboccupation in subOccupationsList | filter: filterSubOccupations(occupation, \'SPETSKUTSE\') | orderBy: \'nameEt\'" layout="column"> <div class="occupation-header2 align-center"><span ng-class="{invalid: stateCurriculumForm.$submitted && !isSpetsOccupationValid(suboccupation.code, occupation) && strictValidation()}">{{\'stateCurriculum.enter.occupation.specialty\' | translate}} {{$index + 1}}: {{currentLanguageNameField(suboccupation)}}</span></div> <div layout="column"> <div layout="row" flex="100" class="occupation-row align-center border-bottom odd"> <div flex="5">&nbsp;</div> <div flex="20">{{\'stateCurriculum.enter.module.modules1\' | translate}}</div> <div layout="column" flex="75"> <div flex="100" ng-repeat="module in stateCurriculum.modules | filter: filterModules(suboccupation.code, MODULE_TYPE.GENERAL) | orderBy: \'nameEt\'" layout="row" class="align-center"> <a flex="30" ng-click="openAddModuleDialog(module)" href="">{{currentLanguageNameField(module)}}</a> <span flex="10">{{module.credits}}&nbsp; EKAP</span> </div> </div> </div> <div layout="row" flex="100" class="occupation-row align-center even"> <div flex="5">&nbsp;</div> <div ng-class="{invalid: stateCurriculumForm.$submitted && hasNoPmodule(suboccupation.code) && strictValidation()}" flex="20">{{\'stateCurriculum.enter.module.modules2\' | translate}}&nbsp;*</div> <div layout="column" flex="75"> <div flex="100" ng-repeat="module in stateCurriculum.modules | filter: filterModules(suboccupation.code, MODULE_TYPE.BASIC) | orderBy: \'nameEt\'" layout="row" class="align-center"> <a flex="30" ng-click="openAddModuleDialog(module)" href="">{{currentLanguageNameField(module)}}</a> <span flex="10">{{module.credits}}&nbsp; EKAP</span> </div> </div> </div> </div> </div> </div> </fieldset> <div>&nbsp;</div> <fieldset tabindex="5"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'curriculum.additionalInfo\' | translate}}</legend> <div layout="column"> <div layout="row"> <md-input-container> <label>{{\'stateCurriculum.enter.module.modules3\' | translate}}{{getStar()}}</label> <input type="number" name="optionalCredits" ng-model="stateCurriculum.optionalStudyCredits" pattern="^\\d+(\\.\\d{1})?$" ng-required="strictValidation()" aria-label="optional credits" min="0" max="999"> <div ng-messages="stateCurriculumForm.optionalCredits.$error" ng-show="stateCurriculumForm.optionalCredits.$dirty"> <div ng-message="min"> {{\'stateCurriculum.enter.credits.positive\' | translate}} </div> <div ng-message="max"> {{\'stateCurriculum.enter.credits.max\' | translate}} </div> <div ng-message="pattern"> {{\'stateCurriculum.error.decimalPresision\' | translate}} </div> </div> </md-input-container> </div> <md-input-container flex> <label>{{\'stateCurriculum.enter.practice\' | translate}}</label> <textarea ng-model="stateCurriculum.practiceDescription" md-maxlength="20000" max-rows="10"></textarea> </md-input-container> <md-input-container flex> <label>{{\'stateCurriculum.enter.finalExam\' | translate}}</label> <textarea ng-model="stateCurriculum.finalExamDescription" md-maxlength="4000" max-rows="10"></textarea> </md-input-container> <md-input-container flex> <label>{{\'stateCurriculum.enter.comment\' | translate}}</label> <textarea ng-model="stateCurriculum.description" md-maxlength="20000" max-rows="10"></textarea> </md-input-container> <md-input-container flex> <label>{{\'stateCurriculum.enter.riigiteataja\' | translate}}</label> <input ng-model="stateCurriculum.riigiteatajaUrl" type="text" md-maxlength="4000"> </md-input-container> </div> </fieldset> <div>&nbsp;</div> <fieldset tabindex="6"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'curriculum.statuses\' | translate}}</legend> <div layout="column"> <div layout="row" flex> <md-input-container> <label>{{\'stateCurriculum.enter.validFrom\' | translate}}{{getStar()}}</label> <md-datepicker ng-model="stateCurriculum.validFrom" ng-required="strictValidation()" md-open-on-focus md-max-date="stateCurriculum.validThru"> </md-datepicker> </md-input-container> <md-input-container flex-offset="5"> <label>{{\'stateCurriculum.enter.validThru\' | translate}}</label> <md-datepicker ng-model="stateCurriculum.validThru" md-min-date="stateCurriculum.validFrom" md-open-on-focus> </md-datepicker> </md-input-container> </div> <div class="form-readonly top-margin" flex layout="row"> <md-input-container flex="100"> <label class="label">{{\'main.status\' | translate}}</label> <hois-classifier-value ng-model="stateCurriculum.status" main-classifier-code="OPPEKAVA_STAATUS"></hois-classifier-value> </md-input-container> </div> </div> </fieldset> <div>&nbsp;</div> <fieldset tabindex="11" ng-show="stateCurriculum.curricula && stateCurriculum.curricula.length > 0"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'stateCurriculum.curricula\' | translate}}</legend> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'school.label\' | translate}}</th> <th md-column>{{\'curriculum.name\' | translate}}</th> <th md-column>{{\'curriculum.studyLevel\' | translate}}</th> <th md-column>{{\'stateCurriculum.creditsEkap\' | translate}}</th> <th md-column>{{\'stateCurriculum.validFrom\' | translate}}</th> <th md-column>{{\'stateCurriculum.validThru\' | translate}}</th> <th md-column>{{\'stateCurriculum.status\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="curriculum in stateCurriculum.curricula | orderBy: currentLanguageNameField()" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{currentLanguageNameField(curriculum.school)}}</td> <td md-cell>{{currentLanguageNameField(curriculum)}}</td> <td md-cell> <hois-classifier-value ng-model="curriculum.origStudyLevel" main-classifier-codes="OPPEASTE,EKR"></hois-classifier-value> </td> <td md-cell>{{curriculum.credits}}</td> <td md-cell>{{curriculum.validFrom | hoisDate}}</td> <td md-cell>{{curriculum.validThru | hoisDate}}</td> <td md-cell> <hois-classifier-value ng-model="curriculum.status" main-classifier-code="OPPEKAVA_STAATUS"></hois-classifier-value> </td> </tr> </tbody> </table> </fieldset> <hois-created-modified object="stateCurriculum"></hois-created-modified> </form> <div layout="row"> <div ng-show="stateCurriculum.status === STATUS.ENTERING"> <div ng-show="!stateCurriculum.id"> <md-button class="md-raised md-primary" ng-click="save()">{{\'main.button.save\' | translate}}</md-button> </div> <div ng-show="stateCurriculum.id"> <md-button class="md-raised md-primary" ng-click="save()" ng-if="stateCurriculum.canChange">{{\'main.button.save\' | translate}}</md-button> <md-button class="md-raised md-default" ng-click="confirmAndSave()" ng-if="stateCurriculum.canChange && stateCurriculum.canConfirm"> {{\'stateCurriculum.statusButton.confirm\' | translate}} </md-button> <md-button class="md-raised md-default" ng-click="close()" ng-if="stateCurriculum.canClose && stateCurriculum.canChange"> {{\'stateCurriculum.statusButton.close\' | translate}} </md-button> <md-button ng-click="delete()" class="md-raised" ng-if="stateCurriculum.canDelete">{{\'main.button.delete\' | translate}}</md-button> </div> </div> <div ng-show="stateCurriculum.status === STATUS.VERIFIED"> <div> <md-button class="md-raised md-primary" ng-click="save()" ng-if="stateCurriculum.canChange">{{\'main.button.save\' | translate}}</md-button> </div> </div> <md-button ng-click="back(\'#/stateCurriculum\', stateCurriculumForm)" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </div> </div> </div>'),a.put("stateCurriculum/state.curriculum.list.html",'<div class="ois-form-layout-padding"> <div flex> <form ng-submit="loadData()" layout="column" class="nomargin"> <fieldset tabindex="1"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="65" flex-sm="100" flex-xs="100"> <label>{{\'curriculum.name\' | translate}}</label> <input ng-model="criteria.name" type="text"> </md-input-container> <md-input-container flex="30" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'stateCurriculum.EKR\' | translate}}</label> <hois-classifier-select ng-model="criteria.ekrLevel" model-value-attr="code" main-classifier-code="EKR" criteria="{vocational: true}" multiple></hois-classifier-select> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="30" flex-sm="100" flex-xs="100"> <label>{{\'curriculum.areaOfStudy\' | translate}}</label> <hois-classifier-select ng-model="criteria.iscedVald" model-value-attr="code" main-classifier-code="ISCED_VALD" criteria="{vocational: true}"></hois-classifier-select> </md-input-container> <md-input-container flex="30" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'curriculum.fieldOfStudy\' | translate}}</label> <hois-classifier-select ng-model="criteria.iscedSuun" model-value-attr="code" main-classifier-code="ISCED_SUUN" criteria="{vocational: true}" watch-model="criteria.iscedVald" filter-values search-from-connect connect-main-classifier-code="ISCED_VALD" multiple></hois-classifier-select> </md-input-container> <md-input-container flex="30" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'curriculum.group\' | translate}}</label> <hois-classifier-select ng-model="criteria.iscedClass" model-value-attr="code" main-classifier-code="ISCED_RYHM" criteria="{vocational: true}" watch-model="criteria.iscedSuun" filter-values search-from-connect connect-main-classifier-code="ISCED_SUUN" multiple></hois-classifier-select> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column" class="top-margin" ng-if="formState.canView"> <md-input-container flex="30" flex-sm="100" flex-xs="100" flex-offset-sm="0" class="top-margin"> <label>{{\'stateCurriculum.status\' | translate}}</label> <hois-classifier-select ng-model="criteria.status" model-value-attr="code" main-classifier-code="OPPEKAVA_STAATUS" multiple filter-values="filteredOutStatuses"></hois-classifier-select> </md-input-container> <md-input-container flex-offset="5" flex-offset-xs="0" flex-offset-sm="0" flex-sm="100" flex-xs="100"> <label>{{\'stateCurriculum.enter.validFrom\' | translate}}</label> <md-datepicker ng-model="criteria.validFrom" md-max-date="criteria.validThru" md-open-on-focus hois-datepicker-extension hd-controller="directiveControllers"> </md-datepicker> </md-input-container> <md-input-container flex-sm="100" flex-xs="100" flex-offset="2" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'stateCurriculum.enter.validThru\' | translate}}</label> <md-datepicker ng-model="criteria.validThru" md-min-date="criteria.validFrom" md-open-on-focus hois-datepicker-extension hd-controller="directiveControllers"> </md-datepicker> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column" class="top-margin" ng-if="!formState.canView"> <md-input-container flex-sm="100" flex-xs="100"> <label>{{\'stateCurriculum.enter.validFrom\' | translate}}</label> <md-datepicker ng-model="criteria.validFrom" md-max-date="criteria.validThru" md-open-on-focus hois-datepicker-extension hd-controller="directiveControllers"> </md-datepicker> </md-input-container> <md-input-container flex-sm="100" flex-xs="100" flex-offset="2" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'stateCurriculum.enter.validThru\' | translate}}</label> <md-datepicker ng-model="criteria.validThru" md-min-date="criteria.validFrom" md-open-on-focus hois-datepicker-extension hd-controller="directiveControllers"> </md-datepicker> </md-input-container> </div> <div layout="row"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> <md-button class="md-raised" ng-href="#/stateCurriculum/new" ng-if="formState.canCreate">{{\'main.button.create\' | translate}}</md-button> </div> </fieldset> </form> </div> </div> <md-table-container flex ng-cloak layout-padding> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="{{currentLanguageNameField()}}">{{\'curriculum.name\' | translate}}</th> <th md-column md-order-by="ekrLevel">{{\'stateCurriculum.EKR\' | translate}}</th> <th md-column md-order-by="credits">{{\'stateCurriculum.creditsEkap\' | translate}}</th> <th md-column md-order-by="validFrom">{{\'stateCurriculum.validFrom\' | translate}}</th> <th md-column md-order-by="validThru">{{\'stateCurriculum.validThru\' | translate}}</th> <th md-column md-order-by="status.{{currentLanguageNameField()}}" ng-if="formState.canView">{{\'stateCurriculum.status\' | translate}}</th> <th></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell><a ng-href="#/stateCurriculum{{isPublic ? \'/public\' : \'\'}}/{{row.id}}/view">{{currentLanguageNameField(row)}}</a></td> <td md-cell>{{currentLanguageNameField(row.ekrLevel)}}</td> <td md-cell>{{row.credits}}</td> <td md-cell>{{row.validFrom | hoisDate}}</td> <td md-cell>{{row.validThru | hoisDate}}</td> <td md-cell="status" ng-if="formState.canView">{{currentLanguageNameField(row.status)}}</td> <td md-cell> <md-button md-no-ink class="md-primary change-button" ng-href="#/stateCurriculum/{{row.id}}/edit" ng-if="row.canChange">{{\'main.button.change\' | translate}}</md-button> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\' }" md-page-select></md-table-pagination>'),
a.put("stateCurriculum/state.curriculum.module.add.dialog.html",'<md-dialog aria-label="module add dialog" flex="70" flex-xs="100"> <form name="dialogForm" ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2>{{readOnly ? "module.viewToughtModule" : "module.addToughtModule" | translate}}</h2> <span flex></span> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <span flex></span> <div class="ois-form-layout" layout="column" layout-margin ng-cloak> <div layout="column"> <div> <fieldset tabindex="1"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'module.occupationPartOccupationSpecialize\' | translate}}</legend> <div layout="column"> <div ng-repeat="occupation in occupations | orderBy: \'code\'"> <md-checkbox ng-model="occupation.selected" ng-change="changeOccupation(occupation)" ng-disabled="readOnly"> <hois-classifier-value ng-model="occupation.code" main-classifier-codes="KUTSE" class="inline"></hois-classifier-value> </md-checkbox> <div layout="column"> <div ng-repeat="subOccupation in occupation.subOccupations | orderBy: \'code\'" layout="row"> <div flex="5">&nbsp;</div> <md-checkbox ng-model="subOccupation.selected" ng-change="changeOccupation(subOccupation)" ng-disabled="readOnly"> <hois-classifier-value ng-model="subOccupation" main-classifier-code="OSAKUTSE,SPETSKUTSE" class="inline"></hois-classifier-value> {{subOccupation.mainClassCode === \'OSAKUTSE\' ? " (" + (\'stateCurriculum.enter.occupation.partial\' | translate) + ")" : ""}} {{subOccupation.mainClassCode === \'SPETSKUTSE\' ? " (" + (\'stateCurriculum.enter.occupation.specialty\' | translate) + ")" : ""}} </md-checkbox> </div> </div> </div> </div> <input style="display:none" type="number" readonly name="occupationsLength" ng-model="data.moduleOccupations.length" min="1"> <div class="invalid" ng-if="dialogForm.$submitted" ng-messages="dialogForm.occupationsLength.$error"> <div ng-message="min">{{\'main.messages.error.atLeastOneShouldBeAdded\' | translate}}</div> </div> <p class="invalid" ng-show="dialogForm.$submitted && !occupationsValid"> {{\'stateCurriculum.error.specialtiesInvalid\' | translate}} </p> <md-input-container hide> <input ng-model="occupationsValid" type="text" required> </md-input-container> <p class="invalid" ng-show="dialogForm.$submitted && !suboccupationsValid"> {{\'stateCurriculum.error.partAndSpecOccupationsInvalid\' | translate}} </p> <md-input-container hide> <input ng-model="suboccupationsValid" type="text" required> </md-input-container> </fieldset> </div> <div>&nbsp;</div> <div layout="row"> <md-input-container flex="45"> <label>{{\'stateCurriculum.enter.module.type\' | translate}}</label> <hois-classifier-select ng-model="data.module" show-only-values="allowedModuleTypes" main-classifier-code="KUTSEMOODUL" required ng-disabled="readOnly" model-value-attr="code"></hois-classifier-select> </md-input-container> <md-input-container flex="20" flex-sm="50" flex-xs="50" flex-offset="5"> <label>{{\'stateCurriculum.enter.module.credits\' | translate}}</label> <input ng-model="data.credits" type="number" min="0" max="999" required name="credits" ng-readonly="readOnly" pattern="^\\d+(\\.\\d{1})?$"> <div ng-messages="dialogForm.credits.$error" ng-show="dialogForm.credits.$dirty"> <div ng-message="min"> {{\'stateCurriculum.enter.credits.positive\' | translate}} </div> <div ng-message="max"> {{\'stateCurriculum.enter.credits.max\' | translate}} </div> <div ng-message="pattern"> {{\'stateCurriculum.error.decimalPresision\' | translate}} </div> </div> </md-input-container> </div> <md-input-container> <label>{{\'stateCurriculum.enter.module.nameEt\' | translate}}</label> <input ng-model="data.nameEt" type="text" required md-maxlength="255" ng-readonly="readOnly"> </md-input-container> <md-input-container> <label>{{\'stateCurriculum.enter.module.nameEn\' | translate}}</label> <input ng-model="data.nameEn" type="text" md-maxlength="255" ng-readonly="readOnly"> </md-input-container> <md-input-container> <label>{{\'stateCurriculum.enter.module.objectiveEt\' | translate}}</label> <textarea ng-model="data.objectivesEt" required md-maxlength="10000" max-rows="10" ng-readonly="readOnly"></textarea> </md-input-container> <md-input-container> <label>{{\'stateCurriculum.enter.module.objectiveEn\' | translate}}</label> <textarea ng-model="data.objectivesEn" md-maxlength="10000" max-rows="10" ng-readonly="readOnly"></textarea> </md-input-container> <div> <fieldset tabindex="2"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'module.studyOutcome\' | translate}} *</legend> <input style="display:none" type="number" readonly name="outcomesLength" ng-model="data.outcomes.length" min="1"> <div class="invalid" ng-if="dialogForm.$submitted" ng-messages="dialogForm.outcomesLength.$error"> <div ng-message="min">{{\'main.messages.error.atLeastOneShouldBeAdded\' | translate}}</div> </div> <div layout="row" flex ng-if="!readOnly"> <md-input-container flex="45"> <label>{{\'studyOutcome.nameEt\' | translate}} *</label> <textarea ng-model="data.outcomesEt" md-maxlength="1000" max-rows="10"></textarea> </md-input-container> <md-input-container flex="40" flex-offset="5"> <label>{{\'studyOutcome.nameEn\' | translate}}</label> <textarea ng-model="data.outcomesEn" md-maxlength="1000" max-rows="10"></textarea> </md-input-container> <md-button class="md-primary" ng-click="addOutcome()" ng-if="!isEditingOutcome">{{\'main.button.add\' | translate}}</md-button> <md-button class="md-primary" ng-click="saveOutcome()" ng-if="isEditingOutcome">{{\'main.button.change\' | translate}}</md-button> </div> <div layout="column"> <div ng-repeat="item in data.outcomes | orderBy: \'id\' track by $index" class="occupation-row align-center" layout="row" flex> <div flex="45"> <a ng-click="editOutcome(item)" ng-if="!readOnly"> <p class="scrollable">{{item.outcomesEt}}</p> </a> <p class="scrollable" ng-if="readOnly">{{item.outcomesEt}}</p> </div> <div flex="40" flex-offset="5"> <a ng-click="editOutcome(item)" ng-if="!readOnly"> <p class="scrollable">{{item.outcomesEn}}</p> </a> <p class="scrollable" ng-if="readOnly">{{item.outcomesEn}}</p> </div> <div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div> <div> <a class="remove" ng-click="removeFromArray(data.outcomes, item)" ng-if="!readOnly">&times;&nbsp;&nbsp;</a> </div> </div> </div> </fieldset> </div> <div>&nbsp;</div> <md-input-container> <label>{{\'stateCurriculum.enter.module.criteriaEt\' | translate}}</label> <textarea ng-model="data.assessmentsEt" required md-maxlength="20000" max-rows="10" ng-readonly="readOnly"></textarea> </md-input-container> <md-input-container> <label>{{\'stateCurriculum.enter.module.criteriaEn\' | translate}}</label> <textarea ng-model="data.assessmentsEn" md-maxlength="20000" max-rows="10" ng-readonly="readOnly"></textarea> </md-input-container> <br> <md-checkbox ng-model="data.isAdditional" aria-label="{{\'stateCurriculum.enter.module.isAdditional\' | translate}}" ng-disabled="readOnly"> {{\'stateCurriculum.enter.module.isAdditional\' | translate}} </md-checkbox> </div> </div> </md-dialog-content> <md-dialog-actions layout="row" layout-align="start center"> <md-button class="md-raised md-primary" ng-click="submit()" ng-if="!readOnly">{{"main.button.save" | translate}}</md-button> <md-button ng-click="delete()" ng-if="editing && !readOnly" class="md-raised"> {{\'main.button.delete\' | translate}}</md-button> <md-button class="md-raised" ng-click="cancel()">{{"main.button.close" | translate}}</md-button> </md-dialog-actions> </form> </md-dialog>'),a.put("stateCurriculum/state.curriculum.module.view.dialog.html",'<md-dialog aria-label="module add dialog" flex="70" flex-xs="100"> <form name="dialogForm" ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2>{{"module.viewToughtModule" | translate}}</h2> <span flex></span> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <span flex></span> <div class="ois-form-layout" layout="column" layout-margin ng-cloak> <div layout="column"> <div> <fieldset tabindex="1"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'module.occupationPartOccupationSpecialize\' | translate}}</legend> <div layout="column"> <div ng-repeat="occupation in occupations | orderBy: \'code\'"> <md-checkbox ng-model="occupation.selected" disabled> <hois-classifier-value ng-model="occupation.code" main-classifier-codes="KUTSE" class="inline"></hois-classifier-value> </md-checkbox> <div layout="column"> <div ng-repeat="subOccupation in occupation.subOccupations | orderBy: \'code\'" layout="row"> <div flex="5">&nbsp;</div> <md-checkbox ng-model="subOccupation.selected" disabled> <hois-classifier-value ng-model="subOccupation" main-classifier-code="OSAKUTSE,SPETSKUTSE" class="inline"></hois-classifier-value> {{subOccupation.mainClassCode === \'OSAKUTSE\' ? " (" + (\'stateCurriculum.enter.occupation.partial\' | translate) + ")" : ""}} {{subOccupation.mainClassCode === \'SPETSKUTSE\' ? " (" + (\'stateCurriculum.enter.occupation.specialty\' | translate) + ")" : ""}} </md-checkbox> </div> </div> </div> </div> </fieldset> </div> <div>&nbsp;</div> <div layout="row"> <md-input-container flex="45"> <label>{{\'stateCurriculum.enter.module.type\' | translate}}</label> <hois-classifier-select ng-model="data.module" main-classifier-code="KUTSEMOODUL" disabled model-value-attr="code"></hois-classifier-select> </md-input-container> <md-input-container flex="20" flex-sm="50" flex-xs="50" flex-offset="5"> <label>{{\'stateCurriculum.enter.module.credits\' | translate}}</label> <input ng-model="data.credits" type="number" name="credits" readonly> </md-input-container> </div> <md-input-container> <label>{{\'stateCurriculum.enter.module.nameEt\' | translate}}</label> <input ng-model="data.nameEt" type="text" readonly> </md-input-container> <md-input-container> <label>{{\'stateCurriculum.enter.module.nameEn\' | translate}}</label> <input ng-model="data.nameEn" type="text" readonly> </md-input-container> <md-input-container> <label>{{\'stateCurriculum.enter.module.objectiveEt\' | translate}}</label> <textarea ng-model="data.objectivesEt" max-rows="10" readonly></textarea> </md-input-container> <md-input-container> <label>{{\'stateCurriculum.enter.module.objectiveEn\' | translate}}</label> <textarea ng-model="data.objectivesEn" max-rows="10" readonly></textarea> </md-input-container> <div> <fieldset tabindex="2"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'module.studyOutcome\' | translate}}</legend> <div layout="column"> <div ng-repeat="item in data.outcomes | orderBy: \'id\' track by $index" class="occupation-row align-center" layout="row" flex> <div flex="45"> <p class="scrollable">{{item.outcomesEt}}</p> </div> <div flex="40" flex-offset="5"> <p class="scrollable">{{item.outcomesEn}}</p> </div> <div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div> <div></div> </div> </div> </fieldset> </div> <div>&nbsp;</div> <md-input-container> <label>{{\'stateCurriculum.enter.module.criteriaEt\' | translate}}</label> <textarea ng-model="data.assessmentsEt" max-rows="10" readonly></textarea> </md-input-container> <md-input-container> <label>{{\'stateCurriculum.enter.module.criteriaEn\' | translate}}</label> <textarea ng-model="data.assessmentsEn" max-rows="10" readonly></textarea> </md-input-container> <br> <md-checkbox ng-model="data.isAdditional" aria-label="{{\'stateCurriculum.enter.module.isAdditional\' | translate}}" disabled> {{\'stateCurriculum.enter.module.isAdditional\' | translate}} </md-checkbox> </div> </div> </md-dialog-content> <md-dialog-actions layout="row" layout-align="start center"> <md-button class="md-raised" ng-click="cancel()">{{"main.button.close" | translate}}</md-button> </md-dialog-actions> </form> </md-dialog>'),a.put("stateCurriculum/state.curriculum.view.html",'<div class="ois-form-layout-padding"> <div flex> <form name="stateCurriculumForm" layout="column" class="nomargin"> <fieldset tabindex="1" flex> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'curriculum.mainData\' | translate}}</legend> <div layout="column"> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="50" flex-sm="100" flex-xs="100"> <label>{{\'stateCurriculum.enter.nameEt\' | translate}}</label> <input ng-model="stateCurriculum.nameEt" type="text" name="nameEt" readonly> </md-input-container> <md-input-container flex="45" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'stateCurriculum.enter.nameEn\' | translate}}</label> <input ng-model="stateCurriculum.nameEn" type="text" name="nameEn" readonly> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="25" flex-sm="100" flex-xs="100"> <label>{{\'curriculum.areaOfStudy\' | translate}}</label> <hois-classifier-select ng-model="iscedVald" main-classifier-code="ISCED_VALD" criteria="{vocational: true}" model-value-attr="code" disabled></hois-classifier-select> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'curriculum.fieldOfStudy\' | translate}}</label> <hois-classifier-select ng-model="iscedSuun" main-classifier-code="ISCED_SUUN" criteria="{vocational: true}" watch-model="iscedVald" model-value-attr="code" filter-values search-from-connect connect-main-classifier-code="ISCED_VALD" disabled> </hois-classifier-select> </md-input-container> <md-input-container flex="45" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'curriculum.group\' | translate}}</label> <hois-classifier-select ng-model="stateCurriculum.iscedClass" main-classifier-code="ISCED_RYHM" criteria="{vocational: true}" watch-model="iscedSuun" model-value-attr="code" filter-values search-from-connect connect-main-classifier-code="ISCED_SUUN" disabled></hois-classifier-select> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column" class="top-margin"> <md-input-container flex="25" flex-sm="100" flex-xs="100"> <label>{{\'stateCurriculum.enter.credits.credits\' | translate}}</label> <input ng-model="stateCurriculum.credits" type="number" name="credits" readonly> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'stateCurriculum.enter.ROKclassifier\' | translate}}</label> <hois-classifier-select ng-model="stateCurriculum.stateCurrClass" main-classifier-code="EHIS_ROK" criteria="{vocational: true}" model-value-attr="code" disabled></hois-classifier-select> </md-input-container> </div> </div> </fieldset> <div>&nbsp;</div> <fieldset tabindex="2"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'curriculum.commonData\' | translate}}</legend> <div layout="column"> <md-input-container flex> <label>{{\'stateCurriculum.enter.objectivesEt\' | translate}}</label> <textarea ng-model="stateCurriculum.objectivesEt" max-rows="10" readonly></textarea> </md-input-container> <md-input-container flex> <label>{{\'stateCurriculum.enter.objectivesEn\' | translate}}</label> <textarea ng-model="stateCurriculum.objectivesEn" max-rows="10" readonly></textarea> </md-input-container> <md-input-container flex> <label>{{\'stateCurriculum.enter.outcome.outcomeLabelEt\' | translate}}</label> <textarea ng-model="stateCurriculum.outcomesEt" max-rows="10" readonly></textarea> </md-input-container> <md-input-container flex> <label>{{\'stateCurriculum.enter.outcome.outcomeLabelEn\' | translate}}</label> <textarea ng-model="stateCurriculum.outcomesEn" max-rows="10" readonly></textarea> </md-input-container> <md-input-container flex> <label>{{\'stateCurriculum.enter.admission.requirementsEt\' | translate}}</label> <textarea ng-model="stateCurriculum.admissionRequirementsEt" max-rows="10" readonly></textarea> </md-input-container> <md-input-container flex> <label>{{\'stateCurriculum.enter.admission.requirementsEn\' | translate}}</label> <textarea ng-model="stateCurriculum.admissionRequirementsEn" max-rows="10" readonly></textarea> </md-input-container> <md-input-container flex> <label>{{\'stateCurriculum.enter.graduation.requirementsEt\' | translate}}</label> <textarea ng-model="stateCurriculum.graduationRequirementsEt" max-rows="10" readonly></textarea> </md-input-container> <md-input-container flex> <label>{{\'stateCurriculum.enter.graduation.requirementsEn\' | translate}}</label> <textarea ng-model="stateCurriculum.graduationRequirementsEn" max-rows="10" readonly></textarea> </md-input-container> </div> </fieldset> <div>&nbsp;</div> <fieldset tabindex="3" flex> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'stateCurriculum.enter.occupation.acquiredMany\' | translate}}&nbsp;</legend> <div> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column>Jrk</th> <th md-column>Kutse</th> <th md-column>Osakutsed</th> <th md-column>Spetsialiseerumised</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="occupation in stateCurriculum.occupations | orderBy" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{$index + 1}}</td> <td md-cell> <hois-classifier-value ng-model="occupation" main-classifier-code="KUTSE"></hois-classifier-value> </td> <td md-cell><span ng-repeat="subOccupation in subOccupations[occupation] | filter:{ mainClassCode: \'OSAKUTSE\'}"><span ng-if="$index > 0">; </span>{{currentLanguageNameField(subOccupation)}} </span> </td> <td md-cell><span ng-repeat="subOccupation in subOccupations[occupation] | filter:{ mainClassCode: \'SPETSKUTSE\'}"><span ng-if="$index > 0">; </span>{{currentLanguageNameField(subOccupation)}} </span> </td> <td md-cell></td> </tr> </tbody> </table> </div> </fieldset> <div>&nbsp;</div> <fieldset tabindex="3" flex> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'stateCurriculum.enter.module.modules\' | translate}}&nbsp;</legend> <div layout="row" ng-if="stateCurriculum.occupations.length > 0"> </div> <!--KUTSETE MOODULID--> <div ng-repeat="occupation in stateCurriculum.occupations | orderBy" layout="column"> <div class="occupation-header align-center"><span>{{\'stateCurriculum.enter.occupation.occupation\' | translate}} {{$index + 1}}:&nbsp;</span> <hois-classifier-value ng-model="occupation" main-classifier-code="KUTSE"></hois-classifier-value> </div> <div layout="column"> <div layout="row" flex="100" class="occupation-row align-center border-bottom odd"> <div flex="5">&nbsp;</div> <div flex="20">{{\'stateCurriculum.enter.module.modules1\' | translate}}</div> <div layout="column" flex="75"> <div flex="100" ng-repeat="module in stateCurriculum.modules | filter: filterModules(occupation, MODULE_TYPE.GENERAL) | orderBy: \'nameEt\'" layout="row" class="align-center"> <a flex="30" ng-click="openViewModuleDialog(module)" href="">{{currentLanguageNameField(module)}}</a> <span flex="10">{{module.credits}}&nbsp; EKAP</span> </div> </div> </div> <div layout="row" flex="100" class="occupation-row align-center even"> <div flex="5">&nbsp;</div> <div flex="20">{{\'stateCurriculum.enter.module.modules2\' | translate}}&nbsp;</div> <div layout="column" flex="75"> <div flex="100" ng-repeat="module in stateCurriculum.modules | filter: filterModules(occupation, MODULE_TYPE.BASIC) | orderBy: \'nameEt\'" layout="row" class="align-center"> <a flex="30" ng-click="openViewModuleDialog(module)" href="">{{currentLanguageNameField(module)}}</a> <span flex="10">{{module.credits}}&nbsp; EKAP</span> </div> </div> </div> </div> <!--OSAKUTSETE MOODULID--> <div ng-repeat="suboccupation in subOccupationsList | filter: filterSubOccupations(occupation, \'OSAKUTSE\') | orderBy: \'nameEt\'" layout="column"> <div class="occupation-header2 align-center">{{\'stateCurriculum.enter.occupation.partial\' | translate}} {{$index + 1}}: {{currentLanguageNameField(suboccupation)}}</div> <div layout="column"> <div layout="row" flex="100" class="occupation-row align-center border-bottom odd"> <div flex="5">&nbsp;</div> <div flex="20">{{\'stateCurriculum.enter.module.modules1\' | translate}}</div> <div layout="column" flex="75"> <div flex="100" ng-repeat="module in stateCurriculum.modules | filter: filterModules(suboccupation.code, MODULE_TYPE.GENERAL) | orderBy: \'nameEt\'" layout="row" class="align-center"> <a flex="30" ng-click="openViewModuleDialog(module)" href="">{{currentLanguageNameField(module)}}</a> <span flex="10">{{module.credits}}&nbsp; EKAP</span> </div> </div> </div> <div layout="row" flex="100" class="occupation-row align-center even"> <div flex="5">&nbsp;</div> <div flex="20">{{\'stateCurriculum.enter.module.modules2\' | translate}}&nbsp;</div> <div layout="column" flex="75"> <div flex="100" ng-repeat="module in stateCurriculum.modules | filter: filterModules(suboccupation.code, MODULE_TYPE.BASIC) | orderBy: \'nameEt\'" layout="row" class="align-center"> <a flex="30" ng-click="openViewModuleDialog(module)" href="">{{currentLanguageNameField(module)}}</a> <span flex="10">{{module.credits}}&nbsp; EKAP</span> </div> </div> </div> </div> </div> <!--SPETSKUTSETE MOODULID--> <div ng-repeat="suboccupation in subOccupationsList | filter: filterSubOccupations(occupation, \'SPETSKUTSE\') | orderBy: \'nameEt\'" layout="column"> <div class="occupation-header2 align-center"><span>{{\'stateCurriculum.enter.occupation.specialty\' | translate}} {{$index + 1}}: {{currentLanguageNameField(suboccupation)}}</span></div> <div layout="column"> <div layout="row" flex="100" class="occupation-row align-center border-bottom odd"> <div flex="5">&nbsp;</div> <div flex="20">{{\'stateCurriculum.enter.module.modules1\' | translate}}</div> <div layout="column" flex="75"> <div flex="100" ng-repeat="module in stateCurriculum.modules | filter: filterModules(suboccupation.code, MODULE_TYPE.GENERAL) | orderBy: \'nameEt\'" layout="row" class="align-center"> <a flex="30" ng-click="openViewModuleDialog(module)" href="">{{currentLanguageNameField(module)}}</a> <span flex="10">{{module.credits}}&nbsp; EKAP</span> </div> </div> </div> <div layout="row" flex="100" class="occupation-row align-center even"> <div flex="5">&nbsp;</div> <div flex="20">{{\'stateCurriculum.enter.module.modules2\' | translate}}&nbsp;</div> <div layout="column" flex="75"> <div flex="100" ng-repeat="module in stateCurriculum.modules | filter: filterModules(suboccupation.code, MODULE_TYPE.BASIC) | orderBy: \'nameEt\'" layout="row" class="align-center"> <a flex="30" ng-click="openViewModuleDialog(module)" href="">{{currentLanguageNameField(module)}}</a> <span flex="10">{{module.credits}}&nbsp; EKAP</span> </div> </div> </div> </div> </div> </div> </fieldset> <div>&nbsp;</div> <fieldset tabindex="5"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'curriculum.additionalInfo\' | translate}}</legend> <div layout="column"> <div layout="row"> <md-input-container> <label>{{\'stateCurriculum.enter.module.modules3\' | translate}}</label> <input type="number" name="optionalCredits" ng-model="stateCurriculum.optionalStudyCredits" aria-label="optional credits" readonly> </md-input-container> </div> <md-input-container flex> <label>{{\'stateCurriculum.enter.practice\' | translate}}</label> <textarea ng-model="stateCurriculum.practiceDescription" max-rows="10" readonly></textarea> </md-input-container> <md-input-container flex> <label>{{\'stateCurriculum.enter.finalExam\' | translate}}</label> <textarea ng-model="stateCurriculum.finalExamDescription" max-rows="10" readonly></textarea> </md-input-container> <md-input-container flex> <label>{{\'stateCurriculum.enter.comment\' | translate}}</label> <textarea ng-model="stateCurriculum.description" max-rows="10" readonly></textarea> </md-input-container> <div>&nbsp;</div> <div class="form-readonly" layout="column" ng-if="stateCurriculum.riigiteatajaUrl"> <br> <md-input-container flex> <label>{{\'stateCurriculum.enter.riigiteataja\' | translate}}</label> <a href="{{stateCurriculum.riigiteatajaUrl | hoisUrl}}" target="_blank">{{stateCurriculum.riigiteatajaUrl}}</a> </md-input-container> </div> </div> </fieldset> <div>&nbsp;</div> <fieldset tabindex="6"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'curriculum.statuses\' | translate}}</legend> <div layout="column"> <div layout="row" flex> <md-input-container> <label>{{\'stateCurriculum.enter.validFrom\' | translate}}</label> <md-datepicker ng-model="stateCurriculum.validFrom" md-open-on-focus disabled> </md-datepicker> </md-input-container> <md-input-container flex-offset="5"> <label>{{\'stateCurriculum.enter.validThru\' | translate}}</label> <md-datepicker ng-model="stateCurriculum.validThru" md-min-date="stateCurriculum.validFrom" md-open-on-focus disabled> </md-datepicker> </md-input-container> </div> <div class="form-readonly top-margin" flex layout="row"> <md-input-container flex="100"> <label class="label">{{\'main.status\' | translate}}</label> <hois-classifier-value ng-model="stateCurriculum.status" main-classifier-code="OPPEKAVA_STAATUS"></hois-classifier-value> </md-input-container> </div> </div> </fieldset> <div>&nbsp;</div> <fieldset tabindex="11" ng-show="stateCurriculum.curricula && stateCurriculum.curricula.length > 0"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'stateCurriculum.curricula\' | translate}}</legend> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'school.label\' | translate}}</th> <th md-column>{{\'curriculum.name\' | translate}}</th> <th md-column>{{\'curriculum.studyLevel\' | translate}}</th> <th md-column>{{\'stateCurriculum.creditsEkap\' | translate}}</th> <th md-column>{{\'stateCurriculum.validFrom\' | translate}}</th> <th md-column>{{\'stateCurriculum.validThru\' | translate}}</th> <th md-column>{{\'stateCurriculum.status\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="curriculum in stateCurriculum.curricula | orderBy: currentLanguageNameField()" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{currentLanguageNameField(curriculum.school)}}</td> <td md-cell><a class="md-primary" ng-href="{{getCurriculumViewUrl(curriculum.id)}}">{{currentLanguageNameField(curriculum)}}</a></td> <td md-cell> <hois-classifier-value ng-model="curriculum.origStudyLevel" main-classifier-codes="OPPEASTE,EKR"></hois-classifier-value> </td> <td md-cell>{{curriculum.credits}}</td> <td md-cell>{{curriculum.validFrom | hoisDate}}</td> <td md-cell>{{curriculum.validThru | hoisDate}}</td> <td md-cell> <hois-classifier-value ng-model="curriculum.status" main-classifier-code="OPPEKAVA_STAATUS"></hois-classifier-value> </td> </tr> </tbody> </table> </fieldset> <hois-created-modified object="stateCurriculum"></hois-created-modified> </form> <div layout="row"> <div ng-show="stateCurriculum.status === STATUS.ENTERING"> <md-button ng-href="#/stateCurriculum/{{stateCurriculum.id}}/edit?_noback" class="md-raised md-primary" ng-if="stateCurriculum.canChange">{{\'main.button.change\' | translate}} </md-button> </div> <div ng-show="stateCurriculum.status === STATUS.VERIFIED"> <md-button ng-click="goToEditForm()" class="md-raised md-primary" ng-if="stateCurriculum.canChange">{{\'main.button.change\' | translate}} </md-button> <md-button class="md-raised md-default" ng-click="close()" ng-if="stateCurriculum.canClose"> {{\'stateCurriculum.statusButton.close\' | translate}} </md-button> </div> <a href="{{formState.stateCurriculumPdfUrl}}" target="_blank" class="md-button md-raised" ng-if="stateCurriculum.id && !isPublic">{{\'main.button.print\' | translate}}</a> <md-button ng-click="back(\'#/stateCurriculum\')" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </div> </div> </div>'),a.put("student/absence.edit.dialog.html",'<md-dialog aria-label="grade add dialog" flex="30" flex-md="45" flex-sm="60" flex-xs="100"> <form name="studentAbsenceForm" novalidate ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2 flex>{{\'absence.label\' | translate}}</h2> <span flex></span> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <div class="md-dialog-content"> <div layout="row" layout-xs="column" class="form-readonly"> <md-input-container flex> <label>{{\'student.name\' | translate}}</label> <hois-value value="record.studentName"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'student.studentGroup\' | translate}}</label> <hois-value value="record.studentGroup"></hois-value> </md-input-container> </div> <div layout="row" layout-xs="column"> <md-input-container flex> <label>{{\'student.absence.validFrom\' | translate}}</label> <md-datepicker ng-model="record.validFrom" name="validFrom" md-max-date="record.validThru" required></md-datepicker> </md-input-container> <md-input-container flex> <label>{{\'student.absence.validThru\' | translate}}</label> <md-datepicker ng-model="record.validThru" name="validThru" md-min-date="record.validFrom"></md-datepicker> </md-input-container> </div> <md-input-container class="md-block"> <label>{{\'student.absence.cause\' | translate}}</label> <textarea ng-model="record.cause" name="cause" required md-maxlength="1000"></textarea> </md-input-container> </div> </md-dialog-content> <md-dialog-actions layout="row" layout-align="start center"> <md-button ng-click="update()" class="md-raised md-primary">{{\'main.button.save\' | translate}}</md-button> <md-button ng-click="delete()" ng-if="record.id" class="md-raised">{{\'main.button.delete\' | translate}}</md-button> <md-button ng-click="cancel()" class="md-raised">{{\'main.button.close\' | translate}}</md-button> </md-dialog-actions> </form> </md-dialog>'),a.put("student/edit.main.html",'<div layout="column" layout-padding> <div> <div layout="row" class="form-readonly"> <md-input-container flex> <label>{{\'student.label\' | translate}}</label> <hois-value value="student.person.fullname"></hois-value> </md-input-container> </div> <form name="studentEditForm" novalidate> <hois-collapsable label="(\'student.contact\' | translate)"> <md-input-container class="md-block"> <label>{{\'student.email\' | translate}}</label> <input ng-model="student.person.email" name="email" type="text" required md-maxlength="255"> </md-input-container> <md-input-container class="md-block"> <label class="textInput">{{\'student.phone\' | translate}}</label> <input ng-model="student.person.phone" name="phone" type="text" required md-maxlength="100"> </md-input-container> <md-input-container class="md-block"> <label>{{\'student.residenceCountry\' | translate}}</label> <hois-classifier-select ng-model="student.person.residenceCountry" name="residenceCountry" main-classifier-code="RIIK" required model-value-attr="code"></hois-classifier-select> </md-input-container> <div class="md-block" ng-if="student.person.residenceCountry === \'RIIK_EST\'"> <hois-ads-adapter class="md-text" ng-model="student.person.addressAds" ads-oid-model="student.person.addressAdsOid" address-model="student.person.address" required></hois-ads-adapter> </div> <md-input-container class="md-block" ng-if="student.person.residenceCountry !== \'RIIK_EST\'"> <label class="textInput">{{\'student.address\' | translate}}</label> <input ng-model="student.person.address" name="address" type="text" required md-maxlength="255"> </md-input-container> <md-input-container class="md-block"> <label class="textInput">{{\'student.postcode\' | translate}}</label> <input ng-model="student.person.postcode" name="postcode" type="text" required md-maxlength="10"> </md-input-container> <md-input-container class="md-block" ng-if="student.userIsSchoolAdmin || student.userIsStudentGroupTeacher"> <label>{{\'student.citizenship\' | translate}}</label> <hois-classifier-select ng-model="student.person.citizenship" name="citizenship" main-classifier-code="RIIK" model-value-attr="code"></hois-classifier-select> </md-input-container> <md-input-container class="md-block" ng-if="student.userIsSchoolAdmin || student.userIsStudentGroupTeacher"> <label>{{\'student.language\' | translate}}</label> <hois-classifier-select ng-model="student.person.language" name="language" main-classifier-code="OPPEKEEL" model-value-attr="code"></hois-classifier-select> </md-input-container> <md-input-container class="md-block"> <label class="textInput">{{\'student.bankaccount\' | translate}}</label> <input ng-model="student.person.bankaccount" name="bankaccount" type="text" md-maxlength="50"> </md-input-container> </hois-collapsable> <hois-collapsable label="(\'student.study\' | translate)" ng-if="student.userIsSchoolAdmin || student.userIsStudentGroupTeacher"> <md-input-container class="md-block" ng-if="student.userIsSchoolAdmin"> <label>{{\'student.studyLanguage\' | translate}}</label> <hois-classifier-select ng-model="student.studyLanguage" name="studyLanguage" main-classifier-code="OPPEKEEL" model-value-attr="code"></hois-classifier-select> </md-input-container> <md-input-container class="md-block" ng-if="student.userIsSchoolAdmin && !student.isVocational"> <label>{{\'student.curriculumSpeciality\' | translate}}</label> <md-select ng-model="student.curriculumSpeciality" name="studyLanguage" ng-model-options="{trackBy: \'$value.id\'}"> <md-option ng-value="null"></md-option> <md-option ng-value="speciality" track ng-repeat="speciality in specialities">{{currentLanguageNameField(speciality)}}</md-option> </md-select> </md-input-container> <md-input-container class="md-block" ng-if="student.userIsSchoolAdmin"> <label>{{\'student.nominalStudyEnd\' | translate}}</label> <md-datepicker class="wider-datepicker" name="nominalStudyEnd" ng-model="student.nominalStudyEnd" md-min-date="student.studyStart"></md-datepicker> <div ng-messages="studentEditForm.nominalStudyEnd.$error"> <div ng-message="mindate"> {{\'student.error.cannotBeBeforeStudyStart\' | translate:errorParams}} </div> </div> </md-input-container> <md-input-container class="md-block" ng-if="student.userIsSchoolAdmin"> <label>{{\'student.finSpecific\' | translate}}</label> <hois-classifier-select ng-model="student.finSpecific" name="finSpecific" main-classifier-code="FINTAPSUSTUS" model-value-attr="code"></hois-classifier-select> </md-input-container> <md-input-container class="md-block"> <label>{{\'student.schoolEmail\' | translate}}</label> <input ng-model="student.schoolEmail" name="schoolEmail" type="text" md-maxlength="255"> </md-input-container> <md-input-container class="md-block"> <label>{{\'student.previousStudyLevel\' | translate}}</label> <hois-classifier-select ng-model="student.previousStudyLevel" name="previousStudyLevel" main-classifier-code="OPPEASTE" required model-value-attr="code"></hois-classifier-select> </md-input-container> <md-input-container ng-if="student.isVocational" class="md-block"> <label>{{\'student.studyCompany\' | translate}}</label> <input ng-model="student.studyCompany" name="studyCompany" type="text" md-maxlength="1000"> </md-input-container> <md-input-container class="md-block"> <label>{{\'student.previousSchoolName\' | translate}}</label> <input ng-model="student.previousSchoolName" name="previousSchoolName" type="text" md-maxlength="255"> </md-input-container> <md-input-container class="md-block"> <label>{{\'student.previousSchoolEndDate\' | translate}}</label> <md-datepicker class="wider-datepicker" ng-model="student.previousSchoolEndDate"></md-datepicker> </md-input-container> <md-input-container class="md-block"> <label>{{\'student.dormitory\' | translate}}</label> <hois-classifier-select ng-model="student.dormitory" name="dormitory" main-classifier-code="YHISELAMU" required model-value-attr="code"></hois-classifier-select> </md-input-container> </hois-collapsable> <hois-collapsable label="(\'student.specialNeeds\' | translate)" ng-if="student.userIsSchoolAdmin || student.userIsStudentGroupTeacher"> <md-checkbox ng-model="student.isSpecialNeed" name="isSpecialNeed"> {{\'student.isSpecialNeed\' | translate}} </md-checkbox> <md-input-container class="md-block"> <label>{{\'student.specialNeed\' | translate}}</label> <hois-classifier-select ng-model="student.specialNeeds" name="specialNeeds" main-classifier-code="ERIVAJADUS" model-value-attr="code" multiple only-valid criteria="{higher: !student.isVocational ? true : undefined, vocational: student.isVocational ? true : undefined}"></hois-classifier-select> </md-input-container> <md-checkbox ng-model="student.isRepresentativeMandatory" name="isRepresentativeMandatory"> {{\'student.isRepresentativeMandatory\' | translate}} </md-checkbox> </hois-collapsable> <hois-collapsable label="(\'student.photo.label\' | translate)" ng-if="student.userIsSchoolAdmin || student.userIsStudentGroupTeacher"> <lf-ng-md-file-input name="photoFiles" lf-files="photoFiles" lf-filesize="3MB" accept=".png, .jpg, .jpeg" lf-mimetype="image/*" preview lf-placeholder="{{!student.photo ? (\'student.photo.notSelected\' | translate) :  (\'student.photo.selectNewPhoto\' | translate)}}" lf-browse-label="{{\'student.photo.selectPhoto\' | translate}}" lf-remove-label="{{\'main.button.clear\' | translate}}"></lf-ng-md-file-input> <div ng-messages="studentEditForm.photoFiles.$error" style="color:red"> <div ng-message="filesize">{{\'main.messages.error.fileTooLarge\' | translate}} 3MB!</div> <div ng-message="mimetype">{{\'main.messages.error.wrongExtension\' | translate}} png, jpg, jpeg</div> </div> <h3 ng-if="student.photo">{{\'student.photo.currentPhoto\' | translate}}</h3> <div flex="30" flex-sm="100" flex-xs="100"> <img ng-if="student.photo" flex="100" ng-src="{{student.imageUrl}}" id="currentPhotoView"> </div> <br> <md-checkbox ng-model="student.deleteCurrentPhoto" name="deleteCurrentPhoto" ng-if="student.photo && !photoFiles[0]"> {{\'student.photo.delete\' | translate}} </md-checkbox> </hois-collapsable> </form> <md-button ng-click="update()" class="md-raised md-primary">{{\'main.button.save\' | translate}}</md-button> <md-button ng-click="back(\'#/students/\' + student.id + \'/main\', studentEditForm)" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </div> </div>'),
a.put("student/list.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <form name="searchForm" ng-submit="searchForm.$valid && loadData()" novalidate ng-model-options="{allowInvalid: true}"> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'student.name\' | translate}}</label> <input ng-model="criteria.name" name="name" type="text" md-maxlength="255" autofocus> </md-input-container> <md-input-container ng-if="!auth.isStudent()" flex="50" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label class="textInput">{{\'student.idcode\' | translate}}</label> <input ng-model="criteria.idcode" name="idcode" type="text" minlength="11" md-maxlength="11"> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label>{{\'student.curriculum\' | translate}}</label> <hois-select ng-model="criteria.curriculumVersion" name="curriculumVersion" type="curriculumversion" multiple></hois-select> </md-input-container> <hois-autocomplete flex="50" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0" ng-model="criteria.studentGroupId" ha-attribute="id" ha-controller="directiveControllers" method="studentgroups" name="studentGroup" label="{{\'student.studentGroup\'}}"></hois-autocomplete> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label>{{\'student.studyForm\' | translate}}</label> <hois-classifier-select ng-model="criteria.studyForm" criteria="{higher: auth.school.higher ? true : undefined, vocational: auth.school.vocational ? true : undefined}" name="studyForm" model-value-attr="code" main-classifier-code="OPPEVORM" multiple></hois-classifier-select> </md-input-container> <md-input-container flex="50" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'student.status\' | translate}}</label> <hois-classifier-select ng-if="auth.isAdmin() || auth.isTeacher()" criteria="{higher: auth.school.higher ? true : undefined, vocational: auth.school.vocational ? true : undefined}" ng-model="criteria.status" name="status" model-value-attr="code" main-classifier-code="OPPURSTAATUS" multiple></hois-classifier-select> <hois-classifier-select ng-if="auth.isStudent()" criteria="{higher: auth.school.higher ? true : undefined, vocational: auth.school.vocational ? true : undefined}" ng-model="criteria.status" name="status" model-value-attr="code" main-classifier-code="OPPURSTAATUS" filter-values="[\'OPPURSTAATUS_K\', \'OPPURSTAATUS_L\']" multiple></hois-classifier-select> </md-input-container> </div> <div layout="row"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> <md-button ng-if="auth.isAdmin() && auth.school.higher && auth.authorizedRoles.indexOf(\'ROLE_OIGUS_M_TEEMAOIGUS_OPPUR\') !== -1" class="md-raised" ng-href="#/students/specialities?_menu">{{\'student.speciality.button\' | translate}}</md-button> </div> <div flex-xs="0" flex-gt-xs="0" flex-gt-sm="50"></div> </form> </fieldset> </div> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="person.lastname,person.firstname">{{\'student.name\' | translate}}</th> <th ng-if="auth.isAdmin() || auth.isTeacher()" md-column md-order-by="person.idcode">{{\'student.idcode\' | translate}}</th> <th md-column md-order-by="curriculumVersion.code">{{\'student.curriculum\' | translate}}</th> <th md-column md-order-by="studentGroup.code">{{\'student.studentGroup\' | translate}}</th> <th md-column md-order-by="{{currentLanguage()===\'en\' ? \'studyForm.nameEn\' : \'studyForm.nameEt\'}}">{{\'student.studyForm\' | translate}}</th> <th md-column md-order-by="{{currentLanguage()===\'en\' ? \'status.nameEn\' : \'status.nameEt\'}}">{{\'student.status\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell> <a ng-if="auth.isAdmin() || auth.isTeacher()" md-no-ink class="md-primary" ng-href="#/students/{{::row.id}}/main">{{::row.fullname}}</a> <span ng-if="auth.isStudent()">{{::row.fullname}}</span> </td> <td ng-if="auth.isAdmin() || auth.isTeacher()" md-cell>{{::row.idcode}}</td> <td md-cell>{{currentLanguageNameField(row.curriculumVersion)}}</td> <td md-cell>{{currentLanguageNameField(row.studentGroup)}}</td> <td md-cell>{{currentLanguageNameField(row.studyForm)}}</td> <td md-cell>{{currentLanguageNameField(row.status)}}</td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> </div>'),a.put("student/student.journal.html",'<div class="ois-form-layout-padding" ng-cloak> <div flex> <div layout="row" layout-sm="column" layout-xs="column" class="form-readonly"> <md-input-container flex="50" flex-sm="100" flex-xs="100"> <label>{{\'student.journal.modules\' | translate}}</label> <hois-value value="$parent.currentLanguageNameField(journal.modules)"></hois-value> </md-input-container> <md-input-container flex="50" flex-sm="100" flex-xs="100"> <label>{{auth.higher ? (\'student.journal.teachersHigher\' | translate) : (\'student.journal.teachersVocational\' | translate)}}</label> <hois-value value="journal.teachers"></hois-value> </md-input-container> </div> <md-table-container hide-xs> <table md-table md-progress="journal.$promise"> <thead md-head> <tr md-row> <th md-column>{{\'student.journal.entry.date\' | translate}}</th> <th md-column>{{\'student.journal.entry.nameContent\' | translate}}</th> <th md-column style="min-width: 100px">{{\'student.journal.entry.grade\' | translate}}</th> <th md-column>{{\'student.journal.entry.addInfo\' | translate}} / {{\'student.journal.entry.remark\' | translate}}</th> <th md-column>{{\'student.journal.entry.homework\' | translate}}</th> <th md-column>{{\'student.journal.entry.homeworkDuedate\' | translate}}</th> <th md-column>{{\'student.journal.entry.absence\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in journal.journalEntries" ng-class-odd="\'odd\'" ng-class-even="\'even\'" md-colors="{background: getEntryColor(row.entryType.code)}"> <td md-cell>{{row.entryDate ? (row.entryDate | hoisDate) : \'-\'}}</td> <td md-cell> <span>{{row.nameEt ? row.nameEt : \'-\'}}</span> <span ng-if="row.nameEt && row.content">/</span> <hois-value value="row.content"></hois-value> </td> <td md-cell> <span ng-repeat="previousGrade in row.previousResults | orderBy: \'gradeInserted\'"> <span> <span>{{previousGrade.gradeValue}}</span> <md-tooltip class="tooltip-multiline"> <div>{{previousGrade.gradeInserted | hoisDate}}, {{previousGrade.gradeInsertedBy}}</div> </md-tooltip> </span> <span>* / </span> </span> <span> <span>{{row.gradeValue ? row.gradeValue : \'-\'}}</span> <md-tooltip md-direction="bottom" style="height: auto"> <div>{{row.gradeInserted | hoisDate}}, {{row.gradeInsertedBy}}</div> </md-tooltip> </span> </td> <td md-cell> <span ng-class="{\'journal-remark\': row.isRemark}" style="word-break: break-word"> <span>{{row.addInfo ? row.addInfo : \'-\'}}</span> <md-tooltip ng-if="row.isRemark" class="tooltip-multiline"> <div>{{row.remarkInserted | hoisDate}}, {{row.remarkInsertedBy}}</div> </md-tooltip> </span> </td> <td md-cell> <hois-value value="row.homework ? row.homework : \'-\'"></hois-value> </td> <td md-cell>{{row.homeworkDueDate ? (row.homeworkDueDate | hoisDate) : \'-\' }}</td> <td md-cell> <span ng-if="row.absence"> <hois-classifier-value ng-model="row.absence" main-classifier-code="PUUDUMINE"></hois-classifier-value> </span> <span ng-if="row.lessonAbsences"> <div ng-repeat="lessonAbsence in row.lessonAbsences | orderBy: \'lessonNr\'" layout="row"> <hois-classifier-value ng-model="lessonAbsence.absence" main-classifier-code="PUUDUMINE"></hois-classifier-value> <span>&nbsp; ({{lessonAbsence.lessonNr}})</span> </div> </span> <span ng-if="!row.absence && !row.lessonAbsences">-</span> </td> </tr> </tbody> </table> </md-table-container> <div hide-gt-xs> <hois-collapsable ng-repeat="row in journal.journalEntries" expanded="false" header-background-color="getEntryMdColor(row.entryType.code)" class="journal-mobile-collapsable"> <hois-collapsable-header> <div layout="row" layout-align="space-between end"> <span>{{row.entryDate ? (row.entryDate | hoisDate) : \'-\'}}</span> <span> <span ng-if="row.gradeValue && !row.isRemark">{{row.gradeValue}}</span> <span ng-if="row.isRemark"> <md-icon md-font-set="material-icons" md-colors="{color: \'warn\'}">warning</md-icon> </span> </span> </div> </hois-collapsable-header> <div flex> <table md-table class="journal-mobile-table"> <tbody md-body> <tr md-row ng-if="row.content"> <td md-cell>{{\'student.journal.entry.content\' | translate}}</td> </tr> <tr md-row ng-if="row.content"> <td md-cell> <hois-value value="row.content"></hois-value> </td> </tr> <tr md-row ng-if="row.gradeValue || row.previousResults.length > 0"> <td md-cell>{{\'student.journal.entry.grade\' | translate}}</td> </tr> <tr md-row ng-if="row.gradeValue || row.previousResults.length > 0"> <td md-cell> <table md-table class="journal-mobile-grades-table"> <tbody md-body> <tr md-row> <td md-cell>{{row.gradeValue ? row.gradeValue : \'-\'}}</td> <td md-cell> <span> <span>{{row.gradeInserted | hoisDate}}</span> <md-tooltip md-direction="bottom">{{row.gradeInsertedBy}}</md-tooltip> </span> </td> </tr> <tr md-row ng-repeat="previousGrade in row.previousResults | orderBy: \'-gradeInserted\'"> <td md-cell>{{previousGrade.gradeValue}} *</td> <td md-cell> <span> <span>{{previousGrade.gradeInserted | hoisDate}}</span> <md-tooltip md-direction="bottom">{{previousGrade.gradeInsertedBy}}</md-tooltip> </span> </td> </tr> </tbody> </table> </td> </tr> <tr md-row ng-if="row.addInfo"> <td md-cell> <span ng-if="!row.isRemark">{{\'student.journal.entry.addInfo\' | translate}}</span> <span ng-if="row.isRemark">{{\'student.journal.entry.remark\' | translate}}</span> </td> </tr> <tr md-row ng-if="row.addInfo"> <td md-cell> <span ng-class="{\'journal-remark\': row.isRemark}" style="word-break: break-word"> <span>{{row.addInfo}}</span> <md-tooltip ng-if="row.isRemark && row.remarkInsertedBy" class="tooltip-multiline"> <div>{{row.remarkInserted | hoisDate}}, {{row.remarkInsertedBy}}</div> </md-tooltip> </span> </td> </tr> <tr md-row ng-if="row.homework"> <td md-cell>{{\'student.journal.entry.homework\' | translate}}</td> </tr> <tr md-row ng-if="row.homework"> <td md-cell> <hois-value value="row.homework"></hois-value> </td> </tr> <tr md-row ng-if="row.homeworkDueDate"> <td md-cell>{{\'student.journal.entry.homeworkDuedate\' | translate}}</td> </tr> <tr md-row ng-if="row.homeworkDueDate"> <td md-cell>{{row.homeworkDueDate | hoisDate}}</td> </tr> <tr md-row ng-if="row.absence || row.lessonAbsences"> <td md-cell>{{\'student.journal.entry.absence\' | translate}}</td> </tr> <tr md-row ng-if="row.absence || row.lessonAbsences"> <td md-cell> <span ng-if="row.absence"> <hois-classifier-value ng-model="row.absence" main-classifier-code="PUUDUMINE"></hois-classifier-value> </span> <span ng-if="row.lessonAbsences"> <div ng-repeat="lessonAbsence in row.lessonAbsences | orderBy: \'lessonNr\'" layout="row"> <hois-classifier-value ng-model="lessonAbsence.absence" main-classifier-code="PUUDUMINE"></hois-classifier-value> <span>&nbsp; ({{lessonAbsence.lessonNr}})</span> </div> </span> </td> </tr> <tr md-row ng-if="!row.content && !(row.gradeValue || row.previousResults.length > 0) && !row.addInfo && !row.homework \r\n                && !row.homeworkDueDate && !(row.absence || row.lessonAbsences)"> <td md-cell>{{\'student.journal.entry.empty\' | translate}}</td> </tr> </tbody> </table> </div> </hois-collapsable> </div> <div>&nbsp;</div> <div layout="row"> <div layout="row" layout-align="end" layout-sm="column" layout-xs="column" flex="100"> <span class="capacity-type-legend" md-colors="{background: getEntryColor(\'SISSEKANNE_T\')}">{{$parent.currentLanguageNameField(journalEntryTypes[\'SISSEKANNE_T\'])}}</span> <span class="capacity-type-legend" flex-offset="5" flex-offset-sm="0" flex-offset-xs="0" md-colors="{background: getEntryColor(\'SISSEKANNE_E\')}">{{$parent.currentLanguageNameField(journalEntryTypes[\'SISSEKANNE_E\'])}}</span> <span class="capacity-type-legend" flex-offset="5" flex-offset-sm="0" flex-offset-xs="0" md-colors="{background: getEntryColor(\'SISSEKANNE_I\')}">{{$parent.currentLanguageNameField(journalEntryTypes[\'SISSEKANNE_I\'])}}</span> <span class="capacity-type-legend" flex-offset="5" flex-offset-sm="0" flex-offset-xs="0" md-colors="{background: getEntryColor(\'SISSEKANNE_H\')}">{{$parent.currentLanguageNameField(journalEntryTypes[\'SISSEKANNE_H\'])}}</span> <span class="capacity-type-legend" flex-offset="5" flex-offset-sm="0" flex-offset-xs="0" md-colors="{background: getEntryColor(\'SISSEKANNE_P\')}">{{$parent.currentLanguageNameField(journalEntryTypes[\'SISSEKANNE_P\'])}}</span> <span class="capacity-type-legend" flex-offset="5" flex-offset-sm="0" flex-offset-xs="0" md-colors="{background: getEntryColor(\'SISSEKANNE_R\')}">{{$parent.currentLanguageNameField(journalEntryTypes[\'SISSEKANNE_R\'])}}</span> <span ng-show="journal.moduleOutcomesAsEntries" class="capacity-type-legend" flex-offset="5" flex-offset-sm="0" flex-offset-xs="0" md-colors="{background: getEntryColor(\'SISSEKANNE_O\')}">{{$parent.currentLanguageNameField(journalEntryTypes[\'SISSEKANNE_O\'])}}</span> <span class="capacity-type-legend" flex-offset="5" flex-offset-sm="0" flex-offset-xs="0" md-colors="{background: getEntryColor(\'SISSEKANNE_L\')}">{{$parent.currentLanguageNameField(journalEntryTypes[\'SISSEKANNE_L\'])}}</span> </div> </div> <div layout="row" layout-xs="column"> <md-button class="md-raised" ng-click="back(\'#/students/journals\')">{{\'main.button.back\' | translate}}</md-button> </div> </div> </div>'),a.put("student/student.journal.list.html",'<md-nav-bar md-selected-nav-item="currentNavItem" aria-label="{{\'subjectStudyPeriod.label.options\' | translate}}"> <md-nav-item md-nav-href="#/students/journals" name="journals">{{\'student.journal.journals\' | translate}}</md-nav-item> <md-nav-item md-nav-href="#/students/study" name="study">{{\'student.journal.study.label\' | translate}}</md-nav-item> <md-nav-item md-nav-href="#/students/tasks" name="tasks">{{\'student.journal.tasks.label\' | translate}}</md-nav-item> </md-nav-bar> <div layout-padding> <div flex> <hois-collapsable ng-repeat="year in journalsByYears track by $index" expanded="year.collapsableOpen" expand-collapse-action="getStudyYearJournals(year.yearId, year.yearCode)"> <hois-collapsable-header> <span> <hois-classifier-value style="display: inline-block" ng-model="year.yearCode" main-classifier-code="OPPEAASTA"></hois-classifier-value> <span>{{\'student.journal.studyYear\' | translate}}</span> </span> </hois-collapsable-header> <md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column width="20%">{{\'student.journal.journalName\' | translate}}</th> <th md-column width="10%">{{\'student.journal.grades\' | translate}}</th> <th md-column>{{\'student.journal.modules\' | translate}}</th> <th md-column>{{auth.higher ? (\'student.journal.teachersHigher\' | translate) : (\'student.journal.teachersVocational\' | translate)}}</th> <th md-column width="10%">{{\'student.journal.absencesIncudlingWithoutReason\' | translate}}</th> <th md-column>{{\'student.journal.lateForClass\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="journal in year.journals | orderBy: \'nameEt\'" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell><a ng-href="/#/students/journals/{{journal.id}}">{{journal.nameEt}}</a></td> <td md-cell> <span ng-repeat="result in journal.journalEntries | filter : {gradeValue: \'\'} | orderBy: [\'!entryDate\', \'-entryDate\']" ng-class="{good: result.entryType.code === \'SISSEKANNE_L\' && resultIsPostive(result.gradeValue), \r\n                                bad: result.entryType.code === \'SISSEKANNE_L\' && !resultIsPostive(result.gradeValue),\r\n                                bold: isTestButNotFinal(result.entryType.code)}"> {{result.gradeValue}} <md-tooltip class="tooltip-multiline" ng-if="result.gradeValue"> {{result.gradeInserted | hoisDate}} <span ng-if="result.entryType.code">, {{currentLanguageNameField(result.entryType)}}</span> <span ng-if="result.addInfo && !result.isRemark">, {{result.addInfo}}</span> </md-tooltip> </span> </td> <td md-cell>{{currentLanguageNameField(journal.modules)}}</td> <td md-cell>{{journal.teachers}}</td> <td md-cell> <span>{{journal.absences[\'PUUDUMINE_P\'] + journal.absences[\'PUUDUMINE_V\'] + journal.absences[\'PUUDUMINE_PR\']}} /</span> <span ng-class="{bad: journal.absences[\'PUUDUMINE_P\'] > 0}">{{journal.absences[\'PUUDUMINE_P\']}}</span> </td> <td md-cell>{{journal.absences[\'PUUDUMINE_H\']}}</td> <td md-cell><a ng-href="/#/studyMaterial/vocational/{{journal.id}}/view">{{\'studyMaterial.label\' | translate}}</a></td> </tr> </tbody> </table> </md-table-container> </hois-collapsable> </div> </div> <style>.good {\r\n    color: rgb(13,71,161);\r\n    font-weight: 500;\r\n    font-size: 18px;\r\n}\r\n    \r\n.bad {\r\n    color: red;\r\n    font-weight: 500;\r\n    font-size: 18px;\r\n}\r\n\r\n.bold {\r\n    font-weight: 500;\r\n}</style>'),a.put("student/student.journal.study.html",'<md-nav-bar md-selected-nav-item="currentNavItem" aria-label="{{\'subjectStudyPeriod.label.options\' | translate}}"> <md-nav-item md-nav-href="#/students/journals" name="journals">{{\'student.journal.journals\' | translate}}</md-nav-item> <md-nav-item md-nav-href="#/students/study" name="study">{{\'student.journal.study.label\' | translate}}</md-nav-item> <md-nav-item md-nav-href="#/students/tasks" name="tasks">{{\'student.journal.tasks.label\' | translate}}</md-nav-item> </md-nav-bar> <div layout-padding> <div layout-row style="text-align: center"> <md-button ng-if="previousWeekIndex !== null" ng-click="changeWeek(previousWeekIndex)" class="md-icon-button md-primary"> <md-icon>arrow_back</md-icon> </md-button> <h2 style="display:inline-block">{{shownWeek.start | hoisDayMonth}} - {{shownWeek.end | hoisDayMonth}}</h2> <md-button ng-if="nextWeekIndex !== null" ng-click="changeWeek(nextWeekIndex)" class="md-icon-button md-primary"> <md-icon>arrow_forward</md-icon> </md-button> </div> <md-table-container ng-if="shownWeek.entries.length > 0"> <table md-table md-progress="endpoint.$promise"> <thead md-head> <tr md-row> <th md-column width="10%">{{\'student.journal.study.date\' | translate}}</th> <th md-column width="20%">{{\'student.journal.study.journal\' | translate}}</th> <th md-column width="70%">{{\'student.journal.study.content\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="entry in shownWeek.entries" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{entry.date | hoisDate}}</td> <td md-cell>{{entry.journalName}}</td> <td md-cell> <hois-value value="entry.content"></hois-value> </td> </tr> </tbody> </table> </md-table-container> <div layout-row ng-if="shownWeek.entries.length === 0" style="text-align: center">{{\'student.journal.study.noEntries\' | translate}}</div> </div>'),a.put("student/student.journal.tasks.html",'<md-nav-bar md-selected-nav-item="currentNavItem" aria-label="{{\'subjectStudyPeriod.label.options\' | translate}}"> <md-nav-item md-nav-href="#/students/journals" name="journals">{{\'student.journal.journals\' | translate}}</md-nav-item> <md-nav-item md-nav-href="#/students/study" name="study">{{\'student.journal.study.label\' | translate}}</md-nav-item> <md-nav-item md-nav-href="#/students/tasks" name="tasks">{{\'student.journal.tasks.label\' | translate}}</md-nav-item> </md-nav-bar> <div layout-padding> <div layout-row style="text-align: center"> <md-button ng-if="previousWeekIndex !== null" ng-click="changeWeek(previousWeekIndex)" class="md-icon-button md-primary"> <md-icon>arrow_back</md-icon> </md-button> <h2 style="display:inline-block">{{shownWeek.start | hoisDayMonth}} - {{shownWeek.end | hoisDayMonth}}</h2> <md-button ng-if="nextWeekIndex !== null" ng-click="changeWeek(nextWeekIndex)" class="md-icon-button md-primary"> <md-icon>arrow_forward</md-icon> </md-button> </div> <md-table-container ng-if="shownWeek.entries.length > 0"> <table md-table md-progress="endpoint.$promise"> <thead md-head> <tr md-row> <th md-column width="10%">{{\'student.journal.tasks.date\' | translate}}</th> <th md-column width="20%">{{\'student.journal.tasks.journal\' | translate}}</th> <th md-column width="70%">{{\'student.journal.tasks.content\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="task in shownWeek.entries" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{task.date | hoisDate}}</td> <td md-cell>{{task.journalName}}</td> <td md-cell> <hois-value value="task.taskContent"></hois-value> </td> </tr> </tbody> </table> </md-table-container> <div layout-row ng-if="shownWeek.entries.length === 0" style="text-align: center">{{\'student.journal.tasks.noTasks\' | translate}}</div> </div>'),a.put("student/view.absences.html",'<div ng-cloak> <div ng-if="student && student.isVocational===true" ng-include="\'student/templates/view.navbar.vocational.tmpl.html\'"></div> </div> <div layout-padding ng-cloak> <div flex> <div layout="row" layout-xs="column" flex class="form-readonly"> <div layout="row" layout-sm="column" layout-xs="column" flex> <md-input-container flex> <label>{{\'student.label\' | translate}}</label> <hois-value value="student.person.firstname + \' \' + student.person.lastname"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'student.idcode\' | translate}}</label> <hois-value value="student.person.idcode"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column" flex> <md-input-container flex> <label>{{\'student.studyForm\' | translate}}</label> <hois-classifier-value ng-model="student.studyForm" main-classifier-code="OPPEVORM"></hois-classifier-value> </md-input-container> <md-input-container flex> <label>{{\'student.curriculum\' | translate}}</label> <hois-value value="currentLanguageNameField(student.curriculumVersion)"></hois-value> </md-input-container> </div> </div> <md-table-container> <table md-table md-progress="tabledata.$promise" class="secondary-table"> <thead md-head md-order="absencesCriteria.order" md-on-reorder="loadAbsences"> <tr md-row> <th md-column md-order-by="validFrom">{{\'student.absence.validFrom\' | translate}}</th> <th md-column md-order-by="validThru">{{\'student.absence.validThru\' | translate}}</th> <th md-column md-order-by="cause">{{\'student.absence.cause\' | translate}}</th> <th md-column md-order-by="isAccepted, isRejected">{{\'student.absence.status\' | translate}}</th> <th></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{::row.validFrom | hoisDate}}</td> <td md-cell>{{::row.validThru | hoisDate}}</td> <td md-cell>{{::row.cause}}</td> <td md-cell> <span ng-if="row.isAccepted">{{\'student.absence.isAccepted\' | translate}}</span> <span ng-if="row.isRejected"> {{\'student.absence.isRejected\' | translate}} <span ng-if="row.rejectReason"> <md-tooltip md-direction="bottom"><p>{{row.rejectReason}}</p></md-tooltip> <md-icon md-font-set="material-icons" ng-if="row.rejectReason">message</md-icon> </span> </span> <span ng-if="!row.isAccepted && !row.isRejected">{{\'student.absence.isNotAccepted\' | translate}}</span> </td> <td md-cell> <md-button md-no-ink ng-click="editAbsence(row)" class="md-primary change-button" ng-if="row.userCanEdit">{{\'main.button.change\' | translate}}</md-button> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="absencesCriteria.size" md-limit-options="[10, 20, 50]" md-page="absencesCriteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadAbsences" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> <md-button ng-click="editAbsence({})" class="md-primary md-raised" ng-if="tabledata.canAddAbsence">{{\'main.button.create\' | translate}}</md-button> <md-button ng-if="!auth.isStudent() && !auth.isParent()" ng-click="back(\'#/students\')" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </div> </div> <style>md-tooltip {\r\n      height: auto !important;\r\n    }\r\n  \r\n    md-tooltip p {\r\n      white-space: normal;\r\n    }\r\n  \r\n    @media only screen and (max-width: 649px) {\r\n      md-tooltip p {\r\n        max-width: 90vw;\r\n      }\r\n    }\r\n  \r\n    @media only screen and (min-width: 650px) {\r\n      md-tooltip p {\r\n        /* Give at least 10 px free space */\r\n        max-width: 640px;\r\n      }\r\n    }</style>'),a.put("student/view.documents.html",'<div ng-cloak> <div ng-if="student && student.isVocational===true" ng-include="\'student/templates/view.navbar.vocational.tmpl.html\'"></div> <div ng-if="student && student.isVocational===false" ng-include="\'student/templates/view.navbar.higher.tmpl.html\'"></div> </div> <div layout-padding ng-cloak> <div flex> <div layout="row" layout-xs="column" flex class="form-readonly"> <div layout="row" layout-sm="column" layout-xs="column" flex> <md-input-container flex> <label>{{\'student.label\' | translate}}</label> <hois-value value="student.person.firstname + \' \' + student.person.lastname"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'student.idcode\' | translate}}</label> <hois-value value="student.person.idcode"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column" flex> <md-input-container flex> <label>{{\'student.studyForm\' | translate}}</label> <hois-classifier-value ng-model="student.studyForm" main-classifier-code="OPPEVORM"></hois-classifier-value> </md-input-container> <md-input-container flex> <label>{{\'student.curriculum\' | translate}}</label> <hois-value value="currentLanguageNameField(student.curriculumVersion)"></hois-value> </md-input-container> </div> </div> <hois-collapsable label="(\'student.application.label\' | translate)"> <md-table-container> <table md-table md-progress="applications.$promise" class="secondary-table"> <thead md-head md-order="applicationsCriteria.order" md-on-reorder="loadApplications"> <tr md-row> <th md-column md-order-by="{{currentLanguage()===\'en\' ? \'type.nameEn\' : \'type.nameEt\'}}">{{\'student.application.type\' | translate}}</th> <th md-column md-order-by="submitted">{{\'student.application.created\' | translate}}</th> <th md-column md-order-by="{{currentLanguage()===\'en\' ? \'status.nameEn\' : \'status.nameEt\'}}">{{\'student.application.status\' | translate}}</th> <th md-column md-order-by="5">{{\'student.application.confirmDate\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in applications.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell> <a ng-href="#/applications/{{::row.id}}/view">{{currentLanguageNameField(row.type)}}</a> </td> <td md-cell>{{::row.submitted | hoisDate}}</td> <td md-cell>{{currentLanguageNameField(row.status)}}</td> <td md-cell>{{::row.confirmDate | hoisDate}}</td> <td md-cell> <a ng-if="student.userCanEditStudent && ((row.status.code === \'AVALDUS_STAATUS_KOOST\') || (row.status.code === \'AVALDUS_STAATUS_YLEVAAT\' && auth.isAdmin()))" md-no-ink class="md-button md-primary change-button" ng-href="#/applications/{{::row.id}}/edit">{{\'main.button.change\' | translate}}</a> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination ng-show="applications.totalElements > applicationsCriteria.size" md-limit="applicationsCriteria.size" md-limit-options="[5, 10, 20, 50]" md-page="applicationsCriteria.page" md-total="{{applications.totalElements}}" md-on-paginate="loadApplications" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> <br ng-if="auth.isStudent()"> <md-table-container ng-if="auth.isStudent()"> <table md-table md-progress="applicationTypes.$promise" class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'application.type\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in applicationTypes" ng-class-odd="\'odd\'" ng-class-even="\'even\'" ng-if="applicationTypesApplicable[row.code]"> <td md-cell>{{currentLanguageNameField(row)}}</td> <td md-cell> <div ng-if="applicationTypesApplicable[row.code].isAllowed === true" layout="row" layout-align="end end"> <a class="md-button md-primary" ng-href="#/applications/new?student={{studentId}}&type={{row.code}}">{{\'main.button.apply\' | translate}}</a> </div> </td> </tr> </tbody> </table> </md-table-container> </hois-collapsable> <br> <hois-collapsable ng-if="!auth.isTeacher()" label="(\'certificate.certificates\' | translate)"> <md-table-container ng-if="!auth.isTeacher()"> <table md-table md-progress="certificates.$promise" class="secondary-table"> <thead md-head md-order="certificatesCriteria.order" md-on-reorder="loadCertificates"> <tr md-row> <th md-column md-order-by="c.certificateNr">{{\'certificate.nr\' | translate}}</th> <th md-column md-order-by="type.{{currentLanguageNameField()}}">{{\'certificate.type\' | translate}}</th> <th md-column md-order-by="status.{{currentLanguageNameField()}}">{{\'certificate.status\' | translate}}</th> <th md-column md-order-by="c.headline">{{\'certificate.headline\' | translate}}</th> <th md-column md-order-by="c.inserted">{{\'certificate.inserted\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in certificates.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{::row.certificateNr}}</td> <td md-cell> <a ng-href="#/certificate/{{::row.id}}/view">{{currentLanguageNameField(row.type)}}</a> </td> <td md-cell>{{currentLanguageNameField(row.status)}}</td> <td md-cell>{{::row.headline}}</td> <td md-cell>{{row.inserted | hoisDate}}</td> </tr> </tbody> </table> </md-table-container> <md-table-pagination ng-show="!auth.isTeacher() && certificates.totalElements > certificatesCriteria.size" md-limit="certificatesCriteria.size" md-limit-options="[5, 10, 15]" md-page="certificatesCriteria.page" md-total="{{certificates.totalElements}}" md-on-paginate="loadCertificates" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> <br ng-if="auth.isStudent()"> <md-table-container> <table md-table ng-if="auth.isStudent()" class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'certificate.type\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="type in certificateTypes" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{currentLanguageNameField(type)}}</td> <td md-cell> <md-button md-no-ink class="md-primary change-button" ng-href="#/certificate/{{::type.code}}/new"> {{\'certificate.order\' | translate}} </md-button> </td> </tr> </tbody> </table> </md-table-container> </hois-collapsable> <br> <hois-collapsable label="(\'student.directive.label\' | translate)"> <md-table-container> <table md-table md-progress="directives.$promise" class="secondary-table"> <thead md-head md-order="directivesCriteria.order" md-on-reorder="loadDirectives"> <tr md-row> <th md-column md-order-by="headline">{{\'student.directive.headline\' | translate}}</th> <th md-column md-order-by="{{currentLanguage()===\'en\' ? \'type.nameEn\' : \'type.nameEt\'}}">{{\'student.directive.type\' | translate}}</th> <th md-column md-order-by="directiveNr">{{\'student.directive.directiveNr\' | translate}}</th> <th md-column md-order-by="confirmDate">{{\'student.directive.confirmDate\' | translate}}</th> <th md-column md-order-by="insertedBy">{{\'student.directive.createdBy\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in directives.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell> <a ng-href="#/directives/{{::row.id}}/view">{{::row.headline}}</a> </td> <td md-cell>{{currentLanguageNameField(row.type)}}</td> <td md-cell>{{::row.directiveNr}}</td> <td md-cell>{{::row.confirmDate | hoisDate}}</td> <td md-cell>{{::row.insertedBy}}</td> </tr> </tbody> </table> </md-table-container> <md-table-pagination ng-show="directives.totalElements > directivesCriteria.size" md-limit="directivesCriteria.size" md-limit-options="[5, 10, 15]" md-page="directivesCriteria.page" md-total="{{directives.totalElements}}" md-on-paginate="loadDirectives" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </hois-collapsable> <hois-collapsable label="(\'student.practiceContracts.label\' | translate)"> <md-table-container> <table md-table md-progress="practiceContracts.$promise" class="secondary-table"> <thead md-head md-order="practiceContractsCriteria.order" md-on-reorder="loadPracticeContracts"> <tr md-row> <!--todo order byd--> <th md-column md-order-by="contractNr">{{\'student.practiceContracts.contractNumber\' | translate}}</th> <th md-column md-order-by="startDate, endDate">{{\'student.practiceContracts.validity\' | translate}}</th> <th md-column md-order-by="e.name">{{\'student.practiceContracts.enterprise\' | translate}}</th> <th md-column md-order-by="e.contactPersonName">{{\'student.practiceContracts.supervisor\' | translate}}</th> <th md-column md-order-by="p.firstname, p.lastname">{{\'student.practiceContracts.schoolSupervisor\' | translate}}</th> <th md-column md-order-by="confirmDate">{{\'student.practiceContracts.contractDate\' | translate}}</th> <th md-column md-order-by="status.{{currentLanguageNameField()}}">{{\'student.practiceContracts.status\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in practiceContracts.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{::row.contractNr}}</td> <td md-cell>{{::row.startDate | hoisDate}} - {{::row.endDate | hoisDate}}</td> <td md-cell>{{::row.enterprise}}</td> <td md-cell>{{::row.supervisor}}</td> <td md-cell>{{::row.schoolSupervisor}}</td> <td md-cell>{{::row.contractDate | hoisDate}}</td> <td md-cell>{{currentLanguageNameField(row.status)}}</td> <td md-cell> <md-button ng-if="student.userCanEditStudent && (auth.isAdmin() && row.status.code === \'LEPING_STAATUS_S\')" md-no-ink class="md-primary change-button" ng-href="#/contracts/{{::row.id}}/edit">{{\'main.button.edit\' | translate}}</md-button> <md-button ng-if="!auth.isAdmin() || (auth.isAdmin() && row.status.code !== \'LEPING_STAATUS_S\')" md-no-ink class="md-primary change-button" ng-href="#/contracts/{{::row.id}}/view">{{\'main.button.view\' | translate}}</md-button> </td> </tr> </tbody> </table> </md-table-container> <!-- todo lehe suuruse valik katki?--> <md-table-pagination ng-show="practiceContracts.totalElements > practiceContractsCriteria.size" md-limit="practiceContractsCriteria.size" md-limit-options="[5, 10, 15]" md-page="practiceContractsCriteria.page" md-total="{{practiceContracts.totalElements}}" md-on-paginate="loadPracticeContracts" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </hois-collapsable> <md-button ng-if="!auth.isStudent() && !auth.isParent()" ng-click="back(\'#/students\')" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </div> </div>'),
a.put("student/view.main.html",'<div ng-cloak> <div ng-if="student && student.isVocational===true" ng-include="\'student/templates/view.navbar.vocational.tmpl.html\'"></div> <div ng-if="student && student.isVocational===false" ng-include="\'student/templates/view.navbar.higher.tmpl.html\'"></div> </div> <div layout-padding ng-cloak class="form-readonly"> <div flex> <div layout="row" layout-xs="column" flex> <div flex="70"> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="35" flex-sm="100" flex-xs="100"> <label>{{\'student.firstname\' | translate}}</label> <hois-value value="student.person.firstname"></hois-value> </md-input-container> <md-input-container flex="60" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'student.lastname\' | translate}}</label> <hois-value value="student.person.lastname"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="35" flex-sm="100" flex-xs="100"> <label>{{\'student.idcode\' | translate}}</label> <hois-value value="student.person.idcode"></hois-value> </md-input-container> <md-input-container flex="60" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'student.sex\' | translate}}</label> <hois-classifier-value ng-model="student.person.sex" main-classifier-code="SUGU"></hois-classifier-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="35" flex-sm="100" flex-xs="100"> <label>{{\'student.citizenship\' | translate}}</label> <hois-classifier-value ng-model="student.person.citizenship" main-classifier-code="RIIK"></hois-classifier-value> </md-input-container> <md-input-container flex="30" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'student.language\' | translate}}</label> <hois-classifier-value ng-model="student.person.language" main-classifier-code="OPPEKEEL"></hois-classifier-value> </md-input-container> <md-input-container flex="25" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'student.bankaccount\' | translate}}</label> <hois-value value="student.person.bankaccount"></hois-value> </md-input-container> </div> </div> <div flex="30"> <img ng-if="student.photo" flex="60" style="display: block; margin-left: auto; margin-right: auto" ng-src="{{student.imageUrl}}"> </div> </div> <div layout="column"> <hois-collapsable label="(\'student.study\' | translate) + \' (\' + currentLanguageNameField(student.school) + \')\' \r\n        + (student.individualCurriculum ? \' - \' + (\'student.statuses.individualCurriculumShort\' | translate) + \' (\'\r\n        + (student.individualCurriculumStart | hoisDate) + \'-\' + (student.individualCurriculumEnd | hoisDate) + \')\' : \'\')"> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="20" flex-sm="100" flex-xs="100"> <label>{{\'student.status\' | translate}}</label> <hois-classifier-value ng-model="student.status" main-classifier-code="OPPURSTAATUS"></hois-classifier-value> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{student.isVocational ? \'student.implementationPlan\' : \'student.curriculumVersion\' | translate}}</label> <hois-value value="currentLanguageNameField(student.curriculumVersion)" href-value="student.isVocational ? \'#/vocationalCurriculum/\' + student.curriculum + \'/moduleImplementationPlan/\' + student.curriculumVersion.id + \'/view\' : \'#/higherCurriculum/\' + student.curriculum + \'/version/\' + student.curriculumVersion.id + \'/view\'"></hois-value> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'student.studyLanguage\' | translate}}</label> <hois-classifier-value ng-model="student.studyLanguage" main-classifier-code="OPPEKEEL"></hois-classifier-value> </md-input-container> <md-input-container flex="50" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0" ng-if="student.isVocational && student.speciality"> <label class="textInput">{{\'studentGroup.speciality\' | translate}}</label> <hois-classifier-value ng-model="student.speciality" main-classifier-code="SPETSKUTSE"></hois-classifier-value> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0" ng-if="!student.isVocational && student.curriculumSpeciality"> <label>{{\'student.curriculumSpeciality\' | translate}}</label> <hois-value value="currentLanguageNameField(student.curriculumSpeciality)"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="20" flex-sm="100" flex-xs="100"> <label>{{\'student.studentGroup\' | translate}}</label> <hois-value value="currentLanguageNameField(student.studentGroup)" href-value="auth.isAdmin() || auth.isStudent() ? \'#/studentgroups/\' + student.studentGroup.id + \'/view\' : undefined"></hois-value> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'student.course\' | translate}}</label> <hois-value value="student.course"></hois-value> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'student.studyStart\' | translate}}</label> <hois-value value="student.studyStart | hoisDate"></hois-value> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{student.studyEnd ? \'student.studyEnd\' : \'student.nominalStudyEnd\' | translate}}</label> <hois-value value="student.studyEnd ? student.studyEnd : student.nominalStudyEnd | hoisDate"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="20" flex-sm="100" flex-xs="100"> <label>{{\'student.studyForm\' | translate}}</label> <hois-classifier-value ng-model="student.studyForm" main-classifier-code="OPPEVORM"></hois-classifier-value> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0" ng-if="!student.isVocational"> <label>{{\'student.studyLoad\' | translate}}</label> <hois-classifier-value ng-model="student.studyLoad" main-classifier-code="OPPEKOORMUS"></hois-classifier-value> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'student.fin\' | translate}}</label> <hois-classifier-value ng-model="student.fin" main-classifier-code="FINALLIKAS"></hois-classifier-value> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'student.finSpecific\' | translate}}</label> <hois-classifier-value ng-model="student.finSpecific" main-classifier-code="FINTAPSUSTUS"></hois-classifier-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="20" flex-sm="100" flex-xs="100"> <label>{{\'student.studentCard\' | translate}}</label> <hois-value value="student.studentCard"></hois-value> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'student.card.status\' | translate}}</label> <hois-classifier-value ng-model="student.studentCardStatus" main-classifier-code="OPILASPILET_STAATUS"></hois-classifier-value> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'student.card.validThru\' | translate}}</label> <hois-value value="student.studentCardValidThru | hoisDate"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="20" flex-sm="100" flex-xs="100"> <label>{{\'student.card.givenDate\' | translate}}</label> <hois-value value="student.studentCardGivenDt | hoisDate"></hois-value> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'student.card.returnDate\' | translate}}</label> <hois-value value="student.studentCardReturnedDt | hoisDate"></hois-value> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'student.card.repeating\' | translate}}</label> <hois-value value="student.isStudentCardRepetitive ? (\'main.yes\' | translate) : (\'main.no\' | translate)"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="20" flex-sm="100" flex-xs="100"> <label>{{\'student.previousStudyLevel\' | translate}}</label> <hois-classifier-value ng-model="student.previousStudyLevel" main-classifier-code="OPPEASTE"></hois-classifier-value> </md-input-container> <md-input-container ng-if="student.isVocational" flex="20" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'student.studyCompany\' | translate}}</label> <hois-value value="student.studyCompany"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="20" flex-sm="100" flex-xs="100"> <label>{{\'student.previousSchoolName\' | translate}}</label> <hois-value value="student.previousSchoolName"></hois-value> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'student.previousSchoolEndDate\' | translate}}</label> <hois-value value="student.previousSchoolEndDate | hoisYear"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="20" flex-sm="100" flex-xs="100"> <label>{{\'student.dormitory\' | translate}}</label> <hois-classifier-value ng-model="student.dormitory" main-classifier-code="YHISELAMU"></hois-classifier-value> <md-tooltip ng-if="student.dormitoryHistory.length > 0" class="tooltip-multiline"> <div ng-repeat="history in student.dormitoryHistory">{{currentLanguageNameField(history.dormitory)}} {{history.date | hoisDate}}</div> </md-tooltip> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'student.boardingSchool\' | translate}}</label> <hois-value value="currentLanguageNameField(student.boardingSchool)"></hois-value> </md-input-container> <md-input-container ng-if="student.boardingSchool" flex="20" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'student.boardingSchoolValidFrom\' | translate}}</label> <hois-value value="student.boardingSchoolValidFrom | hoisDate"></hois-value> </md-input-container> <md-input-container ng-if="student.boardingSchool" flex="20" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'student.boardingSchoolValidFrom\' | translate}}</label> <hois-value value="student.boardingSchoolValidThru | hoisDate"></hois-value> </md-input-container> </div> <div ng-if="student.boardingSchoolAddInfo" layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="95" flex-sm="100" flex-xs="100"> <label>{{\'student.boardingSchoolAddInfo\' | translate}}</label> <hois-value value="student.boardingSchoolAddInfo"></hois-value> </md-input-container> </div> </hois-collapsable> </div> <div ng-if="student.occupationCertificates && student.occupationCertificates.length > 0"> <hois-collapsable label="(\'student.occupationcertificate.label\' | translate)"> <div ng-repeat="row in student.occupationCertificates"> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="20" flex-sm="100" flex-xs="100"> <label>{{\'student.occupationcertificate.certificateNr\' | translate}}</label> <hois-value value="row.certificateNr"></hois-value> </md-input-container> <md-input-container ng-if="!student.isVocational" flex="45" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'student.occupationcertificate.occupation\' | translate}}</label> <hois-classifier-value ng-model="row.occupationCode" main-classifier-code="KUTSE"></hois-classifier-value> </md-input-container> <md-input-container ng-if="student.isVocational" flex="20" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'student.occupationcertificate.occupation\' | translate}}</label> <hois-classifier-value ng-model="row.occupationCode" main-classifier-code="KUTSE"></hois-classifier-value> </md-input-container> <md-input-container ng-if="student.isVocational" flex="20" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'student.occupationcertificate.partOccupation\' | translate}}</label> <hois-classifier-value ng-model="row.partOccupationSpecialityCode" main-classifier-codes="OSAKUTSE,SPETSKUTSE"></hois-classifier-value> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'student.occupationcertificate.language\' | translate}}</label> <hois-value value="row.language"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="20" flex-sm="100" flex-xs="100"> <label>{{\'student.occupationcertificate.issuer\' | translate}}</label> <hois-value value="row.issuer"></hois-value> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'student.occupationcertificate.issueDate\' | translate}}</label> <hois-value value="row.issueDate | hoisDate"></hois-value> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'student.occupationcertificate.validFrom\' | translate}}</label> <hois-value value="row.validFrom | hoisDate"></hois-value> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'student.occupationcertificate.validThru\' | translate}}</label> <hois-value value="row.validThru | hoisDate"></hois-value> </md-input-container> </div> </div> </hois-collapsable> </div> <div> <hois-collapsable label="(\'student.contact\' | translate)"> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="35" flex-sm="100" flex-xs="100"> <label>{{\'student.schoolEmail\' | translate}}</label> <hois-value value="student.schoolEmail"></hois-value> </md-input-container> <md-input-container flex="55" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'student.phone\' | translate}}</label> <hois-value value="student.person.phone"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="35" flex-sm="100" flex-xs="100"> <label>{{\'student.residenceCountry\' | translate}}</label> <hois-classifier-value ng-model="student.person.residenceCountry" main-classifier-code="RIIK"></hois-classifier-value> </md-input-container> <md-input-container flex="30" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'student.address\' | translate}}</label> <hois-value value="student.person.address"></hois-value> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'student.postcode\' | translate}}</label> <hois-value value="student.person.postcode"></hois-value> </md-input-container> </div> </hois-collapsable> </div> <div> <hois-collapsable label="(\'student.representatives\' | translate)"> <md-button ng-if="student.userCanAddRepresentative" ng-click="editRepresentative()" class="md-raised"> {{\'student.representative.add\' | translate}} </md-button> <br> <br> <md-table-container> <table md-table md-progress="representatives.$promise" class="secondary-table"> <thead md-head md-order="representativesCriteria.order" md-on-reorder="loadRepresentatives"> <tr md-row> <th md-column md-order-by="person.lastname">{{\'student.representative.name\' | translate}}</th> <th md-column md-order-by="person.idcode">{{\'student.representative.idcode\' | translate}}</th> <th md-column md-order-by="relation.nameEt">{{\'student.representative.relation\' | translate}}</th> <th md-column md-order-by="person.phone">{{\'student.representative.phone\' | translate}}</th> <th md-column md-order-by="person.email">{{\'student.representative.email\' | translate}}</th> <th md-column>{{\'student.representative.studentVisible\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in representatives.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{::row.person.fullname}}</td> <td md-cell>{{::row.person.idcode}}</td> <td md-cell>{{currentLanguageNameField(row.relation)}}</td> <td md-cell>{{::row.person.phone}}</td> <td md-cell>{{::row.person.email}}</td> <td md-cell>{{row.isStudentVisible ? \'main.yes\' : \'main.no\' | translate}}</td> <td md-cell> <md-button md-no-ink ng-if="row.userCanEdit" ng-click="editRepresentative(row.id)" class="md-primary change-button">{{\'main.button.change\' | translate}}</md-button> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination ng-show="representatives.totalElements > representativesCriteria.size" md-limit="representativesCriteria.size" md-limit-options="[5, 10, 15]" md-page="representativesCriteria.page" md-total="{{representatives.totalElements}}" md-on-paginate="loadRepresentatives" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </hois-collapsable> </div> <div class="top-margin"> <hois-collapsable label="(\'student.specialNeeds\' | translate)" ng-if="student.userIsSchoolAdmin || student.userIsStudentGroupTeacher"> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="35" flex-sm="100" flex-xs="100"> <label>{{\'student.isSpecialNeed\' | translate}}</label> <hois-value value="student.isSpecialNeed ? \'main.yes\' : \'main.no\' | translate"></hois-value> </md-input-container> <md-input-container flex="30" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'student.specialNeed\' | translate}}</label> <hois-classifier-value ng-model="student.specialNeeds" main-classifier-code="ERIVAJADUS"></hois-classifier-value> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'student.isRepresentativeMandatory\' | translate}}</label> <hois-value value="student.isRepresentativeMandatory ? \'main.yes\' : \'main.no\' | translate"></hois-value> </md-input-container> </div> </hois-collapsable> </div> <div ng-if="student.isVocational===false"> <hois-collapsable label="(\'student.foreignStudy\' | translate)"> <md-table-container> <table md-table md-progress="foreignstudies.$promise" class="secondary-table"> <thead md-head md-order="foreignstudiesCriteria.order" md-on-reorder="loadForeignstudies"> <tr md-row> <th md-column md-order-by="1">{{\'student.foreignstudy.school\' | translate}}</th> <th md-column md-order-by="country.{{currentLanguageNameField()}}">{{\'student.foreignstudy.country\' | translate}}</th> <th md-column md-order-by="3">{{\'student.foreignstudy.startDate\' | translate}}</th> <th md-column md-order-by="4">{{\'student.foreignstudy.endDate\' | translate}}</th> <th md-column md-order-by="purpose.{{currentLanguageNameField()}}">{{\'student.foreignstudy.purpose\' | translate}}</th> <th md-column md-order-by="programme.{{currentLanguageNameField()}}">{{\'student.foreignstudy.programme\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in foreignstudies.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{::row.school}}</td> <td md-cell> <hois-classifier-value ng-model="row.country" main-classifier-code="RIIK"></hois-classifier-value> </td> <td md-cell>{{::row.startDate | hoisDate}}</td> <td md-cell>{{::row.endDate | hoisDate}}</td> <td md-cell> <hois-classifier-value ng-model="row.abroadPurpose" main-classifier-code="VALISOPE_EESMARK"></hois-classifier-value> </td> <td md-cell> <hois-classifier-value ng-model="row.abroadProgramme" main-classifier-code="VALISKOOL_PROGRAMM"></hois-classifier-value> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination ng-show="foreignstudies.totalElements > foreignstudiesCriteria.size" md-limit="foreignstudiesCriteria.size" md-limit-options="[5, 10, 15]" md-page="foreignstudiesCriteria.page" md-total="{{foreignstudies.totalElements}}" md-on-paginate="loadForeignstudies" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </hois-collapsable> </div> <md-button ng-href="#/students/{{student.id}}/edit" ng-if="student.userCanEditStudent" class="md-primary md-raised">{{\'main.button.change\' | translate}}</md-button> <md-button ng-click="updatePersonData() && student.person.idcode" ng-if="student.userCanUpdateRR" class="md-raised">{{\'rr.operations.updateStudentData.button\' | translate}}</md-button> <md-button ng-if="!auth.isStudent() && !auth.isParent()" ng-click="back(\'#/students\')" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </div> </div>'),a.put("student/view.remarks.html",'<div ng-cloak> <div ng-if="student && student.isVocational===true" ng-include="\'student/templates/view.navbar.vocational.tmpl.html\'"></div> </div> <div layout-padding ng-cloak> <div flex> <div layout="row" layout-xs="column" flex class="form-readonly"> <div layout="row" layout-sm="column" layout-xs="column" flex> <md-input-container flex> <label>{{\'student.label\' | translate}}</label> <hois-value value="student.person.firstname + \' \' + student.person.lastname"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'student.idcode\' | translate}}</label> <hois-value value="student.person.idcode"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column" flex> <md-input-container flex> <label>{{\'student.studyForm\' | translate}}</label> <hois-classifier-value ng-model="student.studyForm" main-classifier-code="OPPEVORM"></hois-classifier-value> </md-input-container> <md-input-container flex> <label>{{\'student.curriculum\' | translate}}</label> <hois-value value="currentLanguageNameField(student.curriculumVersion)"></hois-value> </md-input-container> </div> </div> <md-table-container> <table md-table md-progress="tabledata.$promise" class="secondary-table"> <thead md-head md-order="remarksCriteria.order" md-on-reorder="loadRemarks"> <tr md-row> <th md-column width="20%">{{\'student.remark.reason\' | translate}} / {{\'student.remark.journal\' | translate}}</th> <th md-column width="40%">{{\'student.remark.label\' | translate}}</th> <th md-column></th> <th md-column md-order-by="remark_time">{{\'student.remark.date\' | translate}}</th> <th md-column md-order-by="remark_inserted_by">{{\'student.remark.addedBy\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell> <span ng-if="row.reason">{{currentLanguageNameField(row.reason)}}</span> <a ng-if="row.journal && (auth.isStudent() || auth.isParent())" ng-href="#/students/journals/{{::row.journal.id}}">{{currentLanguageNameField(row.journal)}}</a> <a ng-if="row.journal && (auth.isAdmin() || auth.isTeacher())" ng-href="#/journal/{{::row.journal.id}}/view">{{currentLanguageNameField(row.journal)}}</a> </td> <td md-cell> <span>{{row.remark | hoisLimitTo: 150:!row.showAll}}</span> </td> <td md-cell> <span class="custom-tooltip" ng-if="!row.showAll && row.remark.length > 150" ng-click="row.showAll = true">{{\'student.remark.showMore\' | translate}}</span> <span class="custom-tooltip" ng-if="row.showAll" ng-click="row.showAll = false">{{\'student.remark.showLess\' | translate}}</span> </td> <td md-cell>{{row.remarkDate | hoisDate}}</td> <td md-cell>{{row.remarkInsertedBy}}</td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="remarksCriteria.size" md-limit-options="[10, 20, 50]" md-page="remarksCriteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadRemarks" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> <md-button ng-if="!auth.isStudent() && !auth.isParent()" ng-click="back(\'#/students\')" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </div> </div>'),a.put("student/view.results.html",'<div ng-cloak> <div> <div ng-if="student && student.isVocational===true" ng-include="\'student/templates/view.navbar.vocational.tmpl.html\'"></div> <div ng-if="student && student.isVocational===false" ng-include="\'student/templates/view.navbar.higher.tmpl.html\'"></div> </div> <div> <div ng-if="student && student.isVocational===true" ng-include="\'student/templates/view.results.vocational.tmpl.html\'"></div> <div ng-if="student && student.isVocational===false" ng-include="\'student/templates/view.results.higher.tmpl.html\'"></div> </div> <div layout="row" layout-margin> <md-button ng-if="!auth.isStudent() && !auth.isParent()" ng-click="back(\'#/students\')" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </div> </div>'),a.put("student/view.rr.html",'<div ng-cloak> <div ng-if="student && student.isVocational===true" ng-include="\'student/templates/view.navbar.vocational.tmpl.html\'"></div> <div ng-if="student && student.isVocational===false" ng-include="\'student/templates/view.navbar.higher.tmpl.html\'"></div> </div> <div layout-padding ng-cloak> <div flex> <div layout="row" layout-xs="column" flex class="form-readonly"> <div layout="row" layout-sm="column" layout-xs="column" flex> <md-input-container flex> <label>{{\'student.label\' | translate}}</label> <hois-value value="student.person.firstname + \' \' + student.person.lastname"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'student.idcode\' | translate}}</label> <hois-value value="student.person.idcode"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column" flex> <md-input-container flex> <label>{{\'student.studyForm\' | translate}}</label> <hois-classifier-value ng-model="student.studyForm" main-classifier-code="OPPEVORM"></hois-classifier-value> </md-input-container> <md-input-container flex> <label>{{\'student.curriculum\' | translate}}</label> <hois-value value="currentLanguageNameField(student.curriculumVersion)"></hois-value> </md-input-container> </div> </div> <md-table-container> <table md-table md-progress="tabledata.$promise" class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'rr.student.oldName\' | translate}}</th> <th md-column>{{\'rr.student.newName\' | translate}}</th> <th md-column>{{\'rr.student.oldAddress\' | translate}}</th> <th md-column>{{\'rr.student.newAddress\' | translate}}</th> <th md-column>{{\'rr.student.changed\' | translate}}</th> <th md-column>{{\'rr.student.changedBy\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{::row.oldName}}</td> <td md-cell>{{::row.newName}}</td> <td md-cell>{{::row.oldAddress}}</td> <td md-cell>{{::row.newAddress}}</td> <td md-cell>{{::row.changed | hoisDateTime}}</td> <td md-cell>{{::row.changedBy}}</td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> <md-button ng-if="!auth.isStudent() && !auth.isParent()" ng-click="back(\'#/students\')" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </div> </div> <style>md-tooltip {\r\n    height: auto !important;\r\n  }\r\n\r\n  md-tooltip p {\r\n    white-space: normal;\r\n  }\r\n\r\n  @media only screen and (max-width: 649px) {\r\n    md-tooltip p {\r\n      max-width: 90vw;\r\n    }\r\n  }\r\n\r\n  @media only screen and (min-width: 650px) {\r\n    md-tooltip p {\r\n      /* Give at least 10 px free space */\r\n      max-width: 640px;\r\n    }\r\n  }</style>'),a.put("student/view.supportservice.html",'<div ng-cloak> <div ng-if="student && student.isVocational===true" ng-include="\'student/templates/view.navbar.vocational.tmpl.html\'"></div> <div ng-if="student && student.isVocational===false" ng-include="\'student/templates/view.navbar.higher.tmpl.html\'"></div> </div> <div layout-padding ng-cloak> <div flex> <div layout="row" layout-xs="column" flex class="form-readonly"> <div layout="row" layout-sm="column" layout-xs="column" flex> <md-input-container flex> <label>{{\'student.label\' | translate}}</label> <hois-value value="student.person.firstname + \' \' + student.person.lastname"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'student.idcode\' | translate}}</label> <hois-value value="student.person.idcode"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column" flex> <md-input-container flex> <label>{{\'student.studyForm\' | translate}}</label> <hois-classifier-value ng-model="student.studyForm" main-classifier-code="OPPEVORM"></hois-classifier-value> </md-input-container> <md-input-container flex> <label>{{\'student.curriculum\' | translate}}</label> <hois-value value="currentLanguageNameField(student.curriculumVersion)"></hois-value> </md-input-container> </div> </div> <hois-collapsable label="(\'student.supportService.label\' | translate)"> <md-table-container> <table md-table md-progress="supportServices.$promise" class="secondary-table"> <thead md-head md-order="supportServicesCriteria.order" md-on-reorder="loadSupportServices"> <tr md-row> <th md-column ng-if="auth.isAdmin() && isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_TUGITEENUS\') && student.id && [\'OPPURSTAATUS_K\', \'OPPURSTAATUS_L\'].indexOf(student.status) === -1"></th> <th md-column>{{\'student.supportService.order\' | translate}}</th> <th md-column md-order-by="entry_date">{{\'student.supportService.entryDate\' | translate}}</th> <th md-column>{{\'student.supportService.title\' | translate}}</th> <th md-column style="min-width: 300px">{{\'student.supportService.content\' | translate}}</th> <th md-column md-order-by="validity_code">{{\'student.supportService.validity\' | translate}}</th> <th md-column md-order-by="is_public">{{\'student.supportService.public\' | translate}}</th> <th md-column>{{\'student.supportService.file\' | translate}}</th> <th md-column md-order-by="submitter">{{\'student.supportService.entrySubmitter\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in supportServices.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell ng-if="auth.isAdmin() && isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_TUGITEENUS\') && student.id && [\'OPPURSTAATUS_K\', \'OPPURSTAATUS_L\'].indexOf(student.status) === -1"> <a href="#" onclick="return false" ng-click="editService(row)" ng-if="!row.isArtificial">{{\'journal.entry.open\' | translate}}</a> </td> <td md-cell>{{$index + 1}}</td> <td md-cell>{{::row.entryDate | hoisDate}}</td> <td md-cell>{{::(row.nameEt ? row.nameEt : (\'student.supportService.directive\' | translate))}}</td> <td md-cell ng-if="isArray(row.content)" style="padding-bottom: 4px"> <ul style="padding-left: 1.5em"> <li ng-repeat="ss in row.content" style="margin-bottom: 0.25em"> <hois-classifier-value ng-model="ss" main-classifier-code="TUGITEENUS"></hois-classifier-value> </li> </ul> <div style="float: right" layout="column"> <a style="text-align: right" href="#/directives/{{row.id}}/view">{{\'student.supportService.viewDirective\' | translate}}</a> <a ng-if="row.endingDirectiveId" style="text-align: right" href="#/directives/{{row.endingDirectiveId}}/view"> {{\'student.supportService.viewDirectiveEnd\' | translate}}</a> </div> </td> <td md-cell ng-if="!isArray(row.content)"> <hois-value value="row.content | hoisLimitTo: 200:!row.showAll"></hois-value> <a style="float: right" ng-if="!row.showAll && row.content.length > 200" ng-click="row.showAll = true">{{\'student.supportService.showMore\' | translate}}</a> <a style="float: right" ng-if="row.showAll" ng-click="row.showAll = false">{{\'student.supportService.showLess\' | translate}}</a> </td> <td md-cell> <hois-classifier-value ng-model="row.validity" main-classifier-code="TUGIKEHTIV"></hois-classifier-value> </td> <td md-cell>{{::((row.isPublic ? \'main.yes\' : \'main.no\') | translate)}}</td> <td md-cell> {{row.file.fname}} <a ng-if="row.file" ng-href="{{getUrl(row.file, \'supportservice\')}}" download target="_blank" rel="noopener noreferrer"> <md-icon md-font-set="material-icons">file_download</md-icon> </a> </td> <td md-cell>{{::row.entrySubmitter}}</td> </tr> </tbody> </table> </md-table-container> <md-table-pagination ng-show="supportServices.totalElements > supportServicesCriteria.size" md-limit="supportServicesCriteria.size" md-limit-options="[5, 10, 20, 50]" md-page="supportServicesCriteria.page" md-total="{{supportServices.totalElements}}" md-on-paginate="loadSupportServices" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> <md-button ng-if="auth.isAdmin() && isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_TUGITEENUS\') && student.id && [\'OPPURSTAATUS_K\', \'OPPURSTAATUS_L\'].indexOf(student.status) === -1" ng-click="editService()" class="md-primary md-raised">{{\'student.supportService.operation.addService.label\' | translate}}</md-button> <md-button ng-if="student.userCanViewPrivateStudentSupportServices && supportServices.totalElements > 0" ng-click="printServices()" class="md-raised">{{\'student.supportService.operation.printServices.label\' | translate}}</md-button> </hois-collapsable> <hois-collapsable label="(\'student.supportService.ehis\' | translate)" ng-if="false"> </hois-collapsable> <md-button ng-if="!auth.isStudent() && !auth.isParent()" ng-click="back(\'#/students\')" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </div> </div> <style>table.secondary-table th md-icon > svg {\r\n    fill: grey !important;\r\n  }\r\n  \r\n  table.secondary-table th,\r\n  table.secondary-table td {\r\n    padding-right: 28px !important;\r\n  }</style>'),
a.put("student/view.timetable.html",'<div ng-cloak> <div ng-if="student && student.isVocational===true" ng-include="\'student/templates/view.navbar.vocational.tmpl.html\'"></div> <div ng-if="student && student.isVocational===false" ng-include="\'student/templates/view.navbar.higher.tmpl.html\'"></div> </div> <div layout-padding ng-cloak> <div flex> <div layout="row" layout-xs="column" flex class="form-readonly"> <div layout="row" layout-sm="column" layout-xs="column" flex> <md-input-container flex> <label>{{\'student.label\' | translate}}</label> <hois-value value="student.person.firstname + \' \' + student.person.lastname"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'student.idcode\' | translate}}</label> <hois-value value="student.person.idcode"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column" flex> <md-input-container flex> <label>{{\'student.studyForm\' | translate}}</label> <hois-classifier-value ng-model="student.studyForm" main-classifier-code="OPPEVORM"></hois-classifier-value> </md-input-container> <md-input-container flex> <label>{{\'student.curriculum\' | translate}}</label> <hois-value value="currentLanguageNameField(student.curriculumVersion)"></hois-value> </md-input-container> </div> </div> <div layout="row" layout-sm="column" layout-xs="column"> <div layout="column" class="form-readonly" flex="50" flex-sm="100" flex-offset="50" flex-offset-xs="0" flex-offset-sm="0"> <div>&nbsp;</div> <md-input-container> <label class="textInput">{{\'timetable.search.studyYear\' | translate}}</label> <div class="md-body-1 hois-value"> <span ng-repeat="sy in studyYears | orderBy: \'startDate\'"> <a ng-click="changeStudyYear(sy)" ng-style="{\'font-weight\': criteria.studyYearId === sy.id ? \'bold\' : \'normal\'}"> {{currentLanguageNameField(sy)}}</a> <span>&nbsp;</span> </span> </div> </md-input-container> </div> </div> <div ng-controller="TimetableWeekViewController"> <div ng-include="\'timetable/generalTimetable/timetable.week.view.html\'"></div> </div> <md-button ng-if="!auth.isStudent() && !auth.isParent()" ng-click="back(\'#/students\')" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </div> </div>'),a.put("studentAbsence/absence.accept.by.lessons.dialog.html",'<md-dialog aria-label="absence accept by lessons dialog" flex="50" flex-xs="100"> <form name="dialogForm" ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2>{{currentLanguageNameField(absence.student)}}, {{absence.studentGroup}}</h2> <span flex></span> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <div class="md-dialog-content"> <div layout="column" class="form-readonly"> <md-input-container class="label-only" flex> <label>{{\'absence.cause\' | translate}}</label> <hois-value value="absence.cause"></hois-value> </md-input-container> <md-input-container class="label-only" flex> <label>{{\'absence.period\' | translate}}</label> <hois-value ng-if="!absence.validThru" value="(absence.validFrom | hoisDate)"></hois-value> <hois-value ng-if="absence.validThru" value="(absence.validFrom | hoisDate) + \'-\' + (absence.validThru | hoisDate)"></hois-value> </md-input-container> </div> <div layout="column" ng-show="canEdit"> <md-input-container flex> <label>{{\'absence.maxLessonNr\' | translate}}</label> <hois-select ng-model="maxLessonNr" values="lessons" required></hois-select> </md-input-container> <md-input-container> <md-checkbox ng-model="showWeekends" aria-label="{{\'absence.showWeekends\' | translate}}" ng-change="showWeekendsChanged()"> {{\'absence.showWeekends\' | translate}} </md-checkbox> </md-input-container> </div> <md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column></th> <th md-column ng-repeat="lesson in [].constructor(maxLessonNr) track by $index">{{$index + 1}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="date in dates | orderBy" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{date | hoisDate}}</td> <td md-cell ng-repeat="lesson in [].constructor(maxLessonNr) track by $index"> <md-input-container> <md-checkbox ng-model="lessonsByDate[date][$index + 1]" aria-label="lesson" ng-change="lessonByDate()" ng-disabled="!canEdit"></md-checkbox> </md-input-container> </td> </tr> </tbody> </table> </md-table-container> </div> </md-dialog-content> <span flex></span> <md-dialog-actions layout="row" layout-sm="column" layout-xs="column" layout-align="start center"> <md-button ng-if="canEdit" class="md-raised md-primary" ng-disabled="!lessonsToAccept" ng-click="submit()">{{\'absence.acceptLessons\' | translate}}</md-button> <md-button class="md-raised" ng-click="cancel()">{{\'main.button.close\' | translate}}</md-button> </md-dialog-actions> </form> </md-dialog>'),a.put("studentAbsence/absence.group.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <form name="studentGroupAbsenceForm" novalidate> <div layout="row"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'groupAbsence.studyYear\' | translate}}</label> <hois-select ng-model="criteria.studyYear" values="formState.studyYears" ng-change="studyYearChanged(true)" ng-disabled="criteria.todaysAbsences" ng-required="!criteria.todaysAbsences"></hois-select> </md-input-container> <div ng-if="auth.isAdmin()" flex="50" flex-offset="5" flex-sm="100" flex-xs="100"> <hois-autocomplete flex ng-model="criteria.studentGroup" ha-attribute="id" ha-controller="directiveControllers" method="studentgroups" name="studentGroup" label="{{\'groupAbsence.studentGroup\'}}" additional-query-params="{higher: false}" ng-required="!criteria.todaysAbsences"></hois-autocomplete> </div> <md-input-container ng-if="auth.isTeacher()" flex="50" flex-offset="5" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'groupAbsence.studentGroup\' | translate}}</label> <md-select ng-model="criteria.studentGroup" ng-required="!criteria.todaysAbsences"> <md-option ng-if="criteria.todaysAbsences" md-option-empty></md-option> <md-option ng-value="studentGroup.id" ng-repeat="studentGroup in formState.studentGroups | orderBy: currentLanguageNameField()"> {{currentLanguageNameField(studentGroup)}} </md-option> </md-select> </md-input-container> </div> <div layout="row"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'groupAbsence.studyWeek\' | translate}}</label> <md-select ng-model="criteria.studyWeek" ng-change="studyWeekChanged()" ng-disabled="criteria.todaysAbsences" ng-required="!criteria.todaysAbsences"> <md-option ng-value="week" ng-repeat="week in formState.studyWeeks | orderBy: \'nr\' track by $index"> {{week.start | hoisDate}}-{{week.end | hoisDate}} </md-option> </md-select> </md-input-container> <md-input-container class="md-block" flex="50" flex-offset="5" flex-sm="100" flex-xs="100"> <md-checkbox ng-model="criteria.todaysAbsences" aria-label="{{\'groupAbsence.todaysAbsences\' | translate}}"> {{\'groupAbsence.todaysAbsences\' | translate}} </md-checkbox> </md-input-container> </div> <div layout="row"> <md-button class="md-raised md-primary" ng-click="search()">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> </div> <div flex-xs="0" flex-gt-xs="0" flex-gt-sm="50"></div> </form> </fieldset> </div> <span ng-if="content.students.length > 0"> <div>&nbsp;</div> <div flex="100" layout="row" layout-align="end start" class="common-label" md-colors="{color: \'background-400\'}"> <span ng-repeat="a in formState.absenceOptions"> <span ng-if="!$first">|</span> {{::a.value.toUpperCase()}} - {{currentLanguageNameField(a)}} </span> </div> </span> <div flex ng-if="content.students.length > 0"> <div class="container" fixed-column-table fixed-columns="1" resize-table search-criteria-height="300"> <table class="tertiary-table student-group-absence-table"> <thead> <tr> <th width="15%"></th> <th ng-if="journalsByDateCount(date) > 0" ng-repeat="date in content.dates" colspan="{{journalsByDateCount(date)}}">{{date | hoisDate}}</th> </tr> <tr> <th>{{\'groupAbsence.student\' | translate}}</th> <th ng-repeat="journal in journals" class="fix"> <a ng-if="journal.id" ng-href="#/journal/{{journal.id}}/view" class="md-primary change-button">{{currentLanguageNameField(journal)}}</a> </th> </tr> </thead> <tbody> <tr ng-repeat="student in content.students" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td>{{student.nameEt}}</td> <td ng-repeat="journal in journals"> <div layout="row" layout-sm="column" layout-xs="column" layout-align="center center"> <div ng-repeat="absence in studentAbsences[student.id][journal.id][journal.date]" style="margin-right: 10px"> <div ng-if="absence.length === 1 && !absence[0].lessonNr"> <md-input-container> <hois-select ng-model="absence[0].absence" values="formState.absenceOptions" aria-label="absence" model-value-attr="code" show-property="value" value-property="code" ng-change="absenceChanged(absence[0])" required></hois-select> </md-input-container> </div> <div ng-if="absence.length > 1 || absence[0].lessonNr"> <div layout="column" ng-repeat="lessonAbsence in absence | orderBy: \'lessonNr\'"> <div layout="row"> <div style="line-height: 48px">{{lessonAbsence.lessonNr}}</div> <md-input-container> <hois-select ng-model="lessonAbsence.absence" values="formState.absenceOptions" aria-label="absence" model-value-attr="code" show-property="value" value-property="code" ng-change="lessonAbsenceChanged(lessonAbsence)" required></hois-select> </md-input-container> </div> </div> </div> </div> </div> </td> </tr> </tbody> </table> </div> </div> </div>'),a.put("studentAbsence/absence.reject.dialog.html",'<md-dialog aria-label="reject dialog" flex="60" flex-xs="100"> <form name="dialogForm" ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2>{{currentLanguageNameField(absence.student)}}, {{absence.validFrom | hoisDate}} - {{absence.validThru | hoisDate}}</h2> <span flex></span> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <div class="ois-form-layout-padding nomargin" layout="column" ng-cloak> <p>{{\'absence.dialog.reject.message\' | translate}}</p> <md-input-container flex> <label>{{\'absence.dialog.reject.info\' | translate}}</label> <textarea ng-model="rejectReason" md-maxlength="4000" max-rows="10" rows="2"></textarea> </md-input-container> </div> </md-dialog-content> <span flex></span> <md-dialog-actions layout="row" layout-align="start center"> <md-button class="md-raised md-primary" ng-click="rejectAbsence()">{{"absence.dialog.reject.yes" | translate}}</md-button> <md-button class="md-raised" ng-click="cancel()">{{"main.no" | translate}}</md-button> </md-dialog-actions> </form> </md-dialog>'),a.put("studentAbsence/absence.search.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div layout="column"> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <form name="absencesSearchForm" ng-submit="loadData()" novalidate class="nomargin"> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label>{{\'absence.studyYear\' | translate}}</label> <hois-select ng-model="criteria.studyYear" ng-change="studyYearChanged()" values="studyYears" sorted-query="true" required></hois-select> </md-input-container> <md-input-container flex flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'absence.studyPeriod\' | translate}}</label> <md-select ng-model="criteria.studyPeriod"> <md-option ng-value="null"></md-option> <md-option ng-repeat="studyPeriod in studyPeriods | filter: filterByStudyYear(criteria.studyYear)" ng-value="studyPeriod.id"> {{ currentLanguageNameField(studyPeriod) }} </md-option> </md-select> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label>{{\'absence.curriculumVersion\' | translate}}</label> <hois-select ng-model="criteria.curriculumVersions" type="curriculumversion" multiple></hois-select> </md-input-container> <hois-autocomplete flex flex-offset="5" flex-offset-xs="0" flex-offset-sm="0" ng-model="criteria.studentGroupId" ha-attribute="id" ha-controller="directiveControllers" method="studentgroups" name="studentGroup" label="{{\'absence.studentGroup\'}}"></hois-autocomplete> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label>{{\'absence.student\' | translate}}</label> <input ng-model="criteria.studentName" type="text" md-maxlength="255"> </md-input-container> <md-input-container flex flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'absence.status\' | translate}}</label> <md-select ng-model="criteria.status" ng-change="statusChanged()"> <md-option ng-value="null"></md-option> <md-option ng-value="\'accepted\'">{{ \'absence.isAccepted\' | translate }}</md-option> <md-option ng-value="\'isNotAccepted\'">{{ \'absence.isNotAccepted\' | translate }}</md-option> <md-option ng-value="\'rejected\'">{{ \'absence.isRejected\' | translate }}</md-option> </md-select> </md-input-container> </div> <div layout="row" layout-sm="row" layout-xs="column"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> </div> </form> </fieldset> <md-table-container ng-cloak layout-padding> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="p.lastname,p.firstname">{{\'absence.student\' | translate}}</th> <th md-column md-order-by="sa.valid_from">{{\'absence.absenceFrom\' | translate}}</th> <th md-column md-order-by="sa.valid_thru">{{\'absence.absenceThru\' | translate}}</th> <th md-column md-order-by="sa.cause">{{\'absence.absenceCause\' | translate}}</th> <th md-column md-order-by="sa.inserted_by">{{\'absence.applicant\' | translate}}</th> <th md-column md-order-by="sa.is_accepted, sa.is_rejected">{{\'absence.status\' | translate}}</th> <th md-column>{{\'absence.absenceAcceptor\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell class="one-row"> <a ng-href="#/students/{{row.student.id}}/main">{{currentLanguageNameField(row.student)}}</a> </td> <td md-cell>{{row.validFrom | hoisDate}}</td> <td md-cell>{{row.validThru | hoisDate}}</td> <td md-cell>{{::row.cause}}</td> <td md-cell>{{::row.applicant}}</td> <td md-cell> <span ng-if="row.isAccepted">{{\'absence.isAccepted\' | translate}}</span> <span ng-if="row.isRejected"> {{\'absence.isRejected\' | translate}} <span ng-if="row.rejectReason"> <md-tooltip md-direction="bottom"><p>{{row.rejectReason}}</p></md-tooltip> <md-icon md-font-set="material-icons" ng-if="row.rejectReason">message</md-icon> </span> </span> <span ng-if="!row.isAccepted && !row.isRejected">{{\'absence.isNotAccepted\' | translate}}</span> </td> <td md-cell>{{row.acceptor}}</td> <td md-cell> <md-button ng-if="row.canAccept" md-no-ink class="md-primary change-button" ng-click="accept(row)">{{\'absence.accept\' | translate}}</md-button> <md-button ng-if="row.canAccept" md-no-ink class="md-primary change-button" ng-click="acceptByLessons(row)">{{\'absence.acceptByLessons\' | translate}}</md-button> <md-button ng-if="row.isAccepted && row.isLessonAbsence" md-no-ink class="md-primary change-button" ng-click="viewAcceptedLessons(row)">{{\'absence.viewAcceptedLessons\' | translate}}</md-button> <md-button ng-if="row.canReject" md-no-ink class="md-primary change-button" ng-click="openRejectDialog(row)">{{\'absence.reject\' | translate}}</md-button> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\' }" md-page-select></md-table-pagination> </div> </div> <style>md-tooltip {\r\n    height: auto !important;\r\n  }\r\n\r\n  md-tooltip p {\r\n    white-space: normal;\r\n  }\r\n\r\n  @media only screen and (max-width: 649px) {\r\n    md-tooltip p {\r\n      max-width: 90vw;\r\n    }\r\n  }\r\n\r\n  @media only screen and (min-width: 650px) {\r\n    md-tooltip p {\r\n      /* Give at least 10 px free space */\r\n      max-width: 640px;\r\n    }\r\n  }</style>'),a.put("studentCard/student.card.management.html",'<div ng-include="\'studentCard/student.card.navbar.tmpl.html\'"></div> <div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <form name="searchForm" ng-submit="searchForm.$valid && loadData()" novalidate ng-model-options="{ allowInvalid: true }"> <fieldset tabindex="1"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <div layout="row" layout-sm="column" layout-xs="column"> <hois-autocomplete flex="45" flex-sm="100" flex-xs="100" ng-model="criteria.studentGroup" ha-controller="directiveControllers" method="studentgroups" name="studentGroup" label="{{\'student.studentGroup\'}}" additional-query-params="{valid: true}"></hois-autocomplete> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'student.name\' | translate}}</label> <input ng-model="criteria.name" name="name" type="text" md-maxlength="255" autofocus> </md-input-container> <md-input-container flex="50" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label class="textInput">{{\'student.idcode\' | translate}}</label> <input ng-model="criteria.idcode" name="idcode" type="text" minlength="11" md-maxlength="11"> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'student.card.nr\' | translate}}</label> <input ng-model="criteria.cardNr" name="cardNr" type="text" md-maxlength="50"> </md-input-container> <md-input-container flex="50" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'student.card.status\' | translate}}</label> <hois-classifier-select multiple ng-model="criteria.status" main-classifier-code="OPILASPILET_STAATUS" model-value-attr="code"></hois-classifier-select> </md-input-container> </div> <div layout="row" flex> <md-input-container class="md-block"> <md-checkbox ng-model="criteria.notActiveStudents" name="notActiveStudents"> {{\'student.card.showNotActiveStudents\' | translate}}</md-checkbox> </md-input-container> </div> <div layout="row"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> </div> </fieldset> </form> </div> </div> <div layout-padding ng-cloak> <div flex> <md-table-container> <form name="cards" novalidate> <table md-table md-progress="tabledata.$promise" ng-model="selectedStudents" ng-model-options="{ allowInvalid: true }"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="p.lastname, p.firstname">{{\'student.name\' | translate}}</th> <th md-column md-order-by="sg.code">{{\'student.studentGroup\' | translate}}</th> <th md-column md-order-by="s.is_student_card_repetitive">{{\'student.card.repeating\' | translate}}</th> <th md-column md-order-by="s.student_card">{{\'student.card.nr\' | translate}}</th> <th md-column md-order-by="s.student_card_valid_thru">{{\'student.card.validThru\' | translate}}</th> <th md-column>{{\'student.card.given\' | translate}}</th> <th md-column md-order-by="s.student_card_given_dt">{{\'student.card.givenDate\' | translate}}</th> <th md-column>{{\'student.card.returned\' | translate}}</th> <th md-column md-order-by="s.student_card_returned_dt">{{\'student.card.returnDate\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row md-select="row.studentId" ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell><a ng-href="#/students/{{::row.studentId}}/main">{{::row.fullname}}</a></td> <td md-cell>{{currentLanguageNameField(row.studentGroup)}}</td> <td md-cell>{{row.isStudentCardRepetitive ? (\'main.yes\' | translate) : (\'main.no\' | translate)}}</td> <td md-cell> <md-input-container> <input ng-model="row.cardNr" type="text" aria-label="{{\'student.card.nr\' | translate}}" ng-change="row.dirty = true" md-maxlength="50"> </md-input-container> </td> <td md-cell> <md-input-container> <md-datepicker ng-model="row.validThru" aria-label="{{\'student.card.validThru\' | translate}}" ng-change="row.dirty = true"></md-datepicker> </md-input-container> </td> <td md-cell> <md-checkbox ng-model="row.given" aria-label="{{\'student.card.given\' | translate}}" ng-disabled="row.returned" ng-change="row.dirty = true"></md-checkbox> </td> <td md-cell> <md-input-container> <md-datepicker ng-model="row.givenDate" aria-label="{{\'student.card.givenDate\' | translate}}" ng-disabled="!row.given" ng-change="row.dirty = true"></md-datepicker> </md-input-container> </td> <td md-cell> <md-checkbox ng-model="row.returned" aria-label="{{\'student.card.returned\' | translate}}" ng-change="row.dirty = true && (row.given = false)"></md-checkbox> </td> <td md-cell> <md-input-container> <md-datepicker ng-model="row.returnedDate" aria-label="{{\'student.card.returnDate\' | translate}}" ng-disabled="!row.returned" ng-change="row.dirty = true"></md-datepicker> </md-input-container> </td> </tr> </tbody> </table> </form> </md-table-container> <md-table-toolbar class="md-default"> <div class="md-toolbar-tools"> <md-button ng-click="save()" class="md-primary md-raised">{{\'main.button.save\' | translate}}</md-button> </div> </md-table-toolbar> <md-table-pagination md-limit="criteria.size" md-limit-options="[20, 50, 100]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="changePage" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> </div> <style>td md-input-container {\r\n    height: 24px !important;\r\n  }\r\n  td md-input-container input {\r\n    height: 24px !important;\r\n    padding-top: 2px !important;\r\n  }</style>'),a.put("studentCard/student.card.navbar.tmpl.html",'<md-nav-bar md-selected-nav-item="currentNavItem" aria-label="{{\'main.nagivationBar\' | translate}}"> <md-nav-item md-nav-href="#/studentCards?_menu" name="student.card.search" aria-label="{{\'student.card.search\' | translate}}">{{\'student.card.search\' | translate}}</md-nav-item> <md-nav-item md-nav-href="#/studentCards/studentCardManagement?_menu" ng-if="canEdit" name="student.card.management" aria-label="{{\'student.card.management\' | translate}}">{{\'student.card.management\' | translate}}</md-nav-item> </md-nav-bar>'),a.put("studentCard/student.card.search.html",'<div ng-include="\'studentCard/student.card.navbar.tmpl.html\'"></div> <div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <form name="searchForm" ng-submit="searchForm.$valid && loadData()" novalidate ng-model-options="{ allowInvalid: true }"> <fieldset tabindex="1"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <div layout="row" layout-sm="column" layout-xs="column"> <hois-autocomplete flex="45" flex-sm="100" flex-xs="100" ng-model="criteria.studentGroup" ha-controller="directiveControllers" method="studentgroups" name="studentGroup" label="{{\'student.studentGroup\'}}" additional-query-params="{valid: true}"></hois-autocomplete> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'student.name\' | translate}}</label> <input ng-model="criteria.name" name="name" type="text" md-maxlength="255" autofocus> </md-input-container> <md-input-container flex="50" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label class="textInput">{{\'student.idcode\' | translate}}</label> <input ng-model="criteria.idcode" name="idcode" type="text" minlength="11" md-maxlength="11"> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'student.card.nr\' | translate}}</label> <input ng-model="criteria.cardNr" name="cardNr" type="text" md-maxlength="50"> </md-input-container> <md-input-container flex="50" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'student.card.status\' | translate}}</label> <hois-classifier-select multiple ng-model="criteria.status" main-classifier-code="OPILASPILET_STAATUS" model-value-attr="code"></hois-classifier-select> </md-input-container> </div> <div layout="row" flex> <md-input-container class="md-block"> <md-checkbox ng-model="criteria.notActiveStudents" name="notActiveStudents"> {{\'student.card.showNotActiveStudents\' | translate}}</md-checkbox> </md-input-container> </div> <div layout="row"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> <md-button class="md-raised" ng-if="canEdit" ng-href="{{orderUrl(\'order\')}}" target="_blank">{{\'student.card.order\' | translate}}</md-button> <md-button class="md-raised" ng-if="canEdit" ng-href="{{orderUrl(\'orderAgain\')}}" target="_blank">{{\'student.card.orderAgain\' | translate}}</md-button> <md-button class="md-raised" ng-if="canEdit" ng-href="{{orderUrl(\'orderExtension\')}}" target="_blank">{{\'student.card.orderExtension\' | translate}}</md-button> <md-button class="md-raised" ng-href="{{excelUrl()}}" target="_blank">{{\'main.button.printXls\' | translate}}</md-button> </div> </fieldset> </form> </div> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise" ng-model="selectedStudents"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="p.lastname, p.firstname">{{\'student.name\' | translate}}</th> <th md-column md-order-by="sg.code">{{\'student.studentGroup\' | translate}}</th> <th md-column md-order-by="case when s.ois_file_id is not null then false else true">{{\'student.card.pictureExists\' | translate}}</th> <th md-column md-order-by="s.student_card">{{\'student.card.nr\' | translate}}</th> <th md-column md-order-by="s.student_card_status_code">{{\'student.card.status\' | translate}}</th> <th md-column md-order-by="s.student_card_valid_thru">{{\'student.card.validThru\' | translate}}</th> <th md-column md-order-by="s.student_card_given_dt">{{\'student.card.givenDate\' | translate}}</th> <th md-column md-order-by="s.student_card_returned_dt">{{\'student.card.returnDate\' | translate}}</th> <th md-column md-order-by="s.is_student_card_repetitive">{{\'student.card.repeating\' | translate}}</th> <th></th> </tr> </thead> <tbody md-body> <tr md-row md-select="row.studentId" ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell><a ng-href="#/students/{{::row.studentId}}/main">{{::row.fullname}}</a></td> <td md-cell>{{currentLanguageNameField(row.studentGroup)}}</td> <td md-cell>{{row.pictureExists ? (\'main.yes\' | translate) : (\'main.no\' | translate)}}</td> <td md-cell>{{row.cardNr}}</td> <td md-cell>{{currentLanguageNameField(row.status)}}</td> <td md-cell>{{row.validThru | hoisDate}}</td> <td md-cell>{{row.givenDate | hoisDate}}</td> <td md-cell>{{row.returnedDate | hoisDate}}</td> <td md-cell>{{row.isStudentCardRepetitive ? (\'main.yes\' | translate) : (\'main.no\' | translate)}}</td> <td md-cell> <a ng-if="row.isStudentActive && canEdit" class="md-button md-primary" ng-click="orderRepetition(row)">{{\'student.card.operation.orderRepetition.label\' | translate}}</a> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> </div>'),a.put("studentGroup/student.group.edit.html",'<div layout="column" class="ois-form-layout-padding"> <div> <form name="studentGroupForm"> <div layout="column"> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label>{{\'studentGroup.code\' | translate}}</label> <input ng-model="record.code" name="code" type="text" required md-maxlength="50"> </md-input-container> <md-input-container flex="25" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label class="textInput">{{\'studentGroup.course\' | translate}}</label> <input ng-model="record.course" name="course" type="number" required min="1" ng-max="formState.studyPeriodInYears"> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label class="textInput">{{\'studentGroup.places\' | translate}}</label> <input ng-model="record.places" name="places" ng-readonly="formState.readonly" type="number" min="0"> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <div flex="45" flex-sm="100" flex-xs="100" ng-if="!formState.readonly"> <hois-autocomplete ng-model="record.curriculum" method="curriculums" name="curriculum" label="studentGroup.curriculumRequired" md-selected-item-change="curriculumChanged()" required></hois-autocomplete> </div> <md-input-container ng-if="formState.readonly" flex="45" flex-sm="100" flex-xs="100" class="readonly top-margin"> <label ng-if="record.id" class="textInput">{{\'studentGroup.curriculumRequired\' | translate}}</label> <hois-value value="currentLanguageNameField(record.curriculum)"></hois-value> </md-input-container> <md-input-container flex="50" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label class="textInput">{{formState.curriculumVersionLabel | translate}}</label> <hois-select ng-model="record.curriculumVersion" name="curriculumVersion" ng-disabled="formState.isVocational && formState.readonly" values="formState.curriculumVersions" ng-change="curriculumVersionChanged()" ng-required="formState.onlyvocational || formState.isVocational"></hois-select> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'studentGroup.studyForm\' | translate}}</label> <hois-classifier-select ng-model="record.studyForm" name="studyForm" ng-disabled="formState.readonly" main-classifier-code="OPPEVORM" show-only-values="formState.studyForms" model-value-attr="code" required></hois-classifier-select> </md-input-container> <md-input-container flex="25" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label class="textInput">{{\'studentGroup.language\' | translate}}</label> <hois-classifier-select ng-model="record.language" name="language" ng-disabled="formState.readonly" main-classifier-code="OPPEKEEL" show-only-values="formState.languages" model-value-attr="code" required></hois-classifier-select> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0" class="readonly top-margin"> <label>{{\'student.studyLevel\' | translate}}</label> <hois-classifier-value ng-model="formState.origStudyLevel" main-classifier-code="OPPEASTE"></hois-classifier-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column" ng-if="formState.onlyvocational || formState.isVocational"> <div flex="45" flex-sm="100" flex-xs="100"> <hois-autocomplete ng-model="record.teacher" method="teachers" name="teacher" label="studentGroup.teacher"></hois-autocomplete> </div> <md-input-container flex="50" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label class="textInput">{{\'studentGroup.speciality\' | translate}}</label> <!-- <hois-classifier-select ng-model="record.speciality" name="speciality" main-classifier-code="SPETSKUTSE" show-only-values="formState.specialities" model-value-attr="code"></hois-classifier-select> --> <md-select ng-model="record.speciality"> <md-option md-option-empty></md-option> <md-option ng-value="opt.code.code" ng-repeat="opt in formState.specialities | orderBy: [\'code.nameEt\', \'code.validFrom\', \'code.validThru\']"> {{opt.code | hoisValidDates}} </md-option> </md-select> </md-input-container> </div> <div layout="row"> <div flex="33"> <md-input-container flex> <label>{{\'main.validFrom\' | translate}}</label> <md-datepicker ng-model="record.validFrom" md-max-date="record.validThru"></md-datepicker> </md-input-container> <md-input-container flex> <label>{{\'main.validThru\' | translate}}</label> <md-datepicker ng-model="record.validThru" ng-change="validThruChanged()" md-min-date="record.validFrom"></md-datepicker> </md-input-container> </div> </div> </div> </form> <div>&nbsp;</div> <md-table-container ng-if="formState.students"> <table md-table md-row-select="!record.id" multiple ng-model="formState.selectedStudents"> <thead md-head md-order="formState.order"> <tr md-row> <th md-column>{{\'main.rowno\' | translate}}</th> <th md-column md-order-by="rowno">{{\'studentGroup.studentname\' | translate}}</th> <th md-column md-order-by="idcode">{{\'studentGroup.idcode\' | translate}}</th> <th md-column md-order-by="curriculumVersion.{{currentLanguageNameField()}}">{{formState.curriculumVersionLabel | translate}}</th> <th md-column md-order-by="status.{{currentLanguageNameField()}}">{{\'studentGroup.studentstatus\' | translate}}</th> <th></th> </tr> </thead> <tbody md-body> <tr md-row md-select="row" md-select-id="id" md-auto-select ng-repeat="row in formState.students | orderBy: formState.order" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{::row.rowno}}</td> <td md-cell> <a ng-disabled="!record.id" class="md-primary" ng-href="#/students/{{::row.id}}/main">{{::row.fullname}}</a> </td> <td md-cell>{{::row.idcode}}</td> <td md-cell>{{currentLanguageNameField(row.curriculumVersion)}}</td> <td md-cell>{{currentLanguageNameField(row.status)}}</td> <td md-cell> <a ng-if="record.id" md-no-ink class="remove" ng-click="removeStudent(row.id)">&times;</a> </td> </tr> </tbody> </table> </md-table-container> <md-button ng-click="update()" class="md-raised md-primary">{{\'main.button.save\' | translate}}</md-button> <md-button ng-click="delete()" ng-if="record.id && !(formState.students && formState.students.length > 0)" class="md-raised">{{\'main.button.delete\' | translate}}</md-button> <md-button ng-href="#/studentgroups" class="md-raised">{{\'main.button.back\' | translate}}</md-button> <md-button ng-click="addStudents()" ng-if="record.id && formState.canAddStudents" class="md-raised">{{\'studentGroup.addStudents\' | translate}}</md-button> </div> </div>'),
a.put("studentGroup/student.group.list.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <form name="searchForm" ng-submit="searchForm.$valid && loadData()" novalidate ng-model-options="{allowInvalid: true}"> <fieldset tabindex="1"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <div flex layout="column"> <md-input-container flex> <label class="textInput">{{\'studentGroup.code\' | translate}}</label> <input ng-model="criteria.name" name="name" type="text" md-maxlength="255" autofocus> </md-input-container> <div layout="row" flex> <div flex="45"> <hois-autocomplete ng-model="criteria.curriculum" ha-controller="directiveControllers" method="curriculums" name="curriculum" label="studentGroup.curriculum"></hois-autocomplete> </div> <md-input-container flex="50" flex-offset="5"> <label>{{formState.curriculumVersionLabel | translate}}</label> <hois-select ng-model="criteria.curriculumVersion" values="formState.curriculumVersions" name="curriculumVersion" ng-change="curriculumVersionChanged()" multiple></hois-select> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="45"> <label>{{\'studentGroup.studyForm\' | translate}}</label> <hois-select ng-model="criteria.studyForm" name="studyForm" value-property="code" values="formState.allStudyForms" filter-values="formState.hiddenStudyForms" multiple></hois-select> </md-input-container> <hois-autocomplete label="studentGroup.teacher" ha-controller="directiveControllers" ng-if="!formState.onlyhigher" ng-model="criteria.teacher" method="teachers" flex="50" flex-offset="5"></hois-autocomplete> </div> <div layout="row" flex="45"> <md-input-container> <label>{{\'main.validFrom\' | translate}}</label> <md-datepicker ng-model="criteria.validFrom" md-max-date="criteria.validThru" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> <md-input-container flex-offset="5"> <label>{{\'main.validThru\' | translate}}</label> <md-datepicker ng-model="criteria.validThru" md-min-date="criteria.validFrom" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> </div> <div layout="row" flex> <md-input-container class="md-block"> <md-checkbox ng-model="criteria.isValid" name="isValid">{{\'studentGroup.isValid\' | translate}}</md-checkbox> </md-input-container> </div> <div layout="row"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> <md-button class="md-raised" ng-if="isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_OPPERYHM\')" ng-href="#/studentgroups/new">{{\'main.button.create\' | translate}}</md-button> </div> </div> </fieldset> </form> </div> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="code">{{\'studentGroup.code\' | translate}}</th> <th md-column md-order-by="{{currentLanguage()===\'en\' ? \'curriculum.nameEn\' : \'curriculum.nameEt\'}}">{{\'studentGroup.curriculum\' | translate}}</th> <th md-column md-order-by="{{currentLanguage()===\'en\' ? \'studyForm.nameEn\' : \'studyForm.nameEt\'}}">{{\'studentGroup.studyForm\' | translate}}</th> <th md-column md-order-by="12" ng-if="!formState.onlyhigher">{{\'studentGroup.teacher\' | translate}}</th> <th md-column md-numeric md-order-by="course">{{\'studentGroup.course\' | translate}}</th> <th md-column md-numeric>{{\'studentGroup.studentCount\' | translate}}</th> <th md-column md-order-by="validFrom">{{\'main.validFrom\' | translate}}</th> <th md-column md-order-by="validThru">{{\'main.validThru\' | translate}}</th> <th></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell><a ng-href="#/studentgroups/{{::row.id}}/view">{{::row.code}}</a></td> <td md-cell>{{currentLanguageNameField(row.curriculum)}}</td> <td md-cell>{{currentLanguageNameField(row.studyForm)}}</td> <td md-cell ng-if="!formState.onlyhigher">{{row.teacher}}</td> <td md-cell>{{::row.course}}</td> <td md-cell>{{::row.studentCount}}</td> <td md-cell>{{::row.validFrom | hoisDate}}</td> <td md-cell>{{::row.validThru | hoisDate}}</td> <td md-cell> <md-button md-no-ink class="md-primary change-button" ng-if="isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_OPPERYHM\')" ng-href="#/studentgroups/{{::row.id}}/edit">{{\'main.button.change\' | translate}}</md-button> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> </div>'),a.put("studentGroup/student.group.view.html",'<div layout="column" class="ois-form-layout-padding form-readonly"> <div> <div layout="column"> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label>{{\'studentGroup.code\' | translate}}</label> <hois-value value="record.code"></hois-value> </md-input-container> <md-input-container flex="25" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label class="textInput">{{\'studentGroup.course\' | translate}}</label> <hois-value value="record.course.toString()"></hois-value> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label class="textInput">{{\'studentGroup.places\' | translate}}</label> <hois-value value="record.places.toString()"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'studentGroup.curriculum\' | translate}}</label> <hois-value value="currentLanguageNameField(record.curriculum)"></hois-value> </md-input-container> <md-input-container flex="50" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label class="textInput">{{formState.curriculumVersionLabel | translate}}</label> <hois-value value="currentLanguageNameField(formState.curriculumVersion)"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'studentGroup.studyForm\' | translate}}</label> <hois-classifier-value ng-model="record.studyForm" main-classifier-code="OPPEVORM"></hois-classifier-value> </md-input-container> <md-input-container flex="25" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label class="textInput">{{\'studentGroup.language\' | translate}}</label> <hois-classifier-value ng-model="record.language" main-classifier-code="OPPEKEEL"></hois-classifier-value> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'student.studyLevel\' | translate}}</label> <hois-classifier-value ng-model="formState.origStudyLevel" main-classifier-code="OPPEASTE"></hois-classifier-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column" ng-if="formState.onlyvocational || formState.isVocational"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'studentGroup.teacher\' | translate}}</label> <hois-value value="record.teacher.nameEt"></hois-value> </md-input-container> <md-input-container flex="50" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label class="textInput">{{\'studentGroup.speciality\' | translate}}</label> <hois-value value="record.speciality ? (record.speciality | hoisValidDates) : record.speciality"></hois-value> </md-input-container> </div> <div layout="row"> <div layout="column" flex="45"> <br> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex flex-sm="100" flex-xs="100"> <label>{{\'main.validFrom\' | translate}}</label> <hois-value value="record.validFrom | hoisDate"></hois-value> </md-input-container> <md-input-container flex flex-sm="100" flex-xs="100" flex-offset-xs="0" flex-offset-sm="0" flex-offset="5"> <label>{{\'main.validThru\' | translate}}</label> <hois-value value="record.validThru | hoisDate"></hois-value> </md-input-container> </div> </div> </div> </div> <div>&nbsp;</div> <md-table-container ng-if="record.members && record.members.length > 0"> <table md-table> <thead md-head md-order="formState.order"> <tr md-row> <th md-column>{{\'main.rowno\' | translate}}</th> <th md-column md-order-by="rowno">{{\'studentGroup.studentname\' | translate}}</th> <th md-column ng-if="showPersonalData" md-order-by="idcode">{{\'studentGroup.idcode\' | translate}}</th> <th md-column md-order-by="curriculumVersion.{{currentLanguageNameField()}}">{{formState.curriculumVersionLabel | translate}}</th> <th md-column md-order-by="status.{{currentLanguageNameField()}}">{{\'studentGroup.studentstatus\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row md-select="row" ng-repeat="row in record.members | orderBy: formState.order" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{::row.rowno}}</td> <td md-cell> <a class="md-primary" ng-if="showPersonalData" ng-href="#/students/{{::row.id}}/main">{{::row.fullname}}</a> <span ng-if="!showPersonalData">{{::row.fullname}}</span> </td> <td md-cell ng-if="showPersonalData">{{::row.idcode}}</td> <td md-cell>{{currentLanguageNameField(row.curriculumVersion)}}</td> <td md-cell>{{currentLanguageNameField(row.status)}}</td> </tr> </tbody> </table> </md-table-container> <md-button ng-href="#/studentgroups/{{record.id}}/edit" class="md-raised md-primary" ng-if="canEdit">{{\'main.button.change\' | translate}}</md-button> <md-button ng-click="back(\'#/studentgroups\')" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </div> </div>'),a.put("studentGroup/student.select.dialog.html",'<md-dialog aria-label="grade add dialog" flex="60" flex-sm="100" flex-xs="100"> <form name="studentGroupStudentForm" novalidate ng-cloak> <md-dialog-content> <div class="md-dialog-content"> <md-table-container> <table md-table md-row-select multiple ng-model="formState.selectedStudents"> <thead md-head md-order="formState.order"> <tr md-row> <th md-column md-order-by="rowno">{{\'studentGroup.studentname\' | translate}}</th> <th md-column md-order-by="idcode">{{\'studentGroup.idcode\' | translate}}</th> <th md-column md-order-by="curriculumVersion.{{$root.currentLanguageNameField()}}">{{formState.curriculumVersionLabel | translate}}</th> <th md-column md-order-by="status.{{$root.currentLanguageNameField()}}">{{\'studentGroup.studentstatus\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row md-select="row" md-select-id="id" md-auto-select ng-repeat="row in formState.students | orderBy: formState.order" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{::row.fullname}}</td> <td md-cell>{{::row.idcode}}</td> <td md-cell>{{$root.currentLanguageNameField(row.curriculumVersion)}}</td> <td md-cell>{{$root.currentLanguageNameField(row.status)}}</td> </tr> </tbody> </table> </md-table-container> </div> </md-dialog-content> <md-dialog-actions layout="row" layout-align="start center"> <md-button ng-click="select()" class="md-raised md-primary">{{\'main.button.add\' | translate}}</md-button> <md-button ng-click="cancel()" class="md-raised">{{\'main.button.close\' | translate}}</md-button> </md-dialog-actions> </form> </md-dialog>'),a.put("studentGroupYearTransfer/student.group.year.transfer.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <div layout="row"> <md-input-container flex="20" flex-sm="100" flex-xs="100"> <label>{{\'studentGroupYearTransfer.studyYear\' | translate}}</label> <hois-select ng-model="studyYear" ng-change="studyYearChanged()" values="studyYears" required></hois-select> </md-input-container> </div> <div ng-show="studyYear"> <form name="transferForm"> <div class="label-with-vertical-margin"> {{\'studentGroupYearTransfer.conditionsDescription\' | translate}}: </div> <div> <md-checkbox ng-model="academicLeave" ng-disabled="calculated" aria-label="{{\'studentGroupYearTransfer.academicLeave\' | translate}}"> {{\'studentGroupYearTransfer.academicLeave\' | translate}} </md-checkbox> </div> <div layout="row"> <md-input-container flex="33" flex-sm="100" flex-xs="100"> <label>{{\'studentGroupYearTransfer.academicLeaveDays\' | translate}}</label> <input type="number" ng-model="academicLeaveDays" min="0" ng-disabled="calculated"> </md-input-container> </div> <div> <md-checkbox ng-model="abroadStudies" ng-disabled="calculated" aria-label="{{\'studentGroupYearTransfer.abroadStudies\' | translate}}"> {{\'studentGroupYearTransfer.abroadStudies\' | translate}} </md-checkbox> </div> <div layout="row"> <md-input-container flex="33" flex-sm="100" flex-xs="100"> <label>{{\'studentGroupYearTransfer.abroadStudiesDays\' | translate}}</label> <input type="number" ng-model="abroadStudiesDays" min="0" ng-disabled="calculated"> </md-input-container> </div> <div class="label-with-vertical-margin" ng-show="checkGroupValidThru"> {{\'studentGroupYearTransfer.checkGroupValidThru\' | translate}}: {{checkGroupValidThru}} </div> <div layout="row"> <md-table-container flex="100"> <table md-table> <thead md-head> <tr md-row> <th md-column> <md-checkbox ng-model="multiSelect" ng-change="multiSelectChanged()" aria-label="multiSelect"></md-checkbox> </th> <th md-column>{{\'studentGroupYearTransfer.studentGroup\' | translate}}</th> <th md-column>{{\'studentGroupYearTransfer.course\' | translate}}</th> <th md-column>{{\'studentGroupYearTransfer.newCode\' | translate}}</th> <th md-column>{{\'studentGroupYearTransfer.newCourse\' | translate}}</th> <th md-column>{{\'studentGroupYearTransfer.curriculum\' | translate}}</th> <th md-column>{{\'studentGroupYearTransfer.allStudents\' | translate}}</th> <th md-column>{{\'studentGroupYearTransfer.suitableStudents\' | translate}}</th> <th md-column>{{\'studentGroupYearTransfer.unsuitableStudents\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in studentGroups" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell> <md-checkbox ng-model="row.selected" ng-if="!row.transfered" ng-change="selectChanged()" aria-label="selected"></md-checkbox> </td> <td md-cell>{{::row.oldCode}}</td> <td md-cell>{{::row.oldCourse}}</td> <td md-cell> <md-input-container ng-if="!row.transfered"> <input type="text" ng-model="row.newCode" ng-required="row.selected" aria-label="newCode"> </md-input-container> <span ng-if="row.transfered">{{row.newCode}}</span> </td> <td md-cell>{{::row.newCourse}}</td> <td md-cell>{{::row.curriculumName}}</td> <td md-cell>{{row.relatedStudents}}</td> <td md-cell> <a ng-click="viewMatchingStudents(row)">{{row.suitableStudents}}</a> </td> <td md-cell> <a ng-click="viewMismatchingStudents(row)">{{row.unsuitableStudents}}</a> </td> </tr> </tbody> </table> </md-table-container> </div> <div layout="row"> <md-button class="md-raised" ng-if="isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_UUDE_AASTASSE\')" ng-show="canTransfer" ng-class="{\'md-primary\': !calculated}" ng-click="calculate()"> {{\'main.button.calculate\' | translate}} </md-button> </div> <div ng-show="calculated"> <div layout="row"> <fieldset flex="100"> <legend>{{\'studentGroupYearTransfer.mismatchingStudents\' | translate}}</legend> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'student.name\' | translate}}</th> <th md-column>{{\'studentGroupYearTransfer.curriculum\' | translate}}</th> <th md-column>{{\'studentGroupYearTransfer.reason\' | translate}}</th> <th md-column>{{\'studentGroupYearTransfer.course\' | translate}}</th> <th md-column>{{\'studentGroupYearTransfer.studentGroup\' | translate}}</th> <th md-column>{{\'studentGroupYearTransfer.newGroup\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in mismatchingStudents" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{::row.name}}</td> <td md-cell>{{::row.group.curriculumName}}</td> <td md-cell>{{currentLanguageNameField(row.mismatchCode)}}</td> <td md-cell>{{::row.group.oldCourse}}</td> <td md-cell>{{::row.group.oldCode}}</td> <td md-cell> <md-input-container> <hois-select ng-model="row.newGroup" values="studentGroups" show-property="oldCode" required aria-label="newGroup"></hois-select> </md-input-container> </td> </tr> </tbody> </table> </fieldset> </div> <div layout="row"> <md-button class="md-raised md-primary" ng-click="transfer()">{{\'studentGroupYearTransfer.button.transfer\' | translate}}</md-button> </div> </div> </form> </div> </div> </div>'),a.put("studentGroupYearTransfer/students.match.dialog.html",'<md-dialog aria-label="students dialog" flex="50"> <md-toolbar> <div class="md-toolbar-tools"> <h2 flex>{{"studentGroupYearTransfer.suitableStudents" | translate}}</h2> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <div class="md-dialog-content"> <div layout="column" flex> <md-table-container> <table md-table> <thead md-head> <tr md-row> <th md-column>{{\'student.name\' | translate}}</th> <th md-column>{{\'studentGroupYearTransfer.studentGroup\' | translate}}</th> <th md-column>{{\'studentGroupYearTransfer.curriculum\' | translate}}</th> <th md-column>{{\'studentGroupYearTransfer.course\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in students" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{::row}}</td> <td md-cell>{{::studentGroup.oldCode}}</td> <td md-cell>{{::studentGroup.curriculumName}}</td> <td md-cell>{{::studentGroup.oldCourse}}</td> </tr> </tbody> </table> </md-table-container> </div> </div> </md-dialog-content> <md-dialog-actions layout="row" layout-align="start start"> <md-button class="md-raised" ng-click="cancel()">{{"main.button.close" | translate}}</md-button> </md-dialog-actions> </md-dialog>'),a.put("studentGroupYearTransfer/students.mismatch.dialog.html",'<md-dialog aria-label="students dialog" flex="50"> <md-toolbar> <div class="md-toolbar-tools"> <h2 flex>{{"studentGroupYearTransfer.unsuitableStudents" | translate}}</h2> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <div class="md-dialog-content"> <div layout="column" flex> <md-table-container> <table md-table> <thead md-head> <tr md-row> <th md-column>{{\'student.name\' | translate}}</th> <th md-column>{{\'studentGroupYearTransfer.studentGroup\' | translate}}</th> <th md-column>{{\'studentGroupYearTransfer.curriculum\' | translate}}</th> <th md-column>{{\'studentGroupYearTransfer.course\' | translate}}</th> <th md-column>{{\'studentGroupYearTransfer.reason\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in students" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{::row.name}}</td> <td md-cell>{{::studentGroup.oldCode}}</td> <td md-cell>{{::studentGroup.curriculumName}}</td> <td md-cell>{{::studentGroup.oldCourse}}</td> <td md-cell>{{currentLanguageNameField(row.mismatchCode)}}</td> </tr> </tbody> </table> </md-table-container> </div> </div> </md-dialog-content> <md-dialog-actions layout="row" layout-align="start start"> <md-button class="md-raised" ng-click="cancel()">{{"main.button.close" | translate}}</md-button> </md-dialog-actions> </md-dialog>'),a.put("studentRepresentative/representative.application.create.html",'<div layout="column" class="ois-form-layout-padding ois-form-layout" ng-cloak> <div> <form name="studentRepresentativeApplicationCreateForm" novalidate> <md-input-container class="md-block"> <label>{{\'student.representative.studentIdcode\' | translate}}</label> <hois-idcode-lookup ng-model="record.studentIdcode" name="idcode" role="activestudent" after-lookup="lookupPerson(response)" after-failed-lookup="lookupFailure(response)" required></hois-idcode-lookup> </md-input-container> <md-input-container class="md-block"> <label>{{\'student.representative.firstname\' | translate}}</label> <input ng-model="record.firstname" name="firstname" type="text" readonly> </md-input-container> <md-input-container class="md-block"> <label>{{\'student.representative.lastname\' | translate}}</label> <input ng-model="record.lastname" name="lastname" type="text" readonly> </md-input-container> <md-input-container class="md-block"> <label>{{\'student.representative.relation\' | translate}}</label> <hois-classifier-select ng-model="record.relation" name="relation" main-classifier-code="OPPURESINDAJA" required model-value-attr="code"></hois-classifier-select> </md-input-container> <md-input-container class="md-block"> <label>{{\'student.representative.phone\' | translate}}</label> <input ng-model="record.phone" name="phone" type="text" required md-maxlength="100"> </md-input-container> <md-input-container class="md-block"> <label>{{\'student.representative.email\' | translate}}</label> <input ng-model="record.email" name="email" type="text" required md-maxlength="255"> </md-input-container> </form> <md-button ng-click="apply()" class="md-raised md-primary">{{\'student.representative.application.apply\' | translate}}</md-button> <md-button ng-click="back(\'#/\')" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </div> </div>'),a.put("studentRepresentative/representative.application.decline.dialog.html",'<md-dialog aria-label="grade add dialog" flex="30" flex-xs="100"> <form name="studentRepresentativeApplicationDeclineForm" novalidate ng-cloak> <md-dialog-content> <div class="md-dialog-content"> <md-input-container class="md-block"> <label>{{\'student.representative.application.rejectReason\' | translate}}</label> <textarea ng-model="record.rejectReason" name="rejectReason" required md-maxlength="4000" md-autofocus></textarea> </md-input-container> </div> </md-dialog-content> <md-dialog-actions layout="row" layout-align="start center"> <md-button ng-click="decline()" class="md-raised md-primary">{{\'main.button.decline\' | translate}}</md-button> <md-button ng-click="cancel()" class="md-raised">{{\'main.button.close\' | translate}}</md-button> </md-dialog-actions> </form> </md-dialog>'),a.put("studentRepresentative/representative.application.list.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <form name="searchForm" ng-submit="searchForm.$valid && loadData()" novalidate class="nomargin" ng-model-options="{allowInvalid: true}"> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'student.representative.application.applicantname\' | translate}}</label> <input ng-model="criteria.name" name="name" type="text" md-maxlength="255" autofocus> </md-input-container> <md-input-container flex="50" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label class="textInput">{{\'student.representative.application.applicantidcode\' | translate}}</label> <input ng-model="criteria.idcode" name="idcode" type="text" minlength="11" md-maxlength="11"> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label>{{\'student.representative.application.status\' | translate}}</label> <hois-classifier-select ng-model="criteria.status" name="status" model-value-attr="code" main-classifier-code="AVALDUS_ESINDAJA_STAATUS"></hois-classifier-select> </md-input-container> </div> <div layout="row"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> </div> <div flex-xs="0" flex-gt-xs="0" flex-gt-sm="50"></div> </form> </fieldset> </div> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="person.lastname,person.firstname">{{\'student.representative.application.applicantname\' | translate}}</th> <th md-column md-order-by="person.idcode">{{\'student.representative.idcode\' | translate}}</th> <th md-column md-order-by="{{currentLanguage()===\'en\' ? \'relation.nameEn\' : \'relation.nameEt\'}}">{{\'student.representative.relation\' | translate}}</th> <th md-column md-order-by="person.phone">{{\'student.representative.phone\' | translate}}</th> <th md-column md-order-by="person.email">{{\'student.representative.email\' | translate}}</th> <th md-column md-order-by="inserted">{{\'student.representative.application.applied\' | translate}}</th> <th md-column md-order-by="{{currentLanguage()===\'en\' ? \'status.nameEn\' : \'status.nameEt\'}}">{{\'student.representative.application.status\' | translate}}</th> <th md-column ng-if="formState.status !== \'AVALDUS_ESINDAJA_STAATUS_E\'" md-order-by="changed">{{(formState.status === \'AVALDUS_ESINDAJA_STAATUS_K\' ? \'student.representative.application.confirmDate\' : (formState.status === \'AVALDUS_ESINDAJA_STAATUS_T\' ? \'student.representative.application.declineDate\' : \'student.representative.application.confirmDeclineDate\')) | translate}}</th> <th md-column md-order-by="student.person.lastname,student.person.firstname">{{\'student.name\' | translate}}</th> <th md-column md-order-by="student.person.idcode">{{\'student.idcode\' | translate}}</th> <th></th> <th></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{::row.fullname}}</td> <td md-cell>{{::row.idcode}}</td> <td md-cell>{{currentLanguageNameField(row.relation)}}</td> <td md-cell>{{::row.phone}}</td> <td md-cell>{{::row.email}}</td> <td md-cell>{{::row.inserted | hoisDate}}</td> <td md-cell> <md-tooltip ng-if="row.status.code === \'AVALDUS_ESINDAJA_STAATUS_T\'">{{::row.rejectReason}}</md-tooltip> {{currentLanguageNameField(row.status)}} </td> <td md-cell ng-if="formState.status !== \'AVALDUS_ESINDAJA_STAATUS_E\'">{{(row.confirmDate || row.declineDate) | hoisDate}}</td> <td md-cell><a md-no-ink class="md-primary" ng-href="#/students/{{::row.studentId}}/main">{{::row.studentFullname}}</a></td> <td md-cell>{{::row.studentIdcode}}</td> <td md-cell> <md-button ng-if="row.status.code === \'AVALDUS_ESINDAJA_STAATUS_E\' && isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_ESINDAVALDUS\')" md-no-ink class="md-primary change-button" ng-click="accept(row)">{{\'main.button.confirm\' | translate}}</md-button> </td> <td md-cell> <md-button ng-if="row.status.code === \'AVALDUS_ESINDAJA_STAATUS_E\' && isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_ESINDAVALDUS\')" md-no-ink class="md-primary change-button" ng-click="decline(row)">{{\'main.button.decline\' | translate}}</md-button> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> </div>'),a.put("studentRepresentative/representative.edit.dialog.html",'<md-dialog aria-label="grade add dialog" flex="30" flex-xs="100"> <form name="studentRepresentativeEditForm" novalidate ng-cloak> <md-dialog-content> <div class="md-dialog-content"> <fieldset tabindex="1" ng-if="!record.id" class="form-readonly"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'student.representative.student\' | translate}}</legend> <md-input-container class="md-block"> <label>{{\'student.representative.studentIdcode\' | translate}}</label> <hois-value value="formState.student.person.idcode"></hois-value> </md-input-container> <md-input-container class="md-block"> <label>{{\'student.name\' | translate}}</label> <hois-value value="formState.student.person.fullname"></hois-value> </md-input-container> </fieldset> <fieldset tabindex="2"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'student.representative.data\' | translate}}</legend> <md-input-container class="md-block"> <label>{{\'student.representative.idcode\' | translate}}</label> <input type="text" name="idcode" ng-model="record.person.idcode" ng-blur="lookupPerson()" md-minlength="11" md-maxlength="11" ng-readonly="record.id" required md-autofocus="!record.id"> <div class="invalid" ng-show="studentRepresentativeEditForm.idcode.$error.notUnique"> {{\'student.representative.samewithstudent\' | translate}} </div> <div class="invalid" ng-show="studentRepresentativeEditForm.idcode.$error.estonianIdcode"> {{\'main.messages.error.estonianIdcode\' | translate}} </div> </md-input-container> <md-input-container class="md-block"> <label>{{\'student.representative.firstname\' | translate}}</label> <input ng-model="record.person.firstname" name="firstname" type="text" ng-readonly="record.id || formState.idcode" required md-maxlength="255"> </md-input-container> <md-input-container class="md-block"> <label>{{\'student.representative.lastname\' | translate}}</label> <input ng-model="record.person.lastname" name="lastname" type="text" ng-readonly="record.id || formState.idcode" required md-maxlength="255"> </md-input-container> <md-input-container class="md-block"> <label>{{\'student.representative.relation\' | translate}}</label> <hois-classifier-select ng-model="record.relation" name="relation" ng-disabled="record.id" main-classifier-code="OPPURESINDAJA" required model-value-attr="code"></hois-classifier-select> </md-input-container> <md-input-container class="md-block"> <label>{{\'student.representative.phone\' | translate}}</label> <input ng-model="record.person.phone" name="phone" type="text" required md-maxlength="100" md-autofocus="!record.id"> </md-input-container> <md-input-container class="md-block"> <label>{{\'student.representative.email\' | translate}}</label> <input ng-model="record.person.email" name="email" type="text" required md-maxlength="100"> </md-input-container> <md-checkbox ng-model="record.isStudentVisible" name="isStudentVisible" ng-disabled="isParent" ng-if="record.id"> {{\'student.representative.studentVisible\' | translate}} </md-checkbox> </fieldset> </div> </md-dialog-content> <md-dialog-actions layout="row" layout-align="start center"> <md-button ng-click="update()" class="md-raised md-primary">{{\'main.button.save\' | translate}}</md-button> <md-button ng-click="delete()" ng-if="record.id && record.userCanDelete" class="md-raised">{{\'main.button.delete\' | translate}}</md-button> <md-button ng-click="cancel()" class="md-raised">{{\'main.button.close\' | translate}}</md-button> </md-dialog-actions> </form> </md-dialog>'),a.put("studentResultCard/student.result.card.list.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <form name="searchForm" ng-submit="searchForm.$valid && loadData()" novalidate ng-model-options="{allowInvalid: true}"> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'student.name\' | translate}}</label> <input ng-model="criteria.name" name="name" type="text" md-maxlength="255" autofocus> </md-input-container> <md-input-container flex="50" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label class="textInput">{{\'student.idcode\' | translate}}</label> <input ng-model="criteria.idcode" name="idcode" type="text" minlength="11" md-maxlength="11"> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label>{{\'student.curriculum\' | translate}}</label> <hois-select ng-model="criteria.curriculumVersion" name="curriculumVersion" type="curriculumversion" criteria="{higher: false}" multiple></hois-select> </md-input-container> <hois-autocomplete flex="50" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0" ng-model="criteria.studentGroupId" ha-attribute="id" ha-controller="directiveControllers" method="studentgroups" name="studentGroup" additional-query-params="{higher: false}" label="{{\'student.studentGroup\'}}"></hois-autocomplete> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label>{{\'student.studyForm\' | translate}}</label> <hois-classifier-select ng-model="criteria.studyForm" criteria="{vocational: true}" name="studyForm" model-value-attr="code" main-classifier-code="OPPEVORM" multiple></hois-classifier-select> </md-input-container> <md-input-container flex="50" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'student.status\' | translate}}</label> <hois-classifier-select criteria="{vocational: true}" ng-model="criteria.status" name="status" model-value-attr="code" main-classifier-code="OPPURSTAATUS" multiple></hois-classifier-select> </md-input-container> </div> <div layout="row"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> <md-button class="md-raised" ng-click="print()" ng-disabled="selectedStudents.length === 0">{{\'student.resultcard.print\' | translate}}</md-button> </div> <div flex-xs="0" flex-gt-xs="0" flex-gt-sm="50"></div> </form> </fieldset> </div> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise" md-row-select multiple ng-model="selectedStudents"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="person.lastname,person.firstname">{{\'student.name\' | translate}}</th> <th md-column md-order-by="person.idcode">{{\'student.idcode\' | translate}}</th> <th md-column md-order-by="curriculumVersion.code">{{\'student.curriculum\' | translate}}</th> <th md-column md-order-by="studentGroup.code">{{\'student.studentGroup\' | translate}}</th> <th md-column md-order-by="{{currentLanguage()===\'en\' ? \'studyForm.nameEn\' : \'studyForm.nameEt\'}}">{{\'student.studyForm\' | translate}}</th> <th md-column md-order-by="{{currentLanguage()===\'en\' ? \'status.nameEn\' : \'status.nameEt\'}}">{{\'student.status\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row md-select="row.id" ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell> <a md-no-ink class="md-primary" ng-href="#/studentResultCards/{{::row.id}}/view">{{::row.fullname}}</a> </td> <td md-cell>{{::row.idcode}}</td> <td md-cell>{{currentLanguageNameField(row.curriculumVersion)}}</td> <td md-cell>{{currentLanguageNameField(row.studentGroup)}}</td> <td md-cell>{{currentLanguageNameField(row.studyForm)}}</td> <td md-cell>{{currentLanguageNameField(row.status)}}</td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[50, 100, 200]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> </div> <div layout-padding> <div flex> <md-button class="md-raised" ng-click="print()" ng-disabled="selectedStudents.length === 0">{{\'student.resultcard.print\' | translate}}</md-button> </div> </div>'),
a.put("studentResultCard/student.result.card.view.html",'<div layout-padding ng-cloak class="form-readonly"> <div flex> <div ng-if="resultCard.idcode" layout="row"> <md-input-container class="label-only" flex="60" flex-sm="100" flex-xs="100"> <label>{{\'student.resultcard.idcode\' | translate}}</label> <hois-value value="resultCard.idcode"></hois-value> </md-input-container> </div> <div ng-if="!resultCard.idcode" layout="row"> <md-input-container class="label-only" flex="60" flex-sm="100" flex-xs="100"> <label>{{\'student.resultcard.birthdate\' | translate}}</label> <hois-value value="(resultCard.birthdate | hoisDate)"></hois-value> </md-input-container> </div> <div layout="row"> <md-input-container class="label-only" flex="60" flex-sm="100" flex-xs="100"> <label>{{\'student.resultcard.firstname\' | translate}}</label> <hois-value value="resultCard.firstname"></hois-value> </md-input-container> </div> <div layout="row"> <md-input-container class="label-only" flex="60" flex-sm="100" flex-xs="100"> <label>{{\'student.resultcard.lastname\' | translate}}</label> <hois-value value="resultCard.lastname"></hois-value> </md-input-container> </div> <div layout="row"> <md-input-container class="label-only" flex="60" flex-sm="100" flex-xs="100"> <label>{{\'student.resultcard.studyStartAndBase\' | translate}}</label> <hois-value ng-if="resultCard.matriculationDate || resultCard.studyStartDirectiveConfirmDate" value="((resultCard.matriculationDate | hoisDate) || \'\') + \', \' + (\'student.resultcard.directiveNr\' | translate) \r\n          + \' \' + (resultCard.studyStartDirectiveNr || \'\') + \' \' + ((resultCard.studyStartDirectiveConfirmDate | hoisDate) || \'\')"></hois-value> <hois-value ng-if="!(resultCard.matriculationDate || resultCard.studyStartDirectiveConfirmDate)" value=""></hois-value> </md-input-container> </div> <div layout="row" ng-if="resultCard.exmatriculationDate || resultCard.studyEndDirectiveConfirmDate"> <md-input-container class="label-only" flex="60" flex-sm="100" flex-xs="100"> <label>{{\'student.resultcard.studyEndAndBase\' | translate}}</label> <hois-value value="((resultCard.exmatriculationDate | hoisDate) || \'\') + \', \' +  (\'student.resultcard.directiveNr\' | translate) \r\n          + \' \' + (resultCard.studyEndDirectiveNr || \'\') + \' \' + ((resultCard.studyEndDirectiveConfirmDate | hoisDate) || \'\')"></hois-value> </md-input-container> </div> <div layout="row"> <md-input-container class="label-only" flex="60" flex-sm="100" flex-xs="100"> <label>{{\'student.resultcard.curriculumNameAndCode\' | translate}}</label> <hois-value value="resultCard.curriculumName + \', \' + resultCard.curriculumCode"></hois-value> </md-input-container> </div> <div layout="row"> <md-input-container class="label-only" flex="60" flex-sm="100" flex-xs="100"> <label>{{\'student.resultcard.curriculumCredits\' | translate}}</label> <hois-value value="(resultCard.curriculumCredits ? resultCard.curriculumCredits : 0) + \' \' + (\'student.resultcard.credits\' | translate)"></hois-value> </md-input-container> </div> <div layout="row"> <md-input-container class="label-only" flex="60" flex-sm="100" flex-xs="100"> <label>{{\'student.resultcard.studyForm\' | translate}}</label> <hois-value value="resultCard.studyForm"></hois-value> </md-input-container> </div> <div layout="row"> <md-input-container class="label-only" flex="60" flex-sm="100" flex-xs="100"> <label>{{\'student.resultcard.language\' | translate}}</label> <hois-value value="resultCard.studyLanguage"></hois-value> </md-input-container> </div> <div layout="row" ng-if="resultCard.diplomaNrs"> <md-input-container class="label-only" flex="60" flex-sm="100" flex-xs="100"> <label>{{\'student.resultcard.diplomaNr\' | translate}}</label> <hois-value value="resultCard.diplomaNrs"></hois-value> </md-input-container> </div> <div layout="row" ng-if="resultCard.supplementNrs"> <md-input-container class="label-only" flex="60" flex-sm="100" flex-xs="100"> <label>{{\'student.resultcard.supplementNr\' | translate}}</label> <hois-value value="resultCard.supplementNrs"></hois-value> </md-input-container> </div> </div> <h2 class="md-title">{{\'student.resultcard.results\' | translate}}</h2> <md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'student.resultcard.nr\' | translate}}</th> <th md-column>{{\'student.resultcard.name\' | translate}}</th> <th md-column>{{\'student.resultcard.creditsLoad\' | translate}}</th> <th md-column>{{\'student.resultcard.grade\' | translate}}</th> <th md-column>{{\'student.resultcard.date\' | translate}}</th> <th md-column>{{auth.higher ? (\'student.resultcard.teacherHigher\' | translate) : (\'student.resultcard.teacherVocational\' | translate)}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="result in resultCard.studyResults track by $index" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell width="10%">{{$index + 1}}</td> <td md-cell width="40%">{{result.name}}</td> <td md-cell width="10%">{{result.credits}} {{\'student.resultcard.credits\' | translate}}</td> <td md-cell width="10%">{{result.grade}} ({{result.gradeName}})</td> <td md-cell width="10%">{{result.gradeDate | hoisDate}}</td> <td md-cell width="20%">{{result.teacher}}</td> </tr> </tbody> </table> </md-table-container> <h2 class="md-title">{{\'student.resultcard.examResults\' | translate}}</h2> <md-table-container> <table md-table class="secondary-table"> <tbody md-body> <tr md-row ng-repeat="result in resultCard.finalResults track by $index" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell width="10%"></td> <td md-cell width="40%">{{result.name}}</td> <td md-cell width="10%">{{result.credits}} {{\'student.resultcard.credits\' | translate}}</td> <td md-cell width="10%">{{result.grade}} ({{result.gradeName}})</td> <td md-cell width="10%">{{result.gradeDate | hoisDate}}</td> <td md-cell width="20%">{{result.teacher}}</td> </tr> </tbody> </table> </md-table-container> <div>&nbsp;</div> <md-table-container> <table md-table> <tbody md-body class="secondary-table"> <tr md-row> <td md-cell width="50%">{{\'student.resultcard.totalSubjectCredits\' | translate}}</td> <td md-cell width="10%">{{resultCard.totalCredits}}</td> <td md-cell width="40%"></td> </tr> <tr md-row ng-repeat="apel in resultCard.apels track by $index"> <td md-cell> <span>*{{$index + 1}}</span> <span ng-if="apel.isFormal">{{\'student.resultcard.transferred\' | translate}} {{apel.name}}</span> <span ng-if="!apel.isFormal">{{\'student.resultcard.apel\' | translate}}</span> </td> <td md-cell></td> <td md-cell></td> </tr> </tbody> </table> </md-table-container> </div> <div layout-padding> <div flex> <md-button class="md-raised" ng-click="print()">{{\'student.resultcard.print\' | translate}}</md-button> <md-button ng-click="back(\'#/studentResultCards/\')" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </div> </div>'),a.put("studentgroupContract/studentgroup.contract.add.dialog.html",'<md-dialog aria-label="add enterprise dialog" flex="50"> <form name="dialogForm" ng-submit="checkChecked()" novalidate ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2 flex>{{"contract.addToSeveralHeader" | translate}}</h2> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <div class="md-dialog-content" flex> <div flex="50" layout="column" class="form-readonly"> <md-input-container> <label>{{\'lessonplan.studentGroup\' | translate}}</label> <hois-value value="currentLanguageNameField(studentGroup)"></hois-value> </md-input-container> </div> <div layout="row" flex="100"> <hois-autocomplete label="student.label" ng-model="criteria.student" method="students" additional-query-params="{active: true, studentGroup: studentGroupList}" flex></hois-autocomplete> <md-button flex-offset="5" ng-click="addAllStudents()" class="md-raised">{{"student.addAll" | translate}}</md-button> </div> <md-table-container ng-if="criteria.students.length > 0" layout="row" flex="100" style="max-height: 100px"> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column width="90%">{{\'student.plural\' | translate}}</th> <th md-column width="10%"></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="student in criteria.students" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{currentLanguageNameField(student)}}</td> <td md-cell> <a ng-click="deleteStudent(student)" class="remove">&times;</a> </td> </tr> </tbody> </table> </md-table-container> </div> </md-dialog-content> <md-dialog-actions layout="row" layout-xs="column" layout-align="start start" layout-align-xs="none none"> <md-button flex-xs="100" class="md-raised md-primary" type="submit">{{\'main.button.save\' | translate}}</md-button> <md-button ng-show="enterprise.id" flex-xs="100" class="md-raised" ng-click="delete()">{{\'main.button.delete\' | translate}}</md-button> <md-button flex-xs="100" class="md-raised" ng-click="cancel()">{{"main.button.close" | translate}}</md-button> </md-dialog-actions> </form> </md-dialog>'),a.put("studentgroupContract/studentgroup.contract.list.html",'<style>md-autocomplete {\r\n    min-width: 0;\r\n  }</style> <div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <form name="searchForm" ng-submit="searchForm.$valid && loadData()" novalidate class="nomargin"> <div layout="row" layout-xs="column"> <hois-autocomplete flex="30" flex-xs="50" ng-model="studentGroupObject" method="studentgroups" name="studentGroup" label="{{\'lessonplan.studentGroup\'}}" additional-query-params="{valid: true}" required></hois-autocomplete> <div ng-if="criteria.curriculumVersion" layout="column" class="form-readonly" flex-offset="5" flex-offset-xs="0" flex="30" flex-xs="100"> <br> <md-input-container flex> <label>{{(auth.higher ? \'student.curriculum\' : \'studentGroup.curriculumVersionVocational\') | translate}}</label> <hois-value value="currentLanguageNameField(criteria.curriculumVersion)"></hois-value> </md-input-container> </div> <div layout="column" layout-align="center start" flex-offset="5" flex-offset-xs="0" flex="30" flex-xs="50"> <md-input-container> <md-checkbox aria-label="active students" ng-model="criteria.active" ng-checked="true"> {{\'studentGroup.active\' | translate}} </md-checkbox> </md-input-container> </div> </div> <div flex-xs="0" flex-gt-xs="0" flex-gt-sm="50"></div> </form> </div> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadContracts"> <tr md-row> <th ng-if="auth.isAdmin()" md-column md-order-by="student_person.lastname,student_person.firstname">{{\'student.label\' | translate}}</th> <th md-column>{{\'student.practiceContracts.contractNumber\' | translate}}</th> <th md-column>{{\'contract.validity\' | translate}}</th> <th md-column>{{\'contract.supervisors\' | translate}}</th> <th md-column>{{\'contract.schoolSupervisor\' | translate}}</th> <th md-column>{{\'contract.contractDate\' | translate}}</th> <th md-column>{{\'main.status\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td ng-if="auth.isAdmin()" md-cell>{{currentLanguageNameField(row.student)}}</td> <td md-cell ng-if="!row.id" style="font-style: italic" colspan="5">{{\'contract.missing\' | translate}}</td> <td md-cell ng-if="!row.contractNr && row.id">{{\'-\'}}</td> <td md-cell ng-if="row.contractNr && row.id"><a ng-href="#/contracts/{{::row.id}}/view">{{row.contractNr}}</a></td> <td md-cell>{{row.startDate | hoisDate}} - {{row.endDate | hoisDate}}</td> <td md-cell ng-if="row.id">{{row.enterpriseContactPersonName ? row.enterpriseContactPersonName : \'-\' }}</td> <td md-cell ng-if="row.id">{{row.teacher ? currentLanguageNameField(row.teacher) : \'-\' }}</td> <td md-cell ng-if="row.id">{{row.confirmDate ? (row.confirmDate | hoisDate) : \'-\' }}</td> <td md-cell ng-if="row.id">{{row.status ? currentLanguageNameField(row.status) : \'-\' }}</td> <td md-cell> <div layout="row"> <div ng-if="row.id"> <md-button ng-if="row.status.code===\'LEPING_STAATUS_S\' && isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_LEPING\')" md-no-ink class="md-primary change-button" ng-href="#/contracts/{{::row.id}}/edit?_noback">{{\'main.button.change\' | translate}}</md-button> <md-button ng-if="row.status.code!==\'LEPING_STAATUS_S\' || !isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_LEPING\')" md-no-ink class="md-primary change-button" ng-href="#/contracts/{{::row.id}}/view?_noback">{{\'main.button.view\' | translate}}</md-button> </div> <div ng-if="row.student.id && row.active"> <md-button md-no-ink class="md-primary change-button" ng-href="#/contracts/{{::row.student.id}}/new?_noback">{{\'main.button.create\' | translate}}</md-button> </div> </div> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> <div layout="row" layout-xs="column"> <md-button md-no-ink class="md-raised" ng-href="#/contracts/new/{{::criteria.studentGroup}}?_menu" ng-if="!auth.higher && criteria.studentGroup && tabledata.content.length > 0">{{\'contract.addToSeveral\' | translate}}</md-button> <md-button md-no-ink class="md-raised" ng-click="sendToEkis()" ng-if="tabledata.content"> {{\'contract.sendToEkis\' | translate}} </md-button> </div> </div>'),a.put("studentgroupContract/studentgroup.contract.result.dialog.html",'<md-dialog aria-label="contract to ekis result" flex="50"> <md-toolbar> <div class="md-toolbar-tools"> <h2 flex>{{"contract.ekisResponse.label" | translate}}</h2> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <div class="ois-form-layout" layout="column" layout-margin ng-cloak> <p md-colors="{color: \'default-primary-800\'}" class="md-title-small">{{\'contract.ekisResponse.success\' | translate}}</p> <md-table-container style="max-height: 30vh"> <table md-table> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column>{{\'student.label\' | translate}}</th> <th md-column>{{\'enterprise.name\' | translate}}</th> <th md-column>{{\'practice.student.contractNr\' | translate}}</th> <th md-column>{{\'enterprise.csv.note\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in criteria.successful" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{row.student ? row.student : \'-\'}}</td> <td md-cell>{{row.enterprise ? row.enterprise : \'-\'}}</td> <td md-cell>{{row.contractNr ? row.contractNr : \'-\'}}</td> <td md-cell>{{row.message ? (row.message | translate) : \'-\'}}</td> </tr> </tbody> </table> </md-table-container> <p md-colors="{color: \'default-primary-800\'}" class="md-title-small">{{\'contract.ekisResponse.failed\' | translate}}</p> <md-table-container style="max-height: 30vh"> <table md-table> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column>{{\'student.label\' | translate}}</th> <th md-column>{{\'enterprise.name\' | translate}}</th> <th md-column>{{\'practice.student.contractNr\' | translate}}</th> <th md-column>{{\'enterprise.csv.note\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in criteria.failed" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{row.student ? row.student : \'-\'}}</td> <td md-cell>{{row.enterprise ? row.enterprise : \'-\'}}</td> <td md-cell>{{row.contractNr ? row.contractNr : \'-\'}}</td> <td md-cell>{{row.message ? (row.message | translate) : \'-\'}}</td> </tr> </tbody> </table> </md-table-container> </div> </md-dialog-content> <md-dialog-actions layout="row" layout-align="start start"> <md-button class="md-raised md-primary" ng-click="cancel()">{{"main.button.close" | translate}}</md-button> </md-dialog-actions> </md-dialog>'),a.put("studentgroupContract/studentgroup.ekis.contract.list.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <form name="searchForm" ng-submit="searchForm.$valid && loadData()" novalidate class="nomargin"> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <div layout="row"> <hois-autocomplete flex="50" ng-model="studentGroupObject" method="studentgroups" name="studentGroup" label="{{\'lessonplan.studentGroup\'}}" additional-query-params="{valid: true}"></hois-autocomplete> <md-input-container flex="50" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'student.name\' | translate}}</label> <input ng-model="criteria.studentName" name="name" type="text" md-maxlength="255"> </md-input-container> </div> <div layout="row"> <md-button md-no-ink class="md-raised md-primary" ng-click="reload()">{{\'main.button.search\' | translate}}</md-button> </div> </fieldset> <div flex-xs="0" flex-gt-xs="0" flex-gt-sm="50"></div> </form> </div> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadContracts"> <tr md-row> <th md-column> <md-input-container> <md-checkbox ng-model="allChecked" ng-change="checkAll()" aria-label="check all"></md-checkbox> </md-input-container> </th> <th md-column md-order-by="student_person.lastname,student_person.firstname">{{\'student.label\' | translate}}</th> <th md-column>{{\'lessonplan.studentGroup\' | translate}}</th> <th md-column>{{auth.higher ? (\'main.subjects\' | translate) : (\'practiceJournal.moduleAndTheme\' | translate)}}</th> <th md-column>{{\'practice.contract.enterprise\' | translate}}</th> <th md-column>{{\'contract.supervisors\' | translate}}</th> <th md-column>{{\'contract.schoolSupervisor\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell> <md-input-container> <md-checkbox ng-model="row.checked" aria-label="check row"></md-checkbox> </md-input-container> </td> <td md-cell>{{currentLanguageNameField(row.student)}}</td> <td md-cell>{{row.studentGroup ? row.studentGroup : \'-\' }}</td> <td md-cell>{{auth.higher ? currentLanguageNameField(row.higherModuleSubjects) : currentLanguageNameField(row.moduleSubjects) }}</td> <td md-cell>{{row.enterpriseName ? row.enterpriseName : \'-\' }}</td> <td md-cell>{{row.enterpriseContactPersonName ? row.enterpriseContactPersonName : \'-\' }}</td> <td md-cell>{{row.teacher ? currentLanguageNameField(row.teacher) : \'-\' }}</td> <td md-cell> <div layout="row"> <div ng-if="row.id"> <md-button ng-if="isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_LEPING\')" md-no-ink class="md-primary change-button" ng-href="#/contracts/{{::row.id}}/edit">{{\'main.button.change\' | translate}}</md-button> </div> <div ng-if="row.student.id && row.active"> <md-button md-no-ink class="md-primary change-button" ng-href="#/contracts/{{::row.student.id}}/new">{{\'main.button.create\' | translate}}</md-button> </div> </div> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> <div layout="row" layout-xs="column"> <div ng-if="tabledata.content"> <md-button md-no-ink class="md-raised" ng-if="isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_LEPING\')" ng-click="sendToEkis()">{{\'contract.sendToEkis\' | translate}}</md-button> </div> <md-button class="md-raised md-default" ng-click="back(\'#/contracts\')">{{\'main.button.back\' | translate}}</md-button> </div> </div>'),a.put("studyMaterial/study.material.higher.edit.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex class="form-readonly"> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="25" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'subjectStudyPeriod.studyPeriod\' | translate}}</label> <hois-value value="currentLanguageNameField(subjectStudyPeriod.studyPeriod)"></hois-value> </md-input-container> <md-input-container flex="30" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label class="textInput">{{\'subjectStudyPeriod.subject\' | translate}}</label> <hois-value value="currentLanguageNameField(subjectStudyPeriod.subject)"></hois-value> </md-input-container> </div> </div> <div flex> <form name="studyMaterialForm" ng-submit="save()" novalidate layout="column"> <div flex> <hois-autocomplete ng-if="auth.isAdmin()" flex ng-model="$parent.teacher" method="teachers" name="teacher" label="teacher.labelHigher" required ng-disabled="material.id && !material.canEdit"></hois-autocomplete> </div> <md-input-container flex> <label class="textInput">{{\'studyMaterial.type\' | translate}}</label> <hois-classifier-select ng-model="material.typeCode" main-classifier-code="OPPEMATERJAL" model-value-attr="code" ng-disabled="material.id" ng-change="typeCodeChanged(material.typeCode)" required></hois-classifier-select> </md-input-container> <span ng-if="!material.id && material.typeCode === \'OPPEMATERJAL_F\'"> <md-input-container flex> <lf-ng-md-file-input name="file" lf-files="$parent.files" lf-browse-label="{{\'main.addFile\' | translate}}" lf-remove-label="{{\'main.button.delete\' | translate}}" lf-placeholder="" lf-filesize="5MB" disallow-same-file="addedFiles" lf-required> </lf-ng-md-file-input> </md-input-container> <div ng-messages="studyMaterialForm.file.$error"> <div class="invalid" ng-message="required">{{\'main.messages.error.selectFile\' | translate}}</div> <div class="invalid" ng-message="filesize">{{\'main.messages.error.fileTooLarge\' | translate}} 5MB!</div> <div class="invalid" ng-message="samefile">{{\'main.messages.error.fileAlreadyExists\' | translate}}</div> </div> </span> <md-input-container ng-if="material.typeCode === \'OPPEMATERJAL_L\'" flex> <label>{{\'studyMaterial.link\' | translate}}</label> <input ng-model="material.url" type="text" required ng-disabled="material.id && !material.canEdit"> </md-input-container> <md-input-container flex> <label>{{\'studyMaterial.name\' | translate}}</label> <input ng-model="material.nameEt" type="text" required ng-disabled="material.id && !material.canEdit" md-maxlength="255"> </md-input-container> <md-input-container flex> <label>{{auth.higher ? (\'studyMaterial.descriptionHigher\' | translate) : (\'studyMaterial.descriptionVocational\' | translate)}}</label> <input ng-model="material.descriptionEt" type="text" ng-disabled="material.id && !material.canEdit" md-maxlength="4000"> </md-input-container> <div layout="row"> <md-input-container> <md-checkbox ng-model="material.isVisibleToStudents" ng-disabled="material.isPublic === true || (material.id && !material.canEdit)" aria-label="isVisibleToStudents"> {{\'studyMaterial.isVisibleToStudents\' | translate}} </md-checkbox> </md-input-container> <md-input-container> <md-checkbox ng-model="material.isPublic" aria-label="isPublic" ng-disabled="material.id && !material.canEdit"> {{\'studyMaterial.isPublic\' | translate}} </md-checkbox> </md-input-container> </div> <div layout="row" flex> <md-button class="md-raised md-primary" type="submit" ng-if="!material.id || material.canEdit">{{\'main.button.save\' | translate}}</md-button> <md-button class="md-raised md-default" ng-click="back(backPath)">{{\'main.button.back\' | translate}}</md-button> </div> </form> </div> </div>'),a.put("studyMaterial/study.material.higher.list.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <form name="searchForm" ng-submit="loadData()" novalidate> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label>{{\'subjectStudyPeriod.studyPeriod\' | translate}}</label> <hois-select ng-model="criteria.studyPeriod" values="studyPeriods" required sorted-query="true"></hois-select> </md-input-container> <md-input-container flex="50" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'subjectStudyPeriod.subject\' | translate}}</label> <hois-select ng-model="criteria.subject" type="subject"></hois-select> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <div flex="45" flex-sm="100" flex-xs="100"> <hois-autocomplete flex ng-model="criteria.studentGroup" ha-attribute="id" ha-controller="directiveControllers" ng-search-text="studentGroupSearch" method="studentgroups" name="studentGroup" label="{{\'subjectStudyPeriod.studentGroup\'}}" additional-query-params="{higher: true}"></hois-autocomplete> </div> <div ng-if="auth.isAdmin()" flex="50" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <hois-autocomplete flex ng-model="criteria.teacher" ha-attribute="id" ha-controller="directiveControllers" ng-search-text="teacherSearch" method="teachers" name="teacher" label="{{auth.higher ? \'teacher.labelHigher\' : \'teacher.labelVocational\'}}"></hois-autocomplete> </div> </div> <div layout="row"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> </div> </form> </fieldset> </div> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column>{{\'subjectStudyPeriod.subject\' | translate}}</th> <th md-column>{{\'subjectStudyPeriod.studyPeriod\' | translate}}</th> <th md-column md-order-by="groups">{{\'subjectStudyPeriod.studentGroup\' | translate}}</th> <th md-column>{{\'studyMaterial.count\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{currentLanguageNameField(row.subject)}}</td> <td md-cell>{{currentLanguageNameField(row.studyPeriod)}}</td> <td md-cell>{{row.studentGroups.join(\', \')}}</td> <td md-cell>{{row.materialCount}}</td> <td md-cell> <div ng-if="canEdit"> <md-button md-no-ink class="md-primary change-button" ng-href="#/studyMaterial/higher/{{::row.id}}/edit">{{\'main.button.change\' | translate}}</md-button> </div> <div ng-if="!canEdit"> <md-button md-no-ink class="md-primary change-button" ng-href="#/studyMaterial/higher/{{::row.id}}/view">{{\'main.button.view\' | translate}}</md-button> </div> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> </div>'),a.put("studyMaterial/study.material.journal.edit.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex class="form-readonly"> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="25" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'journal.studyYear\' | translate}}</label> <hois-value value="currentLanguageNameField(journal.studyYear)"></hois-value> </md-input-container> <md-input-container flex="30" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label class="textInput">{{\'journal.label\' | translate}}</label> <hois-value value="journal.nameEt"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="25" flex-sm="100" flex-xs="100"> <label class="textInput">{{auth.higher ? (\'journal.teachersHigher\' | translate) : (\'journal.teachersVocational\' | translate)}}</label> <hois-value value="teachers"></hois-value> </md-input-container> <md-input-container flex="30" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label class="textInput">{{\'studyMaterial.studentGroup\' | translate}}</label> <hois-value value="studentGroups"></hois-value> </md-input-container> </div> </div> <div flex> <div ng-include="\'studyMaterial/templates/journal.material.edit.tmpl.html\'"></div> <div layout="row"> <md-button class="md-raised md-default" href="/#/studyMaterial/vocational/">{{\'main.button.back\' | translate}}</md-button> </div> </div> </div>'),a.put("studyMaterial/study.material.journal.view.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex class="form-readonly"> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="25" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'journal.studyYear\' | translate}}</label> <hois-value value="currentLanguageNameField(journal.studyYear)"></hois-value> </md-input-container> <md-input-container flex="30" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label class="textInput">{{\'journal.label\' | translate}}</label> <hois-value value="journal.nameEt"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="25" flex-sm="100" flex-xs="100"> <label class="textInput">{{auth.higher ? (\'journal.teachersHigher\' | translate) : (\'journal.teachersVocational\' | translate)}}</label> <hois-value value="teachers"></hois-value> </md-input-container> <md-input-container flex="30" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label class="textInput">{{\'studyMaterial.studentGroup\' | translate}}</label> <hois-value value="studentGroups"></hois-value> </md-input-container> </div> </div> <div flex> <div ng-include="\'studyMaterial/templates/journal.material.view.tmpl.html\'"></div> <br> <div layout="row"> <md-button ng-if="auth && !auth.isExternalExpert() && !auth.isMainAdmin()" class="md-raised md-default" ng-click="back(\'/#/students/journals\')">{{\'main.button.back\' | translate}}</md-button> <md-button ng-if="!auth || auth.isExternalExpert() || auth.isMainAdmin()" class="md-raised md-default" ng-click="back(\'/#/timetables\')">{{\'main.button.back\' | translate}}</md-button> </div> </div> </div>'),a.put("studyMaterial/study.material.subjectStudyPeriod.edit.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex class="form-readonly"> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="25" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'subjectStudyPeriod.studyPeriod\' | translate}}</label> <hois-value value="currentLanguageNameField(subjectStudyPeriod.studyPeriod)"></hois-value> </md-input-container> <md-input-container flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label class="textInput">{{\'subjectStudyPeriod.subject\' | translate}}</label> <hois-value value="currentLanguageNameField(subjectStudyPeriod.subject)"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="25" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'subjectStudyPeriod.teacher\' | translate}}</label> <hois-value value="teachers"></hois-value> </md-input-container> <md-input-container flex="30" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label class="textInput">{{\'subjectStudyPeriod.studentGroup\' | translate}}</label> <hois-value value="studentGroups"></hois-value> </md-input-container> </div> </div> <div flex> <div ng-include="\'studyMaterial/templates/subjectStudyPeriod.material.edit.tmpl.html\'"></div> <div layout="row"> <md-button class="md-raised md-default" href="/#/studyMaterial/higher/">{{\'main.button.back\' | translate}}</md-button> </div> </div> </div>'),
a.put("studyMaterial/study.material.subjectStudyPeriod.view.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex class="form-readonly"> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="25" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'subjectStudyPeriod.studyPeriod\' | translate}}</label> <hois-value value="currentLanguageNameField(subjectStudyPeriod.studyPeriod)"></hois-value> </md-input-container> <md-input-container flex="30" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label class="textInput">{{\'subjectStudyPeriod.subject\' | translate}}</label> <hois-value value="currentLanguageNameField(subjectStudyPeriod.subject)"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="25" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'subjectStudyPeriod.teacher\' | translate}}</label> <hois-value value="teachers"></hois-value> </md-input-container> <md-input-container flex="30" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label class="textInput">{{\'subjectStudyPeriod.studentGroup\' | translate}}</label> <hois-value value="studentGroups"></hois-value> </md-input-container> </div> </div> <div flex> <div ng-include="\'studyMaterial/templates/subjectStudyPeriod.material.view.tmpl.html\'"></div> <br> <div layout="row"> <md-button class="md-raised md-default" ng-click="back(\'/#/declaration/current/view\')">{{\'main.button.back\' | translate}}</md-button> </div> </div> </div>'),a.put("studyMaterial/study.material.vocational.edit.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex class="form-readonly"> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="25" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'studyYear.label\' | translate}}</label> <hois-value value="currentLanguageNameField(journal.studyYear)"></hois-value> </md-input-container> <md-input-container flex="30" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label class="textInput">{{\'journal.label\' | translate}}</label> <hois-value value="journal.nameEt"></hois-value> </md-input-container> </div> </div> <div flex> <form name="studyMaterialForm" ng-submit="save()" novalidate layout="column"> <div flex> <hois-autocomplete ng-if="auth.isAdmin()" flex ng-model="$parent.teacher" method="teachers" name="teacher" label="teacher.labelVocational" required ng-disabled="material.id && !material.canEdit"></hois-autocomplete> </div> <md-input-container flex> <label class="textInput">{{\'studyMaterial.type\' | translate}}</label> <hois-classifier-select ng-model="material.typeCode" main-classifier-code="OPPEMATERJAL" model-value-attr="code" ng-disabled="material.id" ng-change="typeCodeChanged(material.typeCode)" required></hois-classifier-select> </md-input-container> <span ng-if="!material.id && material.typeCode === \'OPPEMATERJAL_F\'"> <md-input-container flex> <lf-ng-md-file-input name="file" lf-files="$parent.files" lf-browse-label="{{\'main.addFile\' | translate}}" lf-remove-label="{{\'main.button.delete\' | translate}}" lf-placeholder="" lf-filesize="5MB" disallow-same-file="addedFiles" lf-required> </lf-ng-md-file-input> </md-input-container> <div ng-messages="studyMaterialForm.file.$error"> <div class="invalid" ng-message="required">{{\'main.messages.error.selectFile\' | translate}}</div> <div class="invalid" ng-message="filesize">{{\'main.messages.error.fileTooLarge\' | translate}} 5MB!</div> <div class="invalid" ng-message="samefile">{{\'main.messages.error.fileAlreadyExists\' | translate}}</div> </div> </span> <md-input-container ng-if="material.typeCode === \'OPPEMATERJAL_L\'" flex> <label>{{\'studyMaterial.link\' | translate}}</label> <input ng-model="material.url" type="text" required ng-disabled="material.id && !material.canEdit"> </md-input-container> <md-input-container flex> <label>{{\'studyMaterial.name\' | translate}}</label> <input ng-model="material.nameEt" type="text" required ng-disabled="material.id && !material.canEdit" md-maxlength="255"> </md-input-container> <md-input-container flex> <label>{{auth.higher ? (\'studyMaterial.descriptionHigher\' | translate) : (\'studyMaterial.descriptionVocational\' | translate)}}</label> <input ng-model="material.descriptionEt" type="text" ng-disabled="material.id && !material.canEdit" md-maxlength="4000"> </md-input-container> <div layout="row"> <md-input-container> <md-checkbox ng-model="material.isVisibleToStudents" ng-disabled="material.isPublic === true || (material.id && !material.canEdit)" aria-label="isVisibleToStudents"> {{\'studyMaterial.isVisibleToStudents\' | translate}} </md-checkbox> </md-input-container> <md-input-container> <md-checkbox ng-model="material.isPublic" aria-label="isPublic" ng-disabled="material.id && !material.canEdit"> {{\'studyMaterial.isPublic\' | translate}} </md-checkbox> </md-input-container> </div> <div layout="row" flex> <md-button class="md-raised md-primary" type="submit" ng-if="!material.id || material.canEdit">{{\'main.button.save\' | translate}}</md-button> <md-button class="md-raised md-default" ng-click="back(backPath)">{{\'main.button.back\' | translate}}</md-button> </div> </form> </div> </div>'),a.put("studyMaterial/study.material.vocational.list.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <form name="searchForm" ng-submit="loadData()" novalidate> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label>{{\'studyYear.label\' | translate}}</label> <hois-select ng-model="criteria.studyYear" values="studyYears" required></hois-select> </md-input-container> <div flex="50" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <hois-autocomplete label="journal.label" ng-model="criteria.journalObject" ha-controller="directiveControllers" method="journals" additional-query-params="{studyYear: criteria.studyYear}"></hois-autocomplete> </div> </div> <div layout="row" layout-sm="column" layout-xs="column"> <div flex="45" flex-sm="100" flex-xs="100"> <hois-autocomplete flex ng-model="criteria.studentGroup" ha-attribute="id" ha-controller="directiveControllers" method="studentgroups" name="studentGroup" label="{{\'studyMaterial.studentGroup\'}}" additional-query-params="{higher: false}"></hois-autocomplete> </div> <div ng-if="auth.isAdmin()" flex="50" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <hois-autocomplete flex ng-model="criteria.teacher" ha-attribute="id" ha-controller="directiveControllers" method="teachers" name="teacher" label="{{auth.higher ? \'teacher.labelHigher\' : \'teacher.labelVocational\'}}"></hois-autocomplete> </div> </div> <div layout="row"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> </div> </form> </fieldset> </div> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column>{{\'journal.label\' | translate}}</th> <th md-column>{{\'studyYear.label\' | translate}}</th> <th md-column md-order-by="groups">{{\'studyMaterial.studentGroup\' | translate}}</th> <th md-column>{{\'studyMaterial.count\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{currentLanguageNameField(row)}}</td> <td md-cell>{{currentLanguageNameField(row.studyYear)}}</td> <td md-cell>{{row.studentGroups.join(\', \')}}</td> <td md-cell>{{row.materialCount}}</td> <td md-cell> <div ng-if="canEdit"> <md-button md-no-ink class="md-primary change-button" ng-href="#/studyMaterial/vocational/{{::row.id}}/edit">{{\'main.button.change\' | translate}}</md-button> </div> <div ng-if="!canEdit"> <md-button md-no-ink class="md-primary change-button" ng-href="#/studyMaterial/vocational/{{::row.id}}/view">{{\'main.button.view\' | translate}}</md-button> </div> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> </div>'),a.put("studyYear/study.period.dialog.html",'<md-dialog aria-label="grade add dialog" flex="70" flex-xs="100"> <form name="dialogForm" ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2>{{"studyYear.studyPeriod.heading" | translate}}</h2> <span flex></span> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <span flex></span> <div class="ois-form-layout md-dialog-content" layout="column" flex ng-cloak> <div layout="column" flex> <div layout="row" flex layout-align="center center"> <md-input-container flex="45" class="readonly"> <label class="label">{{\'studyYear.studyPeriod.year\' | translate}}</label> <hois-classifier-value ng-model="studyPeriod.year" model-value-attr="code" main-classifier-code="OPPEAASTA"></hois-classifier-value> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label class="textInput">{{\'studyYear.studyPeriod.type\' | translate}}</label> <hois-classifier-select ng-model="studyPeriod.type" model-value-attr="code" ng-change="typeChange()" required main-classifier-code="OPPEPERIOOD"></hois-classifier-select> </md-input-container> </div> <div layout="column" layout-xs="row"> <md-input-container flex> <label>{{\'studyYear.studyPeriod.nameEt\' | translate}}</label> <input ng-model="studyPeriod.nameEt" type="text" md-maxlength="100" required> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="20" flex-sm="100" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'studyYear.studyPeriod.startDate\' | translate}}</label> <md-datepicker ng-model="studyPeriod.startDate" name="startDate" md-max-date="studyPeriod.endDate" md-min-date="studyYear.startDate" required md-open-on-focus></md-datepicker> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'studyYear.studyPeriod.endDate\' | translate}}</label> <md-datepicker ng-model="studyPeriod.endDate" name="endDate" md-min-date="studyPeriod.startDate" md-max-date="studyYear.endDate" required md-open-on-focus></md-datepicker> </md-input-container> </div> </div> </div> </md-dialog-content> <md-dialog-actions layout="row" layout-align="start center"> <md-button class="md-raised md-primary" ng-click="submit()">{{"main.button.save" | translate}}</md-button> <md-button class="md-raised" ng-click="cancel()">{{"main.button.close" | translate}}</md-button> <md-button class="md-raised" ng-click="delete()" ng-if="studyPeriod.id">{{"main.button.delete" | translate}}</md-button> </md-dialog-actions> </form> </md-dialog>'),a.put("studyYear/study.period.event.dialog.html",'<md-dialog aria-label="grade add dialog" flex="70" flex-xs="100"> <form name="dialogForm" ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2>{{"studyYear.studyPeriodEvent.heading" | translate}}</h2> <span flex></span> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <span flex></span> <div class="ois-form-layout" layout="column" ng-cloak layout-padding> <div class="ois-form-layout md-dialog-content" layout="column" flex ng-cloak> <div layout="column" flex> <div layout="row" flex> <md-input-container flex="45"> <label class="label">{{\'studyYear.studyPeriodEvent.period\' | translate}}</label> <md-select ng-model="studyPeriodEvent.studyPeriod" ng-required="uniqueInStudyPeriod"> <md-option md-option-empty ng-value="null" ng-if="!uniqueInStudyPeriod"></md-option> <md-option ng-repeat="option in studyPeriods" ng-value="option" aria-label="{{$root.currentLanguageNameField(option)}}">{{$root.currentLanguageNameField(option)}}</md-option> </md-select> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label class="textInput">{{\'studyYear.studyPeriodEvent.eventType\' | translate}}</label> <hois-classifier-select ng-model="studyPeriodEvent.eventType" model-value-attr="code" main-classifier-code="SYNDMUS" only-valid ignore-preselected criteria="{higher: auth.school.higher ? true : undefined, vocational: auth.school.vocational ? true : undefined}" required></hois-classifier-select> </md-input-container> </div> </div> <div layout="column" layout-xs="row"> <md-input-container flex> <label>{{\'studyYear.studyPeriodEvent.descriptionEt\' | translate}}</label> <input ng-model="studyPeriodEvent.descriptionEt" type="text" md-maxlength="100" required> </md-input-container> <!--<md-input-container flex>\r\n              <label>{{\'studyYear.studyPeriodEvent.nameEn\' | translate}}</label>\r\n              <input ng-model="studyPeriodEvent.nameEn" type="text" md-maxlength="100">\r\n            </md-input-container>--> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="30" flex-sm="100" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'studyYear.studyPeriodEvent.startDate\' | translate}}</label> <md-datepicker ng-model="studyPeriodEvent.start" md-max-date="studyPeriodEvent.end" required md-open-on-focus></md-datepicker> </md-input-container> <md-input-container flex="30" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'studyYear.studyPeriodEvent.startTime\' | translate}}</label> <hois-time ng-model="studyPeriodEvent.start" name="startTime" placeholder="{{\'main.timePlaceholder\' | translate}}"></hois-time> <div ng-messages="dialogForm.startTime.$error"> <div ng-message="time"> {{\'main.messages.error.time\' | translate}} </div> </div> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="30" flex-sm="100" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'studyYear.studyPeriodEvent.endDate\' | translate}}</label> <md-datepicker ng-model="studyPeriodEvent.end" md-min-date="studyPeriodEvent.start" ng-model-options="{ getterSetter: true }" md-open-on-focus></md-datepicker> </md-input-container> <md-input-container flex="30" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'studyYear.studyPeriodEvent.endTime\' | translate}}</label> <hois-time ng-model="studyPeriodEvent.end" name="endTime" placeholder="{{\'main.timePlaceholder\' | translate}}"></hois-time> <div ng-messages="dialogForm.endTime.$error"> <div ng-message="time"> {{\'main.messages.error.time\' | translate}} </div> </div> </md-input-container> </div> </div> </div> </md-dialog-content> <md-dialog-actions layout="row" layout-align="start center"> <md-button class="md-raised md-primary" ng-click="submit()">{{"main.button.save" | translate}}</md-button> <md-button class="md-raised" ng-click="cancel()">{{"main.button.close" | translate}}</md-button> <md-button class="md-raised" ng-click="delete()" ng-if="studyPeriodEvent.id">{{"main.button.delete" | translate}}</md-button> </md-dialog-actions> </form> </md-dialog>'),a.put("studyYear/study.year.edit.html",'<!--FIXME: IE does not show this form correctly--> <div class="ois-form-layout" layout="column" layout-margin ng-cloak> <form name="schoolYearForm" layout="column"> <div layout="column" flex> <div layout="row" layout-sm="column" layout-xs="column" class="form-readonly"> <md-input-container flex> <label class="label">{{\'studyYear.year\' | translate}}</label> <hois-classifier-value ng-model="studyYear.year" main-classifier-code="OPPEAASTA"></hois-classifier-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container> <label>{{\'studyYear.startDate\' | translate}}</label> <md-datepicker ng-model="studyYear.startDate" md-max-date="studyYear.endDate" ng-disabled="!canEdit" required md-open-on-focus></md-datepicker> </md-input-container> <md-input-container> <label>{{\'studyYear.endDate\' | translate}}</label> <md-datepicker ng-model="studyYear.endDate" md-min-date="studyYear.startDate" ng-disabled="!canEdit" required md-open-on-focus></md-datepicker> </md-input-container> <div> <md-button ng-click="update()" ng-if="canEdit" class="md-raised md-primary">{{\'main.button.save\' | translate}}</md-button> </div> </div> </div> <div ng-if="studyYear.id" layout="column" flex> <div>&nbsp;</div> <fieldset tabindex="1"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'studyYear.studyPeriods\' | translate}}</legend> <md-button class="md-raised" ng-if="canEdit" ng-click="openStudyPeriodDialog()">{{\'main.button.create\' | translate}}</md-button> <div layout="row"> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'studyYear.studyPeriod.type\' | translate}}</th> <th md-column>{{\'studyYear.studyPeriod.name\' | translate}}</th> <th md-column>{{\'studyYear.studyPeriod.startDate\' | translate}}</th> <th md-column>{{\'studyYear.studyPeriod.endDate\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="item in studyPeriods | orderBy: [\'startDate\', \'endDate\', \'id\']" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{currentLanguageNameField(item.type)}}</td> <td md-cell>{{currentLanguageNameField(item)}}</td> <td md-cell>{{item.startDate | hoisDate}}</td> <td md-cell>{{item.endDate | hoisDate}}</td> <td md-cell><md-button ng-if="canEdit" ng-click="openStudyPeriodDialog(item)" class="md-primary change-button">{{\'main.button.change\' | translate}}</md-button></td> </tr> </tbody> </table> </div> </fieldset> <div>&nbsp;</div> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'studyYear.studyPeriodEvents\' | translate}}</legend> <md-button class="md-raised" ng-if="canEdit" ng-click="openStudyPeriodEventDialog()">{{\'main.button.create\' | translate}}</md-button> <div layout="row"> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'studyYear.studyPeriodEvent.period\' | translate}}</th> <th md-column>{{\'studyYear.studyPeriodEvent.eventType\' | translate}}</th> <th md-column>{{\'studyYear.studyPeriodEvent.description\' | translate}}</th> <th md-column>{{\'studyYear.studyPeriodEvent.start\' | translate}}</th> <th md-column>{{\'studyYear.studyPeriodEvent.end\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="item in studyPeriodEvents | orderBy: [\'start\', \'end\', \'id\']" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{currentLanguageNameField(item.studyPeriod)}}</td> <td md-cell>{{currentLanguageNameField(eventTypes[item.eventType])}}</td> <td md-cell>{{currentLanguage()===\'en\' ?(item.descriptionEn || item.descriptionEt) : item.descriptionEt}}</td> <td md-cell>{{item.start | hoisDateTimeMin}}</td> <td md-cell>{{item.end | hoisDateTimeMin}}</td> <td md-cell><md-button ng-if="canEdit" ng-click="openStudyPeriodEventDialog(item)" class="md-primary change-button">{{\'main.button.change\' | translate}}</md-button></td> </tr> </tbody> </table> </div> </fieldset> </div> <div layout="row"> <md-button ng-href="#/school/studyYears" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </div> </form> </div>'),a.put("studyYear/study.year.list.html",'<div layout-padding> <div flex> <md-table-container> <table md-table md-progress="endpoint.$promise"> <thead md-head> <tr md-row> <th md-column>{{\'studyYear.year\' | translate}}</th> <th md-column>{{\'studyYear.startDate\' | translate}}</th> <th md-column>{{\'studyYear.endDate\' | translate}}</th> <th md-column>{{\'studyYear.periods\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell> <span ng-if="!row.id">{{currentLanguageNameField(row)}}</span> <a md-no-ink ng-if="row.id" class="md-primary change-button" ng-href="#/school/studyYears/{{::row.id}}/view">{{currentLanguageNameField(row)}}</a> </td> <td md-cell>{{row.startDate | hoisDate}}</td> <td md-cell>{{row.endDate | hoisDate}}</td> <td md-cell>{{::row.count}}</td> <td md-cell> <md-button md-no-ink class="md-primary change-button" ng-if="!row.id && canEdit" ng-href="#/school/studyYears/{{::row.code}}/new">{{\'main.button.change\' | translate}}</md-button> <md-button md-no-ink class="md-primary change-button" ng-if="row.id && canEdit" ng-href="#/school/studyYears/{{::row.id}}/edit">{{\'main.button.change\' | translate}}</md-button> <md-button md-no-ink class="md-primary change-button" ng-if="row.id && !canEdit" ng-href="#/school/studyYears/{{::row.id}}/view">{{\'main.button.view\' | translate}}</md-button> </td> </tr> </tbody> </table> </md-table-container> </div> </div>'),a.put("studyYear/study.year.view.html",'<!--FIXME: IE does not show this form correctly--> <div class="ois-form-layout form-readonly" layout="column" layout-margin ng-cloak> <form name="schoolYearForm" layout="column"> <div layout="column" flex> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex> <label class="label">{{\'studyYear.year\' | translate}}</label> <hois-classifier-value ng-model="studyYear.year" main-classifier-code="OPPEAASTA"></hois-classifier-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column" flex> <md-input-container flex="20"> <label>{{\'studyYear.startDate\' | translate}}</label> <hois-value value="studyYear.startDate | hoisDate"></hois-value> </md-input-container> <md-input-container flex="20" flex-offset="5"> <label>{{\'studyYear.endDate\' | translate}}</label> <hois-value value="studyYear.endDate | hoisDate"></hois-value> </md-input-container> </div> </div> <div ng-if="studyYear.id" layout="column" flex> <div>&nbsp;</div> <fieldset tabindex="1"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'studyYear.studyPeriods\' | translate}}</legend> <div layout="row"> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'studyYear.studyPeriod.type\' | translate}}</th> <th md-column>{{\'studyYear.studyPeriod.name\' | translate}}</th> <th md-column>{{\'studyYear.studyPeriod.startDate\' | translate}}</th> <th md-column>{{\'studyYear.studyPeriod.endDate\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="item in studyPeriods | orderBy: [\'startDate\', \'endDate\', \'id\']" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{currentLanguageNameField(item.type)}}</td> <td md-cell>{{currentLanguageNameField(item)}}</td> <td md-cell>{{item.startDate | hoisDate}}</td> <td md-cell>{{item.endDate | hoisDate}}</td> </tr> </tbody> </table> </div> </fieldset> <div>&nbsp;</div> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'studyYear.studyPeriodEvents\' | translate}}</legend> <div layout="row"> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'studyYear.studyPeriodEvent.period\' | translate}}</th> <th md-column>{{\'studyYear.studyPeriodEvent.eventType\' | translate}}</th> <th md-column>{{\'studyYear.studyPeriodEvent.description\' | translate}}</th> <th md-column>{{\'studyYear.studyPeriodEvent.start\' | translate}}</th> <th md-column>{{\'studyYear.studyPeriodEvent.end\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="item in studyPeriodEvents | orderBy: [\'start\', \'end\', \'id\']" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{currentLanguageNameField(item.studyPeriod)}}</td> <td md-cell>{{currentLanguageNameField(eventTypes[item.eventType])}}</td> <td md-cell>{{currentLanguage()===\'en\' ?(item.descriptionEn || item.descriptionEt) : item.descriptionEt}}</td> <td md-cell>{{item.start | hoisDateTimeMin}}</td> <td md-cell>{{item.end | hoisDateTimeMin}}</td> </tr> </tbody> </table> </div> </fieldset> </div> <div layout="row"> <md-button ng-if="canEdit" ng-href="#/school/studyYears/{{::studyYear.id}}/edit" class="md-raised md-primary">{{\'main.button.edit\' | translate}}</md-button> <md-button ng-href="#/school/studyYears" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </div> </form> </div>'),a.put("studyYearSchedule/study.year.schedule.add.dialog.html",'<md-dialog aria-label="module add dialog" flex="40" flex-sm="80" flex-xs="100"> <form name="dialogForm" ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2>{{"studyYearSchedule.studentGroup" | translate}} {{studentGroup.code}}</h2> <span flex></span> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <span flex></span> <div class="ois-form-layout" layout="column" layout-margin ng-cloak> <span flex></span> <h2>{{week.weekNr}}. {{"studyYearSchedule.week" | translate}}: {{week.start | hoisDate}} - {{week.end | hoisDate}}</h2> <br> <md-input-container> <md-radio-group ng-model="data.legend"> <span class="label">{{\'studyYearSchedule.studyType\' | translate}}</span> <md-input-container> <md-input-container> <md-radio-button ng-value="null" aria-label="{{ \'select color\' }}"> <div class="colorCell" style="background: \'white\'"></div> </md-radio-button> </md-input-container> <md-input-container ng-repeat="legend in legends"> <md-radio-button ng-value="legend.id" aria-label="{{ \'select color\' }}"> <div class="colorCell" ng-style="{ background: true ? legend.color : \'white\', color: legend.brightText ? \'white\' : \'black\'  }"> <span>&nbsp;{{ legend.code }}</span> </div> </md-radio-button> </md-input-container> </md-input-container> </md-radio-group> </md-input-container> <br> <div layout="row"> <md-input-container flex="35" flex-sm="50" flex-xs="50"> <label>{{\'studyYearSchedule.durationInWeeks\' | translate}}</label> <input type="number" ng-model="data.weeks" min="1" max="{{translationData.weeks}}" required name="weeks" step="1" pattern="^\\d+$"> <div ng-messages="dialogForm.weeks.$error" ng-show="dialogForm.weeks.$dirty"> <div ng-message="min"> {{\'studyYearSchedule.error.minWeeks\' | translate}} </div> <div ng-message="max"> {{\'studyYearSchedule.error.maxWeeks\' | translate:translationData}} </div> <div ng-message="pattern"> {{\'main.messages.error.integer\' | translate}} </div> </div> </md-input-container> </div> <div layout="column" flex> <md-input-container flex> <label>{{\'studyYearSchedule.addInfo\' | translate}}</label> <textarea ng-model="data.addInfo" md-maxlength="4000" md-autofocus></textarea> </md-input-container> </div> <span flex></span> </div> </md-dialog-content> <md-dialog-actions layout="row" layout-align="start center"> <md-button class="md-raised md-primary" ng-click="submit()">{{hasValue ? "main.button.change" : "main.button.add" | translate}}</md-button> <md-button class="md-raised" ng-click="cancel()">{{"main.button.close" | translate}}</md-button> </md-dialog-actions> </form> </md-dialog> <style>.colorCell {\r\n    width: 20px;\r\n    height: 20px;\r\n    border: 1px solid black;\r\n  }\r\n\r\n  md-radio-button {\r\n    padding-right: 20px;\r\n  }</style>'),a.put("studyYearSchedule/study.year.schedule.html",'<md-table-container> <table md-table class="secondary-table" ng-if="legends.length > 0"> <thead md-head> <tr md-row> <th md-column>{{\'studyYearScheduleLegend.code\' | translate}}</th> <th md-column>{{\'studyYearScheduleLegend.nameEt\' | translate}}</th> <th md-column>{{\'studyYearScheduleLegend.nameEn\' | translate}}</th> <th md-column>{{\'studyYearScheduleLegend.color\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="item in legends" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{item.code}}</td> <td md-cell>{{item.nameEt}}</td> <td md-cell>{{item.nameEn}}</td> <td md-cell> <color-picker ng-model="item.color" options="colorOptions"></color-picker> </td> </tr> </tbody> </table> </md-table-container> <!--FIXME: this form is slow in IE--> <div layout="column" layout-padding> <form name="studyYearScheduleForm"> <div layout="column"> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="50" flex-sm="100" flex-xs="100"> <label>{{\'studyYearSchedule.studyYear\' | translate}}</label> <md-select ng-model="criteria.studyYear" md-on-close="yearSelectionTrigger()"> <md-option ng-value="option" ng-repeat="option in studyYears"> <hois-classifier-value ng-model="option.year" main-classifier-code="OPPEAASTA"></hois-classifier-value> </md-option> </md-select> </md-input-container> <md-input-container flex="45" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'studyYearSchedule.schoolDepartment\' | translate}}</label> <md-select ng-model="criteria.schoolDepartments" ng-disabled="criteria.showMine" ng-change="schoolDepartmentsChanged()" aria-label="{{\'certificate.signatory\' | translate}}" multiple> <md-option ng-value="department.id" ng-repeat="department in schoolDepartments | orderBy: \'!valid\'">{{currentLanguageNameField(department)}}</md-option> </md-select> </md-input-container> </div> <br> <div layout="row" layout-sm="column" layout-xs="column" ng-if="useMyFilter"> <div flex="50" flex-sm="100" flex-xs="100"> <md-checkbox ng-model="criteria.showMine" ng-change="showMineChanged()" aria-label="{{\'studyYearSchedule.showMine\' | translate}}"> {{\'studyYearSchedule.showMine\' | translate}} </md-checkbox> </div> <br> </div> <md-table-container style="overflow: auto" ng-cloak class="container" fixed-column-table fixed-columns="3"> <table ng-cloak class="lessonplan"> <thead> <tr class="schedule"> <th class="studentGroup schedule" colspan="3"></th> <th class="schedule hois-collapse-header" ng-repeat="studyPeriod in criteria.studyYear.studyPeriods" colspan="{{studyPeriod.weeks}}"> {{currentLanguageNameField(studyPeriod)}} </th> </tr> <tr> <th class="schedule studentGroup" colspan="3"></th> <th class="schedule weekCell weekNr" ng-repeat="week in weeks"> {{$index + 1}} <md-tooltip> {{week.start | hoisDate}} - {{week.end | hoisDate}} </md-tooltip> </th> </tr> </thead> <tbody ng-repeat="department in schoolDepartments | filter: filterSchoolDepartments"> <tr> <td colspan="3" colspan="{{weeks.length + 1}}" class="hois-collapse-header fixed-cell dividerBorder">{{currentLanguageNameField(department)}}</td> <td colspan="53" class="dividerBorder" style="border-right: 1px solid #ccc !important"></td> </tr> <tr class="dividerBorder" ng-repeat="sg in studentGroups | filter: filterStudentGroups(department)" ng-init="refreshHeight()"> <td colspan="3" class="schedule fixed-cell dividerBorder">{{sg.code}}</td> <!--\r\n                                style="background: { getLegendById(getSchedule(sg.id, week.weekNr).studyYearScheduleLegend).color}"\r\n                                Was not used insted of ng-style as VS code marked curly braces as error(css property expected),\r\n                                though it did not cause an error on "grunt build" on local machine\r\n\r\n                                ng-if="!isPastStudyYear" was used, because in case of past study year, it should not become bold when clicked\r\n                            --> <td ng-if="!isPastStudyYear" ng-repeat="week in weeks" ng-click="openAddScheduleDialog(sg, week, getSchedule(sg.id, week.weekNr))" ng-style="{ background: true ? getLegendById(getSchedule(sg.id, week.weekNr).studyYearScheduleLegend).color : \'white\', color: getLegendById(getSchedule(sg.id, week.weekNr).studyYearScheduleLegend).brightText ? \'white\' : \'black\' }" title="{{getSchedule(sg.id, week.weekNr).addInfo}}"> {{getLegendById(getSchedule(sg.id, week.weekNr).studyYearScheduleLegend).code}} </td> <td ng-if="isPastStudyYear" ng-repeat="week in weeks" ng-style="{ background: true ? getLegendById(getSchedule(sg.id, week.weekNr).studyYearScheduleLegend).color : \'white\', color: getLegendById(getSchedule(sg.id, week.weekNr).studyYearScheduleLegend).brightText ? \'white\' : \'black\' }" title="{{getSchedule(sg.id, week.weekNr).addInfo}}"> {{getLegendById(getSchedule(sg.id, week.weekNr).studyYearScheduleLegend).code}} </td> </tr> </tbody> </table> </md-table-container> <div layout="row"> <md-button class="md-raised md-primary" ng-if="canEdit" ng-click="save()" ng-show="!isPastStudyYear">{{\'main.button.save\' | translate}}</md-button> <a ng-href="{{exportUrl(formState.pdfUrl)}}" target="_blank" class="md-button md-raised"> {{\'main.button.printPdf\' | translate}} </a> <a ng-href="{{exportUrl(formState.xlsUrl)}}" target="_blank" class="md-button md-raised"> {{\'main.button.printXls\' | translate}} </a> </div> </div> </form> </div> <style>table.schedule,\r\n  \r\n  th.schedule,\r\n  td.schedule {\r\n    border-collapse: collapse;\r\n  }\r\n\r\n\r\n  .studentGroup {\r\n    width: 100px;\r\n  }\r\n\r\n  .weekCell {\r\n    width: 30px;\r\n  }\r\n\r\n  .schoolDepartment {\r\n    font-weight: bold;\r\n  }\r\n\r\n  .weekNr {\r\n    font-weight: normal;\r\n  }</style>'),
a.put("studyYearSchedule/study.year.schedule.legend.html",'<!--FIXME: type color is not supported in IE 11--> <div class="ois-form-layout-padding" layout="row" flex="100" flex-sm="100" flex-xs="100" ng-if="defaultLegends"> <span class="common-label">{{\'studyYearScheduleLegend.defaultLegend\' | translate}}</span> </div> <md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column style="width:10%">{{\'studyYearScheduleLegend.code\' | translate}}</th> <th md-column style="width:30%">{{\'studyYearScheduleLegend.nameEt\' | translate}}</th> <th md-column style="width:30%">{{\'studyYearScheduleLegend.nameEn\' | translate}}</th> <th md-column style="width:20%">{{\'studyYearScheduleLegend.color\' | translate}}</th> <th md-column style="width:10%"></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="item in legends" ng-class-odd="\'odd\'" ng-class-even="\'even\'" ng-click="changeEditable(item)"> <td md-cell> <span ng-class="{invalid: formSubmitted && !codeIsValid(item)}" ng-if="!item.edited">{{item.code}}</span> <md-input-container ng-if="item.edited"> <input ng-model="item.code" class="small-input" type="text" max="2" md-max-length="2"> </md-input-container> </td> <td md-cell> <span ng-class="{invalid: formSubmitted && !nameEtIsValid(item)}" ng-if="!item.edited">{{item.nameEt}}</span> <md-input-container ng-if="item.edited"> <input ng-model="item.nameEt" class="small-input" type="text"> </md-input-container> </td> <td md-cell> <span ng-class="{invalid: formSubmitted && !nameEnIsValid(item)}" ng-if="!item.edited">{{item.nameEn}}</span> <md-input-container ng-if="item.edited"> <input ng-model="item.nameEn" class="small-input" type="text"> </md-input-container> </td> <td md-cell> <div class="color-container"> <color-picker ng-model="item.colorPicker" options="colorOptions" ng-model-options="{ getterSetter: true }"></color-picker> </div> </td> <td md-cell> <md-button class="remove nomargin" ng-if="canEdit" ng-click="remove(item)">&times;</md-button> </td> </tr> <tr md-row class="odd"> <td md-cell colspan="5" style="padding-bottom: 100px"> <!-- "Fixes" problem with table cell absolute position and table overflow hidden --> <md-button class="md-primary" ng-if="canEdit" ng-click="addRow()">{{\'main.button.addNewRow\' | translate}}</md-button> <br><br> <md-button class="md-raised md-primary" ng-if="canEdit" ng-click="checkErrorsAndSave()">{{\'main.button.save\' | translate}}</md-button> </td> </tr> </tbody> </table> </md-table-container> <style>.color-container {\r\n        display: inline-block;\r\n    }\r\n    md-table-container .md-button {\r\n        text-transform: none;\r\n    }</style>'),a.put("subject/subject.edit.html",'<div class="ois-form-layout" layout="column" layout-margin ng-cloak> <form name="subjectForm" layout="column"> <md-input-container> <label>{{\'subject.code\' | translate}}</label> <input ng-model="subject.code" name="code" type="text" md-maxlength="20" ng-required="true" ng-model-options="{ debounce: 250 }" unique="subjectCodeUniqueQuery"> <div ng-messages="subjectForm.code.$error"> <div ng-message="notUnique"> {{\'subject.alreadyexist\' | translate}} </div> </div> </md-input-container> <md-input-container> <label>{{\'subject.nameEt\' | translate}}</label> <input ng-model="subject.nameEt" type="text" md-maxlength="255" ng-required="true"> </md-input-container> <md-input-container> <label>{{\'subject.nameEn\' | translate}}</label> <input ng-model="subject.nameEn" type="text" md-maxlength="255" ng-required="true"> </md-input-container> <md-input-container> <label>{{\'subject.credits\' | translate}}</label> <input name="credits" ng-model="subject.credits" type="number" ng-required="true" step="0.1" max="999" min="0.1"> <div ng-messages="subjectForm.credits.$error" ng-show="subjectForm.credits.$dirty"> <div ng-message="max"> {{\'main.messages.error.max\' | translate: {max: 999} }} </div> <div ng-message="min"> {{\'main.messages.error.min\' | translate: {min: 0.1} }} </div> </div> </md-input-container> <md-input-container> <label>{{\'subject.assessment\' | translate}}</label> <hois-classifier-select ng-model="subject.assessment" model-value-attr="code" main-classifier-code="HINDAMISVIIS" ng-required="true"></hois-classifier-select> </md-input-container> <md-input-container> <label>{{\'subject.assessmentDescription\' | translate}}</label> <textarea ng-model="subject.assessmentDescription" md-maxlength="10000" max-rows="2"></textarea> </md-input-container> <md-input-container> <label>{{\'subject.language\' | translate}}</label> <hois-classifier-select ng-model="subject.languages" model-value-attr="code" main-classifier-code="OPPEKEEL" criteria="{higher: true}" multiple></hois-classifier-select> </md-input-container> <md-input-container> <label>{{\'subject.objectivesEt\' | translate}}</label> <textarea ng-model="subject.objectivesEt" md-maxlength="10000" max-rows="2" ng-required="true"></textarea> </md-input-container> <md-input-container> <label>{{\'subject.objectivesEn\' | translate}}</label> <textarea ng-model="subject.objectivesEn" md-maxlength="10000" max-rows="2" ng-required="true"></textarea> </md-input-container> <md-input-container> <label>{{\'subject.outcomesEt\' | translate}}</label> <textarea ng-model="subject.outcomesEt" md-maxlength="10000" max-rows="2" ng-required="true"></textarea> </md-input-container> <md-input-container> <label>{{\'subject.outcomesEn\' | translate}}</label> <textarea ng-model="subject.outcomesEn" md-maxlength="10000" max-rows="2" ng-required="true"></textarea> </md-input-container> <md-input-container> <label>{{\'subject.descriptionEt\' | translate}}</label> <textarea ng-model="subject.descriptionEt" md-maxlength="4000" max-rows="2"></textarea> </md-input-container> <md-input-container> <label>{{\'subject.descriptionEn\' | translate}}</label> <textarea ng-model="subject.descriptionEn" md-maxlength="4000" max-rows="2"></textarea> </md-input-container> <md-input-container> <label>{{\'subject.independentStudyEt\' | translate}}</label> <textarea ng-model="subject.independentStudyEt" md-maxlength="4000" max-rows="2"></textarea> </md-input-container> <md-input-container> <label>{{\'subject.independentStudyEn\' | translate}}</label> <textarea ng-model="subject.independentStudyEn" md-maxlength="4000" max-rows="2"></textarea> </md-input-container> <md-input-container> <label>{{\'subject.studyLiterature\' | translate}}</label> <textarea ng-model="subject.studyLiterature" md-maxlength="4000" max-rows="2"></textarea> </md-input-container> <md-input-container> <label>{{\'subject.evaluationEt\' | translate}}</label> <textarea ng-model="subject.evaluationEt" md-maxlength="10000" max-rows="2"></textarea> </md-input-container> <md-input-container> <label>{{\'subject.evaluationEn\' | translate}}</label> <textarea ng-model="subject.evaluationEn" md-maxlength="10000" max-rows="2"></textarea> </md-input-container> <md-input-container> <label>{{\'subject.additionalInfo\' | translate}}</label> <textarea ng-model="subject.additionalInfo" md-maxlength="4000" max-rows="2"></textarea> </md-input-container> <div>&nbsp;</div> <div layout="column"> <fieldset tabindex="1"> <legend md-colors="{color: \'default-primary-800\'}" class="md-title-small">{{\'subject.prerequisiteAndSubstituteSubjects\' | translate}}</legend> <h3>{{\'subject.mandatoryPrerequisiteSubjects\' | translate}}</h3> <hois-autocomplete ng-model="mandatoryPrerequisiteSubject" label="subject.label" method="subjects" md-selected-item-change="addSubject(SUBJECT_TYPE.MANDATORY_PREPEQUISITE)"></hois-autocomplete> <div layout="column" class="common-label" flex="95" ng-repeat="sub in subject.mandatoryPrerequisiteSubjects | orderBy: [\'sub.\' + currentLanguageNameField(), \'code\']"> <div layout="row" flex layout-align="start center"> <div flex="50"><a ng-href="#/subject/{{sub.id}}">{{currentLanguageNameField(sub)}}</a></div> <div> <a ng-click="deleteSubject(SUBJECT_TYPE.MANDATORY_PREPEQUISITE, sub)" class="remove">&times;</a> </div> </div> </div> <md-divider></md-divider> <h3>{{\'subject.recommendedPrerequisiteSubjects\' | translate}}</h3> <hois-autocomplete ng-model="recommendedPrerequisiteSubject" label="subject.label" method="subjects" md-selected-item-change="addSubject(SUBJECT_TYPE.RECOMMENDED_PREREQUISITE)"></hois-autocomplete> <div layout="column" class="common-label" flex="95" ng-repeat="sub in subject.recommendedPrerequisiteSubjects | orderBy: [\'sub.\' + currentLanguageNameField(), \'code\']"> <div layout="row" flex layout-align="start center"> <div flex="50"><a ng-href="#/subject/{{sub.id}}">{{currentLanguageNameField(sub)}}</a></div> <div> <a ng-click="deleteSubject(SUBJECT_TYPE.RECOMMENDED_PREREQUISITE, sub)" class="remove">&times;</a> </div> </div> </div> <md-divider></md-divider> <h3>{{\'subject.substituteSubjects\' | translate}}</h3> <hois-autocomplete ng-model="substituteSubject" label="subject.label" method="subjects" md-selected-item-change="addSubject(SUBJECT_TYPE.SUBSTITUTE)"></hois-autocomplete> <div layout="column" class="common-label" flex="95" ng-repeat="sub in subject.substituteSubjects | orderBy: [\'sub.\' + currentLanguageNameField(), \'code\']"> <div layout="row" flex layout-align="start center"> <div flex="50"><a ng-href="#/subject/{{sub.id}}">{{currentLanguageNameField(sub)}}</a></div> <div> <a ng-click="deleteSubject(SUBJECT_TYPE.SUBSTITUTE, sub)" class="remove">&times;</a> </div> </div> </div> </fieldset> </div> <div>&nbsp;</div> <md-input-container> <label>{{\'subject.linkDepartment\' | translate}}</label> <hois-select ng-model="subject.schoolDepartment.id" values="departments"></hois-select> </md-input-container> <br> <md-input-container> <md-checkbox ng-model="subject.isPractice"> {{\'subject.isPractice\' | translate}} </md-checkbox> </md-input-container> <md-input-container class="top-margin readonly"> <label>{{\'subject.status\' | translate}}</label> <hois-classifier-value ng-model="subject.status" main-classifier-code="AINESTAATUS"></hois-classifier-value> </md-input-container> <!-- info tund --> <div flex ng-show="subject.primarySubjects.length > 0"> <fieldset tabindex="2"> <legend md-colors="{color: \'default-primary-800\'}" class="md-title-small">{{\'subject.subjectIsPrerequisite\' | translate}}</legend> <div ng-repeat="row in subject.primarySubjects | orderBy: currentLanguageNameField()"> <a class="md-body-1" ng-href="#/subject{{isPublic ? \'/public\' : \'\'}}/{{row.id}}">{{currentLanguageNameField(row)}}</a> </div> </fieldset> </div> <div flex ng-show="subject.curriculumVersions.length > 0"> <div>&nbsp;</div> <fieldset tabindex="3"> <legend md-colors="{color: \'default-primary-800\'}" class="md-title-small">{{\'subject.belongsCurriculum\' | translate}}</legend> <div ng-repeat="row in subject.curriculumVersions | orderBy: currentLanguageNameField()"> <span class="md-body-1">{{currentLanguageNameField(row) }}</span> </div> </fieldset> </div> <div flex ng-if="subject.programs && subject.programs.length > 0"> <div>&nbsp;</div> <fieldset tabindex="4"> <legend md-colors="{color: \'default-primary-800\'}" class="md-title-small">{{\'subject.subjectProgram.label\' | translate}}</legend> <div layout="column"> <md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'subject.subjectProgram.teacher\' | translate}}</th> <th md-column>{{\'subject.subjectProgram.studyPeriod\' | translate}}</th> <th md-column>{{\'subject.subjectProgram.status\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="program in subject.programs"> <td md-cell><a href="#/subjectProgram/periods/{{::program.id}}/view">{{program.teacherName}}</a></td> <td md-cell><a href="#/subjectProgram/periods/{{::program.id}}/view">{{currentLanguageNameField(program.studyPeriod)}}</a></td> <td md-cell><hois-classifier-value ng-model="program.status" main-classifier-code="AINEPROGRAMM_STAATUS"></hois-classifier-value></td> </tr> </tbody> </table> </md-table-container> </div> </fieldset> </div> <div>&nbsp;</div> <hois-created-modified object="subject"></hois-created-modified> <div layout="row" layout-xs="column"> <md-button ng-click="update()" class="md-raised md-primary">{{\'main.button.save\' | translate}}</md-button> <md-button ng-if="subject.canSetActive" ng-click="saveAndConfirm()" class="md-raised">{{\'subject.activate\' | translate}}</md-button> <md-button ng-if="subject.canSetPassive" ng-click="saveAndUnconfirm()" class="md-raised">{{\'subject.passive\' | translate}}</md-button> <md-button ng-if="subject.canDelete" ng-click="delete()" class="md-raised">{{\'main.button.delete\' | translate}}</md-button> <md-button ng-click="back(formState.backUrl, subjectForm)" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </div> </form> </div>'),a.put("subject/subject.list.html",'<div flex-xs="100" flex-gt-xs="100" flex-gt-sm="100" class="ois-form-layout-padding ois-form-layout" ng-cloak> <!--<div class="ois-form-layout" layout="column" layout-margin ng-cloak>--> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <form ng-submit="loadData()" novalidate> <div layout="column"> <div layout="row" ng-if="isPublic"> <md-input-container flex> <label>{{\'school.label\' | translate}}</label> <hois-select ng-model="criteria.schoolId" type="school"></hois-select> </md-input-container> </div> <div layout="row"> <md-input-container flex> <label class="textInput">{{\'subject.name\' | translate}}</label> <input ng-model="criteria.name" type="text" autofocus> </md-input-container> </div> <div layout="row"> <md-input-container flex> <label class="textInput">{{\'subject.code\' | translate}}</label> <input ng-model="criteria.code" type="text"> </md-input-container> <div flex-xs="0" flex-gt-sm="10"></div> <md-input-container flex> <label>{{\'subject.assessment\' | translate}}</label> <hois-classifier-select ng-model="criteria.assessments" model-value-attr="code" main-classifier-code="HINDAMISVIIS" multiple></hois-classifier-select> </md-input-container> </div> <div layout="row"> <md-input-container flex> <label>{{\'subject.curriculum\' | translate}}</label> <md-select ng-model="criteria.curriculaVersion" multiple> <md-option ng-repeat="it in curricula" value="{{it.id}}" style="font-size: medium"> {{currentLanguageNameField(it)}} </md-option> </md-select> </md-input-container> </div> <div layout="column"> <label class="common-label" style="padding-bottom:12px"> {{\'subject.credits\' | translate}}</label> <div layout="row" flex> <div layout="column" flex> <div layout-gt-xs="row" flex="45" flex-xs="100"> <md-input-container flex> <label>{{\'main.from\' | translate}}</label> <input type="number" ng-model="criteria.from" min="0" step="0.1"> </md-input-container> <md-input-container flex> <label>{{\'main.thru\' | translate}}</label> <input type="number" ng-model="criteria.thru" min="0" step="0.1"> </md-input-container> </div> </div> <div flex-xs="0" flex-gt-sm="10"></div> <div layout="column" flex> <md-input-container flex> <label>{{\'school.department.department\' | translate}}</label> <md-select ng-model="criteria.departments" multiple> <md-option ng-repeat="department in departments" ng-value="department.id"> {{currentLanguageNameField(department)}} </md-option> </md-select> </md-input-container> </div> </div> <div layout="row" flex> <div layout="column" flex> <md-input-container ng-show="formState.canViewAll"> <label>{{\'subject.status\' | translate}}</label> <hois-classifier-select ng-model="criteria.status" model-value-attr="code" main-classifier-code="AINESTAATUS" multiple></hois-classifier-select> </md-input-container> </div> <div flex-xs="0" flex-gt-sm="10"></div> <div layout="column" flex> <md-input-container> <label>{{\'subject.language\' | translate}}</label> <hois-classifier-select ng-model="criteria.languages" model-value-attr="code" main-classifier-code="OPPEKEEL" criteria="{higher: true}" multiple></hois-classifier-select> </md-input-container> </div> </div> </div> <div layout="row" layout-xs="column"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> <md-button class="md-raised" ng-href="#/subject/new" ng-if="formState.canCreate">{{\'main.button.create\' | translate}}</md-button> </div> </div> </form> </fieldset> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="{{\'school.\'+currentLanguageNameField()}}" ng-if="isPublic"><span>{{\'school.label\' | translate}}</span></th> <th md-column md-order-by="{{currentLanguageNameField()}}"><span>{{\'subject.name\' | translate}}</span></th> <th md-column md-order-by="code"><span>{{\'subject.code\' | translate}}</span></th> <th md-column md-order-by="credits"><span>{{\'subject.creditsEap\' | translate}}</span></th> <th md-column md-order-by="{{currentLanguage(\'assessment\')===\'en\' ? \'assessment.nameEn\' : \'assessment.nameEt\'}}">{{\'subject.assessment\' | translate}}</th> <th md-column>{{\'subject.language\' | translate}}</th> <th md-column md-order-by="{{currentLanguage()===\'en\' ? \'status.nameEn\' : \'status.nameEt\'}}" ng-if="formState.canViewAll">{{\'subject.status\' | translate}}</th> <th md-column md-order-by="{{currentLanguage()===\'en\' ? \'schoolDepartment.nameEn\' : \'schoolDepartment.nameEt\'}}">{{\'school.department.department\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell ng-if="isPublic">{{currentLanguageNameField(row.school)}}</td> <td md-cell><a ng-href="#/subject{{isPublic ? \'/public\' : \'\'}}/{{::row.id}}">{{currentLanguageNameField(row)}}</a></td> <td md-cell>{{::row.code}}</td> <td md-cell>{{::row.credits}}</td> <td md-cell>{{currentLanguageNameField(row.assessment)}}</td> <td md-cell>{{subjectLanguages(row.languages)}}</td> <td md-cell ng-if="formState.canViewAll">{{currentLanguageNameField(row.status)}}</td> <td md-cell>{{currentLanguageNameField(row.schoolDepartment)}}</td> <td md-cell><md-button ng-if="row.canEdit" md-no-ink class="md-primary change-button" ng-href="#/subject/{{::row.id}}/edit">{{\'main.button.change\' | translate}}</md-button></td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\' }" md-page-select></md-table-pagination> </div> </div>'),a.put("subject/subject.view.html",'<div class="ois-form-layout-padding form-readonly" ng-cloak> <div> <form name="subjectForm" layout="column"> <md-input-container flex> <label>{{\'subject.code\' | translate}}</label> <hois-value value="subject.code"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'subject.nameEt\' | translate}}</label> <hois-value value="subject.nameEt"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'subject.nameEn\' | translate}}</label> <hois-value value="subject.nameEn"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'subject.credits\' | translate}}</label> <hois-value value="subject.credits"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'subject.assessment\' | translate}}</label> <hois-classifier-value ng-model="subject.assessment" main-classifier-code="HINDAMISVIIS"></hois-classifier-value> </md-input-container> <md-input-container flex> <label>{{\'subject.assessmentDescription\' | translate}}</label> <hois-value value="subject.assessmentDescription"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'subject.language\' | translate}}</label> <hois-classifier-value ng-model="subject.languages" main-classifier-code="OPPEKEEL"></hois-classifier-value> </md-input-container> <md-input-container flex> <label>{{\'subject.objectivesEt\' | translate}}</label> <hois-value value="subject.objectivesEt"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'subject.objectivesEn\' | translate}}</label> <hois-value value="subject.objectivesEn"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'subject.outcomesEt\' | translate}}</label> <hois-value value="subject.outcomesEt"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'subject.outcomesEn\' | translate}}</label> <hois-value value="subject.outcomesEn"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'subject.descriptionEt\' | translate}}</label> <hois-value value="subject.descriptionEt"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'subject.descriptionEn\' | translate}}</label> <hois-value value="subject.descriptionEn"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'subject.independentStudyEt\' | translate}}</label> <hois-value value="subject.independentStudyEt"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'subject.independentStudyEn\' | translate}}</label> <hois-value value="subject.independentStudyEn"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'subject.studyLiterature\' | translate}}</label> <hois-value value="subject.studyLiterature"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'subject.evaluationEt\' | translate}}</label> <hois-value value="subject.evaluationEt"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'subject.evaluationEn\' | translate}}</label> <hois-value value="subject.evaluationEn"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'subject.additionalInfo\' | translate}}</label> <hois-value value="subject.additionalInfo"></hois-value> </md-input-container> <div flex layout="column" ng-show="subject.mandatoryPrerequisiteSubjects.length > 0 || subject.recommendedPrerequisiteSubjects.length > 0 || subject.substituteSubjects.length > 0"> <fieldset tabindex="1"> <legend md-colors="{color: \'default-primary-800\'}" class="md-title-small">{{\'subject.prerequisiteAndSubstituteSubjects\' | translate}}</legend> <div ng-show="subject.mandatoryPrerequisiteSubjects.length > 0"> <h3>{{\'subject.mandatoryPrerequisiteSubjects\' | translate}}</h3> <div layout="column" class="common-label" flex="95" ng-repeat="sub in subject.mandatoryPrerequisiteSubjects | orderBy: [\'sub.\' + currentLanguageNameField(), \'code\']"> <div layout="row" flex layout-align="start center"> <div flex="50"><a ng-href="#/subject{{isPublic ? \'/public\' : \'\'}}/{{sub.id}}">{{currentLanguageNameField(sub)}}</a></div> </div> </div> <md-divider></md-divider> </div> <div ng-if="subject.recommendedPrerequisiteSubjects.length > 0"> <h3>{{\'subject.recommendedPrerequisiteSubjects\' | translate}}</h3> <div layout="column" class="common-label" flex="95" ng-repeat="sub in subject.recommendedPrerequisiteSubjects | orderBy: [\'sub.\' + currentLanguageNameField(), \'code\']"> <div layout="row" flex layout-align="start center"> <div flex="50"><a ng-href="#/subject{{isPublic ? \'/public\' : \'\'}}/{{sub.id}}">{{currentLanguageNameField(sub)}}</a></div> </div> </div> <md-divider></md-divider> </div> <div ng-if="subject.substituteSubjects.length > 0"> <h3>{{\'subject.substituteSubjects\' | translate}}</h3> <div layout="column" class="common-label" flex="95" ng-repeat="sub in subject.substituteSubjects | orderBy: [\'sub.\' + currentLanguageNameField(), \'code\']"> <div layout="row" flex layout-align="start center"> <div flex="50"><a ng-href="#/subject{{isPublic ? \'/public\' : \'\'}}/{{sub.id}}">{{currentLanguageNameField(sub)}}</a></div> </div> </div> <md-divider></md-divider> </div> </fieldset> <div>&nbsp;</div> </div> <md-input-container flex> <label>{{\'subject.linkDepartment\' | translate}}</label> <hois-value value="currentLanguageNameField(subject.schoolDepartment)"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'subject.isPractice\' | translate}}</label> <hois-value value="subject.isPractice ? \'main.yes\' : \'main.no\' | translate"></hois-value> </md-input-container> <md-input-container> <label>{{\'subject.status\' | translate}}</label> <hois-classifier-value ng-model="subject.status" main-classifier-code="AINESTAATUS"></hois-classifier-value> </md-input-container> <md-input-container ng-if="subject.status === \'AINESTAATUS_K\'"> <label>{{\'public.url\' | translate}}</label> <input ng-model="publicUrl" type="text" readonly> </md-input-container> <div flex ng-show="subject.primarySubjects.length > 0"> <fieldset tabindex="2"> <legend md-colors="{color: \'default-primary-800\'}" class="md-title-small">{{\'subject.subjectIsPrerequisite\' | translate}}</legend> <div ng-repeat="row in subject.primarySubjects | orderBy: currentLanguageNameField()"> <a class="md-body-1" ng-href="#/subject{{isPublic ? \'/public\' : \'\'}}/{{row.id}}">{{currentLanguageNameField(row)}}</a> </div> </fieldset> </div> <div flex ng-show="subject.curriculumVersions.length > 0"> <div>&nbsp;</div> <fieldset tabindex="3"> <legend md-colors="{color: \'default-primary-800\'}" class="md-title-small">{{\'subject.belongsCurriculum\' | translate}}</legend> <div ng-repeat="row in subject.curriculumVersions | orderBy: currentLanguageNameField()"> <span class="md-body-1">{{currentLanguageNameField(row) }}</span> </div> </fieldset> </div> <div flex ng-if="subject.programs.length > 0"> <div>&nbsp;</div> <fieldset tabindex="4"> <legend md-colors="{color: \'default-primary-800\'}" class="md-title-small">{{\'subject.subjectProgram.label\' | translate}}</legend> <div layout="column"> <md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'subject.subjectProgram.teacher\' | translate}}</th> <th md-column>{{\'subject.subjectProgram.studyPeriod\' | translate}}</th> <th md-column ng-if="!isPublic && (auth.isAdmin() || auth.isTeacher())">{{\'subject.subjectProgram.status\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="program in subject.programs"> <td md-cell><a href="#/subjectProgram/{{::(isPublic || !(auth.isAdmin() || auth.isTeacher())  ? \'public\' : \'periods\')}}/{{::program.id}}/view">{{program.teacherName}}</a></td> <td md-cell><a href="#/subjectProgram/{{::(isPublic || !(auth.isAdmin() || auth.isTeacher()) ? \'public\' : \'periods\')}}/{{::program.id}}/view">{{currentLanguageNameField(program.studyPeriod)}}</a></td> <td md-cell ng-if="!isPublic && (auth.isAdmin() || auth.isTeacher())"><hois-classifier-value ng-model="program.status" main-classifier-code="AINEPROGRAMM_STAATUS"></hois-classifier-value></td> </tr> </tbody> </table> </md-table-container> </div> </fieldset> </div> <div>&nbsp;</div> <hois-created-modified object="subject"></hois-created-modified> <div layout="row"> <md-button ng-if="subject.canEdit" ng-href="#/subject/{{subject.id}}/edit" class="md-raised md-primary">{{\'main.button.change\' | translate}}</md-button> <md-button ng-click="back(formState.backUrl)" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </div> </form> </div> </div>'),a.put("subjectProgram/subject.program.edit.html",'<div class="ois-form-layout-padding nomargin"> <form ng-cloak name="subjectProgramForm"> <div layout="column" ng-cloak> <div flex class="form-readonly"> <div flex layout="column" ng-if="subjectProgram.rejectInfo"> <md-input-container flex="100" class="md-input-invalid"> <label class="textInput">{{\'subjectProgram.rejectInfo\' | translate}}</label> <hois-value value="subjectProgram.rejectInfo"></hois-value> </md-input-container> </div> <div flex layout="column" layout-gt-xs="row"> <md-input-container flex="100" flex-gt-xs="40"> <label class="textInput">{{\'subjectProgram.subjectName\' | translate}}</label> <hois-value value="currentLanguageNameField(subject)"></hois-value> </md-input-container> <md-input-container flex="100" flex-gt-xs="20"> <label class="textInput">{{\'subject.code\' | translate}}</label> <hois-value value="subject.code"></hois-value> </md-input-container> <md-input-container flex="100" flex-gt-xs="20"> <label class="textInput">{{\'subjectProgram.creditsAndHours\' | translate}}</label> <hois-value value="subject.credits + \'/\' + (subject.credits * 26)"></hois-value> </md-input-container> <md-input-container flex="100" flex-gt-xs="20"> <label class="textInput">{{\'subject.assessment\' | translate}}</label> <hois-classifier-value ng-model="subject.assessment" main-classifier-code="HINDAMISVIIS"></hois-classifier-value> </md-input-container> </div> <hois-collapsable class="hois-collapse2" expanded="false"> <hois-collapsable-header> <span>{{\'subjectProgram.syllabus\' | translate}}</span> </hois-collapsable-header> <div flex layout="column"> <md-input-container flex style="margin-top: 0 !important"> <label class="textInput">{{\'subject.assessmentDescription\' | translate}}</label> <hois-value value="subject.assessmentDescription"></hois-value> </md-input-container> <md-input-container flex> <label class="textInput">{{\'subject.language\' | translate}}</label> <hois-classifier-value ng-model="subject.languages" main-classifier-code="OPPEKEEL"></hois-classifier-value> </md-input-container> <md-input-container flex ng-if="currentLanguage() === \'et\'"> <label>{{\'subject.objectivesEt\' | translate}}</label> <hois-value value="subject.objectivesEt"></hois-value> </md-input-container> <md-input-container flex ng-if="currentLanguage() === \'en\'"> <label>{{\'subject.objectivesEn\' | translate}}</label> <hois-value value="subject.objectivesEn"></hois-value> </md-input-container> <md-input-container flex ng-if="currentLanguage() === \'et\'"> <label>{{\'subject.outcomesEt\' | translate}}</label> <hois-value value="subject.outcomesEt"></hois-value> </md-input-container> <md-input-container flex ng-if="currentLanguage() === \'en\'"> <label>{{\'subject.outcomesEn\' | translate}}</label> <hois-value value="subject.outcomesEn"></hois-value> </md-input-container> <md-input-container flex ng-if="currentLanguage() === \'et\'"> <label>{{\'subject.descriptionEt\' | translate}}</label> <hois-value value="subject.descriptionEt"></hois-value> </md-input-container> <md-input-container flex ng-if="currentLanguage() === \'en\'"> <label>{{\'subject.descriptionEn\' | translate}}</label> <hois-value value="subject.descriptionEn"></hois-value> </md-input-container> <md-input-container flex ng-if="currentLanguage() === \'et\'"> <label>{{\'subject.independentStudyEt\' | translate}}</label> <hois-value value="subject.independentStudyEt"></hois-value> </md-input-container> <md-input-container flex ng-if="currentLanguage() === \'en\'"> <label>{{\'subject.independentStudyEn\' | translate}}</label> <hois-value value="subject.independentStudyEn"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'subject.studyLiterature\' | translate}}</label> <hois-value value="subject.studyLiterature"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'subject.evaluationEt\' | translate}}</label> <hois-value value="subject.evaluationEt"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'subject.evaluationEn\' | translate}}</label> <hois-value value="subject.evaluationEn"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'subject.additionalInfo\' | translate}}</label> <hois-value value="subject.additionalInfo"></hois-value> </md-input-container> <div flex layout="column" ng-show="subject.mandatoryPrerequisiteSubjects.length > 0 || subject.recommendedPrerequisiteSubjects.length > 0 || subject.substituteSubjects.length > 0"> <div>&nbsp;</div> <fieldset tabindex="1"> <legend md-colors="{color: \'default-primary-800\'}" class="md-title-small">{{\'subject.prerequisiteAndSubstituteSubjects\' | translate}}</legend> <div ng-show="subject.mandatoryPrerequisiteSubjects.length > 0"> <h3>{{\'subject.mandatoryPrerequisiteSubjects\' | translate}}</h3> <div layout="column" class="common-label" flex="95" ng-repeat="sub in subject.mandatoryPrerequisiteSubjects | orderBy: [\'sub.\' + currentLanguageNameField(), \'code\']"> <div layout="row" flex layout-align="start center"> <div flex="50"><a ng-href="#/subject{{isPublic ? \'/public\' : \'\'}}/{{sub.id}}">{{currentLanguageNameField(sub)}}</a></div> </div> </div> <md-divider></md-divider> </div> <div ng-if="subject.recommendedPrerequisiteSubjects.length > 0"> <h3>{{\'subject.recommendedPrerequisiteSubjects\' | translate}}</h3> <div layout="column" class="common-label" flex="95" ng-repeat="sub in subject.recommendedPrerequisiteSubjects | orderBy: [\'sub.\' + currentLanguageNameField(), \'code\']"> <div layout="row" flex layout-align="start center"> <div flex="50"><a ng-href="#/subject{{isPublic ? \'/public\' : \'\'}}/{{sub.id}}">{{currentLanguageNameField(sub)}}</a></div> </div> </div> <md-divider></md-divider> </div> <div ng-if="subject.substituteSubjects.length > 0"> <h3>{{\'subject.substituteSubjects\' | translate}}</h3> <div layout="column" class="common-label" flex="95" ng-repeat="sub in subject.substituteSubjects | orderBy: [\'sub.\' + currentLanguageNameField(), \'code\']"> <div layout="row" flex layout-align="start center"> <div flex="50"><a ng-href="#/subject{{isPublic ? \'/public\' : \'\'}}/{{sub.id}}">{{currentLanguageNameField(sub)}}</a></div> </div> </div> <md-divider></md-divider> </div> </fieldset> </div> <md-input-container flex> <label>{{\'subject.linkDepartment\' | translate}}</label> <hois-value value="currentLanguageNameField(subject.schoolDepartment)"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'subject.isPractice\' | translate}}</label> <hois-value value="subject.isPractice ? \'main.yes\' : \'main.no\' | translate"></hois-value> </md-input-container> <md-input-container> <label>{{\'subject.status\' | translate}}</label> <hois-classifier-value ng-model="subject.status" main-classifier-code="AINESTAATUS"></hois-classifier-value> </md-input-container> <div flex ng-show="subject.primarySubjects.length > 0"> <fieldset tabindex="2"> <legend md-colors="{color: \'default-primary-800\'}" class="md-title-small">{{\'subject.subjectIsPrerequisite\' | translate}}</legend> <div ng-repeat="row in subject.primarySubjects | orderBy: currentLanguageNameField()"> <a class="md-body-1" ng-href="#/subject/{{row.id}}/edit">{{currentLanguageNameField(row)}}</a> </div> </fieldset> </div> </div> </hois-collapsable> </div> <div layout="column" ng-if="!subjectProgram.id && subjectPrograms.length > 0"> <md-input-container flex> <label>{{\'subjectProgram.copySubjectProgram\' | translate}}</label> <md-select ng-model="selectedSubjectProgram" ng-change="getSubjectProgramData(selectedSubjectProgram)"> <md-option ng-value="program" ng-repeat="program in subjectPrograms">{{currentLanguageNameField(program)}}</md-option> </md-select> </md-input-container> <div>&nbsp;</div> </div> <div flex class="study-content"> <fieldset tabindex="1"> <legend md-colors="{color: \'default-primary-800\'}" class="md-title-small">{{\'subjectProgram.studyContent\' | translate}}</legend> <div flex layout="row"> <span flex="30" class="common-label"></span> <hois-classifier-radio layout="row" ng-model="subjectProgram.studyContentType" name="studyContentType" model-value-attr="code" main-classifier-code="OPPETOOSISU" required class="md-primary" ng-change="studyContentTypeChange()"></hois-classifier-radio> </div> <p class="md-body-1" md-colors="{color: \'warn\'}" ng-if="showWarningAboutType" style="margin: 0 4px">{{\'subjectProgram.messages.previousStudyContentBeingDeleted\' | translate }}</p> <div ng-if="!showWarningAboutType">&nbsp;</div> <div ng-show="subjectProgram.studyContentType === \'OPPETOOSISU_K\'" layout="column"> <md-table-container> <div layout="row" ng-repeat="sc in studyContentDt"> <md-input-container> <label>{{\'subjectProgram.date\' | translate}}</label> <md-datepicker ng-model="sc.studyDt" ng-required="subjectProgram.studyContentType === \'OPPETOOSISU_K\'"></md-datepicker> </md-input-container> <md-input-container flex="100"> <label>{{\'subjectProgram.description\' | translate}}</label> <textarea ng-model="sc.studyInfo" md-maxlength="4000" max-rows="10" ng-required="subjectProgram.studyContentType === \'OPPETOOSISU_K\'"></textarea> </md-input-container> <div layout="row" layout-align="center center" style="margin-left: 10px"> <a class="remove" ng-click="removeFromArray(studyContentDt, sc)">&times;</a> </div> </div> <div layout="row"> <md-button class="md-raised" ng-click="addStudyContentDt()" style="text-transform: none">{{\'main.button.addRow\' | translate}}</md-button> </div> </md-table-container> </div> <div ng-show="subjectProgram.studyContentType === \'OPPETOOSISU_N\'" layout="column"> <md-table-container> <div layout="column" ng-repeat="sc in studyContentWk"> <div layout="row"> <md-input-container flex="10"> <label>{{\'subjectProgram.week\' | translate}}</label> <input type="text" ng-model="sc.weekNr" name="week[{{$index}}]" md-maxlength="20" ng-required="subjectProgram.studyContentType === \'OPPETOOSISU_N\'"> </md-input-container> <md-input-container flex> <label>{{\'subjectProgram.description\' | translate}}</label> <textarea ng-model="sc.studyInfo" md-maxlength="4000" max-rows="10" ng-required="subjectProgram.studyContentType === \'OPPETOOSISU_N\'"></textarea> </md-input-container> <div layout="row" layout-align="center center" style="margin-left: 10px"> <a class="remove" ng-click="removeFromArray(studyContentWk, sc)">&times;</a> </div> </div> <div layout="row"> <div ng-messages="subjectProgramForm[\'week[\'+$index+\']\'].$error"> <div class="invalid md-body-1" ng-message="minmax">{{\'subjectProgram.messages.weeksMinmax\' | translate}}</div> </div> </div> </div> <div layout="row"> <md-button class="md-raised" ng-click="addStudyContentWk()" style="text-transform: none">{{\'main.button.addRow\' | translate}}</md-button> </div> </md-table-container> </div> <div ng-show="subjectProgram.studyContentType === \'OPPETOOSISU_T\'" layout="column" flex> <md-input-container flex> <label>{{\'subjectProgram.description\' | translate}}</label> <textarea ng-model="subjectProgram.studyDescription" name="studyDescription" md-maxlength="20000" max-rows="10" ng-required="subjectProgram.studyContentType === \'OPPETOOSISU_T\'"></textarea> </md-input-container> </div> </fieldset> <div>&nbsp;</div> </div> <md-input-container flex> <label>{{\'subjectProgram.independentStudy\' | translate}}</label> <textarea ng-model="subjectProgram.independentStudy" name="independentStudy" md-maxlength="20000" max-rows="10"></textarea> </md-input-container> <md-input-container flex> <label>{{\'subjectProgram.studyLiterature\' | translate}}</label> <textarea ng-model="subjectProgram.studyLiterature" name="studyLiterature" md-maxlength="20000" max-rows="10"></textarea> </md-input-container> <md-input-container flex> <label>{{\'subjectProgram.assessmentDescription\' | translate}}</label> <textarea ng-model="subjectProgram.assessmentDescription" name="assessmentDescription" md-maxlength="20000" max-rows="10"></textarea> </md-input-container> <div>&nbsp;</div> <div flex> <fieldset tabindex="2"> <legend md-colors="{color: \'default-primary-800\'}" class="md-title-small">{{\'subjectProgram.assessmentCriteria\' | translate}}</legend> <div>&nbsp;</div> <div ng-show="subject.assessment === \'HINDAMISVIIS_A\'" layout="column"> <md-input-container flex> <label>{{\'subjectProgram.passDescription\' | translate}}</label> <textarea ng-model="subjectProgram.passDescription" name="passDescription" md-maxlength="20000" max-rows="10" ng-required="subject.assessment === \'HINDAMISVIIS_A\'"></textarea> </md-input-container> <md-input-container flex> <label>{{\'subjectProgram.npassDescription\' | translate}}</label> <textarea ng-model="subjectProgram.npassDescription" name="npassDescription" md-maxlength="20000" max-rows="10" ng-required="subject.assessment === \'HINDAMISVIIS_A\'"></textarea> </md-input-container> </div> <div ng-show="subject.assessment === \'HINDAMISVIIS_E\'" layout="column" flex> <md-input-container flex> <label>{{\'subjectProgram.grade0Description\' | translate}}</label> <textarea ng-model="subjectProgram.grade0Description" name="grade0Description" md-maxlength="20000" max-rows="10" ng-required="subject.assessment === \'HINDAMISVIIS_E\'"></textarea> </md-input-container> <md-input-container flex> <label>{{\'subjectProgram.grade1Description\' | translate}}</label> <textarea ng-model="subjectProgram.grade1Description" name="grade1Description" md-maxlength="20000" max-rows="10" ng-required="subject.assessment === \'HINDAMISVIIS_E\'"></textarea> </md-input-container> <md-input-container flex> <label>{{\'subjectProgram.grade2Description\' | translate}}</label> <textarea ng-model="subjectProgram.grade2Description" name="grade2Description" md-maxlength="20000" max-rows="10" ng-required="subject.assessment === \'HINDAMISVIIS_E\'"></textarea> </md-input-container> <md-input-container flex> <label>{{\'subjectProgram.grade3Description\' | translate}}</label> <textarea ng-model="subjectProgram.grade3Description" name="grade3Description" md-maxlength="20000" max-rows="10" ng-required="subject.assessment === \'HINDAMISVIIS_E\'"></textarea> </md-input-container> <md-input-container flex> <label>{{\'subjectProgram.grade4Description\' | translate}}</label> <textarea ng-model="subjectProgram.grade4Description" name="grade4Description" md-maxlength="20000" max-rows="10" ng-required="subject.assessment === \'HINDAMISVIIS_E\'"></textarea> </md-input-container> <md-input-container flex> <label>{{\'subjectProgram.grade5Description\' | translate}}</label> <textarea ng-model="subjectProgram.grade5Description" name="grade5Description" md-maxlength="20000" max-rows="10" ng-required="subject.assessment === \'HINDAMISVIIS_E\'"></textarea> </md-input-container> </div> <div ng-show="subject.assessment === \'HINDAMISVIIS_H\'" layout="column" flex> <md-input-container flex> <label>{{\'subjectProgram.grade3Description\' | translate}}</label> <textarea ng-model="subjectProgram.grade3Description" name="grade3Description" md-maxlength="20000" max-rows="10" ng-required="subject.assessment === \'HINDAMISVIIS_H\'"></textarea> </md-input-container> <md-input-container flex> <label>{{\'subjectProgram.grade4Description\' | translate}}</label> <textarea ng-model="subjectProgram.grade4Description" name="grade4Description" md-maxlength="20000" max-rows="10" ng-required="subject.assessment === \'HINDAMISVIIS_H\'"></textarea> </md-input-container> <md-input-container flex> <label>{{\'subjectProgram.grade5Description\' | translate}}</label> <textarea ng-model="subjectProgram.grade5Description" name="grade5Description" md-maxlength="20000" max-rows="10" ng-required="subject.assessment === \'HINDAMISVIIS_H\'"></textarea> </md-input-container> </div> </fieldset> </div> <div>&nbsp;</div> <md-input-container> <label>{{\'subjectProgram.addInfo\' | translate}}</label> <textarea ng-model="subjectProgram.addInfo" name="addInfo" md-maxlength="10000" max-rows="10"></textarea> </md-input-container> <div>&nbsp;</div> <div flex> <fieldset tabindex="3"> <legend md-colors="{color: \'default-primary-800\'}" class="md-title-small">{{\'subjectProgram.publicLevel\' | translate}}</legend> <div>&nbsp;</div> <div layout="column"> <md-checkbox ng-model="subjectProgram.publicAll" aria-label="{{\'subjectProgram.publicAll\' | translate}}"> {{\'subjectProgram.publicAll\' | translate}} </md-checkbox> <md-checkbox ng-model="subjectProgram.publicHois" aria-label="{{\'subjectProgram.publicHois\' | translate}}"> {{\'subjectProgram.publicHois\' | translate}} </md-checkbox> <md-checkbox ng-model="subjectProgram.publicStudent" aria-label="{{\'subjectProgram.publicStudent\' | translate}}"> {{\'subjectProgram.publicStudent\' | translate}} </md-checkbox> </div> </fieldset> </div> <div>&nbsp;</div> <div flex class="form-readonly" layout="column"> <md-input-container flex> <label class="textInput">{{\'subjectProgram.status\' | translate}}</label> <hois-classifier-value ng-model="subjectProgram.status" main-classifier-code="AINEPROGRAMM_STAATUS"></hois-classifier-value> </md-input-container> <md-input-container flex ng-if="subjectProgram.status === \'AINEPROGRAMM_STAATUS_K\'"> <label>{{\'subjectProgram.confirmedDate\' | translate}}</label> <hois-value value="subjectProgram.confirmed | hoisDateTime"></hois-value> </md-input-container> <md-input-container flex ng-if="subjectProgram.status === \'AINEPROGRAMM_STAATUS_K\'"> <label>{{\'subjectProgram.confirmedBy\' | translate}}</label> <hois-value value="subjectProgram.confirmedBy"></hois-value> </md-input-container> </div> <br> </div> <md-button class="md-raised md-primary" ng-if="!auth.isAdmin() || isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_AINEOPPETAJA\')" ng-click="save()">{{"main.button.save" | translate}}</md-button> <md-button class="md-raised" ng-if="subjectProgram.status === \'AINEPROGRAMM_STAATUS_I\'\r\n      && (!auth.isAdmin() || isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_AINEOPPETAJA\'))" ng-click="completeProgram()">{{"subjectProgram.operation.complete.label" | translate}}</md-button> <md-button class="md-raised" ng-if="subjectProgram.id" ng-href="{{pdfUrl()}}" target="_blank">{{"main.button.print" | translate}}</md-button> <md-button class="md-raised" ng-if="subjectProgram.id && (!auth.isAdmin() || isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_AINEOPPETAJA\'))" ng-click="delete()">{{\'main.button.delete\' | translate}}</md-button> <md-button class="md-raised" ng-click="back(getDefaultBack(), subjectProgramForm)">{{"main.button.back" | translate}}</md-button> </form> </div> <style>.link-no-underline {\r\n    text-decoration: none;\r\n  }\r\n  .link-disabled {\r\n    color: #d7dde5;\r\n  }\r\n  .nomargin .form-readonly .md-input-has-value {\r\n    margin-top: 18px !important;\r\n  }\r\n  .study-content .md-input.md-datepicker-input {\r\n    height: 47px !important;\r\n  }\r\n  .study-content input[type="text"] {\r\n    height: 47px !important;\r\n  }</style>'),
a.put("subjectProgram/subject.program.list.html",'<div class="ois-form-layout-padding"> <div flex> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <form name="searchController.searchForm" ng-submit="load()" class="nomargin" layout="column"> <div layout-gt-sm="row" layout="column"> <md-input-container flex-gt-sm="45" flex="100"> <label class="textInput">{{\'subjectProgram.search.subject\' | translate}}</label> <md-select ng-model="criteria.subject"> <md-option value=""></md-option> <md-option ng-value="subject.id" ng-repeat="subject in subjects | orderBy: currentLanguageNameField()">{{currentLanguageNameField(subject)}}</md-option> </md-select> </md-input-container> <md-input-container flex-gt-sm="50" flex="100" flex-offset-gt-sm="5"> <label class="textInput">{{\'subjectProgram.search.studyPeriod\' | translate}}</label> <md-select ng-model="criteria.studyPeriod"> <md-option ng-value="period.id" ng-repeat="period in studyPeriods | orderBy: currentLanguageNameField()">{{currentLanguageNameField(period)}}</md-option> </md-select> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-autocomplete name="teacher" md-selected-item="criteria.teacher" md-search-text="teacherName" md-items="teacher in searchTeacher(teacherName)" md-item-text="currentLanguageNameField(teacher)" md-min-length="1" md-floating-label="{{\'subjectProgram.search.teacher\' | translate}}" md-no-cache class="small-margin" flex-gt-sm="45" flex="100" ng-if="!myData"> <md-item-template> <span md-highlight-text="teacherName" md-highlight-flags="^i">{{currentLanguageNameField(teacher)}}</span> </md-item-template> <md-not-found> {{\'main.messages.error.notFound\' | translate}} </md-not-found> </md-autocomplete> <md-input-container flex-gt-sm="{{myData ? 45 : 50}}" flex="100" flex-offset-gt-sm="{{myData ? 0 : 5}}"> <label>{{\'subjectProgram.search.status\' | translate}}</label> <md-select ng-model="criteria.status"> <md-option ng-value=""></md-option> <md-option ng-value="status.code" ng-repeat="status in statusOptions" ng-if="status.code !== \'AINEPROGRAMM_STAATUS_L\'">{{currentLanguageNameField(status)}}</md-option> </md-select> </md-input-container> </div> <div layout="row"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteriaBefore()">{{\'main.button.clear\' | translate}}</md-button> </div> </form> </fieldset> </div> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column style="width:40%">{{\'subjectProgram.search.subject\' | translate}}</th> <th md-column style="width:25%">{{\'subjectProgram.search.studyPeriod\' | translate}}</th> <th md-column style="width:20%" ng-if="!myData">{{\'subjectProgram.search.teacher\' | translate}}</th> <th md-column style="width:10%">{{\'subjectProgram.search.status\' | translate}}</th> <th md-column style="width:5%"></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{currentLanguageNameField(row.subject)}}</td> <td md-cell>{{getStudyPeriodName(row.studyPeriod)}}</td> <td md-cell ng-if="!myData">{{currentLanguageNameField(row.teacher)}}</td> <td md-cell> <hois-classifier-value ng-model="row.status" main-classifier-code="AINEPROGRAMM_STAATUS"></hois-classifier-value> </td> <td md-cell> <md-button md-no-ink class="md-primary change-button" ng-href="#/subjectProgram/{{::(myData ? \'teachers\' : \'programs\')}}/{{::row.id}}/{{::(row.status === \'AINEPROGRAMM_STAATUS_I\' && !myData  ? \'edit\' : \'view\')}}"> {{row.status === \'AINEPROGRAMM_STAATUS_I\' && !myData ? (\'main.button.edit\' | translate) : (\'main.button.view\' | translate)}} </md-button> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> </div>'),a.put("subjectProgram/subject.program.view.html",'<div class="ois-form-layout-padding nomargin"> <form ng-cloak name="subjectProgramForm"> <div layout="column" ng-cloak class="form-readonly"> <div flex> <div flex layout="column" ng-if="subjectProgram.rejectInfo"> <md-input-container flex="100" class="md-input-invalid"> <label class="textInput">{{\'subjectProgram.rejectInfo\' | translate}}</label> <hois-value value="subjectProgram.rejectInfo"></hois-value> </md-input-container> </div> <div flex layout="column" layout-gt-xs="row"> <md-input-container flex="100" flex-gt-xs="40"> <label class="textInput">{{\'subjectProgram.subjectName\' | translate}}</label> <hois-value value="currentLanguageNameField(subject)"></hois-value> </md-input-container> <md-input-container flex="100" flex-gt-xs="20"> <label class="textInput">{{\'subject.code\' | translate}}</label> <hois-value value="subject.code"></hois-value> </md-input-container> <md-input-container flex="100" flex-gt-xs="20"> <label class="textInput">{{\'subjectProgram.creditsAndHours\' | translate}}</label> <hois-value value="subject.credits + \'/\' + (subject.credits * 26)"></hois-value> </md-input-container> <md-input-container flex="100" flex-gt-xs="20"> <label class="textInput">{{\'subject.assessment\' | translate}}</label> <hois-classifier-value ng-model="subject.assessment" main-classifier-code="HINDAMISVIIS"></hois-classifier-value> </md-input-container> </div> <hois-collapsable class="hois-collapse2" expanded="false"> <hois-collapsable-header> <span>{{\'subjectProgram.syllabus\' | translate}}</span> </hois-collapsable-header> <div flex layout="column"> <md-input-container flex style="margin-top: 0 !important"> <label class="textInput">{{\'subject.assessmentDescription\' | translate}}</label> <hois-value value="subject.assessmentDescription"></hois-value> </md-input-container> <md-input-container flex> <label class="textInput">{{\'subject.language\' | translate}}</label> <hois-classifier-value ng-model="subject.languages" main-classifier-code="OPPEKEEL"></hois-classifier-value> </md-input-container> <md-input-container flex ng-if="currentLanguage() === \'et\'"> <label>{{\'subject.objectivesEt\' | translate}}</label> <hois-value value="subject.objectivesEt"></hois-value> </md-input-container> <md-input-container flex ng-if="currentLanguage() === \'en\'"> <label>{{\'subject.objectivesEn\' | translate}}</label> <hois-value value="subject.objectivesEn"></hois-value> </md-input-container> <md-input-container flex ng-if="currentLanguage() === \'et\'"> <label>{{\'subject.outcomesEt\' | translate}}</label> <hois-value value="subject.outcomesEt"></hois-value> </md-input-container> <md-input-container flex ng-if="currentLanguage() === \'en\'"> <label>{{\'subject.outcomesEn\' | translate}}</label> <hois-value value="subject.outcomesEn"></hois-value> </md-input-container> <md-input-container flex ng-if="currentLanguage() === \'et\'"> <label>{{\'subject.descriptionEt\' | translate}}</label> <hois-value value="subject.descriptionEt"></hois-value> </md-input-container> <md-input-container flex ng-if="currentLanguage() === \'en\'"> <label>{{\'subject.descriptionEn\' | translate}}</label> <hois-value value="subject.descriptionEn"></hois-value> </md-input-container> <md-input-container flex ng-if="currentLanguage() === \'et\'"> <label>{{\'subject.independentStudyEt\' | translate}}</label> <hois-value value="subject.independentStudyEt"></hois-value> </md-input-container> <md-input-container flex ng-if="currentLanguage() === \'en\'"> <label>{{\'subject.independentStudyEn\' | translate}}</label> <hois-value value="subject.independentStudyEn"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'subject.studyLiterature\' | translate}}</label> <hois-value value="subject.studyLiterature"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'subject.evaluationEt\' | translate}}</label> <hois-value value="subject.evaluationEt"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'subject.evaluationEn\' | translate}}</label> <hois-value value="subject.evaluationEn"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'subject.additionalInfo\' | translate}}</label> <hois-value value="subject.additionalInfo"></hois-value> </md-input-container> <div flex layout="column" ng-show="subject.mandatoryPrerequisiteSubjects.length > 0 || subject.recommendedPrerequisiteSubjects.length > 0 || subject.substituteSubjects.length > 0"> <div>&nbsp;</div> <fieldset tabindex="1"> <legend md-colors="{color: \'default-primary-800\'}" class="md-title-small">{{\'subject.prerequisiteAndSubstituteSubjects\' | translate}}</legend> <div ng-show="subject.mandatoryPrerequisiteSubjects.length > 0"> <h3>{{\'subject.mandatoryPrerequisiteSubjects\' | translate}}</h3> <div layout="column" class="common-label" flex="95" ng-repeat="sub in subject.mandatoryPrerequisiteSubjects | orderBy: [\'sub.\' + currentLanguageNameField(), \'code\']"> <div layout="row" flex layout-align="start center"> <div flex="50"><a ng-href="#/subject{{isPublic ? \'/public\' : \'\'}}/{{sub.id}}">{{currentLanguageNameField(sub)}}</a></div> </div> </div> <md-divider></md-divider> </div> <div ng-if="subject.recommendedPrerequisiteSubjects.length > 0"> <h3>{{\'subject.recommendedPrerequisiteSubjects\' | translate}}</h3> <div layout="column" class="common-label" flex="95" ng-repeat="sub in subject.recommendedPrerequisiteSubjects | orderBy: [\'sub.\' + currentLanguageNameField(), \'code\']"> <div layout="row" flex layout-align="start center"> <div flex="50"><a ng-href="#/subject{{isPublic ? \'/public\' : \'\'}}/{{sub.id}}">{{currentLanguageNameField(sub)}}</a></div> </div> </div> <md-divider></md-divider> </div> <div ng-if="subject.substituteSubjects.length > 0"> <h3>{{\'subject.substituteSubjects\' | translate}}</h3> <div layout="column" class="common-label" flex="95" ng-repeat="sub in subject.substituteSubjects | orderBy: [\'sub.\' + currentLanguageNameField(), \'code\']"> <div layout="row" flex layout-align="start center"> <div flex="50"><a ng-href="#/subject{{isPublic ? \'/public\' : \'\'}}/{{sub.id}}">{{currentLanguageNameField(sub)}}</a></div> </div> </div> <md-divider></md-divider> </div> </fieldset> </div> <md-input-container flex> <label>{{\'subject.linkDepartment\' | translate}}</label> <hois-value value="currentLanguageNameField(subject.schoolDepartment)"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'subject.isPractice\' | translate}}</label> <hois-value value="subject.isPractice ? \'main.yes\' : \'main.no\' | translate"></hois-value> </md-input-container> <md-input-container> <label>{{\'subject.status\' | translate}}</label> <hois-classifier-value ng-model="subject.status" main-classifier-code="AINESTAATUS"></hois-classifier-value> </md-input-container> <div flex ng-show="subject.primarySubjects.length > 0"> <fieldset tabindex="2"> <legend md-colors="{color: \'default-primary-800\'}" class="md-title-small">{{\'subject.subjectIsPrerequisite\' | translate}}</legend> <div ng-repeat="row in subject.primarySubjects | orderBy: currentLanguageNameField()"> <a class="md-body-1" ng-href="#/subject/{{row.id}}/edit">{{currentLanguageNameField(row)}}</a> </div> </fieldset> </div> </div> </hois-collapsable> </div> <div flex class="study-content"> <fieldset tabindex="3"> <legend md-colors="{color: \'default-primary-800\'}" class="md-title-small">{{\'subjectProgram.studyContent\' | translate}}</legend> <div flex layout="row"> <span flex="30" class="common-label"></span> <hois-classifier-radio layout="row" ng-model="subjectProgram.studyContentType" name="studyContentType" model-value-attr="code" main-classifier-code="OPPETOOSISU" disabled class="md-primary"></hois-classifier-radio> </div> <div ng-show="subjectProgram.studyContentType === \'OPPETOOSISU_K\'" layout="column"> <md-table-container> <div layout="row" ng-repeat="sc in studyContentDt"> <md-input-container> <label>{{\'subjectProgram.date\' | translate}}</label> <hois-value value="sc.studyDt | hoisDate"></hois-value> </md-input-container> <md-input-container flex="100"> <label>{{\'subjectProgram.description\' | translate}}</label> <hois-value value="sc.studyInfo"></hois-value> </md-input-container> </div> </md-table-container> </div> <div ng-show="subjectProgram.studyContentType === \'OPPETOOSISU_N\'" layout="column"> <div layout="row" ng-repeat="sc in studyContentWk"> <md-input-container flex="10"> <label>{{\'subjectProgram.week\' | translate}}</label> <hois-value value="sc.weekNr"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'subjectProgram.description\' | translate}}</label> <hois-value value="sc.studyInfo"></hois-value> </md-input-container> </div> </div> <div ng-show="subjectProgram.studyContentType === \'OPPETOOSISU_T\'" layout="column" flex> <md-input-container flex> <label>{{\'subjectProgram.description\' | translate}}</label> <hois-value value="subjectProgram.studyDescription"></hois-value> </md-input-container> </div> </fieldset> <div>&nbsp;</div> </div> <md-input-container flex> <label>{{\'subjectProgram.independentStudy\' | translate}}</label> <hois-value value="subjectProgram.independentStudy"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'subjectProgram.studyLiterature\' | translate}}</label> <hois-value value="subjectProgram.studyLiterature"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'subjectProgram.assessmentDescription\' | translate}}</label> <hois-value value="subjectProgram.assessmentDescription"></hois-value> </md-input-container> <div flex> <div>&nbsp;</div> <fieldset tabindex="4"> <legend md-colors="{color: \'default-primary-800\'}" class="md-title-small">{{\'subjectProgram.assessmentCriteria\' | translate}}</legend> <div>&nbsp;</div> <div ng-show="subject.assessment === \'HINDAMISVIIS_A\'" layout="column"> <md-input-container flex> <label>{{\'subjectProgram.passDescription\' | translate}}</label> <hois-value value="subjectProgram.passDescription"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'subjectProgram.npassDescription\' | translate}}</label> <hois-value value="subjectProgram.npassDescription"></hois-value> </md-input-container> </div> <div ng-show="subject.assessment === \'HINDAMISVIIS_E\'" layout="column" flex> <md-input-container flex> <label>{{\'subjectProgram.grade0Description\' | translate}}</label> <hois-value value="subjectProgram.grade0Description"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'subjectProgram.grade1Description\' | translate}}</label> <hois-value value="subjectProgram.grade1Description"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'subjectProgram.grade2Description\' | translate}}</label> <hois-value value="subjectProgram.grade2Description"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'subjectProgram.grade3Description\' | translate}}</label> <hois-value value="subjectProgram.grade3Description"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'subjectProgram.grade4Description\' | translate}}</label> <hois-value value="subjectProgram.grade4Description"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'subjectProgram.grade5Description\' | translate}}</label> <hois-value value="subjectProgram.grade5Description"></hois-value> </md-input-container> </div> <div ng-show="subject.assessment === \'HINDAMISVIIS_H\'" layout="column" flex> <md-input-container flex> <label>{{\'subjectProgram.grade3Description\' | translate}}</label> <hois-value value="subjectProgram.grade3Description"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'subjectProgram.grade4Description\' | translate}}</label> <hois-value value="subjectProgram.grade4Description"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'subjectProgram.grade5Description\' | translate}}</label> <hois-value value="subjectProgram.grade5Description"></hois-value> </md-input-container> </div> </fieldset> </div> <div>&nbsp;</div> <md-input-container> <label>{{\'subjectProgram.addInfo\' | translate}}</label> <hois-value value="subjectProgram.addInfo"></hois-value> </md-input-container> <div flex ng-if="!isPublic"> <div>&nbsp;</div> <fieldset tabindex="5"> <legend md-colors="{color: \'default-primary-800\'}" class="md-title-small">{{\'subjectProgram.publicLevel\' | translate}}</legend> <div>&nbsp;</div> <div layout="column"> <md-checkbox disabled ng-model="subjectProgram.publicAll" aria-label="{{\'subjectProgram.publicAll\' | translate}}"> {{\'subjectProgram.publicAll\' | translate}} </md-checkbox> <md-checkbox disabled ng-model="subjectProgram.publicHois" aria-label="{{\'subjectProgram.publicHois\' | translate}}"> {{\'subjectProgram.publicHois\' | translate}} </md-checkbox> <md-checkbox disabled ng-model="subjectProgram.publicStudent" aria-label="{{\'subjectProgram.publicStudent\' | translate}}"> {{\'subjectProgram.publicStudent\' | translate}} </md-checkbox> </div> </fieldset> </div> <div flex class="form-readonly" layout="column" ng-if="!isPublic"> <div>&nbsp;</div> <md-input-container flex> <label class="textInput">{{\'subjectProgram.status\' | translate}}</label> <hois-classifier-value ng-model="subjectProgram.status" main-classifier-code="AINEPROGRAMM_STAATUS"></hois-classifier-value> </md-input-container> <md-input-container flex ng-if="subjectProgram.status === \'AINEPROGRAMM_STAATUS_K\'"> <label>{{\'subjectProgram.confirmedDate\' | translate}}</label> <hois-value value="subjectProgram.confirmed | hoisDateTime"></hois-value> </md-input-container> <md-input-container flex ng-if="subjectProgram.status === \'AINEPROGRAMM_STAATUS_K\'"> <label>{{\'subjectProgram.confirmedBy\' | translate}}</label> <hois-value value="subjectProgram.confirmedBy"></hois-value> </md-input-container> </div> <br> </div> <md-button class="md-raised md-primary" ng-if="!isPublic && subjectProgram.id\r\n      && (subjectProgram.subjectStudyPeriodTeacher.teacherId === userTeacherId || (auth.isAdmin() \r\n      && isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_AINEOPPETAJA\')))" ng-click="edit()">{{"main.button.change" | translate}}</md-button> <md-button class="md-raised" ng-if="!isPublic && subjectProgram.id && (isSupervisor || (auth.isAdmin()\r\n      && isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_AINEOPPETAJA\'))) && subjectProgram.status === \'AINEPROGRAMM_STAATUS_V\'" ng-click="confirm()">{{"main.button.confirm" | translate}}</md-button> <md-button class="md-raised" ng-if="!isPublic && subjectProgram.id && (isSupervisor || (auth.isAdmin()\r\n      && isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_AINEOPPETAJA\'))) && subjectProgram.status !== \'AINEPROGRAMM_STAATUS_I\'" ng-click="openRejectDialog()">{{"subjectProgram.operation.reject.label" | translate}}</md-button> <md-button class="md-raised" ng-if="subjectProgram.id" ng-href="{{pdfUrl()}}" target="_blank">{{"main.button.print" | translate}}</md-button> <md-button class="md-raised" ng-click="back(getDefaultBack())">{{"main.button.back" | translate}}</md-button> </form> </div> <style>.link-no-underline {\r\n    text-decoration: none;\r\n  }\r\n\r\n  .link-disabled {\r\n    color: #d7dde5;\r\n  }\r\n  .nomargin .form-readonly .md-input-has-value {\r\n    margin-top: 18px !important;\r\n  }</style>'),a.put("subjectStudyPeriod/subject.study.period.edit.html",'<div layout="column" layout-padding> <form name="subjectStudyPeriodEditForm"> <div layout="column"> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label>{{\'subjectStudyPeriod.studyPeriod\' | translate}}</label> <hois-select ng-model="record.studyPeriod" values="studyPeriods" disabled required></hois-select> </md-input-container> <md-input-container flex="50" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'subjectStudyPeriod.nameCode\' | translate}}</label> <hois-select ng-model="record.subject" values="subjects" ng-disabled="disableSubject" required></hois-select> </md-input-container> </div> <!--\r\n                hois-autocomplete is not suitable for this case as it has md-require-match attribute.\r\n                This autocomplete is supposed to be cleared after selecting an item as multiple teachers can be added\r\n            --> <md-autocomplete name="teacherInput" md-selected-item="teacher" md-search-text="queryText" md-items="item in querySearch(queryText)" md-item-text="item.nameEt" md-min-length="3" md-floating-label="{{\'subjectStudyPeriodTeacher.teacher\' | translate}} *" ng-model="queryText" md-no-cache class="small-margin" md-selected-item-change="addTeacher(teacher)"> <md-item-template> <span md-highlight-text="queryText" md-highlight-flags="^i">{{item.nameEt}}</span> </md-item-template> <md-not-found> {{\'main.messages.error.notFound\' | translate}} </md-not-found> </md-autocomplete> <table md-table class="secondary-table"> <tbody md-body> <tr md-row ng-repeat="teacher in record.teachers" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{teacher.name}}</td> <td md-cell ng-hide="record.teachers.length === 1"> <md-checkbox ng-model="teacher.isSignatory" aria-label="{{\'subjectStudyPeriodTeacher.isSignatory\' | translate}}"> {{\'subjectStudyPeriodTeacher.isSignatory\' | translate}} </md-checkbox> </td> <td md-cell> <md-button class="remove nomargin" ng-click="removeTeacher(teacher)" ng-show="obligatoryTeacher !== teacher.teacherId">&times;</md-button> </td> </tr> </tbody> </table> <div>&nbsp;</div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100" ng-if="!hasObligatoryStudentGroup"> <label>{{\'subjectStudyPeriod.studentGroups\' | translate}}</label> <hois-select ng-model="record.studentGroups" values="studentGroups" multiple ng-required="record.declarationType === \'DEKLARATSIOON_KOIK\'"></hois-select> </md-input-container> <md-input-container flex="10" flex-sm="100" flex-xs="100" ng-if="hasObligatoryStudentGroup"> <label>{{\'subjectStudyPeriod.studentGroupPreselected\' | translate}}</label> <input type="text" ng-model="studentGroup.code" readonly> </md-input-container> <md-input-container flex="30" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0" ng-if="hasObligatoryStudentGroup"> <label>{{\'subjectStudyPeriod.otherStudentGroups\' | translate}}</label> <hois-select ng-model="record.studentGroups" values="studentGroups" multiple></hois-select> </md-input-container> <md-input-container flex="50" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'subjectStudyPeriod.proportion\' | translate}}</label> <hois-classifier-select ng-model="record.groupProportion" model-value-attr="code" main-classifier-code="PAEVIK_GRUPI_JAOTUS" required></hois-classifier-select> </md-input-container> </div> <md-input-container> <label>{{\'subjectStudyPeriod.addInfo\' | translate}}</label> <textarea ng-model="record.addInfo" md-maxlength="20000" max-rows="2"></textarea> </md-input-container> <md-input-container> <label>{{\'subjectStudyPeriod.declaration\' | translate}}</label> <hois-classifier-select ng-model="record.declarationType" model-value-attr="code" main-classifier-code="DEKLARATSIOON"></hois-classifier-select> </md-input-container> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100" ng-if="record.id"> <label>{{\'moodle.courseId\' | translate}}</label> <input type="number" name="moodleCourseId" ng-model="record.moodleCourseId" max="9007199254740991"> <div class="md-errors-spacer"> <div class="md-char-counter">{{subjectStudyPeriodEditForm.moodleCourseId.$viewValue ? subjectStudyPeriodEditForm.moodleCourseId.$viewValue.length : 0}} / 16</div> </div> <div ng-messages="subjectStudyPeriodEditForm.moodleCourseId.$error" ng-show="subjectStudyPeriodEditForm.moodleCourseId.$dirty"> <div ng-message="max"> {{\'main.messages.error.max\' | translate: {max: 16} }} </div> </div> </md-input-container> </div> </div> <div layout="row"> <md-button class="md-raised md-primary" ng-click="save()">{{\'main.button.save\' | translate}}</md-button> <md-button class="md-raised md-default" ng-click="delete()" ng-if="record.id">{{\'main.button.delete\' | translate}}</md-button> <md-button class="md-raised" ng-click="back(\'#/subjectStudyPeriods\', subjectStudyPeriodEditForm)">{{\'main.button.back\' | translate}}</md-button> </div> </form> </div>'),a.put("subjectStudyPeriod/subject.study.period.search.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <form name="searchForm" ng-submit="load()" layout="column" novalidate ng-model-options="{allowInvalid: true}"> <div layout="row" layout-sm="column" layout-xs="column"> <div flex="45" flex-sm="100" flex-xs="100"> <hois-autocomplete ha-controller="directiveControllers" ng-model="criteria.subjectObject" url="/subjectStudyPeriods/autocomplete-subjects" name="student" label="subjectStudyPeriod.subject" no-paging="true"></hois-autocomplete> </div> <div flex="50" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0" ng-if="auth.isAdmin()"> <hois-autocomplete ha-controller="directiveControllers" ng-model="criteria.teacherObject" method="teachers" name="student" label="subjectStudyPeriod.teacher"></hois-autocomplete> </div> <div flex="50" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0" ng-if="auth.isTeacher()"> <hois-autocomplete ha-controller="directiveControllers" ng-model="criteria.studentObject" method="students" name="student" label="student.label"></hois-autocomplete> </div> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label>{{\'subjectStudyPeriod.studyPeriod\' | translate}}</label> <hois-select ng-model="criteria.studyPeriods" values="studyPeriods" required sorted-query="true"></hois-select> </md-input-container> <div flex="50" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0" ng-if="auth.isAdmin()"> <hois-autocomplete ha-controller="directiveControllers" ng-model="criteria.studentObject" method="students" name="student" label="student.label"></hois-autocomplete> </div> <md-input-container flex-gt-sm="50" flex="100" flex-offset-gt-sm="5" ng-if="auth.isTeacher()"> <label>{{\'subjectStudyPeriod.programStatus\' | translate}}</label> <md-select ng-model="criteria.programStatus"> <md-option ng-value=""></md-option> <md-option ng-value="status.code" ng-repeat="status in statusOptions">{{currentLanguageNameField(status)}}</md-option> </md-select> </md-input-container> </div> <div layout="row"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> </div> </form> </fieldset> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="s.{{currentLanguageNameField()}},s.code">{{\'subjectStudyPeriod.nameCode\' | translate}}</th> <th md-column>{{\'subjectStudyPeriod.teachersFullname\' | translate}}</th> <th md-column md-order-by="sp.{{currentLanguageNameField()}}">{{\'subjectStudyPeriod.studyPeriod\' | translate}}</th> <th md-column md-order-by="declared_students">{{\'subjectStudyPeriod.declaredStudentsNumber\' | translate}}</th> <th md-column>{{\'subjectProgram.label\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell><a href="#/subjectStudyPeriod/{{::row.id}}/view">{{currentLanguageNameField(row.subject)}}</a></td> <td md-cell> <table> <tr ng-repeat="teacher in row.teachers | orderBy"> <td><a href="#/subjectStudyPeriod/{{::row.id}}/view">{{teacher}}</a></td> </tr> </table> </td> <td md-cell>{{currentLanguageNameField(row.studyPeriod)}}</td> <td md-cell><a href="#/subjectStudyPeriods/{{::row.id}}/midtermTasks/studentResults">{{::row.studentsNumber}}</a></td> <td md-cell ng-if="auth.isTeacher()"> <p class="nomargin"> <hois-classifier-value ng-model="row.subjectProgramStatus" main-classifier-code="AINEPROGRAMM_STAATUS"></hois-classifier-value> </p> <div> <md-button md-no-ink class="md-primary change-button" ng-if="row.subjectProgramStatus === \'AINEPROGRAMM_STAATUS_L\'" style="padding:0 !important; margin: 0 !important; min-width: 0 !important" ng-href="#/subjectProgram/{{::row.subject.id}}/{{::row.id}}/periods/new">{{\'main.button.create\' | translate}}</md-button> <md-button md-no-ink class="md-primary change-button" ng-if="row.subjectProgramStatus === \'AINEPROGRAMM_STAATUS_I\'" style="padding:0 !important; margin: 0 !important; min-width: 0 !important" ng-href="#/subjectProgram/periods/{{::row.subjectProgramId}}/edit">{{\'main.button.change\' | translate}}</md-button> <md-button md-no-ink class="md-primary change-button" ng-if="row.subjectProgramStatus === \'AINEPROGRAMM_STAATUS_V\' || row.subjectProgramStatus === \'AINEPROGRAMM_STAATUS_K\'" style="padding:0 !important; margin: 0 !important; min-width: 0 !important" ng-href="#/subjectProgram/periods/{{::row.subjectProgramId}}/view">{{\'main.button.view\' | translate}}</md-button> </div> </td> <td md-cell ng-if="!auth.isTeacher()"> <table> <tr ng-repeat="program in row.programs | orderBy: \'teacherName\'"> <td> {{program.teacherName}} (<hois-classifier-value ng-model="program.status" main-classifier-code="AINEPROGRAMM_STAATUS" style="display: inline"> </hois-classifier-value>)<span ng-if="isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_AINEOPPETAJA\')">: <md-button md-no-ink class="md-primary change-button" ng-if="program.status === \'AINEPROGRAMM_STAATUS_L\'" style="padding:0 !important; margin: 0 !important; min-width: 0 !important" ng-href="#/subjectProgram/{{::row.subject.id}}/{{::row.id}}/periods/new?teacher={{::program.teacherId}}">{{\'main.button.create\' | translate}}</md-button> <md-button md-no-ink class="md-primary change-button" ng-if="program.status === \'AINEPROGRAMM_STAATUS_I\'" style="padding:0 !important; margin: 0 !important; min-width: 0 !important" ng-href="#/subjectProgram/periods/{{::program.id}}/edit">{{\'main.button.change\' | translate}}</md-button> <md-button md-no-ink class="md-primary change-button" ng-if="program.status === \'AINEPROGRAMM_STAATUS_V\' || program.status === \'AINEPROGRAMM_STAATUS_K\'" style="padding:0 !important; margin: 0 !important; min-width: 0 !important" ng-href="#/subjectProgram/periods/{{::program.id}}/view">{{\'main.button.view\' | translate}}</md-button> </span><span ng-if="!isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_AINEOPPETAJA\')">: <md-button md-no-ink class="md-primary change-button" ng-if="program.status !== \'AINEPROGRAMM_STAATUS_L\'" style="padding:0 !important; margin: 0 !important; min-width: 0 !important" ng-href="#/subjectProgram/periods/{{::program.id}}/view">{{\'main.button.view\' | translate}}</md-button> </span> </td> </tr> </table> </td> <td md-cell> <md-button md-no-ink class="md-primary change-button" ng-if="isAuthorized([\'ROLE_OIGUS_M_TEEMAOIGUS_AINEOPPETAJA\', \'ROLE_OIGUS_M_TEEMAOIGUS_PAEVIK\'])" ng-href="#/subjectStudyPeriod/{{::row.id}}/edit">{{\'main.button.change\' | translate}}</md-button> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> </div>'),
a.put("subjectStudyPeriod/subject.study.period.view.html",'<div layout="column" layout-padding> <form name="subjectStudyPeriodEditForm"> <div layout="column" class="form-readonly"> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label>{{\'subjectStudyPeriod.studyPeriod\' | translate}}</label> <hois-select ng-model="record.studyPeriod" values="studyPeriods" disabled required></hois-select> </md-input-container> <md-input-container flex="50" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'subjectStudyPeriod.nameCode\' | translate}}</label> <hois-select ng-model="record.subject" values="subjects" disabled required></hois-select> </md-input-container> </div> <h2 ng-show="record.teachers.length > 0">{{\'subjectStudyPeriod.teacher\' | translate}}</h2> <table md-table class="secondary-table"> <tbody md-body> <tr md-row ng-repeat="teacher in record.teachers" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{teacher.name}}</td> <td md-cell ng-hide="record.teachers.length === 1"> <md-checkbox ng-model="teacher.isSignatory" disabled aria-label="{{\'subjectStudyPeriodTeacher.isSignatory\' | translate}}"> {{\'subjectStudyPeriodTeacher.isSignatory\' | translate}} </md-checkbox> </td> </tr> </tbody> </table> <div>&nbsp;</div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label>{{\'subjectStudyPeriod.studentGroups\' | translate}}</label> <hois-select ng-model="record.studentGroups" values="studentGroups" multiple disabled></hois-select> </md-input-container> <md-input-container flex="50" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'subjectStudyPeriod.proportion\' | translate}}</label> <hois-classifier-select ng-model="record.groupProportion" model-value-attr="code" main-classifier-code="PAEVIK_GRUPI_JAOTUS" required disabled></hois-classifier-select> <!--<hois-classifier-value ng-model="record.groupProportion" main-classifier-code="PAEVIK_GRUPI_JAOTUS"></hois-classifier-value>--> </md-input-container> </div> <md-input-container> <label>{{\'subjectStudyPeriod.addInfo\' | translate}}</label> <hois-value value="record.addInfo"></hois-value> </md-input-container> <md-input-container> <label>{{\'subjectStudyPeriod.declaration\' | translate}}</label> <hois-classifier-value ng-model="record.declarationType" main-classifier-code="DEKLARATSIOON"></hois-classifier-value> </md-input-container> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label>{{\'moodle.courseId\' | translate}}</label> <hois-value value="record.moodleCourseId"></hois-value> </md-input-container> </div> </div> <div layout="row"> <md-button class="md-primary md-raised" ng-if="isAuthorized([\'ROLE_OIGUS_M_TEEMAOIGUS_AINEOPPETAJA\', \'ROLE_OIGUS_M_TEEMAOIGUS_PAEVIK\'])" ng-href="#/subjectStudyPeriod/{{::record.id}}/edit">{{\'main.button.change\' | translate}}</md-button> <md-button class="md-raised" ng-click="back(\'#/subjectStudyPeriods\')">{{\'main.button.back\' | translate}}</md-button> </div> </form> </div>'),a.put("subjectStudyPeriod/teacher.capacities.tmpl.html",'<md-dialog aria-label="teacher capacities dialog" flex="80" flex-sm="80" flex-xs="100"> <form name="dialogForm" ng-submit="dialogForm.$valid && submit()" novalidate ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2>{{\'subjectStudyPeriod.teacherSpecificLoads\' | translate}}</h2> <span flex></span> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <div class="md-dialog-content"> <md-checkbox ng-model="subject.capacityDiff" aria-label="{{\'subjectStudyPeriod.loadsDiffer\' | translate}}"> {{\'subjectStudyPeriod.loadsDiffer\' | translate}} </md-checkbox> <md-table-container> <table class="subject-study-period"> <thead> <tr> <th>{{\'subjectStudyPeriod.label.teachers\' | translate}}</th> <th ng-repeat="capacityType in capacityTypes">{{capacityType.value.toUpperCase()}}</th> <th>{{\'subjectStudyPeriod.overall\' | translate}}</th> </tr> </thead> <tbody> <tr ng-repeat="teacher in subject.teachers"> <td> <!-- TODO: teachers load per teacher ??? \r\n                  ng-class="{\'invalid\': !capacitiesUtil.teachersLoadOk(ssp)}"\r\n                  --> <span ng-class="{\'invalid\': !capacitiesUtil.teacherLoadOk(teacher)}">{{teacher.name}}</span> </td> <td ng-repeat="type in capacityTypes"> <span ng-repeat="capacity in teacher.capacities | filter:{ capacityType: type.code } : true"> <input type="number" ng-model="capacity.hours" min="0" max="1000" aria-label="{{\'subjectStudyPeriod.changeLoad\' | translate}}" pattern="^\\d+$" ng-disabled="!subject.capacityDiff"> </span> </td> <td class="bold">{{capacitiesUtil.capacitiesSumBySsp(teacher)}}</td> </tr> <tr class="bold"> <td>{{\'subjectStudyPeriod.subjectTeacherPairTotal\' | translate}}</td> <td ng-repeat="type in capacityTypes">{{capacitiesUtil.capacityBySsp(subject, type.code)}}</td> <td class="bold">{{capacitiesUtil.capacitiesSumBySsp(subject)}}</td> </tr> </tbody> </table> </md-table-container> </div> </md-dialog-content> <span flex></span> <md-dialog-actions layout="row" layout-align="start center"> <md-button class="md-raised md-primary" ng-click="submit()">{{"main.button.save" | translate}}</md-button> <md-button class="md-raised" ng-click="cancel()">{{"main.button.close" | translate}}</md-button> </md-dialog-actions> </form> </md-dialog>'),a.put("subjectStudyPeriodPlan/subject.study.period.plan.edit.html",'<div layout="column" layout-padding> <form name="subjectStudyPeriodPlanEditForm"> <div layout="column"> <div layout="row" layout-sm="column" layout-xs="column" class="form-readonly"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label>{{\'subjectStudyPeriodPlan.studyPeriod\' | translate}}</label> <hois-value value="currentLanguageNameField(studyPeriod)"></hois-value> </md-input-container> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label>{{\'subjectStudyPeriodPlan.subject\' | translate}}</label> <hois-value value="currentLanguageNameField(subject)"></hois-value> </md-input-container> </div> <h2>{{\'subjectStudyPeriodPlan.volumes\' | translate}}</h2> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column></th> <th md-column>{{\'subjectStudyPeriodPlan.volume\' | translate}}</th> <th md-column>{{\'subjectStudyPeriodPlan.isContact\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="capacity in record.capacities | orderBy: \'capacityType\'" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell> <hois-classifier-value ng-model="capacity.capacityType" main-classifier-code="MAHT"></hois-classifier-value> </td> <td md-cell> <md-input-container> <input ng-model="capacity.hours" type="number" min="0" max="1000" pattern="^\\d+$" ng-readonly="readOnly" aria-label="{{\'subjectStudyPeriodPlan.volume\' | translate}}"> </md-input-container> </td> <td md-cell> <md-checkbox ng-model="capacity.isContact" aria-label="{{\'subjectStudyPeriodPlan.isContact\' | translate}}" ng-disabled="readOnly"></md-checkbox> </td> </tr> </tbody> </table> <h2>{{\'subjectStudyPeriodPlan.volumeTotal\' | translate}}: {{getTotalCapacity()}}</h2> <br> <h2>{{\'subjectStudyPeriodPlan.validInCurriculums\' | translate}}</h2> <div layout="row"> <md-checkbox ng-repeat="curriculum in curriculums" ng-model="curriculum.selected" aria-label="{{\'subjectStudyPeriodPlan.validInCurriculums\' | translate}}" ng-disabled="readOnly"> {{currentLanguageNameField(curriculum)}} </md-checkbox> </div> <h2>{{\'subjectStudyPeriodPlan.validInStudyForms\' | translate}}</h2> <div layout="row"> <md-checkbox ng-repeat="studyForm in studyForms" ng-model="studyForm.selected" aria-label="{{\'subjectStudyPeriodPlan.validInCurriculums\' | translate}}" ng-disabled="readOnly"> {{currentLanguageNameField(studyForm)}} </md-checkbox> </div> </div> <div layout="row"> <md-button ng-if="!readOnly" class="md-raised md-primary" ng-click="save()">{{\'main.button.save\' | translate}}</md-button> <md-button ng-if="!readOnly && record.id" class="md-raised md-default" ng-click="delete()">{{\'main.button.delete\' | translate}}</md-button> <md-button class="md-raised" ng-click="back(\'/#/subjectStudyPeriodPlans\', subjectStudyPeriodPlanEditForm)">{{\'main.button.back\' | translate}}</md-button> </div> </form> </div>'),a.put("subjectStudyPeriodPlan/subject.study.period.plan.search.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <p class="md-body-1"> <span ng-repeat="capacity in capacityTypes"> <span ng-if="$index !== 0">|</span> {{capacity.value.toUpperCase()}} - {{currentLanguageNameField(capacity)}} </span> </p> <br> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <form name="searchForm" ng-submit="load()" layout="column" novalidate> <md-input-container> <label class="textInput">{{\'subjectStudyPeriodPlan.studyPeriod\' | translate}}</label> <hois-select ng-model="criteria.studyPeriod" values="studyPeriods" required sorted-query="true"></hois-select> </md-input-container> <hois-autocomplete flex="50" flex-sm="100" flex-xs="100" ng-model="criteria.curriculum" ha-controller="directiveControllers" ha-search="searchCurriculums" label="subjectStudyPeriodPlan.curriculum"></hois-autocomplete> <hois-autocomplete ha-controller="directiveControllers" ng-model="criteria.subjectObject" url="/subjectStudyPeriodPlans/subjects" name="subject" label="subjectStudyPeriodPlan.subject" additional-query-params="subjectQueryParams"></hois-autocomplete> <div layout="row"> <md-button type="submit" class="md-raised md-primary" ng-click="checkIfStudyPeriodIsPast()">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> </div> </form> </fieldset> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="{{currentLanguageNameField()}}">{{\'subjectStudyPeriodPlan.subject\' | translate}} / {{\'subjectStudyPeriodPlan.curriculum\' | translate}}</th> <th md-column>{{\'subjectStudyPeriodPlan.studyForm\' | translate}}</th> <th md-column class="center" ng-repeat="capacityType in capacityTypes"> {{capacityType.value.toUpperCase()}} </th> <th md-column></th> </tr> </thead> <tbody md-body ng-repeat="row in tabledata.content"> <tr md-row ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{currentLanguageNameField(row.subject)}}</td> <td md-cell colspan="{{capacityTypes.length + 1}}"></td> <td md-cell> <md-button md-no-ink class="md-primary change-button" ng-if="canEdit" ng-href="#/subjectStudyPeriodPlans/{{::row.subject.id}}/{{criteria.studyPeriod}}/new" ng-disabled="pastStudyPeriodSelected">{{\'subjectStudyPeriodPlan.add\' | translate}} </md-button> </td> </tr> <tr md-row ng-repeat="plan in row.plans | orderBy: \'id\'"> <td md-cell class="cell"> <span ng-repeat="curriculum in plan.curriculums | orderBy: \'id\'"> <span ng-if="$index > 0">, </span> {{currentLanguageNameField(curriculum)}} </span> </td> <td md-cell class="cell"> <span ng-repeat="studyForm in plan.studyForms | orderBy: currentLanguageNameField()"> <span ng-if="$index > 0">, </span> {{currentLanguageNameField(studyForm)}} </span> </td> <td md-cell class="cell center" ng-repeat="capacityType in capacityTypes"> {{getCapacitiesHours(capacityType.code, plan)}} </td> <td md-cell class="cell"> <md-button md-no-ink class="md-primary change-button" ng-if="canEdit" ng-href="#/subjectStudyPeriodPlans/{{::plan.id}}/edit" ng-disabled="pastStudyPeriodSelected">{{\'main.button.change\' | translate}} </md-button> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> </div> <style>.cell {\r\n        border: 1px solid #e8ebef;\r\n    }\r\n    .center {\r\n        text-align: center !important;\r\n    }</style>'),a.put("teacher/teacher.continuing.education.edit.html",'<md-nav-bar md-selected-nav-item="currentNavItem" nav-bar-aria-label="main selection" ng-cloak> <md-nav-item ng-if="auth.isAdmin()" md-nav-href="#/teachers/{{::teacher.id}}/edit?_noback" name="teacher.data"> {{\'teacher.data\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isTeacher()" md-nav-href="#/teachers/{{::teacher.id}}/editmydata?_noback" name="teacher.data"> {{\'teacher.data\' | translate}}</md-nav-item> <md-nav-item ng-if="(auth.isAdmin() && teacher.id && teacher.isVocational) || (auth.isTeacher() && teacher.isVocational)" md-nav-href="#/teachers/{{::teacher.id}}/continuingEducation?_noback" name="teacher.continuingEducation"> {{\'teacher.continuingEducation.label\' | translate}}</md-nav-item> <md-nav-item ng-if="(auth.isAdmin() && teacher.id) || (teacher.teacherQualifications.length > 0 && auth.isTeacher())" md-nav-href="#/teachers/{{::teacher.id}}/qualification?_noback" name="teacher.qualification"> {{\'teacher.qualification.qualification\' | translate}}</md-nav-item> <md-nav-item ng-if="(auth.isAdmin() && teacher.id && teacher.isHigher && isHigher) || (auth.isTeacher() && teacher.teacherMobility.length > 0)" md-nav-href="#/teachers/{{::teacher.id}}/mobility?_noback" name="teacher.mobility"> {{\'teacher.mobility.mobility\' | translate}}</md-nav-item> <md-nav-item ng-if="(auth.isAdmin() && teacher.id) || auth.isTeacher()" md-nav-href="#/teachers/{{::teacher.id}}/rtipAbsence?_noback" name="teacher.rtipAbsence"> {{\'teacher.rtipAbsence.label\' | translate}}</md-nav-item> <md-nav-item ng-if="((auth.isAdmin() && teacher.id) || auth.isTeacher()) && teacher.isHigher" md-nav-href="#/teachers/{{::teacher.id}}/programs?_noback" name="teacher.programs"> {{\'teacher.subjectPrograms.label\' | translate}}</md-nav-item> </md-nav-bar> <md-content class="md-padding"> <div>&nbsp;</div> <div layout="row" layout-xs="column" flex class="form-readonly"> <div layout="row" layout-sm="column" layout-xs="column" flex> <md-input-container flex> <label>{{auth.higher ? (\'teacher.person.nameHigher\' | translate) : (\'teacher.person.nameVocational\' | translate)}}</label> <hois-value value="teacher.person.firstname + \' \' + teacher.person.lastname"></hois-value> </md-input-container> <md-input-container flex> <label>{{auth.higher ? (\'teacher.person.idcodeHigher\' | translate) : (\'teacher.person.idcodeVocational\' | translate)}}</label> <hois-value value="teacher.person.idcode"></hois-value> </md-input-container> </div> </div> <form name="continuingEducationsForm" class="nomargin" novalidate> <md-button ng-click="newTeacherContinuingEducation()" class="md-raised">{{\'teacher.continuingEducation.add\' | translate}}</md-button> <div ng-repeat="continuingEducation in teacherContinuingEducations.continuingEducations | orderBy: \'-id\'"> <hois-collapsable label="(\'teacher.continuingEducation.continuingEducation\' | translate)"> <div layout="column" flex> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="25" flex-sm="100" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.continuingEducation.school\' | translate}}</label> <hois-classifier-select ng-model="continuingEducation.school" main-classifier-code="EHIS_TAIEND_OPPEAS" model-value-attr="code" ng-required="!continuingEducation.otherSchool" ng-disabled="continuingEducation.otherSchool" show-empty></hois-classifier-select> </md-input-container> <md-input-container flex="25" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.continuingEducation.otherSchool\' | translate}}</label> <textarea ng-model="continuingEducation.otherSchool" name="continuingEducation[{{$index}}].otherSchool" md-maxlength="1000" max-rows="2" ng-required="!continuingEducation.school" ng-disabled="continuingEducation.school"></textarea> <div ng-messages="continuingEducationsForm[\'continuingEducation[\'+$index+\'].otherSchool\'].$error"> <div ng-message="md-maxlength"> {{\'main.messages.error.maxlength\' | translate}} </div> </div> </md-input-container> <md-input-container flex="25" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.continuingEducation.field\' | translate}}</label> <hois-classifier-select ng-model="continuingEducation.field" main-classifier-code="EHIS_TAIEND_VALDKOND" model-value-attr="code" required></hois-classifier-select> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="25" flex-sm="100" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.continuingEducation.name\' | translate}}</label> <textarea ng-model="continuingEducation.nameEt" name="continuingEducation[{{$index}}].nameEt" md-maxlength="1000" required></textarea> <div ng-messages="continuingEducationsForm[\'continuingEducation[\'+$index+\'].nameEt\'].$error"> <div ng-message="md-maxlength"> {{\'main.messages.error.maxlength\' | translate}} </div> </div> </md-input-container> <md-input-container flex="25" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.continuingEducation.capacity\' | translate}}</label> <input ng-model="continuingEducation.capacity" name="continuingEducation[{{$index}}].capacity" type="number" min="0" max="9999" required> <div ng-messages="continuingEducationsForm[\'continuingEducation[\'+$index+\'].capacity\'].$error"> <div ng-message="max"> {{\'main.messages.error.max\' | translate: {max: 9999} }} </div> <div ng-message="min"> {{\'main.messages.error.min\' | translate: {min: 0} }} </div> </div> </md-input-container> <md-input-container flex="25" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.continuingEducation.diplomaCode\' | translate}}</label> <hois-classifier-select ng-model="continuingEducation.diploma" main-classifier-code="EHIS_TAIEND_DOK" model-value-attr="code" required></hois-classifier-select> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="25" flex-sm="100" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.continuingEducation.diplomaDate\' | translate}}</label> <md-datepicker ng-model="continuingEducation.diplomaDate" required md-open-on-focus></md-datepicker> </md-input-container> <md-input-container flex="25" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.continuingEducation.diplomaNr\' | translate}}</label> <input ng-model="continuingEducation.diplomaNr" name="continuingEducation[{{$index}}].diplomaNr" md-maxlength="100" type="text"> <div ng-messages="continuingEducationsForm[\'continuingEducation[\'+$index+\'].diplomaNr\'].$error"> <div ng-message="md-maxlength"> {{\'main.messages.error.maxlength\' | translate}} </div> </div> </md-input-container> <md-input-container flex="25" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <md-checkbox ng-model="continuingEducation.isAbroad">{{\'teacher.continuingEducation.isAbroad\' | translate}}</md-checkbox> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="25" flex-sm="100" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.continuingEducation.abroadDescription\' | translate}}</label> <textarea ng-model="continuingEducation.abroadDesc" name="continuingEducation[{{$index}}].abroadDesc" md-maxlength="4000" max-rows="5" ng-disabled="!continuingEducation.isAbroad"></textarea> <div ng-messages="continuingEducationsForm[\'continuingEducation[\'+$index+\'].abroadDesc\'].$error"> <div ng-message="md-maxlength"> {{\'main.messages.error.maxlength\' | translate}} </div> </div> </md-input-container> </div> </div> <md-button ng-click="deleteContinuingEducation(continuingEducation)" class="md-raised">{{\'main.button.delete\' | translate}}</md-button> </hois-collapsable> </div> <md-button ng-click="updateContinuingEducations()" class="md-raised md-primary" ng-if="teacherContinuingEducations.continuingEducations.length > 0"> {{\'main.button.save\' | translate}} </md-button> <md-button ng-if="auth.isTeacher()" ng-click="back(\'#/teachers/myData\')" class="md-raised">{{\'main.button.back\' | translate}}</md-button> <md-button ng-if="auth.isAdmin()" ng-click="back(\'#/teachers\', continuingEducationsForm)" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </form> </md-content>'),a.put("teacher/teacher.continuing.education.view.html",'<div class="ois-form-layout form-readonly"> <div flex> <div>&nbsp;</div> <div layout="row" layout-xs="column" flex class="form-readonly"> <div layout="row" layout-sm="column" layout-xs="column" flex> <md-input-container flex> <label>{{auth.higher ? (\'teacher.person.nameHigher\' | translate) : (\'teacher.person.nameVocational\' | translate)}}</label> <hois-value value="teacher.person.firstname + \' \' + teacher.person.lastname"></hois-value> </md-input-container> <md-input-container flex> <label>{{auth.higher ? (\'teacher.person.idcodeHigher\' | translate) : (\'teacher.person.idcodeVocational\' | translate)}}</label> <hois-value value="teacher.person.idcode"></hois-value> </md-input-container> </div> </div> <div ng-repeat="continuingEducation in teacher.teacherContinuingEducations"> <hois-collapsable label="(\'teacher.continuingEducation.continuingEducation\' | translate)"> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="25" flex-sm="100" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.continuingEducation.school\' | translate}}</label> <hois-classifier-value ng-model="continuingEducation.school" main-classifier-code="EHIS_TAIEND_OPPEAS"></hois-classifier-value> </md-input-container> <md-input-container flex="25" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.continuingEducation.otherSchool\' | translate}}</label> <hois-value value="continuingEducation.otherSchool"></hois-value> </md-input-container> <md-input-container flex="25" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.continuingEducation.field\' | translate}}</label> <hois-classifier-value ng-model="continuingEducation.field" main-classifier-code="EHIS_TAIEND_VALDKOND"></hois-classifier-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="25" flex-sm="100" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.continuingEducation.name\' | translate}}</label> <hois-value value="continuingEducation.nameEt"></hois-value> </md-input-container> <md-input-container flex="25" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.continuingEducation.capacity\' | translate}}</label> <hois-value value="continuingEducation.capacity"></hois-value> </md-input-container> <md-input-container flex="25" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.continuingEducation.diplomaCode\' | translate}}</label> <hois-classifier-value ng-model="continuingEducation.diploma" main-classifier-code="EHIS_TAIEND_DOK"></hois-classifier-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="25" flex-sm="100" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.continuingEducation.diplomaDate\' | translate}}</label> <hois-value value="continuingEducation.diplomaDate | hoisDate"></hois-value> </md-input-container> <md-input-container flex="25" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.continuingEducation.diplomaNr\' | translate}}</label> <hois-value value="continuingEducation.diplomaNr"></hois-value> </md-input-container> <md-input-container flex="25" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <md-checkbox ng-model="continuingEducation.isAbroad" disabled>{{\'teacher.continuingEducation.isAbroad\' | translate}}</md-checkbox> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="25" flex-sm="100" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.continuingEducation.abroadDescription\' | translate}}</label> <hois-value value="continuingEducation.abroadDesc"></hois-value> </md-input-container> </div> </hois-collapsable> </div> </div> <div layout="row" layout-margin> <md-button ng-if="(auth.isAdmin() && teacher.id && teacher.isVocational) || (auth.isTeacher() && teacher.isVocational)" ng-href="#/teachers/{{teacher.id}}/continuingEducation" class="md-primary md-raised">{{\'main.button.change\' | translate}}</md-button> </div> </div>'),a.put("teacher/teacher.edit.html",'<md-nav-bar md-selected-nav-item="currentNavItem" nav-bar-aria-label="main selection" ng-cloak> <md-nav-item ng-if="auth.isAdmin() && teacher.id" md-nav-href="#/teachers/{{::teacher.id}}/edit?_noback" name="teacher.data"> {{\'teacher.data\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isTeacher()" md-nav-href="#/teachers/{{::teacher.id}}/editmydata?_noback" name="teacher.data"> {{\'teacher.data\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && !teacher.id" md-nav-href="#/teachers/new?_noback" name="teacher.data"> {{\'teacher.data\' | translate}}</md-nav-item> <md-nav-item ng-if="(auth.isAdmin() && teacher.id && teacher.isVocational) || (auth.isTeacher() && teacher.isVocational)" md-nav-href="#/teachers/{{::teacher.id}}/continuingEducation?_noback" name="teacher.continuingEducation"> {{\'teacher.continuingEducation.label\' | translate}}</md-nav-item> <md-nav-item ng-if="(auth.isAdmin() && teacher.id) || (teacher.teacherQualifications.length > 0 && auth.isTeacher())" md-nav-href="#/teachers/{{::teacher.id}}/qualification?_noback" name="teacher.qualification"> {{\'teacher.qualification.qualification\' | translate}}</md-nav-item> <md-nav-item ng-if="(auth.isAdmin() && teacher.id && teacher.isHigher && isHigher) || (auth.isTeacher() && teacher.teacherMobility.length > 0)" md-nav-href="#/teachers/{{::teacher.id}}/mobility?_noback" name="teacher.mobility"> {{\'teacher.mobility.mobility\' | translate}}</md-nav-item> <md-nav-item ng-if="(auth.isAdmin() && teacher.id) || auth.isTeacher()" md-nav-href="#/teachers/{{::teacher.id}}/rtipAbsence?_noback" name="teacher.rtipAbsence"> {{\'teacher.rtipAbsence.label\' | translate}}</md-nav-item> <md-nav-item ng-if="((auth.isAdmin() && teacher.id) || auth.isTeacher()) && teacher.isHigher" md-nav-href="#/teachers/{{::teacher.id}}/programs?_noback" name="teacher.programs"> {{\'teacher.subjectPrograms.label\' | translate}}</md-nav-item> </md-nav-bar> <div class="ois-form-layout-padding" layout="column" ng-cloak> <form name="teacherForm" role="form" class="nomargin" novalidate> <hois-collapsable label="(\'teacher.data\' | translate)"> <div layout="column" flex> <div layout="row" layout-sm="column" layout-xs="column"> <!--\r\n            different elements are used for entering and displaying as in other case\r\n            teacher\'s unique check will be trigered even with disabled autocomplete\r\n            which can prevent form from saving.\r\n\r\n            hois-value is not used as id did not match whole page design\r\n          --> <md-input-container flex="25" flex-sm="100" flex-xs="100" ng-if="!teacher.id"> <label>{{auth.higher ? (\'teacher.person.idcodeHigher\' | translate) : (\'teacher.person.idcodeVocational\' | translate)}}</label> <hois-idcode-lookup ng-model="teacher.person.idcode" name="idcode" role="forteacher" after-lookup="lookupPerson(response)" after-failed-lookup="lookupFailure()" no-lookup="cleanReadOnly()" ng-required="teacher.person.citizenship === \'RIIK_EST\'"></hois-idcode-lookup> <div ng-messages="teacherForm.idcode.$error" ng-show="teacherForm.idcode.$dirty"> <div ng-message="teacherIdCode"> {{auth.higher ? (\'teacher.person.alreadyExistHigher\' | translate) : (\'teacher.person.alreadyExistVocational\' | translate)}} </div> </div> </md-input-container> <md-input-container flex-sm="100" flex-xs="100" flex="25" ng-if="teacher.id"> <label>{{auth.higher ? (\'teacher.person.idcodeHigher\' | translate) : (\'teacher.person.idcodeVocational\' | translate)}}</label> <input type="text" ng-model="teacher.person.idcode" readonly> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.person.birthdate\' | translate}}</label> <md-datepicker ng-model="teacher.person.birthdate" md-max-date="maxDate" ng-disabled="teacher.person.idcode" required md-open-on-focus></md-datepicker> </md-input-container> <md-input-container flex="10" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.person.sex\' | translate}}</label> <hois-classifier-select ng-model="teacher.person.sex" main-classifier-code="SUGU" model-value-attr="code" ng-disabled="teacher.person.idcode" required></hois-classifier-select> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="25" flex-sm="100" flex-xs="100"> <label>{{auth.higher ? (\'teacher.person.firstnameHigher\' | translate) : (\'teacher.person.firstnameVocational\' | translate)}}</label> <input ng-model="teacher.person.firstname" name="firstname" type="text" ng-blur="generateEmail()" required md-maxlength="100"> <div ng-messages="teacherForm.firstname.$error"> <div ng-message="md-maxlength"> {{\'main.messages.error.maxlength\' | translate}} </div> </div> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{auth.higher ? (\'teacher.person.lastnameHigher\' | translate) : (\'teacher.person.lastnameVocational\' | translate)}}</label> <input ng-model="teacher.person.lastname" name="lastname" type="text" ng-blur="generateEmail()" required md-maxlength="100"> <div ng-messages="teacherForm.lastname.$error"> <div ng-message="md-maxlength"> {{\'main.messages.error.maxlength\' | translate}} </div> </div> </md-input-container> <md-input-container flex="45" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.person.nativeLanguage\' | translate}}</label> <hois-classifier-select ng-model="teacher.nativeLanguage" main-classifier-code="EHIS_EMAKEEL" model-value-attr="code" required></hois-classifier-select> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="25" flex-sm="100" flex-xs="100"> <label>{{\'teacher.person.citizenship\' | translate}}</label> <hois-classifier-select ng-model="teacher.person.citizenship" main-classifier-code="RIIK" model-value-attr="code" required></hois-classifier-select> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.person.phone\' | translate}}</label> <input ng-model="teacher.person.phone" name="personphone" type="text" md-maxlength="100"> <div ng-messages="teacherForm.personphone.$error"> <div ng-message="md-maxlength"> {{\'main.messages.error.maxlength\' | translate}} </div> </div> </md-input-container> <md-input-container flex="45" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.person.email\' | translate}}</label> <input ng-model="teacher.person.email" name="personemail" type="email" md-maxlength="100"> <div ng-messages="teacherForm.personemail.$error"> <div ng-message="md-maxlength"> {{\'main.messages.error.maxlength\' | translate}} </div> </div> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container class="md-block" flex="25" flex-sm="100" flex-xs="100"> <label>{{\'teacher.occupation.label\' | translate}}</label> <md-select ng-model="teacher.teacherOccupation.id" required> <md-option></md-option> <md-option ng-repeat="occupation in occupations" ng-value="occupation.id"> {{currentLanguage()===\'en\' ? (occupation.occupationEn || occupation.occupationEt) : occupation.occupationEt}} </md-option> </md-select> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.phone\' | translate}}</label> <input ng-model="teacher.phone" name="phone" type="text" md-maxlength="100"> <div ng-messages="teacherForm.phone.$error"> <div ng-message="md-maxlength"> {{\'main.messages.error.maxlength\' | translate}} </div> </div> </md-input-container> <md-input-container flex="45" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.email\' | translate}}</label> <input ng-model="teacher.email" name="email" type="email" required md-maxlength="100"> <div ng-messages="teacherForm.email.$error"> <div ng-message="md-maxlength"> {{\'main.messages.error.maxlength\' | translate}} </div> </div> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="25" flex-sm="100" flex-xs="100" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.scheduleLoad\' | translate}}</label> <input ng-model="teacher.scheduleLoad" name="scheduleLoad" type="number" required min="0" max="9999"> <div ng-messages="teacherForm.scheduleLoad.$error"> <div ng-message="min"> {{\'main.messages.error.min\' | translate: {min: 0} }} </div> <div ng-message="max"> {{\'main.messages.error.max\' | translate: {max: 9999} }} </div> </div> </md-input-container> <!-- todo: alert or check for need for alert --> <div layout="row" flex="70" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0" layout-sm="column" layout-xs="column"> <md-radio-group ng-model="teacher.isStudyPeriodScheduleLoad" required class="align-center"> <md-radio-button ng-value="true"> {{\'teacher.studyPeriodLoad\' | translate}}&nbsp;&nbsp;&nbsp; </md-radio-button> <md-radio-button ng-value="false"> {{\'teacher.studyYearLoad\' | translate}} </md-radio-button> </md-radio-group> <div flex-offset="5" flex-offset-xs="0" flex-offset-sm="0" md-colors="{color: \'warn-A400\'}" ng-if="teacherForm.$submitted && teacher.isStudyPeriodScheduleLoad !== true && teacher.isStudyPeriodScheduleLoad !== false" class="md-title-very-small" style="margin-top:12px"> <div>{{\'main.messages.error.inputFieldIsRequired\' | translate}}</div> </div> </div> </div> <!----> <div layout="row" flex layout-align="none center"> <md-checkbox ng-model="teacher.isVocational" ng-required="!teacher.isVocational && !teacher.isHigher"> {{\'teacher.isVocational\' | translate}} </md-checkbox> <md-checkbox ng-model="teacher.isHigher" ng-required="!teacher.isVocational && !teacher.isHigher"> {{\'teacher.isHigher\' | translate}} </md-checkbox> </div> <div md-colors="{color: \'warn-A400\'}" ng-if="teacherForm.$submitted && !teacher.isVocational && !teacher.isHigher" class="md-title-very-small" style="margin-top:-12px"> <div>{{\'main.messages.error.inputFieldIsRequired\' | translate}}</div> </div> <div layout="row" layout-sm="column" layout-xs="column" flex> <div flex="25" flex-sm="100" flex-xs="100" layout-align="none center" layout="row"> <md-checkbox ng-model="teacher.isActive"> {{\'teacher.isActive\' | translate}} </md-checkbox> </div> <md-input-container flex="20" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.rtipNr\' | translate}}</label> <input ng-model="teacher.rtipNr" name="rtipNr" type="text" md-maxlength="20"> <div ng-messages="teacherForm.rtipNr.$error"> <div ng-message="md-maxlength"> {{\'main.messages.error.maxlength\' | translate}} </div> </div> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.untis\' | translate}}</label> <input ng-model="teacher.untisCode" name="untisCode" type="text" md-maxlength="20"> <div ng-messages="teacherForm.untisCode.$error"> <div ng-message="md-maxlength"> {{\'main.messages.error.maxlength\' | translate}} </div> </div> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column" flex> <md-input-container flex> <label>{{\'teacher.addInfo\' | translate}}</label> <textarea ng-model="teacher.addInfo" name="addInfo" md-maxlength="1000" max-rows="10" dfs></textarea> <div ng-messages="teacherForm.addInfo.$error"> <div ng-message="md-maxlength"> {{\'main.messages.error.maxlength\' | translate}} </div> </div> </md-input-container> </div> </div> </hois-collapsable> <div ng-repeat="teacherPositionEhis in teacher.teacherPositionEhis | orderBy: \'id\'"> <hois-collapsable label="(\'teacher.teacherPositionEhis.label\' | translate)"> <div layout="column" flex> <div layout="row" layout-sm="column" layout-xs="column"> <!--md-button ng-click="remove(teacherPositionEhis)" class="md-raised md-warn">{{\'main.button.delete\' | translate}}</md-button--> <md-radio-group ng-model="teacherPositionEhis.isVocational" required layout="row" layout-sm="column" layout-xs="column" flex="50" flex-sm="100" flex-xs="100" class="align-center"> <md-radio-button ng-value="true" flex="20" flex-sm="100" flex-xs="100"> {{\'teacher.isVocational\' | translate}} </md-radio-button> <md-radio-button ng-value="false" flex="45" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0">{{\'teacher.isHigher\' | translate}} </md-radio-button> </md-radio-group> </div> <!-- TODO: it would be better bo make filterByCriteria attribute, wich works like criteria but filters in front end --> <div layout="row" layout-sm="column" layout-xs="column" class="top-margin"> <md-input-container flex="25" flex-sm="100" flex-xs="100" ng-if="teacherPositionEhis.isVocational"> <label>{{\'teacher.teacherPositionEhis.position\' | translate}}</label> <hois-classifier-select ng-model="teacherPositionEhis.position" main-classifier-code="EHIS_AMETIKOHT" model-value-attr="code" required criteria="{vocational: true}"></hois-classifier-select> </md-input-container> <md-input-container flex="25" flex-sm="100" flex-xs="100" ng-if="!teacherPositionEhis.isVocational"> <label>{{\'teacher.teacherPositionEhis.position\' | translate}}</label> <hois-classifier-select ng-model="teacherPositionEhis.position" main-classifier-code="EHIS_AMETIKOHT" model-value-attr="code" required criteria="{higher: true}"></hois-classifier-select> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.teacherPositionEhis.positionSpecificationEt\' | translate}}</label> <input ng-model="teacherPositionEhis.positionSpecificationEt" name="teacherPositionEhis[{{$index}}].positionSpecificationEt" type="text" md-maxlength="255"> <div ng-messages="teacherForm[\'teacherPositionEhis[\'+$index+\'].positionSpecificationEt\'].$error"> <div ng-message="md-maxlength"> {{\'main.messages.error.maxlength\' | translate}} </div> </div> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="25" flex-sm="100" flex-xs="100" ng-if="teacherPositionEhis.isVocational"> <label>{{\'teacher.teacherPositionEhis.contractType\' | translate}}</label> <hois-classifier-select ng-model="teacherPositionEhis.contractType" name="teacherPositionEhis[{{$index}}].contractType" main-classifier-code="EHIS_LEPING" model-value-attr="code" required criteria="{vocational: true}"></hois-classifier-select> </md-input-container> <md-input-container flex="25" flex-sm="100" flex-xs="100" ng-if="!teacherPositionEhis.isVocational"> <label>{{\'teacher.teacherPositionEhis.contractType\' | translate}}</label> <hois-classifier-select ng-model="teacherPositionEhis.contractType" name="teacherPositionEhis[{{$index}}].contractType" main-classifier-code="EHIS_LEPING" model-value-attr="code" required criteria="{higher: true}"></hois-classifier-select> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.teacherPositionEhis.contractStart\' | translate}}</label> <md-datepicker ng-model="teacherPositionEhis.contractStart" md-max-date="teacherPositionEhis.contractEnd" required md-open-on-focus></md-datepicker> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.teacherPositionEhis.contractEnd\' | translate}}</label> <md-datepicker ng-model="teacherPositionEhis.contractEnd" md-min-date="teacherPositionEhis.contractStart" md-open-on-focus></md-datepicker> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="25" flex-sm="100" flex-xs="100"> <label>{{\'teacher.teacherPositionEhis.load\' | translate}}</label> <input ng-model="teacherPositionEhis.load" name="teacherPositionEhis[{{$index}}].load" type="number" required max="5" ng-min="{{teacherForm[\'teacherPositionEhis[\'+$index+\'].contractType\'].$viewValue === \'EHIS_LEPING_TL\' ? 0.1 : 0}}" step="0.1"> <div ng-messages="teacherForm[\'teacherPositionEhis[\'+$index+\'].load\'].$error"> <div ng-message="max"> {{\'main.messages.error.max\' | translate: {max: 5} }} </div> <div ng-message="min"> {{\'main.messages.error.min\' | translate: teacherForm[\'teacherPositionEhis[\'+$index+\'].contractType\'].$viewValue === \'EHIS_LEPING_TL\' ? {min:0.1} : {min:0} }} </div> </div> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <md-checkbox ng-model="teacherPositionEhis.isContractEnded"> {{\'teacher.teacherPositionEhis.isContractEnded\' | translate}} </md-checkbox> </md-input-container> <md-input-container ng-if="teacherPositionEhis.isVocational === false" flex="45" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <md-checkbox ng-model="teacherPositionEhis.isTeacher"> {{\'teacher.teacherPositionEhis.isTeacher\' | translate}} </md-checkbox> </md-input-container> </div> <div ng-if="teacherPositionEhis.isVocational === true" layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="25" flex-sm="100" flex-xs="100"> <label>{{\'teacher.teacherPositionEhis.language\' | translate}}</label> <hois-classifier-select ng-model="teacherPositionEhis.language" main-classifier-code="EHIS_OPETAJA_KEEL" model-value-attr="code" required></hois-classifier-select> </md-input-container> </div> <div ng-if="teacherPositionEhis.isVocational === true" layout="row" layout-sm="column" layout-xs="column" class="top-margin"> <md-input-container flex="25" flex-sm="100" flex-offset-xs="0" flex-offset-sm="0"> <md-checkbox ng-model="teacherPositionEhis.meetsQualification"> {{\'teacher.teacherPositionEhis.meetsQualification\' | translate}} </md-checkbox> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <md-checkbox ng-model="teacherPositionEhis.isChildCare"> {{\'teacher.teacherPositionEhis.workHalted\' | translate}} </md-checkbox> </md-input-container> <md-input-container flex="25" flex-offset="5" flex-sm="100" flex-offset-xs="0" flex-offset-sm="0"> <md-checkbox ng-model="teacherPositionEhis.isClassTeacher"> {{\'teacher.teacherPositionEhis.isClassTeacher\' | translate}} </md-checkbox> </md-input-container> <md-button ng-click="deleteEhisPosition(teacherPositionEhis)" class="md-raised" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0">{{\'main.button.delete\' | translate}} </md-button> </div> <div ng-if="teacherPositionEhis.isVocational === false" layout="row"> <md-input-container flex="25" flex-sm="100" flex-xs="100"> <label>{{\'teacher.teacherPositionEhis.employmentType\' | translate}}</label> <hois-classifier-select ng-model="teacherPositionEhis.employmentType" main-classifier-code="EHIS_TOOSUHE" model-value-attr="code" required></hois-classifier-select> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.teacherPositionEhis.employmentTypeSpecification\' | translate}}</label> <input ng-model="teacherPositionEhis.employmentTypeSpecification" name="teacherPositionEhis[{{$index}}].employmentTypeSpecification" type="text" md-maxlength="255"> <div ng-messages="teacherForm[\'teacherPositionEhis[\'+$index+\'].employmentTypeSpecification\'].$error"> <div ng-message="md-maxlength"> {{\'main.messages.error.maxlength\' | translate}} </div> </div> </md-input-container> <md-input-container flex="10" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.teacherPositionEhis.employmentCode\' | translate}}</label> <input ng-model="teacherPositionEhis.employmentCode" name="teacherPositionEhis[{{$index}}].employmentCode" type="text" md-maxlength="100"> <div ng-messages="teacherForm[\'teacherPositionEhis[\'+$index+\'].employmentCode\'].$error"> <div ng-message="md-maxlength"> {{\'main.messages.error.maxlength\' | translate}} </div> </div> </md-input-container> </div> <div ng-if="teacherPositionEhis.isVocational === false" layout="row"> <md-input-container class="md-block" flex="25" flex-sm="100" flex-xs="100"> <label>{{\'school.department.department\' | translate}}</label> <hois-school-department-select ng-model="teacherPositionEhis.schoolDepartment"></hois-school-department-select> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.teacherPositionEhis.positionSpecificationEn\' | translate}}</label> <input ng-model="teacherPositionEhis.positionSpecificationEn" name="teacherPositionEhis[{{$index}}].positionSpecificationEn" type="text" md-maxlength="255"> <div ng-messages="teacherForm[\'teacherPositionEhis[\'+$index+\'].positionSpecificationEn\'].$error"> <div ng-message="md-maxlength"> {{\'main.messages.error.maxlength\' | translate}} </div> </div> </md-input-container> <md-button ng-click="deleteEhisPosition(teacherPositionEhis)" class="md-raised" flex-offset="35" flex-offset-xs="0" flex-offset-sm="0">{{\'main.button.delete\' | translate}} </md-button> </div> </div> </hois-collapsable> </div> <div> <md-button ng-click="newTeacherPositionEhis()" class="md-raised">{{\'teacher.teacherPositionEhis.add\' | translate}} </md-button> </div> <md-button ng-click="update()" class="md-raised md-primary">{{\'main.button.save\' | translate}}</md-button> <md-button ng-if="auth.isAdmin()" ng-click="back(\'#/teachers\', teacherForm)" class="md-raised">{{\'main.button.back\' | translate}}</md-button> <md-button ng-if="auth.isTeacher()" ng-click="back(\'#/teachers/myData\')" class="md-raised">{{\'main.button.back\' | translate}}</md-button> <md-button ng-if="teacher.id" ng-click="delete()" class="md-raised">{{\'main.button.delete\' | translate}}</md-button> <md-button ng-if="teacher.id && teacher.teacherPositionEhis && teacher.teacherPositionEhis.length" ng-click="sendToEhis()" class="md-raised">{{\'main.button.sendToEhis\' | translate}}</md-button> <span ng-if="teacher.ehisLastSuccessfulDate && teacher.teacherPositionEhis.length > 0" style="font-size: 13px">{{\'teacher.ehisSendOperation.success\' | translate: {day: (teacher.ehisLastSuccessfulDate | hoisDateTime)} }}</span> <span ng-if="!teacher.ehisLastSuccessfulDate && teacher.teacherPositionEhis.length > 0" style="font-size: 13px">{{\'teacher.ehisSendOperation.fail\' | translate}}</span> </form> </div>'),
a.put("teacher/teacher.edit.mydata.html",'<md-nav-bar md-selected-nav-item="currentNavItem" nav-bar-aria-label="main selection" ng-cloak> <md-nav-item ng-if="auth.isAdmin()" md-nav-href="#/teachers/{{::teacher.id}}/edit?_noback" name="teacher.data"> {{\'teacher.data\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isTeacher()" md-nav-href="#/teachers/{{::teacher.id}}/editmydata?_noback" name="teacher.data"> {{\'teacher.data\' | translate}}</md-nav-item> <md-nav-item ng-if="(auth.isAdmin() && teacher.id && teacher.isVocational) || (auth.isTeacher() && teacher.isVocational)" md-nav-href="#/teachers/{{::teacher.id}}/continuingEducation?_noback" name="teacher.continuingEducation"> {{\'teacher.continuingEducation.label\' | translate}}</md-nav-item> <md-nav-item ng-if="(auth.isAdmin() && teacher.id) || (teacher.teacherQualifications.length > 0 && auth.isTeacher())" md-nav-href="#/teachers/{{::teacher.id}}/qualification?_noback" name="teacher.qualification"> {{\'teacher.qualification.qualification\' | translate}}</md-nav-item> <md-nav-item ng-if="(auth.isAdmin() && teacher.id && teacher.isHigher && isHigher) || (auth.isTeacher() && teacher.teacherMobility.length > 0)" md-nav-href="#/teachers/{{::teacher.id}}/mobility?_noback" name="teacher.mobility"> {{\'teacher.mobility.mobility\' | translate}}</md-nav-item> <md-nav-item ng-if="(auth.isAdmin() && teacher.id) || auth.isTeacher()" md-nav-href="#/teachers/{{::teacher.id}}/rtipAbsence?_noback" name="teacher.rtipAbsence"> {{\'teacher.rtipAbsence.label\' | translate}}</md-nav-item> <md-nav-item ng-if="((auth.isAdmin() && teacher.id) || auth.isTeacher()) && teacher.isHigher" md-nav-href="#/teachers/{{::teacher.id}}/programs?_noback" name="teacher.programs"> {{\'teacher.subjectPrograms.label\' | translate}}</md-nav-item> </md-nav-bar> <md-content class="md-padding"> <form name="teacherForm" role="form" class="form-readonly" novalidate> <div style="padding-top: 1em"> <div layout="column"> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="30" flex-sm="100" flex-xs="100"> <label>{{auth.higher ? (\'teacher.person.idcodeHigher\' | translate) : (\'teacher.person.idcodeVocational\' | translate)}}</label> <hois-value value="teacher.person.idcode"></hois-value> </md-input-container> <md-input-container flex="30" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.person.birthdate\' | translate}}</label> <hois-value value="teacher.person.birthdate | hoisDate"></hois-value> </md-input-container> <md-input-container flex="30" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.person.sex\' | translate}}</label> <hois-classifier-value ng-model="teacher.person.sex" main-classifier-code="SUGU"></hois-classifier-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="30" flex-sm="100" flex-xs="100"> <label>{{auth.higher ? (\'teacher.person.nameHigher\' | translate) : (\'teacher.person.nameVocational\' | translate)}}</label> <hois-value value="teacher.person.firstname + \' \' + teacher.person.lastname"></hois-value> </md-input-container> <md-input-container flex="30" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.person.nativeLanguage\' | translate}}</label> <hois-classifier-value ng-model="teacher.nativeLanguage" main-classifier-code="EHIS_EMAKEEL"></hois-classifier-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column" flex> <md-input-container flex="30" flex-sm="100" flex-xs="100"> <label>{{\'teacher.person.citizenship\' | translate}}</label> <hois-classifier-value ng-model="teacher.person.citizenship" main-classifier-code="RIIK"></hois-classifier-value> </md-input-container> <div flex="30" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0" class="active"> <md-input-container flex="100"> <label>{{\'teacher.person.phone\' | translate}}</label> <input ng-model="teacher.person.phone" name="personphone" type="text" md-maxlength="100"> <div ng-messages="teacherForm.personphone.$error"> <div ng-message="md-maxlength"> {{\'main.messages.error.maxlength\' | translate}} </div> </div> </md-input-container> </div> <div flex="30" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0" class="active"> <md-input-container> <label>{{\'teacher.person.email\' | translate}}</label> <input ng-model="teacher.person.email" name="personemail" type="email" md-maxlength="100"> <div ng-messages="teacherForm.personemail.$error"> <div ng-message="md-maxlength"> {{\'main.messages.error.maxlength\' | translate}} </div> </div> </md-input-container> </div> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex> <label>{{\'teacher.occupation.label\' | translate}}</label> <hois-value value="currentLanguageNameField(teacher.teacherOccupation)"></hois-value> </md-input-container> <md-input-container flex="30" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.phone\' | translate}}</label> <hois-value value="teacher.phone"></hois-value> </md-input-container> <md-input-container flex="30" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.email\' | translate}}</label> <hois-value value="teacher.email"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="30" flex-sm="100" flex-xs="100"> <label>{{\'teacher.scheduleLoad\' | translate}}</label> <hois-value value="teacher.scheduleLoad"></hois-value> </md-input-container> <md-radio-group ng-model="teacher.isStudyPeriodScheduleLoad" layout="row" layout-sm="column" layout-xs="column" flex="30" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0" class="align-center" disabled style="margin-top: -18px"> <md-radio-button ng-value="true"> {{\'teacher.studyPeriodLoad\' | translate}} </md-radio-button> <md-radio-button ng-value="false"> {{\'teacher.studyYearLoad\' | translate}} </md-radio-button> </md-radio-group> <md-input-container flex="30" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.isActive\' | translate}}</label> <hois-value value="teacher.isActive ? \'main.yes\' : \'main.no\' | translate"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="30" flex-sm="100" flex-xs="100"> <label>{{\'teacher.isVocationalOrIsHigher\' | translate}}</label> <hois-value value="vocationalHigher"></hois-value> </md-input-container> <md-input-container flex="30" flex-offset="5" flex-sm="100" flex-xs="100"> <label>{{\'teacher.rtipNr\' | translate}}</label> <hois-value value="teacher.rtipNr"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column" flex> <md-input-container flex> <label>{{\'teacher.addInfo\' | translate}}</label> <hois-value value="teacher.addInfo"></hois-value> </md-input-container> </div> </div> </div> <div ng-repeat="teacherPositionEhis in teacher.teacherPositionEhis | orderBy: \'id\'"> <hois-collapsable label="(\'teacher.teacherPositionEhis.label\' | translate)"> <div layout="column"> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="30" flex-sm="100" flex-xs="100"> <label>{{\'teacher.teacherPositionEhis.teachingLevel\' | translate}}</label> <hois-value value="teacherPositionEhis.isVocational === true ? \'teacher.isVocational\' : \'teacher.isHigher\' | translate"></hois-value> </md-input-container> <md-input-container flex="30" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.teacherPositionEhis.position\' | translate}}</label> <hois-classifier-value ng-model="teacherPositionEhis.position" main-classifier-code="EHIS_AMETIKOHT"></hois-classifier-value> </md-input-container> <md-input-container flex="30" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.teacherPositionEhis.positionSpecificationEt\' | translate}}</label> <hois-value value="teacherPositionEhis.positionSpecificationEt"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="30" flex-sm="100" flex-xs="100"> <label>{{\'teacher.teacherPositionEhis.contractType\' | translate}}</label> <hois-classifier-value ng-model="teacherPositionEhis.contractType" main-classifier-code="EHIS_LEPING"></hois-classifier-value> </md-input-container> <md-input-container flex="30" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.teacherPositionEhis.contractStart\' | translate}}</label> <hois-value value="teacherPositionEhis.contractStart | hoisDate"></hois-value> </md-input-container> <md-input-container flex="30" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.teacherPositionEhis.contractEnd\' | translate}}</label> <hois-value value="teacherPositionEhis.contractEnd | hoisDate"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="30" flex-sm="100" flex-xs="100"> <label>{{\'teacher.teacherPositionEhis.isContractEnded\' | translate}}</label> <hois-value value="teacherPositionEhis.isContractEnded === true ? \'main.yes\' : \'main.no\' | translate"></hois-value> </md-input-container> <md-input-container flex="30" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.teacherPositionEhis.load\' | translate}}</label> <hois-value value="teacherPositionEhis.load"></hois-value> </md-input-container> <md-input-container ng-if="teacherPositionEhis.isVocational === true" flex="30" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.teacherPositionEhis.language\' | translate}}</label> <hois-classifier-value ng-model="teacherPositionEhis.language" main-classifier-code="EHIS_OPETAJA_KEEL"></hois-classifier-value> </md-input-container> <md-input-container ng-if="!teacherPositionEhis.isVocational" flex="30" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.teacherPositionEhis.isTeacher\' | translate}}</label> <hois-value value="teacherPositionEhis.isTeacher === true ? \'main.yes\' : \'main.no\' | translate"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container ng-if="teacherPositionEhis.isVocational === true" flex="30" flex-sm="100" flex-xs="100"> <label>{{\'teacher.teacherPositionEhis.meetsQualification\' | translate}}</label> <hois-value value="teacherPositionEhis.meetsQualification === true ? \'main.yes\' : \'main.no\' | translate"></hois-value> </md-input-container> <md-input-container ng-if="teacherPositionEhis.isVocational === true" flex="30" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.teacherPositionEhis.workHalted\' | translate}}</label> <hois-value value="teacherPositionEhis.isChildCare === true ? \'main.yes\' : \'main.no\' | translate"></hois-value> </md-input-container> <md-input-container ng-if="teacherPositionEhis.isVocational === true" flex="30" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.teacherPositionEhis.isClassTeacher\' | translate}}</label> <hois-value value="teacherPositionEhis.isClassTeacher === true ? \'main.yes\' : \'main.no\' | translate"></hois-value> </md-input-container> </div> <div ng-if="!teacherPositionEhis.isVocational" layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="30" flex-sm="100" flex-xs="100"> <label>{{\'teacher.teacherPositionEhis.employmentType\' | translate}}</label> <hois-classifier-value ng-model="teacherPositionEhis.employmentType" main-classifier-code="EHIS_TOOSUHE"></hois-classifier-value> </md-input-container> <md-input-container flex="30" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.teacherPositionEhis.employmentTypeSpecification\' | translate}}</label> <hois-value value="teacherPositionEhis.employmentTypeSpecification"></hois-value> </md-input-container> <md-input-container flex="30" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.teacherPositionEhis.employmentCode\' | translate}}</label> <hois-value value="teacherPositionEhis.employmentCode"></hois-value> </md-input-container> </div> <div ng-if="!teacherPositionEhis.isVocational" layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="30" flex-sm="100" flex-xs="100"> <label>{{\'teacher.teacherPositionEhis.schoolDepartment\' | translate}}</label> <hois-value value="currentLanguageNameField(schoolDepartmentsById[teacherPositionEhis.schoolDepartment])"></hois-value> </md-input-container> <md-input-container flex="30" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.teacherPositionEhis.positionSpecificationEn\' | translate}}</label> <hois-value value="teacherPositionEhis.positionSpecificationEn"></hois-value> </md-input-container> </div> </div> </hois-collapsable> </div> <md-button ng-click="update()" class="md-raised md-primary">{{\'main.button.save\' | translate}}</md-button> </form> </md-content> <div layout="row" layout-margin> <md-button ng-click="back(\'#/teachers/myData\', teacherForm)" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </div>'),a.put("teacher/teacher.list.html",'<div class="ois-form-layout-padding"> <div flex> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <form name="searchForm" ng-submit="searchForm.$valid && loadData()" class="nomargin" layout="column" ng-model-options="{allowInvalid: true}"> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label class="textInput">{{auth.higher ? (\'teacher.person.nameHigher\' | translate) : (\'teacher.person.nameVocational\' | translate)}}</label> <input ng-model="criteria.name" type="text" md-maxlength="255" autofocus> </md-input-container> <md-input-container flex="50" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label class="textInput">{{auth.higher ? (\'teacher.person.idcodeHigher\' | translate) : (\'teacher.person.idcodeVocational\' | translate)}}</label> <input ng-model="criteria.idcode" type="text" minlength="11" md-maxlength="11"> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column" ng-if="!showSchool"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label>{{\'teacher.occupation.label\' | translate}}</label> <hois-select ng-model="criteria.teacherOccupation" values="teacherOccupations"></hois-select> </md-input-container> <md-input-container flex="50" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0" ng-show="schoolHigher"> <label>{{\'teacher.occupation.department\' | translate}}</label> <hois-school-department-select ng-model="criteria.schoolDepartment"></hois-school-department-select> </md-input-container> </div> <div layout="row"> <md-input-container flex="45" flex-sm="100" flex-xs="100" ng-if="showSchool"> <label>{{\'school.label\' | translate}}</label> <hois-select ng-model="criteria.school" type="school"></hois-select> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column" class="top-margin" ng-if="!showSchool"> <md-checkbox ng-model="criteria.isActive" aria-label="{{\'teacher.isActive\' | translate}}"> {{\'teacher.isActive\' | translate}} </md-checkbox> </div> <div layout="row"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> <md-button ng-href="#/teachers/new" ng-if="formState.canCreate" class="md-raised">{{\'main.button.create\' | translate}}</md-button> </div> <div flex-xs="0" flex-gt-xs="0" flex-gt-sm="50"></div> </form> </fieldset> </div> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="s.{{currentLanguageNameField()}}" ng-if="showSchool">{{\'school.label\' | translate}}</th> <th md-column md-order-by="p.lastname,p.firstname">{{auth.higher ? (\'teacher.person.nameHigher\' | translate) : (\'teacher.person.nameVocational\' | translate)}}</th> <th md-column md-order-by="p.idcode">{{auth.higher ? (\'teacher.person.idcodeHigher\' | translate) : (\'teacher.person.idcodeVocational\' | translate)}}</th> <th md-column md-order-by="t.email">{{\'teacher.email\' | translate}}</th> <th md-column md-order-by="t.phone">{{\'teacher.phone\' | translate}}</th> <th md-column md-order-by="tot.{{currentLanguage() === \'en\' ? \'occupationEn\' : \'occupationEt\'}}" ng-if="!showSchool">{{\'teacher.occupation.label\' | translate}}</th> <th md-column ng-if="schoolHigher && !showSchool">{{\'teacher.occupation.departments\' | translate}}</th> <th md-column ng-if="!showSchool" md-order-by="t.isActive">{{\'teacher.isActive\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell ng-if="showSchool">{{currentLanguageNameField(row.school)}}</td> <td md-cell> <a ng-href="#/teachers/{{::row.id}}" ng-if="auth.school">{{::row.name}}</a> <span ng-if="!auth.school">{{::row.name}}</span> </td> <td md-cell>{{::row.idcode}}</td> <td md-cell>{{::row.email}}</td> <td md-cell>{{::row.phone}}</td> <td md-cell ng-if="!showSchool">{{currentLanguageNameField(row.teacherOccupation)}}</td> <td md-cell ng-if="schoolHigher && !showSchool"> <table> <tr ng-repeat="department in row.schoolDepartments | orderBy: \'nameEt\'"> <td>{{currentLanguageNameField(department)}}</td> </tr> </table> </td> <td md-cell ng-if="!showSchool">{{::row.isActive ? \'main.yes\' : \'main.no\' | translate}}</td> <td md-cell> <md-button md-no-ink class="md-primary change-button" ng-href="#/teachers/{{::row.id}}/edit" ng-if="row.canEdit"> {{\'main.button.change\' | translate}} </md-button> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> </div>'),a.put("teacher/teacher.mobility.edit.html",'<md-nav-bar md-selected-nav-item="currentNavItem" nav-bar-aria-label="main selection" ng-cloak> <md-nav-item ng-if="auth.isAdmin()" md-nav-href="#/teachers/{{::teacher.id}}/edit?_noback" name="teacher.data"> {{\'teacher.data\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isTeacher()" md-nav-href="#/teachers/{{::teacher.id}}/editmydata?_noback" name="teacher.data"> {{\'teacher.data\' | translate}}</md-nav-item> <md-nav-item ng-if="(auth.isAdmin() && teacher.id && teacher.isVocational) || (auth.isTeacher() && teacher.isVocational)" md-nav-href="#/teachers/{{::teacher.id}}/continuingEducation?_noback" name="teacher.continuingEducation"> {{\'teacher.continuingEducation.label\' | translate}}</md-nav-item> <md-nav-item ng-if="(auth.isAdmin() && teacher.id) || (teacher.teacherQualifications.length > 0 && auth.isTeacher())" md-nav-href="#/teachers/{{::teacher.id}}/qualification?_noback" name="teacher.qualification"> {{\'teacher.qualification.qualification\' | translate}}</md-nav-item> <md-nav-item ng-if="(auth.isAdmin() && teacher.id && teacher.isHigher && isHigher) || (auth.isTeacher() && teacher.teacherMobility.length > 0)" md-nav-href="#/teachers/{{::teacher.id}}/mobility?_noback" name="teacher.mobility"> {{\'teacher.mobility.mobility\' | translate}}</md-nav-item> <md-nav-item ng-if="(auth.isAdmin() && teacher.id) || auth.isTeacher()" md-nav-href="#/teachers/{{::teacher.id}}/rtipAbsence?_noback" name="teacher.rtipAbsence"> {{\'teacher.rtipAbsence.label\' | translate}}</md-nav-item> <md-nav-item ng-if="((auth.isAdmin() && teacher.id) || auth.isTeacher()) && teacher.isHigher" md-nav-href="#/teachers/{{::teacher.id}}/programs?_noback" name="teacher.programs"> {{\'teacher.subjectPrograms.label\' | translate}}</md-nav-item> </md-nav-bar> <md-content class="md-padding"> <div>&nbsp;</div> <div layout="row" layout-xs="column" flex class="form-readonly"> <div layout="row" layout-sm="column" layout-xs="column" flex> <md-input-container flex> <label>{{auth.higher ? (\'teacher.person.nameHigher\' | translate) : (\'teacher.person.nameVocational\' | translate)}}</label> <hois-value value="teacher.person.firstname + \' \' + teacher.person.lastname"></hois-value> </md-input-container> <md-input-container flex> <label>{{auth.higher ? (\'teacher.person.idcodeHigher\' | translate) : (\'teacher.person.idcodeVocational\' | translate)}}</label> <hois-value value="teacher.person.idcode"></hois-value> </md-input-container> </div> </div> <form name="mobilityForm" class="nomargin" novalidate> <md-button ng-click="newTeacherMobility()" class="md-raised">{{\'teacher.mobility.add\' | translate}}</md-button> <div ng-repeat="mobility in teacherMobility.mobilities  | orderBy: \'-id\'"> <hois-collapsable label="(\'teacher.mobility.mobility\' | translate)"> <div layout="column" flex> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="25" flex-sm="100" flex-offset-sm="0"> <label>{{\'teacher.mobility.start\' | translate}}</label> <md-datepicker ng-model="mobility.start" md-max-date="mobility.end" required md-open-on-focus></md-datepicker> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-offset="5" flex-offset-sm="0"> <label>{{\'teacher.mobility.end\' | translate}}</label> <md-datepicker ng-model="mobility.end" md-min-date="mobility.start" required md-open-on-focus></md-datepicker> </md-input-container> <md-input-container flex="45" flex-sm="100" flex-offset="5" flex-offset-sm="0"> <label>{{\'teacher.mobility.state\' | translate}}</label> <hois-classifier-select ng-model="mobility.state" main-classifier-code="RIIK" required model-value-attr="code"></hois-classifier-select> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="25" flex-sm="100" flex-offset-sm="0"> <label>{{\'teacher.mobility.target\' | translate}}</label> <hois-classifier-select ng-model="mobility.target" main-classifier-code="EHIS_MOBIILSUS" required model-value-attr="code"></hois-classifier-select> </md-input-container> <md-input-container flex="50" flex-sm="100" flex-offset="5" flex-offset-sm="0"> <label>{{\'teacher.mobility.school\' | translate}}</label> <input ng-model="mobility.school" name="mobility[{{$index}}].school" md-maxlength="255" type="text" required> <div ng-messages="mobilityForm[\'mobility[\'+$index+\'].school\'].$error"> <div ng-message="md-maxlength"> {{\'main.messages.error.maxlength\' | translate}} </div> </div> </md-input-container> </div> </div> <md-button ng-click="deleteMobility(mobility)" class="md-raised">{{\'main.button.delete\' | translate}}</md-button> </hois-collapsable> </div> <md-button ng-click="updateTeacherMobility()" class="md-raised md-primary" ng-if="teacherMobility.mobilities.length > 0"> {{\'main.button.save\' | translate}} </md-button> <md-button ng-if="auth.isTeacher()" ng-click="back(\'#/teachers/myData\')" class="md-raised">{{\'main.button.back\' | translate}}</md-button> <md-button ng-if="auth.isAdmin()" ng-click="back(\'#/teachers\', mobilityForm)" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </form> </md-content>'),a.put("teacher/teacher.mobility.view.html",'<!--<div ng-include="\'teacher/teacher.menu.view.html\'"></div>--> <div class="ois-form-layout form-readonly"> <div flex> <div>&nbsp;</div> <div layout="row" layout-xs="column" flex class="form-readonly"> <div layout="row" layout-sm="column" layout-xs="column" flex> <md-input-container flex> <label>{{auth.higher ? (\'teacher.person.nameHigher\' | translate) : (\'teacher.person.nameVocational\' | translate)}}</label> <hois-value value="teacher.person.firstname + \' \' + teacher.person.lastname"></hois-value> </md-input-container> <md-input-container flex> <label>{{auth.higher ? (\'teacher.person.idcodeHigher\' | translate) : (\'teacher.person.idcodeVocational\' | translate)}}</label> <hois-value value="teacher.person.idcode"></hois-value> </md-input-container> </div> </div> <div ng-repeat="mobility in teacher.teacherMobility"> <hois-collapsable label="(\'teacher.mobility.mobility\' | translate)"> <div layout="column"> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="25" flex-sm="100" flex-offset-sm="0"> <label>{{\'teacher.mobility.start\' | translate}}</label> <hois-value value="mobility.start | hoisDate"></hois-value> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-offset="5" flex-offset-sm="0"> <label>{{\'teacher.mobility.end\' | translate}}</label> <hois-value value="mobility.end | hoisDate"></hois-value> </md-input-container> <md-input-container flex="45" flex-sm="100" flex-offset="5" flex-offset-sm="0"> <label>{{\'teacher.mobility.state\' | translate}}</label> <hois-classifier-value ng-model="mobility.state" main-classifier-code="RIIK"></hois-classifier-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="25" flex-sm="100" flex-offset-sm="0"> <label>{{\'teacher.mobility.target\' | translate}}</label> <hois-classifier-value ng-model="mobility.target" main-classifier-code="EHIS_MOBIILSUS"></hois-classifier-value> </md-input-container> <md-input-container flex="50" flex-sm="100" flex-offset="5" flex-offset-sm="0"> <label>{{\'teacher.mobility.school\' | translate}}</label> <hois-value value="mobility.school"></hois-value> </md-input-container> </div> </div> </hois-collapsable> </div> </div> </div>'),a.put("teacher/teacher.occupation.edit.html",'<div layout="column" layout-padding> <div> <form name="teacherOccupationForm"> <md-input-container class="md-block"> <label>{{\'teacher.occupation.occupationEt\' | translate}}</label> <input ng-model="teacherOccupation.occupationEt" name="occupationEt" type="text" required md-maxlength="100"> </md-input-container> <md-input-container class="md-block"> <label class="textInput">{{\'teacher.occupation.occupationEn\' | translate}}</label> <input ng-model="teacherOccupation.occupationEn" name="occupationEn" type="text" md-maxlength="100"> </md-input-container> <md-checkbox ng-model="teacherOccupation.isValid" name="isValid"> {{\'teacher.occupation.isValid\' | translate}} </md-checkbox> </form> <md-button ng-click="update()" class="md-raised md-primary">{{\'main.button.save\' | translate}}</md-button> <md-button ng-click="delete()" ng-if="teacherOccupation.id" class="md-raised">{{\'main.button.delete\' | translate}}</md-button> <md-button ng-click="back(\'#/school/teacheroccupations\', teacherOccupationForm)" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </div> </div>'),a.put("teacher/teacher.occupation.list.html",'<div class="ois-form-layout-padding"> <div flex> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <form name="searchForm" ng-submit="searchForm.$valid && loadData()" novalidate class="nomargin" layout="column" ng-model-options="{allowInvalid: true}"> <div layout="row" layout-sm="column" layout-xs="column"> <!--div class="indentForToast"></div--> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'teacher.occupation.occupationEt\' | translate}}</label> <input ng-model="criteria.occupationEt" name="occupationEt" type="text" md-maxlength="100" autofocus> </md-input-container> <md-input-container flex="50" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label class="textInput">{{\'teacher.occupation.occupationEn\' | translate}}</label> <input ng-model="criteria.occupationEn" name="occupationEn" type="text" md-maxlength="100"> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container> <md-checkbox ng-model="criteria.isValid" name="isValid"> {{\'teacher.occupation.isValid\' | translate}} </md-checkbox> </md-input-container> </div> <div layout="row"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> <md-button class="md-raised" ng-if="isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_OPETAJAAMET\')" ng-href="#/school/teacheroccupations/new">{{\'main.button.create\' | translate}}</md-button> </div> <div flex-xs="0" flex-gt-xs="0" flex-gt-sm="50"></div> </form> </fieldset> </div> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="occupationEt">{{\'teacher.occupation.occupationEt\' | translate}}</th> <th md-column md-order-by="occupationEn">{{\'teacher.occupation.occupationEn\' | translate}}</th> <th md-column md-order-by="isValid">{{\'teacher.occupation.status\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{::row.occupationEt}}</td> <td md-cell>{{::row.occupationEn}}</td> <td md-cell>{{row.isValid ? \'teacher.occupation.validTrue\' : \'teacher.occupation.validFalse\' | translate}}</td> <td md-cell> <md-button md-no-ink class="md-primary change-button" ng-if="isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_OPETAJAAMET\')" ng-href="#/school/teacheroccupations/{{::row.id}}/edit">{{\'main.button.change\' | translate}}</md-button> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> </div>'),a.put("teacher/teacher.programs.html",'<md-nav-bar ng-if="separateController" md-selected-nav-item="currentNavItem" nav-bar-aria-label="main selection" ng-cloak> <md-nav-item ng-if="auth.isAdmin()" md-nav-href="#/teachers/{{::teacher.id}}/edit?_noback" name="teacher.data"> {{\'teacher.data\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isTeacher()" md-nav-href="#/teachers/{{::teacher.id}}/editmydata?_noback" name="teacher.data"> {{\'teacher.data\' | translate}}</md-nav-item> <md-nav-item ng-if="(auth.isAdmin() && teacher.id && teacher.isVocational) || (auth.isTeacher() && teacher.isVocational)" md-nav-href="#/teachers/{{::teacher.id}}/continuingEducation?_noback" name="teacher.continuingEducation"> {{\'teacher.continuingEducation.label\' | translate}}</md-nav-item> <md-nav-item ng-if="(auth.isAdmin() && teacher.id) || (teacher.teacherQualifications.length > 0 && auth.isTeacher())" md-nav-href="#/teachers/{{::teacher.id}}/qualification?_noback" name="teacher.qualification"> {{\'teacher.qualification.qualification\' | translate}}</md-nav-item> <md-nav-item ng-if="(auth.isAdmin() && teacher.id && teacher.isHigher) || (auth.isTeacher() && teacher.teacherMobility.length > 0)" md-nav-href="#/teachers/{{::teacher.id}}/mobility?_noback" name="teacher.mobility"> {{\'teacher.mobility.mobility\' | translate}}</md-nav-item> <md-nav-item ng-if="(auth.isAdmin() && teacher.id) || auth.isTeacher()" md-nav-href="#/teachers/{{::teacher.id}}/rtipAbsence?_noback" name="teacher.rtipAbsence"> {{\'teacher.rtipAbsence.label\' | translate}}</md-nav-item> <md-nav-item ng-if="((auth.isAdmin() && teacher.id) || auth.isTeacher()) && teacher.isHigher" md-nav-href="#/teachers/{{::teacher.id}}/programs?_noback" name="teacher.programs"> {{\'teacher.subjectPrograms.label\' | translate}}</md-nav-item> </md-nav-bar> <div layout-padding> <div layout="row" layout-xs="column" flex class="form-readonly"> <div layout="row" layout-sm="column" layout-xs="column" flex> <md-input-container flex> <label>{{auth.higher ? (\'teacher.person.nameHigher\' | translate) : (\'teacher.person.nameVocational\' | translate)}}</label> <hois-value value="teacher.person.firstname + \' \' + teacher.person.lastname"></hois-value> </md-input-container> <md-input-container flex> <label>{{auth.higher ? (\'teacher.person.idcodeHigher\' | translate) : (\'teacher.person.idcodeVocational\' | translate)}}</label> <hois-value value="teacher.person.idcode"></hois-value> </md-input-container> </div> </div> <ng-include src="\'subjectProgram/subject.program.list.html\'" ng-controller="SubjectProgramSearch as searchController" style="padding: 0 !important"></ng-include> <div layout="row"> <md-button ng-if="auth.isAdmin() && separateController" ng-click="back(\'#/teachers\')" class="md-raised">{{\'main.button.back\' | translate}}</md-button> <md-button ng-if="auth.isTeacher() && separateController" ng-click="back(\'#/teachers/myData\')" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </div> </div>'),
a.put("teacher/teacher.qualification.edit.html",'<md-nav-bar md-selected-nav-item="currentNavItem" nav-bar-aria-label="main selection" ng-cloak> <md-nav-item ng-if="auth.isAdmin()" md-nav-href="#/teachers/{{::teacher.id}}/edit?_noback" name="teacher.data"> {{\'teacher.data\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isTeacher()" md-nav-href="#/teachers/{{::teacher.id}}/editmydata?_noback" name="teacher.data"> {{\'teacher.data\' | translate}}</md-nav-item> <md-nav-item ng-if="(auth.isAdmin() && teacher.id && teacher.isVocational) || (auth.isTeacher() && teacher.isVocational)" md-nav-href="#/teachers/{{::teacher.id}}/continuingEducation?_noback" name="teacher.continuingEducation"> {{\'teacher.continuingEducation.label\' | translate}}</md-nav-item> <md-nav-item ng-if="(auth.isAdmin() && teacher.id) || (auth.isTeacher() && teacherQualifications.qualifications.length > 0)" md-nav-href="#/teachers/{{::teacher.id}}/qualification?_noback" name="teacher.qualification"> {{\'teacher.qualification.qualification\' | translate}}</md-nav-item> <md-nav-item ng-if="(auth.isAdmin() && teacher.id && teacher.isHigher && isHigher) || (auth.isTeacher() && teacher.teacherMobility.length > 0)" md-nav-href="#/teachers/{{::teacher.id}}/mobility?_noback" name="teacher.mobility"> {{\'teacher.mobility.mobility\' | translate}}</md-nav-item> <md-nav-item ng-if="(auth.isAdmin() && teacher.id) || auth.isTeacher()" md-nav-href="#/teachers/{{::teacher.id}}/rtipAbsence?_noback" name="teacher.rtipAbsence"> {{\'teacher.rtipAbsence.label\' | translate}}</md-nav-item> <md-nav-item ng-if="((auth.isAdmin() && teacher.id) || auth.isTeacher()) && teacher.isHigher" md-nav-href="#/teachers/{{::teacher.id}}/programs?_noback" name="teacher.programs"> {{\'teacher.subjectPrograms.label\' | translate}}</md-nav-item> </md-nav-bar> <md-content class="md-padding"> <div>&nbsp;</div> <div layout="row" layout-xs="column" flex class="form-readonly"> <div layout="row" layout-sm="column" layout-xs="column" flex> <md-input-container flex> <label>{{auth.higher ? (\'teacher.person.nameHigher\' | translate) : (\'teacher.person.nameVocational\' | translate)}}</label> <hois-value value="teacher.person.firstname + \' \' + teacher.person.lastname"></hois-value> </md-input-container> <md-input-container flex> <label>{{auth.higher ? (\'teacher.person.idcodeHigher\' | translate) : (\'teacher.person.idcodeVocational\' | translate)}}</label> <hois-value value="teacher.person.idcode"></hois-value> </md-input-container> </div> </div> <form name="qualificationsForm" class="nomargin" novalidate> <md-button ng-click="newTeacherQualification()" class="md-raised">{{\'teacher.qualification.add\' | translate}} </md-button> <div ng-repeat="qualification in teacherQualifications.qualifications | orderBy: \'-id\'"> <hois-collapsable label="(\'teacher.qualification.qualification\' | translate)"> <div layout="column" flex> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="50" flex-sm="100"> <label>{{\'teacher.qualification.qualification\' | translate}}</label> <hois-classifier-select ng-model="qualification.qualification" main-classifier-code="EHIS_KVALIFIKATSIOON" model-value-attr="code" required></hois-classifier-select> </md-input-container> <md-input-container flex="45" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.qualification.qualificationName\' | translate}}</label> <hois-classifier-select ng-model="qualification.qualificationName" main-classifier-code="EHIS_KVALIFIKATSIOON_NIMI" model-value-attr="code" required></hois-classifier-select> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column" class="top-margin"> <md-input-container flex="25" flex-sm="100"> <label>{{\'teacher.qualification.state\' | translate}}</label> <hois-classifier-select ng-model="qualification.state" main-classifier-code="RIIK" model-value-attr="code" ng-change="(qualification.state === \'RIIK_EST\') && (qualification.schoolOther = \'\')" required></hois-classifier-select> </md-input-container> <md-input-container flex="20" flex-offset="5" flex-sm="100" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.qualification.endDate\' | translate}}</label> <md-datepicker ng-model="qualification.endDate" md-open-on-focus required></md-datepicker> </md-input-container> <md-input-container flex="45" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.qualification.qualificationOther\' | translate}}</label> <input ng-model="qualification.qualificationOther" name="qualification[{{$index}}].qualificationOther" md-maxlength="255" type="text"> <div ng-messages="qualificationsForm[\'qualification[\'+$index+\'].qualificationOther\'].$error"> <div ng-message="md-maxlength"> {{\'main.messages.error.maxlength\' | translate}} </div> </div> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="25" flex-sm="100" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.qualification.school\' | translate}}</label> <hois-classifier-select ng-model="qualification.school" main-classifier-code="EHIS_EESTI_OPPEASUTUS" model-value-attr="code" ng-required="qualification.state === \'RIIK_EST\'"></hois-classifier-select> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.qualification.exSchool\' | translate}}</label> <hois-classifier-select ng-model="qualification.exSchool" main-classifier-code="EHIS_EESTI_OPPEASUTUS_ENDINE" model-value-attr="code"></hois-classifier-select> </md-input-container> <md-input-container flex="25" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.qualification.schoolOther\' | translate}}</label> <input ng-model="qualification.schoolOther" name="qualification[{{$index}}].schoolOther" md-maxlength="255" type="text" ng-disabled="qualification.state === \'RIIK_EST\'"> <div ng-messages="qualificationsForm[\'qualification[\'+$index+\'].schoolOther\'].$error"> <div ng-message="md-maxlength"> {{\'main.messages.error.maxlength\' | translate}} </div> </div> </md-input-container> </div> <span ng-if="teacher.isVocational"> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="25" flex-sm="100" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.qualification.diplomaNr\' | translate}}</label> <input ng-model="qualification.diplomaNr" name="qualification[{{$index}}].diplomaNr" md-maxlength="100" type="text"> <div ng-messages="qualificationsForm[\'qualification[\'+$index+\'].diplomaNr\'].$error"> <div ng-message="md-maxlength"> {{\'main.messages.error.maxlength\' | translate}} </div> </div> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.qualification.studyLevel\' | translate}}</label> <hois-classifier-select ng-model="qualification.studyLevel" main-classifier-code="EHIS_EDUCATION_LEVEL" model-value-attr="code"></hois-classifier-select> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="25" flex-sm="100" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.qualification.specialty\' | translate}}</label> <input ng-model="qualification.specialty" name="qualification[{{$index}}].specialty" md-maxlength="255" type="text" required> <div ng-messages="qualificationsForm[\'qualification[\'+$index+\'].specialty\'].$error"> <div ng-message="md-maxlength"> {{\'main.messages.error.maxlength\' | translate}} </div> </div> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.qualification.language\' | translate}}</label> <hois-classifier-select ng-model="qualification.language" main-classifier-code="EHIS_OPETAJA_KEEL" model-value-attr="code" required></hois-classifier-select> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.qualification.addInfo\' | translate}}</label> <textarea ng-model="qualification.addInfo" name="qualification[{{$index}}].addInfo" md-maxlength="4000" max-rows="2"></textarea> <div ng-messages="qualificationsForm[\'qualification[\'+$index+\'].addInfo\'].$error"> <div ng-message="md-maxlength"> {{\'main.messages.error.maxlength\' | translate}} </div> </div> </md-input-container> </div> </span> </div> <md-button ng-click="deleteQualification(qualification)" class="md-raised">{{\'main.button.delete\' | translate}}</md-button> </hois-collapsable> </div> <md-button ng-click="updateQualifications()" class="md-raised md-primary" ng-if="teacherQualifications.qualifications.length > 0"> {{\'main.button.save\' | translate}} </md-button> <md-button ng-if="auth.isTeacher()" ng-click="back(\'#/teachers/myData\')" class="md-raised">{{\'main.button.back\' | translate}}</md-button> <md-button ng-if="auth.isAdmin()" ng-click="back(\'#/teachers\', qualificationsForm)" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </form> </md-content>'),a.put("teacher/teacher.qualification.view.html",'<!--<div ng-include="\'teacher/teacher.menu.view.html\'"></div>--> <div class="ois-form-layout form-readonly"> <div flex> <div>&nbsp;</div> <div layout="row" layout-xs="column" flex class="form-readonly"> <div layout="row" layout-sm="column" layout-xs="column" flex> <md-input-container flex> <label>{{auth.higher ? (\'teacher.person.nameHigher\' | translate) : (\'teacher.person.nameVocational\' | translate)}}</label> <hois-value value="teacher.person.firstname + \' \' + teacher.person.lastname"></hois-value> </md-input-container> <md-input-container flex> <label>{{auth.higher ? (\'teacher.person.idcodeHigher\' | translate) : (\'teacher.person.idcodeVocational\' | translate)}}</label> <hois-value value="teacher.person.idcode"></hois-value> </md-input-container> </div> </div> <div ng-repeat="qualification in teacher.teacherQualifications | orderBy: \'id\'"> <hois-collapsable label="(\'teacher.qualification.qualification\' | translate)"> <div layout="column" flex> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="50" flex-sm="100"> <label>{{\'teacher.qualification.qualification\' | translate}}</label> <hois-classifier-value ng-model="qualification.qualification" main-classifier-code="EHIS_KVALIFIKATSIOON"></hois-classifier-value> </md-input-container> <md-input-container flex="45" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.qualification.qualificationName\' | translate}}</label> <hois-classifier-value ng-model="qualification.qualificationName" main-classifier-code="EHIS_KVALIFIKATSIOON_NIMI"></hois-classifier-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column" class="top-margin"> <md-input-container flex="25" flex-sm="100"> <label>{{\'teacher.qualification.state\' | translate}}</label> <hois-classifier-value ng-model="qualification.state" main-classifier-code="RIIK"></hois-classifier-value> </md-input-container> <md-input-container flex="20" flex-offset="5" flex-sm="100" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.qualification.endDate\' | translate}}</label> <hois-value value="qualification.endDate | hoisDate"></hois-value> </md-input-container> <md-input-container flex="45" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.qualification.qualificationOther\' | translate}}</label> <hois-value value="qualification.qualificationOther"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="25" flex-sm="100" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.qualification.school\' | translate}}</label> <hois-classifier-value ng-model="qualification.school" main-classifier-code="EHIS_EESTI_OPPEASUTUS"></hois-classifier-value> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.qualification.exSchool\' | translate}}</label> <hois-classifier-value ng-model="qualification.exSchool" main-classifier-code="EHIS_EESTI_OPPEASUTUS_ENDINE"></hois-classifier-value> </md-input-container> <md-input-container flex="25" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.qualification.schoolOther\' | translate}}</label> <hois-value value="qualification.schoolOther"></hois-value> </md-input-container> </div> <span ng-if="teacher.isVocational"> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="25" flex-sm="100" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.qualification.diplomaNr\' | translate}}</label> <hois-value value="qualification.diplomaNr"></hois-value> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.qualification.studyLevel\' | translate}}</label> <hois-classifier-value ng-model="qualification.studyLevel" main-classifier-code="EHIS_EDUCATION_LEVEL"></hois-classifier-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="25" flex-sm="100" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.qualification.specialty\' | translate}}</label> <hois-value value="qualification.specialty"></hois-value> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.qualification.language\' | translate}}</label> <hois-classifier-value ng-model="qualification.language" main-classifier-code="EHIS_OPETAJA_KEEL"></hois-classifier-value> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.qualification.addInfo\' | translate}}</label> <hois-value value="qualification.addInfo"></hois-value> </md-input-container> </div> </span> </div> </hois-collapsable> </div> </div> </div>'),a.put("teacher/teacher.rtip.absence.view.html",'<md-nav-bar ng-if="rtipPage" md-selected-nav-item="currentNavItem" nav-bar-aria-label="main selection" ng-cloak> <md-nav-item ng-if="auth.isAdmin()" md-nav-href="#/teachers/{{::teacher.id}}/edit?_noback" name="teacher.data"> {{\'teacher.data\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isTeacher()" md-nav-href="#/teachers/{{::teacher.id}}/editmydata?_noback" name="teacher.data"> {{\'teacher.data\' | translate}}</md-nav-item> <md-nav-item ng-if="(auth.isAdmin() && teacher.id && teacher.isVocational) || (auth.isTeacher() && teacher.isVocational)" md-nav-href="#/teachers/{{::teacher.id}}/continuingEducation?_noback" name="teacher.continuingEducation"> {{\'teacher.continuingEducation.label\' | translate}}</md-nav-item> <md-nav-item ng-if="(auth.isAdmin() && teacher.id) || (teacher.teacherQualifications.length > 0 && auth.isTeacher())" md-nav-href="#/teachers/{{::teacher.id}}/qualification?_noback" name="teacher.qualification"> {{\'teacher.qualification.qualification\' | translate}}</md-nav-item> <md-nav-item ng-if="(auth.isAdmin() && teacher.id && teacher.isHigher && isHigher) || (auth.isTeacher() && teacher.teacherMobility.length > 0)" md-nav-href="#/teachers/{{::teacher.id}}/mobility?_noback" name="teacher.mobility"> {{\'teacher.mobility.mobility\' | translate}}</md-nav-item> <md-nav-item ng-if="(auth.isAdmin() && teacher.id) || auth.isTeacher()" md-nav-href="#/teachers/{{::teacher.id}}/rtipAbsence?_noback" name="teacher.rtipAbsence"> {{\'teacher.rtipAbsence.label\' | translate}}</md-nav-item> <md-nav-item ng-if="((auth.isAdmin() && teacher.id) || auth.isTeacher()) && teacher.isHigher" md-nav-href="#/teachers/{{::teacher.id}}/programs?_noback" name="teacher.programs"> {{\'teacher.subjectPrograms.label\' | translate}}</md-nav-item> </md-nav-bar> <div layout-padding> <div layout="row" layout-xs="column" flex class="form-readonly"> <div layout="row" layout-sm="column" layout-xs="column" flex> <md-input-container flex> <label>{{auth.higher ? (\'teacher.person.nameHigher\' | translate) : (\'teacher.person.nameVocational\' | translate)}}</label> <hois-value value="teacher.person.firstname + \' \' + teacher.person.lastname"></hois-value> </md-input-container> <md-input-container flex> <label>{{auth.higher ? (\'teacher.person.idcodeHigher\' | translate) : (\'teacher.person.idcodeVocational\' | translate)}}</label> <hois-value value="teacher.person.idcode"></hois-value> </md-input-container> </div> </div> <md-table-container> <table md-table md-progress="tabledata.$promise" class="secondary-table"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="startDate">{{\'teacher.rtipAbsence.absenceFrom\' | translate}}</th> <th md-column md-order-by="endDate">{{\'teacher.rtipAbsence.absenceThru\' | translate}}</th> <th md-column md-order-by="reason">{{\'teacher.rtipAbsence.absenceReason\' | translate}}</th> <th md-column md-order-by="changed">{{\'teacher.rtipAbsence.changed\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{row.startDate | hoisDate}}</td> <td md-cell>{{row.endDate | hoisDate}}</td> <td md-cell>{{row.reason}}</td> <td md-cell>{{row.changed | hoisDate}}</td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> <div layout="row"> <md-button ng-if="!auth.isTeacher() && rtipPage && teacher.canEdit && teacher.rtipNr" ng-click="updateData()" class="md-raised md-primary">{{\'teacher.rtipAbsence.updateData\' | translate}}</md-button> <md-button ng-if="auth.isAdmin() && rtipPage" ng-click="back(\'#/teachers\')" class="md-raised">{{\'main.button.back\' | translate}}</md-button> <md-button ng-if="auth.isTeacher() && rtipPage" ng-click="back(\'#/teachers/myData\')" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </div> </div>'),a.put("teacher/teacher.view.html",'<md-tabs md-dynamic-height md-border-bottom> <md-tab label="{{\'teacher.data\' | translate}}" md-on-select="changeTab(\'DATA\')"> <md-content class="md-padding form-readonly"> <div style="padding-top: 1em"> <div layout="column"> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="30" flex-sm="100" flex-xs="100"> <label>{{auth.higher ? (\'teacher.person.idcodeHigher\' | translate) : (\'teacher.person.idcodeVocational\' | translate)}}</label> <hois-value value="teacher.person.idcode"></hois-value> </md-input-container> <md-input-container flex="30" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.person.birthdate\' | translate}}</label> <hois-value value="teacher.person.birthdate | hoisDate"></hois-value> </md-input-container> <md-input-container flex="30" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.person.sex\' | translate}}</label> <hois-classifier-value ng-model="teacher.person.sex" main-classifier-code="SUGU"></hois-classifier-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="30" flex-sm="100" flex-xs="100"> <label>{{auth.higher ? (\'teacher.person.nameHigher\' | translate) : (\'teacher.person.nameVocational\' | translate)}}</label> <hois-value value="teacher.person.firstname + \' \' + teacher.person.lastname"></hois-value> </md-input-container> <md-input-container flex="30" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.person.nativeLanguage\' | translate}}</label> <hois-classifier-value ng-model="teacher.nativeLanguage" main-classifier-code="EHIS_EMAKEEL"></hois-classifier-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="30" flex-sm="100" flex-xs="100"> <label>{{\'teacher.person.citizenship\' | translate}}</label> <hois-classifier-value ng-model="teacher.person.citizenship" main-classifier-code="RIIK"></hois-classifier-value> </md-input-container> <md-input-container flex="30" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.person.phone\' | translate}}</label> <hois-value value="teacher.person.phone"></hois-value> </md-input-container> <md-input-container flex="30" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.person.email\' | translate}}</label> <hois-value value="teacher.person.email"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex> <label>{{\'teacher.occupation.label\' | translate}}</label> <hois-value value="currentLanguageNameField(teacher.teacherOccupation)"></hois-value> </md-input-container> <md-input-container flex="30" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.phone\' | translate}}</label> <hois-value value="teacher.phone"></hois-value> </md-input-container> <md-input-container flex="30" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.email\' | translate}}</label> <hois-value value="teacher.email"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="30" flex-sm="100" flex-xs="100"> <label>{{\'teacher.scheduleLoad\' | translate}}</label> <hois-value value="teacher.scheduleLoad"></hois-value> </md-input-container> <md-radio-group ng-model="teacher.isStudyPeriodScheduleLoad" layout="row" layout-sm="column" layout-xs="column" flex="30" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0" class="align-center" disabled style="margin-top: -18px"> <md-radio-button ng-value="true"> {{\'teacher.studyPeriodLoad\' | translate}} </md-radio-button> <md-radio-button ng-value="false"> {{\'teacher.studyYearLoad\' | translate}} </md-radio-button> </md-radio-group> <md-input-container flex="30" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.isActive\' | translate}}</label> <hois-value value="teacher.isActive ? \'main.yes\' : \'main.no\' | translate"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="30" flex-sm="100" flex-xs="100"> <label>{{\'teacher.isVocationalOrIsHigher\' | translate}}</label> <hois-value value="vocationalHigher"></hois-value> </md-input-container> <md-input-container flex="30" flex-offset="5" flex-sm="100" flex-xs="100"> <label>{{\'teacher.rtipNr\' | translate}}</label> <hois-value value="teacher.rtipNr"></hois-value> </md-input-container> <md-input-container flex="30" flex-offset="5" flex-sm="100" flex-xs="100"> <label>{{\'teacher.untis\' | translate}}</label> <hois-value value="teacher.untisCode"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column" flex> <md-input-container flex> <label>{{\'teacher.addInfo\' | translate}}</label> <hois-value value="teacher.addInfo"></hois-value> </md-input-container> </div> </div> </div> <div ng-repeat="teacherPositionEhis in teacher.teacherPositionEhis | orderBy: \'id\'"> <hois-collapsable label="(\'teacher.teacherPositionEhis.label\' | translate)"> <div layout="column"> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="30" flex-sm="100" flex-xs="100"> <label>{{\'teacher.teacherPositionEhis.teachingLevel\' | translate}}</label> <hois-value value="teacherPositionEhis.isVocational === true ? \'teacher.isVocational\' : \'teacher.isHigher\' | translate"></hois-value> </md-input-container> <md-input-container flex="30" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.teacherPositionEhis.position\' | translate}}</label> <hois-classifier-value ng-model="teacherPositionEhis.position" main-classifier-code="EHIS_AMETIKOHT"></hois-classifier-value> </md-input-container> <md-input-container flex="30" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.teacherPositionEhis.positionSpecificationEt\' | translate}}</label> <hois-value value="teacherPositionEhis.positionSpecificationEt"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="30" flex-sm="100" flex-xs="100"> <label>{{\'teacher.teacherPositionEhis.contractType\' | translate}}</label> <hois-classifier-value ng-model="teacherPositionEhis.contractType" main-classifier-code="EHIS_LEPING"></hois-classifier-value> </md-input-container> <md-input-container flex="30" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.teacherPositionEhis.contractStart\' | translate}}</label> <hois-value value="teacherPositionEhis.contractStart | hoisDate"></hois-value> </md-input-container> <md-input-container flex="30" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.teacherPositionEhis.contractEnd\' | translate}}</label> <hois-value value="teacherPositionEhis.contractEnd | hoisDate"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="30" flex-sm="100" flex-xs="100"> <label>{{\'teacher.teacherPositionEhis.isContractEnded\' | translate}}</label> <hois-value value="teacherPositionEhis.isContractEnded === true ? \'main.yes\' : \'main.no\' | translate"></hois-value> </md-input-container> <md-input-container flex="30" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.teacherPositionEhis.load\' | translate}}</label> <hois-value value="teacherPositionEhis.load"></hois-value> </md-input-container> <md-input-container ng-if="teacherPositionEhis.isVocational === true" flex="30" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.teacherPositionEhis.language\' | translate}}</label> <hois-classifier-value ng-model="teacherPositionEhis.language" main-classifier-code="EHIS_OPETAJA_KEEL"></hois-classifier-value> </md-input-container> <md-input-container ng-if="!teacherPositionEhis.isVocational" flex="30" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.teacherPositionEhis.isTeacher\' | translate}}</label> <hois-value value="teacherPositionEhis.isTeacher === true ? \'main.yes\' : \'main.no\' | translate"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container ng-if="teacherPositionEhis.isVocational === true" flex="30" flex-sm="100" flex-xs="100"> <label>{{\'teacher.teacherPositionEhis.meetsQualification\' | translate}}</label> <hois-value value="teacherPositionEhis.meetsQualification === true ? \'main.yes\' : \'main.no\' | translate"></hois-value> </md-input-container> <md-input-container ng-if="teacherPositionEhis.isVocational === true" flex="30" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.teacherPositionEhis.workHalted\' | translate}}</label> <hois-value value="teacherPositionEhis.isChildCare === true ? \'main.yes\' : \'main.no\' | translate"></hois-value> </md-input-container> <md-input-container ng-if="teacherPositionEhis.isVocational === true" flex="30" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.teacherPositionEhis.isClassTeacher\' | translate}}</label> <hois-value value="teacherPositionEhis.isClassTeacher === true ? \'main.yes\' : \'main.no\' | translate"></hois-value> </md-input-container> </div> <div ng-if="!teacherPositionEhis.isVocational" layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="30" flex-sm="100" flex-xs="100"> <label>{{\'teacher.teacherPositionEhis.employmentType\' | translate}}</label> <hois-classifier-value ng-model="teacherPositionEhis.employmentType" main-classifier-code="EHIS_TOOSUHE"></hois-classifier-value> </md-input-container> <md-input-container flex="30" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.teacherPositionEhis.employmentTypeSpecification\' | translate}}</label> <hois-value value="teacherPositionEhis.employmentTypeSpecification"></hois-value> </md-input-container> <md-input-container flex="30" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.teacherPositionEhis.employmentCode\' | translate}}</label> <hois-value value="teacherPositionEhis.employmentCode"></hois-value> </md-input-container> </div> <div ng-if="!teacherPositionEhis.isVocational" layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="30" flex-sm="100" flex-xs="100"> <label>{{\'teacher.teacherPositionEhis.schoolDepartment\' | translate}}</label> <hois-value value="currentLanguageNameField(schoolDepartmentsById[teacherPositionEhis.schoolDepartment])"></hois-value> </md-input-container> <md-input-container flex="30" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'teacher.teacherPositionEhis.positionSpecificationEn\' | translate}}</label> <hois-value value="teacherPositionEhis.positionSpecificationEn"></hois-value> </md-input-container> </div> </div> </hois-collapsable> </div> <md-button ng-if="teacher.canEdit && auth.isTeacher()" ng-href="#/teachers/{{teacher.id}}/editmydata" class="md-raised md-primary">{{\'main.button.change\' | translate}}</md-button> </md-content> </md-tab> <md-tab label="{{\'teacher.continuingEducation.continuingEducation\' | translate}}" md-on-select="changeTab(\'CONTINUING_EDUCATION\')" ng-if="teacher.teacherContinuingEducations.length > 0 && teacher.isVocational"> <md-content class="md-padding"> <div ng-include="\'teacher/teacher.continuing.education.view.html\'"></div> </md-content> </md-tab> <md-tab label="{{\'teacher.qualification.qualification\' | translate}}" md-on-select="changeTab(\'QUALIFICATION\')" ng-if="teacher.teacherQualifications.length > 0"> <md-content class="md-padding"> <div ng-include="\'teacher/teacher.qualification.view.html\'"></div> </md-content> </md-tab> <md-tab label="{{\'teacher.mobility.mobility\' | translate}}" md-on-select="changeTab(\'MOBILITY\')" ng-if="teacher.teacherMobility.length > 0"> <md-content class="md-padding"> <div ng-include="\'teacher/teacher.mobility.view.html\'"></div> </md-content> </md-tab> <md-tab md-on-select="changeIsShowingRtipTab()" md-on-deselect="changeIsShowingRtipTab()" label="{{\'teacher.rtipAbsence.label\' | translate}}"> <md-content class="md-padding"> <div ng-include="\'teacher/teacher.rtip.absence.view.html\'"></div> </md-content> </md-tab> <md-tab label="{{\'teacher.subjectPrograms.label\' | translate}}" md-on-select="changeTab(\'SUBJECT_PROGRAMS\')" ng-if="teacher.isHigher"> <md-content class="md-padding"> <div ng-include="\'teacher/teacher.programs.html\'"></div> </md-content> </md-tab> </md-tabs> <div layout="row" ng-if="!auth.isTeacher()" class="md-padding"> <md-button ng-if="!isShowingRtipTab && teacher.canEdit" ng-href="{{getUrl()}}" class="md-raised md-primary">{{\'main.button.change\' | translate}}</md-button> <md-button ng-if="isShowingRtipTab && teacher.canEdit && teacher.rtipNr" ng-click="updateData()" class="md-raised md-primary">{{\'teacher.rtipAbsence.updateData\' | translate}}</md-button> <md-button ng-click="back(\'#/teachers\')" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </div>'),a.put("timetable/timetable.createHigherPlan.html",'<div class="ois-form-layout-padding" layout="column" ng-cloak> <div layout-padding id="groupSelection"> <div layout="row" class="form-readonly"> <md-input-container flex> <label class="textInput">{{\'timetable.timetablePlan.timetablePeriod\' | translate}}</label> <hois-value value="(plan.startDate | hoisDate) + \'-\'+(plan.endDate | hoisDate)"> </md-input-container> <div flex layout="row" layout-align="end start" class="common-label" md-colors="{color: \'background-400\'}"> <span ng-repeat="c in capacityTypes | orderBy: currentLanguageNameField()"> <span ng-if="!$first">|</span> {{::c.value.toUpperCase()}} - {{currentLanguageNameField(c)}} </span> </div> </div> <hois-collapsable expanded="false" label="(\'timetable.timetablePlan.showGroups\' | translate)"> <fieldset tabindex="1"> <div layout="column"> <md-checkbox ng-model="plan.selectAll" flex-offset="5"> {{\'timetable.timetablePlan.selectAll\' | translate}} </md-checkbox> <md-grid-list ng-app="app" md-cols="5" md-cols-md="3" md-cols-sm="2" md-cols-xs="1" md-row-height="5:1"> <md-grid-tile ng-repeat="group in plan.studentGroups"> <md-checkbox ng-model="group._selected" ng-change="updateGroups()"> {{group.code}} </md-checkbox> </md-grid-tile> <md-grid-tile ng-repeat="pair in plan.subjectTeacherPairs"> <md-checkbox ng-model="pair._selected" ng-change="updatePairs()"> {{pair.code}}</md-checkbox> </md-grid-tile> </md-grid-list> </div> </fieldset> </hois-collapsable> <div layout="column" flex layout-gt-md="row"> <div flex="50" layout="column" layout-gt-sm="row"> <md-input-container flex="100" flex-gt-sm="60"> <label>{{\'timetable.timetablePlan.planGroupLessonsSubject\' | translate}}</label> <hois-select ng-model="plan.selectedGroup" values="plan.currentStudentGroups" show-property="code" value-property="dropdownValue"></hois-select> </md-input-container> <hois-autocomplete flex="100" flex-gt-sm="35" flex-offset-gt-sm="5" ng-model="plan.eventRoom" method="rooms" label="lessonplan.event.room"></hois-autocomplete> </div> <div flex="45" layout="column" layout-gt-sm="row" flex-offset-gt-md="5"> <md-input-container flex="100" flex-gt-sm="35"> <label>{{\'timetable.timetablePlan.lessonAmount\' | translate}}</label> <input ng-model="plan.lessonAmount" type="number" autofocus aria-label="lessonamount"> </md-input-container> <md-input-container flex="100" flex-gt-sm="60" flex-offset-gt-sm="5" ng-if="loaded"> <label>{{\'timetable.timetablePlan.repetition\' | translate}}</label> <hois-classifier-select ng-model="plan.repeatCode" model-value-attr="code" aria-label="repeatcode" main-classifier-code="TUNNIPLAAN_SYNDMUS_KORDUS"> </hois-classifier-select> </md-input-container> </div> </div> <div ng-if="plan.selectedGroup && plan.repeatCode && plan.lessonAmount"> <fieldset tabindex="1"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'timetable.timetablePlan.plannedLessons\' | translate}}<span ng-if="plan.selectedGroup"> {{\'timetable.timetablePlan.group\' | translate}} {{plan.selectedStudentGroupObject.code}}</span></legend> <md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column ng-repeat="capacity in plan.currentCapacitiesGrouped track by $index"> <span title="{{capacity[0].subjectName}}&#10;{{getTeachersString(capacity[0].teachers)}}">{{capacity[0].subjectCode}}</span> <span title="{{\'timetable.timetablePlan.periodPlannedLessons\' | translate}} / {{\'timetable.timetablePlan.periodAllocatedLessons\' | translate}}"> (<span ng-repeat="current in capacity" ng-style="{\'color\': isUnderAllocatedLessons(current) ? \'rgba(0,0,0,0.87)\' : \'red\'}"> {{getCapacityTypeValue(current.capacityType)}}: {{current.totalPlannedLessons}}/{{current.totalAllocatedLessons ? current.totalAllocatedLessons : 0}}{{$last ? \'\' : \', \'}}</span> ) </span> </th> </tr> </thead> <tbody md-body> <tr md-row ng-class-odd="\'odd\'" ng-class-even="\'even\'" id="timetable-planned"> <td md-cell ng-repeat="capacity in plan.currentCapacitiesGrouped track by $index" id="timetable-planned-column"> <div ng-repeat="current in capacity" style="background-color: {{getColorBySubjectStudyPeriod(current.subjectStudyPeriod)}}" id="{{current.subjectStudyPeriod}}-{{current.capacityType}}" journal-id="{{current.subjectStudyPeriod}}" ois-drag="true" capacity-type="{{current.capacityType}}" class="timetable-drag timetable-planned-capacity" title="{{current.subjectCode}}/{{currentLanguageNameField(getCapacityType(current.capacityType))}}&#10;{{getTeachersString(current.teachers)}}"> <span>{{current.subjectCode}}/{{getCapacityTypeValue(current.capacityType)}}</span> </div> </td> </tr> </tbody> </table> </md-table-container> </fieldset> </div> <div layout="row"> <md-input-container flex="30" flex-sm="100" flex-xs="100"> <label>{{\'timetable.timetablePlan.week\' | translate}}</label> <md-select ng-model="plan.selectedWeek" placeholder="{{\'timetable.timetablePlan.week\' | translate}}"> <md-option ng-value="week.start" ng-repeat="week in plan.weeks">{{ week.start | hoisDate }}-{{ week.end | hoisDate }}</md-option> </md-select> </md-input-container> </div> <div flex="20" flex-sm="100" flex-xs="100" flex-offset="3"> <md-input-container layout-align="start center"> <md-checkbox ng-model="plan.showLessonTimes" flex-offset="5"> {{\'timetable.timetablePlan.showLessonTimes\' | translate}} </md-checkbox> </md-input-container> </div> <div ng-if="plan.showLessonTimes"> <md-radio-group ng-model="plan.lessonTimeBuilding" layout="row" aria-label="absence" ng-change="lessonTimeBuildingChanged(building)"> <md-radio-button ng-repeat="building in plan.buildings" value="{{building.id}}">{{currentLanguageNameField(building)}}</md-radio-button> </md-radio-group> </div> <div>&nbsp;</div> </div> <div id="timetableCreation" ng-if="plan.currentStudentGroups.length > 0"> <div ng-if="totalLessons === 0"> <md-whiteframe class="md-whiteframe-1dp attention-whiteframe" flex="100" layout layout-align="left center"> <div md-colors="{color: \'warn\'}"> <md-icon md-colors="{color: \'warn\'}" md-font-set="material-icons">info_outline</md-icon> <span>{{\'timetable.timetablePlan.noPeriodLessonTimes\' | translate}}</span> </div> </md-whiteframe> </div> <md-table-container fixed-column-table fixed-columns="1" class="fixed-md-table-container"> <table md-table class="higher"> <thead md-head> <tr md-row> <th md-column></th> <th md-column ng-if="lessonsInDay[date] > 0" ng-repeat="date in plan.datesForTimetable" colspan="{{lessonsInDay[date]}}"> {{\'timetable.timetablePlan.\' + weekday[date.getDay()] | translate}} </th> </tr> </thead> <tbody md-body> <tr md-row ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td class="fixed-cell"></td> <td ng-if="$even" ng-repeat="lessonTime in currentLessonTimes track by $index" colspan="2" ng-class="{dividerBorder: currentLessonTimes[$index + 1].endOfDay}"> <div> {{lessonTime.time | hoisTimeMin}} </div> </td> </tr> <tr> <td class="fixed-cell"></td> <td ng-repeat="lessonTime in currentLessonTimes track by $index" colspan="1" ng-class="{dividerBorder: lessonTime.endOfDay}"> <span>&nbsp;</span> </td> </tr> <tr md-row ng-class="\'even\'" ng-if="plan.showLessonTimes"> <td class="fixed-cell">{{\'timetable.timetablePlan.lessonTimes\' | translate}}</td> <td ng-repeat="lessonTime in lessonTimeLegend" colspan="{{lessonTime.colspan}}" class="higher-timetable-lesson-time" ng-class="{dividerBorder: lessonTime.endOfDay}"> <div layout="center">{{lessonTime.lessonNr}}</div> </td> </tr> <tr md-row ng-repeat="group in plan.currentStudentGroups | orderBy: orderBySelectedGroup" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td>{{group.code}}</td> <td ng-if="lessonsInDay[date] > 0" ng-repeat="date in plan.datesForTimetable" colspan="{{lessonsInDay[date]}}" class="dividerBorder"> <div ng-repeat="lessonTime in group.currentLessons[date.getDate() + date.getMonth() + date.getFullYear()]" old-event-id="{{lessonTime.id}}" ng-class="{\'timetable-higher-drop\' : (plan.selectedGroup === group.dropdownValue && plan.repeatCode && plan.lessonAmount), \'timetable-higher-drag\' : lessonTime.id ? true : false, \'timetable-higher\' : true}" drop-fn="saveEventAfterClashCheck(data)" ng-click="changeEvent(lessonTime)" ng-attr-ois-higher-drop="{{plan.selectedGroup === group.dropdownValue}}" ng-attr-ois-drag="{{(plan.selectedGroup === group.dropdownValue) && lessonTime.id !== undefined}}" id="{{lessonTime.id}}-{{group.id}}" ng-style="lessonTimeStyle(lessonTime)" title="{{lessonTime.subjectName}}/{{currentLanguageNameField(getCapacityType(lessonTime.capacityType))}}&#10;{{lessonTime.teacherNames.join(\', \')}}" journal-id="{{lessonTime.subjectStudyPeriod}}" capacity-type="{{lessonTime.capacityType}}"> <span ng-if="lessonTime.id"> {{lessonTime.subjectCode}}/{{getCapacityTypeValue(lessonTime.capacityType)}} </span> <br> <span ng-if="lessonTime.id && lessonTime.rooms && lessonTime.rooms.length > 0">{{getRoomCodes(lessonTime.rooms)}}</span> <span ng-if="lessonTime.id && (!lessonTime.rooms || lessonTime.rooms.length === 0)" ng-style="boldAndRed(lessonTime.rooms)">?</span> <span ng-if="!lessonTime.id">&nbsp;</span> </div> </td> </tr> </tbody> </table> </md-table-container> <md-button ng-href="#/timetable/{{timetableId}}/view" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </div> </div>'),
a.put("timetable/timetable.createVocationalPlan.html",'<div class="ois-form-layout-padding" layout="column" ng-cloak> <div layout-padding id="groupSelection"> <div layout="row" class="form-readonly"> <md-input-container flex> <label class="textInput">{{\'timetable.timetablePlan.timetablePeriod\' | translate}}</label> <hois-value value="(plan.startDate | hoisDate) + \'-\'+(plan.endDate | hoisDate)"> </md-input-container> <div flex layout="row" layout-align="end start" class="common-label" md-colors="{color: \'background-400\'}"> <span ng-repeat="c in capacityTypes | orderBy: currentLanguageNameField()"> <span ng-if="!$first">|</span> {{::c.value.toUpperCase()}} - {{currentLanguageNameField(c)}} </span> </div> </div> <hois-collapsable expanded="false" label="(\'timetable.timetablePlan.showGroups\' | translate)"> <fieldset tabindex="1"> <div> <div flex> <md-checkbox ng-model="plan.selectAll" flex-offset="5" ng-change="selectAllChanged()"> {{\'timetable.timetablePlan.selectAll\' | translate}} </md-checkbox> </div> <md-grid-list ng-app="app" md-cols="5" md-cols-md="3" md-cols-sm="2" md-cols-xs="1" md-row-height="6:1"> <md-grid-tile ng-repeat="group in plan.studentGroups"> <md-checkbox ng-model="group._selected" ng-change="updateGroups()"> {{group.code}} </md-checkbox> </md-grid-tile> </md-grid-list> </div> </fieldset> </hois-collapsable> <div layout="row"> <md-checkbox ng-model="plan.displayPeriodLessons" flex="10" ng-change="displayPeriodLessonsChanged()"> {{\'timetable.timetablePlan.displayPeriodLessons\' | translate}} </md-checkbox> <md-checkbox ng-model="plan.displayLeftOverLessons" flex="10" ng-change="displayLeftOverLessonsChanged()"> {{\'timetable.timetablePlan.displayLeftOverLessons\' | translate}} </md-checkbox> <md-input-container flex="85" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'timetable.timetablePlan.planGroupLessons\' | translate}}</label> <hois-select ng-model="plan.selectedGroup" values="plan.studentGroups" show-property="code" value-property="id"></hois-select> </md-input-container> </div> <div> <fieldset tabindex="1"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'timetable.timetablePlan.plannedLessons\' | translate}}<span ng-if="plan.selectedGroup"> {{\'timetable.timetablePlan.group\' | translate}} {{plan.selectedStudentGroupObject.code}}</span></legend> <md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column ng-repeat="journal in plan.currentJournals" ng-if="showJournalPlannedLessons(journal)"> <span> <span title="{{journal.name}}&#10;{{journal.teachersString}}">{{journal.name.substring(0, 4)}}</span> <br> <span title="{{\'timetable.timetablePlan.weekPlannedLessons\' | translate}} / {{\'timetable.timetablePlan.weekAllocatedLessons\' | translate}}" ng-style="{\'color\': isUnderAllocatedWeekLessons(journal) ? \'rgba(0,0,0,0.87)\' : \'red\'}"> {{getTotalsByJournal(journal, \'thisPlannedLessons\')}}/{{getTotalsByJournal(journal, \'thisPlannedLessons\') - getTotalsByJournal(journal, \'lessonsLeft\')}} </span> <span ng-if="plan.displayPeriodLessons"> <span title="{{\'timetable.timetablePlan.periodPlannedLessons\' | translate}} / {{\'timetable.timetablePlan.periodAllocatedLessons\' | translate}}" ng-style="{\'color\': isUnderAllocatedTotalLessons(journal) ? \'rgba(0,0,0,0.87)\' : \'red\'}"> ({{getTotalsByJournal(journal, \'totalPlannedLessons\')}}/{{getTotalsByJournal(journal,\'totalAllocatedLessons\')}}) </span> </span> <span ng-if="plan.displayLeftOverLessons"> <span title="{{\'timetable.timetablePlan.periodPlannedLessons\' | translate}} + {{\'timetable.timetablePlan.previousPeriodNotAllocatedLessons\' | translate}} /&#10;{{\'timetable.timetablePlan.periodAllocatedLessons\' | translate}}" ng-style="{\'color\': isUnderLeftOverTotalLessons(journal) ? \'rgba(0,0,0,0.87)\' : \'red\'}"> ({{getTotalsByJournal(journal, \'totalPlannedLessons\') + getTotalsByJournal(journal, \'leftOverLessons\')}}/{{getTotalsByJournal(journal,\'totalAllocatedLessons\')}}) </span> </span> </span> </th> </tr> </thead> <tbody md-body> <tr md-row ng-class-odd="\'odd\'" ng-class-even="\'even\'" id="timetable-planned"> <td md-cell ng-repeat="capacity in plan.currentCapacitiesGrouped track by $index" ng-if="showCurrentCapacitiesGrouped(capacity)" id="timetable-planned-column"> <div ng-repeat="current in capacity" class="timetable-planned-capacity"> <div ng-if="!plan.displayPeriodLessons && !plan.displayLeftOverLessons && current.lessonsLeft > 0" title="{{getByCapacity(current, \'name\')}}/{{currentLanguageNameField(getCapacityType(current.capacityType))}}&#10;{{getByCapacity(current, \'teachersString\')}}" style="background-color: {{getByCapacity(current, \'color\')}}" id="{{current.journal}}-{{count}}" ois-drag="true" journal-id="{{current.journal}}" capacity-type="{{current.capacityType}}" class="timetable-drag"> <span>{{getByCapacity(current, \'name\').substring(0, 4)}}/{{getCapacityTypeValue(current.capacityType)}}</span> </div> <div ng-if="plan.displayPeriodLessons && current.totalLessonsLeft > 0" title="{{getByCapacity(current, \'name\')}}/{{currentLanguageNameField(getCapacityType(current.capacityType))}}&#10;{{getByCapacity(current, \'teachersString\')}}" style="background-color: {{getByCapacity(current, \'color\')}}" id="{{current.journal}}-{{count}}" ois-drag="true" journal-id="{{current.journal}}" capacity-type="{{current.capacityType}}" class="timetable-drag"> <span>{{getByCapacity(current, \'name\').substring(0, 4)}}/{{getCapacityTypeValue(current.capacityType)}}</span> </div> <div ng-if="plan.displayLeftOverLessons && current.totalPlannedLessons + current.leftOverLessons > current.totalAllocatedLessons" title="{{getByCapacity(current, \'name\')}}/{{currentLanguageNameField(getCapacityType(current.capacityType))}}&#10;{{getByCapacity(current, \'teachersString\')}}" style="background-color: {{getByCapacity(current, \'color\')}}" id="{{current.journal}}-{{count}}" ois-drag="true" journal-id="{{current.journal}}" capacity-type="{{current.capacityType}}" class="timetable-drag"> <span>{{getByCapacity(current, \'name\').substring(0, 4)}}/{{getCapacityTypeValue(current.capacityType)}}</span> </div> </div> </td> </tr> </tbody> </table> </md-table-container> </fieldset> </div> </div> <div id="timetableCreation"> <md-table-container fixed-column-table fixed-columns="1" class="fixed-md-table-container"> <table md-table class="timetableVocationalPlan"> <thead md-head> <tr md-row> <th md-column class="fixed-cell"></th> <th md-column ng-repeat="date in plan.datesForTimetable" colspan="{{lessonsInDay[weekday[date.getDay()]].length}}">{{\'timetable.timetablePlan.\' + weekday[date.getDay()] | translate}} </th> </tr> </thead> <tbody md-body> <tr md-row ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td class="fixed-cell"></td> <td style="text-align: center" ng-repeat="lessonTime in currentLessonTimes track by $index" ng-class="{dividerBorder: lessonTime.endOfDay}"> <span>{{lessonTime.lessonNr}}</span> </td> </tr> <tr md-row ng-repeat="group in plan.currentStudentGroups | orderBy: orderBySelectedGroup" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td class="fixed-cell" style="min-width: 100px">{{group.code}}</td> <td ng-repeat="lessonTime in currentLessonTimes track by $index" ng-class="{noLessonTime: lessonTime.noLessons, dividerBorder: lessonTime.endOfDay}"> <span ng-if="!lessonTime.noLessons"> <div index-value="{{$parent.$index}}" drop-fn="saveEvent(data)" ng-attr-ois-drop="{{plan.selectedGroup === group.id}}" ng-repeat="currentEvent in t = angular.equals(t.id, getEventsForLesson($index, lessonTime, group).id) ? t : getEventsForLesson($index, lessonTime, group)" ng-click="changeEvent(currentEvent)" ng-attr-ois-drag="{{plan.selectedGroup === group.id}}" id="{{currentEvent.journalObject.id + \'-\' + $index + group.id}}" journal-id="{{currentEvent.journal}}" class="timetable-drag" style="background-color:{{currentEvent.journalObject.color}}" old-event-id="{{currentEvent.id}}" title="{{currentEvent.journalObject.name}}/{{currentLanguageNameField(getCapacityType(currentEvent.capacityType))}}&#10;{{currentEvent.currentTeachers.join(\', \')}}"> <span>{{currentEvent.journalObject.name.substr(0, 4)}}/{{getCapacityTypeValue(currentEvent.capacityType)}}</span> <br> <span style=";{{currentEvent.rooms.length !== 0 ? \'\' : \'color:red;font-weight: bold;\'}}">{{currentEvent.rooms.length !== 0 ? getRoomCodes(currentEvent.rooms) : "?"}}</span> </div> <div ng-if="!getEventsForLesson($index, lessonTime, group)" ng-attr-ois-drop="{{plan.selectedGroup === group.id}}" index-value="{{$index}}" drop-fn="saveEvent(data)" id="{{group.id + \'-\' + $index}}" class="timetable-drop"> </div> </span> </td> </tr> </tbody> </table> </md-table-container> <md-button ng-href="#/timetable/{{timetableId}}/view" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </div> </div>'),a.put("timetable/timetable.edit.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div> <form name="timetableForm" novalidate class="nomargin"> <md-input-container layout="row" flex="50" flex-sm="100" flex-xs="100"> <label>{{\'timetable.management.studyYear\' | translate}}</label> <hois-select required ng-model="timetable.studyYear" values="formState.studyYears" ng-change="studyYearChanged()" ng-disabled="timetable.code === \'TUNNIPLAAN_LIIK_V\'" sorted-query="true"></hois-select> </md-input-container> <md-input-container layout="row" flex="50" flex-sm="100" flex-xs="100"> <label>{{\'timetable.management.studyPeriod\' | translate}}</label> <hois-select required ng-model="timetable.studyPeriod" values="formState.studyPeriods" ng-disabled="timetable.code === \'TUNNIPLAAN_LIIK_V\'" sorted-query="true"></hois-select> </md-input-container> <div layout="row"> <md-input-container flex="25" flex-md="100" flex-sm="100" flex-xs="100"> <label>{{\'main.from\' | translate}}</label> <md-datepicker required ng-model="timetable.startDate" md-min-date="studyPeriodStartDate" md-max-date="studyPeriodEndDate" md-date-filter="blockedFromDatesPredicate" ng-disabled="timetable.code === \'TUNNIPLAAN_LIIK_V\' || !timetable.studyPeriod"></md-datepicker> </md-input-container> <md-input-container flex="25" flex-md="100" flex-sm="100" flex-xs="100"> <label>{{\'main.thru\' | translate}}</label> <md-datepicker required ng-model="timetable.endDate" md-min-date="endDateMinDate" md-max-date="studyPeriodEndDate" md-date-filter="blockedThruDatesPredicate" ng-disabled="timetable.code === \'TUNNIPLAAN_LIIK_V\' || !timetable.studyPeriod"></md-datepicker> </md-input-container> </div> <md-input-container layout="row" flex="50" flex-sm="100" flex-xs="100"> <label>{{\'timetable.management.type\' | translate}}</label> <hois-classifier-select ng-model="timetable.code" model-value-attr="code" main-classifier-code="TUNNIPLAAN_LIIK" disabled></hois-classifier-select> </md-input-container> </form> <md-button ng-click="save()" class="md-raised md-primary">{{\'main.button.save\' | translate}}</md-button> <md-button ng-href="#/timetable/timetableManagement" class="md-raised">{{\'main.button.back\' | translate}} </md-button> </div> </div>'),a.put("timetable/timetable.event.change.dialog.html",'<md-dialog aria-label="add enterprise dialog" flex="30"> <form name="dialogForm" ng-submit="dialogForm.$valid && saveEvent()" novalidate ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2 flex>{{lessonHeader}}, {{currentLanguageNameField(lessonCapacityName)}}</h2> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <span flex></span> <div class="ois-form-layout" layout="column" layout-margin ng-cloak> <div layout="column"> <div flex="100" flex-offset="2" flex-offset-xs="0" flex-offset-sm="0"> <div layout="row" flex="70"> <hois-autocomplete flex ng-model="lesson.eventRoom" method="rooms" label="lessonplan.event.room" warning-param="isOccupied" additional-query-params="{buildingIds: lesson.buildingIds, isStudy: true, occupied: true, date: lesson.start, \r\n                    timetable: timetableId, startTime: lesson.startTime, endTime: lesson.endTime}"></hois-autocomplete> </div> <div layout="column" class="common-label" flex="70" ng-repeat="room in lesson.eventRooms"> <div layout="row" flex layout-align="start center"> <div flex="10">&nbsp;</div> <div flex="60">{{room.nameEt}}</div> <div flex="25" class="occupied-warning"> <span ng-if="isRoomOccupied(room.id)"> <md-icon md-colors="{color: \'default-warn\'}" md-font-set="material-icons">warning</md-icon> <span md-colors="{color: \'default-warn\'}">{{\'timetable.timetableEvent.occupied\' | translate}}</span> </span> </div> <div><a ng-click="removeFromArray(lesson.eventRooms, room)" class="remove">&times;</a></div> </div> </div> </div> <div layout="row" flex="100"> <md-input-container flex="30" flex-sm="100" flex-offset="2" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'main.start\' | translate}}</label> <hois-time ng-model="lesson.startTime" placeholder="{{\'main.timePlaceholder\' | translate}}"></hois-time> </md-input-container> <md-input-container flex="30" flex-sm="100" flex-offset="10" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'main.end\' | translate}}</label> <hois-time ng-model="lesson.endTime" placeholder="{{\'main.timePlaceholder\' | translate}}"></hois-time> </md-input-container> </div> <div flex="100"> <div ng-repeat="teacher in teachers" layout="row" flex="70" class="common-label"> <div flex="10"> <md-checkbox layout="row" ng-model="teacher.isTeaching"></md-checkbox> </div> <div flex="60"> <span>{{teacher.nameEt}}</span> <span>&nbsp;</span> <span ng-if="teacher.capacity"> <span ng-if="!teacher.subjectStudyPeriod"> <span title="{{\'timetable.timetablePlan.weekPlannedLessons\' | translate}} / {{\'timetable.timetablePlan.weekAllocatedLessons\' | translate}}" ng-style="{\'color\': isUnderAllocatedWeekLessons(teacher.capacity) ? \'rgba(0,0,0,0.87)\' : \'red\'}"> {{teacher.capacity.thisPlannedLessons}}/{{teacher.capacity.thisPlannedLessons - teacher.capacity.lessonsLeft}} </span> </span> <span ng-if="teacher.subjectStudyPeriod"> <span title="{{\'timetable.timetablePlan.periodPlannedLessons\' | translate}} / {{\'timetable.timetablePlan.periodAllocatedLessons\' | translate}}" ng-style="{\'color\': isUnderAllocatedLessons(teacher.capacity) ? \'rgba(0,0,0,0.87)\' : \'red\'}"> {{teacher.capacity.totalPlannedLessons}}/{{teacher.capacity.totalAllocatedLessons}} </span> </span> <span ng-if="displayPeriodLessons"> <span title="{{\'timetable.timetablePlan.periodPlannedLessons\' | translate}} / {{\'timetable.timetablePlan.periodAllocatedLessons\' | translate}}" ng-style="{\'color\': isUnderAllocatedTotalLessons(teacher.capacity) ? \'rgba(0,0,0,0.87)\' : \'red\'}"> ({{teacher.capacity.totalPlannedLessons}}/{{teacher.capacity.totalAllocatedLessons}}) </span> </span> <span ng-if="displayLeftOverLessons"> <span title="{{\'timetable.timetablePlan.periodPlannedLessons\' | translate}} + {{\'timetable.timetablePlan.previousPeriodNotAllocatedLessons\' | translate}} /&#10;{{\'timetable.timetablePlan.periodAllocatedLessons\' | translate}}" ng-style="{\'color\': isUnderLeftOverTotalLessons(teacher.capacity) ? \'rgba(0,0,0,0.87)\' : \'red\'}"> ({{teacher.capacity.totalPlannedLessons + teacher.capacity.leftOverLessons}}/{{teacher.capacity.totalAllocatedLessons}}) </span> </span> </span> </div> <div flex="25" class="occupied-warning"> <span ng-if="isTeacherOccupied(teacher.id)"> <md-icon md-colors="{color: \'default-warn\'}" md-font-set="material-icons">warning</md-icon> <span md-colors="{color: \'default-warn\'}">{{\'timetable.timetableEvent.occupied\' | translate}}</span> </span> </div> </div> </div> </div> </div> </md-dialog-content> <md-dialog-actions layout="row" layout-align="start start"> <md-button class="md-raised md-primary" type="submit">{{\'main.button.save\' | translate}}</md-button> <md-button class="md-raised" ng-click="cancel()">{{"main.button.close" | translate}}</md-button> <md-button class="md-raised" ng-click="deleteEvent(lesson.id)">{{"main.button.delete" | translate}}</md-button> </md-dialog-actions> </form> </md-dialog>'),a.put("timetable/timetable.lessonTime.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <form layout="column" name="lessonTimeForm" novalidate class="nomargin"> <div layout="column" flex> <div> <div layout="row" layout-sm="column" layout-xs="column" flex-sm="100" flex-xs="100"> <md-input-container> <label>{{\'timetable.lessonTime.validFrom\' | translate}}</label> <md-datepicker ng-model="validFrom" md-min-date="minValidFrom" required ng-disabled="blocks.length === 0"></md-datepicker> </md-input-container> </div> <div layout-padding ng-repeat="block in blocks | orderBy: \'id\'"> <div layout="row" flex> <md-input-container flex="10" flex-xs="100"> <label>{{\'timetable.buildings\' | translate}}</label> </md-input-container> <md-grid-list md-cols="4" md-cols-md="3" md-cols-sm="2" md-cols-xs="1" md-gutter="1em" md-row-height="35px" flex="90" flex-xs="100"> <md-grid-tile ng-repeat="building in buildings | orderBy: currentLanguageNameField()"> <md-checkbox ng-model="block.selectedBuildings[building.id]" ng-disabled="isBuildingDisabled(building, block)" ng-change="buildingChanged(building, block)" style="position: absolute; left: 5px">{{ currentLanguageNameField(building) }}</md-checkbox> </md-grid-tile> </md-grid-list> </div> <input style="display:none" type="number" readonly name="{{\'buildingsLength\'+$index}}" ng-model="selectedBuildingsLength(block)" ng-model-options="{ getterSetter: true }" min="1"> <div md-colors="{color: \'warn-A400\'}" ng-messages="lessonTimeForm[\'buildingsLength\'+$index].$error"> <div ng-if="lessonTimeForm.$submitted" ng-message="min">{{\'main.messages.error.atLeastOneShouldBeAdded\' | translate}}</div> </div> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column>{{\'main.nr\' | translate}}</th> <th md-column>{{\'main.start\' | translate}}</th> <th md-column>{{\'main.end\' | translate}}</th> <th md-column>{{\'timetable.academicHours\' | translate}}</th> <th md-column>{{\'main.mondayShort\' | translate}}</th> <th md-column>{{\'main.tuesdayShort\' | translate}}</th> <th md-column>{{\'main.wednesdayShort\' | translate}}</th> <th md-column>{{\'main.thursdayShort\' | translate}}</th> <th md-column>{{\'main.fridayShort\' | translate}}</th> <th md-column>{{\'main.saturdayShort\' | translate}}</th> <th md-column>{{\'main.sundayShort\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="lessonTime in block.lessonTimes | orderBy: \'lessonNr\'" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell> <md-input-container> <input style="width:4em" ng-model="lessonTime.lessonNr" ng-model-options="{ updateOn: \'mousedown blur\' }" aria-label="{{\'main.nr\' | translate}}" type="number" ng-required="isLessonTimeRowFilled(lessonTime)"> </md-input-container> </td> <td md-cell> <md-input-container> <label></label> <hois-time placeholder="{{\'main.timePlaceholder\' | translate}}" ng-model="lessonTime.startTime" ng-max="lessonTime.endTime" aria-label="{{\'main.start\' | translate}}" ng-required="isLessonTimeRowFilled(lessonTime)"></hois-time> </md-input-container> </td> <td md-cell> <md-input-container> <label></label> <hois-time placeholder="{{\'main.timePlaceholder\' | translate}}" ng-model="lessonTime.endTime" ng-min="lessonTime.startTime" aria-label="{{\'main.end\' | translate}}" ng-required="isLessonTimeRowFilled(lessonTime)"></hois-time> </md-input-container> </td> <td md-cell> <md-input-container flex="25"> <input ng-model="lessonTime.academicHours" ng-value="calculateAcademicHours(lessonTime.startTime, lessonTime.endTime)" aria-label="{{\'timetable.academicHours\' | translate}}" type="text" readonly> </md-input-container> </td> <td md-cell> <md-input-container> <md-checkbox ng-model="lessonTime.dayMon" aria-label="{{\'main.mondayShort\' | translate}}"></md-checkbox> </md-input-container> </td> <td md-cell> <md-input-container> <md-checkbox ng-model="lessonTime.dayTue" aria-label="{{\'main.tuesdayShort\' | translate}}"></md-checkbox> </md-input-container> </td> <td md-cell> <md-input-container> <md-checkbox ng-model="lessonTime.dayWed" aria-label="{{\'main.wednesdayShort\' | translate}}"></md-checkbox> </md-input-container> </td> <td md-cell> <md-input-container> <md-checkbox ng-model="lessonTime.dayThu" aria-label="{{\'main.thursdayShort\' | translate}}"></md-checkbox> </md-input-container> </td> <td md-cell> <md-input-container> <md-checkbox ng-model="lessonTime.dayFri" aria-label="{{\'main.fridayShort\' | translate}}"></md-checkbox> </md-input-container> </td> <td md-cell> <md-input-container> <md-checkbox ng-model="lessonTime.daySat" aria-label="{{\'main.saturdayShort\' | translate}}"></md-checkbox> </md-input-container> </td> <td md-cell> <md-input-container> <md-checkbox ng-model="lessonTime.daySun" aria-label="{{\'main.sundayShort\' | translate}}"></md-checkbox> </md-input-container> </td> <td md-cell> <div ng-show="isLessonTimeRowFilled(lessonTime)" class="remove nomargin" ng-click="deleteRow(block.lessonTimes, lessonTime)">&times;</div> </td> </tr> </tbody> </table> </md-table-container> <div layout="row" layout-sm="column" layout-xs="column" flex> <md-button class="md-primary" ng-click="addNewRow(block)">{{\'main.button.addNewRow\' | translate}}</md-button> <md-button class="md-primary" ng-click="deleteBlock(block)">{{\'timetable.lessonTime.deleteBlock\' | translate}}</md-button> </div> </div> <div layout="row" layout-sm="column" layout-xs="column" flex> <md-button class="md-primary" ng-click="addNewBlock()">{{\'timetable.lessonTime.addNewBlock\' | translate}}</md-button> </div> </div> <div> <md-button class="md-raised md-primary" ng-click="save()" ng-if="isEdit() || blocks.length > 0">{{blocks.length > 0 ? (\'main.button.save\' | translate) : (\'main.button.delete\' | translate)}}</md-button> <md-button ng-click="back(\'#/timetable/lessonTime/search\', lessonTimeForm)" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </div> </div> </form> </div> </div>'),a.put("timetable/timetable.lessonTime.list.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <form name="searchForm" ng-submit="searchForm.$valid && loadData()" novalidate class="nomargin"> <div layout="row" layout-sm="column" layout-xs="column" flex> <div layout="row" layout-sm="column" layout-xs="column" flex="25" flex-sm="100" flex-xs="100"> <md-input-container> <label>{{\'main.from\' | translate}}</label> <md-datepicker ng-model="criteria.from" md-mad-date="criteria.thru" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column" flex="25" flex-sm="100" flex-xs="100"> <md-input-container> <label>{{\'main.thru\' | translate}}</label> <md-datepicker ng-model="criteria.thru" md-min-date="criteria.from" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column" flex="20" flex-sm="100" flex-xs="100"> <md-input-container flex> <label>{{\'timetable.weekday\' | translate}}</label> <md-select ng-model="criteria.day" multiple> <md-option ng-repeat="option in days" ng-value="option.code" aria-label="{{currentLanguageNameField(option)}}">{{currentLanguageNameField(option)}}</md-option> </md-select> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column" flex="20" flex-offset="5" flex-sm="100" flex-offset-sm="0" flex-xs="100" flex-offset-xs="0"> <md-input-container flex> <label>{{\'building.label\' | translate}}</label> <hois-select ng-model="criteria.building" type="building" multiple></hois-select> </md-input-container> </div> </div> <div layout="row" flex> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> <a class="md-button md-raised" ng-if="canEdit" ng-href="#/timetable/lessonTime">{{\'main.button.create\' | translate}}</a> </div> <div flex-xs="0" flex-gt-xs="0" flex-gt-sm="50"></div> </form> </fieldset> </div> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="lessonNr">{{\'main.nr\' | translate}}</th> <th md-column md-order-by="startTime">{{\'main.start\' | translate}}</th> <th md-column md-order-by="endTime">{{\'main.end\' | translate}}</th> <th md-column>{{\'timetable.weekdays\' | translate}}</th> <th md-column>{{\'timetable.buildings\' | translate}}</th> <th md-column>{{\'main.validFrom\' | translate}}</th> <th md-column>{{\'main.validThru\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{row.lessonNr}}</td> <td md-cell>{{row.startTime}}</td> <td md-cell>{{row.endTime}}</td> <td md-cell>{{displayWeekdays(row)}}</td> <td md-cell>{{displayBuildings(row.buildings)}}</td> <td md-cell>{{row.validFrom | hoisDate}}</td> <td md-cell>{{row.validThru | hoisDate}}</td> <td md-cell> <a class="md-button md-primary" ng-href="/#/timetable/lessonTime/{{::row.id}}/{{!canEditLessonTime(row) ? \'view\' : \'edit\'}}"> {{\'main.button.\' + (!canEditLessonTime(row) ? \'view\' : \'edit\') | translate}}</a> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> </div>'),a.put("timetable/timetable.lessonTime.view.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <form layout="column" style="display: block"> <div layout="column" layout-sm="column" layout-xs="column" flex> <div layout="row" class="form-readonly" layout-sm="column" layout-xs="column" flex-sm="100" flex-xs="100"> <md-input-container flex> <label>{{\'timetable.lessonTime.validFrom\' | translate}}</label> <hois-value value="validFrom | hoisDate"></hois-value> </md-input-container> </div> <div layout-padding ng-repeat="block in blocks | orderBy: $index"> <div layout="row" layout-sm="column" layout-xs="column" flex> <md-input-container flex="10" flex-xs="100"> <label>{{\'timetable.buildings\' | translate}}</label> </md-input-container> <md-input-container layout="row" layout-align="start center"> <md-checkbox ng-model="block.selectedBuildings[building.id]" ng-repeat="building in buildings | orderBy: currentLanguageNameField()" disabled>{{ currentLanguageNameField(building) }}</md-checkbox> </md-input-container> </div> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column>{{\'main.nr\' | translate}}</th> <th md-column>{{\'main.start\' | translate}}</th> <th md-column>{{\'main.end\' | translate}}</th> <th md-column>{{\'timetable.academicHours\' | translate}}</th> <th md-column>{{\'main.mondayShort\' | translate}}</th> <th md-column>{{\'main.tuesdayShort\' | translate}}</th> <th md-column>{{\'main.wednesdayShort\' | translate}}</th> <th md-column>{{\'main.thursdayShort\' | translate}}</th> <th md-column>{{\'main.fridayShort\' | translate}}</th> <th md-column>{{\'main.saturdayShort\' | translate}}</th> <th md-column>{{\'main.sundayShort\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="lessonTime in block.lessonTimes | orderBy: \'lessonNr\'" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell> <span>{{::lessonTime.lessonNr}}</span> </td> <td md-cell> <span>{{lessonTime.startTime | hoisTime}}</span> </td> <td md-cell> <span>{{lessonTime.endTime | hoisTime}}</span> </td> <td md-cell> <span>{{calculateAcademicHours(lessonTime.startTime, lessonTime.endTime)}}</span> </td> <td md-cell> <md-input-container> <md-checkbox ng-model="lessonTime.dayMon" aria-label="{{\'main.mondayShort\' | translate}}" disabled></md-checkbox> </md-input-container> </td> <td md-cell> <md-input-container> <md-checkbox ng-model="lessonTime.dayTue" aria-label="{{\'main.tuesdayShort\' | translate}}" disabled></md-checkbox> </md-input-container> </td> <td md-cell> <md-input-container> <md-checkbox ng-model="lessonTime.dayWed" aria-label="{{\'main.wednesdayShort\' | translate}}" disabled></md-checkbox> </md-input-container> </td> <td md-cell> <md-input-container> <md-checkbox ng-model="lessonTime.dayThu" aria-label="{{\'main.thursdayShort\' | translate}}" disabled></md-checkbox> </md-input-container> </td> <td md-cell> <md-input-container> <md-checkbox ng-model="lessonTime.dayFri" aria-label="{{\'main.fridayShort\' | translate}}" disabled></md-checkbox> </md-input-container> </td> <td md-cell> <md-input-container> <md-checkbox ng-model="lessonTime.daySat" aria-label="{{\'main.saturdayShort\' | translate}}" disabled></md-checkbox> </md-input-container> </td> <td md-cell> <md-input-container> <md-checkbox ng-model="lessonTime.daySun" aria-label="{{\'main.sundayShort\' | translate}}" disabled></md-checkbox> </md-input-container> </td> </tr> </tbody> </table> </md-table-container> </div> </div> <br> <div layout="row"> <md-button ng-href="#/timetable/lessonTime/search" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </div> </form> </div> </div>'),a.put("timetable/timetable.timetableEvent.edit.html",'<div class="ois-form-layout-padding" ng-cloak> <div flex> <form name="eventForm" ng-submit="eventForm.$valid && loadData()" novalidate layout="column"> <div layout="row" flex="100"> <md-input-container flex="50" flex-sm="100"> <label>{{\'main.date\' | translate}}</label> <md-datepicker required ng-model="timetableEvent.date"></md-datepicker> </md-input-container> <md-input-container flex flex-sm="100" flex-offset="2" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'main.start\' | translate}}</label> <hois-time required ng-model="timetableEvent.startTime" placeholder="{{\'main.timePlaceholder\' | translate}}"></hois-time> </md-input-container> <md-input-container flex flex-sm="100" flex-offset="2" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'main.end\' | translate}}</label> <hois-time required ng-model="timetableEvent.endTime" placeholder="{{\'main.timePlaceholder\' | translate}}"></hois-time> </md-input-container> </div> <md-input-container flex> <label class="textInput">{{\'timetable.timetableEvent.name\' | translate}}</label> <input type="text" ng-model="timetableEvent.name" required md-maxlength="255"> </md-input-container> <div ng-if="!timetableEvent.id" layout="row" flex="100"> <md-input-container flex="20" flex-sm="100" flex-xs="100"> <md-checkbox ng-model="timetableEvent.repeat" aria-label="Is repeat event"> {{\'timetable.timetableEvent.isRepeat\' | translate}} </md-checkbox> </md-input-container> <div ng-if="timetableEvent.repeat" flex="80"> <md-input-container flex="50"> <label>{{\'timetable.timetableEvent.weekAmount\' | translate}}</label> <input flex="100" ng-model="timetableEvent.weekAmount" type="number" autofocus aria-label="weekamount" required> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label>{{\'timetable.timetableEvent.repetition\' | translate}}</label> <hois-classifier-select flex="100" ng-model="timetableEvent.repeatCode" model-value-attr="code" aria-label="repeatcode" filter-values="[\'TUNNIPLAAN_SYNDMUS_KORDUS_EI\']" main-classifier-code="TUNNIPLAAN_SYNDMUS_KORDUS" required> </hois-classifier-select> </md-input-container> </div> </div> <div layout="row" flex="60" flex-sm="100" flex-xs="100"> <hois-autocomplete label="{{auth.higher ? \'timetable.timetableEvent.teacherHigher\' : \'timetable.timetableEvent.teacherVocational\'}}" ng-model="timetableEvent.teacher" ng-disabled="auth.isTeacher()" method="teachers" warning-param="isOccupied" additional-query-params="{valid: true, occupied: true, date: timetableEvent.date, startTime: timetableEvent.startTime, endTime: timetableEvent.endTime, \r\n            repeatCode: timetableEvent.repeatCode, weekAmount: timetableEvent.weekAmount}" flex></hois-autocomplete> </div> <md-table-container ng-if="timetableEvent.teachers.length > 0" layout="row" flex="60" flex-sm="100" flex-xs="100"> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column ng-style="{\'width\': !timetableEvent.isSingleEvent ? 70 + \'%\' : 90 + \'%\' }">{{\'timetable.timetableEvent.teacherName\' | translate}}</th> <th md-column ng-if="!timetableEvent.isSingleEvent" width="20%">{{\'timetable.timetableEvent.substitute\' | translate}}</th> <th md-column width="10%"></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="teacher in timetableEvent.teachers | orderBy: sortTeachers" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{currentLanguageNameField(teacher.teacher)}}</td> <td md-cell ng-if="!timetableEvent.isSingleEvent"> <md-checkbox ng-model="teacher.isSubstitute" aria-label="{{\'timetable.timetableEvent.substitute\' | translate}}" ng-disabled="!auth.isAdmin()"></md-checkbox> </td> <td md-cell> <a ng-if="auth.isAdmin()" ng-click="deleteTeacher(teacher)" class="remove">&times;</a> </td> </tr> </tbody> </table> </md-table-container> <div layout="row" flex="60" flex-sm="100" flex-xs="100"> <hois-autocomplete label="timetable.timetableEvent.room" ng-model="timetableEvent.room" method="rooms" warning-param="isOccupied" additional-query-params="{isStudy: true, occupied: true, date: timetableEvent.date, startTime: timetableEvent.startTime, endTime: timetableEvent.endTime, \r\n            repeatCode: timetableEvent.repeatCode, weekAmount: timetableEvent.weekAmount}" flex></hois-autocomplete> </div> <md-table-container ng-if="timetableEvent.rooms.length > 0" layout="row" flex="60" flex-sm="100" flex-xs="100"> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column width="90%">{{\'timetable.timetableEvent.code\' | translate}}</th> <th md-column width="10%"></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="room in timetableEvent.rooms | orderBy: currentLanguageNameField()" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{room.nameEt}}</td> <td md-cell> <a ng-click="deleteRoom(room)" class="remove">&times;</a> </td> </tr> </tbody> </table> </md-table-container> <div layout="row" flex="60" flex-sm="100" flex-xs="100"> <hois-autocomplete label="timetable.timetableEvent.studentGroup" ng-model="timetableEvent.studentGroup" method="studentgroups" warning-param="isOccupied" additional-query-params="{valid: true, occupied: true, date: timetableEvent.date, startTime: timetableEvent.startTime, endTime: timetableEvent.endTime, \r\n            repeatCode: timetableEvent.repeatCode, weekAmount: timetableEvent.weekAmount, studentGroupTeacherId: (auth.isTeacher() && !auth.higher) ? auth.teacher : undefined}" flex></hois-autocomplete> </div> <md-table-container ng-if="timetableEvent.studentGroups.length > 0" layout="row" flex="60" flex-sm="100" flex-xs="100"> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column width="90%">{{\'timetable.timetableEvent.code\' | translate}}</th> <th md-column width="10%"></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="studentGroup in timetableEvent.studentGroups" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{studentGroup.nameEt}}</td> <td md-cell> <a ng-click="deleteStudentGroup(studentGroup)" class="remove">&times;</a> </td> </tr> </tbody> </table> </md-table-container> <md-input-container flex> <label class="textInput"> {{auth.higher ? (\'timetable.timetableEvent.otherTeacherHigher\' | translate) : (\'timetable.timetableEvent.otherTeacherVocational\' | translate)}} </label> <input type="text" ng-model="timetableEvent.otherTeacher" md-maxlength="1000"> </md-input-container> <md-input-container flex> <label class="textInput">{{\'timetable.timetableEvent.otherRoom\' | translate}}</label> <input type="text" ng-model="timetableEvent.otherRoom" md-maxlength="1000"> </md-input-container> <div layout="row" flex> <md-button class="md-raised md-primary" ng-click="save()">{{\'main.button.save\' | translate}}</md-button> <md-button ng-if="timetableEvent.id" ng-click="delete()" class="md-raised">{{\'main.button.delete\' | translate}}</md-button> <md-button ng-click="back(\'#/lessonplans/events\', eventForm)" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </div> </form> </div> </div>'),
a.put("timetable/timetable.timetableEvent.view.html",'<div class="ois-form-layout-padding form-readonly" ng-cloak> <div flex> <br> <form name="eventForm"> <div layout="row" layout-xs="column" flex="100"> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100"> <label>{{\'main.date\' | translate}}</label> <hois-value value="timetableEvent.date | hoisDate"></hois-value> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-xs="100" flex-offset="2" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'main.start\' | translate}}</label> <hois-value value="timetableEvent.startTime | hoisTime"></hois-value> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-xs="100" flex-offset="2" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'main.end\' | translate}}</label> <hois-value value="timetableEvent.endTime | hoisTime"></hois-value> </md-input-container> </div> <div layout="row" flex="100"> <md-input-container flex="60" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'timetable.timetableEvent.name\' | translate}}</label> <hois-value value="timetableEvent.name"></hois-value> </md-input-container> </div> <fieldset flex="60" flex-sm="100" flex-xs="100" ng-if="timetableEvent.teachers.length > 0"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small"> {{auth.higher ? (\'timetable.timetableEvent.teacherHigher\' | translate) : (\'timetable.timetableEvent.teachersVocational\' | translate)}} </legend> <md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'timetable.timetableEvent.teacherName\' | translate}}</th> <th md-column>{{\'timetable.timetableEvent.substitute\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="teacher in timetableEvent.teachers | orderBy: sortTeachers" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{currentLanguageNameField(teacher.teacher)}}</td> <td md-cell>{{teacher.isSubstitute ? (\'main.yes\' | translate) : (\'main.no\' | translate)}}</td> </tr> <tr md-row ng-if="timetableEvent.otherTeacher"> <td md-cell>{{timetableEvent.otherTeacher}}</td> <td md-cell>{{\'main.no\' | translate}}</td> </tr> </tbody> </table> </md-table-container> </fieldset> <br> <fieldset flex="60" flex-sm="100" flex-xs="100" ng-if="timetableEvent.rooms.length > 0"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'timetable.timetableEvent.rooms\' | translate}}</legend> <md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'timetable.timetableEvent.code\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="room in timetableEvent.rooms | orderBy: currentLanguageNameField()" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{room.nameEt}}</td> </tr> <tr md-row ng-if="timetableEvent.otherRoom"> <td md-cell>{{timetableEvent.otherRoom}}</td> </tr> </tbody> </table> </md-table-container> </fieldset> <br> <fieldset flex="60" flex-sm="100" flex-xs="100" ng-if="timetableEvent.studentGroups.length > 0"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'timetable.timetableEvent.studentGroups\' | translate}}</legend> <md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'timetable.timetableEvent.code\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="studentGroup in timetableEvent.studentGroups | orderBy: currentLanguageNameField()" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{studentGroup.nameEt}}</td> </tr> </tbody> </table> </md-table-container> </fieldset> <div layout="row" flex="100"> <md-button ng-href="#/lessonplans/events" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </div> </form> </div> </div>'),a.put("timetable/timetable.timetableManagement.copyTimetable.html",'<md-dialog aria-label="add enterprise dialog" flex="30"> <form name="dialogForm" ng-submit="dialogForm.$valid && submit()" novalidate ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2 flex>{{\'timetable.management.selectCopyTarget\' | translate}}</h2> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <span flex></span> <div class="ois-form-layout" layout="column" layout-margin ng-cloak> <div layout="column"> <div flex="100" flex-offset="2" flex-offset-xs="0" flex-offset-sm="0"> <div layout="row" flex="70"> <md-input-container flex="100" flex-sm="100" flex-xs="100"> <md-select ng-model="copyTarget" placeholder="{{\'timetable.management.period\' | translate}}"> <md-option ng-value="target" ng-repeat="target in copyTargets">{{ target.start | hoisDate }}-{{ target.end | hoisDate }}</md-option> </md-select> </md-input-container> </div> </div> </div> </div> </md-dialog-content> <md-dialog-actions layout="row" layout-align="start start"> <md-button class="md-raised md-primary" type="submit">{{\'main.button.save\' | translate}}</md-button> <md-button class="md-raised" ng-click="cancel()">{{"main.button.close" | translate}}</md-button> </md-dialog-actions> </form> </md-dialog>'),a.put("timetable/timetable.timetableManagement.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <form name="timetableSearchForm" ng-submit="loadData()" novalidate class="nomargin"> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="25" flex-sm="100" flex-xs="100"> <label>{{\'timetable.management.studyYear\' | translate}}</label> <hois-select ng-model="criteria.studyYear" values="formState.studyYears" required sorted-query="true"></hois-select> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'timetable.management.studyPeriod\' | translate}}</label> <hois-select ng-model="criteria.studyPeriod" values="formState.studyPeriods" required sorted-query="true"></hois-select> </md-input-container> <md-input-container required ng-if="higher && vocational" flex="45" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'timetable.management.type\' | translate}}</label> <hois-classifier-select ng-model="criteria.type" model-value-attr="code" default-value="TUNNIPLAAN_LIIK_V" filter-values hide-empty show-only-values="true" watch-model connect-main-classifier-code="TUNNIPLAAN_LIIK" main-classifier-code="TUNNIPLAAN_LIIK"></hois-classifier-select> </md-input-container> </div> <div layout="row"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button ng-if="criteria.type === \'TUNNIPLAAN_LIIK_H\' && canEdit" class="md-raised" ng-href="#/timetable/new?type={{criteria.type}}">{{\'main.button.create\' | translate}} </md-button> </div> <div flex-xs="0" flex-gt-xs="0" flex-gt-sm="50"></div> </form> </fieldset> </div> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="3, 4">{{\'timetable.management.period\' | translate}}</th> <th md-column md-order-by="2">{{\'timetable.management.status\' | translate}}</th> <th md-column></th> <th></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell ng-if="row.id"><a ng-href="#/timetable/{{::row.id}}/view">{{row.start | hoisDate}} - {{row.end | hoisDate}}</a></td> <td md-cell ng-if="!row.id">{{row.start | hoisDate}} - {{row.end | hoisDate}}</td> <td md-cell>{{currentLanguageNameField(row.status)}}</td> <td md-cell> <md-button ng-if="!row.id && canEdit" md-no-ink class="md-primary change-button" ng-click="createEvent(row)"> {{\'main.button.create\' | translate}} </md-button> <!--md-button ng-if="row.id && row.isHigher" md-no-ink class="md-primary change-button"\r\n                       ng-href="#/timetable/{{::row.id}}/edit">{{\'main.button.change\' | translate}}\r\n            </md-button--> <md-button ng-if="row.id && !row.isHigher" md-no-ink class="md-primary change-button" ng-href="#/timetable/{{::row.id}}/view">{{\'main.button.change\' | translate}} </md-button> <md-button ng-if="row.id && !row.isHigher" md-no-ink class="md-primary change-button" ng-click="copyTimetable(row.id)">{{\'main.button.copy\' | translate}} </md-button> <md-button ng-if="row.id && !row.isHigher" ng-href="{{excel(formState.xlsDiffUrl, {id: row.id})}}" target="_blank" class="md-primary change-button">{{\'timetable.management.difference\' | translate}} </md-button> <md-button ng-if="row.id && !row.isHigher" ng-href="{{excel(formState.xlsPlanUrl, {id: row.id})}}" target="_blank" class="md-primary change-button">{{\'timetable.management.plan\' | translate}} </md-button> <md-button ng-if="row.start" ng-click="exportTimetable(\'timetables/exportTimetable\',{startDate: row.start, endDate: row.end, studyPeriod: row.studyPeriod})" target="_blank" class="md-primary change-button">{{\'timetable.management.xmlExport\' | translate}} </md-button> <md-button ng-if="row.start" ng-click="openAddFileDialog(row.studyPeriod,{startDate: row.start, endDate: row.end, isHigher: row.isHigher})" target="_blank" class="md-primary change-button">{{\'timetable.management.xmlImport\' | translate}} </md-button> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> </div>'),a.put("timetable/timetable.view.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div> <form name="timetableForm" novalidate class="nomargin form-readonly" layout="column"> <div layout="row" class="form-readonly"> <md-input-container flex="30"> <label class="textInput">{{\'timetable.timetablePlan.timetablePeriod\' | translate}}</label> <hois-value value="(timetable.startDate | hoisDate) + \'-\'+(timetable.endDate | hoisDate)"> </md-input-container> </div> <div flex-xs="0" flex-gt-xs="0" flex-gt-sm="50"></div> <div id="tt" ng-repeat="curriculum in timetable.curriculums | orderBy: currentLanguageNameField()" layout="column" flex> <div class="hois-collapse-header even">{{currentLanguageNameField(curriculum)}}{{curriculum.curriculumCode}}, {{currentLanguageNameField(curriculum.curriculumStudyLevelCode)}}</div> <div flex> <md-grid-list ng-app="app" md-cols-xs="1" md-cols-sm="2" md-cols-md="4" md-cols-lg="8" md-cols-gt-lg="8" md-gutter="1em" md-row-height="40px" flex> <md-grid-tile ng-repeat="group in curriculum.groups | orderBy: code"> <!--md-button class="md-button" md-colors="{background: \'background-200\'}" ng-click="showTeacherWeek(row.teacherId)">\r\n                {{row.lastname}}, {{row.firstname}}\r\n              </md-button--> <span style="position: absolute; left: 0px"> <a ng-if="!timetable.higher" href="#/timetable/{{timetable.id}}/createVocationalPlan/{{group.id}}">{{group.code}}</a> <a ng-if="timetable.higher" href="#/timetable/{{timetable.id}}/createHigherPlan/group/{{group.id}}">{{group.code}}</a> </span> </md-grid-tile> </md-grid-list> </div> </div> <div ng-if="timetable.pairs"> <table md-table> <thead md-head> <tr md-row> <th md-column><label>{{\'timetable.subjectTeacherPairs\' | translate}}</label> </th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="pair in timetable.pairs | orderBy: [\'code\', currentLanguageNameField()]" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell><a href="#/timetable/{{timetable.id}}/createHigherPlan/pair/{{pair.id}}">{{pair.code}} {{currentLanguageNameField(pair)}} / {{pair.teacherNames}}</a></td> </tr> </tbody> </table> </div> </form> <md-button ng-if="timetable.editable && timetable.higher" md-no-ink class="md-primary change-button" ng-href="#/timetable/{{::timetable.id}}/edit">{{\'main.button.change\' | translate}} </md-button> <md-button ng-if="timetable.status === \'TUNNIPLAAN_STAATUS_S\' && canConfirm" ng-click="confirm()" class="md-raised">{{\'main.button.confirm\' | translate}} </md-button> <md-button ng-if="timetable.status === \'TUNNIPLAAN_STAATUS_K\'" ng-click="publicize()" class="md-raised">{{\'timetable.view.publicize\' | translate}} </md-button> <md-button ng-href="#/timetable/timetableManagement" class="md-raised">{{\'main.button.back\' | translate}} </md-button> </div> </div>'),a.put("vocationalCurriculum/vocational.curriculum.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <form name="vocationalCurriculumForm" layout="column"> <div layout="row" layout-sm="column" layout-xs="column"> <div layout="column" flex="30" flex-sm="100" flex-xs="100"> <fieldset tabindex="1"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'curriculum.draft\' | translate}} *</legend> <md-input-container flex="70" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <md-radio-group ng-model="curriculum.draft" name="draft" ng-change="draftSelected()" required class="md-primary" ng-disabled="curriculum.id || (curriculum.draft && (curriculum.draft === \'OPPEKAVA_LOOMISE_VIIS_RIIKLIK\' || curriculum.draft === \'OPPEKAVA_LOOMISE_VIIS_KOOL\') || curriculum.nameEt)"> <md-radio-button value="OPPEKAVA_LOOMISE_VIIS_KUTSE" aria-label="OPPEKAVA LOOMISE VIIS KUTSE">{{draftOptions["OPPEKAVA_LOOMISE_VIIS_KUTSE"][$root.currentLanguageNameField()]}}</md-radio-button> <md-radio-button value="OPPEKAVA_LOOMISE_VIIS_TOOANDJA" aria-label="OPPEKAVA LOOMISE VIIS TOOANDJA">{{draftOptions["OPPEKAVA_LOOMISE_VIIS_TOOANDJA"][$root.currentLanguageNameField()]}}</md-radio-button> <md-radio-button value="OPPEKAVA_LOOMISE_VIIS_KOOL" aria-label="OPPEKAVA LOOMISE VIIS KOOL">{{draftOptions["OPPEKAVA_LOOMISE_VIIS_KOOL"][$root.currentLanguageNameField()]}}</md-radio-button> <md-radio-button value="OPPEKAVA_LOOMISE_VIIS_RIIKLIK" aria-label="OPPEKAVA LOOMISE VIIS RIIKLIK">{{draftOptions["OPPEKAVA_LOOMISE_VIIS_RIIKLIK"][$root.currentLanguageNameField()]}}</md-radio-button> </md-radio-group> <p class="invalid" ng-if="vocationalCurriculumForm.$submitted && !curriculum.draft">{{\'main.messages.error.inputFieldIsRequired\' | translate}}</p> </md-input-container> </fieldset> <div>&nbsp;</div> <fieldset tabindex="2" layout="column"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'curriculum.nameTitle\' | translate}}</legend> <div layout="column"> <md-input-container> <label>{{\'curriculum.nameEt\' | translate}}</label> <input name="nameEt" ng-model="curriculum.nameEt" type="text" required ng-readonly="formState.notEditableBasicData" md-maxlength="255"> </md-input-container> <md-input-container> <label>{{\'curriculum.nameEn\' | translate}}</label> <input ng-model="curriculum.nameEn" type="text" required ng-readonly="formState.notEditableBasicData" md-maxlength="255"> </md-input-container> <md-input-container> <label>{{\'curriculum.nameRu\' | translate}}</label> <input ng-model="curriculum.nameRu" type="text" ng-readonly="formState.notEditableBasicData" md-maxlength="255"> </md-input-container> </div> </fieldset> </div> <fieldset tabindex="3" flex="66" flex-offset="4" flex-sm="100" flex-xs="100" flex-offset-xs="0" flex-offset-sm="0"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'curriculum.mainData\' | translate}}</legend> <div layout="row" flex> <md-input-container layout="row" flex="45"> <hois-classifier-radio layout="row" name="consecution" ng-model="curriculum.consecution" model-value-attr="code" main-classifier-code="OPPEKAVA_TYPE" filter-values watch-model="curriculum.origStudyLevel" connect-main-classifier-code="OPPEASTE" search-from-connect select-first-value default-value="OPPEKAVA_TYPE_E" required disabled></hois-classifier-radio> </md-input-container> <div md-colors="{color: \'warn-A400\'}" ng-if="vocationalCurriculumForm.$submitted" ng-messages="vocationalCurriculumForm.consecution.$error"> <div ng-message="required">{{\'main.messages.error.inputFieldIsRequired\' | translate}}</div> </div> <md-input-container flex="50" flex-offset="5"> <label>{{\'curriculum.code\' | translate}}</label> <input ng-model="curriculum.code" name="code" type="text" required ng-readonly="formState.notEditableBasicData" md-maxlength="25" unique="codeUniqueQuery" ng-model-options="{ debounce: 250 }"> <div ng-messages="vocationalCurriculumForm.code.$error" ng-show="vocationalCurriculumForm.code.$dirty"> <div ng-message="notUnique"> {{\'main.messages.error.mustBeUnique\' | translate}} </div> </div> </md-input-container> </div> <div layout="row" flex> <div flex="45"> <md-checkbox ng-model="curriculum.joint" aria-label="Is vocational" class="md-primary" ng-disabled="formState.notEditableBasicData"> {{\'curriculum.isJoint\' | translate}} </md-checkbox> </div> <md-input-container flex="50" flex-offset="5"> <label>{{\'curriculum.merCode\' | translate}}</label> <input ng-model="curriculum.merCode" name="merCode" type="text" ng-model-options="{ debounce: 250 }" unique="merCodeUniqueQuery" ng-readonly="formState.notEditableBasicData" md-maxlength="10"> <div ng-messages="vocationalCurriculumForm.merCode.$error" ng-show="vocationalCurriculumForm.merCode.$dirty"> <div ng-message="notUnique"> {{\'main.messages.error.mustBeUnique\' | translate}} </div> </div> </md-input-container> </div> <!-- uus --> <div layout="row" flex> <div flex="45"> <md-checkbox ng-model="curriculum.occupation" ng-click="isOccupationChanged()" aria-label="Is vocational" ng-hide="isDraftEmployerSupportLetter" ng-disabled="formState.notEditableBasicData || !occupationCanBeChanged() || curriculum.curriculumOccupations.length > 0" name="isOccupation"> {{\'curriculum.occupationIsAcquired\' | translate}} </md-checkbox> </div> <md-input-container flex="50" flex-offset="5"> <label>{{\'curriculum.credits\' | translate}}</label> <input ng-model="curriculum.credits" name="credits" type="number" min="0" max="999" pattern="^\\d+(\\.\\d{1})?$" required ng-readonly="formState.notEditableBasicData"> <div ng-messages="vocationalCurriculumForm.credits.$error" ng-show="vocationalCurriculumForm.credits.$dirty"> <div ng-message="min"> {{\'main.messages.error.positive\' | translate}} </div> <div ng-message="max"> {{\'curriculum.error.max999\' | translate}} </div> <div ng-message="pattern"> {{\'stateCurriculum.error.decimalPresision\' | translate}} </div> </div> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="45"> <label>{{\'curriculum.studyLevel\' | translate}}</label> <hois-classifier-select ng-model="curriculum.origStudyLevel" model-value-attr="code" main-classifier-code="OPPEASTE" show-only-values="schoolOrigStudyLevel" required ng-disabled="formState.notEditableBasicData"></hois-classifier-select> </md-input-container> <div layout="row" flex="50" flex-offset="5"> <md-input-container flex="50"> <input ng-model="curriculum.studyPeriodYears" name="studyPeriodYears" type="number" placeholder="{{\'curriculum.studyPeriod\' | translate}} {{\'main.years\' | translate}}" required min="0" max="{{maxStydyYears.max}}" pattern="^\\d+$" ng-readonly="formState.notEditableBasicData"> <div ng-messages="vocationalCurriculumForm.studyPeriodYears.$error" ng-show="vocationalCurriculumForm.studyPeriodYears.$dirty"> <div ng-message="min"> {{\'main.messages.error.positive\' | translate}} </div> <div ng-message="max"> {{\'curriculum.error.max\' | translate:maxStydyYears }} </div> <div ng-message="pattern"> {{\'stateCurriculum.enter.credits.integer\' | translate}} </div> </div> </md-input-container> <md-input-container flex="45" flex-offset="5"> <input ng-model="curriculum.studyPeriodMonths" name="studyPeriodMonths" type="number" placeholder="{{\'main.months\' | translate}}" min="0" max="11" pattern="^\\d+$" ng-readonly="formState.notEditableBasicData"> <div ng-messages="vocationalCurriculumForm.studyPeriodMonths.$error" ng-show="vocationalCurriculumForm.studyPeriodMonths.$dirty"> <div ng-message="min"> {{\'main.messages.error.positive\' | translate}} </div> <div ng-message="max"> {{\'curriculum.error.monthsMax11\' | translate}} </div> <div ng-message="pattern"> {{\'stateCurriculum.enter.credits.integer\' | translate}} </div> </div> </md-input-container> </div> </div> <div layout="row" flex> <md-input-container flex="45"> <label>{{\'curriculum.ekrLevel\' | translate}}</label> <hois-classifier-select ng-model="curriculum.ekrLevel" main-classifier-code="EKR" watch-model="curriculum.origStudyLevel" filter-values connect-main-classifier-code="EKR" select-first-value disabled></hois-classifier-select> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label>{{\'curriculum.studyForm\' | translate}}</label> <hois-classifier-select multiple ng-model="curriculum.studyForms" model-value-attr="code" ignore-preselected only-valid main-classifier-code="OPPEVORM" criteria="{vocational: true}" required ng-disabled="formState.notEditableBasicData"></hois-classifier-select> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="45"> <label>{{\'curriculum.educationLevel\' | translate}}</label> <hois-classifier-select ng-model="curriculum.educationLevel" main-classifier-code="HARIDUSTASE" watch-model="curriculum.origStudyLevel" filter-values connect-main-classifier-code="HARIDUSTASE" select-first-value disabled></hois-classifier-select> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label>{{\'curriculum.studyLanguage\' | translate}}</label> <hois-classifier-select multiple ng-model="curriculum.studyLanguages" model-value-attr="code" ignore-preselected only-valid main-classifier-code="OPPEKEEL" criteria="{vocational: true}" required ng-disabled="formState.notEditableBasicData"></hois-classifier-select> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="45"> <label>{{\'curriculum.areaOfStudy\' | translate}}</label> <hois-classifier-select ng-model="curriculum.areaOfStudy" model-value-attr="code" main-classifier-code="ISCED_VALD" criteria="{vocational: true}" required ng-disabled="formState.notEditableBasicData"></hois-classifier-select> </md-input-container> <!-- hois-school-department-select was not used here as it set form $dirty after page load.\r\n          In addition, extra logic in providing options required --> <md-input-container flex="50" flex-offset="5"> <label> {{\'curriculum.structuralUnitResponsible\' | translate}} </label> <hois-select ng-model="curriculum.schoolDepartments" multiple values="schoolDepartments" required></hois-select> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="45"> <label>{{\'curriculum.fieldOfStudy\' | translate}}</label> <hois-classifier-select ng-model="curriculum.fieldOfStudy" model-value-attr="code" main-classifier-code="ISCED_SUUN" criteria="{vocational: true}" watch-model="curriculum.areaOfStudy" filter-values search-from-connect connect-main-classifier-code="ISCED_VALD" required ng-disabled="formState.notEditableBasicData"></hois-classifier-select> </md-input-container> <md-input-container flex="50" flex-offset="5" ng-show="curriculum.draft === \'OPPEKAVA_LOOMISE_VIIS_RIIKLIK\'"> <label>{{\'curriculum.ehisRokClassifier\' | translate}}</label> <hois-classifier-select ng-model="curriculum.stateCurrClass" model-value-attr="code" main-classifier-code="EHIS_ROK" disabled></hois-classifier-select> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="45"> <label>{{\'curriculum.group\' | translate}}</label> <hois-classifier-select ng-model="curriculum.iscedClass" model-value-attr="code" main-classifier-code="ISCED_RYHM" criteria="{vocational: true}" watch-model="curriculum.fieldOfStudy" filter-values search-from-connect connect-main-classifier-code="ISCED_SUUN" required ng-disabled="formState.notEditableBasicData"></hois-classifier-select> </md-input-container> </div> </fieldset> </div> <div>&nbsp;</div> <fieldset tabindex="4"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'curriculum.commonData\' | translate}}</legend> <div layout="column"> <md-input-container flex> <label>{{\'curriculum.studyOutcomesEt\' | translate}}{{getStar()}}</label> <textarea ng-model="curriculum.outcomesEt" md-maxlength="20000" max-rows="10" dfs ng-required="strictValidation()"></textarea> </md-input-container> <md-input-container flex> <label>{{\'curriculum.studyOutcomesEn\' | translate}}</label> <textarea ng-model="curriculum.outcomesEn" md-maxlength="20000" max-rows="10"></textarea> </md-input-container> <md-input-container flex> <label>{{\'curriculum.structure\' | translate}}{{getStar()}}</label> <textarea ng-model="curriculum.structure" md-maxlength="20000" max-rows="10" ng-required="strictValidation()"></textarea> </md-input-container> <md-input-container flex> <label>{{\'curriculum.admissionRequirementsEt\' | translate}}{{getStar()}}</label> <textarea ng-model="curriculum.admissionRequirementsEt" md-maxlength="20000" max-rows="10" ng-required="strictValidation()"></textarea> </md-input-container> <md-input-container flex> <label>{{\'curriculum.admissionRequirementsEn\' | translate}}</label> <textarea ng-model="curriculum.admissionRequirementsEn" md-maxlength="20000" max-rows="10"></textarea> </md-input-container> <md-input-container flex> <label>{{\'curriculum.graduationRequirementsEt\' | translate}}{{getStar()}}</label> <textarea ng-model="curriculum.graduationRequirementsEt" md-maxlength="20000" max-rows="10" ng-required="strictValidation()"></textarea> </md-input-container> <md-input-container flex> <label>{{\'curriculum.graduationRequirementsEn\' | translate}}</label> <textarea ng-model="curriculum.graduationRequirementsEn" md-maxlength="20000" max-rows="10"></textarea> </md-input-container> <md-input-container flex> <label>{{\'curriculum.basesOfDraft\' | translate}}</label> <textarea ng-model="curriculum.draftText" md-maxlength="4000" max-rows="10"></textarea> </md-input-container> <md-input-container flex> <label>{{\'curriculum.specialityOpportunities\' | translate}}</label> <textarea ng-model="curriculum.specialization" md-maxlength="4000" max-rows="10"></textarea> </md-input-container> <md-autocomplete name="teacher" md-selected-item="curriculum.teacher" md-search-text="teacherName" md-items="teacher in searchTeacher(teacherName)" md-item-text="currentLanguageNameField(teacher)" md-min-length="1" md-floating-label="{{\'curriculum.supervisor\' | translate}}" md-no-cache class="small-margin" md-require-match flex> <md-item-template> <span md-highlight-text="teacherName" md-highlight-flags="^i">{{currentLanguageNameField(teacher)}}</span> </md-item-template> <md-not-found> {{\'main.messages.error.notFound\' | translate}} </md-not-found> </md-autocomplete> </div> </fieldset> <div>&nbsp;</div> <fieldset tabindex="5" ng-hide="isDraftEmployerSupportLetter"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small" ng-class="{invalid: vocationalCurriculumForm.$submitted && occupationRequired() && strictValidation() && curriculum.curriculumOccupations.length === 0}">{{curriculum.occupation ? \'curriculum.occupationsAcquired\' : \'curriculum.partOccupationsAcquired\' | translate}}</legend> <md-button class="md-raised" ng-click="curriculum.occupation ? openOccupationDialog() : openPartOccupationsDialog()" ng-if="curriculum.id && !formState.notEditableBasicData">{{curriculum.occupation ? \'curriculum.addOccupation\' : \'curriculum.addPartOccupation\' | translate}}</md-button> <div layout="column"> <div ng-if="vocationalCurriculumForm.$submitted && occupationRequired() && strictValidation()"> <input style="display:none" type="number" readonly name="occupationsLength" ng-model="validation.occupationsLength" min="1"> <div md-colors="{color: \'warn-A400\'}" ng-messages="vocationalCurriculumForm.occupationsLength.$error"> <div ng-message="min">{{\'main.messages.error.atLeastOneShouldBeAdded\' | translate}}</div> </div> </div> </div> <md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'curriculum.occupationTable.order\' | translate}}</th> <th md-column ng-show="curriculum.occupation">{{\'curriculum.occupationTable.occupation\' | translate}}</th> <th md-column ng-show="!curriculum.occupation">{{\'curriculum.occupationTable.partOccupation\' | translate}}</th> <th md-column ng-show="curriculum.occupation">{{\'curriculum.occupationTable.partOccupations\' | translate}}</th> <th md-column ng-show="curriculum.occupation">{{\'curriculum.occupationTable.speciality\' | translate}}</th> <th md-column ng-show="curriculum.occupation">{{\'occupation.hasOccupationGrant\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="item in curriculum.curriculumOccupations | orderBy: [\'occupation\', \'-occupation.validThru\', \'-occupation.validFrom\']:false:compareUsingLanguage" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{$index + 1}}</td> <td md-cell> <a href="" ng-click="curriculum.occupation ? openOccupationDialog(item) : openPartOccupationsDialog(item)">{{item.occupation | hoisValidDates }}</a> </td> <td md-cell><span ng-hide="!curriculum.occupation" ng-repeat="partOccupation in item.partOccupations">{{currentLanguageNameField(partOccupation)}}{{$last ? \'\' : \', \'}}</span></td> <td md-cell><span ng-hide="!curriculum.occupation || !item.specialities || item.specialities.length == 0" ng-repeat="speciality in item.specialities track by $index"> {{currentLanguageNameField(speciality)}}{{$last ? \'\' : \', \'}}</span></td> <td md-cell><span ng-hide="!curriculum.occupation"> <md-checkbox ng-model="item.occupationGrant" disabled></md-checkbox> </span></td> <td md-cell><a class="remove" ng-click="removeOccupation(item)" ng-if="!formState.notEditableBasicData">&times;</a></td> </tr> </tbody> </table> </md-table-container> </fieldset> <div>&nbsp;</div> <fieldset tabindex="6"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small" ng-class="{invalid: vocationalCurriculumForm.$submitted && strictValidation() && !modulesValid()}">{{\'curriculum.modulesTought\' | translate}}</legend> <md-button class="md-raised" ng-click="openAddModuleDialog()" ng-if="curriculum.id">{{\'curriculum.addModule\' | translate}}</md-button> <!--MODULES WITHOUT OCCUPATIONS--> <div class="occupation-header align-center"> <span ng-class="{invalid: notAllModulesHaveOccupation()}">{{\'module.modulesWithoutPartOccupationOccuaptionSpecialization\' | translate}}</span> </div> <div layout="column" ng-repeat="type in moduleTypes | filter: filterTypesWithoutEmptyModules" class="lowerBorder"> <div layout="row" flex="100" class="occupation-row align-center border-bottom odd"> <div flex="5">&nbsp;</div> <div flex="20" flex-xs="35" style="word-wrap: break-word">{{currentLanguageNameField(type)}} ({{getTotalCredits(curriculum.modules | filter: filterEmptyModulesByType(type.code))}} EKAP)</div> <div layout="column" flex="75" flex-xs="60"> <div flex="100" ng-repeat="module in curriculum.modules | filter: filterEmptyModulesByType(type.code) | orderBy: \'nameEt\' track by $index" layout="row" class="align-center"> <a flex="30" flex-xs="70" style="word-wrap: break-word" ng-click="openAddModuleDialog(module)" href="">{{module.baseModule ? \'* \' : \'\'}}{{currentLanguageNameField(module)}}</a> <span flex="10" flex-xs="30">{{module.credits}}&nbsp; EKAP</span> </div> </div> </div> </div> <!--KUTSETE/OSAKUTSETE MOODULID--> <div ng-repeat="occupation in curriculum.curriculumOccupations | orderBy: [\'occupation\', \'-occupation.validThru\', \'-occupation.validFrom\']:false:compareUsingLanguage" layout="column"> <div class="occupation-header align-center"> <span ng-show="curriculum.occupation" ng-class="{invalid: vocationalCurriculumForm.$submitted && strictValidation() && (!occupationHasPModule(occupation.occupation.code) || !isOccutationsCreditsValid(occupation))}"> {{\'stateCurriculum.enter.occupation.occupation\' | translate}} {{$index + 1}}:&nbsp; {{occupation.occupation | hoisValidDates }} </span> <span ng-show="!curriculum.occupation" ng-class="{invalid: vocationalCurriculumForm.$submitted && strictValidation() && (!occupationHasPModule(occupation.occupation.code) || !isOccutationsCreditsValid(occupation))}"> {{\'stateCurriculum.enter.occupation.partial\' | translate}} {{$index + 1}}:&nbsp; {{occupation.occupation | hoisValidDates }} </span> </div> <div layout="column" ng-repeat="type in moduleTypes | filter: filterTypesWithoutModules(occupation.occupation.code, curriculum.modules)" class="lowerBorder"> <div layout="row" flex="100" class="occupation-row align-center border-bottom odd"> <div flex="5">&nbsp;</div> <div flex="20" style="word-wrap: break-word">{{currentLanguageNameField(type)}} ({{getTotalCredits(curriculum.modules | filter: filterModulesByType(type.code, occupation.occupation.code))}} EKAP)</div> <div layout="column" flex="75"> <div flex="100" ng-repeat="module in curriculum.modules | filter: filterModulesByType(type.code, occupation.occupation.code) | orderBy: \'nameEt\' track by $index" layout="row" class="align-center"> <a flex="30" style="word-wrap: break-word" ng-click="openAddModuleDialog(module)" href="">{{module.baseModule ? \'* \' : \'\'}}{{currentLanguageNameField(module)}}</a> <span flex="10">{{module.credits}}&nbsp; EKAP</span> </div> </div> </div> </div> <!--OSAKUTSETE MOODULID--> <div ng-repeat="partOccupation in occupation.partOccupations | orderBy: [partOccupation, \'-validThru\', \'-validFrom\']:false:compareUsingLanguage" layout="column"> <div class="occupation-header2 align-center"> <span ng-class="{invalid: vocationalCurriculumForm.$submitted && strictValidation() && !occupationHasPModule(partOccupation.code)}"> {{\'stateCurriculum.enter.occupation.partial\' | translate}} {{$index + 1}}: {{partOccupation | hoisValidDates }} </span> </div> <div layout="column" ng-repeat="type in moduleTypes | filter: filterTypesWithoutModules(partOccupation.code, curriculum.modules)" class="lowerBorder"> <div layout="row" flex="100" class="occupation-row align-center border-bottom odd"> <div flex="5">&nbsp;</div> <div flex="20" style="word-wrap: break-word">{{currentLanguageNameField(type)}} ({{getTotalCredits(curriculum.modules | filter: filterModulesByType(type.code, partOccupation.code))}} EKAP)</div> <div layout="column" flex="75"> <div flex="100" ng-repeat="module in curriculum.modules | filter: filterModulesByType(type.code, partOccupation.code) | orderBy: \'nameEt\' track by $index" layout="row" class="align-center"> <a flex="30" style="word-wrap: break-word" ng-click="openAddModuleDialog(module)" href="">{{module.baseModule ? \'* \' : \'\'}}{{currentLanguageNameField(module)}}</a> <span flex="10">{{module.credits}}&nbsp; EKAP</span> </div> </div> </div> </div> </div> <!--SPETSKUTSETE MOODULID--> <div ng-repeat="speciality in occupation.specialities | orderBy: [speciality, \'-validThru\', \'-validFrom\']:false:compareUsingLanguage" layout="column"> <div class="occupation-header2 align-center"> <span ng-class="{invalid: vocationalCurriculumForm.$submitted && strictValidation() && (!occupationHasPModule(speciality.code) || !isSpetsOccupationValid(speciality, occupation))}"> {{\'stateCurriculum.enter.occupation.specialty\' | translate}} {{$index + 1}}: {{speciality | hoisValidDates }} </span> </div> <div layout="column" ng-repeat="type in moduleTypes | filter: filterTypesWithoutModules(speciality.code, curriculum.modules)" class="lowerBorder"> <div layout="row" flex="100" class="occupation-row align-center border-bottom odd"> <div flex="5">&nbsp;</div> <div flex="20" style="word-wrap: break-word">{{currentLanguageNameField(type)}} ({{getTotalCredits(curriculum.modules | filter: filterModulesByType(type.code, speciality.code))}} EKAP)</div> <div layout="column" flex="75"> <div flex="100" ng-repeat="module in curriculum.modules | filter: filterModulesByType(type.code, speciality.code) | orderBy: \'nameEt\' track by $index" layout="row" class="align-center"> <a flex="30" style="word-wrap: break-word" ng-click="openAddModuleDialog(module)" href="">{{module.baseModule ? \'* \' : \'\'}}{{currentLanguageNameField(module)}}</a> <span flex="10">{{module.credits}}&nbsp; EKAP</span> </div> </div> </div> </div> </div> </div> </fieldset> <div>&nbsp;</div> <fieldset tabindex="7"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'curriculum.additionalInfo\' | translate}}</legend> <md-input-container> <label>{{\'curriculum.optionalStudyCredits\' | translate}}{{getStar()}}</label> <input name="vocationalCredits" type="number" ng-model="curriculum.optionalStudyCredits" ng-required="strictValidation()" aria-label="optional credits" min="0" max="999" pattern="^\\d+(\\.\\d{1})?$" ng-readonly="formState.notEditableBasicData"> <div ng-messages="vocationalCurriculumForm.vocationalCredits.$error" ng-show="vocationalCurriculumForm.vocationalCredits.$dirty"> <div ng-message="min"> {{\'main.messages.error.positive\' | translate}} </div> <div ng-message="max"> {{\'curriculum.error.max999\' | translate}} </div> <div ng-message="pattern"> {{\'stateCurriculum.error.decimalPresision\' | translate}} </div> </div> </md-input-container> <div layout="column"> <md-input-container flex> <label>{{\'curriculum.practiceDescription\' | translate}}</label> <textarea ng-model="curriculum.practiceDescription" md-maxlength="20000" max-rows="2"></textarea> </md-input-container> <md-input-container flex> <label>{{\'curriculum.finalExamShortDescription\' | translate}}</label> <textarea ng-model="curriculum.finalExamDescription" md-maxlength="4000" max-rows="2"></textarea> </md-input-container> <md-input-container flex> <label>{{\'curriculum.optionalStudyOpportunities\' | translate}}</label> <textarea ng-model="curriculum.optionalStudyDescription" md-maxlength="4000" max-rows="2"></textarea> </md-input-container> <md-input-container flex> <label>{{\'curriculum.contactPerson\' | translate}}</label> <input ng-model="curriculum.contactPerson" type="text" md-maxlength="1000"> </md-input-container> <md-input-container flex> <label>{{\'main.notes\' | translate}}</label> <textarea ng-model="curriculum.description" md-maxlength="20000" max-rows="2"></textarea> </md-input-container> </div> </fieldset> <div ng-show="curriculum.joint">&nbsp;</div> <fieldset tabindex="8" ng-show="curriculum.joint"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'curriculum.jointInfo\' | translate}}</legend> <div layout="column"> <div layout="row" layout-align="start start" ng-show="curriculum.joint"> <label class="md-required common-label" flex="30">{{\'curriculum.jointSchool\' | translate}}</label> <md-radio-group ng-model="curriculum.abroad" flex="50" layout="row" class="align-center" ng-change="clearJointPartnersFields()" flex-offset-xs="0" flex-offset-sm="0" flex-offset="4" ng-disabled="formState.notEditableBasicData"> <md-radio-button ng-value="false" aria-label="{{ \'curriculum.estonianEducationalInstitute\' | translate }}"> {{ \'curriculum.estonianEducationalInstitute\' | translate }} </md-radio-button> <md-radio-button ng-value="true" aria-label="{{ \'curriculum.jointPartnerAbroadSchool\' | translate }}"> {{ \'curriculum.foreignEducationalInstitute\' | translate }} </md-radio-button> </md-radio-group> </div> <div layout="row" flex="100" ng-show="curriculum.joint"> <md-input-container flex="64" ng-hide="curriculum.abroad"> <label>{{\'curriculum.estonianEducationalInstitute\' | translate}}&nbsp;*</label> <hois-classifier-select ng-model="curriculum.jointPartnerEhisSchool" main-classifier-code="EHIS_KOOL" filter-values="curriculum.jointPartners" by-property="ehisSchool" model-value-attr="code" ng-disabled="formState.notEditableBasicData"></hois-classifier-select> </md-input-container> <md-input-container ng-hide="!curriculum.abroad" flex="30"> <label>{{\'school.name\' | translate}}&nbsp;*</label> <input ng-model="curriculum.jointPartnerForeignNameEt" type="text" md-maxlength="100"> </md-input-container> <md-input-container ng-hide="!curriculum.abroad" flex="30" flex-offset-xs="0" flex-offset-sm="0" flex-offset="4"> <label>{{\'school.nameEn\' | translate}}&nbsp;*</label> <input ng-model="curriculum.jointPartnerForeignNameEn" type="text" md-maxlength="100"> </md-input-container> <md-button class="md-raised" ng-click="addJointPartner()" ng-disabled="(!curriculum.jointPartnerForeignNameEt || !curriculum.jointPartnerForeignNameEn) && !curriculum.jointPartnerEhisSchool">{{\'main.button.add\' | translate}}</md-button> </div> <input ng-if="curriculum.joint && strictValidation()" style="display:none" type="number" readonly name="jointPartnersLength" ng-model="validation.jointPartnersLength" min="1"> <div md-colors="{color: \'warn-A400\'}" ng-messages="vocationalCurriculumForm.jointPartnersLength.$error"> <div ng-if="vocationalCurriculumForm.$submitted" ng-message="min">{{\'main.messages.error.atLeastOneShouldBeAdded\' | translate}}</div> </div> <div layout="column" flex ng-show="curriculum.joint" class="common-label"> <div layout="row" ng-repeat="item in curriculum.jointPartners | filter: filterEmptyJointPartners | orderBy: [\'ehisSchool\', \'nameEt\']" class="align-center"> <div flex="5">&nbsp;</div> <div ng-if="item.abroad">{{currentLanguageNameField(item)}}</div> <div ng-if="!item.abroad"> <hois-classifier-value ng-model="item.ehisSchool" main-classifier-code="EHIS_KOOL"></hois-classifier-value></div> <div flex="5">&nbsp;</div> <div flex="5"><a class="remove nomargin" ng-click="removejointPartner(item)" ng-if="!formState.notEditableBasicData">&times;</a></div> </div> </div> <div layout="row" layout-sm="column" layout-xs="column" ng-show="curriculum.joint"> <md-input-container flex="30" ng-if="curriculum.joint"> <label>{{\'curriculum.jointMentor\' | translate}}{{getStar()}}</label> <hois-classifier-select ng-model="curriculum.jointMentor" main-classifier-code="EHIS_KOOL" model-value-attr="code" show-only-values="selectedJointPartners" ng-required="strictValidation()" ng-disabled="formState.notEditableBasicData"></hois-classifier-select> </md-input-container> <md-input-container flex="66" flex-offset="4"> <label>{{\'curriculum.jointResponsible\' | translate}}</label> <input ng-model="curriculum.supervisor" type="text" md-maxlength="100" ng-readonly="formState.notEditableBasicData"> </md-input-container> </div> <md-input-container flex="100"> <label>{{\'curriculum.jointAgreementInfoEt\' | translate}}{{getStar()}}</label> <textarea ng-model="curriculum.contractEt" md-maxlength="1000" max-rows="10" ng-required="curriculum.joint && strictValidation()" ng-readonly="formState.notEditableBasicData"></textarea> </md-input-container> <md-input-container flex="100"> <label>{{\'curriculum.jointAgreementInfoEn\' | translate}}{{getStar()}}</label> <textarea ng-model="curriculum.contractEn" md-maxlength="1000" max-rows="10" ng-required="curriculum.joint && strictValidation()" ng-readonly="formState.notEditableBasicData"></textarea> </md-input-container> </div> </fieldset> <div>&nbsp;</div> <fieldset tabindex="9"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'curriculum.address\' | translate}}</legend> <div layout="column"> <div layout="row"> <div flex> <hois-ads-adapter class="md-text" ng-model="formState.address.addressAds" ads-oid-model="formState.address.addressOid" address-model="formState.address.address" ov-model="formState.address.addressOv"></hois-ads-adapter> </div> <md-button class="md-raised" ng-click="addAddress()" ng-disabled="!formState.address.addressOv">{{\'main.button.add\' | translate}}</md-button> </div> <input ng-if="strictValidation()" style="display:none" type="number" readonly name="addressesLength" ng-model="validation.addressesLength" min="1"> <div md-colors="{color: \'warn-A400\'}" ng-messages="vocationalCurriculumForm.addressesLength.$error"> <div ng-if="vocationalCurriculumForm.$submitted" ng-message="min">{{\'main.messages.error.atLeastOneShouldBeAdded\' | translate}}</div> </div> <div layout="column" flex class="common-label"> <div layout="row" ng-repeat="item in curriculum.addresses | orderBy: \'address\'" class="align-center"> <div flex="5">&nbsp;</div> <div>{{::item.address}}</div> <div flex="5">&nbsp;</div> <div flex="5"><a class="remove nomargin" ng-click="removeAddress(item)">&times;</a></div> </div> </div> </div> </fieldset> <div>&nbsp;</div> <fieldset tabindex="10"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'curriculum.approvalInfo\' | translate}}</legend> <div layout="row" flex="100"> <md-input-container flex="30" flex-sm="100" flex-xs="100"> <label>{{\'curriculum.approvalDocumentNr\' | translate}}{{getStar()}}</label> <input ng-model="curriculum.approvalDokNr" type="text" md-maxlength="50" ng-required="strictValidation()"> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-xs="100" flex-offset-xs="0" flex-offset-sm="0" flex-offset="4"> <label>{{\'curriculum.approvalDate\' | translate}}{{getStar()}}</label> <md-datepicker ng-model="curriculum.approval" md-open-on-focus ng-required="strictValidation()"></md-datepicker> </md-input-container> </div> </fieldset> <div>&nbsp;</div> <fieldset tabindex="11"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'curriculum.statuses\' | translate}}</legend> <div layout="row" flex="100"> <md-input-container flex="30" flex-sm="100" flex-xs="100"> <label>{{\'main.validFrom\' | translate}}{{getStar()}}</label> <md-datepicker ng-model="curriculum.validFrom" md-open-on-focus ng-required="strictValidation()"></md-datepicker> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-xs="100" flex-offset-xs="0" flex-offset-sm="0" flex-offset="4"> <label>{{\'main.validTo\' | translate}}</label> <md-datepicker ng-model="curriculum.validThru" md-min-date="curriculum.validFrom" md-open-on-focus></md-datepicker> </md-input-container> </div> <div layout="row" flex="100" class="top-margin form-readonly"> <md-input-container flex="30" flex-sm="100" flex-xs="100" class="readonly"> <label class="label">{{\'main.status\' | translate}}</label> <hois-classifier-value ng-model="curriculum.status" main-classifier-code="OPPEKAVA_STAATUS"></hois-classifier-value> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-xs="100" flex-offset-xs="0" flex-offset-sm="0" flex-offset="4"> <label>{{\'curriculum.statusInEhis\' | translate}}</label> <hois-classifier-value ng-model="curriculum.ehisStatus" main-classifier-code="OPPEKAVA_EHIS_STAATUS"></hois-classifier-value> </md-input-container> <md-input-container flex="40" flex-sm="100" flex-xs="100" flex-offset-xs="0" flex-offset-sm="0" flex-offset="5"> <label>{{\'curriculum.statusChangedDateInEhis\' | translate}}</label> <hois-value value="curriculum.ehisChanged | hoisDate"></hois-value> </md-input-container> </div> <div layout="row" flex="100" class="md-body-1 hois-value"> <a ng-show="!!curriculum.stateCurriculum" ng-href="/#/stateCurriculum/{{curriculum.stateCurriculum.id}}/view" class="md-primary" translate="curriculum.referenceToStateCurriculum" translate-values="{{curriculum.stateCurriculum}}"></a> </div> </fieldset> <div ng-if="curriculum.id">&nbsp;</div> <fieldset tabindex="12" ng-if="curriculum.id"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small" ng-class="{invalid: vocationalCurriculumForm.$submitted && strictValidation() && !hasRequiredFiles()}">{{\'main.relatedFiles\' | translate}}</legend> <md-button class="md-raised" ng-click="openAddFileDialog()">{{\'main.button.uploadFile\' | translate}}</md-button> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column><span>{{\'file.nameAndFile\' | translate}}</span></th> <th md-column><span>{{\'file.creationLocation\' | translate}}</span></th> <th md-column>{{\'file.type\' | translate}}</th> <th md-column>{{\'curriculum.sendToEhis\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="file in curriculum.files | orderBy: \'oisFile.fname\'" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell> {{file.oisFile.fname}} <a ng-href="{{getUrl(file, \'curriculum\')}}" download><md-icon md-font-set="material-icons">file_download</md-icon></a> </td> <td md-cell> {{file.ehis ? \'EHIS\' : \'ÕIS\'}} </td> <td md-cell> <hois-classifier-value ng-model="file.ehisFile" main-classifier-code="EHIS_FAIL"></hois-classifier-value> </td> <td md-cell> <md-checkbox ng-model="file.sendEhis" aria-label="send to ehis"></md-checkbox> </td> <td md-cell> <a class="remove nomargin" ng-click="deleteFile(file)">&times;</a> </td> </tr> </tbody> </table> </fieldset> <div>&nbsp;</div> <fieldset tabindex="13" ng-if="curriculum.id > 0"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small" ng-class="{invalid: vocationalCurriculumForm.$submitted && strictValidation() && !hasVerifiedVersions()}">{{\'curriculum.moduleImplementationPlans\' | translate}}</legend> <md-button class="md-raised" ng-click="goToVersionNewForm()" ng-show="versionCanBeAdded()">{{\'main.button.create\' | translate}}</md-button> <md-table-container> <table md-table md-progress="promise" class="secondary-table"> <thead md-head md-order="query.order"> <tr md-row> <th md-column>{{\'module.implementationPlan.code\' | translate}}</th> <th md-column>{{\'main.status\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="moduleImplementationPlan in curriculum.versions | orderBy: \'code\'"> <td md-cell> <a href="" class="md-primary" ng-click="goToImplementationPlanForm(moduleImplementationPlan)">{{moduleImplementationPlan.code}}</a> </td> <td md-cell><hois-classifier-value ng-model="moduleImplementationPlan.status" main-classifier-code="OPPEKAVA_VERSIOON_STAATUS"></hois-classifier-value></td> </tr> </tbody> </table> </md-table-container> </fieldset> <hois-created-modified object="curriculum"></hois-created-modified> <div> </div> </form> <div layout="row"> <div flex layout-xs="column"> <span ng-show="curriculum.status === STATUS.ENTERING" layout-xs="column"> <span ng-show="!curriculum.id" layout-xs="column"> <md-button class="md-raised md-primary" ng-click="save()">{{\'main.button.save\' | translate}}</md-button> </span> <span ng-show="curriculum.id" layout-xs="column"> <md-button class="md-raised md-primary" ng-click="save()" ng-if="curriculum.canChange">{{\'main.button.save\' | translate}}</md-button> <md-button class="md-raised" ng-click="saveAndProceed()" ng-if="curriculum.canChange && curriculum.canConfirm">{{\'main.button.status.approving\' | translate}}</md-button> <md-button class="md-raised" ng-click="setStatusClosed()" ng-if="curriculum.canChange && curriculum.canClose">{{\'main.button.status.close\' | translate}}</md-button> <md-button class="md-raised md-default" ng-click="delete()" ng-if="curriculum.canDelete">{{\'main.button.delete\' | translate}}</md-button> </span> </span> <span ng-show="curriculum.status === STATUS.PROCEEDING && !formState.sentToEhis" layout-xs="column"> <md-button class="md-raised md-primary" ng-click="save()" ng-if="curriculum.canChange">{{\'main.button.save\' | translate}}</md-button> <md-button class="md-raised md-default" ng-click="changeStatusUnderRevision()" ng-if="curriculum.canSetUnderRevision">{{\'curriculum.button.changeStatusUnderRevision\' | translate}}</md-button> <md-button class="md-raised md-default" ng-click="delete()" ng-if="curriculum.canDelete">{{\'main.button.delete\' | translate}}</md-button> </span> <span ng-show="curriculum.status === STATUS.PROCEEDING && formState.sentToEhis" layout-xs="column"> <md-button class="md-raised md-default" ng-click="changeStatusUnderRevision()" ng-if="curriculum.canSetUnderRevision">{{\'curriculum.button.changeStatusUnderRevision\' | translate}}</md-button> <md-button class="md-raised md-default" ng-click="updateFromEhis(true)" ng-if="curriculum.canConfirm">{{\'curriculum.button.updateFromEhisTest\' | translate}}</md-button> <md-button class="md-raised md-default" ng-click="updateFromEhis(false)" ng-if="curriculum.canConfirm">{{\'curriculum.button.updateFromEhis\' | translate}}</md-button> </span> <span ng-show="curriculum.status === STATUS.VERIFIED" layout-xs="column"> <md-button class="md-raised md-primary" ng-click="save()" ng-if="curriculum.canChange">{{\'main.button.save\' | translate}}</md-button> <md-button class="md-raised md-default" ng-click="changeStatusUnderRevision()" ng-if="curriculum.canSetUnderRevision">{{\'curriculum.button.changeStatusUnderRevision\' | translate}}</md-button> </span> <a href="{{curriculumPdfUrl}}" target="_blank" class="md-button md-raised" ng-if="showPrintButton()">{{\'main.button.printGeneral\' | translate}}</a> <a href="{{curriculumModulesPdfUrl}}" target="_blank" class="md-button md-raised" ng-if="showPrintButton()">{{\'main.button.printModules\' | translate}}</a> <a href="{{curriculumCompetencesPdfUrl}}" target="_blank" class="md-button md-raised" ng-if="showPrintButton()">{{\'main.button.printCompetences\' | translate}}</a> <md-button class="md-raised md-default" ng-click="back(\'#/curriculum\', vocationalCurriculumForm)">{{\'main.button.back\' | translate}}</md-button> </div> </div> </div> <style>.lowerBorder {\r\n    border-bottom: solid 1px #E0E0E0;\r\n  }</style>'),
a.put("vocationalCurriculum/vocational.curriculum.view.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <form name="vocationalCurriculumForm" layout="column"> <div layout="row" layout-sm="column" layout-xs="column"> <div layout="column" flex="30" flex-sm="100" flex-xs="100"> <fieldset tabindex="1"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'curriculum.draft\' | translate}}</legend> <md-input-container flex="70" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <md-radio-group ng-model="curriculum.draft" name="draft" class="md-primary" ng-disabled="curriculum.id || (curriculum.draft && (curriculum.draft === \'OPPEKAVA_LOOMISE_VIIS_RIIKLIK\' || curriculum.draft === \'OPPEKAVA_LOOMISE_VIIS_KOOL\') || curriculum.nameEt)"> <md-radio-button value="OPPEKAVA_LOOMISE_VIIS_KUTSE" aria-label="OPPEKAVA LOOMISE VIIS KUTSE">{{draftOptions["OPPEKAVA_LOOMISE_VIIS_KUTSE"][$root.currentLanguageNameField()]}}</md-radio-button> <md-radio-button value="OPPEKAVA_LOOMISE_VIIS_TOOANDJA" aria-label="OPPEKAVA LOOMISE VIIS TOOANDJA">{{draftOptions["OPPEKAVA_LOOMISE_VIIS_TOOANDJA"][$root.currentLanguageNameField()]}}</md-radio-button> <md-radio-button value="OPPEKAVA_LOOMISE_VIIS_KOOL" aria-label="OPPEKAVA LOOMISE VIIS KOOL">{{draftOptions["OPPEKAVA_LOOMISE_VIIS_KOOL"][$root.currentLanguageNameField()]}}</md-radio-button> <md-radio-button value="OPPEKAVA_LOOMISE_VIIS_RIIKLIK" aria-label="OPPEKAVA LOOMISE VIIS RIIKLIK">{{draftOptions["OPPEKAVA_LOOMISE_VIIS_RIIKLIK"][$root.currentLanguageNameField()]}}</md-radio-button> </md-radio-group> <p class="invalid" ng-if="vocationalCurriculumForm.$submitted && !curriculum.draft">{{\'main.messages.error.inputFieldIsRequired\' | translate}}</p> </md-input-container> </fieldset> <div>&nbsp;</div> <fieldset tabindex="2" layout="column"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'curriculum.nameTitle\' | translate}}</legend> <div layout="column"> <md-input-container> <label>{{\'curriculum.nameEt\' | translate}}</label> <input name="nameEt" ng-model="curriculum.nameEt" type="text" readonly> </md-input-container> <md-input-container> <label>{{\'curriculum.nameEn\' | translate}}</label> <input ng-model="curriculum.nameEn" type="text" readonly> </md-input-container> <md-input-container> <label>{{\'curriculum.nameRu\' | translate}}</label> <input ng-model="curriculum.nameRu" type="text" readonly> </md-input-container> </div> </fieldset> </div> <fieldset tabindex="3" flex="66" flex-offset="4" flex-sm="100" flex-xs="100" flex-offset-sm="0" flex-offset-xs="0"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'curriculum.mainData\' | translate}}</legend> <div layout="row" flex layout-xs="column"> <md-input-container layout="row" flex="45"> <hois-classifier-radio layout="row" name="consecution" ng-model="curriculum.consecution" model-value-attr="code" main-classifier-code="OPPEKAVA_TYPE" filter-values watch-model="curriculum.origStudyLevel" connect-main-classifier-code="OPPEASTE" search-from-connect select-first-value default-value="OPPEKAVA_TYPE_E" disabled></hois-classifier-radio> </md-input-container> <md-input-container flex="50" flex-offset="5" flex-xs="100" flex-offset-xs="0"> <label>{{\'curriculum.code\' | translate}}</label> <input ng-model="curriculum.code" name="code" type="text" readonly> </md-input-container> </div> <div layout="row" flex> <div flex="45"> <md-checkbox ng-model="curriculum.joint" aria-label="Is vocational" class="md-primary" disabled> {{\'curriculum.isJoint\' | translate}} </md-checkbox> </div> <md-input-container flex="50" flex-offset="5"> <label>{{\'curriculum.merCode\' | translate}}</label> <input ng-model="curriculum.merCode" name="merCode" type="text" readonly> </md-input-container> </div> <!-- uus --> <div layout="row" flex> <div flex="45"> <md-checkbox ng-model="curriculum.occupation" ng-click="isOccupationChanged()" aria-label="Is vocational" ng-hide="isDraftEmployerSupportLetter" disabled> {{\'curriculum.occupationIsAcquired\' | translate}} </md-checkbox> </div> <md-input-container flex="50" flex-offset="5"> <label>{{\'curriculum.credits\' | translate}}</label> <input ng-model="curriculum.credits" name="credits" type="number" readonly> </md-input-container> </div> <div layout="row" layout-xs="column" flex> <md-input-container flex="45" flex-xs="100"> <label>{{\'curriculum.studyLevel\' | translate}}</label> <hois-classifier-select ng-model="curriculum.origStudyLevel" model-value-attr="code" main-classifier-code="OPPEASTE" disabled></hois-classifier-select> </md-input-container> <div layout="row" flex="50" flex-xs="100" flex-offset="5" flex-offset-xs="0"> <md-input-container flex="50" flex-xs="50"> <input ng-model="curriculum.studyPeriodYears" name="studyPeriodYears" type="number" placeholder="{{\'curriculum.studyPeriod\' | translate}} {{\'main.years\' | translate}}" readonly> </md-input-container> <md-input-container flex="45" flex-offset="5" flex-xs="50" flex-offset-xs="0"> <input ng-model="curriculum.studyPeriodMonths" name="studyPeriodMonths" type="number" placeholder="{{\'main.months\' | translate}}" readonly> </md-input-container> </div> </div> <div layout="row" layout-xs="column" flex> <md-input-container flex="45" flex-xs="100"> <label>{{\'curriculum.ekrLevel\' | translate}}</label> <hois-classifier-select ng-model="curriculum.ekrLevel" main-classifier-code="EKR" watch-model="curriculum.origStudyLevel" filter-values connect-main-classifier-code="EKR" select-first-value disabled></hois-classifier-select> </md-input-container> <md-input-container flex="50" flex-xs="100" flex-offset="5" flex-offset-xs="0"> <label>{{\'curriculum.studyForm\' | translate}}</label> <hois-classifier-select multiple ng-model="curriculum.studyForms" model-value-attr="code" main-classifier-code="OPPEVORM" criteria="{vocational: true}" disabled></hois-classifier-select> </md-input-container> </div> <div layout="row" layout-xs="column" flex> <md-input-container flex="45" flex-xs="100"> <label>{{\'curriculum.educationLevel\' | translate}}</label> <hois-classifier-select ng-model="curriculum.educationLevel" main-classifier-code="HARIDUSTASE" watch-model="curriculum.origStudyLevel" filter-values connect-main-classifier-code="HARIDUSTASE" select-first-value disabled></hois-classifier-select> </md-input-container> <md-input-container flex="50" flex-xs="100" flex-offset="5" flex-offset-xs="0"> <label>{{\'curriculum.studyLanguage\' | translate}}</label> <hois-classifier-select multiple ng-model="curriculum.studyLanguages" model-value-attr="code" main-classifier-code="OPPEKEEL" criteria="{vocational: true}" disabled></hois-classifier-select> </md-input-container> </div> <div layout="row" layout-xs="column" flex> <md-input-container flex="45" flex-xs="100"> <label>{{\'curriculum.areaOfStudy\' | translate}}</label> <hois-classifier-select ng-model="curriculum.areaOfStudy" model-value-attr="code" main-classifier-code="ISCED_VALD" criteria="{vocational: true}" disabled></hois-classifier-select> </md-input-container> <!-- hois-school-department-select was not used here as it set form $dirty after page load.\r\n          In addition, extra logic in providing options --> <md-input-container flex="50" flex-offset="5" flex-xs="100" flex-offset-xs="0"> <label> {{\'curriculum.structuralUnitResponsible\' | translate}} </label> <hois-select ng-model="curriculum.schoolDepartments" multiple values="schoolDepartments" disabled></hois-select> </md-input-container> </div> <div layout="row" layout-xs="column" flex> <md-input-container flex="45" flex-xs="100"> <label>{{\'curriculum.fieldOfStudy\' | translate}}</label> <hois-classifier-select ng-model="curriculum.fieldOfStudy" model-value-attr="code" main-classifier-code="ISCED_SUUN" criteria="{vocational: true}" watch-model="curriculum.areaOfStudy" filter-values search-from-connect connect-main-classifier-code="ISCED_VALD" disabled></hois-classifier-select> </md-input-container> <md-input-container flex="50" flex-xs="100" flex-offset="5" flex-offset-xs="0" ng-show="curriculum.draft === \'OPPEKAVA_LOOMISE_VIIS_RIIKLIK\'"> <label>{{\'curriculum.ehisRokClassifier\' | translate}}</label> <hois-classifier-select ng-model="curriculum.stateCurrClass" model-value-attr="code" main-classifier-code="EHIS_ROK" disabled></hois-classifier-select> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="45" flex-xs="100"> <label>{{\'curriculum.group\' | translate}}</label> <hois-classifier-select ng-model="curriculum.iscedClass" model-value-attr="code" main-classifier-code="ISCED_RYHM" criteria="{vocational: true}" watch-model="curriculum.fieldOfStudy" filter-values search-from-connect connect-main-classifier-code="ISCED_SUUN" disabled></hois-classifier-select> </md-input-container> </div> </fieldset> </div> <div>&nbsp;</div> <fieldset tabindex="4"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'curriculum.commonData\' | translate}}</legend> <div layout="column"> <md-input-container flex> <label>{{\'curriculum.studyOutcomesEt\' | translate}}</label> <textarea ng-model="curriculum.outcomesEt" max-rows="10" readonly></textarea> </md-input-container> <md-input-container flex> <label>{{\'curriculum.studyOutcomesEn\' | translate}}</label> <textarea ng-model="curriculum.outcomesEn" max-rows="10" readonly></textarea> </md-input-container> <md-input-container flex> <label>{{\'curriculum.structure\' | translate}}</label> <textarea ng-model="curriculum.structure" max-rows="10" readonly></textarea> </md-input-container> <md-input-container flex> <label>{{\'curriculum.admissionRequirementsEt\' | translate}}</label> <textarea ng-model="curriculum.admissionRequirementsEt" max-rows="10" readonly></textarea> </md-input-container> <md-input-container flex> <label>{{\'curriculum.admissionRequirementsEn\' | translate}}</label> <textarea ng-model="curriculum.admissionRequirementsEn" max-rows="10" readonly></textarea> </md-input-container> <md-input-container flex> <label>{{\'curriculum.graduationRequirementsEt\' | translate}}</label> <textarea ng-model="curriculum.graduationRequirementsEt" max-rows="10" readonly></textarea> </md-input-container> <md-input-container flex> <label>{{\'curriculum.graduationRequirementsEn\' | translate}}</label> <textarea ng-model="curriculum.graduationRequirementsEn" max-rows="10" readonly></textarea> </md-input-container> <md-input-container flex> <label>{{\'curriculum.basesOfDraft\' | translate}}</label> <textarea ng-model="curriculum.draftText" max-rows="10" readonly></textarea> </md-input-container> <md-input-container flex> <label>{{\'curriculum.specialityOpportunities\' | translate}}</label> <textarea ng-model="curriculum.specialization" max-rows="10" readonly></textarea> </md-input-container> <md-input-container flex> <label>{{\'curriculum.supervisor\' | translate}}</label> <input ng-value="currentLanguageNameField(curriculum.teacher)" readonly> </md-input-container> </div> </fieldset> <div>&nbsp;</div> <fieldset tabindex="5" ng-hide="isDraftEmployerSupportLetter"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small"> {{curriculum.occupation ? \'curriculum.occupationsAcquired\' : \'curriculum.partOccupationsAcquired\' | translate}} </legend> <div layout="column"> <div ng-if="vocationalCurriculumForm.$submitted && occupationRequired() && strictValidation()"> <input style="display:none" type="number" readonly name="occupationsLength" ng-model="validation.occupationsLength" min="1"> <div md-colors="{color: \'warn-A400\'}" ng-messages="vocationalCurriculumForm.occupationsLength.$error"> <div ng-message="min">{{\'main.messages.error.atLeastOneShouldBeAdded\' | translate}}</div> </div> </div> </div> <md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'curriculum.occupationTable.order\' | translate}}</th> <th md-column ng-show="curriculum.occupation">{{\'curriculum.occupationTable.occupation\' | translate}}</th> <th md-column ng-show="!curriculum.occupation">{{\'curriculum.occupationTable.partOccupation\' | translate}}</th> <th md-column ng-show="curriculum.occupation">{{\'curriculum.occupationTable.partOccupations\' | translate}}</th> <th md-column ng-show="curriculum.occupation">{{\'curriculum.occupationTable.speciality\' | translate}}</th> <th md-column ng-show="curriculum.occupation">{{\'occupation.hasOccupationGrant\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="item in curriculum.curriculumOccupations | orderBy: [\'occupation\', \'-occupation.validThru\', \'-occupation.validFrom\']:false:compareUsingLanguage" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{$index + 1}}</td> <td md-cell> <a href="" ng-click="curriculum.occupation ? openOccupationDialog(item) : openPartOccupationsDialog(item)">{{item.occupation | hoisValidDates}}</a> </td> <td md-cell><span ng-hide="!curriculum.occupation" ng-repeat="partOccupation in item.partOccupations">{{currentLanguageNameField(partOccupation)}}{{$last ? \'\' : \', \'}}</span></td> <td md-cell><span ng-hide="!curriculum.occupation || !item.specialities || item.specialities.length == 0" ng-repeat="speciality in item.specialities track by $index"> {{currentLanguageNameField(speciality)}}{{$last ? \'\' : \', \'}}</span></td> <td md-cell> <span ng-hide="!curriculum.occupation"> <md-checkbox ng-model="item.occupationGrant" disabled></md-checkbox> </span></td> <td md-cell></td> </tr> </tbody> </table> </md-table-container> </fieldset> <div>&nbsp;</div> <fieldset tabindex="6"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small" ng-class="{invalid: vocationalCurriculumForm.$submitted && strictValidation() && !modulesValid()}">{{\'curriculum.modulesTought\' | translate}}</legend> <!--MODULES WITHOUT OCCUPATIONS--> <div class="occupation-header align-center"> <span ng-class="{invalid: notAllModulesHaveOccupation()}">{{\'module.modulesWithoutPartOccupationOccuaptionSpecialization\' | translate}}</span> </div> <div layout="column" ng-repeat="type in moduleTypes | filter: filterTypesWithoutEmptyModules" class="lowerBorder"> <div layout="row" flex="100" class="occupation-row align-center border-bottom odd"> <div flex="5">&nbsp;</div> <div flex="20" flex-xs="35" style="word-wrap: break-word">{{currentLanguageNameField(type)}} ({{getTotalCredits(curriculum.modules | filter: filterEmptyModulesByType(type.code))}} EKAP)</div> <div layout="column" flex="75" flex-xs="60"> <div flex="100" ng-repeat="module in curriculum.modules | filter: filterEmptyModulesByType(type.code) | orderBy: \'nameEt\' track by $index" layout="row" class="align-center"> <a flex="30" flex-xs="70" style="word-wrap: break-word" ng-click="openAddModuleDialog(module)" href="">{{module.baseModule ? \'* \' : \'\'}}{{currentLanguageNameField(module)}}</a> <span flex="10" flex-xs="30">{{module.credits}}&nbsp; EKAP</span> </div> </div> </div> </div> <!--KUTSETE/OSAKUTSETE MOODULID--> <div ng-repeat="occupation in curriculum.curriculumOccupations | orderBy: [\'occupation\', \'-occupation.validThru\', \'-occupation.validFrom\']:false:compareUsingLanguage" layout="column"> <div class="occupation-header align-center"> <span ng-show="curriculum.occupation" ng-class="{invalid: vocationalCurriculumForm.$submitted && strictValidation() && (!occupationHasPModule(occupation.occupation.code) || !isOccutationsCreditsValid(occupation))}"> {{\'stateCurriculum.enter.occupation.occupation\' | translate}} {{$index + 1}}:&nbsp; {{occupation.occupation | hoisValidDates }} </span> <span ng-show="!curriculum.occupation" ng-class="{invalid: vocationalCurriculumForm.$submitted && strictValidation() && (!occupationHasPModule(occupation.occupation.code) || !isOccutationsCreditsValid(occupation))}"> {{\'stateCurriculum.enter.occupation.partial\' | translate}} {{$index + 1}}:&nbsp; {{occupation.occupation | hoisValidDates }} </span> </div> <div layout="column" ng-repeat="type in moduleTypes | filter: filterTypesWithoutModules(occupation.occupation.code, curriculum.modules)" class="lowerBorder"> <div layout="row" flex="100" class="occupation-row align-center border-bottom odd"> <div flex="5" flex-xs="0">&nbsp;</div> <div flex="20" flex-xs="30" style="word-wrap: break-word">{{currentLanguageNameField(type)}} ({{getTotalCredits(curriculum.modules | filter: filterModulesByType(type.code, occupation.occupation.code))}} EKAP)</div> <div layout="column" flex="75" flex-xs="70"> <div flex="100" ng-repeat="module in curriculum.modules | filter: filterModulesByType(type.code, occupation.occupation.code) | orderBy: \'nameEt\' track by $index" layout="row" class="align-center"> <a flex="30" flex-xs="80" style="word-wrap: break-word" ng-click="openAddModuleDialog(module)" href="">{{module.baseModule ? \'* \' : \'\'}}{{currentLanguageNameField(module)}}</a> <span flex="10">{{module.credits}}&nbsp; EKAP</span> </div> </div> </div> </div> <!--OSAKUTSETE MOODULID--> <div ng-repeat="partOccupation in occupation.partOccupations | orderBy: [partOccupation, \'-validThru\', \'-validFrom\']:false:compareUsingLanguage" layout="column"> <div class="occupation-header2 align-center"> <span ng-class="{invalid: vocationalCurriculumForm.$submitted && strictValidation() && !occupationHasPModule(partOccupation.code)}">{{\'stateCurriculum.enter.occupation.partial\' | translate}} {{$index + 1}}: {{partOccupation | hoisValidDates }}</span> </div> <div layout="column" ng-repeat="type in moduleTypes | filter: filterTypesWithoutModules(partOccupation.code, curriculum.modules)" class="lowerBorder"> <div layout="row" flex="100" class="occupation-row align-center border-bottom odd"> <div flex="5" flex-xs="0">&nbsp;</div> <div flex="20" flex-xs="30" style="word-wrap: break-word">{{currentLanguageNameField(type)}} ({{getTotalCredits(curriculum.modules | filter: filterModulesByType(type.code, partOccupation.code))}} EKAP)</div> <div layout="column" flex="75" flex-xs="70"> <div flex="100" ng-repeat="module in curriculum.modules | filter: filterModulesByType(type.code, partOccupation.code) | orderBy: \'nameEt\' track by $index" layout="row" class="align-center"> <a flex="30" flex-xs="80" ng-click="openAddModuleDialog(module)" style="word-wrap: break-word" href="">{{module.baseModule ? \'* \' : \'\'}}{{currentLanguageNameField(module)}}</a> <span flex="10">{{module.credits}}&nbsp; EKAP</span> </div> </div> </div> </div> </div> <!--SPETSKUTSETE MOODULID--> <div ng-repeat="speciality in occupation.specialities | orderBy: [speciality, \'-validThru\', \'-validFrom\']:false:compareUsingLanguage" layout="column"> <div class="occupation-header2 align-center"> <span ng-class="{invalid: vocationalCurriculumForm.$submitted && strictValidation() && (!occupationHasPModule(speciality.code) || !isSpetsOccupationValid(speciality, occupation))}">{{\'stateCurriculum.enter.occupation.specialty\' | translate}} {{$index + 1}}: {{speciality | hoisValidDates }}</span> </div> <div layout="column" ng-repeat="type in moduleTypes | filter: filterTypesWithoutModules(speciality.code, curriculum.modules)" class="lowerBorder"> <div layout="row" flex="100" class="occupation-row align-center border-bottom odd"> <div flex="5" flex-xs="0">&nbsp;</div> <div flex="20" flex-xs="30" style="word-wrap: break-word">{{currentLanguageNameField(type)}} ({{getTotalCredits(curriculum.modules | filter: filterModulesByType(type.code, speciality.code))}} EKAP)</div> <div layout="column" flex="75" flex-xs="70"> <div flex="100" ng-repeat="module in curriculum.modules | filter: filterModulesByType(type.code, speciality.code) | orderBy: \'nameEt\' track by $index" layout="row" class="align-center"> <a flex="30" flex-xs="80" ng-click="openAddModuleDialog(module)" style="word-wrap: break-word" href="">{{module.baseModule ? \'* \' : \'\'}}{{currentLanguageNameField(module)}}</a> <span flex="10">{{module.credits}}&nbsp; EKAP</span> </div> </div> </div> </div> </div> </div> </fieldset> <div>&nbsp;</div> <fieldset tabindex="7"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'curriculum.additionalInfo\' | translate}}</legend> <md-input-container> <label>{{\'curriculum.optionalStudyCredits\' | translate}}</label> <input name="vocationalCredits" type="number" ng-model="curriculum.optionalStudyCredits" aria-label="optional credits" min="0" max="999" pattern="^\\d+(\\.\\d{1})?$" readonly> <div ng-messages="vocationalCurriculumForm.vocationalCredits.$error" ng-show="vocationalCurriculumForm.vocationalCredits.$dirty"> <div ng-message="min"> {{\'main.messages.error.positive\' | translate}} </div> <div ng-message="max"> {{\'curriculum.error.max999\' | translate}} </div> <div ng-message="pattern"> {{\'stateCurriculum.error.decimalPresision\' | translate}} </div> </div> </md-input-container> <div layout="column"> <md-input-container flex> <label>{{\'curriculum.practiceDescription\' | translate}}</label> <textarea ng-model="curriculum.practiceDescription" max-rows="2" readonly></textarea> </md-input-container> <md-input-container flex> <label>{{\'curriculum.finalExamShortDescription\' | translate}}</label> <textarea ng-model="curriculum.finalExamDescription" max-rows="2" readonly></textarea> </md-input-container> <md-input-container flex> <label>{{\'curriculum.optionalStudyOpportunities\' | translate}}</label> <textarea ng-model="curriculum.optionalStudyDescription" max-rows="2" readonly></textarea> </md-input-container> <md-input-container flex> <label>{{\'curriculum.contactPerson\' | translate}}</label> <input ng-model="curriculum.contactPerson" type="text" readonly> </md-input-container> <md-input-container flex> <label>{{\'main.notes\' | translate}}</label> <textarea ng-model="curriculum.description" max-rows="2" readonly></textarea> </md-input-container> <md-input-container flex ng-if="curriculum.status === STATUS.VERIFIED"> <label>{{\'public.url\' | translate}}</label> <input ng-model="publicUrl" type="text" readonly> </md-input-container> </div> </fieldset> <div ng-show="curriculum.joint">&nbsp;</div> <fieldset tabindex="8" ng-show="curriculum.joint"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'curriculum.jointInfo\' | translate}}</legend> <div layout="column"> <div layout="row" layout-align="start start" ng-show="curriculum.joint"> <label class="md-required common-label" flex="30">{{\'curriculum.jointSchool\' | translate}}</label> </div> <div>&nbsp;</div> <div layout="column" flex ng-show="curriculum.joint" class="common-label"> <div layout="row" ng-repeat="item in curriculum.jointPartners | filter: filterEmptyJointPartners | orderBy: [\'ehisSchool\', \'nameEt\']" class="align-center"> <div flex="5">&nbsp;</div> <div ng-if="item.abroad">{{currentLanguageNameField(item)}}</div> <div ng-if="!item.abroad"> <hois-classifier-value ng-model="item.ehisSchool" main-classifier-code="EHIS_KOOL"></hois-classifier-value></div> <div flex="5">&nbsp;</div> <div flex="5"></div> </div> </div> <div layout="row" layout-sm="column" layout-xs="column" ng-show="curriculum.joint"> <md-input-container flex="30" ng-if="curriculum.joint"> <label>{{\'curriculum.jointMentor\' | translate}}</label> <hois-classifier-select ng-model="curriculum.jointMentor" main-classifier-code="EHIS_KOOL" model-value-attr="code" disabled></hois-classifier-select> </md-input-container> <md-input-container flex="66" flex-offset="4"> <label>{{\'curriculum.jointResponsible\' | translate}}</label> <input ng-model="curriculum.supervisor" type="text" readonly> </md-input-container> </div> <md-input-container flex="100"> <label>{{\'curriculum.jointAgreementInfoEt\' | translate}}</label> <textarea ng-model="curriculum.contractEt" max-rows="10" readonly></textarea> </md-input-container> <md-input-container flex="100"> <label>{{\'curriculum.jointAgreementInfoEn\' | translate}}</label> <textarea ng-model="curriculum.contractEn" max-rows="10" readonly></textarea> </md-input-container> </div> </fieldset> <div>&nbsp;</div> <fieldset tabindex="9"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'curriculum.address\' | translate}}</legend> <div layout="column" flex class="common-label"> <div layout="row" ng-repeat="item in curriculum.addresses | orderBy: \'address\'" class="align-center"> <div>{{::item.address}}</div> </div> </div> </fieldset> <div>&nbsp;</div> <fieldset tabindex="10"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'curriculum.approvalInfo\' | translate}}</legend> <div layout="row" flex="100"> <md-input-container flex="30" flex-sm="100" flex-xs="100"> <label>{{\'curriculum.approvalDocumentNr\' | translate}}</label> <input ng-model="curriculum.approvalDokNr" type="text" readonly> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-xs="100" flex-offset-xs="0" flex-offset-sm="0" flex-offset="4"> <label>{{\'curriculum.approvalDate\' | translate}}</label> <md-datepicker ng-model="curriculum.approval" md-open-on-focus disabled></md-datepicker> </md-input-container> </div> </fieldset> <div>&nbsp;</div> <fieldset tabindex="11"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'curriculum.statuses\' | translate}}</legend> <div style="overflow: auto"> <div layout="row" flex="100"> <md-input-container flex="30" flex-sm="100" flex-xs="100"> <label>{{\'main.validFrom\' | translate}}</label> <md-datepicker ng-model="curriculum.validFrom" md-open-on-focus disabled></md-datepicker> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-xs="100" flex-offset-xs="0" flex-offset-sm="0" flex-offset="4"> <label>{{\'main.validTo\' | translate}}</label> <md-datepicker ng-model="curriculum.validThru" md-min-date="curriculum.validFrom" md-open-on-focus disabled></md-datepicker> </md-input-container> </div> <div layout="row" flex="100" class="top-margin form-readonly"> <md-input-container flex="30" flex-sm="100" flex-xs="100" class="readonly"> <label class="label">{{\'main.status\' | translate}}</label> <hois-classifier-value ng-model="curriculum.status" main-classifier-code="OPPEKAVA_STAATUS"></hois-classifier-value> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-xs="100" flex-offset-xs="0" flex-offset-sm="0" flex-offset="4"> <label>{{\'curriculum.statusInEhis\' | translate}}</label> <hois-classifier-value ng-model="curriculum.ehisStatus" main-classifier-code="OPPEKAVA_EHIS_STAATUS"></hois-classifier-value> </md-input-container> <md-input-container flex="40" flex-sm="100" flex-xs="100" flex-offset-xs="0" flex-offset-sm="0" flex-offset="5"> <label>{{\'curriculum.statusChangedDateInEhis\' | translate}}</label> <hois-value value="curriculum.ehisChanged | hoisDate"></hois-value> </md-input-container> </div> <div layout="row" flex="100" class="md-body-1 hois-value"> <a ng-show="!!curriculum.stateCurriculum" ng-href="/#/stateCurriculum/{{curriculum.stateCurriculum.id}}/view" class="md-primary" translate="curriculum.referenceToStateCurriculum" translate-values="{{curriculum.stateCurriculum}}"></a> </div> </div> </fieldset> <div>&nbsp;</div> <fieldset tabindex="12"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.relatedFiles\' | translate}}</legend> <md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column><span>{{\'file.nameAndFile\' | translate}}</span></th> <th md-column><span>{{\'file.creationLocation\' | translate}}</span></th> <th md-column>{{\'file.type\' | translate}}</th> <th md-column>{{\'curriculum.sendToEhis\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="file in curriculum.files | orderBy: \'oisFile.fname\'" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell> {{file.oisFile.fname}} <a ng-href="{{getUrl(file, \'curriculum\')}}" download><md-icon md-font-set="material-icons">file_download</md-icon></a> </td> <td md-cell> {{file.ehis ? \'EHIS\' : \'ÕIS\'}} </td> <td md-cell> <hois-classifier-value ng-model="file.ehisFile" main-classifier-code="EHIS_FAIL"></hois-classifier-value> </td> <td md-cell> <md-checkbox ng-model="file.sendEhis" aria-label="send to ehis" disabled></md-checkbox> </td> <td md-cell> </td> </tr> </tbody> </table> </md-table-container> </fieldset> <div>&nbsp;</div> <fieldset tabindex="13"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'curriculum.moduleImplementationPlans\' | translate}}</legend> <md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'module.implementationPlan.code\' | translate}}</th> <th md-column>{{\'main.status\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="moduleImplementationPlan in curriculum.versions | orderBy: \'code\'"> <td md-cell> <a href="" class="md-primary" ng-click="goToImplementationPlanForm(moduleImplementationPlan)">{{moduleImplementationPlan.code}}</a> </td> <td md-cell><hois-classifier-value ng-model="moduleImplementationPlan.status" main-classifier-code="OPPEKAVA_VERSIOON_STAATUS"></hois-classifier-value></td> </tr> </tbody> </table> </md-table-container> </fieldset> <hois-created-modified object="curriculum"></hois-created-modified> <div> </div> </form> <div layout="row"> <div flex layout-xs="column"> <span ng-show="curriculum.status === STATUS.ENTERING" layout-xs="column"> <md-button class="md-raised md-primary" ng-click="goToEditForm()" ng-if="curriculum.canChange">{{\'main.button.change\' | translate}}</md-button> </span> <span ng-show="curriculum.status === STATUS.PROCEEDING && !formState.sentToEhis" layout-xs="column"> <md-button class="md-raised md-primary" ng-click="goToEditForm()" ng-if="curriculum.canChange">{{\'main.button.change\' | translate}}</md-button> <md-button class="md-raised md-default" ng-click="changeStatusUnderRevision()" ng-if="curriculum.canSetUnderRevision">{{\'curriculum.button.changeStatusUnderRevision\' | translate}}</md-button> <md-button class="md-raised md-default" ng-click="sendToEhis(true)" ng-if="curriculum.canConfirm">{{\'curriculum.button.sendToEhisTest\' | translate}}</md-button> <md-button class="md-raised md-default" ng-click="sendToEhis(false)" ng-if="curriculum.canConfirm">{{\'curriculum.button.sendToEhis\' | translate}}</md-button> <md-button class="md-raised" ng-click="setStatusClosed()" ng-if="curriculum.canClose">{{\'main.button.status.close\' | translate}}</md-button> </span> <span ng-show="curriculum.status === STATUS.PROCEEDING && formState.sentToEhis" layout-xs="column"> <md-button class="md-raised md-default" ng-click="changeStatusUnderRevision()" ng-if="curriculum.canSetUnderRevision">{{\'curriculum.button.changeStatusUnderRevision\' | translate}}</md-button> <md-button class="md-raised md-default" ng-click="updateFromEhis(true)" ng-if="curriculum.canConfirm">{{\'curriculum.button.updateFromEhisTest\' | translate}}</md-button> <md-button class="md-raised md-default" ng-click="updateFromEhis(false)" ng-if="curriculum.canConfirm">{{\'curriculum.button.updateFromEhis\' | translate}}</md-button> </span> <span ng-show="curriculum.status === STATUS.VERIFIED" layout-xs="column"> <md-button class="md-raised md-primary" ng-click="goToEditForm()" ng-if="curriculum.canChange">{{\'main.button.change\' | translate}}</md-button> <md-button class="md-raised md-default" ng-click="changeStatusUnderRevision()" ng-if="curriculum.canSetUnderRevision">{{\'curriculum.button.changeStatusUnderRevision\' | translate}}</md-button> <md-button class="md-raised" ng-click="setStatusClosed()" ng-if="curriculum.canClose">{{\'main.button.status.close\' | translate}}</md-button> </span> <a href="{{curriculumPdfUrl}}" target="_blank" class="md-button md-raised" ng-if="showPrintButton()">{{\'main.button.printGeneral\' | translate}}</a> <a href="{{curriculumModulesPdfUrl}}" target="_blank" class="md-button md-raised" ng-if="showPrintButton()">{{\'main.button.printModules\' | translate}}</a> <a href="{{curriculumCompetencesPdfUrl}}" target="_blank" class="md-button md-raised" ng-if="showPrintButton()">{{\'main.button.printCompetences\' | translate}}</a> <md-button class="md-raised md-default" ng-click="back(\'#/curriculum\')">{{\'main.button.back\' | translate}}</md-button> </div> </div> </div> <style>.lowerBorder {\r\n     border-bottom: solid 1px #E0E0E0;\r\n   }</style>'),
a.put("apelApplication/templates/apel.application.formal.learning.higher.list.html","<md-table-container> <table md-table class=\"secondary-table\"> <thead md-head> <tr md-row ng-class=\"!record.error ? 'apel-record-header' : 'apel-record-header-error'\"> <th md-column ng-if=\"!formState.viewForm && application.canEdit\"> <a ng-click=\"editFormalLearning(record.id)\">{{'main.button.change' | translate}}</a> </th> <th md-column colspan=\"{{formalLearningColspan}}\" style=\"text-align: center\">{{'apel.formalLearnings.transferableSubjects' | translate}} </th> <th md-column style=\"border-left: 1px rgba(0, 0, 0, 0.12) solid\"></th> <th md-column colspan=\"2\" style=\"text-align: center\">{{'apel.formalLearnings.substitutableSubjects' | translate}}</th> </tr> <tr md-row> <th md-column ng-if=\"application.status !== 'VOTA_STAATUS_K'\">{{'apel.formalLearnings.transfer' | translate}}</th> <th md-column>{{'apel.formalLearnings.school' | translate}}</th> <th md-column>{{'apel.formalLearnings.subject' | translate}} ({{'apel.formalLearnings.code' | translate}})</th> <th md-column>{{'apel.formalLearnings.creditsEAP' | translate}}</th> <th md-column>{{'apel.formalLearnings.assessment' | translate}}</th> <th md-column>{{'apel.formalLearnings.result' | translate}}</th> <th md-column>{{'apel.formalLearnings.resultDate' | translate}}</th> <th md-column>{{auth.higher ? ('apel.formalLearnings.teacherHigher' | translate) : ('apel.formalLearnings.teacherVocational' | translate)}}</th> <th md-column>{{'apel.formalLearnings.module' | translate}} ({{'apel.formalLearnings.required' | translate}})</th> <td md-cell style=\"border-left: 1px rgba(0, 0, 0, 0.12) solid\"></td> <th md-column>{{'apel.formalLearnings.subject' | translate}} ({{'apel.formalLearnings.code' | translate}})</th> <th md-column>{{'apel.formalLearnings.creditsEAP' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat=\"row in record.data | orderBy:'moduleId'\" ng-class-odd=\"'odd'\" ng-class-even=\"'even'\"> <td md-cell ng-if=\"application.status !== 'VOTA_STAATUS_K'\"> <md-checkbox ng-if=\"(row.transfer === false || row.transfer === true) && canChangeTransferStatus\" ng-model=\"row.transfer\" ng-click=\"changeFormalTransferStatus(row)\" aria-label=\"{{'apel.formalLearnings.transfer' | translate}}\"></md-checkbox> <md-checkbox ng-if=\"(row.transfer === false || row.transfer === true) && !canChangeTransferStatus\" ng-model=\"row.transfer\" ng-click=\"changeFormalTransferStatus(row)\" aria-label=\"{{'apel.formalLearnings.transfer' | translate}}\" ng-disabled=\"true\"></md-checkbox> </td> <td md-cell>{{currentLanguageNameField(row.school)}}</td> <td md-cell>{{currentLanguageNameField(row.subject)}} <span ng-if=\"row.code\">({{row.code}})</span></td> <td md-cell>{{row.credits}}</td> <td md-cell>{{currentLanguageNameField(row.assessment)}}</td> <td md-cell>{{auth.school.letterGrades ? row.grade.value2 : row.grade.value}}</td> <td md-cell>{{row.gradeDate | hoisDate}}</td> <td md-cell>{{row.teachers}}</td> <td md-cell> <span ng-if=\"row.isOptional === false\">{{currentLanguageNameField(row.module)}} ({{'main.yes' | translate}})</span> <span ng-if=\"row.isOptional === true\">{{currentLanguageNameField(row.module)}} ({{'main.no' | translate}})</span> </td> <td md-cell style=\"border-left: 1px rgba(0, 0, 0, 0.12) solid\"></td> <td md-cell> <span ng-if=\"row.replacedSubject\">{{currentLanguageNameField(row.replacedSubject)}} ({{row.replacedSubject.code}})</span> </td> <td md-cell>{{row.replacedCredits}}</td> </tr> </tbody> </table> </md-table-container>"),a.put("apelApplication/templates/apel.application.formal.learning.vocational.list.html",'<md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row class="apel-record-header"> <th md-column ng-if="!formState.viewForm && application.canEdit"> <a ng-click="editFormalLearning(record.id)">{{\'main.button.change\' | translate}}</a> </th> <th md-column colspan="{{formalLearningColspan}}" style="text-align: center">{{\'apel.formalLearnings.transferableModules\' | translate}} </th> <th md-column style="border-left: 1px rgba(0, 0, 0, 0.12) solid"></th> <th md-column colspan="2" style="text-align: center">{{\'apel.formalLearnings.substitutableModulesThemes\' | translate}}</th> </tr> <tr md-row> <th md-column ng-if="application.status !== \'VOTA_STAATUS_K\'">{{\'apel.formalLearnings.transfer\' | translate}}</th> <th md-column>{{\'apel.formalLearnings.school\' | translate}}</th> <th md-column>{{\'apel.formalLearnings.module\' | translate}}</th> <th md-column>{{\'apel.formalLearnings.creditsEKAP\' | translate}}</th> <th md-column>{{\'apel.formalLearnings.result\' | translate}}</th> <th md-column>{{\'apel.formalLearnings.resultDate\' | translate}}</th> <th md-column>{{auth.higher ? (\'apel.formalLearnings.teacherHigher\' | translate) : (\'apel.formalLearnings.teacherVocational\' | translate)}}</th> <th md-column style="border-left: 1px rgba(0, 0, 0, 0.12) solid"></th> <th md-column>{{\'apel.formalLearnings.module\' | translate}}/{{\'apel.formalLearnings.theme\' | translate}}</th> <th md-column>{{\'apel.formalLearnings.creditsEKAP\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in record.data | orderBy:\'moduleId\'" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell ng-if="application.status !== \'VOTA_STAATUS_K\'"> <md-checkbox ng-if="(row.transfer === false || row.transfer === true) && canChangeTransferStatus" ng-model="row.transfer" ng-click="changeFormalTransferStatus(row)" aria-label="{{\'apel.formalLearnings.transfer\' | translate}}"></md-checkbox> <md-checkbox ng-if="(row.transfer === false || row.transfer === true) && !canChangeTransferStatus" ng-model="row.transfer" ng-click="changeFormalTransferStatus(row)" aria-label="{{\'apel.formalLearnings.transfer\' | translate}}" ng-disabled="true"></md-checkbox> </td> <td md-cell>{{currentLanguageNameField(row.school)}}</td> <td md-cell>{{currentLanguageNameField(row.module)}}</td> <td md-cell>{{row.credits}}</td> <td md-cell>{{row.grade.value}}</td> <td md-cell>{{row.gradeDate | hoisDate}}</td> <td md-cell>{{row.teachers}}</td> <td md-cell style="border-left: 1px rgba(0, 0, 0, 0.12) solid"></td> <td md-cell> <span ng-if="!row.replacedTheme">{{currentLanguageNameField(row.replacedModule)}}</span> <span ng-if="row.replacedTheme">{{currentLanguageNameField(row.replacedModule)}}/{{currentLanguageNameField(row.replacedTheme)}}</span> </td> <td md-cell>{{row.replacedCredits}}</td> </tr> </tbody> </table> </md-table-container>'),a.put("apelApplication/templates/apel.application.informal.learning.higher.list.html",'<md-table-container flex="100"> <table md-table class="secondary-table"> <thead md-head> <tr md-row class="apel-record-header"> <th md-column> <a ng-if="!formState.viewForm && application.canEdit" ng-click="editInformalLearning(record.id)">{{\'main.button.change\' | translate}}</a> </th> <th md-column colspan="{{informalLearningColspan}}" style="text-align: center">{{\'apel.informalLearnings.schoolResults\' | translate}}</th> <th md-column style="border-left: 1px rgba(0, 0, 0, 0.12) solid"></th> <th md-column colspan="5" style="text-align: center">{{\'apel.informalLearnings.higherOtherInformalLearnings\' | translate}}</th> </tr> <tr md-row> <th md-column ng-if="application.status !== \'VOTA_STAATUS_K\'" colspan="1">{{\'apel.informalLearnings.transfer\' | translate}}</th> <th md-column>{{\'apel.informalLearnings.subject\' | translate}} ({{\'apel.informalLearnings.code\' | translate}})</th> <th md-column>{{\'apel.informalLearnings.creditsEAP\' | translate}}</th> <th md-column>{{\'apel.informalLearnings.result\' | translate}}</th> <th md-column>{{\'apel.informalLearnings.module\' | translate}} ({{\'apel.informalLearnings.required\' | translate}})</th> <th md-column>{{\'apel.informalLearnings.acquiredSkills\' | translate}}</th> <th md-column style="border-left: 1px rgba(0, 0, 0, 0.12) solid"></th> <th md-column>{{\'apel.informalLearnings.name\' | translate}}</th> <th md-column>{{\'apel.informalLearnings.placeTime\' | translate}}</th> <th md-column>{{\'apel.informalLearnings.hours\' | translate}}</th> <th md-column>{{\'apel.informalLearnings.documents\' | translate}}</th> <th md-column>{{\'apel.informalLearnings.type\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in record.data | orderBy:\'subjectId\'" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell ng-if="!(application.status === \'VOTA_STAATUS_K\')"> <md-checkbox ng-if="(row.transfer === false || row.transfer === true) && canChangeTransferStatus" ng-model="row.transfer" ng-click="changeInformalTransferStatus(row)" aria-label="{{\'apel.informalLearnings.transfer\' | translate}}"></md-checkbox> <md-checkbox ng-if="(row.transfer === false || row.transfer === true) && !canChangeTransferStatus" ng-model="row.transfer" ng-click="changeInformalTransferStatus(row)" aria-label="{{\'apel.informalLearnings.transfer\' | translate}}" ng-disabled="true"></md-checkbox> </td> <td md-cell> <span ng-if="row.subject">{{currentLanguageNameField(row.subject)}} ({{row.code}})</span> </td> <td md-cell>{{row.credits}}</td> <td md-cell>{{auth.school.letterGrades ? row.grade.value2 : row.grade.value}}</td> <td md-cell> <span ng-if="row.isOptional === false"> {{row.module ? currentLanguageNameField(row.module) : (\'apel.informalLearnings.freeChoice\' | translate)}} ({{\'main.yes\' | translate}}) </span> <span ng-if="row.isOptional === true"> {{row.module ? currentLanguageNameField(row.module) : (\'apel.informalLearnings.freeChoice\' | translate)}} ({{\'main.no\' | translate}}) </span> </td> <td md-cell>{{row.skills}}</td> <td md-cell style="border-left: 1px rgba(0, 0, 0, 0.12) solid"></td> <td md-cell>{{row.nameEt}}</td> <td md-cell>{{row.placeTime}}</td> <td md-cell>{{row.hours}}</td> <td md-cell>{{row.documents}}</td> <td md-cell> <hois-classifier-value ng-model="row.type" main-classifier-code="VOTA_INFORMAAL_LIIK"></hois-classifier-value> </td> </tr> </tbody> </table> </md-table-container>'),a.put("apelApplication/templates/apel.application.informal.learning.vocational.list.html",'<md-table-container flex="100"> <table md-table class="secondary-table"> <thead md-head> <tr md-row class="apel-record-header"> <th md-column ng-if="!formState.viewForm && application.canEdit"> <a ng-click="editInformalLearning(record.id)">{{\'main.button.change\' | translate}}</a> </th> <th md-column colspan="{{informalLearningColspan}}" style="text-align: center">{{\'apel.informalLearnings.substitutableModulesThemes\' | translate}}</th> <th md-column style="border-left: 1px rgba(0, 0, 0, 0.12) solid"></th> <th md-column colspan="5" style="text-align: center">{{\'apel.informalLearnings.vocationalOtherInformalLearnings\' | translate}}</th> </tr> <tr md-row> <th md-column ng-if="application.status !== \'VOTA_STAATUS_K\'">{{\'apel.informalLearnings.transfer\' | translate}}</th> <th md-column>{{\'apel.informalLearnings.module\' | translate}}/{{\'apel.informalLearnings.theme\' | translate}}</th> <th md-column>{{\'apel.informalLearnings.isModule\' | translate}}</th> <th md-column>{{\'apel.informalLearnings.hours\' | translate}}/{{\'apel.informalLearnings.ekap\' | translate}}</th> <th md-column>{{\'apel.informalLearnings.result\' | translate}}</th> <th md-column>{{\'apel.informalLearnings.outcomes\' | translate}}</th> <th md-column>{{\'apel.informalLearnings.acquiredSkills\' | translate}}</th> <th md-column style="border-left: 1px rgba(0, 0, 0, 0.12) solid"></th> <th md-column>{{\'apel.informalLearnings.name\' | translate}}</th> <th md-column>{{\'apel.informalLearnings.placeTime\' | translate}}</th> <th md-column>{{\'apel.informalLearnings.hours\' | translate}}</th> <th md-column>{{\'apel.informalLearnings.documents\' | translate}}</th> <th md-column>{{\'apel.informalLearnings.type\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in record.data | orderBy:\'moduleId\'" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell ng-if="application.status !== \'VOTA_STAATUS_K\'"> <md-checkbox ng-if="(row.transfer === false || row.transfer === true) && canChangeTransferStatus" ng-model="row.transfer" ng-click="changeInformalTransferStatus(row)" aria-label="{{\'apel.informalLearnings.transfer\' | translate}}"></md-checkbox> <md-checkbox ng-if="(row.transfer === false || row.transfer === true) && !canChangeTransferStatus" ng-model="row.transfer" ng-click="changeInformalTransferStatus(row)" aria-label="{{\'apel.informalLearnings.transfer\' | translate}}" ng-disabled="true"></md-checkbox> </td> <td md-cell> <span ng-if="row.module && row.isModule">{{currentLanguageNameField(row.module)}}</span> <span ng-if="row.module && !row.isModule">{{currentLanguageNameField(row.module)}}/{{currentLanguageNameField(row.theme)}}</span> </td> <td md-cell> <md-checkbox ng-if="row.isModule === true || row.isModule === false" ng-model="row.isModule" aria-label="{{\'apel.informalLearnings.isModule\' | translate}}" ng-disabled="true"></md-checkbox> </td> <td ng-if="row.ekap" md-cell>{{row.schoolResultHours}}/{{row.ekap}}</td> <td ng-if="!row.ekap" md-cell>{{row.schoolResultHours}}</td> <td md-cell>{{row.grade.value}}</td> <td md-cell> <ul ng-repeat="outcome in row.outcomes | orderBy: [\'curriculumModuleOutcomes.orderNr\', \'curriculumModuleOutcomes.\' + currentLanguage() === \'en\' ? outcomeEn : outcomeEt]" style="padding-left: 15px"> <li>{{currentLanguage() === \'en\' ? outcome.curriculumModuleOutcomes.outcomeEn : outcome.curriculumModuleOutcomes.outcomeEt}}</li> </ul> </td> <td md-cell>{{row.skills}}</td> <td md-cell style="border-left: 1px rgba(0, 0, 0, 0.12) solid"></td> <td md-cell>{{row.nameEt}}</td> <td md-cell>{{row.placeTime}}</td> <td md-cell>{{row.hours}}</td> <td md-cell>{{row.documents}}</td> <td md-cell> <hois-classifier-value ng-model="row.type" main-classifier-code="VOTA_INFORMAAL_LIIK"></hois-classifier-value> </td> </tr> </tbody> </table> </md-table-container>'),a.put("apelApplication/templates/apel.application.information.html",'<div class="form-readonly"> <div flex> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label>{{\'apel.student\' | translate}}</label> <hois-value value="application.person.firstname + \' \' + application.person.lastname"></hois-value> </md-input-container> <md-input-container flex="45" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label ng-if="application.isVocational">{{\'apel.curriculumVersionVocational\' | translate}}</label> <label ng-if="!application.isVocational">{{\'apel.curriculumVersionHigher\' | translate}}</label> <hois-value value="currentLanguageNameField(application.curriculumVersion)"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="20" flex-sm="100" flex-xs="100"> <label>{{\'apel.insertedDate\' | translate}}</label> <hois-value value="application.inserted | hoisDate"></hois-value> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'apel.inserter\' | translate}}</label> <hois-value value="application.insertedBy"></hois-value> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'apel.confirmedDate\' | translate}}</label> <hois-value value="application.confirmed | hoisDate"></hois-value> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'apel.confirmer\' | translate}}</label> <hois-value value="application.confirmedBy"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label>{{\'apel.status\' | translate}}</label> <hois-classifier-value ng-model="application.status" main-classifier-code="VOTA_STAATUS"></hois-classifier-value> </md-input-container> </div> </div> </div>'),a.put("apelApplication/templates/comment.edit.dialog.html",'<md-dialog aria-label="comment edit dialog" flex="50" flex-sm="50" flex-xs="100"> <form name="dialogForm" novalidate ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2>{{"apel.addInfo.add" | translate}}</h2> <span flex></span> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <span flex></span> <div class="ois-form-layout" layout="column" layout-margin ng-cloak> <div layout="column" flex> <md-input-container flex> <label>{{\'apel.addInfo.label\' | translate}}</label> <textarea ng-model="comment.addInfo" md-maxlength="4000" max-rows="5" required md-autofocus></textarea> </md-input-container> </div> </div> </md-dialog-content> <span flex></span> <md-dialog-actions layout="row" layout-align="start center"> <md-button class="md-raised" ng-click="submit()">{{"main.button.save" | translate}}</md-button> <md-button class="md-raised" ng-click="cancel()">{{"main.button.close" | translate}}</md-button> </md-dialog-actions> </form> </md-dialog>'),a.put("apelApplication/templates/formal.learning.higher.edit.dialog.html",'<md-dialog aria-label="formal learning edit dialog" flex="60" flex-sm="80" flex-xs="100"> <form name="dialogForm" ng-submit="dialogForm.$valid && submitHigherFormalLearning()" novalidate ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2>{{"apel.formalLearnings.add" | translate}}</h2> <span flex></span> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <div layout-padding> <fieldset> <legend ng-class="{invalid: dialogForm.$submitted && (!record.formalSubjectsOrModules || record.formalSubjectsOrModules.length === 0)}" class="md-title-small">{{\'apel.formalLearnings.transferableSubjects\' | translate}}</legend> <md-input-container> <md-button ng-click="addNewTransferableSubjectOrModule()" class="md-raised">{{\'main.button.addNewRow\' | translate}}</md-button> </md-input-container> <div ng-if="record.newTransferableSubjectOrModule"> <div layout="row" layout-xs="column" flex> <div flex="100"> <div class="form-readonly" layout="row" layout-sm="column" layout-xs="column"> <md-input-container> <md-radio-group layout-gt-sm="row" ng-model="formState.isMySchool"> <md-radio-button ng-value="true" aria-label="iternalTransfer"> {{\'apel.formalLearnings.iternalTransfer\' | translate}} </md-radio-button> <md-radio-button ng-value="false" aria-label="externalTransfer"> {{\'apel.formalLearnings.externalTransfer\' | translate}} </md-radio-button> </md-radio-group> </md-input-container> </div> <div ng-if="formState.isMySchool" layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label>{{\'apel.formalLearnings.schoolNameEt\' | translate}}</label> <input type="text" ng-model="record.school.nameEt" disabled required> </md-input-container> <md-input-container flex="45" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'apel.formalLearnings.schoolNameEn\' | translate}}</label> <input type="text" ng-model="record.school.nameEn" disabled> </md-input-container> </div> <div ng-if="!formState.isMySchool && !formState.isNewSchool" layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label>{{\'apel.formalLearnings.schoolNameEt\' | translate}}</label> <md-select ng-model="record.newTransferableSubjectOrModule.apelSchool" ng-model-options="{trackBy: \'$value.id\'}" ng-change="apelSchoolChanged(record.newTransferableSubjectOrModule.apelSchool)" aria-label="apelSchool" required> <md-option ng-repeat="val in apelSchools" ng-value="val">{{currentLanguageNameField(val)}}</md-option> </md-select> </md-input-container> <md-input-container flex="45" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'apel.formalLearnings.schoolCountry\' | translate}}</label> <input type="text" value="{{currentLanguageNameField(record.newTransferableSubjectOrModule.country)}}" disabled required> </md-input-container> </div> <div ng-if="!formState.isMySchool"> <md-input-container ng-if="!formState.isNewSchool"> <md-button ng-click="addNewSchool()" class="md-raised">{{\'apel.formalLearnings.addNewSchool\' | translate}}</md-button> </md-input-container> <fieldset ng-if="formState.isNewSchool"> <legend class="md-title-small">{{\'apel.formalLearnings.newSchool\' | translate}}</legend> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label>{{\'apel.formalLearnings.schoolCountry\' | translate}}</label> <hois-classifier-select ng-model="record.newTransferableSubjectOrModule.newApelSchool.country" aria-label="country" model-value-attr="code" main-classifier-code="RIIK" ng-change="newSchoolCountryChanged(record.newTransferableSubjectOrModule.newApelSchool.country)" required></hois-classifier-select> </md-input-container> <md-input-container ng-if="newSchoolEst" flex="45" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'apel.formalLearnings.schoolEHIS\' | translate}}</label> <hois-classifier-select ng-model="record.newTransferableSubjectOrModule.newApelSchool.ehisSchool" aria-label="EHIS" model-value-attr="code" main-classifier-code="EHIS_KOOL" ng-change="ehisSchoolChanged(record.newTransferableSubjectOrModule.newApelSchool.ehisSchool)" filter-values="apelSchoolsEhisCodes()" required></hois-classifier-select> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container ng-if="record.newTransferableSubjectOrModule.newApelSchool.country" flex="45" flex-sm="100" flex-xs="100"> <label>{{\'apel.formalLearnings.schoolNameEt\' | translate}}</label> <input type="text" ng-model="record.newTransferableSubjectOrModule.newApelSchool.nameEt" ng-disabled="formState.isMySchool" md-maxlength="100" required> </md-input-container> <md-input-container ng-if="record.newTransferableSubjectOrModule.newApelSchool.country" flex="45" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'apel.formalLearnings.schoolNameEn\' | translate}}</label> <input type="text" ng-model="record.newTransferableSubjectOrModule.newApelSchool.nameEn" ng-disabled="formState.isMySchool" md-maxlength="100"> </md-input-container> </div> <md-button class="md-raised" ng-click="cancelCreatingNewSchool()">{{\'main.button.annul\' | translate}}</md-button> </fieldset> </div> <div ng-if="formState.isMySchool" layout="row" layout-sm="column" layout-xs="column"> <md-input-container> <md-radio-group layout-gt-sm="row" ng-model="record.newTransferableSubjectOrModule.type" ng-change="typeChanged(record.newTransferableSubjectOrModule.type)" required> <md-radio-button value="VOTA_AINE_LIIK_V" aria-label="passedSubject"> {{\'apel.formalLearnings.passedSubject\' | translate}} </md-radio-button> <md-radio-button value="VOTA_AINE_LIIK_O" aria-label="curriculumSubject"> {{\'apel.formalLearnings.curriculumSubject\' | translate}} </md-radio-button> <md-radio-button value="VOTA_AINE_LIIK_M" aria-label="otherSubject"> {{\'apel.formalLearnings.otherSubject\' | translate}} </md-radio-button> </md-radio-group> </md-input-container> </div> <div ng-if="formState.isMySchool" layout="row" layout-sm="column" layout-xs="column"> <md-input-container ng-if="record.newTransferableSubjectOrModule.type !== \'VOTA_AINE_LIIK_M\'" flex="45" flex-sm="100" flex-xs="100"> <label>{{\'apel.formalLearnings.transferableSubjectEt\' | translate}}</label> <md-select ng-model="record.newTransferableSubjectOrModule.subject" aria-label="subject" ng-change="subjectChanged(record.newTransferableSubjectOrModule.subject)" ng-model-options="{trackBy: \'$value.id\'}" required> <md-option ng-repeat="val in transferableSubjects" ng-value="val">{{currentLanguageNameField(val)}}</md-option> </md-select> </md-input-container> <hois-autocomplete ng-if="record.newTransferableSubjectOrModule.type === \'VOTA_AINE_LIIK_M\'" flex="45" flex-sm="100" flex-xs="100" ng-model="record.newTransferableSubjectOrModule.subject" method="subjects" name="subject" label="apel.formalLearnings.transferableSubjectEt" additional-query-params="{student: student.id, curriculumSubjects: false, curriculumVersion: curriculumVersionId, withCredits: false}" md-selected-item-change="subjectChanged(record.newTransferableSubjectOrModule.subject)" ng-model-options="{ debounce: 500 }" required> </hois-autocomplete> <md-input-container flex="45" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'apel.formalLearnings.transferableSubjectEn\' | translate}}</label> <input type="text" value="{{record.newTransferableSubjectOrModule.subject.nameEn}}" disabled required> </md-input-container> </div> <div ng-if="!formState.isMySchool" layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label>{{\'apel.formalLearnings.transferableSubjectEt\' | translate}}</label> <input type="text" ng-model="record.newTransferableSubjectOrModule.nameEt" md-maxlength="255" required> </md-input-container> <md-input-container flex="45" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'apel.formalLearnings.transferableSubjectEn\' | translate}}</label> <input type="text" ng-model="record.newTransferableSubjectOrModule.nameEn" md-maxlength="255" required> </md-input-container> </div> <div ng-if="formState.isMySchool" layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label>{{\'apel.formalLearnings.subjectCode\' | translate}}</label> <input type="text" value="{{record.newTransferableSubjectOrModule.subjectCode}}" disabled> </md-input-container> <md-input-container flex="45" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'apel.formalLearnings.subjectCredits\' | translate}} ({{\'apel.formalLearnings.EAP\' | translate}})</label> <input type="text" value="{{record.newTransferableSubjectOrModule.credits}}" disabled required> </md-input-container> </div> <div ng-if="!formState.isMySchool" layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label>{{\'apel.formalLearnings.subjectCode\' | translate}}</label> <input type="text" ng-model="record.newTransferableSubjectOrModule.subjectCode" md-maxlength="20"> </md-input-container> <md-input-container flex="45" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'apel.formalLearnings.subjectCredits\' | translate}} ({{\'apel.formalLearnings.EAP\' | translate}})</label> <input type="number" ng-model="record.newTransferableSubjectOrModule.credits" ng-min="0" ng-max="999.9" required> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container ng-if="formState.isMySchool" flex="45" flex-sm="100" flex-xs="100"> <label>{{\'apel.formalLearnings.assessmentType\' | translate}}</label> <input ng-if="formState.isMySchool" value="{{currentLanguageNameField(record.assessment)}}" disabled> </md-input-container> <md-input-container ng-if="!formState.isMySchool" flex="45" flex-sm="100" flex-xs="100"> <label>{{\'apel.formalLearnings.assessmentType\' | translate}}</label> <hois-classifier-select ng-model="record.newTransferableSubjectOrModule.assessment" aria-label="assessment" model-value-attr="code" main-classifier-code="HINDAMISVIIS" ng-change="assessmentTypeChanged(record.newTransferableSubjectOrModule.assessment)" required></hois-classifier-select> </md-input-container> <md-input-container ng-if="record.newTransferableSubjectOrModule.type !== \'VOTA_AINE_LIIK_V\'" flex="45" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'apel.formalLearnings.result\' | translate}}</label> <hois-select ng-model="record.newTransferableSubjectOrModule.grade" values="grades" value-property="code" hide-values="hideInvalid" show-property="{{auth.school.letterGrades ? \'value2\' : \'value\'}}" aria-label="grade" required></hois-select> </md-input-container> <md-input-container ng-if="record.newTransferableSubjectOrModule.type === \'VOTA_AINE_LIIK_V\'" flex="45" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'apel.formalLearnings.result\' | translate}}</label> <input value="{{gradeValue(record.newTransferableSubjectOrModule.grade)}}" disabled> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container ng-if="record.newTransferableSubjectOrModule.type !== \'VOTA_AINE_LIIK_V\'" flex="45" flex-sm="100" flex-xs="100"> <label>{{\'apel.formalLearnings.resultDate\' | translate}}</label> <md-datepicker ng-model="record.newTransferableSubjectOrModule.gradeDate" md-max-date="currentDate" md-open-on-focus></md-datepicker> </md-input-container> <md-input-container ng-if="record.newTransferableSubjectOrModule.type === \'VOTA_AINE_LIIK_V\'" flex="45" flex-sm="100" flex-xs="100"> <label>{{\'apel.formalLearnings.resultDate\' | translate}}</label> <input value="{{record.newTransferableSubjectOrModule.gradeDate | hoisDate}}" disabled> </md-input-container> <md-input-container ng-if="record.newTransferableSubjectOrModule.type === \'VOTA_AINE_LIIK_V\'" flex="45" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{auth.higher ? (\'apel.formalLearnings.teachersHigher\' | translate) : (\'apel.formalLearnings.teachersVocational\' | translate)}}</label> <input type="text" value="{{record.newTransferableSubjectOrModule.teachers}}" disabled> </md-input-container> <md-input-container ng-if="record.newTransferableSubjectOrModule.type !== \'VOTA_AINE_LIIK_V\'" flex="45" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{auth.higher ? (\'apel.formalLearnings.teachersHigher\' | translate) : (\'apel.formalLearnings.teachersVocational\' | translate)}}</label> <input type="text" ng-model="record.newTransferableSubjectOrModule.teachers" md-maxlength="255"> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label>{{\'apel.formalLearnings.module\' | translate}}</label> <md-select ng-model="record.newTransferableSubjectOrModule.curriculumVersionHmodule" aria-label="module" ng-model-options="{trackBy: \'$value.id\'}" required> <md-option ng-repeat="val in curriculumModules" ng-value="val">{{currentLanguageNameField(val)}}</md-option> </md-select> </md-input-container> <md-input-container flex="45" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <md-checkbox ng-model="record.newTransferableSubjectOrModule.isOptional" ng-true-value="false" ng-false-value="true" aria-label="required"> {{\'apel.formalLearnings.required\' | translate}} </md-checkbox> </md-input-container> </div> </div> </div> <md-button ng-if="record.newTransferableSubjectOrModule.isNew" class="md-raised" ng-click="addTransferableSubjectOrModule()">{{\'main.button.add\' | translate}}</md-button> <md-button ng-if="!record.newTransferableSubjectOrModule.isNew" class="md-raised" ng-click="changeTransferableSubjectOrModule()">{{\'main.button.edit\' | translate}}</md-button> <md-button class="md-raised" ng-click="deleteTransferableSubjectOrModule()"> {{\'apel.formalLearnings.remove\' | translate}}</md-button> </div> <md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'apel.formalLearnings.school\' | translate}}</th> <th md-column>{{\'apel.formalLearnings.subjectEt\' | translate}}/{{\'apel.formalLearnings.subjectEn\' | translate}}</th> <th md-column>{{\'apel.formalLearnings.creditsEAP\' | translate}}</th> <th md-column>{{\'apel.formalLearnings.result\' | translate}}</th> <th md-column>{{\'apel.formalLearnings.resultDate\' | translate}}</th> <th md-column>{{\'apel.formalLearnings.teachersHigher\' | translate}}</th> <th md-column>{{\'apel.formalLearnings.module\' | translate}} ({{\'apel.formalLearnings.required\' | translate}})</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in record.formalSubjectsOrModules track by $index" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell ng-if="row.apelSchool">{{currentLanguageNameField(row.apelSchool)}}</td> <td md-cell ng-if="!row.apelSchool && !row.newApelSchool">{{currentLanguageNameField(record.school)}}</td> <td md-cell ng-if="row.newApelSchool && !row.apelSchool">{{currentLanguageNameField(row.newApelSchool)}}</td> <td md-cell ng-if="row.subject && !row.subject.nameEn">{{row.subject.nameEt}}</td> <td md-cell ng-if="row.subject && row.subject.nameEn">{{row.subject.nameEt}}/{{row.subject.nameEn}}</td> <td md-cell ng-if="!row.subject && !row.nameEn">{{row.nameEt}}</td> <td md-cell ng-if="!row.subject && row.nameEn">{{row.nameEt}}/{{row.nameEn}}</td> <td md-cell>{{row.credits}}</td> <td md-cell>{{auth.school.letterGrades ? row.grade.value2 : row.grade.value}}</td> <td md-cell>{{row.gradeDate | hoisDate}}</td> <td md-cell>{{row.teachers}}</td> <td md-cell>{{currentLanguageNameField(row.module)}} ({{row.isOptional ? \'main.no\' : \'main.yes\' | translate}})</td> <td md-cell> <md-button md-no-ink class="md-primary change-button" ng-click="editTransferableSubjectOrModule($index)">{{\'main.button.change\' | translate}}</md-button> </td> </tr> </tbody> </table> </md-table-container> </fieldset> <br> <fieldset> <legend ng-class="{invalid: areReplacedSubjectsOrModulesInvalid()}" class="md-title-small">{{\'apel.formalLearnings.substitutableSubjects\' | translate}}</legend> <div flex="50"> <md-input-container style="width: 100%"> <label>{{\'apel.formalLearnings.substitutableSubject\' | translate}}</label> <md-select ng-model="selectedSubject" aria-label="substitutableSubjects" ng-change="addSelectedSubject()"> <md-option ng-repeat="val in subjects" ng-value="val">{{currentLanguageNameField(val)}}</md-option> </md-select> </md-input-container> <md-table-container> <table md-table class="secondary-table"> <tbody md-body> <tr md-row ng-repeat="replacedSubject in record.formalReplacedSubjectsOrModules" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell> <span ng-if="replacedSubject.id"> {{replacedSubject.subject.code}} - {{currentLanguageNameField(replacedSubject.subject)}} ({{replacedSubject.subject.credits}} {{\'apel.formalLearnings.EAP\' | translate}}) </span> <span ng-if="!replacedSubject.id">{{currentLanguageNameField(replacedSubject.subject)}}</span> </td> <td md-cell> <a class="remove nomargin" ng-click="removeSubtitutableSubject(replacedSubject)">&times;</a> </td> </tr> </tbody> </table> </md-table-container> </div> </fieldset> </div> </md-dialog-content> <md-dialog-actions layout="row" layout-align="start center"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.save\' | translate}}</md-button> <md-button ng-if="record.id" ng-click="delete()" class="md-raised">{{\'main.button.delete\' | translate}}</md-button> <md-button ng-click="cancel()" class="md-raised">{{\'main.button.close\' | translate}}</md-button> </md-dialog-actions> </form> </md-dialog>'),
a.put("apelApplication/templates/formal.learning.vocational.edit.dialog.html",'<md-dialog aria-label="formal learning edit dialog" flex="80" flex-sm="80" flex-xs="100"> <form name="dialogForm" ng-submit="dialogForm.$valid && submitVocationalFormalLearning()" novalidate ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2>{{"apel.formalLearnings.add" | translate}}</h2> <span flex></span> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <div layout-padding> <fieldset> <legend ng-class="{invalid: dialogForm.$submitted && (!record.formalSubjectsOrModules || record.formalSubjectsOrModules.length === 0)}" class="md-title-small">{{\'apel.formalLearnings.transferableModules\' | translate}}</legend> <md-input-container> <md-button ng-click="addNewTransferableSubjectOrModule()" class="md-raised">{{\'main.button.addNewRow\' | translate}}</md-button> </md-input-container> <div ng-if="record.newTransferableSubjectOrModule"> <div layout="row" layout-xs="column" flex> <div flex="100"> <div class="form-readonly" layout="row" layout-sm="column" layout-xs="column"> <md-input-container> <md-radio-group layout-gt-sm="row" ng-model="formState.isMySchool"> <md-radio-button ng-value="true" aria-label="iternalTransfer"> {{\'apel.formalLearnings.iternalTransfer\' | translate}} </md-radio-button> <md-radio-button ng-value="false" aria-label="externalTransfer"> {{\'apel.formalLearnings.externalTransfer\' | translate}} </md-radio-button> </md-radio-group> </md-input-container> </div> <div ng-if="formState.isMySchool" layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="30" flex-sm="100" flex-xs="100"> <label>{{\'apel.formalLearnings.schoolNameEt\' | translate}}</label> <input type="text" ng-model="record.school.nameEt" disabled required> </md-input-container> <md-input-container flex="30" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'apel.formalLearnings.schoolNameEn\' | translate}}</label> <input type="text" ng-model="record.school.nameEn" disabled> </md-input-container> </div> <div ng-if="!formState.isMySchool && !formState.isNewSchool" layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="30" flex-sm="100" flex-xs="100"> <label>{{\'apel.formalLearnings.schoolNameEt\' | translate}}</label> <md-select ng-model="record.newTransferableSubjectOrModule.apelSchool" aria-label="apelSchool" ng-change="apelSchoolChanged(record.newTransferableSubjectOrModule.apelSchool)" ng-model-options="{trackBy: \'$value.id + $value.nameEt\'}" required> <md-option ng-repeat="val in apelSchools" ng-value="val">{{currentLanguageNameField(val)}}</md-option> </md-select> </md-input-container> <md-input-container flex="30" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'apel.formalLearnings.schoolCountry\' | translate}}</label> <input type="text" value="{{currentLanguageNameField(record.newTransferableSubjectOrModule.country)}}" disabled required> </md-input-container> </div> <div ng-if="!formState.isMySchool"> <md-input-container ng-if="!formState.isNewSchool"> <md-button ng-click="addNewSchool()" class="md-raised">{{\'apel.formalLearnings.addNewSchool\' | translate}}</md-button> </md-input-container> <fieldset ng-if="formState.isNewSchool"> <legend class="md-title-small">{{\'apel.formalLearnings.newSchool\' | translate}}</legend> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="30" flex-sm="100" flex-xs="100"> <label>{{\'apel.formalLearnings.schoolCountry\' | translate}}</label> <hois-classifier-select ng-model="record.newTransferableSubjectOrModule.newApelSchool.country" aria-label="country" model-value-attr="code" main-classifier-code="RIIK" ng-change="newSchoolCountryChanged(record.newTransferableSubjectOrModule.newApelSchool.country)" required></hois-classifier-select> </md-input-container> <md-input-container ng-if="newSchoolEst" flex="30" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'apel.formalLearnings.schoolEHIS\' | translate}}</label> <hois-classifier-select ng-model="record.newTransferableSubjectOrModule.newApelSchool.ehisSchool" aria-label="EHIS" model-value-attr="code" main-classifier-code="EHIS_KOOL" ng-change="ehisSchoolChanged(record.newTransferableSubjectOrModule.newApelSchool.ehisSchool)" filter-values="apelSchoolsEhisCodes()" required></hois-classifier-select> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container ng-if="record.newTransferableSubjectOrModule.newApelSchool.country" flex="30" flex-sm="100" flex-xs="100"> <label>{{\'apel.formalLearnings.schoolNameEt\' | translate}}</label> <input type="text" ng-model="record.newTransferableSubjectOrModule.newApelSchool.nameEt" ng-disabled="formState.isMySchool" md-maxlength="100" required> </md-input-container> <md-input-container ng-if="record.newTransferableSubjectOrModule.newApelSchool.country" flex="30" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'apel.formalLearnings.schoolNameEn\' | translate}}</label> <input type="text" ng-model="record.newTransferableSubjectOrModule.newApelSchool.nameEn" ng-disabled="formState.isMySchool" md-maxlength="100"> </md-input-container> </div> <md-button class="md-raised" ng-click="cancelCreatingNewSchool()">{{\'main.button.annul\' | translate}}</md-button> </fieldset> </div> <div ng-if="formState.isMySchool" layout="row" layout-sm="column" layout-xs="column"> <md-input-container> <md-radio-group layout-gt-sm="row" ng-model="record.newTransferableSubjectOrModule.type" ng-change="typeChanged(record.newTransferableSubjectOrModule.type)" required> <md-radio-button value="VOTA_AINE_LIIK_V" aria-label="passedModule"> {{\'apel.formalLearnings.passedModule\' | translate}} </md-radio-button> <md-radio-button value="VOTA_AINE_LIIK_O" aria-label="curriculumModule"> {{\'apel.formalLearnings.curriculumModule\' | translate}} </md-radio-button> <md-radio-button value="VOTA_AINE_LIIK_M" aria-label="otherModule"> {{\'apel.formalLearnings.otherModule\' | translate}} </md-radio-button> </md-radio-group> </md-input-container> </div> <div ng-if="formState.isMySchool" layout="row" layout-sm="column" layout-xs="column"> <md-input-container ng-if="record.newTransferableSubjectOrModule.type !== \'VOTA_AINE_LIIK_M\'" flex="30" flex-sm="100" flex-xs="100"> <label>{{\'apel.formalLearnings.transferableModuleEt\' | translate}}</label> <md-select ng-model="record.newTransferableSubjectOrModule.curriculumVersionOmodule" aria-label="module" ng-change="moduleChanged(record.newTransferableSubjectOrModule.curriculumVersionOmodule)" ng-model-options="{trackBy: \'$value.id\'}" required> <md-option ng-repeat="val in transferableModules" ng-value="val">{{currentLanguageNameField(val)}}</md-option> </md-select> </md-input-container> <hois-autocomplete ng-if="record.newTransferableSubjectOrModule.type === \'VOTA_AINE_LIIK_M\'" flex ng-model="record.newTransferableSubjectOrModule.curriculumVersionOmodule" method="curriculumversionomodules" name="module" label="apel.formalLearnings.transferableModuleEt" md-selected-item-change="moduleChanged(record.newTransferableSubjectOrModule.curriculumVersionOmodule)" additional-query-params="{student: student.id, curriculumModules: false, curriculumVersion: curriculumVersionId}" ng-model-options="{ debounce: 500 }" required> </hois-autocomplete> <md-input-container flex="30" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'apel.formalLearnings.transferableModuleEn\' | translate}}</label> <input type="text" value="{{record.newTransferableSubjectOrModule.curriculumVersionOmodule.nameEn}}" disabled required> </md-input-container> <md-input-container flex="30" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'apel.formalLearnings.moduleCredits\' | translate}} ({{\'apel.formalLearnings.EKAP\' | translate}})</label> <input type="text" value="{{record.newTransferableSubjectOrModule.credits}}" disabled required> </md-input-container> </div> <div ng-if="!formState.isMySchool" layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="30" flex-sm="100" flex-xs="100"> <label>{{\'apel.formalLearnings.transferableModuleEt\' | translate}}</label> <input type="text" ng-model="record.newTransferableSubjectOrModule.nameEt" md-maxlength="255" required> </md-input-container> <md-input-container flex="30" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'apel.formalLearnings.transferableModuleEn\' | translate}}</label> <input type="text" ng-model="record.newTransferableSubjectOrModule.nameEn" md-maxlength="255"> </md-input-container> <md-input-container flex="30" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'apel.formalLearnings.moduleCredits\' | translate}} ({{\'apel.formalLearnings.EKAP\' | translate}})</label> <input type="number" ng-model="record.newTransferableSubjectOrModule.credits" ng-min="0" ng-max="999.9" required> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container ng-if="formState.isMySchool" flex="30" flex-sm="100" flex-xs="100"> <label>{{\'apel.formalLearnings.assessmentType\' | translate}}</label> <input value="{{currentLanguageNameField(record.assessment)}}" disabled> </md-input-container> <md-input-container ng-if="!formState.isMySchool" flex="30" flex-sm="100" flex-xs="100"> <label>{{\'apel.formalLearnings.assessmentType\' | translate}}</label> <hois-classifier-select ng-model="record.newTransferableSubjectOrModule.assessment" aria-label="assessment" model-value-attr="code" main-classifier-code="KUTSEHINDAMISVIIS" ng-change="assessmentTypeChanged(record.newTransferableSubjectOrModule.assessment)" required></hois-classifier-select> </md-input-container> <md-input-container ng-if="record.newTransferableSubjectOrModule.type !== \'VOTA_AINE_LIIK_V\'" flex="30" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'apel.formalLearnings.result\' | translate}}</label> <hois-select ng-model="record.newTransferableSubjectOrModule.grade" values="grades" show-property="value" value-property="code" aria-label="grade" required hide-values="hideInvalid"></hois-select> </md-input-container> <md-input-container ng-if="record.newTransferableSubjectOrModule.type === \'VOTA_AINE_LIIK_V\'" flex="30" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'apel.formalLearnings.result\' | translate}}</label> <input value="{{gradeValue(record.newTransferableSubjectOrModule.grade)}}" disabled> </md-input-container> <md-input-container ng-if="record.newTransferableSubjectOrModule.type !== \'VOTA_AINE_LIIK_V\'" flex="30" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'apel.formalLearnings.resultDate\' | translate}}</label> <md-datepicker ng-model="record.newTransferableSubjectOrModule.gradeDate" md-max-date="currentDate" md-open-on-focus></md-datepicker> </md-input-container> <md-input-container ng-if="record.newTransferableSubjectOrModule.type === \'VOTA_AINE_LIIK_V\'" flex="30" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'apel.formalLearnings.resultDate\' | translate}}</label> <input value="{{record.newTransferableSubjectOrModule.gradeDate | hoisDate}}" disabled> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container ng-if="record.newTransferableSubjectOrModule.type === \'VOTA_AINE_LIIK_V\'" flex="30" flex-sm="100" flex-xs="100"> <label>{{auth.higher ? (\'apel.formalLearnings.teachersHigher\' | translate) : (\'apel.formalLearnings.teachersVocational\' | translate)}}</label> <input type="text" value="{{record.newTransferableSubjectOrModule.teachers}}" disabled> </md-input-container> <md-input-container ng-if="record.newTransferableSubjectOrModule.type !== \'VOTA_AINE_LIIK_V\'" flex="30" flex-sm="100" flex-xs="100"> <label>{{auth.higher ? (\'apel.formalLearnings.teachersHigher\' | translate) : (\'apel.formalLearnings.teachersVocational\' | translate)}}</label> <input type="text" ng-model="record.newTransferableSubjectOrModule.teachers" md-maxlength="255"> </md-input-container> </div> </div> </div> <md-button ng-if="record.newTransferableSubjectOrModule.isNew" class="md-raised" ng-click="addTransferableSubjectOrModule()">{{\'main.button.add\' | translate}}</md-button> <md-button ng-if="!record.newTransferableSubjectOrModule.isNew" class="md-raised" ng-click="changeTransferableSubjectOrModule()">{{\'main.button.edit\' | translate}}</md-button> <md-button class="md-raised" ng-click="deleteTransferableSubjectOrModule()"> {{\'apel.formalLearnings.remove\' | translate}}</md-button> </div> <md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'apel.formalLearnings.school\' | translate}}</th> <th md-column>{{\'apel.formalLearnings.module\' | translate}}/{{\'apel.formalLearnings.moduleEn\' | translate}}</th> <th md-column>{{\'apel.formalLearnings.creditsEKAP\' | translate}}</th> <th md-column>{{\'apel.formalLearnings.result\' | translate}}</th> <th md-column>{{\'apel.formalLearnings.resultDate\' | translate}}</th> <th md-column>{{auth.higher ? (\'apel.formalLearnings.teachersHigher\' | translate) : (\'apel.formalLearnings.teachersVocational\' | translate)}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in record.formalSubjectsOrModules track by $index" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell ng-if="row.apelSchool">{{currentLanguageNameField(row.apelSchool)}}</td> <td md-cell ng-if="!row.apelSchool && !row.newApelSchool">{{currentLanguageNameField(record.school)}}</td> <td md-cell ng-if="row.newApelSchool && !row.apelSchool">{{currentLanguageNameField(row.newApelSchool)}}</td> <td md-cell ng-if="row.module && !row.module.nameEn">{{row.module.nameEt}}</td> <td md-cell ng-if="row.module && row.module.nameEn">{{row.module.nameEt}}/{{row.module.nameEn}}</td> <td md-cell ng-if="!row.module && !row.nameEn">{{row.nameEt}}</td> <td md-cell ng-if="!row.module && row.nameEn">{{row.nameEt}}/{{row.nameEn}}</td> <td md-cell>{{row.credits}}</td> <td md-cell>{{row.grade.value}}</td> <td md-cell>{{row.gradeDate | hoisDate}}</td> <td md-cell>{{row.teachers}}</td> <td md-cell> <md-button md-no-ink class="md-primary change-button" ng-click="editTransferableSubjectOrModule($index)">{{\'main.button.change\' | translate}}</md-button> </td> </tr> </tbody> </table> </md-table-container> </fieldset> <br> <fieldset> <legend ng-class="{invalid: areReplacedSubjectsOrModulesInvalid()}" class="md-title-small">{{\'apel.formalLearnings.substitutableModulesThemes\' | translate}}</legend> <div flex="50"> <md-input-container style="width: 100%"> <label>{{\'apel.formalLearnings.module\' | translate}}/{{\'apel.formalLearnings.theme\' | translate}}</label> <md-select ng-model="selectedModuleOrTheme" aria-label="substitutable modules/themes" ng-change="formalSelectedModuleOrThemeChanged()"> <md-option ng-repeat="val in modulesAndThemes" ng-value="val"> <span ng-style="{\'font-weight\': val.isModule ? 600 : 400}">{{currentLanguageNameField(val)}}</span> </md-option> </md-select> </md-input-container> </div> <md-table-container> <table md-table md-progress="tabledata.$promise" class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'apel.formalLearnings.module\' | translate}}/{{\'apel.formalLearnings.theme\' | translate}}</th> <th md-column>{{\'apel.formalLearnings.isModule\' | translate}}</th> <th md-column>{{\'apel.formalLearnings.creditsEKAP\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="themeOrModule in record.formalReplacedSubjectsOrModules" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell> <md-input-container> <hois-value ng-if="themeOrModule.isModule" value="currentLanguageNameField(themeOrModule.curriculumVersionOmodule)"></hois-value> <hois-value ng-if="!themeOrModule.isModule" value="currentLanguageNameField(themeOrModule.curriculumVersionOmodule) + \'/\' + currentLanguageNameField(themeOrModule.curriculumVersionOmoduleTheme)"> </hois-value> </md-input-container> </td> <td md-cell> <md-input-container> <md-checkbox ng-model="themeOrModule.isModule" aria-label="{{\'apel.informalLearnings.isModule\' | translate}}" ng-disabled="true"> </md-checkbox> </md-input-container> </td> <td md-cell> <md-input-container> <hois-value ng-if="themeOrModule.isModule" value="themeOrModule.curriculumVersionOmodule.credits"></hois-value> <hois-value ng-if="!themeOrModule.isModule" value="themeOrModule.curriculumVersionOmoduleTheme.credits"></hois-value> </md-input-container> </td> <td md-cell> <a class="remove nomargin" ng-click="removeSubtitutableModuleTheme(themeOrModule)">&times;</a> </td> </tr> </tbody> </table> </md-table-container> </fieldset> </div> </md-dialog-content> <md-dialog-actions layout="row" layout-align="start center"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.save\' | translate}}</md-button> <md-button ng-if="record.id" ng-click="delete()" class="md-raised">{{\'main.button.delete\' | translate}}</md-button> <md-button ng-click="cancel()" class="md-raised">{{\'main.button.close\' | translate}}</md-button> </md-dialog-actions> </form> </md-dialog>'),a.put("apelApplication/templates/informal.learning.higher.edit.dialog.html",'<md-dialog aria-label="informal learning edit dialog" flex="80" flex-sm="80" flex-xs="100"> <form name="dialogForm" ng-submit="dialogForm.$valid && submitInformalLearning()" novalidate ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2>{{"apel.informalLearnings.add" | translate}}</h2> <span flex></span> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <div layout-padding> <fieldset> <legend ng-class="{invalid: dialogForm.$submitted && (!record.informalExperiences || record.informalExperiences.length === 0)}" class="md-title-small">{{\'apel.informalLearnings.higherOtherInformalLearnings\' | translate}}</legend> <md-button class="md-raised" ng-click="addNewInformalExperienceRow()">{{\'main.button.addNewRow\' | translate}}</md-button> <md-table-container> <table md-table md-progress="tabledata.$promise" class="secondary-table"> <thead md-head> <tr md-row> <th md-column width="20%">{{\'apel.informalLearnings.name\' | translate}}</th> <th md-column width="20%">{{\'apel.informalLearnings.placeTime\' | translate}}</th> <th md-column width="10%">{{\'apel.informalLearnings.hours\' | translate}}</th> <th md-column width="20%">{{\'apel.informalLearnings.documents\' | translate}}</th> <th md-column width="25%">{{\'apel.informalLearnings.type\' | translate}}</th> <th md-column width="5%"></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="experience in record.informalExperiences" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell> <md-input-container> <input ng-model="experience.nameEt" aria-label="nameEt" type="text" md-maxlength="255" required> </md-input-container> </td> <td md-cell> <md-input-container> <input ng-model="experience.placeTime" aria-label="place and time" type="text" md-maxlength="255" required> </md-input-container> </td> <td md-cell> <md-input-container> <input ng-model="experience.hours" aria-label="hours" type="number" ng-min="0" ng-max="9999" required> </md-input-container> </td> <td md-cell> <md-input-container> <textarea ng-model="experience.documents" required md-maxlength="255" max-rows="2" aria-label="documents"></textarea> </md-input-container> </td> <td md-cell> <md-input-container> <hois-classifier-select ng-model="experience.type" aria-label="type" model-value-attr="code" main-classifier-code="VOTA_INFORMAAL_LIIK" md-no-asterisk required></hois-classifier-select> </md-input-container> </td> <td md-cell> <a class="remove nomargin" ng-click="removeInformalExperienceRow(experience)">&times;</a> </td> </tr> </tbody> </table> </md-table-container> </fieldset> <br> <fieldset> <legend ng-class="{invalid: dialogForm.$submitted && (!record.informalSubjectsOrModules || record.informalSubjectsOrModules.length === 0)}" class="md-title-small">{{\'apel.informalLearnings.substitutableSubjects\' | translate}}</legend> <div layout="row" layout-align="start center"> <md-input-container ng-if="!dialogScope.freeChoiceSubjects" flex="45"> <label>{{\'apel.informalLearnings.subject\' | translate}}</label> <md-select ng-model="formState.selectedSubject" aria-label="{{\'apel.informalLearnings.substitutableSubjects\' | translate}}"> <md-option ng-repeat="val in subjects" ng-value="val">{{currentLanguageNameField(val)}}</md-option> </md-select> </md-input-container> <hois-autocomplete ng-if="dialogScope.freeChoiceSubjects" flex="45" ng-model="formState.selectedSubject" method="subjects" name="subject" label="{{\'apel.informalLearnings.subject\' | translate}}" additional-query-params="{student: student.id, curriculumSubjects: false, curriculumVersion: curriculumVersionId, withCredits: false, noFinalSubjects: true}"> </hois-autocomplete> <md-input-container flex-offset="5"> <md-checkbox ng-model="dialogScope.freeChoiceSubjects" aria-label="{{\'apel.informalLearnings.freeChoice\' | translate}}" style="margin-bottom: 0">{{\'apel.informalLearnings.freeChoice\' | translate}}</md-checkbox> </md-input-container> </div> <md-table-container> <table md-table md-progress="tabledata.$promise" class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'apel.informalLearnings.subject\' | translate}}</th> <th md-column>{{\'apel.informalLearnings.module\' | translate}}</th> <th md-column>{{\'apel.informalLearnings.required\' | translate}}</th> <th md-column>{{\'apel.informalLearnings.creditsEAP\' | translate}}</th> <th md-column>{{\'apel.informalLearnings.acquiredSkills\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="subjectOrModule in record.informalSubjectsOrModules" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <ng-form name="subjectOrModuleForm"> <td md-cell> <md-input-container> <hois-value value="currentLanguageNameField(subjectOrModule.subject)"></hois-value> </md-input-container> </td> <td md-cell> <md-input-container> <hois-value value="subjectOrModule.curriculumVersionHmodule ? currentLanguageNameField(subjectOrModule.curriculumVersionHmodule) : (\'apel.informalLearnings.freeChoice\' | translate)"></hois-value> </md-input-container> </td> <td md-cell> <md-input-container> <span ng-if="!subjectOrModule.isOptional">{{\'main.yes\' | translate}}</span> <span ng-if="subjectOrModule.isOptional">{{\'main.no\' | translate}}</span> </md-input-container> </td> <td md-cell> <md-input-container> <hois-value value="subjectOrModule.subject.credits"></hois-value> </md-input-container> </td> <td md-cell> <md-input-container style="width: 100%"> <textarea ng-model="subjectOrModule.skills" required md-maxlength="4000" max-rows="3" aria-label="{{\'apel.informalLearnings.acquiredSkills\' | translate}}"></textarea> </md-input-container> </td> <td md-cell> <a class="remove nomargin" ng-click="removeSubtitutableModuleTheme(subjectOrModule)">&times;</a> </td> </ng-form> </tr> </tbody> </table> </md-table-container> </fieldset> </div> </md-dialog-content> <md-dialog-actions layout="row" layout-align="start center"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.save\' | translate}}</md-button> <md-button ng-if="record.id" ng-click="delete()" class="md-raised">{{\'main.button.delete\' | translate}}</md-button> <md-button ng-click="cancel()" class="md-raised">{{\'main.button.close\' | translate}}</md-button> </md-dialog-actions> </form> </md-dialog>'),a.put("apelApplication/templates/informal.learning.vocational.edit.dialog.html",'<md-dialog aria-label="informal learning edit dialog" flex="80" flex-sm="80" flex-xs="100"> <form name="dialogForm" ng-submit="dialogForm.$valid && submitInformalLearning()" novalidate ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2>{{"apel.informalLearnings.add" | translate}}</h2> <span flex></span> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <div layout-padding> <fieldset> <legend ng-class="{invalid: dialogForm.$submitted && (!record.informalExperiences || record.informalExperiences.length === 0)}" class="md-title-small">{{\'apel.informalLearnings.vocationalOtherInformalLearnings\' | translate}}</legend> <md-button class="md-raised" ng-click="addNewInformalExperienceRow()">{{\'main.button.addNewRow\' | translate}}</md-button> <md-table-container> <table md-table md-progress="tabledata.$promise" class="secondary-table"> <thead md-head> <tr md-row> <th md-column width="20%">{{\'apel.informalLearnings.name\' | translate}}</th> <th md-column width="20%">{{\'apel.informalLearnings.placeTime\' | translate}}</th> <th md-column width="10%">{{\'apel.informalLearnings.hours\' | translate}}</th> <th md-column width="20%">{{\'apel.informalLearnings.documents\' | translate}}</th> <th md-column width="25%">{{\'apel.informalLearnings.type\' | translate}}</th> <th md-column width="5%"></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="experience in record.informalExperiences" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell> <md-input-container> <input ng-model="experience.nameEt" aria-label="nameEt" type="text" md-maxlength="255" required> </md-input-container> </td> <td md-cell> <md-input-container> <input ng-model="experience.placeTime" aria-label="place and time" type="text" md-maxlength="255" required> </md-input-container> </td> <td md-cell> <md-input-container> <input ng-model="experience.hours" aria-label="hours" type="number" ng-min="0" ng-max="9999" required> </md-input-container> </td> <td md-cell> <md-input-container> <textarea ng-model="experience.documents" required md-maxlength="255" max-rows="2" aria-label="documents"></textarea> </md-input-container> </td> <td md-cell> <md-input-container> <hois-classifier-select ng-model="experience.type" aria-label="type" model-value-attr="code" main-classifier-code="VOTA_INFORMAAL_LIIK" md-no-asterisk required></hois-classifier-select> </md-input-container> </td> <td md-cell> <a class="remove nomargin" ng-click="removeInformalExperienceRow(experience)">&times;</a> </td> </tr> </tbody> </table> </md-table-container> </fieldset> <br> <fieldset> <legend ng-class="{invalid: dialogForm.$submitted && (!record.informalSubjectsOrModules || record.informalSubjectsOrModules.length === 0)}" class="md-title-small">{{\'apel.informalLearnings.substitutableModulesThemes\' | translate}}</legend> <div flex="50"> <md-input-container style="width: 100%"> <label>{{\'apel.informalLearnings.module\' | translate}}/{{\'apel.informalLearnings.theme\' | translate}}</label> <md-select ng-model="selectedModuleOrTheme" aria-label="substitutable modules/themes" ng-change="selectedModuleOrThemeChanged()"> <md-option ng-repeat="val in modulesAndThemes" ng-value="val"> <span ng-style="{\'font-weight\': val.isModule ? 600 : 400}">{{currentLanguageNameField(val)}}</span> </md-option> </md-select> </md-input-container> </div> <md-table-container> <table md-table md-progress="tabledata.$promise" class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'apel.informalLearnings.module\' | translate}}/{{\'apel.informalLearnings.theme\' | translate}}</th> <th md-column>{{\'apel.informalLearnings.isModule\' | translate}}</th> <th md-column>{{\'apel.informalLearnings.hours\' | translate}}/{{\'apel.informalLearnings.ekap\' | translate}}</th> <th md-column>{{\'apel.informalLearnings.result\' | translate}}</th> <th md-column>{{\'apel.informalLearnings.outcomes\' | translate}}</th> <th md-column>{{\'apel.informalLearnings.acquiredSkills\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="subjectOrModule in record.informalSubjectsOrModules" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <ng-form name="subjectOrModuleForm"> <td md-cell> <md-input-container> <hois-value ng-if="subjectOrModule.isModule" value="currentLanguageNameField(subjectOrModule.curriculumVersionOmodule)"></hois-value> <hois-value ng-if="!subjectOrModule.isModule" value="currentLanguageNameField(subjectOrModule.curriculumVersionOmodule) + \'/\' + currentLanguageNameField(subjectOrModule.curriculumVersionOmoduleTheme)"> </hois-value> </md-input-container> </td> <td md-cell> <md-input-container> <md-checkbox ng-model="subjectOrModule.isModule" aria-label="{{\'apel.informalLearnings.isModule\' | translate}}" ng-disabled="true"> </md-checkbox> </md-input-container> </td> <td md-cell> <md-input-container> <hois-value ng-if="subjectOrModule.EKAP" value="subjectOrModule.hours.toString() + \'/\' + subjectOrModule.EKAP.toString()"></hois-value> <hois-value ng-if="!subjectOrModule.EKAP" value="subjectOrModule.hours"></hois-value> </md-input-container> </td> <td md-cell> <md-input-container> <hois-value value="subjectOrModule.grade.value"></hois-value> </md-input-container> </td> <td md-cell> <md-input-container ng-repeat="outcome in subjectOrModule.outcomes | orderBy: [\'curriculumModuleOutcomes.orderNr\', \'curriculumModuleOutcomes.\' + currentLanguage() === \'en\' ? outcomeEn : outcomeEt]" layout="row"> <md-checkbox ng-model="outcome.acquired" aria-label="{{\'apel.informalLearnings.outcomes\' | translate}}"></md-checkbox> {{currentLanguage() === \'en\' ? outcome.curriculumModuleOutcomes.outcomeEn : outcome.curriculumModuleOutcomes.outcomeEt}} </md-input-container> </td> <td md-cell style="width: 40%; min-width: 400px"> <md-input-container style="width: 100%"> <textarea ng-model="subjectOrModule.skills" required md-maxlength="4000" max-rows="3" aria-label="{{\'apel.informalLearnings.acquiredSkills\' | translate}}"></textarea> </md-input-container> </td> <td md-cell> <a class="remove nomargin" ng-click="removeSubtitutableModuleTheme(subjectOrModule)">&times;</a> </td> </ng-form> </tr> </tbody> </table> </md-table-container> </fieldset> </div> </md-dialog-content> <md-dialog-actions layout="row" layout-align="start center"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.save\' | translate}}</md-button> <md-button ng-if="record.id" ng-click="delete()" class="md-raised">{{\'main.button.delete\' | translate}}</md-button> <md-button ng-click="cancel()" class="md-raised">{{\'main.button.close\' | translate}}</md-button> </md-dialog-actions> </form> </md-dialog>'),a.put("apelApplication/templates/reason.dialog.html",'<md-dialog aria-label="reason dialog" flex="50" flex-sm="50" flex-xs="100"> <form name="dialogForm" novalidate ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2 ng-if="rejection">{{\'apel.rejection\' | translate}}</h2> <h2 ng-if="sendToConfirm">{{\'apel.sendingToConfirm\' | translate}}</h2> <h2 ng-if="sendBackToCreation">{{\'apel.sendingToCreation\' | translate}}</h2> <span flex></span> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <span flex></span> <div class="ois-form-layout" layout="column" layout-margin ng-cloak> <md-whiteframe ng-if="rejection" class="md-whiteframe-1dp attention-whiteframe" flex="100" layout layout-align="left center"> <div md-colors="{color: \'default-warn\'}"> <md-icon md-colors="{color: \'default-warn\'}" md-font-set="material-icons">info_outline</md-icon> <span>{{\'apel.rejectionWarning\' | translate}}</span> </div> </md-whiteframe> <div layout="column" flex> <md-input-container flex> <label>{{committee ? (\'apel.decision\' | translate) : (\'apel.justification\' | translate)}}</label> <textarea ng-model="reason" md-maxlength="4000" max-rows="5" required md-autofocus></textarea> </md-input-container> </div> </div> </md-dialog-content> <span flex></span> <md-dialog-actions layout="row" layout-align="start center"> <md-button class="md-raised" ng-click="submit()"> <span ng-if="rejection">{{\'main.button.reject\' | translate}}</span> <span ng-if="sendToConfirm">{{\'apel.sendToConfirm\' | translate}}</span> <span ng-if="sendBackToCreation">{{\'apel.sendBackToCreation\' | translate}}</span> </md-button> <md-button class="md-raised" ng-click="cancel()">{{\'main.button.close\' | translate}}</md-button> </md-dialog-actions> </form> </md-dialog>'),
a.put("application/student/application.student.list.html",'<div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="{{currentLanguage()===\'en\' ? \'type.nameEn\' : \'type.nameEt\'}}">{{\'application.type\' | translate}}</th> <th md-column md-order-by="submitted">{{\'application.submissionDate\' | translate}}</th> <th md-column md-order-by="{{currentLanguage()===\'en\' ? \'status.nameEn\' : \'status.nameEt\'}}">{{\'main.status\' | translate}}</th> <th md-column md-order-by="5">{{\'student.application.confirmDate\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell><a ng-href="#/applications/{{::row.id}}/view">{{currentLanguageNameField(row.type)}}</a></td> <td md-cell>{{row.submitted | hoisDate}}</td> <td md-cell> {{currentLanguageNameField(row.status)}} <md-tooltip ng-if="row.status.code === \'AVALDUS_STAATUS_TAGASI\' && row.rejectReason">{{row.rejectReason}}</md-tooltip> </td> <td md-cell>{{row.confirmDate | hoisDate}}</td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> </div> <div layout-padding ng-if="!auth.isParent() || applicationTypesApplicable[\'AVALDUS_LIIK_TUGI\'].isAllowed === true"> <div flex> <md-table-container> <table md-table class="secondary-table" md-progress="applicationTypes.$promise"> <thead md-head> <tr md-row> <th md-column>{{\'application.type\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in applicationTypes" ng-class-odd="\'odd\'" ng-class-even="\'even\'" ng-if="applicationTypesApplicable[row.code] && (!auth.isParent() || (auth.isParent() && row.code === \'AVALDUS_LIIK_TUGI\'))"> <td md-cell>{{currentLanguageNameField(row)}}</td> <td md-cell> <md-button md-no-ink ng-if="applicationTypesApplicable[row.code].isAllowed === true && (auth.isStudent() || (auth.isParent() && row.code === \'AVALDUS_LIIK_TUGI\'))" class="md-primary change-button" ng-href="#/applications/student/new/{{row.code}}"> {{\'main.button.apply\' | translate}} </md-button> </td> </tr> </tbody> </table> </md-table-container> </div> </div>'),a.put("application/student/application.student.new.html",'<div class="ois-form-layout-padding" ng-cloak> <div flex> <form ng-submit="loadData()" layout="column" name="applicationForm" ng-controller="ApplicationController as mainCtrl"> <br> <div ng-include="\'application/templates/application.html\'" ng-init="application=studentApplication"></div> <br> <div layout="row"> <md-button ng-if="application.id" class="md-raised md-primary" ng-click="submit()">{{\'main.button.submit\' | translate}}</md-button> <md-button class="md-raised" ng-click="save()">{{\'main.button.save\' | translate}}</md-button> <md-button ng-href="#/applications/student" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </div> </form> </div> </div>'),a.put("application/templates/action.buttons.html",'<div ng-if="isStudentRepresentative()" layout-xs="column"> <md-button ng-if="application.canEditStudent && application.id > 0 && application.status === \'AVALDUS_STAATUS_KOOST\' && \r\n      application.needsRepresentativeConfirm === true" ng-click="submit()" class="md-raised md-primary"> {{(application.type === \'AVALDUS_LIIK_TUGI\' ? \'main.button.submit\' : \'main.button.allowSubmit\') | translate}}</md-button> <md-button ng-if="application.canEditStudent && application.id > 0 && application.status === \'AVALDUS_STAATUS_KOOST\' && application.needsRepresentativeConfirm === true" class="md-raised" ng-click="reject()">{{\'main.button.reject\' | translate}}</md-button> <md-button ng-if="application.canEditStudent && application.id > 0 && application.status === \'AVALDUS_STAATUS_KINNITAM\' && application.type === \'AVALDUS_LIIK_TUGI\'" ng-click="confirmConfirmation()" class="md-raised md-primary">{{\'application.confirmDecision\' | translate}}</md-button> </div> <div ng-if="!isStudentRepresentative()" layout-xs="column"> <md-button ng-if="application.canEditStudent && application.id > 0 && application.status === \'AVALDUS_STAATUS_KOOST\' && \r\n    ((!auth.isAdmin() && application.needsRepresentativeConfirm === false) || auth.isTeacher() || (auth.isAdmin() && isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_AVALDUS\')))" ng-click="submit()" class="md-raised md-primary">{{\'main.button.submit\' | translate}}</md-button> <md-button ng-if="application.canEditStudent && application.id > 0 &&\r\n'+"    (application.type === 'AVALDUS_LIIK_MUU' || application.type === 'AVALDUS_LIIK_OVERSKAVA' || application.type === 'AVALDUS_LIIK_RAKKAVA' || (application.type === 'AVALDUS_LIIK_TUGI' && application.committee)) &&\r\n    (application.status === 'AVALDUS_STAATUS_ESIT' || application.status === 'AVALDUS_STAATUS_YLEVAAT') && \r\n    (auth.isAdmin() && isAuthorized('ROLE_OIGUS_K_TEEMAOIGUS_AVALDUS'))\" ng-click=\"confirm()\" class=\"md-raised md-primary\">{{'main.button.confirm' | translate}}</md-button> <md-button ng-if=\"application.canEditStudent && application.id > 0 && \r\n    application.status === 'AVALDUS_STAATUS_KINNITAM' && application.type === 'AVALDUS_LIIK_TUGI' &&\r\n    ((auth.isStudent() && application.isAdult) || auth.isParent() || (auth.isAdmin() && isAuthorized('ROLE_OIGUS_K_TEEMAOIGUS_AVALDUS')))\" ng-click=\"confirmConfirmation()\" class=\"md-raised md-primary\">{{'application.confirmDecision' | translate}}</md-button> <md-button ng-if=\"application.canRemoveConfirmation\" ng-click=\"removeConfirmation()\" class=\"md-raised md-primary\">{{'application.removeConfirmation' | translate}}</md-button> <md-button ng-if=\"application.canEditStudent && application.id > 0 && ((application.status === 'AVALDUS_STAATUS_YLEVAAT' && (application.type !== 'AVALDUS_LIIK_TUGI' || !application.committee))\r\n    || (application.status === 'AVALDUS_STAATUS_KOOST' && application.needsRepresentativeConfirm)) \r\n    && (auth.isAdmin() && isAuthorized('ROLE_OIGUS_M_TEEMAOIGUS_AVALDUS'))\" class=\"md-raised\" ng-click=\"reject()\">{{'main.button.reject' | translate}}</md-button> <md-button ng-if=\"application.canEditStudent && application.id > 0 && application.status === 'AVALDUS_STAATUS_KOOST'\r\n    && !(auth.isAdmin() && !isAuthorized('ROLE_OIGUS_M_TEEMAOIGUS_AVALDUS'))\" ng-click=\"delete()\" class=\"md-raised\">{{'main.button.delete' | translate}}</md-button> <md-button ng-if=\"application.id > 0 && application.representativeConfirmed && application.type === 'AVALDUS_LIIK_TUGI'\" ng-href=\"{{pdfUrl()}}\" target=\"_blank\" class=\"md-raised\">{{'main.button.print' | translate}}</md-button> </div>"),a.put("application/templates/application.html",'<div ng-if="isCreate && application.type !== \'AVALDUS_LIIK_TUGI\'" layout="row" layout-sm="column" layout-xs="column" class="form-readonly"> <md-input-container class="label-only" flex="60" flex-sm="100" flex-xs="100"> <label>{{\'application.type\' | translate}}</label> <hois-classifier-value ng-model="application.type" main-classifier-code="AVALDUS_LIIK"></hois-classifier-value> </md-input-container> </div> <div ng-if="!isCreate && application.type !== \'AVALDUS_LIIK_TUGI\'" ng-include="\'application/templates/application.information.html\'" class="form-readonly"></div> <div ng-if="isCreate && !(auth.isStudent() || auth.isParent()) && application.type !== \'AVALDUS_LIIK_TUGI\'" layout="row" layout-sm="column" layout-xs="column" class="form-readonly"> <md-input-container class="label-only" flex="60" flex-sm="100" flex-xs="100"> <label>{{\'student.label\' | translate}}</label> <hois-value value="application.student.nameEt" href-value="\'#/students/\' + application.student.id + \'/main\'"></hois-value> </md-input-container> </div> <div ng-include="templateUrlByType"></div> <div layout="row" layout-sm="column" layout-xs="column" ng-if="application.type !== \'AVALDUS_LIIK_TUGI\'"> <md-input-container flex="100" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'application.additionalInfo\' | translate}}</label> <textarea ng-model="application.addInfo" md-maxlength="4000" max-rows="10" ng-disabled="application.status === \'AVALDUS_STAATUS_KINNITATUD\'"></textarea> </md-input-container> </div> <div layout="column" flex> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.relatedFiles\' | translate}}</legend> <md-button ng-if="(auth.isStudent() || (application.type === \'AVALDUS_LIIK_TUGI\' && (auth.isParent() || auth.isTeacher()))\r\n      && application.status === \'AVALDUS_STAATUS_KOOST\') || (auth.isAdmin() && [\'AVALDUS_STAATUS_KOOST\', \'AVALDUS_STAATUS_ESIT\', \'AVALDUS_STAATUS_YLEVAAT\'].indexOf(application.status) !== -1)" class="md-raised" href="" ng-click="openAddFileDialog()">{{\'main.button.uploadFile\' | translate}}</md-button> <md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column><span>{{\'file.nameAndFile\' | translate}}</span></th> <th md-column><span>{{\'file.additionDate\' | translate}}</span></th> <th md-column>{{\'file.addedBy\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="file in application.files | orderBy: \'id\'" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell> <div layout="row" flex> <div flex="60"> {{file.oisFile.fname}} </div> <div flex> <a ng-href="{{getUrl(file.oisFile, \'application\')}}" download target="_blank" rel="noopener noreferrer"> <md-icon md-font-set="material-icons">file_download</md-icon> </a> </div> </div> </td> <td md-cell> {{file.inserted | hoisDateTime}} </td> <td md-cell> {{file.insertedBy}} </td> <td md-cell> <md-button class="remove nomargin" ng-click="removeFromArray(application.files, file)">&times;</md-button> </td> </tr> </tbody> </table> </md-table-container> </fieldset> </div>'),a.put("application/templates/application.information.html",'<div layout="row" layout-sm="column" layout-xs="column"> <md-input-container class="label-only" flex="60" flex-sm="100" flex-xs="100"> <label>{{\'application.type\' | translate}}</label> <hois-classifier-value ng-model="application.type" main-classifier-code="AVALDUS_LIIK"></hois-classifier-value> </md-input-container> </div> <div ng-if="!(auth.isStudent() || auth.isParent())" layout="row" layout-sm="column" layout-xs="column"> <md-input-container class="label-only" flex="60" flex-sm="100" flex-xs="100"> <label>{{\'student.label\' | translate}}</label> <hois-value value="application.student.nameEt" href-value="\'#/students/\' + application.student.id + \'/main\'"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container class="label-only" flex="60" flex-sm="100" flex-xs="100"> <label>{{\'main.status\' | translate}}</label> <hois-classifier-value ng-model="application.status" main-classifier-code="AVALDUS_STAATUS"></hois-classifier-value> </md-input-container> </div> <div ng-if="!application.isAdult" layout="row" layout-sm="column" layout-xs="column"> <md-input-container class="label-only" flex="60" flex-sm="100" flex-xs="100"> <label>{{\'application.confirmedByRepresentative\' | translate}}</label> <hois-value value="application.needsRepresentativeConfirm === true || application.status === \'AVALDUS_STAATUS_KOOST\' ? \'main.no\' : \'main.yes\' | translate"></hois-value> </md-input-container> </div> <div ng-if="application.status === \'AVALDUS_STAATUS_TAGASI\'" layout="row" layout-sm="column" layout-xs="column"> <md-input-container class="label-only" flex="60" flex-sm="100" flex-xs="100"> <label>{{\'application.rejectReason\' | translate}}</label> <hois-value value="application.rejectReason"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container class="label-only" flex="60" flex-sm="100" flex-xs="100"> <label>{{\'application.createdBy\' | translate}}</label> <hois-value value="application.insertedBy"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container class="label-only" flex="60" flex-sm="100" flex-xs="100"> <label>{{\'application.confirmationDate\' | translate}}</label> <hois-value value="application.status === \'AVALDUS_STAATUS_KINNITATUD\' ? (application.changed | hoisDate) : \'\'"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container class="label-only" flex="60" flex-sm="100" flex-xs="100"> <label>{{\'application.submissionDate\' | translate}}</label> <hois-value value="application.submitted | hoisDate"></hois-value> </md-input-container> </div>'),a.put("application/templates/application.type.akad.edit.html",'<div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="60" flex-sm="100" flex-xs="100"> <label>{{\'application.reason\' | translate}}</label> <hois-classifier-select ng-model="application.reason" model-value-attr="code" only-valid required main-classifier-code="AKADPUHKUS_POHJUS" ignore-preselected criteria="{higher: !curriculumVersion.isVocational ? true : undefined, vocational: curriculumVersion.isVocational ? true : undefined}"></hois-classifier-select> </md-input-container> </div> <div ng-include="\'application/templates/period.html\'" ng-init="labelStart=\'application.academicLeaveStart\';labelEnd=\'application.academicLeaveEnd\'"> </div>'),a.put("application/templates/application.type.akad.view.html",'<div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="60" flex-sm="100" flex-xs="100"> <label>{{\'application.reason\' | translate}}</label> <hois-classifier-value ng-model="application.reason" main-classifier-code="AKADPUHKUS_POHJUS"></hois-classifier-value> </md-input-container> </div> <div ng-include="\'application/templates/period.view.html\'" ng-init="labelStart=\'application.academicLeaveStart\';labelEnd=\'application.academicLeaveEnd\'"> </div>'),a.put("application/templates/application.type.akadk.edit.html",'<div> <div class="form-readonly"> <md-input-container flex="60" flex-sm="100" flex-xs="100"> <label>{{\'application.reason\' | translate}}</label> <hois-classifier-value ng-model="application.validAcademicLeave.reason" main-classifier-code="AKADPUHKUS_POHJUS"></hois-classifier-value> </md-input-container> </div> <div ng-show="!application.validAcademicLeave.isPeriod" layout="row" layout-xs="column" class="form-readonly"> <md-input-container flex="20" flex-sm="100" flex-xs="100"> <label>{{\'application.academicLeaveStart\' | translate}}</label> <hois-value value="application.validAcademicLeave.startDate | hoisDate"></hois-value> </md-input-container> <md-input-container style="margin-left: 0px" flex="20" flex-sm="100" flex-xs="100" flex-offset-xs="0" flex-offset-sm="0" flex-offset="5"> <label>{{\'application.academicLeaveEnd\' | translate}}</label> <hois-value value="application.validAcademicLeave.endDate | hoisDate"></hois-value> </md-input-container> </div> <div ng-show="application.validAcademicLeave.isPeriod" layout="row" layout-xs="column"> <md-input-container flex="20" flex-sm="100" flex-xs="100"> <label>{{\'application.academicLeaveStart\' | translate}}</label> <hois-select ng-model="application.validAcademicLeave.studyPeriodStart" values="studyPeriods" disabled></hois-select> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-xs="100"> <label>{{\'application.academicLeaveEnd\' | translate}}</label> <hois-select ng-model="application.validAcademicLeave.studyPeriodEnd" values="studyPeriods" disabled></hois-select> </md-input-container> </div> <md-input-container flex="20" flex-sm="100" flex-xs="100"> <label>{{\'application.academicLeaveRevocationDate\' | translate}}</label> <md-datepicker ng-model="application.startDate" md-open-on-focus md-min-date="application.validAcademicLeave.startDate" md-max-date="application.validAcademicLeave.endDate" required></md-datepicker> </md-input-container> </div>'),a.put("application/templates/application.type.akadk.view.html",'<div> <div layout="row"> <md-input-container flex="60" flex-sm="100" flex-xs="100"> <label>{{\'application.reason\' | translate}}</label> <hois-classifier-value ng-model="application.validAcademicLeave.reason" main-classifier-code="AKADPUHKUS_POHJUS"></hois-classifier-value> </md-input-container> </div> <div ng-show="!application.validAcademicLeave.isPeriod" layout="row" layout-xs="column"> <md-input-container flex="20" flex-sm="100" flex-xs="100"> <label>{{\'application.academicLeaveStart\' | translate}}</label> <hois-value value="application.validAcademicLeave.startDate | hoisDate"></hois-value> </md-input-container> <md-input-container style="margin-left: 0px" flex="20" flex-sm="100" flex-xs="100" flex-offset-xs="0" flex-offset-sm="0" flex-offset="5"> <label>{{\'application.academicLeaveEnd\' | translate}}</label> <hois-value value="application.validAcademicLeave.endDate | hoisDate"></hois-value> </md-input-container> </div> <div ng-show="application.validAcademicLeave.isPeriod" layout="row" layout-xs="column"> <md-input-container flex="20" flex-sm="100" flex-xs="100"> <label>{{\'application.academicLeaveStart\' | translate}}</label> <hois-select ng-model="application.validAcademicLeave.studyPeriodStart" values="studyPeriods" disabled></hois-select> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-xs="100"> <label>{{\'application.academicLeaveEnd\' | translate}}</label> <hois-select ng-model="application.validAcademicLeave.studyPeriodEnd" values="studyPeriods" disabled></hois-select> </md-input-container> </div> <div layout="row" layout-xs="column"> <md-input-container flex="20" flex-sm="100" flex-xs="100"> <label>{{\'application.academicLeaveRevocationDate\' | translate}}</label> <hois-value value="application.startDate | hoisDate"></hois-value> </md-input-container> </div> </div>'),a.put("application/templates/application.type.eksmat.edit.html",'<div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="60" flex-sm="100" flex-xs="100"> <label>{{\'application.reason\' | translate}}</label> <hois-classifier-select ng-model="application.reason" model-value-attr="code" main-classifier-code="EKSMAT_POHJUS" criteria="{higher: auth.school.higher ? true : undefined, vocational: auth.school.vocational ? true : undefined}" only-valid required> </hois-classifier-select> </md-input-container> </div>'),a.put("application/templates/application.type.eksmat.view.html",'<div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="60" flex-sm="100" flex-xs="100"> <label>{{\'application.reason\' | translate}}</label> <hois-classifier-value ng-model="application.reason" main-classifier-code="EKSMAT_POHJUS"></hois-classifier-value> </md-input-container> </div>'),a.put("application/templates/application.type.finm.edit.html",'<div> <div layout="row" layout-sm="column" layout-xs="column" class="form-readonly"> <md-input-container class="label-only" flex="60" flex-sm="100" flex-xs="100"> <label>{{\'application.validFinancialSource\' | translate}}</label> <hois-classifier-value ng-model="application.oldFin" model-value-attr="code" main-classifier-code="FINALLIKAS"></hois-classifier-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column" class="form-readonly"> <md-input-container class="label-only" flex="60" flex-sm="100" flex-xs="100"> <label>{{\'application.validFinancialSourceSpecification\' | translate}}</label> <hois-classifier-value ng-model="application.oldFinSpecific" model-value-attr="code" main-classifier-code="FINTAPSUSTUS"></hois-classifier-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column" class="form-readonly"> <md-input-container class="label-only" flex="60" flex-sm="100" flex-xs="100"> <label>{{\'application.newFinancialSource\' | translate}}</label> <hois-classifier-value ng-model="application.newFin" model-value-attr="code" main-classifier-code="FINALLIKAS"></hois-classifier-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column" flex> <md-input-container flex="60" flex-sm="100" flex-xs="100"> <label>{{\'application.newFinancialSourceSpecification\' | translate}}</label> <hois-classifier-select ng-model="application.newFinSpecific" model-value-attr="code" ignore-preselected criteria="{higher: auth.school.higher ? true : undefined, vocational: auth.school.vocational ? true : undefined}" only-valid main-classifier-code="FINTAPSUSTUS" filter-values="[application.oldFinSpecific]" required></hois-classifier-select> </md-input-container> </div> </div>'),a.put("application/templates/application.type.finm.view.html",'<div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container class="label-only" flex="60" flex-sm="100" flex-xs="100"> <label>{{\'application.validFinancialSource\' | translate}}</label> <hois-classifier-value ng-model="application.oldFin" main-classifier-code="FINALLIKAS"></hois-classifier-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container class="label-only" flex="60" flex-sm="100" flex-xs="100"> <label>{{\'application.validFinancialSourceSpecification\' | translate}}</label> <hois-classifier-value ng-model="application.oldFinSpecific" main-classifier-code="FINTAPSUSTUS"></hois-classifier-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container class="label-only" flex="60" flex-sm="100" flex-xs="100"> <label>{{\'application.newFinancialSource\' | translate}}</label> <hois-classifier-value ng-model="application.newFin" main-classifier-code="FINALLIKAS"></hois-classifier-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="60" flex-sm="100" flex-xs="100"> <label>{{\'application.newFinancialSourceSpecification\' | translate}}</label> <hois-classifier-value ng-model="application.newFinSpecific" main-classifier-code="FINTAPSUSTUS"></hois-classifier-value> </md-input-container> </div> </div>'),a.put("application/templates/application.type.muu.edit.html",'<div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="100" flex-sm="100" flex-xs="100"> <label>{{\'application.otherText\' | translate}}</label> <textarea ng-model="application.otherText" md-maxlength="10000" max-rows="10" required></textarea> </md-input-container> </div>'),a.put("application/templates/application.type.muu.view.html",'<div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="100" flex-sm="100" flex-xs="100"> <label>{{\'application.otherText\' | translate}}</label> <hois-value value="application.otherText"></hois-value> </md-input-container> </div>'),a.put("application/templates/application.type.okava.edit.html",'<div> <div layout="row" layout-sm="column" layout-xs="column" class="form-readonly"> <md-input-container class="label-only" flex="60" flex-sm="100" flex-xs="100"> <label>{{\'application.validCurriculumVersion\' | translate}}</label> <hois-value value="currentLanguageNameField(application.oldCurriculumVersion)"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column" class="form-readonly"> <md-input-container class="label-only" flex="60" flex-sm="100" flex-xs="100"> <label>{{\'application.validStudyForm\' | translate}}</label> <hois-classifier-value ng-model="application.oldStudyForm" model-value-attr="code" main-classifier-code="OPPEVORM"></hois-classifier-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="60" flex-sm="100" flex-xs="100"> <label>{{\'application.newCurriculumVersion\' | translate}}</label> <hois-select ng-model="application.newCurriculumVersion.id" ng-change="newCurriculumVersionSelected()" values="curriculumVersions" ng-required="application.type === \'AVALDUS_LIIK_OKAVA\'"></hois-select> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="60" flex-sm="100" flex-xs="100"> <label>{{\'application.newStudyForm\' | translate}}</label> <hois-classifier-select ng-model="application.newStudyForm" main-classifier-code="OPPEVORM" show-only-values="allowedStudyForms" criteria="{higher: auth.school.higher ? true : undefined, vocational: auth.school.vocational ? true : undefined}" only-valid ignore-preselected model-value-attr="code" required></hois-classifier-select> </md-input-container> </div> </div>'),a.put("application/templates/application.type.okava.view.html",'<div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container class="label-only" flex="60" flex-sm="100" flex-xs="100"> <label>{{\'application.validCurriculumVersion\' | translate}}</label> <hois-value value="currentLanguageNameField(application.oldCurriculumVersion)"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container class="label-only" flex="60" flex-sm="100" flex-xs="100"> <label>{{\'application.validStudyForm\' | translate}}</label> <hois-classifier-value ng-model="application.oldStudyForm" main-classifier-code="OPPEVORM"></hois-classifier-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="60" flex-sm="100" flex-xs="100"> <label>{{\'application.newCurriculumVersion\' | translate}}</label> <hois-value value="currentLanguageNameField(application.newCurriculumVersion)"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="60" flex-sm="100" flex-xs="100"> <label>{{\'application.newStudyForm\' | translate}}</label> <hois-classifier-value ng-model="application.newStudyForm" main-classifier-code="OPPEVORM"></hois-classifier-value> </md-input-container> </div> </div>'),a.put("application/templates/application.type.overskava.edit.html",'<div> <div layout="row" layout-sm="column" layout-xs="column" class="form-readonly"> <md-input-container flex="60" flex-sm="100" flex-xs="100"> <label>{{\'application.validCVHigher\' | translate}}</label> <hois-value value="currentLanguageNameField(application.oldCurriculumVersion)"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label>{{\'application.newCVHigher\' | translate}}</label> <md-select ng-model="application.newCurriculumVersion" ng-model-options="{trackBy: \'$value.id\'}" required name="curriculumVersion"> <md-option ng-value="opt" ng-repeat="opt in formState.curriculumVersions">{{currentLanguageNameField(opt)}}</md-option> </md-select> <div ng-messages="formState.curriculumsEmpty && applicationForm.curriculumVersion.$error"> <div ng-message="required"> {{\'application.messages.noCurriculumVersionHigher\' | translate}} </div> </div> </md-input-container> <md-input-container flex="50" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-sm="0" flex-offset-xs="0"> <label>{{\'application.newStudentGroup\' | translate}}</label> <md-select ng-model="application.studentGroup" ng-model-options="{trackBy: \'$value.id\'}" required> <md-option ng-value="opt" ng-repeat="opt in formState.studentGroups"> {{currentLanguageNameField(opt)}}</md-option> </md-select> </md-input-container> </div> </div>'),a.put("application/templates/application.type.overskava.view.html",'<div> <div layout="column" flex="60" flex-sm="100" flex-xs="100"> <md-input-container flex> <label>{{\'application.validCVHigher\' | translate}}</label> <hois-value value="currentLanguageNameField(application.oldCurriculumVersion)"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'application.newCVHigher\' | translate}}</label> <hois-value value="currentLanguageNameField(application.newCurriculumVersion)"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'application.newStudentGroup\' | translate}}</label> <hois-value value="currentLanguageNameField(application.studentGroup)"></hois-value> </md-input-container> </div> </div>'),a.put("application/templates/application.type.ovorm.edit.html",'<div> <div layout="row" layout-sm="column" layout-xs="column" class="form-readonly"> <md-input-container class="label-only" flex="60" flex-sm="100" flex-xs="100"> <label>{{\'application.validStudyForm\' | translate}}</label> <hois-classifier-value ng-model="application.oldStudyForm" model-value-attr="code" main-classifier-code="OPPEVORM"></hois-classifier-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="60" flex-sm="100" flex-xs="100"> <label>{{\'application.newStudyForm\' | translate}}</label> <hois-classifier-select ng-model="application.newStudyForm" model-value-attr="code" ignore-preselected criteria="{higher: auth.school.higher ? true : undefined, vocational: auth.school.vocational ? true : undefined}" only-valid main-classifier-code="OPPEVORM" criteria="{higher: true}" filter-values="[application.oldStudyForm]" required></hois-classifier-select> </md-input-container> </div> </div>'),a.put("application/templates/application.type.ovorm.view.html",'<div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container class="label-only" flex="60" flex-sm="100" flex-xs="100"> <label>{{\'application.validStudyForm\' | translate}}</label> <hois-classifier-value ng-model="application.oldStudyForm" main-classifier-code="OPPEVORM"></hois-classifier-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="60" flex-sm="100" flex-xs="100"> <label>{{\'application.newStudyForm\' | translate}}</label> <hois-classifier-value ng-model="application.newStudyForm" main-classifier-code="OPPEVORM"></hois-classifier-value> </md-input-container> </div> </div>'),a.put("application/templates/application.type.rakkava.edit.html",'<div> <div layout="row" layout-sm="column" layout-xs="column" class="form-readonly"> <md-input-container flex="60" flex-sm="100" flex-xs="100"> <label>{{\'application.validCVVocational\' | translate}}</label> <hois-value value="currentLanguageNameField(application.oldCurriculumVersion)"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="45" flex-sm="100" flex-xs="100"> <label>{{\'application.newCVVocational\' | translate}}</label> <md-select ng-model="application.newCurriculumVersion" ng-change="newCurriculumVersionSelected()" ng-model-options="{trackBy: \'$value.id\'}" ng-disabled="application.id" name="curriculumVersion" required> <md-option ng-value="opt" ng-repeat="opt in formState.curriculumVersions">{{currentLanguageNameField(opt)}}</md-option> </md-select> <div ng-messages="formState.curriculumsEmpty && applicationForm.curriculumVersion.$error"> <div ng-message="required"> {{\'application.messages.noCurriculumVersionCurriculum\' | translate}} </div> </div> </md-input-container> <md-input-container flex="50" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-sm="0" flex-offset-xs="0"> <label>{{\'application.newStudentGroup\' | translate}}</label> <md-select ng-model="application.studentGroup" ng-model-options="{trackBy: \'$value.id\'}" ng-disabled="application.status === \'AVALDUS_STAATUS_KINNITATUD\'" required> <md-option ng-value="opt" ng-repeat="opt in formState.studentGroups\r\n          | filter: {curriculumVersion: (application.newCurriculumVersion.id ? application.newCurriculumVersion.id : 0)}"> {{currentLanguageNameField(opt)}}</md-option> </md-select> </md-input-container> </div> <div ng-if="application.newCurriculumVersion"> <div>&nbsp;</div> <fieldset flex> <div ng-if="application.themeReplacement.modules.length === 0" flex="100" layout layout-align="left center"> <div md-colors="{color: \'accent\'}" layout layout-align="left center"> <md-icon md-colors="{color: \'accent\'}" md-font-set="material-icons">info_outline</md-icon> <span> {{\'application.noMatchingThemes\' | translate}}</span> </div> </div> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'application.themeMatches\' | translate}}</legend> <md-table-container ng-if="application.themeReplacement.modules.length > 0"> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'application.oldCVVocational\' | translate}}</th> <th md-column>{{\'application.newCVVocational\' | translate}}</th> </tr> </thead> <tbody md-body ng-repeat="module in application.themeReplacement.modules"> <tr md-row class="even"> <td md-cell colspan="2">{{currentLanguageNameField(module)}}</td> </tr> <tr md-row> <td md-cell> <div layout="column"> <div ng-repeat="oldTheme in module.oldThemes | orderBy: \'theme.\' + currentLanguageNameVariable()"> <span>{{currentLanguageNameField(oldTheme.theme)}}</span> <span>(<b>{{oldTheme.grade}}</b> {{oldTheme.gradeInserted | hoisDate}})</span> </div> </div> </td> <td md-cell> <div layout="column"> <div ng-repeat="newTheme in module.newThemes | orderBy: \'theme.\' + currentLanguageNameVariable()"> <md-input-container> <md-checkbox class="new-theme-checkbox" ng-model="newTheme.covering" ng-disabled="!auth.isAdmin()"> {{currentLanguageNameField(newTheme.theme)}}</md-checkbox> </md-input-container> </div> </div> </td> </tr> </tbody> </table> </md-table-container> </fieldset> <div>&nbsp;</div> </div> </div> <style>.new-theme-checkbox {\r\n    width: auto !important;\r\n  }</style>'),
a.put("application/templates/application.type.rakkava.view.html",'<div> <div layout="column" flex="60" flex-sm="100" flex-xs="100"> <md-input-container flex> <label>{{\'application.validCVVocational\' | translate}}</label> <hois-value value="currentLanguageNameField(application.oldCurriculumVersion)"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'application.newCVVocational\' | translate}}</label> <hois-value value="currentLanguageNameField(application.newCurriculumVersion)"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'application.newStudentGroup\' | translate}}</label> <hois-value value="currentLanguageNameField(application.studentGroup)"></hois-value> </md-input-container> </div> <div ng-if="application.themeReplacement.modules.length > 0"> <div>&nbsp;</div> <fieldset flex> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'application.themeMatches\' | translate}}</legend> <md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'application.oldCVVocational\' | translate}}</th> <th md-column>{{\'application.newCVVocational\' | translate}}</th> </tr> </thead> <tbody md-body ng-repeat="module in application.themeReplacement.modules"> <tr md-row class="even"> <td md-cell colspan="2">{{currentLanguageNameField(module)}}</td> </tr> <tr md-row> <td md-cell> <div layout="column"> <div ng-repeat="oldTheme in module.oldThemes | orderBy: \'theme.\' + currentLanguageNameVariable()"> <span>{{currentLanguageNameField(oldTheme.theme)}}</span> <span>(<b>{{oldTheme.grade}}</b> {{oldTheme.gradeInserted | hoisDate}})</span> </div> </div> </td> <td md-cell> <div layout="column"> <div ng-repeat="newTheme in module.newThemes | orderBy: \'theme.\' + currentLanguageNameVariable()"> <md-input-container> <md-checkbox class="new-theme-checkbox" ng-model="newTheme.covering" disabled> {{currentLanguageNameField(newTheme.theme)}}</md-checkbox> </md-input-container> </div> </div> </td> </tr> </tbody> </table> </md-table-container> </fieldset> <div>&nbsp;</div> <div>&nbsp;</div> </div> </div> <style>.new-theme-checkbox {\r\n    width: auto !important;\r\n  }</style>'),a.put("application/templates/application.type.tugi.edit.html",'<div layout="column" class="inner-form" style="margin-top: -1em"> <div layout="column"> <md-input-container class="readonly"> <label>{{\'application.type\' | translate}}</label> <hois-classifier-value ng-model="application.type" main-classifier-code="AVALDUS_LIIK"></hois-classifier-value> </md-input-container> </div> <div ng-if="!(auth.isStudent() || (auth.isParent() && isCreate))" layout="column"> <md-input-container class="readonly"> <label>{{\'student.label\' | translate}}</label> <hois-value value="application.student.nameEt" href-value="\'#/students/\' + application.student.id + \'/main\'"></hois-value> </md-input-container> </div> <div ng-if="auth.isParent() && isCreate && student.nameEt" layout="column"> <!-- For application.student.new.html --> <md-input-container class="readonly"> <label>{{\'student.label\' | translate}}</label> <hois-value value="student.nameEt" href-value="\'#/students/\' + application.student.id + \'/main\'"></hois-value> </md-input-container> </div> <div layout="column" ng-if="!isCreate"> <md-input-container class="readonly"> <label>{{\'main.status\' | translate}}</label> <hois-classifier-value ng-model="application.status" main-classifier-code="AVALDUS_STAATUS"></hois-classifier-value> </md-input-container> </div> <div layout="column" ng-if="!isCreate"> <md-input-container class="readonly"> <label>{{\'application.createdBy\' | translate}}</label> <hois-value value="application.insertedBy"></hois-value> </md-input-container> </div> <div ng-if="application.status === \'AVALDUS_STAATUS_TAGASI\' && application.rejectReason && !application.representativeConfirmed" layout="row" layout-sm="column" layout-xs="column"> <md-input-container class="readonly"> <label>{{\'application.rejectReason\' | translate}}</label> <hois-value value="application.rejectReason"></hois-value> </md-input-container> </div> <div>&nbsp;</div> <fieldset> <legend class="md-title-small"> <span md-colors="{color: \'primary-800\'}" style="margin-right: 16px">{{\'application.label\' | translate}}</span> </legend> <div layout="column"> <div ng-if="!application.isAdult && !isCreate" layout="column"> <md-input-container class="readonly"> <label>{{\'application.confirmedByRepresentative\' | translate}}</label> <hois-value value="application.needsRepresentativeConfirm === true || application.status === \'AVALDUS_STAATUS_KOOST\' ? \'main.no\' : \'main.yes\' | translate"></hois-value> </md-input-container> </div> <div layout="column" ng-if="!isCreate"> <md-input-container class="readonly"> <label>{{\'application.submissionDate\' | translate}}</label> <hois-value value="application.submitted | hoisDate"></hois-value> </md-input-container> </div> <md-input-container ng-if="application.status === \'AVALDUS_STAATUS_KOOST\'"> <label>{{\'application.supportService.text\' | translate}}</label> <textarea ng-model="application.otherText" md-maxlength="10000" max-rows="10" required></textarea> </md-input-container> <md-input-container ng-if="application.status === \'AVALDUS_STAATUS_YLEVAAT\'" class="readonly"> <label>{{\'application.supportService.text\' | translate}}</label> <hois-value value="application.otherText"></hois-value> </md-input-container> <md-input-container flex="100" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'application.additionalInfo\' | translate}}</label> <textarea ng-model="application.addInfo" md-maxlength="4000" max-rows="10"></textarea> </md-input-container> </div> </fieldset> <div>&nbsp;</div> <div layout="column" ng-if="application.status === \'AVALDUS_STAATUS_YLEVAAT\'"> <fieldset> <legend class="md-title-small"> <span md-colors="{color: \'primary-800\'}" style="margin-right: 16px">{{\'application.committee\' | translate}}</span> </legend> <div layout="column" ng-if="application.committeeAdded"> <md-input-container class="readonly"> <label>{{\'application.committeeAdded\' | translate}}</label> <hois-value value="application.committeeAdded | hoisDate"></hois-value> </md-input-container> </div> <div layout="column" ng-if="application.committeeDecisionAdded"> <md-input-container class="readonly"> <label>{{\'application.committeeDecisionAdded\' | translate}}</label> <hois-value value="application.committeeDecisionAdded | hoisDate"></hois-value> </md-input-container> </div> <div layout="column"> <md-input-container> <label>{{\'application.supportService.committee\' | translate}}</label> <md-select ng-model="application.committee" ng-model-options="{trackBy: \'$value.id\'}" required> <md-option ng-value="committee" ng-repeat="committee in formState.committees | orderBy: currentLanguageNameField()"> {{currentLanguageNameField(committee)}} </md-option> </md-select> </md-input-container> </div> <div layout="column" ng-if="application.committee"> <div layout="column"> <div layout="row" layout-xs="column"> <md-input-container style="max-width: 160px; margin-right: 8px" flex> <label>{{\'application.supportService.isDecided\' | translate}}{{getStar()}}</label> <md-select ng-model="application.isDecided" ng-required="strictRequired"> <md-option md-option-empty ng-if="!strictRequired"></md-option> <md-option ng-value="false">{{\'main.no\' | translate}}</md-option> <md-option ng-value="true">{{\'main.yes\' | translate}}</md-option> </md-select> </md-input-container> <p class="md-body-1" md-colors="{color: \'warn\'}" style="margin: auto 4px" ng-if="application.isDecided && !application.hasSpecialNeed">{{\'application.messages.studentHasNoSpecialNeed\' | translate}}</p> </div> <md-input-container> <label>{{\'application.supportService.decision\' | translate}}{{getStar()}}</label> <textarea ng-model="application.decision" md-maxlength="4000" max-rows="10" ng-required="strictRequired"></textarea> </md-input-container> </div> <div layout="column"> <md-input-container> <!-- https://github.com/angular/material/issues/11151 --> <md-select ng-model="formState.supportService" name="supportService" ng-change="onTugiClChange()" placeholder="{{\'application.supportService.supportServices\' | translate}}{{getStar(application.isDecided === true)}}" ng-required="application.isDecided && strictRequired && application.supportServices.length === 0"> <md-option ng-value="cl" ng-repeat="cl in formState.supportServices | filter: isValid(cl)"> {{cl | hoisValidDates}} </md-option> </md-select> </md-input-container> <div layout="column" class="common-label" flex="95" ng-repeat="service in application.supportServices | orderBy: [currentLanguageNameField(), \'code\']"> <div layout="row" flex layout-align="start center"> <div flex="5">&nbsp;</div> <div flex="50" flex-sm="70" flex-xs="85">{{currentLanguageNameField(service)}}</div> <div> <a ng-click="deleteService(service)" class="remove">&times;</a> </div> </div> <md-divider ng-if="$last"></md-divider> </div> <br> <div ng-if="tugiIndivCurriculum"> <p class="md-body-2">{{\'application.supportService.individualCurriculum\' | translate}}{{application.isDecided ? \' *\' : \'\'}}</p> <input hidden ng-model="dummyModel" name="selectedModules" ng-required="application.isDecided && strictRequired && application.selectedModules.length === 0"> <div class="invalid" ng-messages="applicationForm.selectedModules.$error"> <p ng-message="required">{{\'directive.atleastOneModuleRequired\' | translate}}</p> </div> <md-divider></md-divider> <md-table-container> <table md-table md-row-select multiple ng-model="application.selectedModules" md-progress="curriculumVersionModules.$promise" class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'directive.student.module\' | translate}}</th> <th md-column>{{\'directive.student.distinction\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row md-select="row" ng-repeat="row in curriculumVersionModules" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{currentLanguageNameField(row.module)}}</td> <td md-cell style="width: 50%"> <md-input-container style="width: 100%"> <textarea ng-model="row.addInfo" md-maxlength="4000" max-rows="5" aria-label="{{\'directive.student.distinction\' | translate}}" ng-disabled="application.selectedModules.indexOf(row) === -1" ng-required="application.selectedModules.indexOf(row) !== -1"></textarea> </md-input-container> </td> </tr> </tbody> </table> </md-table-container> <br> </div> <md-input-container> <label>{{\'application.supportService.implementationPlan\' | translate}}{{getStar(application.isDecided === true)}}</label> <textarea ng-model="application.implementationPlan" md-maxlength="10000" max-rows="10" ng-required="application.isDecided && strictRequired"></textarea> </md-input-container> </div> <!-- <div layout="column">\r\n          <md-input-container>\r\n            <label>{{\'application.supportService.committeeAddInfo\' | translate}}</label>\r\n            <textarea ng-model="application.committeeAddInfo" md-maxlength="4000" max-rows="10"></textarea>\r\n          </md-input-container>\r\n        </div> --> </div> </fieldset> <div ng-if="(application.status === \'AVALDUS_STAATUS_TAGASI\' || application.status === \'AVALDUS_STAATUS_KINNITATUD\') && application.representativeConfirmed">&nbsp;</div> <fieldset ng-if="(application.status === \'AVALDUS_STAATUS_TAGASI\' || application.status === \'AVALDUS_STAATUS_KINNITATUD\') && application.representativeConfirmed"> <legend class="md-title-small"> <span md-colors="{color: \'primary-800\'}" style="margin-right: 16px">{{\'application.representativeOrStudentDecision\' | translate}}</span> </legend> <div layout="column"> <div ng-if="(application.status === \'AVALDUS_STAATUS_TAGASI\' || application.status === \'AVALDUS_STAATUS_KINNITATUD\') && application.representativeConfirmed" layout="column"> <md-input-container class="readonly"> <label>{{\'application.supportService.isRepresentativeConfirmed\' | translate}}</label> <hois-value value="(application.isRepresentativeConfirmed === true ? \'application.supportService.representativeConfirmed\' : \'application.supportService.representativeRejected\') | translate"></hois-value> </md-input-container> </div> <div ng-if="(application.status === \'AVALDUS_STAATUS_TAGASI\' || application.status === \'AVALDUS_STAATUS_KINNITATUD\') && application.representativeDecisionAddInfo" layout="column"> <md-input-container class="readonly"> <label>{{\'application.representativeDecisionAddInfo\' | translate}}</label> <hois-value value="application.representativeDecisionAddInfo"></hois-value> </md-input-container> </div> <div layout="column" ng-if="application.representativeConfirmed"> <md-input-container class="readonly"> <label>{{\'application.representativeConfirmed\' | translate}}</label> <hois-value value="application.representativeConfirmed | hoisDate"></hois-value> </md-input-container> </div> </div> </fieldset> <div>&nbsp;</div> </div> </div> <style>.inner-form md-input-container.readonly {\r\n      margin-bottom: 0 !important;\r\n      margin-top: 18px !important;\r\n  }</style>'),a.put("application/templates/application.type.tugi.view.html",'<div layout="column" flex class="inner-form" style="margin-top: -1em"> <div layout="column"> <md-input-container class="label-only"> <label>{{\'application.type\' | translate}}</label> <hois-classifier-value ng-model="application.type" main-classifier-code="AVALDUS_LIIK"></hois-classifier-value> </md-input-container> </div> <div ng-if="!(auth.isStudent())" layout="column"> <md-input-container class="label-only"> <label>{{\'student.label\' | translate}}</label> <hois-value value="application.student.nameEt" href-value="\'#/students/\' + application.student.id + \'/main\'"></hois-value> </md-input-container> </div> <div layout="column"> <md-input-container class="label-only"> <label>{{\'main.status\' | translate}}</label> <hois-classifier-value ng-model="application.status" main-classifier-code="AVALDUS_STAATUS"></hois-classifier-value> </md-input-container> </div> <div layout="column"> <md-input-container class="label-only"> <label>{{\'application.createdBy\' | translate}}</label> <hois-value value="application.insertedBy"></hois-value> </md-input-container> </div> <div ng-if="application.status === \'AVALDUS_STAATUS_TAGASI\' && application.rejectReason && !application.representativeConfirmed && !application.committeeDecisionAdded" layout="column"> <md-input-container class="label-only"> <label>{{\'application.rejectReason\' | translate}}</label> <hois-value value="application.rejectReason"></hois-value> </md-input-container> </div> <div>&nbsp;</div> <fieldset> <legend class="md-title-small"> <span md-colors="{color: \'primary-800\'}" style="margin-right: 16px">{{\'application.label\' | translate}}</span> </legend> <div layout="column"> <div ng-if="!application.isAdult" layout="column"> <md-input-container class="label-only"> <label>{{\'application.confirmedByRepresentative\' | translate}}</label> <hois-value value="application.needsRepresentativeConfirm === true || application.status === \'AVALDUS_STAATUS_KOOST\' ? \'main.no\' : \'main.yes\' | translate"></hois-value> </md-input-container> </div> <div layout="column"> <md-input-container class="label-only"> <label>{{\'application.submissionDate\' | translate}}</label> <hois-value value="application.submitted | hoisDate"></hois-value> </md-input-container> </div> <md-input-container> <label>{{\'application.supportService.text\' | translate}}</label> <hois-value value="application.otherText"></hois-value> </md-input-container> <md-input-container flex="60" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'application.additionalInfo\' | translate}}</label> <hois-value value="application.addInfo"></hois-value> </md-input-container> </div> </fieldset> <div ng-if="application.committee">&nbsp;</div> <div ng-if="application.committee"> <fieldset> <legend class="md-title-small"> <span md-colors="{color: \'primary-800\'}" style="margin-right: 16px">{{\'application.committee\' | translate}}</span> </legend> <div layout="column" ng-if="application.committeeAdded"> <md-input-container class="label-only"> <label>{{\'application.committeeAdded\' | translate}}</label> <hois-value value="application.committeeAdded | hoisDate"></hois-value> </md-input-container> </div> <div layout="column" ng-if="application.committeeDecisionAdded"> <md-input-container class="label-only"> <label>{{\'application.committeeDecisionAdded\' | translate}}</label> <hois-value value="application.committeeDecisionAdded | hoisDate"></hois-value> </md-input-container> </div> <div layout="column"> <md-input-container> <label>{{\'application.supportService.committee\' | translate}}</label> <hois-value value="currentLanguageNameField(application.committee)"></hois-value> </md-input-container> </div> <div layout="column" ng-if="application.committee"> <md-input-container> <label>{{\'application.supportService.isDecided\' | translate}}</label> <hois-value value="application.isDecided ? (\'main.yes\' | translate) : application.isDecided === false ? (\'main.no\' | translate) : \'\'"></hois-value> </md-input-container> <md-input-container> <label>{{\'application.supportService.decision\' | translate}}</label> <hois-value value="application.decision"></hois-value> </md-input-container> </div> <div layout="column" ng-if="application.supportServices.length > 0"> <p class="md-body-2">{{\'application.supportService.supportServices\' | translate}}</p> <div layout="column" class="common-label" flex="95" ng-repeat="service in application.supportServices | orderBy: [currentLanguageNameField(), \'code\']"> <div layout="row" flex layout-align="start center" style="margin-bottom: 8px"> <div flex="100">{{($index + 1) + ") " + currentLanguageNameField(service)}}</div> </div> <md-divider ng-if="$last"></md-divider> </div> <br> <div ng-if="tugiIndivCurriculum && application.supportModules.length > 0"> <p class="md-body-2">{{\'application.supportService.individualCurriculum\' | translate}}</p> <md-divider></md-divider> <md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'directive.student.module\' | translate}}</th> <th md-column>{{\'directive.student.distinction\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row md-select="row" ng-repeat="row in application.supportModules | orderBy: [\'module\' + currentLanguageNameField(), \'code\']" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{currentLanguageNameField(row.module)}}</td> <td md-cell style="width: 50%"> <hois-value value="row.addInfo" aria-label="{{\'directive.student.distinction\' | translate}}"></hois-value> </td> </tr> </tbody> </table> </md-table-container> <br> </div> <md-input-container> <label>{{\'application.supportService.implementationPlan\' | translate}}</label> <hois-value value="application.implementationPlan"></hois-value> </md-input-container> </div> <!-- <div layout="column">\r\n          <md-input-container>\r\n            <label>{{\'application.supportService.committeeAddInfo\' | translate}}</label>\r\n            <hois-value value="application.committeeAddInfo"></hois-value>\r\n          </md-input-container>\r\n        </div> --> </fieldset></div>  <div ng-if="(application.status === \'AVALDUS_STAATUS_TAGASI\' || application.status === \'AVALDUS_STAATUS_KINNITATUD\') && application.representativeConfirmed">&nbsp;</div> <fieldset ng-if="(application.status === \'AVALDUS_STAATUS_TAGASI\' || application.status === \'AVALDUS_STAATUS_KINNITATUD\') && application.representativeConfirmed"> <legend class="md-title-small"> <span md-colors="{color: \'primary-800\'}" style="margin-right: 16px">{{\'application.representativeOrStudentDecision\' | translate}}</span> </legend> <div layout="column"> <div ng-if="(application.status === \'AVALDUS_STAATUS_TAGASI\' || application.status === \'AVALDUS_STAATUS_KINNITATUD\') && application.representativeConfirmed" layout="column"> <md-input-container class="label-only"> <label>{{\'application.supportService.isRepresentativeConfirmed\' | translate}}</label> <hois-value value="(application.isRepresentativeConfirmed === true ? \'application.supportService.representativeConfirmed\' : \'application.supportService.representativeRejected\') | translate"></hois-value> </md-input-container> </div> <div ng-if="(application.status === \'AVALDUS_STAATUS_TAGASI\' || application.status === \'AVALDUS_STAATUS_KINNITATUD\') && application.representativeDecisionAddInfo" layout="column"> <md-input-container class="label-only"> <label>{{\'application.representativeDecisionAddInfo\' | translate}}</label> <hois-value value="application.representativeDecisionAddInfo"></hois-value> </md-input-container> </div> <div layout="column" ng-if="application.representativeConfirmed"> <md-input-container class="label-only"> <label>{{\'application.representativeConfirmed\' | translate}}</label> <hois-value value="application.representativeConfirmed | hoisDate"></hois-value> </md-input-container> </div> </div> </fieldset> <div>&nbsp;</div> </div>  <style>.inner-form md-input-container {\r\n      margin-bottom: 0 !important;\r\n      margin-top: 18px !important;\r\n  }</style>'),a.put("application/templates/application.type.valis.edit.html",'<div> <div flex> <fieldset tabindex="1"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.abroadStudies\' | translate}} *</legend> <div layout="column"> <md-input-container layout="row" layout-align="start center" flex="60"> <md-radio-group name="isAbroad" ng-model="application.isAbroad" ng-change="isAbroadChanged()" required layout="row"> <md-radio-button ng-value="false" aria-label="estonian educational institution">{{ \'application.inEstonianEducationalInstitution\' | translate }}</md-radio-button> <md-radio-button ng-value="true" aria-label="abroad educational institution">{{ \'application.inAbroadEducationalInstitution\' | translate }}</md-radio-button> </md-radio-group> </md-input-container> <div layout="row" flex="20" md-colors="{color: \'warn-A400\'}" ng-if="applicationForm.$submitted" ng-messages="applicationForm.isAbroad.$error"> <div ng-message="required">{{\'main.messages.error.inputFieldIsRequired\' | translate}}</div> </div> <div layout="row" layout-sm="column" layout-xs="column" ng-hide="application.isAbroad"> <md-input-container flex="60" flex-sm="100" flex-xs="100"> <label>{{\'main.educationInstitution\' | translate}}</label> <hois-classifier-select ng-model="application.ehisSchool" main-classifier-code="EHIS_KOOL" criteria="{higher: auth.school.higher ? true : undefined, vocational: auth.school.vocational ? true : undefined}" only-valid filter-values="[studentEhisSchool]" by-property="ehisSchool" model-value-attr="code" ng-required="!application.isAbroad"></hois-classifier-select> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column" ng-hide="!application.isAbroad"> <md-input-container flex="60" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'main.educationInstitution\' | translate}}</label> <input type="text" ng-model="application.abroadSchool" ng-required="application.isAbroad"> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column" ng-hide="!application.isAbroad"> <md-input-container flex="60" flex-sm="100" flex-xs="100"> <label>{{\'main.country\' | translate}}</label> <hois-classifier-select ng-model="application.country" main-classifier-code="RIIK" criteria="{higher: auth.school.higher ? true : undefined, vocational: auth.school.vocational ? true : undefined}" only-valid filter-values="[\'RIIK_EST\']" model-value-attr="code" ng-required="application.isAbroad"></hois-classifier-select> </md-input-container> </div> <div ng-include="\'application/templates/period.html\'" ng-init="labelStart=\'application.abroadStudiesStart\';labelEnd=\'application.abroadStudiesEnd\'"> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="60" flex-sm="100" flex-xs="100"> <label>{{\'main.purposeOfStudies\' | translate}}</label> <hois-classifier-select ng-model="application.abroadPurpose" main-classifier-code="VALISOPE_EESMARK" ignore-preselected criteria="{higher: auth.school.higher ? true : undefined, vocational: auth.school.vocational ? true : undefined}" only-valid model-value-attr="code" required></hois-classifier-select> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="60" flex-sm="100" flex-xs="100"> <label>{{\'main.programmeOfStudies\' | translate}}</label> <hois-classifier-select ng-model="application.abroadProgramme" main-classifier-code="VALISKOOL_PROGRAMM" criteria="{higher: auth.school.higher ? true : undefined, vocational: auth.school.vocational ? true : undefined}" only-valid model-value-attr="code" required></hois-classifier-select> </md-input-container> </div> </div> </fieldset> </div> <div>&nbsp;<div> <div layout="column" flex> <fieldset tabindex="1"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.subjects\' | translate}}</legend> <md-button class="md-raised" href="" ng-click="addPlannedSubjectRow()">{{\'main.button.addRow\' | translate}}</md-button> <div layout="row" class="top-margin"> <input style="display:none" type="number" readonly name="plannedSubjectLength" ng-model="plannedSubjectLength" ng-model-options="{ getterSetter: true }" min="1"> <div md-colors="{color: \'warn-A400\'}" ng-messages="applicationForm.plannedSubjectLength.$error"> <div ng-if="applicationForm.$submitted" ng-message="min">{{\'main.messages.error.atLeastOneShouldBeAdded\' | translate}}</div> </div> </div> <md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column><span>{{\'application.plannedSubject\' | translate}} *</span></th> <th md-column><span>{{\'application.substitutableSubject\' | translate}} *</span></th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="plannedSubject in application.plannedSubjects | orderBy: \'id\'" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell> <md-input-container> <input type="text" ng-model="plannedSubject.name" aria-label="planned subject name" required> </md-input-container> </td> <td md-cell> <md-input-container> <hois-select multiple ng-model="plannedSubject.subjectsSelected" ng-change="subjectsSelected(plannedSubject)" aria-label="planned subject equivalent subject" values="studentSubjects" required></hois-select> </md-input-container> </td> <td md-cell> <md-button class="remove nomargin" ng-click="removeFromArray(application.plannedSubjects, plannedSubject)">&times;</md-button> </td> </tr> </tbody> </table> </md-table-container> </fieldset> </div> </div> <div>&nbsp;<div></div></div></div></div>'),a.put("application/templates/application.type.valis.view.html",'<div> <div layout="row"> <md-input-container flex="20" flex-xs="100"> <label>{{\'main.abroadStudies\' | translate}}</label> <hois-value value="application.isAbroad ? (\'main.yes\' | translate) : (\'main.no\' | translate)"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column" ng-hide="application.isAbroad"> <md-input-container flex="60" flex-sm="100" flex-xs="100"> <label>{{\'main.educationInstitution\' | translate}}</label> <hois-classifier-value ng-model="application.ehisSchool" main-classifier-code="EHIS_KOOL"></hois-classifier-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column" ng-hide="!application.isAbroad"> <md-input-container flex="60" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'main.educationInstitution\' | translate}}</label> <hois-value value="application.abroadSchool"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column" ng-hide="!application.isAbroad"> <md-input-container flex="60" flex-sm="100" flex-xs="100"> <label>{{\'main.country\' | translate}}</label> <hois-classifier-value ng-model="application.country" main-classifier-code="RIIK"></hois-classifier-value> </md-input-container> </div> <div ng-include="\'application/templates/period.view.html\'" ng-init="labelStart=\'application.abroadStudiesStart\';labelEnd=\'application.abroadStudiesEnd\'"> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="60" flex-sm="100" flex-xs="100"> <label>{{\'main.purposeOfStudies\' | translate}}</label> <hois-classifier-value ng-model="application.abroadPurpose" main-classifier-code="VALISOPE_EESMARK"></hois-classifier-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="60" flex-sm="100" flex-xs="100"> <label>{{\'main.programmeOfStudies\' | translate}}</label> <hois-classifier-value ng-model="application.abroadProgramme" main-classifier-code="VALISKOOL_PROGRAMM"></hois-classifier-value> </md-input-container> </div> </div> <div> <div layout="column" flex> <div layout="row" class="top-margin"> <h2>{{\'main.subjects\' | translate}} </h2> </div> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column><span>{{\'application.plannedSubject\' | translate}} *</span></th> <th md-column><span>{{\'application.substitutableSubject\' | translate}} *</span></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="plannedSubject in application.plannedSubjects | orderBy: \'id\'" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell> {{plannedSubject.name}} </td> <td md-cell> {{subjectsListView(plannedSubject)}} </td> </tr> </tbody> </table> </div> </div> <div>&nbsp;<div></div></div>'),a.put("application/templates/period.html",'<div layout="row" class="horizontal-radio-group"> <div flex> <label class="common-label">{{\'application.periodType\' | translate}}&nbsp;*</label> <md-input-container> <md-radio-group name="isPeriod" ng-model="application.isPeriod" required ng-change="periodTypeChanged()" layout="row"> <md-radio-button ng-value="true" aria-label="period">{{ \'main.period\' | translate }}</md-radio-button> <md-radio-button ng-value="false" aria-label="date">{{ \'main.date\' | translate }}</md-radio-button> </md-radio-group> <div ng-if="applicationForm.$submitted" ng-messages="applicationForm.isPeriod.$error"> <div ng-message="required">{{\'main.messages.error.inputFieldIsRequired\' | translate}}</div> </div> </md-input-container> </div> </div> <div ng-show="!application.isPeriod" layout="row" layout-sm="column" layout-xs="column"> <div flex> <md-input-container> <label>{{labelStart | translate}}</label> <md-datepicker ng-model="application.startDate" md-min-date="now" md-max-date="application.endDate" md-open-on-focus ng-required="!application.isPeriod"></md-datepicker> </md-input-container> <md-input-container style="margin-left: 0px" flex-offset-xs="0" flex-offset-sm="0" flex-offset="5"> <label>{{labelEnd | translate}}</label> <md-datepicker ng-model="application.endDate" md-min-date="application.startDate" md-open-on-focus ng-required="!application.isPeriod"></md-datepicker> </md-input-container> </div> </div> <div ng-show="application.isPeriod" layout="row" layout-sm="column" layout-xs="column"> <div flex> <md-input-container> <label>{{labelStart | translate}}</label> <hois-select ng-model="application.studyPeriodStart" values="studyPeriods" show-property="display" ng-required="application.isPeriod"></hois-select> </md-input-container> <md-input-container style="margin-left: 0px" flex-offset-xs="0" flex-offset-sm="0" flex-offset="5"> <label>{{labelEnd | translate}}</label> <hois-select ng-model="application.studyPeriodEnd" values="studyPeriods" show-property="display" ng-required="application.isPeriod"></hois-select> </md-input-container> </div> </div>'),a.put("application/templates/period.view.html",'<div layout="row" layout-sm="column" layout-xs="column"> <md-input-container class="label-only" flex="60" flex-sm="100" flex-xs="100"> <label>{{\'application.periodType\' | translate}}</label> <hois-value value="application.isPeriod ? (\'main.period\' | translate) : (\'main.date\' | translate)"></hois-value> </md-input-container> </div> <div ng-show="!application.isPeriod" layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex> <label>{{labelStart | translate}}</label> <hois-value value="application.startDate | hoisDate"></hois-value> </md-input-container> <md-input-container style="margin-left: 0px" flex flex-offset-xs="0" flex-offset-sm="0" flex-offset="5"> <label>{{labelEnd | translate}}</label> <hois-value value="application.endDate | hoisDate"></hois-value> </md-input-container> </div> <div ng-show="application.isPeriod" layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex> <label>{{labelStart | translate}}</label> <hois-value value="studyPeriodView(application.studyPeriodStart)"></hois-value> </md-input-container> <md-input-container flex> <label>{{labelEnd | translate}}</label> <hois-value value="studyPeriodView(application.studyPeriodEnd)"></hois-value> </md-input-container> </div>'),
a.put("baseModule/theme/basemodule.theme.edit.html",'<div aria-label="vocational curriculum implementation plan module theme add dialog" flex> <form name="themeForm" ng-cloak> <div class="ois-form-layout-padding nomargin" layout="column" ng-cloak> <md-input-container flex> <label>{{\'theme.name\' | translate}}</label> <input ng-model="theme.nameEt" type="text" required md-maxlength="255"> </md-input-container> <div layout="row"> <md-input-container> <label>{{\'theme.capacity\' | translate}} ({{\'basemodule.ekap\' | translate}})</label> <input ng-model="theme.credits" name="credits" type="number" min="0" max="999" pattern="^\\d+(\\.\\d{1})?$" ng-change="setDefaultHours()" required> <div ng-messages="themeForm.credits.$error" ng-show="themeForm.credits.$dirty"> <div ng-message="min"> {{\'main.messages.error.positive\' | translate}} </div> <div ng-message="max"> {{\'curriculum.error.max999\' | translate}} </div> <div ng-message="pattern"> {{\'stateCurriculum.error.decimalPresision\' | translate}} </div> </div> </md-input-container> <md-input-container> <label>{{\'theme.unit\' | translate}} ({{\'main.hour\' | translate}})</label> <input ng-model="theme.hours" name="hours" type="number" min="0" max="9999" pattern="^\\d+$" required ng-change="setDefaultCredits()"> <div ng-messages="themeForm.hours.$error" ng-show="theme.hours.$dirty"> <div ng-message="min"> {{\'main.messages.error.positive\' | translate}} </div> <div ng-message="max"> {{\'curriculum.error.max9999\' | translate}} </div> <div ng-message="pattern"> {{\'stateCurriculum.enter.credits.integer\' | translate}} </div> </div> </md-input-container> </div> <div flex> <fieldset tabindex="1"> <legend md-colors="{color: \'default-primary-800\'}" class="md-title-small">{{\'theme.capacityDistribution\' | translate}}</legend> <div layout="row" style="padding-bottom:1em" flex class="secondary-table-header"> <div flex="30">&nbsp;</div> <div flex="30">{{\'basemodule.capacity\' | translate}}</div> <div flex="40" layout="row">{{\'basemodule.contactStudy\' | translate}}</div> </div> <div ng-repeat="item in theme.capacities | orderBy: \'nameEt\' track by item.capacityType" layout="row" class="secondary-table-row"> <div flex="30" class="occupation-module-capacity">{{currentLanguageNameField(item)}}</div> <div flex="30"> <md-input-container flex> <input ng-model="item.hours" type="number" min="0" max="9999" pattern="^\\d+$" aria-label="capacity hours" class="small-input" ng-required="item.contact"> </md-input-container> </div> <div flex="40" layout="row"> <md-checkbox ng-model="item.contact" aria-label="capacity contact" class="occupation-module-capacity-contact"></md-checkbox> </div> </div> </fieldset> </div> <div>&nbsp;</div> <md-input-container flex> <label>{{\'basemodule.subthemes\' | translate}}</label> <textarea ng-model="theme.subthemes" md-maxlength="10000" max-rows="10"></textarea> </md-input-container> <md-input-container flex> <label>{{\'theme.connectionToStudyOutcome\' | translate}}</label> <md-select ng-model="theme.outcomes" md-option="out as (currentLanguageNameField(out.outcomeEt)) for out in theme.outcomes" multiple ng-model-options="{trackBy: \'$value.id\'}"> <md-option ng-repeat="outcome in theme.baseModule.outcomes" ng-value="outcome" aria-label="{{currentLanguage() === \'en\' ? outcome.outcomeEn : outcome.outcomeEt}}">{{currentLanguage() === \'en\' ? outcome.outcomeEn : outcome.outcomeEt}}</md-option> </md-select> </md-input-container> <div>&nbsp;</div> <div flex> <fieldset tabindex="2"> <legend md-colors="{color: \'default-primary-800\'}" class="md-title-small">{{\'basemodule.theme.gradeFormation\' | translate}}</legend> <div layout="column"> <div flex layout="row"> <span flex="30" class="common-label">{{\'theme.assessmentType\' | translate}}</span> <md-radio-group ng-model="theme.assessment" layout="row"> <md-radio-button ng-repeat="option in assessments | orderBy: \'nameEt\' track by option.code" ng-value="option.code" aria-label="{{ currentLanguageNameField(option) }}"> {{ currentLanguageNameField(option) }} </md-radio-button> <md-radio-button ng-value="null" aria-label="{{\'basemodule.theme.noAssessment\' | translate}}"> {{\'basemodule.theme.noAssessment\' | translate}} </md-radio-button> </md-radio-group> </div> <div>&nbsp;</div> <md-input-container flex ng-show="theme.assessment"> <label>{{\'basemodule.totalGradeDescription\' | translate}}</label> <textarea ng-model="theme.totalGradeDescription" md-maxlength="10000" max-rows="10" ng-required="theme.assessment"></textarea> </md-input-container> <div ng-show="theme.assessment === \'KUTSEHINDAMISVIIS_E\'" layout="column" flex> <md-input-container flex> <label>{{\'basemodule.grade3Description\' | translate}}</label> <textarea ng-model="theme.grade3Description" md-maxlength="10000" max-rows="10" ng-required="theme.assessment === \'KUTSEHINDAMISVIIS_E\'"></textarea> </md-input-container> <md-input-container flex> <label>{{\'basemodule.grade4Description\' | translate}}</label> <textarea ng-model="theme.grade4Description" md-maxlength="10000" max-rows="10" ng-required="theme.assessment === \'KUTSEHINDAMISVIIS_E\'"></textarea> </md-input-container> <md-input-container flex> <label>{{\'basemodule.grade5Description\' | translate}}</label> <textarea ng-model="theme.grade5Description" md-maxlength="10000" max-rows="10" ng-required="theme.assessment === \'KUTSEHINDAMISVIIS_E\'"></textarea> </md-input-container> </div> <div ng-show="theme.assessment === \'KUTSEHINDAMISVIIS_M\'" layout="column" flex> <md-input-container flex> <label>{{\'basemodule.gradeADescription\' | translate}}</label> <textarea ng-model="theme.passDescription" md-maxlength="10000" max-rows="2" ng-required="theme.assessment === \'KUTSEHINDAMISVIIS_M\'"></textarea> </md-input-container> </div> </div> </fieldset> </div> <div>&nbsp;</div> </div> <div style="padding-left: 14px"> <md-button class="md-raised md-primary" ng-click="save()">{{"main.button.save" | translate}}</md-button> <md-button class="md-raised" ng-if="theme.id" ng-click="delete()">{{"main.button.delete" | translate}}</md-button> <md-button class="md-raised" ng-click="back(getDefaultUrl(), themeForm)">{{"main.button.back" | translate}}</md-button> </div> </form> </div> <style>.md-select-menu-container {\r\n    max-width: -moz-calc(100vw - 1em);\r\n    max-width: -webkit-calc(100vw - 1em);\r\n    max-width: calc(100vw - 1em);\r\n  }</style>'),a.put("baseModule/theme/basemodule.theme.view.html",'<div aria-label="vocational curriculum implementation plan module theme add dialog" flex> <form name="themeForm" ng-cloak> <div class="ois-form-layout-padding nomargin" layout="column" ng-cloak> <md-input-container> <label>{{\'theme.name\' | translate}}</label> <input ng-model="theme.nameEt" type="text" disabled> </md-input-container> <div layout="row"> <md-input-container> <label>{{\'theme.capacity\' | translate}} ({{\'basemodule.ekap\' | translate}})</label> <input ng-model="theme.credits" name="credits" type="number" disabled> </md-input-container> <md-input-container> <label>{{\'theme.unit\' | translate}} ({{\'main.hour\' | translate}})</label> <input ng-model="theme.hours" name="hours" type="number" disabled> </md-input-container> </div> <div flex> <fieldset tabindex="1"> <legend md-colors="{color: \'default-primary-800\'}" class="md-title-small">{{\'theme.capacityDistribution\' | translate}}</legend> <div layout="row" style="padding-bottom:1em" flex class="secondary-table-header"> <div flex="30">&nbsp;</div> <div flex="30">{{\'basemodule.capacity\' | translate}}</div> <div flex="40" layout="row">{{\'basemodule.contactStudy\' | translate}}</div> </div> <div ng-repeat="item in theme.capacities | orderBy: \'nameEt\' track by item.capacityType" layout="row" class="secondary-table-row"> <div flex="30" class="occupation-module-capacity">{{currentLanguageNameField(item)}}</div> <div flex="30"> <md-input-container flex> <input ng-model="item.hours" type="number" min="0" max="9999" pattern="^\\d+$" aria-label="capacity hours" class="small-input" disabled> </md-input-container> </div> <div flex="40" layout="row"> <md-checkbox ng-model="item.contact" aria-label="capacity contact" class="occupation-module-capacity-contact" disabled></md-checkbox> </div> </div> </fieldset> </div> <div>&nbsp;</div> <md-input-container flex> <label>{{\'basemodule.subthemes\' | translate}}</label> <textarea ng-model="theme.subthemes" max-rows="10" disabled></textarea> </md-input-container> <md-input-container flex> <label>{{\'theme.connectionToStudyOutcome\' | translate}}</label> <textarea ng-value="joinOutcomes(theme.outcomes, \'\\n\')" max-rows="10" disabled></textarea> </md-input-container> <div>&nbsp;</div> <div flex> <fieldset tabindex="2"> <legend md-colors="{color: \'default-primary-800\'}" class="md-title-small">{{\'basemodule.theme.gradeFormation\' | translate}}</legend> <div layout="column"> <div flex layout="row"> <span flex="30" class="common-label">{{\'theme.assessmentType\' | translate}}</span> <md-radio-group ng-model="theme.assessment" layout="row" disabled> <md-radio-button ng-repeat="option in assessments | orderBy: \'nameEt\' track by option.code" ng-value="option.code" aria-label="{{ currentLanguageNameField(option) }}"> {{ currentLanguageNameField(option) }} </md-radio-button> <md-radio-button ng-value="null" aria-label="{{\'basemodule.theme.noAssessment\' | translate}}"> {{\'basemodule.theme.noAssessment\' | translate}} </md-radio-button> </md-radio-group> </div> <div>&nbsp;</div> <md-input-container flex ng-show="theme.assessment"> <label>{{\'basemodule.totalGradeDescription\' | translate}}</label> <textarea ng-model="theme.totalGradeDescription" max-rows="10" disabled></textarea> </md-input-container> <div ng-show="theme.assessment === \'KUTSEHINDAMISVIIS_E\'" layout="column" flex> <md-input-container flex> <label>{{\'basemodule.grade3Description\' | translate}}</label> <textarea ng-model="theme.grade3Description" max-rows="10" disabled></textarea> </md-input-container> <md-input-container flex> <label>{{\'basemodule.grade4Description\' | translate}}</label> <textarea ng-model="theme.grade4Description" max-rows="10" disabled></textarea> </md-input-container> <md-input-container flex> <label>{{\'basemodule.grade5Description\' | translate}}</label> <textarea ng-model="theme.grade5Description" max-rows="10" disabled></textarea> </md-input-container> </div> <div ng-show="theme.assessment === \'KUTSEHINDAMISVIIS_M\'" layout="column" flex> <md-input-container flex> <label>{{\'basemodule.gradeADescription\' | translate}}</label> <textarea ng-model="theme.passDescription" max-rows="2" disabled></textarea> </md-input-container> </div> </div> </fieldset> </div> <div>&nbsp;</div> </div> <div style="padding-left: 14px"> <md-button class="md-raised md-primary" ng-click="edit()">{{"main.button.edit" | translate}}</md-button> <md-button class="md-raised" ng-click="back(getDefaultUrl())">{{"main.button.back" | translate}}</md-button> </div> </form> </div>'),a.put("curriculum/dialog/file.add.dialog.html",'<md-dialog aria-label="file add dialog" flex="40" flex-xs="100"> <form name="dialogForm" ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2>{{"main.addFile" | translate}}</h2> <span flex></span> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <span flex></span> <div class="ois-form-layout" layout="column" layout-margin ng-cloak> <div layout="column"> <md-input-container flex> <label>{{\'ehis.fileType\' | translate}}</label> <hois-classifier-select ng-model="data.ehisFile" main-classifier-code="EHIS_FAIL" required model-value-attr="code" criteria="fileTypeCriteria"></hois-classifier-select> </md-input-container> <md-input-container flex> <lf-ng-md-file-input name="file" lf-files="data.file" lf-browse-label="{{\'main.addFile\' | translate}}" lf-remove-label="{{\'main.button.delete\' | translate}}" lf-placeholder="" lf-required lf-filesize="10MB"> </lf-ng-md-file-input> </md-input-container> <div ng-messages="dialogForm.file.$error"> <div class="invalid" ng-message="required">{{\'main.messages.error.selectFile\' | translate}}</div> <div ng-message="filesize" class="invalid">{{\'curriculum.error.fileSize\' | translate}}</div> </div> </div> </div> </md-dialog-content> <span flex></span> <md-dialog-actions layout="row" layout-align="start center"> <md-button class="md-raised md-primary" ng-click="submit()">{{"main.button.save" | translate}}</md-button> <md-button class="md-raised" ng-click="cancel()">{{"main.button.close" | translate}}</md-button> </md-dialog-actions> </form> </md-dialog>'),a.put("document/templates/diploma.confirm.dialog.html",'<md-dialog aria-label="grade add dialog" flex="30" flex-xs="100" ng-cloak> <md-dialog-content> <div class="md-dialog-content"> <div>{{\'document.confirm.check\' | translate}}</div> <form name="dialogForm"> <div layout="row" ng-repeat="form in forms"> <md-input-container flex="100" flex-sm="100" flex-xs="100"> <label>{{form.fullCode}} - {{form.fullname}}</label> <input type="number" ng-model="form.numeral" min="0" required> </md-input-container> </div> </form> <div>{{\'document.confirm.correct\' | translate}}</div> </div> </md-dialog-content> <md-dialog-actions layout="row" layout-align="start center"> <md-button ng-click="submit()" class="md-raised md-primary">{{\'document.confirm.yes\' | translate}}</md-button> <md-button ng-click="cancel()" class="md-raised">{{\'document.confirm.no\' | translate}}</md-button> </md-dialog-actions> </md-dialog>'),a.put("document/templates/navbar.tmpl.html",'<md-nav-bar md-selected-nav-item="currentNavItem" nav-bar-aria-label="main selection"> <md-nav-item ng-if="isHigher" md-nav-href="#/documents/diplomas?_menu" name="document.diplomas">{{\'document.diplomas\' | translate}}</md-nav-item> <md-nav-item ng-if="isHigher" md-nav-href="#/documents/supplements?_menu" name="document.supplements">{{\'document.supplements\' | translate}}</md-nav-item> <md-nav-item ng-if="!isHigher" md-nav-href="#/documents/diplomas/vocational?_menu" name="document.diplomas.vocational">{{\'document.diplomasVocational\' | translate}}</md-nav-item> <md-nav-item ng-if="!isHigher" md-nav-href="#/documents/supplements/vocational?_menu" name="document.supplements.vocational">{{\'document.supplementsVocational\' | translate}}</md-nav-item> </md-nav-bar>'),a.put("finalProtocol/higher/final.higher.protocol.edit.html",'<div class="ois-form-layout-padding" ng-cloak> <div flex> <form ng-submit="save()" novalidate layout="column" name="finalProtocolForm"> <div ng-include="\'finalProtocol/templates/final.higher.protocol.header.tmpl.html\'"></div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="10" flex-lg="20" flex-md="20" flex-sm="100" flex-xs="100"> <label ng-if="protocol.isFinalThesis" class="required">{{\'finalProtocol.finalDateThesis\' | translate}}</label> <label ng-if="!protocol.isFinalThesis" class="required">{{\'finalProtocol.finalDateExam\' | translate}}</label> <md-datepicker ng-model="protocol.finalDate" ng-change="selectedFinalDateChanged()" ng-disabled="!formState.canEditProtocol" required></md-datepicker> </md-input-container> </div> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'finalProtocol.committee\' | translate}}</legend> <div flex="30" flex-sm="100" flex-xs="100"> <md-input-container style="width: 100%"> <label>{{\'stipend.committee\' | translate}}</label> <hois-select ng-model="protocol.committee" values="committees" ng-change="selectedCommitteeChanged()" ng-disabled="!formState.canEditProtocol"></hois-select> </md-input-container> </div> <md-table-container ng-if="committeeMembers"> <table md-table md-progress="protocol.$promise" class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'finalProtocol.name\' | translate}}</th> <th md-column>{{\'finalProtocol.role\' | translate}}</th> <th md-column>{{\'finalProtocol.present\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in committeeMembers | orderBy: \'memberName\'" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{row.memberName}}</td> <td md-cell ng-if="row.isChairman">{{\'finalProtocol.chairman\' | translate}}</td> <td md-cell ng-if="!row.isChairman">{{\'finalProtocol.member\' | translate}}</td> <td md-cell> <md-checkbox aria-label="module" ng-model="row.isPresent" ng-disabled="!formState.canEditProtocol"></md-checkbox> </td> </tr> </tbody> </table> </md-table-container> </fieldset> <div>&nbsp;</div> <div> <div flex> <md-table-container> <table md-table md-progress="protocol.$promise" multiple> <thead md-head> <tr md-row> <th md-column>{{\'finalProtocol.id\' | translate}}</th> <th md-column>{{\'student.label\' | translate}}</th> <th md-column>{{\'student.idcode\' | translate}}</th> <th md-column>{{\'finalProtocol.studentGroup\' | translate}}</th> <th md-column>{{\'finalProtocol.grade\' | translate}}</th> <th md-column ng-if="formState.canChangeConfirmedProtocolGrade">{{\'finalProtocol.changeReason\' | translate}}</th> <th md-column ng-repeat="grade in protocol.curriculumGrades">{{currentLanguageNameField(grade)}}</th> <th md-column ng-repeat="occupation in protocol.occupations">{{currentLanguageNameField(occupation)}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in protocol.protocolStudents | orderBy: \'fullname\' track by $index" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{$index + 1}}</td> <td md-cell>{{row.fullname}}</td> <td md-cell>{{row.idcode}}</td> <td md-cell>{{row.studentGroup}}</td> <td md-cell> <hois-select class="protocolGradeSelect" ng-model="row.grade" values="grades" show-property="{{auth.school.letterGrades ? \'value2\' : \'value\'}}" hide-values="hideInvalid" value-property="code" aria-label="grade" ng-change="gradeChanged(row)" ng-disabled="!formState.canEditProtocol"></hois-select> </td> <td md-cell ng-if="formState.canChangeConfirmedProtocolGrade"> <md-input-container ng-if="row.gradeHasChanged"> <input ng-model="row.addInfo" aria-label="addInfo" type="text" md-maxlength="255" ng-change="addInfoChanged(row);" required> </md-input-container> <span ng-if="row.addInfo && !row.gradeHasChanged"> {{row.addInfo}} </span> </td> <td md-cell ng-repeat="grade in protocol.curriculumGrades"> <md-checkbox ng-click="setCurriculumGrade(row, grade.id)" ng-checked="grade.id === row.curriculumGrade.id" ng-disabled="!formState.canEditProtocol" aria-label="{{currentLanguageNameField(grade)}}"></md-checkbox> </td> <td md-cell ng-repeat="occupation in protocol.occupations"> <md-checkbox ng-model="row.occupations[occupation.code].granted" aria-label="{{occupation.code}}" ng-disabled="!formState.canEditProtocol || !row.canGrantOccupation" ng-change="setOccupation(row, occupation.code)"></md-checkbox> {{row.occupations[occupation.code].certificateNr}} </td> <td md-cell> <a ng-if="row.canBeDeleted && formState.canAddDeleteStudents" ng-click="deleteProtocolStudent(row)" class="remove">&times;</a> </td> </tr> </tbody> </table> </md-table-container> </div> </div> <div>&nbsp;</div> <div layout="row"> <md-button ng-if="formState.canEditProtocol && protocol.status.code !== \'PROTOKOLL_STAATUS_K\'" class="md-raised md-primary" type="submit">{{\'main.button.save\' | translate}}</md-button> <hois-button ng-if="formState.canConfirm" class="md-raised md-primary" hb-click="confirm()" hb-label="{{\'main.button.confirm\' | translate}}" hb-loading hb-promise></hois-button> <md-button ng-if="protocol.canBeDeleted" class="md-raised" ng-click="delete()">{{\'main.button.delete\' | translate}}</md-button> <a ng-show="formState.protocolPdfUrl" ng-href="{{formState.protocolPdfUrl}}" target="_blank" class="md-button md-raised">{{\'main.button.print\' | translate}}</a> <a ng-show="protocol.oisFile" ng-href="{{getUrl(protocol.oisFile, \'protocol\')}}" target="_blank" rel="noopener noreferrer" class="md-button md-raised">{{\'finalProtocol.downloadSigned\' | translate}}</a> <md-button class="md-raised" ng-click="back(\'#/finalHigherProtocols/\', finalProtocolForm)">{{\'main.button.back\' | translate}}</md-button> </div> </form> </div> </div>'),a.put("finalProtocol/higher/final.higher.protocol.list.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <form name="searchForm" ng-submit="searchForm.$valid && loadData()" novalidate class="nomargin" ng-model-options="{allowInvalid: true}"> <div ng-if="auth.isAdmin()" layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="50" flex-sm="100" flex-xs="100"> <label>{{\'finalThesis.student\' | translate}}</label> <input ng-model="criteria.studentName" type="text" md-maxlength="255"> </md-input-container> <md-input-container flex="50" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> </md-input-container> </div> <div ng-if="auth.isAdmin()" layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="50" flex-sm="100" flex-xs="100"> <label>{{\'finalProtocol.protocolType\' | translate}}</label> <md-select ng-model="criteria.isFinalThesis" aria-label="{{\'finalProtocol.protocolType\' | translate}}"> <md-option md-option-empty></md-option> <md-option ng-value="true">{{\'finalProtocol.finalThesis\' | translate}}</md-option> <md-option ng-value="false">{{\'finalProtocol.finalExam\' | translate}}</md-option> </md-select> </md-input-container> <md-input-container flex="50" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label class="textInput">{{\'finalProtocol.protocolStatus\' | translate}}</label> <hois-classifier-select ng-model="criteria.status" main-classifier-code="PROTOKOLL_STAATUS" model-value-attr="code"></hois-classifier-select> </md-input-container> </div> <div ng-if="auth.isTeacher()" layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="50" flex-sm="100" flex-xs="100"> <label>{{\'finalThesis.student\' | translate}}</label> <input ng-model="criteria.studentName" type="text" md-maxlength="255"> </md-input-container> <md-input-container flex="50" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label class="textInput">{{\'finalProtocol.protocolStatus\' | translate}}</label> <hois-classifier-select ng-model="criteria.status" main-classifier-code="PROTOKOLL_STAATUS" model-value-attr="code"></hois-classifier-select> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="50" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'finalProtocol.protocolNr\' | translate}}</label> <input type="text" ng-model="criteria.protocolNr" md-maxlength="255"> </md-input-container> <md-input-container flex="50" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label class="textInput">{{\'higherProtocol.subject\' | translate}}</label> <input type="text" ng-model="criteria.subject" md-maxlength="255"> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <div flex="50" flex-sm="100" flex-xs="100"> <div layout="column" flex> <div layout="row" flex> <md-input-container> <label>{{\'finalProtocol.insertedFrom\' | translate}}</label> <md-datepicker ng-model="criteria.insertedFrom" md-max-date="criteria.insertedThru" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> <md-input-container flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'finalProtocol.insertedThru\' | translate}}</label> <md-datepicker ng-model="criteria.insertedThru" md-min-date="criteria.insertedFrom" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> </div> </div> </div> <div flex="50" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <div layout="column" flex> <div layout="row" flex> <md-input-container> <label>{{\'finalProtocol.confirmedFrom\' | translate}}</label> <md-datepicker ng-model="criteria.confirmDateFrom" md-max-date="criteria.confirmDateThru" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> <md-input-container flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'finalProtocol.confirmedThru\' | translate}}</label> <md-datepicker ng-model="criteria.confirmDateThru" md-min-date="criteria.confirmDateFrom" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> </div> </div> </div> </div> <div layout="row"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> <md-button class="md-raised" ng-href="#/finalHigherProtocols/exam/new" ng-if="formState.canCreateProtocol">{{\'finalProtocol.addFinalExamProtocol\' | translate}}</md-button> <md-button class="md-raised" ng-href="#/finalHigherProtocols/thesis/new" ng-if="formState.canCreateProtocol && auth.isAdmin()">{{\'finalProtocol.addFinalThesisProtocol\' | translate}}</md-button> </div> <div flex-xs="0" flex-gt-xs="0" flex-gt-sm="50"></div> </form> </fieldset> </div> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="2">{{\'finalProtocol.protocolNr\' | translate}}</th> <th md-column ng-if="auth.isAdmin()" md-order-by="3">{{\'finalProtocol.protocolType\' | translate}}</th> <th md-column md-order-by="4">{{\'finalProtocol.status\' | translate}}</th> <th md-column md-order-by="{{currentLanguage()===\'en\' ? \'6, 8, 9\' : \'6, 7, 9\'}}">{{\'finalProtocol.subject\' | translate}}</th> <th md-column md-order-by="11, 12, 13">{{\'finalProtocol.committeeChairman\' | translate}}</th> <th md-column md-order-by="14">{{\'finalProtocol.insertedDate\' | translate}}</th> <th md-column md-order-by="15">{{\'finalProtocol.confirmedDate\' | translate}}</th> <th md-column md-order-by="16">{{\'finalProtocol.confirmer\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell> <a ng-href="#/finalHigherProtocols/{{::row.id}}/view">{{::row.protocolNr}}</a> </td> <td md-cell ng-if="auth.isAdmin()"> <span ng-if="row.isFinalThesis">{{\'finalProtocol.finalThesis\' | translate}}</span> <span ng-if="!row.isFinalThesis">{{\'finalProtocol.finalExam\' | translate}}</span> </td> <td md-cell>{{currentLanguageNameField(row.status)}}</td> <td md-cell>{{currentLanguageNameField(row.subject)}}</td> <td md-cell>{{row.committeeChairman}}</td> <td md-cell>{{row.inserted | hoisDate}}</td> <td md-cell>{{row.confirmDate | hoisDate}}</td> <td md-cell>{{::row.confirmer}}</td> <td md-cell> <md-button ng-if="row.canChange && row.status.code !== \'PROTOKOLL_STAATUS_K\'" md-no-ink class="md-primary change-button" ng-href="#/finalHigherProtocols/{{::row.id}}/edit">{{\'main.button.change\' | translate}}</md-button> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> </div>'),a.put("finalProtocol/higher/final.higher.protocol.new.html",'<div class="ois-form-layout-padding" ng-cloak> <div flex> <form ng-submit="submit()" novalidate layout="column" name="finalProtocolNewForm"> <div> <div ng-if="!formState.isFinalThesis" layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="100" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'finalProtocol.studyPeriod\' | translate}}</label> <hois-select ng-model="formState.studyPeriod" values="studyPeriods" ng-change="studyPeriodChanged()" required autofocus></hois-select> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex flex-sm="100"> <label class="textInput">{{\'finalProtocol.curriculum\' | translate}}</label> <md-select ng-model="formState.curriculum" ng-change="curriculumChanged()" required> <md-option ng-repeat="curriculum in curriculums | orderBy: currentLanguageNameField()" ng-value="curriculum.id">{{currentLanguageNameField(curriculum)}}</md-option> </md-select> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex flex-sm="100"> <label class="textInput">{{\'finalProtocol.subject\' | translate}}</label> <md-select ng-model="formState.subject" ng-change="subjectChanged()" required> <md-option ng-repeat="subject in formState.subjects | orderBy: currentLanguageNameField()" ng-value="subject">{{currentLanguageNameField(subject)}}</md-option> </md-select> </md-input-container> </div> <br> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise" md-row-select multiple ng-model="formState.selectedStudents"> <thead md-head> <tr md-row flex> <th md-column> <span>{{\'student.label\' | translate}}</span> </th> <th md-column> <span>{{\'student.idcode\' | translate}}</span> </th> </tr> </thead> <tbody md-body> <tr md-row md-select="row.studentId" ng-repeat="row in tabledata.content | orderBy: \'fullname\'" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{row.fullname}}</td> <td md-cell>{{row.idcode}}</td> </tr> </tbody> </table> </md-table-container> </div> <br> <div layout="row"> <md-button class="md-raised md-primary" type="submit">{{\'finalProtocol.create\' | translate}}</md-button> <md-button class="md-raised" ng-click="back(\'#/finalHigherProtocols/\')">{{\'main.button.back\' | translate}}</md-button> </div> </div> </form> </div> </div>'),a.put("finalProtocol/higher/final.higher.protocol.view.html",'<div class="ois-form-layout-padding" ng-cloak> <div flex> <form layout="column" name="finalProtocolForm"> <div ng-include="\'finalProtocol/templates/final.higher.protocol.header.tmpl.html\'"></div> <div class="form-readonly"> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="20" flex-sm="100" flex-xs="100"> <label ng-if="protocol.isFinalThesis">{{\'finalProtocol.finalDateThesis\' | translate}}</label> <label ng-if="!protocol.isFinalThesis">{{\'finalProtocol.finalDateExam\' | translate}}</label> <hois-value value="protocol.finalDate | hoisDate"></hois-value> </md-input-container> </div> </div> <fieldset ng-if="committeeMembers"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'finalProtocol.committee\' | translate}}</legend> <md-table-container> <table md-table md-progress="protocol.$promise" class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'finalProtocol.name\' | translate}}</th> <th md-column>{{\'finalProtocol.role\' | translate}}</th> <th md-column>{{\'finalProtocol.present\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in committeeMembers | orderBy: \'memberName\'" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{row.memberName}}</td> <td md-cell ng-if="row.isChairman">{{\'finalProtocol.chairman\' | translate}}</td> <td md-cell ng-if="!row.isChairman">{{\'finalProtocol.member\' | translate}}</td> <td md-cell> <md-checkbox aria-label="module" ng-model="row.isPresent" disabled></md-checkbox> </td> </tr> </tbody> </table> </md-table-container> </fieldset> <div>&nbsp;</div> <div> <div flex> <md-table-container> <table md-table md-progress="protocol.$promise" multiple> <thead md-head> <tr md-row> <th md-column>{{\'finalProtocol.id\' | translate}}</th> <th md-column>{{\'student.label\' | translate}}</th> <th md-column>{{\'student.idcode\' | translate}}</th> <th md-column>{{\'finalProtocol.studentGroup\' | translate}}</th> <th md-column>{{\'finalProtocol.grade\' | translate}}</th> <th md-column ng-if="protocol.status.code === \'PROTOKOLL_STAATUS_K\'">{{\'finalProtocol.changeReason\' | translate}}</th> <th md-column>{{\'finalProtocol.givenCurriculumGrade\' | translate}}</th> <th md-column>{{\'finalProtocol.givenOccupation\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in protocol.protocolStudents | orderBy: \'fullname\' track by $index" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{$index + 1}}</td> <td md-cell>{{row.fullname}}</td> <td md-cell>{{row.idcode}}</td> <td md-cell>{{row.studentGroup}}</td> <td md-cell> <span ng-class="{badResult: !gradeUtil.isPositive(row.grade, auth.school.letterGrades)}">{{gradeValue(row.grade)}}</span> </td> <td md-cell ng-if="protocol.status.code === \'PROTOKOLL_STAATUS_K\'">{{row.addInfo}}</td> <td md-cell>{{currentLanguageNameField(row.curriculumGrade)}}</td> <td md-cell> <span ng-repeat="occupation in protocol.occupations track by $index"> <span ng-if="row.occupations[occupation.code].granted"> <span>{{currentLanguageNameField(occupation)}}</span> <span ng-if="row.occupations[occupation.code].certificateNr">({{row.occupations[occupation.code].certificateNr}})</span> &nbsp; </span> </span> </td> </tr> </tbody> </table> </md-table-container> </div> </div> <div>&nbsp;</div> <div layout="row"> <md-button ng-if="formState.canEditProtocol" class="md-primary md-raised" ng-href="#/finalHigherProtocols/{{::protocol.id}}/edit">{{\'main.button.change\' | translate}}</md-button> <a ng-show="formState.protocolPdfUrl" ng-href="{{formState.protocolPdfUrl}}" target="_blank" class="md-button md-raised">{{\'main.button.print\' | translate}}</a> <a ng-show="protocol.oisFile" ng-href="{{getUrl(protocol.oisFile, \'protocol\')}}" target="_blank" rel="noopener noreferrer" class="md-button md-raised">{{\'finalProtocol.downloadSigned\' | translate}}</a> <md-button class="md-raised" ng-click="back(\'#/finalHigherProtocols/\')">{{\'main.button.back\' | translate}}</md-button> </div> </form> </div> </div>'),
a.put("finalProtocol/templates/final.higher.protocol.header.tmpl.html",'<div class="form-readonly"> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex flex-sm="100" flex-xs="100"> <label>{{\'finalProtocol.protocolNr\' | translate}}</label> <hois-value value="protocol.protocolNr"></hois-value> </md-input-container> <md-input-container flex flex-sm="100" flex-xs="100"> <label>{{\'finalProtocol.status\' | translate}}</label> <hois-value value="currentLanguageNameField(protocol.status)"></hois-value> </md-input-container> <md-input-container ng-if="!protocol.isFinalThesis" flex flex-sm="100" flex-xs="100"> <label>{{\'finalProtocol.studyPeriod\' | translate}}</label> <hois-value value="currentLanguageNameField(protocol.studyPeriod)"></hois-value> </md-input-container> <md-input-container flex flex-sm="100" flex-xs="100"> <label>{{\'finalProtocol.inserted\' | translate}} / {{\'moduleProtocol.confirmDate\' | translate}}</label> <hois-value ng-if="protocol.confirmDate" value="(protocol.inserted | hoisDate).concat(\' / \').concat(protocol.confirmDate | hoisDate)"></hois-value> <hois-value ng-if="!protocol.confirmDate" value="protocol.inserted | hoisDate"></hois-value> </md-input-container> <md-input-container flex flex-sm="100" flex-xs="100"> <label>{{\'finalProtocol.confirmer\' | translate}}</label> <hois-value value="protocol.confirmedBy"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex flex-sm="100" flex-xs="100"> <label>{{\'finalProtocol.subject\' | translate}}</label> <hois-value value="currentLanguageNameField(protocol.subject)"></hois-value> </md-input-container> <md-input-container flex flex-sm="100" flex-xs="100"> <label>{{\'finalProtocol.studyLevel\' | translate}}</label> <hois-value value="currentLanguageNameField(protocol.studyLevel)"></hois-value> </md-input-container> <md-input-container flex flex-sm="100" flex-xs="100"> <label>{{\'finalProtocol.credits\' | translate}}</label> <hois-value value="protocol.subject.credits + \' \' + (\'finalProtocol.higherCreditsUnit\' | translate)"></hois-value> </md-input-container> <md-input-container flex flex-sm="100" flex-xs="100"> <label>{{\'finalProtocol.assessment\' | translate}}</label> <hois-classifier-value ng-model="protocol.subject.assessment" main-classifier-code="HINDAMISVIIS"></hois-classifier-value> </md-input-container> <md-input-container ng-if="!protocol.isFinalThesis" flex flex-sm="100" flex-xs="100"> <label>{{auth.higher ? (\'finalProtocol.teacherHigher\' | translate) : (\'finalProtocol.teacherVocational\' | translate)}}</label> <hois-value value="protocol.teachers.join(\', \')"></hois-value> </md-input-container> </div> <br> </div>'),a.put("finalProtocol/templates/final.protocol.add.student.dialog.html",'<md-dialog aria-label="add student dialog"> <form name="dialogForm" ng-submit="loadData()" novalidate ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2>{{\'finalProtocol.addStudents\' | translate}}</h2> <span flex></span> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <div class="md-dialog-content"> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise" md-row-select multiple ng-model="selectedStudents"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row flex> <th md-column> <span>{{\'student.label\' | translate}}</span> </th> <th md-column> <span>{{\'student.idcode\' | translate}}</span> </th> <th md-column> <span>{{\'main.status\' | translate}}</span> </th> </tr> </thead> <tbody md-body> <tr md-row md-select="row.studentId" ng-repeat="row in tabledata.content | orderBy: \'fullname\'" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{row.fullname}}</td> <td md-cell>{{row.idcode}}</td> <td md-cell>{{currentLanguageNameField(row.status)}}</td> </tr> </tbody> </table> </md-table-container> </div> </div> </div> </md-dialog-content> <span flex></span> <md-dialog-actions layout="row" layout-align="start center"> <md-button class="md-raised md-primary" ng-click="submit()">{{\'finalProtocol.addStudents\' | translate}}</md-button> <md-button class="md-raised" ng-click="cancel()">{{"main.button.close" | translate}}</md-button> </md-dialog-actions> </form> </md-dialog>'),a.put("finalProtocol/templates/final.protocol.mobile.sign.dialog.html",'<md-dialog> <form> <md-dialog-content> <div class="md-dialog-content" layout="column" layout-align="center center"> <p>{{ \'finalProtocol.mobileSign.instructions\' | translate }}</p> <h1>{{challengeID}}</h1> </div> </md-dialog-content> </form> </md-dialog>'),a.put("finalProtocol/templates/final.vocational.protocol.header.tmpl.html",'<div class="form-readonly"> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex flex-sm="100" flex-xs="100"> <label>{{\'finalProtocol.protocolNr\' | translate}}</label> <hois-value value="protocol.protocolNr"></hois-value> </md-input-container> <md-input-container flex flex-sm="100" flex-xs="100"> <label>{{\'finalProtocol.status\' | translate}}</label> <hois-value value="currentLanguageNameField(protocol.status)"></hois-value> </md-input-container> <md-input-container flex flex-sm="100" flex-xs="100"> <label>{{\'finalProtocol.studyPeriod\' | translate}}</label> <hois-value value="currentLanguageNameField(protocol.protocolVdata.studyYear)"></hois-value> </md-input-container> <md-input-container flex flex-sm="100" flex-xs="100"> <label>{{\'finalProtocol.inserted\' | translate}} / {{\'moduleProtocol.confirmDate\' | translate}}</label> <hois-value ng-if="protocol.confirmDate" value="(protocol.inserted | hoisDate).concat(\' / \').concat(protocol.confirmDate | hoisDate)"></hois-value> <hois-value ng-if="!protocol.confirmDate" value="protocol.inserted | hoisDate"></hois-value> </md-input-container> <md-input-container flex flex-sm="100" flex-xs="100"> <label>{{\'finalProtocol.confirmer\' | translate}}</label> <hois-value value="protocol.confirmer"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex flex-sm="100" flex-xs="100"> <label>{{\'finalProtocol.implementationPlan\' | translate}}</label> <hois-value value="currentLanguageNameField(protocol.protocolVdata.curriculumVersion)"></hois-value> </md-input-container> <md-input-container flex flex-sm="100" flex-xs="100"> <label>{{\'finalProtocol.module\' | translate}}</label> <hois-value value="currentLanguageNameField(protocol.protocolVdata.curriculumVersionOccupationModule)" href-value="\'#/occupationModule/\' + protocol.protocolVdata.curriculum + \'/\' + protocol.protocolVdata.curriculumVersion.id + \'/\' + protocol.protocolVdata.curriculumModule + \'/\' + protocol.protocolVdata.curriculumVersionOccupationModule.id + \'/view\'"></hois-value> </md-input-container> <md-input-container flex flex-sm="100" flex-xs="100"> <label>{{\'finalProtocol.credits\' | translate}}</label> <hois-value value="protocol.protocolVdata.moduleCredits + \' \' + (\'finalProtocol.vocationalCreditsUnit\' | translate)"></hois-value> </md-input-container> <md-input-container flex flex-sm="100" flex-xs="100"> <label>{{\'finalProtocol.assessment\' | translate}}</label> <hois-classifier-value ng-model="protocol.protocolVdata.assessment" main-classifier-code="KUTSEHINDAMISVIIS"></hois-classifier-value> </md-input-container> <md-input-container flex flex-sm="100" flex-xs="100"> <label>{{auth.higher ? (\'finalProtocol.teacherHigher\' | translate) : (\'finalProtocol.teacherVocational\' | translate)}}</label> <hois-value value="currentLanguageNameField(protocol.protocolVdata.teacher)"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="20" flex-sm="100" flex-xs="100"> <label>{{\'finalProtocol.studyLevel\' | translate}}</label> <hois-value value="currentLanguageNameField(protocol.studyLevel)"></hois-value> </md-input-container> </div> <br> </div>'),a.put("finalProtocol/vocational/final.vocational.protocol.edit.html",'<div class="ois-form-layout-padding" ng-cloak> <div flex> <form ng-submit="save()" novalidate layout="column" name="finalProtocolForm"> <div ng-include="\'finalProtocol/templates/final.vocational.protocol.header.tmpl.html\'"></div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="10" flex-lg="20" flex-md="20" flex-sm="100" flex-xs="100"> <label ng-if="protocol.isFinalThesis" class="required">{{\'finalProtocol.finalDateThesis\' | translate}}</label> <label ng-if="!protocol.isFinalThesis" class="required">{{\'finalProtocol.finalDateExam\' | translate}}</label> <md-datepicker ng-model="protocol.finalDate" ng-change="selectedFinalDateChanged()" ng-disabled="!formState.canEditProtocol" required></md-datepicker> </md-input-container> </div> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'finalProtocol.committee\' | translate}}</legend> <div flex="30" flex-sm="100" flex-xs="100"> <md-input-container style="width: 100%"> <label>{{\'stipend.committee\' | translate}}</label> <hois-select ng-model="protocol.committee" values="committees" ng-change="selectedCommitteeChanged()" ng-disabled="!formState.canEditProtocol"></hois-select> </md-input-container> </div> <md-table-container ng-if="committeeMembers"> <table md-table md-progress="protocol.$promise" class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'finalProtocol.name\' | translate}}</th> <th md-column>{{\'finalProtocol.role\' | translate}}</th> <th md-column>{{\'finalProtocol.present\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in committeeMembers | orderBy: \'memberName\'" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{row.memberName}}</td> <td md-cell ng-if="row.isChairman">{{\'finalProtocol.chairman\' | translate}}</td> <td md-cell ng-if="!row.isChairman">{{\'finalProtocol.member\' | translate}}</td> <td md-cell> <md-checkbox aria-label="module" ng-model="row.isPresent" ng-disabled="!formState.canEditProtocol"></md-checkbox> </td> </tr> </tbody> </table> </md-table-container> </fieldset> <div>&nbsp;</div> <div> <div flex> <md-table-container> <table md-table md-progress="protocol.$promise" multiple> <thead md-head> <tr md-row> <th md-column>{{\'finalProtocol.id\' | translate}}</th> <th md-column>{{\'student.label\' | translate}}</th> <th md-column ng-if="protocol.isFinalThesis">{{\'finalProtocol.theme\' | translate}}</th> <th md-column>{{\'finalProtocol.grade\' | translate}}</th> <th md-column ng-if="formState.canChangeConfirmedProtocolGrade">{{\'finalProtocol.changeReason\' | translate}}</th> <th md-column ng-repeat="occupation in protocol.occupations">{{occupation | hoisValidDates}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in protocol.protocolStudents | orderBy: \'fullname\' track by $index" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{$index + 1}}</td> <td md-cell>{{row.fullname}}</td> <td md-cell ng-if="protocol.isFinalThesis">{{row.theme.nameEt}}</td> <td md-cell> <hois-select class="protocolGradeSelect" ng-model="row.grade" values="grades" show-property="value" value-property="code" hide-values="hideInvalid" aria-label="grade" ng-change="gradeChanged(row)" ng-disabled="!formState.canEditProtocol"></hois-select> </td> <td md-cell ng-if="formState.canChangeConfirmedProtocolGrade"> <md-input-container ng-if="row.gradeHasChanged"> <input ng-model="row.addInfo" aria-label="addInfo" type="text" md-maxlength="255" ng-change="addInfoChanged(row);" required> </md-input-container> <span ng-if="row.addInfo && !row.gradeHasChanged"> {{row.addInfo}} </span> </td> <td md-cell ng-repeat="occupation in protocol.occupations"> <md-checkbox ng-model="row.occupations[occupation.code].granted" aria-label="{{occupation.code}}" ng-disabled="!formState.canEditProtocol || !occupation.isOccupationGrant || (occupation.isOccupationGrant && (row.occupations[occupation.code].ceritificateId != null))"></md-checkbox> {{row.occupations[occupation.code].certificateNr}} </td> <td md-cell> <a ng-if="row.canBeDeleted && formState.canAddDeleteStudents" ng-click="deleteProtocolStudent(row)" class="remove">&times;</a> </td> </tr> </tbody> </table> </md-table-container> </div> </div> <div>&nbsp;</div> <div layout="row"> <md-button ng-if="formState.canEditProtocol && protocol.status.code !== \'PROTOKOLL_STAATUS_K\'" class="md-raised md-primary" type="submit">{{\'main.button.save\' | translate}}</md-button> <md-button ng-if="formState.canAddDeleteStudents" class="md-raised" ng-click="addProtocolStudents()">{{\'finalProtocol.addStudents\' | translate}}</md-button> <hois-button ng-if="formState.canConfirm" class="md-raised md-primary" hb-click="confirm()" hb-label="{{\'main.button.confirm\' | translate}}" hb-loading hb-promise></hois-button> <md-button ng-if="protocol.canBeDeleted" class="md-raised" ng-click="delete()">{{\'main.button.delete\' | translate}}</md-button> <a ng-show="formState.protocolPdfUrl" ng-href="{{formState.protocolPdfUrl}}" target="_blank" class="md-button md-raised">{{\'main.button.print\' | translate}}</a> <a ng-show="protocol.oisFile" ng-href="{{getUrl(protocol.oisFile, \'protocol\')}}" target="_blank" rel="noopener noreferrer" class="md-button md-raised">{{\'finalProtocol.downloadSigned\' | translate}}</a> <md-button class="md-raised" ng-click="back(\'#/finalVocationalProtocols/\', finalProtocolForm)">{{\'main.button.back\' | translate}}</md-button> </div> </form> </div> </div>'),a.put("finalProtocol/vocational/final.vocational.protocol.list.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <form name="searchForm" ng-submit="load()" novalidate class="nomargin" ng-model-options="{allowInvalid: true}"> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="50" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'finalProtocol.studyYear\' | translate}}</label> <hois-select ng-model="criteria.studyYear" type="studyyear" select-current-study-year required autofocus></hois-select> </md-input-container> <md-input-container flex="50" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'finalThesis.student\' | translate}}</label> <input ng-model="criteria.studentName" type="text" md-maxlength="255"> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="50" flex-sm="100" flex-xs="100"> <label>{{\'finalProtocol.protocolType\' | translate}}</label> <md-select ng-model="criteria.isFinalThesis" aria-label="{{\'finalProtocol.protocolType\' | translate}}"> <md-option md-option-empty></md-option> <md-option ng-value="true">{{\'finalProtocol.finalThesis\' | translate}}</md-option> <md-option ng-value="false">{{\'finalProtocol.finalExam\' | translate}}</md-option> </md-select> </md-input-container> <md-input-container flex="50" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label class="textInput">{{\'finalProtocol.protocolStatus\' | translate}}</label> <hois-classifier-select ng-model="criteria.status" main-classifier-code="PROTOKOLL_STAATUS" model-value-attr="code"></hois-classifier-select> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="50" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'finalProtocol.protocolNr\' | translate}}</label> <input type="text" ng-model="criteria.protocolNr" md-maxlength="255"> </md-input-container> <div flex="50" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <hois-autocomplete label="finalProtocol.module" ng-model="criteria.moduleObject" ha-controller="directiveControllers" method="vocationalmodules"></hois-autocomplete> </div> </div> <div layout="row" layout-sm="column" layout-xs="column"> <div flex="50" flex-sm="100" flex-xs="100"> <div layout="column" flex> <div layout="row" flex> <md-input-container> <label>{{\'finalProtocol.insertedFrom\' | translate}}</label> <md-datepicker ng-model="criteria.insertedFrom" md-max-date="criteria.insertedThru" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> <md-input-container flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'finalProtocol.insertedThru\' | translate}}</label> <md-datepicker ng-model="criteria.insertedThru" md-min-date="criteria.insertedFrom" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> </div> </div> </div> <div flex="50" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <div layout="column" flex> <div layout="row" flex> <md-input-container> <label>{{\'finalProtocol.confirmedFrom\' | translate}}</label> <md-datepicker ng-model="criteria.confirmDateFrom" md-max-date="criteria.confirmDateThru" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> <md-input-container flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'finalProtocol.confirmedThru\' | translate}}</label> <md-datepicker ng-model="criteria.confirmDateThru" md-min-date="criteria.confirmDateFrom" hois-datepicker-extension hd-controller="directiveControllers"></md-datepicker> </md-input-container> </div> </div> </div> </div> <div layout="row"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> <md-button class="md-raised" ng-href="#/finalVocationalProtocols/exam/new" ng-if="formState.canCreateProtocol">{{\'finalProtocol.addFinalExamProtocol\' | translate}}</md-button> <md-button ng-if="auth.isAdmin() && formState.canCreateProtocol" class="md-raised" ng-href="#/finalVocationalProtocols/thesis/new">{{\'finalProtocol.addFinalThesisProtocol\' | translate}}</md-button> </div> <div flex-xs="0" flex-gt-xs="0" flex-gt-sm="50"></div> </form> </fieldset> </div> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="2">{{\'finalProtocol.protocolNr\' | translate}}</th> <th md-column md-order-by="3">{{\'finalProtocol.protocolType\' | translate}}</th> <th md-column>{{\'finalProtocol.curriculumVersionModule\' | translate}}</th> <th md-column md-order-by="15, 16, 17">{{\'finalProtocol.committeeChairman\' | translate}}</th> <th md-column md-order-by="4">{{\'finalProtocol.status\' | translate}}</th> <th md-column md-order-by="18">{{\'finalProtocol.insertedDate\' | translate}}</th> <th md-column md-order-by="19">{{\'finalProtocol.confirmedDate\' | translate}}</th> <th md-column md-order-by="20">{{\'finalProtocol.confirmer\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell> <a ng-href="#/finalVocationalProtocols/{{::row.id}}/view">{{::row.protocolNr}}</a> </td> <td md-cell> <span ng-if="row.isFinalThesis">{{\'finalProtocol.finalThesis\' | translate}}</span> <span ng-if="!row.isFinalThesis">{{\'finalProtocol.finalExam\' | translate}}</span> </td> <td md-cell>{{currentLanguageNameField(row.curriculumVersions)}}, {{currentLanguageNameField(row.curriculumVersionOccupationModules)}}</td> <td md-cell>{{row.committeeChairman}}</td> <td md-cell>{{currentLanguageNameField(row.status)}}</td> <td md-cell>{{row.inserted | hoisDate}}</td> <td md-cell>{{row.confirmDate | hoisDate}}</td> <td md-cell>{{::row.confirmer}}</td> <td md-cell> <md-button ng-if="row.canEdit && row.status.code !== \'PROTOKOLL_STAATUS_K\'" md-no-ink class="md-primary change-button" ng-href="#/finalVocationalProtocols/{{::row.id}}/edit">{{\'main.button.change\' | translate}}</md-button> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> </div>'),a.put("finalProtocol/vocational/final.vocational.protocol.new.html",'<div class="ois-form-layout-padding" ng-cloak> <div flex> <form ng-submit="submit()" novalidate layout="column" name="finalProtocolNewForm"> <div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="50" flex-sm="100" flex-xs="100"> <label class="textInput">{{\'finalProtocol.studyYear\' | translate}}</label> <hois-select ng-model="formState.studyYear" type="studyyear" select-current-study-year required autofocus></hois-select> </md-input-container> <div flex="50" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <hois-autocomplete flex ng-model="formState.teacher" ha-attribute="id" ha-controller="directiveControllers" method="teachers" label="{{auth.higher ? \'teacher.labelHigher\' : \'teacher.labelVocational\'}}" additional-query-params="{valid: true, id: auth.isTeacher() ? auth.teacher : null,\r\n                selectedTeacherId: auth.isTeacher() ? auth.teacher : null}" ng-disabled="auth.isTeacher()" required></hois-autocomplete> </div> </div> <div layout="row" layout-sm="column" layout-xs="column"> <div flex> <hois-autocomplete flex ng-model="formState.curriculumVersionObject" url="/finalVocationalProtocols/curriculumVersions" label="finalProtocol.implementationPlan" required></hois-autocomplete> </div> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex flex-sm="100"> <label class="textInput">{{\'finalProtocol.module\' | translate}}</label> <hois-select ng-model="formState.curriculumVersionOccupationModule" values="formState.curriculumVersionOccupationModules" ng-change="curriculumVersionOccupationModuleChange()" required></hois-select> </md-input-container> </div> <br> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise" md-row-select multiple ng-model="formState.selectedStudents"> <thead md-head> <tr md-row flex> <th md-column> <span>{{\'student.label\' | translate}}</span> </th> <th md-column> <span>{{\'student.idcode\' | translate}}</span> </th> <th md-column> <span>{{\'finalProtocol.studentGroup\' | translate}}</span> </th> </tr> </thead> <tbody md-body> <tr md-row md-select="row.studentId" ng-repeat="row in tabledata.content | orderBy: \'fullname\'" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{row.fullname}}</td> <td md-cell>{{row.idcode}}</td> <td md-cell>{{row.studentGroup}}</td> </tr> </tbody> </table> </md-table-container> </div> <br> <div layout="row"> <md-button class="md-raised md-primary" type="submit">{{\'finalProtocol.create\' | translate}}</md-button> <md-button class="md-raised" ng-click="back(\'#/finalVocationalProtocols/\')">{{\'main.button.back\' | translate}}</md-button> </div> </div> </form> </div> </div>'),a.put("finalProtocol/vocational/final.vocational.protocol.view.html",'<div class="ois-form-layout-padding" ng-cloak> <div flex> <form layout="column" name="finalProtocolForm"> <div ng-include="\'finalProtocol/templates/final.vocational.protocol.header.tmpl.html\'"></div> <div class="form-readonly"> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="20" flex-sm="100" flex-xs="100"> <label ng-if="protocol.isFinalThesis">{{\'finalProtocol.finalDateThesis\' | translate}}</label> <label ng-if="!protocol.isFinalThesis">{{\'finalProtocol.finalDateExam\' | translate}}</label> <hois-value value="protocol.finalDate | hoisDate"></hois-value> </md-input-container> </div> </div> <fieldset ng-if="committeeMembers"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'finalProtocol.committee\' | translate}}</legend> <md-table-container> <table md-table md-progress="protocol.$promise" class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'finalProtocol.name\' | translate}}</th> <th md-column>{{\'finalProtocol.role\' | translate}}</th> <th md-column>{{\'finalProtocol.present\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in committeeMembers | orderBy: \'memberName\'" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{row.memberName}}</td> <td md-cell ng-if="row.isChairman">{{\'finalProtocol.chairman\' | translate}}</td> <td md-cell ng-if="!row.isChairman">{{\'finalProtocol.member\' | translate}}</td> <td md-cell> <md-checkbox aria-label="module" ng-model="row.isPresent" disabled></md-checkbox> </td> </tr> </tbody> </table> </md-table-container> </fieldset> <div>&nbsp;</div> <div> <div flex> <md-table-container> <table md-table md-progress="protocol.$promise" multiple> <thead md-head> <tr md-row> <th md-column>{{\'finalProtocol.id\' | translate}}</th> <th md-column>{{\'student.label\' | translate}}</th> <th md-column ng-if="protocol.isFinalThesis">{{\'finalProtocol.theme\' | translate}}</th> <th md-column>{{\'finalProtocol.grade\' | translate}}</th> <th md-column ng-if="protocol.status.code === \'PROTOKOLL_STAATUS_K\'">{{\'finalProtocol.changeReason\' | translate}}</th> <th md-column>{{\'finalProtocol.occupationAndCertificateNr\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in protocol.protocolStudents | orderBy: \'fullname\' track by $index" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{$index + 1}}</td> <td md-cell>{{row.fullname}}</td> <td md-cell ng-if="protocol.isFinalThesis">{{row.theme.nameEt}}</td> <td md-cell> <span ng-class="{badResult: !gradeUtil.isPositive(row.grade)}">{{gradeValue(row.grade)}}</span> </td> <td md-cell ng-if="protocol.status.code === \'PROTOKOLL_STAATUS_K\'">{{row.addInfo}}</td> <td md-cell> <span ng-repeat="occupation in protocol.occupations"> <span ng-if="row.occupations[occupation.code].granted"> <span>{{currentLanguageNameField(occupation)}}</span> <span ng-if="row.occupations[occupation.code].certificateNr">({{row.occupations[occupation.code].certificateNr}})</span> &nbsp; </span> </span> </td> </tr> </tbody> </table> </md-table-container> </div> </div> <div>&nbsp;</div> <div layout="row"> <md-button ng-if="formState.canEditProtocol" class="md-primary md-raised" ng-href="#/finalVocationalProtocols/{{::protocol.id}}/edit">{{\'main.button.change\' | translate}}</md-button> <a ng-show="formState.protocolPdfUrl" ng-href="{{formState.protocolPdfUrl}}" target="_blank" class="md-button md-raised">{{\'main.button.print\' | translate}}</a> <a ng-show="protocol.oisFile" ng-href="{{getUrl(protocol.oisFile, \'protocol\')}}" target="_blank" rel="noopener noreferrer" class="md-button md-raised">{{\'finalProtocol.downloadSigned\' | translate}}</a> <md-button class="md-raised" ng-click="back(\'#/finalVocationalProtocols/\')">{{\'main.button.back\' | translate}}</md-button> </div> </form> </div> </div>'),a.put("higherCurriculum/version/higher.module.edit.html",'<div class="ois-form-layout-padding"> <form name="higherModuleForm" ng-cloak> <div> <h2>{{"module.addToughtModule" | translate}}</h2> <span flex></span> </div> <span flex></span> <div class="ois-form-layout" layout="column" layout-margin ng-cloak> <div layout="column"> <div layout="row"> <md-input-container flex> <label>{{\'curriculum.specialty.specialty\' | translate}}</label> <md-select multiple ng-model="data.specialitiesReferenceNumbers" required ng-change="getSubjects()"> <md-option ng-repeat="speciality in specialities | orderBy: \'nameEt\'" ng-value="speciality.id"> {{currentLanguageNameField(speciality)}} </md-option> </md-select> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex> <label>{{\'module.type\' | translate}}</label> <md-select ng-model="data.typeObject" required> <md-option ng-repeat="type in moduleTypes | filter: {\'code\': \'KORGMOODUL_M\'}" ng-value="type"> {{type | hoisValidDates }} </md-option> <md-option ng-repeat="type in moduleTypes | filter: {\'code\': \'!KORGMOODUL_M\'} | orderBy: \'nameEt\'" ng-value="type"> {{type | hoisValidDates }} </md-option> </md-select> </md-input-container> </div> <div ng-if="data.typeObject.code === \'KORGMOODUL_M\'" layout="row" layout-sm="column" layout-xs="column"> <md-input-container> <label>{{\'module.typeNameEt\' | translate}}</label> <input ng-model="data.typeNameEt" type="text" required md-maxlength="255"> </md-input-container> <md-input-container> <label>{{\'module.typeNameEn\' | translate}}</label> <input ng-model="data.typeNameEn" type="text" required md-maxlength="255"> </md-input-container> </div> <md-input-container> <label>{{\'module.nameEt\' | translate}}</label> <input ng-model="data.nameEt" type="text" required md-maxlength="255"> </md-input-container> <md-input-container> <label>{{\'module.nameEn\' | translate}}</label> <input ng-model="data.nameEn" type="text" required md-maxlength="255"> </md-input-container> <md-input-container> <label>{{\'module.objectivesEt\' | translate}}</label> <textarea ng-model="data.objectivesEt" md-maxlength="20000" max-rows="10"></textarea> </md-input-container> <md-input-container> <label>{{\'module.objectivesEn\' | translate}}</label> <textarea ng-model="data.objectivesEn" md-maxlength="20000" max-rows="10"></textarea> </md-input-container> <md-input-container> <label>{{\'module.studyOutcomesEt\' | translate}}</label> <textarea ng-model="data.outcomesEt" md-maxlength="20000" max-rows="10"></textarea> </md-input-container> <md-input-container> <label>{{\'module.studyOutcomesEn\' | translate}}</label> <textarea ng-model="data.outcomesEn" md-maxlength="20000" max-rows="10"></textarea> </md-input-container> <div> <fieldset ng-show="formState.moduleMustHaveSubjects"> <legend md-colors="{color: \'primary-800\'}" ng-class="{invalid: higherModuleForm.$submitted && !subjectsValid()}" class="md-title-small">{{\'curriculum.version.subjects\' | translate}}&nbsp;*</legend> <div layout="row"> <md-autocomplete name="selectedSubject" md-selected-item="data.selectedSubject" md-search-text="subjectSearchText" md-items="subject in searchSubjects(subjectSearchText)" md-item-text="currentLanguageNameField(subject)" md-selected-item-change="addSubject()" md-min-length="1" md-floating-label="{{\'curriculum.version.subjectsName\' | translate}}" md-no-cache class="small-margin" flex> <md-item-template> <span md-highlight-text="subjectSearchText" md-highlight-flags="^i">{{subject.code}} - {{currentLanguageNameField(subject)}}</span> </md-item-template> <md-not-found> {{\'main.messages.error.notFound\' | translate}} </md-not-found> </md-autocomplete> </div> <md-table-container> <table md-table class="secondary-table nowrap-first" ng-show="data.subjects.length > 0"> <thead md-head> <tr md-row> <th md-column style="min-width:30%">{{\'curriculum.version.subjectsName\' | translate}}</th> <th md-column>EAP</th> <th md-column>{{\'module.optionalSubject\' | translate}}</th> <th md-column>{{\'module.studyYear\' | translate}}</th> <th md-column> <hois-classifier-value ng-value="\'OPPEPERIOOD_S\'" main-classifier-code="OPPEPERIOOD"></hois-classifier-value> </th> <th md-column> <hois-classifier-value ng-value="\'OPPEPERIOOD_K\'" main-classifier-code="OPPEPERIOOD"></hois-classifier-value> </th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat-start="subject in data.subjects | orderBy: \'code\'"> <td md-cell>{{subject.code}} - {{currentLanguageNameField(subject)}}</td> <td md-cell>{{subject.credits}}</td> <td md-cell> <md-checkbox ng-model="subject.optional" aria-label="subject is mandatory" ng-change="setCompulsoryStudyCredits(subject)"></md-checkbox> </td> <td md-cell layout="row"> <md-input-container> <md-select ng-model="subject.studyYearNumber" ng-required="subject.autumn || subject.spring"> <md-option md-option-empty></md-option> <md-option ng-value="opt" ng-repeat="opt in studyYears">{{opt}}</md-option> </md-select> </md-input-container> </td> <td md-cell> <md-checkbox name="autumnCheckbox-{{subject.subjectId}}" ng-model="subject.autumn" ng-required="subject.studyYearNumber && !subject.spring"></md-checkbox> </td> <td md-cell> <md-checkbox ng-model="subject.spring" ng-required="subject.studyYearNumber && !subject.autumn"></md-checkbox> </td> <td md-cell> <md-button flex="20" class="remove nomargin" ng-click="removeSubject(subject)">&times;</md-button> </td> </tr> <tr md-row ng-repeat-end ng-show="subject.studyYearNumber && !subject.autumn && !subject.spring"> <td colspan="4"></td> <td md-cell colspan="2"> <div ng-messages="higherModuleForm[\'autumnCheckbox-\' + subject.subjectId].$error"> <div class="invalid" ng-message="required">{{\'module.subject.needSemester\' | translate}}</div> </div> </td> </tr> </tbody> </table> </md-table-container> </fieldset> </div> <div>&nbsp;</div> <md-input-container> <label>{{\'module.optionalEap\' | translate}}</label> <input name="optionalStudyCredits" ng-model="data.optionalStudyCredits" type="number" required ng-change="data.totalCredits = data.optionalStudyCredits + data.compulsoryStudyCredits" min="0" max="999" pattern="^\\d+(\\.\\d{1})?$"> <div ng-messages="higherModuleForm.optionalStudyCredits.$error" ng-show="higherModuleForm.optionalStudyCredits.$dirty"> <div ng-message="min"> {{\'main.messages.error.positive\' | translate}} </div> <div ng-message="max"> {{\'curriculum.error.max999\' | translate}} </div> <div ng-message="pattern"> {{\'stateCurriculum.error.decimalPresision\' | translate}} </div> </div> </md-input-container> <md-input-container ng-show="formState.moduleMustHaveSubjects"> <label>{{\'module.mandatoryEap\' | translate}}</label> <input ng-model="data.compulsoryStudyCredits" type="number" readonly> </md-input-container> <md-input-container ng-show="formState.moduleMustHaveSubjects"> <label>{{\'module.overallEap\' | translate}}</label> <input name="totalCredits" ng-model="data.totalCredits" type="number" readonly max="999"> <div ng-messages="higherModuleForm.totalCredits.$error" ng-show="higherModuleForm.totalCredits.$error"> <div ng-message="max"> {{\'curriculum.error.max999\' | translate}} </div> </div> </md-input-container> <span flex></span> </div> </div> <md-button class="md-raised md-primary" ng-click="save()">{{"main.button.save" | translate}}</md-button> <md-button ng-click="delete()" ng-if="data.id" class="md-raised">{{"main.button.delete" | translate}}</md-button> <md-button class="md-raised" ng-click="back(backToEditForm, higherModuleForm)">{{"main.button.back" | translate}}</md-button> </form> </div>'),
a.put("higherCurriculum/version/higher.module.view.html",'<div class="ois-form-layout-padding"> <div> <h2>{{"module.viewToughtModule" | translate}}</h2> <span flex></span> </div> <span flex></span> <div class="ois-form-layout" layout="column" layout-margin ng-cloak> <div layout="column"> <div layout="row"> <md-input-container flex> <label>{{\'curriculum.specialty.specialty\' | translate}}</label> <md-select multiple ng-model="data.specialitiesReferenceNumbers" disabled> <md-option ng-repeat="speciality in specialities | orderBy: \'nameEt\'" ng-value="speciality.id"> {{currentLanguageNameField(speciality)}} </md-option> </md-select> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex> <label>{{\'module.type\' | translate}}</label> <md-select ng-model="data.typeObject" disabled> <md-option ng-repeat="type in moduleTypes | filter: {\'code\': \'KORGMOODUL_M\'}" ng-value="type"> {{currentLanguageNameField(type)}} </md-option> <md-option ng-repeat="type in moduleTypes | filter: {\'code\': \'!KORGMOODUL_M\'} | orderBy: \'nameEt\'" ng-value="type"> {{currentLanguageNameField(type)}} </md-option> </md-select> </md-input-container> </div> <div ng-if="data.typeObject.code === \'KORGMOODUL_M\'" layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex> <label>{{\'module.typeNameEt\' | translate}}</label> <input ng-model="data.typeNameEt" type="text" readonly> </md-input-container> <md-input-container flex> <label>{{\'module.typeNameEn\' | translate}}</label> <input ng-model="data.typeNameEn" type="text" readonly> </md-input-container> </div> <md-input-container flex> <label>{{\'module.nameEt\' | translate}}</label> <input ng-model="data.nameEt" type="text" readonly> </md-input-container> <md-input-container flex> <label>{{\'module.nameEn\' | translate}}</label> <input ng-model="data.nameEn" type="text" readonly> </md-input-container> <md-input-container flex> <label>{{\'module.objectivesEt\' | translate}}</label> <textarea ng-model="data.objectivesEt" readonly></textarea> </md-input-container> <md-input-container flex> <label>{{\'module.objectivesEn\' | translate}}</label> <textarea ng-model="data.objectivesEn" readonly></textarea> </md-input-container> <md-input-container flex> <label>{{\'module.studyOutcomesEt\' | translate}}</label> <textarea ng-model="data.outcomesEt" readonly></textarea> </md-input-container> <md-input-container flex> <label>{{\'module.studyOutcomesEn\' | translate}}</label> <textarea ng-model="data.outcomesEn" readonly></textarea> </md-input-container> <div> <fieldset ng-show="formState.moduleMustHaveSubjects"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'curriculum.version.subjects\' | translate}}&nbsp;</legend> <md-table-container> <table md-table class="secondary-table nowrap-first" ng-show="data.subjects.length > 0"> <thead md-head> <tr md-row> <th md-column>{{\'curriculum.version.subjectsName\' | translate}}</th> <th md-column>EAP</th> <th md-column>{{\'module.optionalSubject\' | translate}}</th> <th md-column>{{\'module.studyYear\' | translate}}</th> <th md-column> <hois-classifier-value ng-value="\'OPPEPERIOOD_S\'" main-classifier-code="OPPEPERIOOD"></hois-classifier-value> </th> <th md-column> <hois-classifier-value ng-value="\'OPPEPERIOOD_K\'" main-classifier-code="OPPEPERIOOD"></hois-classifier-value> </th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="subject in data.subjects | orderBy: \'code\'"> <td md-cell>{{subject.code}} - {{currentLanguageNameField(subject)}}</td> <td md-cell>{{subject.credits}}</td> <td md-cell> <md-checkbox ng-model="subject.optional" aria-label="subject is mandatory" disabled></md-checkbox> </td> <td md-cell>{{subject.studyYearNumber}}</td> <td md-cell> <md-checkbox ng-model="subject.autumn" disabled></md-checkbox> </td> <td md-cell> <md-checkbox ng-model="subject.spring" disabled></md-checkbox> </td> </tr> </tbody> </table> </md-table-container> </fieldset> </div> <div>&nbsp;</div> <md-input-container flex> <label>{{\'module.optionalEap\' | translate}}</label> <input name="optionalStudyCredits" ng-model="data.optionalStudyCredits" readonly> </md-input-container> <md-input-container flex ng-show="formState.moduleMustHaveSubjects"> <label>{{\'module.mandatoryEap\' | translate}}</label> <input ng-model="data.compulsoryStudyCredits" type="number" readonly> </md-input-container> <md-input-container flex ng-show="formState.moduleMustHaveSubjects"> <label>{{\'module.overallEap\' | translate}}</label> <input name="totalCredits" ng-model="data.totalCredits" type="number" readonly> </md-input-container> <span flex></span> </div> </div> <md-button class="md-raised" ng-click="back(backToViewForm)">{{"main.button.back" | translate}}</md-button> </div>'),a.put("higherCurriculum/version/minor.speciality.edit.html",'<div class="ois-form-layout-padding"> <form name="minorSpecialityForm" ng-cloak> <span flex></span> <div class="ois-form-layout" layout="column" layout-margin ng-cloak> <div layout="column"> <md-input-container flex> <label>{{\'curriculum.minorSpecialty.nameEt\' | translate}}</label> <input ng-model="data.nameEt" type="text" required md-maxlength="255"> </md-input-container> <md-input-container flex> <label>{{\'curriculum.minorSpecialty.nameEn\' | translate}}</label> <input ng-model="data.nameEn" type="text" required md-maxlength="255"> </md-input-container> <md-input-container> <label>{{\'curriculum.minorSpecialty.objectivesEt\' | translate}}</label> <textarea ng-model="data.objectivesEt" md-maxlength="20000" max-rows="10"></textarea> </md-input-container> <md-input-container> <label>{{\'curriculum.minorSpecialty.objectivesEn\' | translate}}</label> <textarea ng-model="data.objectivesEn" md-maxlength="20000" max-rows="10"></textarea> </md-input-container> <md-input-container> <label>{{\'curriculum.minorSpecialty.outcomesEt\' | translate}}</label> <textarea ng-model="data.outcomesEt" md-maxlength="20000" max-rows="10"></textarea> </md-input-container> <md-input-container> <label>{{\'curriculum.minorSpecialty.outcomesEn\' | translate}}</label> <textarea ng-model="data.outcomesEn" md-maxlength="20000" max-rows="10"></textarea> </md-input-container> <div>&nbsp;</div> <div> <fieldset> <legend md-colors="{color: \'primary-800\'}" ng-class="{invalid: minorSpecialityForm.$submitted && data.subjects.length == 0}" class="md-title-small">{{\'curriculum.version.subjects\' | translate}}&nbsp;*</legend> <div layout="row"> <md-autocomplete name="selectedSubject" md-selected-item="data.selectedSubject" md-search-text="subjectSearchText" md-items="subject in searchSubjects(subjectSearchText)" md-item-text="currentLanguageNameField(subject)" md-selected-item-change="addSubject()" md-min-length="1" md-floating-label="{{\'curriculum.version.subjectsName\' | translate}}" md-no-cache class="small-margin" flex> <md-item-template> <span md-highlight-text="subjectSearchText" md-highlight-flags="^i">{{subject.code}} - {{currentLanguageNameField(subject)}}</span> </md-item-template> <md-not-found> {{\'main.messages.error.notFound\' | translate}} </md-not-found> </md-autocomplete> </div> <md-table-container> <table md-table class="secondary-table nowrap-first" ng-show="data.subjects.length > 0"> <thead md-head> <tr md-row> <th md-column style="min-width:30%">{{\'curriculum.version.subjectsName\' | translate}}</th> <th md-column>EAP</th> <th md-column>{{\'module.optionalSubject\' | translate}}</th> <th md-column>{{\'module.studyYear\' | translate}}</th> <th md-column> <hois-classifier-value ng-value="\'OPPEPERIOOD_S\'" main-classifier-code="OPPEPERIOOD"></hois-classifier-value> </th> <th md-column> <hois-classifier-value ng-value="\'OPPEPERIOOD_K\'" main-classifier-code="OPPEPERIOOD"></hois-classifier-value> </th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat-start="subject in data.subjects | orderBy: \'code\'"> <td md-cell>{{subject.code}} - {{currentLanguageNameField(subject)}}</td> <td md-cell>{{subject.credits}}</td> <td md-cell> <md-checkbox ng-model="subject.optional" aria-label="subject is mandatory" ng-change="setCompulsoryStudyCredits(subject)"></md-checkbox> </td> <td md-cell layout="row"> <md-input-container flex> <md-select ng-model="subject.studyYearNumber" ng-required="subject.autumn || subject.spring"> <md-option md-option-empty></md-option> <md-option ng-value="opt" ng-repeat="opt in studyYears">{{opt}}</md-option> </md-select> </md-input-container> </td> <td md-cell> <md-checkbox name="autumnCheckbox-{{subject.subjectId}}" ng-model="subject.autumn" ng-required="subject.studyYearNumber && !subject.spring"></md-checkbox> </td> <td md-cell> <md-checkbox ng-model="subject.spring" ng-required="subject.studyYearNumber && !subject.autumn"></md-checkbox> </td> <td md-cell> <md-button flex="20" class="remove nomargin" ng-click="removeSubject(subject)">&times;</md-button> </td> </tr> <tr md-row ng-repeat-end ng-show="subject.studyYearNumber && !subject.autumn && !subject.spring"> <td colspan="4"></td> <td md-cell colspan="2"> <div ng-messages="minorSpecialityForm[\'autumnCheckbox-\' + subject.subjectId].$error"> <div class="invalid" ng-message="required">{{\'module.subject.needSemester\' | translate}}</div> </div> </td> </tr> </tbody> </table> </md-table-container> </fieldset> </div> <div>&nbsp;</div> <md-input-container flex> <label>{{\'module.optionalEap\' | translate}}</label> <input name="optionalStudyCredits" ng-model="data.optionalStudyCredits" type="number" required ng-change="data.totalCredits = data.optionalStudyCredits + data.compulsoryStudyCredits" min="0" max="999" pattern="^\\d+(\\.\\d{1})?$"> <div ng-messages="minorSpecialityForm.optionalStudyCredits.$error" ng-show="minorSpecialityForm.optionalStudyCredits.$dirty"> <div ng-message="min"> {{\'main.messages.error.positive\' | translate}} </div> <div ng-message="max"> {{\'curriculum.error.max999\' | translate}} </div> <div ng-message="pattern"> {{\'stateCurriculum.error.decimalPresision\' | translate}} </div> </div> </md-input-container> <md-input-container flex> <label>{{\'module.mandatoryEap\' | translate}}</label> <input ng-model="data.compulsoryStudyCredits" type="number" readonly> </md-input-container> <md-input-container flex> <label>{{\'module.overallEap\' | translate}}</label> <input ng-model="data.totalCredits" type="number" readonly> </md-input-container> <span flex></span> </div> </div> <md-button class="md-raised md-primary" ng-click="save()">{{"main.button.save" | translate}}</md-button> <md-button ng-click="delete()" ng-if="data.id" class="md-raised">{{"main.button.delete" | translate}}</md-button> <md-button class="md-raised" ng-click="back(backToEditForm, minorSpecialityForm)">{{"main.button.back" | translate}}</md-button> </form> </div>'),a.put("higherCurriculum/version/minor.speciality.view.html",'<div class="ois-form-layout-padding"> <span flex></span> <div class="ois-form-layout" layout="column" layout-margin ng-cloak> <div layout="column"> <md-input-container flex> <label>{{\'curriculum.minorSpecialty.nameEt\' | translate}}</label> <input ng-model="data.nameEt" type="text" readonly> </md-input-container> <md-input-container flex> <label>{{\'curriculum.minorSpecialty.nameEn\' | translate}}</label> <input ng-model="data.nameEn" type="text" readonly> </md-input-container> <md-input-container> <label>{{\'curriculum.minorSpecialty.objectivesEt\' | translate}}</label> <textarea ng-model="data.objectivesEt" readonly></textarea> </md-input-container> <md-input-container> <label>{{\'curriculum.minorSpecialty.objectivesEn\' | translate}}</label> <textarea ng-model="data.objectivesEn" readonly></textarea> </md-input-container> <md-input-container> <label>{{\'curriculum.minorSpecialty.outcomesEt\' | translate}}</label> <textarea ng-model="data.outcomesEt" readonly></textarea> </md-input-container> <md-input-container> <label>{{\'curriculum.minorSpecialty.outcomesEn\' | translate}}</label> <textarea ng-model="data.outcomesEn" readonly></textarea> </md-input-container> <div> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'curriculum.version.subjects\' | translate}}&nbsp;</legend> <md-table-container> <table md-table class="secondary-table nowrap-first" ng-show="data.subjects.length > 0"> <thead md-head> <tr md-row> <th md-column>{{\'curriculum.version.subjectsName\' | translate}}</th> <th md-column>EAP</th> <th md-column>{{\'module.optionalSubject\' | translate}}</th> <th md-column>{{\'module.studyYear\' | translate}}</th> <th md-column> <hois-classifier-value ng-value="\'OPPEPERIOOD_S\'" main-classifier-code="OPPEPERIOOD"></hois-classifier-value> </th> <th md-column> <hois-classifier-value ng-value="\'OPPEPERIOOD_K\'" main-classifier-code="OPPEPERIOOD"></hois-classifier-value> </th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="subject in data.subjects | orderBy: \'code\'"> <td md-cell>{{subject.code}} - {{currentLanguageNameField(subject)}}</td> <td md-cell>{{subject.credits}}</td> <td md-cell> <md-checkbox ng-model="subject.optional" aria-label="subject is mandatory" disabled></md-checkbox> </td> <td md-cell>{{subject.studyYearNumber}}</td> <td md-cell> <md-checkbox ng-model="subject.autumn" disabled></md-checkbox> </td> <td md-cell> <md-checkbox ng-model="subject.spring" disabled></md-checkbox> </td> </tr> </tbody> </table> </md-table-container> </fieldset> </div> <div>&nbsp;</div> <md-input-container flex> <label>{{\'module.optionalEap\' | translate}}</label> <input name="optionalStudyCredits" ng-model="data.optionalStudyCredits" type="number" readonly> </md-input-container> <md-input-container flex> <label>{{\'module.mandatoryEap\' | translate}}</label> <input ng-model="data.compulsoryStudyCredits" type="number" readonly> </md-input-container> <md-input-container flex> <label>{{\'module.overallEap\' | translate}}</label> <input ng-model="data.totalCredits" type="number" readonly> </md-input-container> <span flex></span> </div> </div> <md-button class="md-raised" ng-click="back(backToViewForm)">{{"main.button.back" | translate}}</md-button> </div>'),a.put("protocol/templates/module.protocol.header.tmpl.html",'<div class="form-readonly"> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex flex-sm="100" flex-xs="100"> <label>{{\'moduleProtocol.protocolNumber\' | translate}}</label> <hois-value value="protocol.protocolNr"></hois-value> </md-input-container> <md-input-container flex flex-sm="100" flex-xs="100"> <label>{{\'main.status\' | translate}}</label> <hois-value value="currentLanguageNameField(protocol.status)"></hois-value> </md-input-container> <md-input-container flex flex-sm="100" flex-xs="100"> <label>{{\'moduleProtocol.studyYear\' | translate}}</label> <hois-value value="currentLanguageNameField(protocol.protocolVdata.studyYear)"></hois-value> </md-input-container> <md-input-container flex flex-sm="100" flex-xs="100"> <label>{{\'moduleProtocol.insertedDate\' | translate}} / {{\'moduleProtocol.confirmDate\' | translate}}</label> <hois-value value="(protocol.inserted ? (protocol.inserted | hoisDate) : \'-\')  + \' / \' + (protocol.confirmDate ? (protocol.confirmDate | hoisDate) : \'-\')"></hois-value> </md-input-container> <md-input-container flex flex-sm="100" flex-xs="100"> <label>{{\'moduleProtocol.confirmer\' | translate}}</label> <hois-value value="protocol.confirmer ? protocol.confirmer : \'-\' "></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex flex-sm="100" flex-xs="100"> <label>{{\'moduleProtocol.curriculumVersion\' | translate}}</label> <hois-value value="currentLanguageNameField(protocol.protocolVdata.curriculumVersion)"></hois-value> </md-input-container> <md-input-container flex flex-sm="100" flex-xs="100"> <label>{{\'moduleProtocol.module\' | translate}}</label> <hois-value value="currentLanguageNameField(protocol.protocolVdata.curriculumVersionOccupationModule)" href-value="\'#/occupationModule/\' + protocol.protocolVdata.curriculum + \'/\' + protocol.protocolVdata.curriculumVersion.id + \'/\' + protocol.protocolVdata.curriculumModule + \'/\' + protocol.protocolVdata.curriculumVersionOccupationModule.id + \'/view\'"></hois-value> </md-input-container> <md-input-container flex flex-sm="100" flex-xs="100"> <label>{{\'moduleProtocol.moduleCredits\' | translate}}</label> <hois-value value="protocol.protocolVdata.moduleCredits + \' \' + (\'moduleProtocol.creditsUnit\' | translate)"></hois-value> </md-input-container> <md-input-container flex flex-sm="100" flex-xs="100"> <label>{{\'moduleProtocol.moduleGrading\' | translate}}</label> <hois-classifier-value ng-model="protocol.protocolVdata.assessment" main-classifier-code="KUTSEHINDAMISVIIS"></hois-classifier-value> </md-input-container> <md-input-container flex flex-sm="100" flex-xs="100"> <label>{{auth.higher ? (\'teacher.labelHigher\' | translate) : (\'teacher.labelVocational\' | translate)}}</label> <hois-value value="currentLanguageNameField(protocol.protocolVdata.teacher)"></hois-value> </md-input-container> </div> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container ng-if="journals.length > 0" flex="10" flex-md="20" flex-sm="100" flex-xs="100"> <md-checkbox ng-model="formState.showJournals">{{\'moduleProtocol.showJournals\' | translate}}</md-checkbox> </md-input-container> <md-input-container ng-if="formState.outcomesAsEntries" flex="10" flex-md="20" flex-sm="100" flex-xs="100"> <md-checkbox ng-model="formState.showOutcomes">{{\'moduleProtocol.showOutcomes\' | translate}}</md-checkbox> </md-input-container> </div>'),a.put("scholarship/student/scholarship.application.doktor.edit.html",'<div class="ois-form-layout-padding" ng-cloak> <fieldset tabindex="1"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'stipend.student.drGrantTerms\' | translate}}</legend> <div class="form-readonly ois-form-layout-padding"> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.grantType\' | translate}}</label> <hois-classifier-value ng-model="stipend.type" main-classifier-code="STIPTOETUS"></hois-classifier-value> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label>{{\'stipend.places\' | translate}}</label> <hois-value value="stipend.places"></hois-value> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.studyPeriod\' | translate}}</label> <hois-value value="currentLanguageNameField(stipend.studyPeriod)"></hois-value> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label>{{\'stipend.amountPaid\' | translate}}</label> <hois-value value="stipend.amountPaid"></hois-value> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.studyLoad\' | translate}}</label> <hois-classifier-value ng-model="stipend.studyLoads" main-classifier-code="OPPEKOORMUS" multiple></hois-classifier-value> </md-input-container> </div> <div layout="row"> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100"> <label>{{\'stipend.studyPeriodDates\' | translate}}</label> <input type="hidden"> </md-input-container> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'main.from\' | translate}}</label> <hois-value value="stipend.studyStartPeriodStart | hoisDate"></hois-value> </md-input-container> <md-input-container flex="50" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'main.thru\' | translate}}</label> <hois-value value="stipend.studyStartPeriodEnd | hoisDate"></hois-value> </md-input-container> </div> <div layout="row"> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100"> <label>{{\'stipend.paymentPeriod\' | translate}}</label> <input type="hidden"> </md-input-container> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'main.from\' | translate}}</label> <hois-value value="stipend.paymentStart | hoisDate"></hois-value> </md-input-container> <md-input-container flex="50" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'main.thru\' | translate}}</label> <hois-value value="stipend.paymentEnd | hoisDate"></hois-value> </md-input-container> </div> </div> </fieldset> <br> <fieldset tabindex="1"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'stipend.student.myData\' | translate}}</legend> <div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <form name="applicationForm"> <div layout="column" flex> <div layout="row" flex> <md-input-container flex="45"> <label>{{\'stipend.student.bankAccount\' | translate}}</label> <input type="text" ng-model="application.bankAccount" name="bankAccount" required md-maxlength="50"> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="100" flex-md="100" flex-sm="100" flex-xs="100"> <label>{{\'stipend.student.grantReason\' | translate}}</label> <textarea ng-model="application.addInfo" name="addInfo" md-maxlength="4000"></textarea> </md-input-container> </div> <br> <div layout="row"> <md-button class="md-raised md-primary" ng-if="application.canApply" ng-click="update(applicationForm)">{{\'main.button.save\' | translate}}</md-button> <md-button class="md-raised" ng-if="application.canApply" ng-click="apply(applicationForm)">{{\'stipend.student.apply\' | translate}}</md-button> <md-button class="md-raised" ng-click="back(\'#/scholarships/myData/grants\', applicationForm)">{{\'main.button.back\' | translate}}</md-button> </div> </div> </form> </div> </div> </fieldset> </div>'),a.put("scholarship/student/scholarship.application.doktor.view.html",'<div class="ois-form-layout-padding" ng-cloak> <fieldset tabindex="1"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'stipend.student.drGrantTerms\' | translate}}</legend> <div class="form-readonly ois-form-layout-padding"> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.grantType\' | translate}}</label> <hois-classifier-value ng-model="stipend.type" main-classifier-code="STIPTOETUS"></hois-classifier-value> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label>{{\'stipend.places\' | translate}}</label> <hois-value value="stipend.places"></hois-value> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.studyPeriod\' | translate}}</label> <hois-value value="currentLanguageNameField(stipend.studyPeriod)"></hois-value> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label>{{\'stipend.amountPaid\' | translate}}</label> <hois-value value="stipend.amountPaid"></hois-value> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.studyLoad\' | translate}}</label> <hois-classifier-value ng-model="stipend.studyLoads" main-classifier-code="OPPEKOORMUS" multiple></hois-classifier-value> </md-input-container> </div> <div layout="row"> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100"> <label>{{\'stipend.studyPeriodDates\' | translate}}</label> <input type="hidden"> </md-input-container> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'main.from\' | translate}}</label> <hois-value value="stipend.studyStartPeriodStart | hoisDate"></hois-value> </md-input-container> <md-input-container flex="50" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'main.thru\' | translate}}</label> <hois-value value="stipend.studyStartPeriodEnd | hoisDate"></hois-value> </md-input-container> </div> <div layout="row"> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100"> <label>{{\'stipend.paymentPeriod\' | translate}}</label> <input type="hidden"> </md-input-container> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'main.from\' | translate}}</label> <hois-value value="stipend.paymentStart | hoisDate"></hois-value> </md-input-container> <md-input-container flex="50" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'main.thru\' | translate}}</label> <hois-value value="stipend.paymentEnd | hoisDate"></hois-value> </md-input-container> </div> </div> </fieldset> <br> <fieldset tabindex="1"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{isStudent ? \'stipend.student.myData\' : \'stipend.student.studentData\' | translate}}</legend> <div class="form-readonly ois-form-layout-padding"> <div flex> <div layout="column" flex> <div layout="row" flex> <md-input-container flex="45"> <label>{{\'stipend.student.bankAccount\' | translate}}</label> <hois-value value="application.bankAccount"></hois-value> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="100" flex-md="100" flex-sm="100" flex-xs="100"> <label>{{\'stipend.student.grantReason\' | translate}}</label> <hois-value value="application.addInfo"></hois-value> </md-input-container> </div> <br> <div layout="row"> <md-button class="md-raised md-primary" ng-if="canManage" ng-click="accept()">{{\'main.button.accept\' | translate}}</md-button> <md-button class="md-raised" ng-click="back(isStudent() ? \'#/scholarships/myData/drGrants\' : \'#/scholarships/applications/grants\')">{{\'main.button.back\' | translate}}</md-button> </div> </div> </div> </div> </fieldset> </div>'),a.put("scholarship/student/scholarship.application.edit.html",'<div ng-include="templateName"></div>'),a.put("scholarship/student/scholarship.application.eri.edit.html",'<div class="ois-form-layout-padding" ng-cloak> <fieldset tabindex="1"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'stipend.student.grantTerms\' | translate}}</legend> <div class="form-readonly ois-form-layout-padding"> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.grantType\' | translate}}</label> <hois-classifier-value ng-model="stipend.type" main-classifier-code="STIPTOETUS"></hois-classifier-value> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label>{{\'stipend.places\' | translate}}</label> <hois-value value="stipend.places"></hois-value> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.studyPeriod\' | translate}}</label> <hois-value value="currentLanguageNameField(stipend.studyPeriod)"></hois-value> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label>{{\'stipend.amountPaid\' | translate}}</label> <hois-value value="stipend.amountPaid"></hois-value> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.studyForm\' | translate}}</label> <hois-classifier-value ng-model="stipend.studyForms" main-classifier-code="OPPEVORM" multiple></hois-classifier-value> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label class="textInput">{{\'stipend.averageMark\' | translate}}</label> <hois-value value="stipend.averageMark"></hois-value> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="100"> <label class="textInput">{{\'stipend.addInfo\' | translate}}</label> <hois-value value="stipend.addInfo"></hois-value> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.curriculumCompletion\' | translate}}</label> <hois-value value="stipend.curriculumCompletion"></hois-value> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label class="textInput">{{\'stipend.lastPeriodMark\' | translate}}</label> <hois-value value="stipend.lastPeriodMark"></hois-value> </md-input-container> </div> <div layout="row"> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100"> <label>{{\'stipend.studyPeriodDates\' | translate}}</label> <input type="hidden"> </md-input-container> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'main.from\' | translate}}</label> <hois-value value="stipend.studyStartPeriodStart | hoisDate"></hois-value> </md-input-container> <md-input-container flex="50" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'main.thru\' | translate}}</label> <hois-value value="stipend.studyStartPeriodEnd | hoisDate"></hois-value> </md-input-container> </div> <div layout="row"> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100"> <label>{{\'stipend.paymentPeriod\' | translate}}</label> <input type="hidden"> </md-input-container> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'main.from\' | translate}}</label> <hois-value value="stipend.paymentStart | hoisDate"></hois-value> </md-input-container> <md-input-container flex="50" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'main.thru\' | translate}}</label> <hois-value value="stipend.paymentEnd | hoisDate"></hois-value> </md-input-container> </div> <div layout="row" flex> <div flex> <md-checkbox ng-model="stipend.isTeacherConfirm" disabled aria-label="Is teacher confirm"> {{\'stipend.isTeacherConfirm\' | translate}} </md-checkbox> </div> </div> </div> </fieldset> <br> <fieldset tabindex="1" ng-if="termCompliance && !termCompliance.fullyComplies"> <legend md-colors="{color: \'default-warn\'}" class="md-title-small">{{\'stipend.messages.error.studentDoesntComply\' | translate}}</legend> <div flex ng-include="\'scholarship/templates/scholarship.term.compliance.list.html\'"></div> </fieldset> <br> <fieldset tabindex="1"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'stipend.student.myData\' | translate}}</legend> <div class="form-readonly ois-form-layout-padding"> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.averageMark\' | translate}}</label> <hois-value value="application.averageMark"></hois-value> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label>{{\'stipend.lastPeriodMark\' | translate}}</label> <hois-value value="application.lastPeriodMark"></hois-value> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.curriculumCompletion\' | translate}}</label> <hois-value value="application.curriculumCompletion"></hois-value> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.student.studentGroup\' | translate}}</label> <hois-value value="application.studentGroupCode"></hois-value> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label class="textInput">{{\'main.contactNumber\' | translate}}</label> <input ng-model="application.phone" type="text" md-maxlength="100" ng-disabled="!application.canApply"> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.student.address\' | translate}}</label> <hois-value value="application.address"></hois-value> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label class="textInput">{{\'main.email\' | translate}}</label> <input ng-model="application.email" type="email" md-maxlength="100" ng-disabled="!application.canApply"> </md-input-container> </div> </div> <div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <ng-form name="applicationForm"> <div layout="row" flex> <md-input-container flex="45" flex-md="100" flex-sm="100" flex-xs="100"> <label>{{\'stipend.student.bankAccount\' | translate}}</label> <input type="text" ng-model="application.bankAccount" name="bankAccount" required md-maxlength="50" ng-disabled="!application.canApply"> </md-input-container> <md-input-container flex="50" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'stipend.student.bankAccountOwnerName\' | translate}}</label> <input type="text" ng-model="application.bankAccountOwnerName" name="bankAccountOwnerName" required md-maxlength="100" ng-disabled="!application.canApply"> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="45" flex-md="100" flex-sm="100" flex-xs="100"> <label>{{\'stipend.student.bankAccountOwnerIdcode\' | translate}}</label> <input type="text" ng-model="application.bankAccountOwnerIdcode" name="bankAccountOwnerIdcode" required md-maxlength="20" ng-disabled="!application.canApply"> </md-input-container> </div> <div layout="row" layout-xs="column"> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100"> <label>{{\'stipend.student.stipToetusEriPeriod\' | translate}}</label> <input style="visibility:hidden"> </md-input-container> <md-input-container flex="35" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0"> <md-datepicker ng-model="application.scholarshipFrom" name="scholarshipFrom" md-placeholder="{{\'main.from\' | translate}}" md-min-date="stipend.paymentStart" md-max-date="formState.scholarshipFromMax" ng-change="updateScholarshipDateValidation()" ng-disabled="!application.canApply"></md-datepicker> </md-input-container> <md-input-container flex="35" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0"> <md-datepicker ng-model="application.scholarshipThru" name="scholarshipThru" md-placeholder="{{\'main.thru\' | translate}}" md-min-date="formState.scholarshipThruMin" md-max-date="stipend.paymentEnd" ng-change="updateScholarshipDateValidation()" ng-disabled="!application.canApply"></md-datepicker> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="100" flex-md="100" flex-sm="100" flex-xs="100"> <label>{{\'stipend.student.grantReason\' | translate}}</label> <textarea ng-model="application.addInfo" name="addInfo" md-maxlength="4000" ng-disabled="!application.canApply"></textarea> </md-input-container> </div> <br ng-if="stipend.isFamilyIncomes"> <div ng-if="stipend.isFamilyIncomes" ng-include="\'scholarship/student/scholarship.family.table.edit.html\'"></div> <br> <div ng-include="\'scholarship/scholarship.relatedFiles.edit.html\'"></div> <div layout="row" layout-xs="column"> <md-button class="md-raised md-primary" ng-if="application.canApply" ng-click="update(applicationForm)">{{\'main.button.save\' | translate}}</md-button> <md-button class="md-raised" ng-if="application.canApply" ng-click="apply(applicationForm)">{{\'stipend.student.apply\' | translate}}</md-button> <md-button class="md-raised" ng-click="back(\'#/scholarships/myData/grants\', applicationForm)">{{\'main.button.back\' | translate}}</md-button> </div> </ng-form> </div> </div> </fieldset> </div>'),
a.put("scholarship/student/scholarship.application.eri.view.html",'<div class="ois-form-layout-padding" ng-cloak> <fieldset tabindex="1"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'stipend.student.grantTerms\' | translate}}</legend> <div class="form-readonly ois-form-layout-padding"> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.grantType\' | translate}}</label> <hois-classifier-value ng-model="stipend.type" main-classifier-code="STIPTOETUS"></hois-classifier-value> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label>{{\'stipend.places\' | translate}}</label> <hois-value value="stipend.places"></hois-value> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.studyPeriod\' | translate}}</label> <hois-value value="currentLanguageNameField(stipend.studyPeriod)"></hois-value> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label>{{\'stipend.amountPaid\' | translate}}</label> <hois-value value="stipend.amountPaid"></hois-value> </md-input-container> </div> <div layout="row" layout-xs="column" flex> <md-input-container flex="45" flex-xs="100"> <label class="textInput">{{\'stipend.studyForm\' | translate}}</label> <hois-classifier-value ng-model="stipend.studyForms" main-classifier-code="OPPEVORM" multiple></hois-classifier-value> </md-input-container> <md-input-container flex="50" flex-xs="100" flex-offset-xs="0" flex-offset="5"> <label class="textInput">{{\'stipend.averageMark\' | translate}}</label> <hois-value value="stipend.averageMark"></hois-value> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="100"> <label class="textInput">{{\'stipend.addInfo\' | translate}}</label> <hois-value value="stipend.addInfo"></hois-value> </md-input-container> </div> <div layout="row" layout-xs="column" flex> <md-input-container flex="45" flex-xs="100"> <label class="textInput">{{\'stipend.curriculumCompletion\' | translate}}</label> <hois-value value="stipend.curriculumCompletion"></hois-value> </md-input-container> <md-input-container flex="50" flex-xs="100" flex-offset-xs="0" flex-offset="5"> <label class="textInput">{{\'stipend.lastPeriodMark\' | translate}}</label> <hois-value value="stipend.lastPeriodMark"></hois-value> </md-input-container> </div> <div layout="row"> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100"> <label>{{\'stipend.studyPeriodDates\' | translate}}</label> <input type="hidden"> </md-input-container> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'main.from\' | translate}}</label> <hois-value value="stipend.studyStartPeriodStart | hoisDate"></hois-value> </md-input-container> <md-input-container flex="50" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'main.thru\' | translate}}</label> <hois-value value="stipend.studyStartPeriodEnd | hoisDate"></hois-value> </md-input-container> </div> <div layout="row"> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100"> <label>{{\'stipend.paymentPeriod\' | translate}}</label> <input type="hidden"> </md-input-container> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'main.from\' | translate}}</label> <hois-value value="stipend.paymentStart | hoisDate"></hois-value> </md-input-container> <md-input-container flex="50" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'main.thru\' | translate}}</label> <hois-value value="stipend.paymentEnd | hoisDate"></hois-value> </md-input-container> </div> <div layout="row" flex> <div flex> <md-checkbox ng-model="stipend.isTeacherConfirm" disabled aria-label="Is teacher confirm"> {{\'stipend.isTeacherConfirm\' | translate}} </md-checkbox> </div> </div> </div> </fieldset> <br> <fieldset tabindex="1"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{isStudent() ? \'stipend.student.myData\' : \'stipend.student.studentData\' | translate}}</legend> <div class="form-readonly ois-form-layout-padding"> <div layout="row" layout-xs="column" flex> <md-input-container flex="45" flex-xs="100"> <label class="textInput">{{\'stipend.averageMark\' | translate}}</label> <hois-value value="application.averageMark"></hois-value> </md-input-container> <md-input-container flex="50" flex-xs="100" flex-offset-xs="0" flex-offset="5"> <label>{{\'stipend.lastPeriodMark\' | translate}}</label> <hois-value value="application.lastPeriodMark"></hois-value> </md-input-container> </div> <div layout="row" layout-xs="column" flex> <md-input-container flex="45" flex-xs="100"> <label class="textInput">{{\'stipend.curriculumCompletion\' | translate}}</label> <hois-value value="application.curriculumCompletion"></hois-value> </md-input-container> </div> <div layout="row" layout-xs="column" flex> <md-input-container flex="45" flex-xs="100"> <label class="textInput">{{\'stipend.student.studentGroup\' | translate}}</label> <hois-value value="application.studentGroupCode"></hois-value> </md-input-container> <md-input-container flex="50" flex-xs="100" flex-offset-xs="0" flex-offset="5"> <label class="textInput">{{\'main.contactNumber\' | translate}}</label> <hois-value value="application.phone"></hois-value> </md-input-container> </div> <div layout="row" layout-xs="column" flex> <md-input-container flex="45" flex-xs="100"> <label class="textInput">{{\'stipend.student.address\' | translate}}</label> <hois-value value="application.address"></hois-value> </md-input-container> <md-input-container flex="50" flex-xs="100" flex-offset-xs="0" flex-offset="5"> <label class="textInput">{{\'main.email\' | translate}}</label> <hois-value value="application.email"></hois-value> </md-input-container> </div> </div> <div class="form-readonly ois-form-layout-padding" ng-cloak> <div flex> <div layout="row" layout-xs="column" flex> <md-input-container flex="45" flex-md="100" flex-sm="100" flex-xs="100"> <label>{{\'stipend.student.bankAccount\' | translate}}</label> <hois-value value="application.bankAccount"></hois-value> </md-input-container> <md-input-container flex="50" flex-md="100" flex-sm="100" flex-xs="100" flex-offset-xs="0" flex-offset="5"> <label>{{\'stipend.student.bankAccountOwnerName\' | translate}}</label> <hois-value value="application.bankAccountOwnerName"></hois-value> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="45" flex-md="100" flex-sm="100" flex-xs="100"> <label>{{\'stipend.student.bankAccountOwnerIdcode\' | translate}}</label> <hois-value value="application.bankAccountOwnerIdcode"></hois-value> </md-input-container> </div> <div layout="row" layout-xs="column"> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100"> <label>{{\'stipend.student.stipToetusEriPeriod\' | translate}}</label> <input type="hidden"> </md-input-container> <md-input-container flex="35" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'main.from\' | translate}}</label> <hois-value value="application.scholarshipFrom | hoisDate"></hois-value> </md-input-container> <md-input-container flex="35" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'main.thru\' | translate}}</label> <hois-value value="application.scholarshipThru | hoisDate"></hois-value> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="100" flex-md="100" flex-sm="100" flex-xs="100"> <label>{{\'stipend.student.grantReason\' | translate}}</label> <hois-value value="application.addInfo"></hois-value> </md-input-container> </div> <div ng-if="stipend.isFamilyIncomes" ng-include="\'scholarship/student/scholarship.family.table.view.html\'"></div> <br> <div ng-include="\'scholarship/scholarship.relatedFiles.edit.html\'"></div> <div layout="row"> <md-button class="md-raised md-primary" ng-if="canManage" ng-click="accept()">{{\'main.button.accept\' | translate}}</md-button> <md-button class="md-raised" ng-click="back(isStudent() ? \'#/scholarships/myData/grants\' : \'#/scholarships/applications/grants\')">{{\'main.button.back\' | translate}}</md-button> </div> </div> </div> </fieldset> </div>'),a.put("scholarship/student/scholarship.application.pohi.edit.html",'<div class="ois-form-layout-padding" ng-cloak> <fieldset tabindex="1"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'stipend.student.grantTerms\' | translate}}</legend> <div class="form-readonly ois-form-layout-padding"> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.grantType\' | translate}}</label> <hois-classifier-value ng-model="stipend.type" main-classifier-code="STIPTOETUS"></hois-classifier-value> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label>{{\'stipend.places\' | translate}}</label> <hois-value value="stipend.places"></hois-value> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.studyPeriod\' | translate}}</label> <hois-value value="currentLanguageNameField(stipend.studyPeriod)"></hois-value> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label>{{\'stipend.amountPaid\' | translate}}</label> <hois-value value="stipend.amountPaid"></hois-value> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.studyForm\' | translate}}</label> <hois-classifier-value ng-model="stipend.studyForms" main-classifier-code="OPPEVORM" multiple></hois-classifier-value> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label class="textInput">{{\'stipend.averageMark\' | translate}}</label> <hois-value value="stipend.averageMark"></hois-value> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="100"> <label class="textInput">{{\'stipend.addInfo\' | translate}}</label> <hois-value value="stipend.addInfo"></hois-value> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.curriculumCompletion\' | translate}}</label> <hois-value value="stipend.curriculumCompletion"></hois-value> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label class="textInput">{{\'stipend.lastPeriodMark\' | translate}}</label> <hois-value value="stipend.lastPeriodMark"></hois-value> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.maxAbsences\' | translate}}</label> <hois-value value="stipend.maxAbsences"></hois-value> </md-input-container> <div flex="50" flex-offset="5"> <md-checkbox ng-model="stipend.isTeacherConfirm" disabled aria-label="Is teacher confirm"> {{\'stipend.isTeacherConfirm\' | translate}} </md-checkbox> </div> </div> <div layout="row"> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100"> <label>{{\'stipend.studyPeriodDates\' | translate}}</label> <input type="hidden"> </md-input-container> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'main.from\' | translate}}</label> <hois-value value="stipend.studyStartPeriodStart | hoisDate"></hois-value> </md-input-container> <md-input-container flex="50" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'main.thru\' | translate}}</label> <hois-value value="stipend.studyStartPeriodEnd | hoisDate"></hois-value> </md-input-container> </div> <div layout="row"> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100"> <label>{{\'stipend.paymentPeriod\' | translate}}</label> <input type="hidden"> </md-input-container> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'main.from\' | translate}}</label> <hois-value value="stipend.paymentStart | hoisDate"></hois-value> </md-input-container> <md-input-container flex="50" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'main.thru\' | translate}}</label> <hois-value value="stipend.paymentEnd | hoisDate"></hois-value> </md-input-container> </div> </div> </fieldset> <br> <fieldset tabindex="1" ng-if="termCompliance && !termCompliance.fullyComplies"> <legend md-colors="{color: \'default-warn\'}" class="md-title-small">{{\'stipend.messages.error.studentDoesntComply\' | translate}}</legend> <div flex ng-include="\'scholarship/templates/scholarship.term.compliance.list.html\'"></div> </fieldset> <br> <fieldset tabindex="1"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'stipend.student.myData\' | translate}}</legend> <div class="form-readonly ois-form-layout-padding"> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.averageMark\' | translate}}</label> <hois-value value="application.averageMark"></hois-value> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label>{{\'stipend.lastPeriodMark\' | translate}}</label> <hois-value value="application.lastPeriodMark"></hois-value> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.curriculumCompletion\' | translate}}</label> <hois-value value="application.curriculumCompletion"></hois-value> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label>{{\'stipend.maxAbsences\' | translate}}</label> <hois-value value="application.absences"></hois-value> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.student.studentGroup\' | translate}}</label> <hois-value value="application.studentGroupCode"></hois-value> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label class="textInput">{{\'main.contactNumber\' | translate}}</label> <input ng-model="application.phone" type="text" md-maxlength="100" ng-disabled="!application.canApply"> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.student.address\' | translate}}</label> <hois-value value="application.address"></hois-value> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label class="textInput">{{\'main.email\' | translate}}</label> <input ng-model="application.email" type="email" md-maxlength="100" ng-disabled="!application.canApply"> </md-input-container> </div> </div> <div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <form name="applicationForm"> <div layout="row" flex> <md-input-container flex="45" flex-md="100" flex-sm="100" flex-xs="100"> <label>{{\'stipend.student.bankAccount\' | translate}}</label> <input type="text" ng-model="application.bankAccount" name="bankAccount" required md-maxlength="50" ng-disabled="!application.canApply"> </md-input-container> <md-input-container flex="50" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'stipend.student.bankAccountOwnerName\' | translate}}</label> <input type="text" ng-model="application.bankAccountOwnerName" name="bankAccountOwnerName" required md-maxlength="100" ng-disabled="!application.canApply"> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="45" flex-md="100" flex-sm="100" flex-xs="100"> <label>{{\'stipend.student.bankAccountOwnerIdcode\' | translate}}</label> <input type="text" ng-model="application.bankAccountOwnerIdcode" name="bankAccountOwnerIdcode" required md-maxlength="20" ng-disabled="!application.canApply"> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="100" flex-md="100" flex-sm="100" flex-xs="100"> <label>{{\'stipend.student.grantReason\' | translate}}</label> <textarea ng-model="application.addInfo" name="addInfo" md-maxlength="4000" ng-disabled="!application.canApply"></textarea> </md-input-container> </div> <div ng-include="\'scholarship/scholarship.relatedFiles.edit.html\'"></div> <br> <div layout="row" layout-xs="column"> <md-button class="md-raised md-primary" ng-if="application.canApply" ng-click="update(applicationForm)">{{\'main.button.save\' | translate}}</md-button> <md-button class="md-raised" ng-if="application.canApply" ng-click="apply(applicationForm)">{{\'stipend.student.apply\' | translate}}</md-button> <md-button class="md-raised" ng-click="back(\'#/scholarships/myData/grants\', applicationForm)">{{\'main.button.back\' | translate}}</md-button> </div> </form> </div> </div> </fieldset> </div>'),a.put("scholarship/student/scholarship.application.pohi.view.html",'<div class="ois-form-layout-padding" ng-cloak> <fieldset tabindex="1"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'stipend.student.grantTerms\' | translate}}</legend> <div class="form-readonly ois-form-layout-padding"> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.grantType\' | translate}}</label> <hois-classifier-value ng-model="stipend.type" main-classifier-code="STIPTOETUS"></hois-classifier-value> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label>{{\'stipend.places\' | translate}}</label> <hois-value value="stipend.places"></hois-value> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.studyPeriod\' | translate}}</label> <hois-value value="currentLanguageNameField(stipend.studyPeriod)"></hois-value> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label>{{\'stipend.amountPaid\' | translate}}</label> <hois-value value="stipend.amountPaid"></hois-value> </md-input-container> </div> <div layout="row" layout-xs="column" flex> <md-input-container flex="45" flex-xs="100"> <label class="textInput">{{\'stipend.studyForm\' | translate}}</label> <hois-classifier-value ng-model="stipend.studyForms" main-classifier-code="OPPEVORM" multiple></hois-classifier-value> </md-input-container> <md-input-container flex="50" flex-xs="100" flex-offset-xs="0" flex-offset="5"> <label class="textInput">{{\'stipend.averageMark\' | translate}}</label> <hois-value value="stipend.averageMark"></hois-value> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="100"> <label class="textInput">{{\'stipend.addInfo\' | translate}}</label> <hois-value value="stipend.addInfo"></hois-value> </md-input-container> </div> <div layout="row" layout-xs="column" flex> <md-input-container flex="45" flex-xs="100"> <label class="textInput">{{\'stipend.curriculumCompletion\' | translate}}</label> <hois-value value="stipend.curriculumCompletion"></hois-value> </md-input-container> <md-input-container flex="50" flex-xs="100" flex-offset-xs="0" flex-offset="5"> <label class="textInput">{{\'stipend.lastPeriodMark\' | translate}}</label> <hois-value value="stipend.lastPeriodMark"></hois-value> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.maxAbsences\' | translate}}</label> <hois-value value="stipend.maxAbsences"></hois-value> </md-input-container> <div flex="50" flex-offset="5"> <md-checkbox ng-model="stipend.isTeacherConfirm" disabled aria-label="Is teacher confirm"> {{\'stipend.isTeacherConfirm\' | translate}} </md-checkbox> </div> </div> <div layout="row"> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100"> <label>{{\'stipend.studyPeriodDates\' | translate}}</label> <input type="hidden"> </md-input-container> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'main.from\' | translate}}</label> <hois-value value="stipend.studyStartPeriodStart | hoisDate"></hois-value> </md-input-container> <md-input-container flex="50" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'main.thru\' | translate}}</label> <hois-value value="stipend.studyStartPeriodEnd | hoisDate"></hois-value> </md-input-container> </div> <div layout="row"> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100"> <label>{{\'stipend.paymentPeriod\' | translate}}</label> <input type="hidden"> </md-input-container> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'main.from\' | translate}}</label> <hois-value value="stipend.paymentStart | hoisDate"></hois-value> </md-input-container> <md-input-container flex="50" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'main.thru\' | translate}}</label> <hois-value value="stipend.paymentEnd | hoisDate"></hois-value> </md-input-container> </div> </div> </fieldset> <br> <fieldset tabindex="1"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{isStudent() ? \'stipend.student.myData\' : \'stipend.student.studentData\' | translate}}</legend> <div class="form-readonly ois-form-layout-padding"> <div layout="row" layout-xs="column" flex> <md-input-container flex="45" flex-xs="100"> <label class="textInput">{{\'stipend.averageMark\' | translate}}</label> <hois-value value="application.averageMark"></hois-value> </md-input-container> <md-input-container flex="50" flex-xs="100" flex-offset-xs="0" flex-offset="5"> <label>{{\'stipend.lastPeriodMark\' | translate}}</label> <hois-value value="application.lastPeriodMark"></hois-value> </md-input-container> </div> <div layout="row" layout-xs="column" flex> <md-input-container flex="45" flex-xs="100"> <label class="textInput">{{\'stipend.curriculumCompletion\' | translate}}</label> <hois-value value="application.curriculumCompletion"></hois-value> </md-input-container> <md-input-container flex="50" flex-xs="100" flex-offset-xs="0" flex-offset="5"> <label>{{\'stipend.maxAbsences\' | translate}}</label> <hois-value value="application.absences"></hois-value> </md-input-container> </div> <div layout="row" layout-xs="column" flex> <md-input-container flex="45" flex-xs="100"> <label class="textInput">{{\'stipend.student.studentGroup\' | translate}}</label> <hois-value value="application.studentGroupCode"></hois-value> </md-input-container> <md-input-container flex="50" flex-xs="100" flex-offset-xs="0" flex-offset="5"> <label class="textInput">{{\'main.contactNumber\' | translate}}</label> <hois-value value="application.phone"></hois-value> </md-input-container> </div> <div layout="row" layout-xs="column" flex> <md-input-container flex="45" flex-xs="100"> <label class="textInput">{{\'stipend.student.address\' | translate}}</label> <hois-value value="application.address"></hois-value> </md-input-container> <md-input-container flex="50" flex-xs="100" flex-offset-xs="0" flex-offset="5"> <label class="textInput">{{\'main.email\' | translate}}</label> <hois-value value="application.email"></hois-value> </md-input-container> </div> </div> <div class="form-readonly ois-form-layout-padding"> <div flex> <div layout="row" flex> <md-input-container flex="45" flex-md="100" flex-sm="100" flex-xs="100"> <label>{{\'stipend.student.bankAccount\' | translate}}</label> <hois-value value="application.bankAccount"></hois-value> </md-input-container> <md-input-container flex="50" flex-md="100" flex-sm="100" flex-xs="100" flex-offset-xs="0" flex-offset="5"> <label>{{\'stipend.student.bankAccountOwnerName\' | translate}}</label> <hois-value value="application.bankAccountOwnerName"></hois-value> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="45" flex-md="100" flex-sm="100" flex-xs="100"> <label>{{\'stipend.student.bankAccountOwnerIdcode\' | translate}}</label> <hois-value value="application.bankAccountOwnerIdcode"></hois-value> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="100" flex-md="100" flex-sm="100" flex-xs="100"> <label>{{\'stipend.student.grantReason\' | translate}}</label> <hois-value value="application.addInfo"></hois-value> </md-input-container> </div> <div ng-include="\'scholarship/scholarship.relatedFiles.edit.html\'"></div> <br> <div layout="row"> <md-button class="md-raised md-primary" ng-if="canManage" ng-click="accept()">{{\'main.button.accept\' | translate}}</md-button> <md-button class="md-raised" ng-click="back(isStudent() ? \'#/scholarships/myData/grants\' : \'#/scholarships/applications/grants\')">{{\'main.button.back\' | translate}}</md-button> </div> </div> </div> </fieldset> </div>'),a.put("scholarship/student/scholarship.application.scho.edit.html",'<div class="ois-form-layout-padding" ng-cloak> <fieldset tabindex="1"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'stipend.student.scholarshipTerms\' | translate}}</legend> <div class="form-readonly ois-form-layout-padding"> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.scholarshipType\' | translate}}</label> <hois-classifier-value ng-model="stipend.type" main-classifier-code="STIPTOETUS"></hois-classifier-value> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label>{{\'stipend.places\' | translate}}</label> <hois-value value="stipend.places"></hois-value> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.studyPeriod\' | translate}}</label> <hois-value value="currentLanguageNameField(stipend.studyPeriod)"></hois-value> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label>{{\'stipend.amountPaid\' | translate}}</label> <hois-value value="stipend.amountPaid"></hois-value> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.studyLoad\' | translate}}</label> <hois-classifier-value ng-model="stipend.studyLoads" main-classifier-code="OPPEKOORMUS" multiple></hois-classifier-value> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label class="textInput">{{\'stipend.averageMark\' | translate}}</label> <hois-value value="stipend.averageMark"></hois-value> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.curriculumCompletion\' | translate}}</label> <hois-value value="stipend.curriculumCompletion"></hois-value> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label class="textInput">{{\'stipend.lastPeriodMark\' | translate}}</label> <hois-value value="stipend.lastPeriodMark"></hois-value> </md-input-container> </div> <div layout="row"> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100"> <label>{{\'stipend.studyPeriodDates\' | translate}}</label> <input type="hidden"> </md-input-container> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'main.from\' | translate}}</label> <hois-value value="stipend.studyStartPeriodStart | hoisDate"></hois-value> </md-input-container> <md-input-container flex="50" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'main.thru\' | translate}}</label> <hois-value value="stipend.studyStartPeriodEnd | hoisDate"></hois-value> </md-input-container> </div> <div layout="row"> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100"> <label>{{\'stipend.paymentPeriod\' | translate}}</label> <input type="hidden"> </md-input-container> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'main.from\' | translate}}</label> <hois-value value="stipend.paymentStart | hoisDate"></hois-value> </md-input-container> <md-input-container flex="50" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'main.thru\' | translate}}</label> <hois-value value="stipend.paymentEnd | hoisDate"></hois-value> </md-input-container> </div> <div layout="row" flex> <div flex> <md-checkbox ng-model="stipend.isAcademicLeave" disabled aria-label="Is academic leave"> {{\'stipend.isAcademicLeave\' | translate}} </md-checkbox> </div> </div> </div> </fieldset> <br> <fieldset tabindex="1" ng-if="termCompliance && !termCompliance.fullyComplies"> <legend md-colors="{color: \'default-warn\'}" class="md-title-small">{{\'stipend.messages.error.studentDoesntComply\' | translate}}</legend> <div flex ng-include="\'scholarship/templates/scholarship.term.compliance.list.html\'"></div> </fieldset> <br> <fieldset tabindex="1"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'stipend.student.myData\' | translate}}</legend> <div class="form-readonly ois-form-layout-padding"> <div layout="row" flex> <md-input-container flex="45" ng-if="!application.useSaisPoints"> <label class="textInput">{{\'stipend.averageMark\' | translate}}</label> <hois-value value="application.averageMark"></hois-value> </md-input-container> <md-input-container flex="45" ng-if="application.useSaisPoints"> <label class="textInput">{{\'stipend.saisPoints\' | translate}}</label> <hois-value value="application.saisPoints"></hois-value> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label>{{\'stipend.lastPeriodMark\' | translate}}</label> <hois-value value="application.lastPeriodMark"></hois-value> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.curriculumCompletion\' | translate}}</label> <hois-value value="application.curriculumCompletion"></hois-value> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label class="textInput">{{\'stipend.credits\' | translate}}</label> <hois-value value="application.credits"></hois-value> </md-input-container> </div> </div> <ng-form name="applicationForm"> <div layout="row" flex> <md-input-container flex="45" flex-md="100" flex-sm="100" flex-xs="100"> <label>{{\'stipend.student.bankAccount\' | translate}}</label> <input type="text" ng-model="application.bankAccount" name="bankAccount" required md-maxlength="50"> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="100" flex-md="100" flex-sm="100" flex-xs="100"> <label>{{\'stipend.student.professionalAchievements\' | translate}}</label> <textarea ng-model="application.addInfo" name="addInfo" md-maxlength="4000"></textarea> </md-input-container> </div> <br> <div ng-include="\'scholarship/scholarship.relatedFiles.edit.html\'"></div> <br> <div layout="row"> <md-button class="md-raised md-primary" ng-if="application.canApply" ng-click="update(applicationForm)">{{\'main.button.save\' | translate}}</md-button> <md-button class="md-raised" ng-if="application.canApply" ng-click="apply(applicationForm)">{{\'stipend.student.apply\' | translate}}</md-button> <md-button class="md-raised" ng-click="back(\'#/scholarships/myData/grants\', applicationForm)">{{\'main.button.back\' | translate}}</md-button> </div> </ng-form> </fieldset> </div>'),a.put("scholarship/student/scholarship.application.scho.view.html",'<div class="ois-form-layout-padding" ng-cloak> <fieldset tabindex="1"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'stipend.student.scholarshipTerms\' | translate}}</legend> <div class="form-readonly ois-form-layout-padding"> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.scholarshipType\' | translate}}</label> <hois-classifier-value ng-model="stipend.type" main-classifier-code="STIPTOETUS"></hois-classifier-value> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label>{{\'stipend.places\' | translate}}</label> <hois-value value="stipend.places"></hois-value> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.studyPeriod\' | translate}}</label> <hois-value value="currentLanguageNameField(stipend.studyPeriod)"></hois-value> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label>{{\'stipend.amountPaid\' | translate}}</label> <hois-value value="stipend.amountPaid"></hois-value> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.studyLoad\' | translate}}</label> <hois-classifier-value ng-model="stipend.studyLoads" main-classifier-code="OPPEKOORMUS" multiple></hois-classifier-value> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label class="textInput">{{\'stipend.averageMark\' | translate}}</label> <hois-value value="stipend.averageMark"></hois-value> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.curriculumCompletion\' | translate}}</label> <hois-value value="stipend.curriculumCompletion"></hois-value> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label class="textInput">{{\'stipend.lastPeriodMark\' | translate}}</label> <hois-value value="stipend.lastPeriodMark"></hois-value> </md-input-container> </div> <div layout="row"> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100"> <label>{{\'stipend.studyPeriodDates\' | translate}}</label> <input type="hidden"> </md-input-container> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'main.from\' | translate}}</label> <hois-value value="stipend.studyStartPeriodStart | hoisDate"></hois-value> </md-input-container> <md-input-container flex="50" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'main.thru\' | translate}}</label> <hois-value value="stipend.studyStartPeriodEnd | hoisDate"></hois-value> </md-input-container> </div> <div layout="row"> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100"> <label>{{\'stipend.paymentPeriod\' | translate}}</label> <input type="hidden"> </md-input-container> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'main.from\' | translate}}</label> <hois-value value="stipend.paymentStart | hoisDate"></hois-value> </md-input-container> <md-input-container flex="50" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'main.thru\' | translate}}</label> <hois-value value="stipend.paymentEnd | hoisDate"></hois-value> </md-input-container> </div> <div layout="row" flex> <div flex> <md-checkbox ng-model="stipend.isAcademicLeave" disabled aria-label="Is academic leave"> {{\'stipend.isAcademicLeave\' | translate}} </md-checkbox> </div> </div> </div> </fieldset> <br> <fieldset tabindex="1"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{isStudent() ? \'stipend.student.myData\' : \'stipend.student.studentData\' | translate}}</legend> <div class="form-readonly ois-form-layout-padding"> <div layout="row" flex> <md-input-container flex="45" ng-if="!application.useSaisPoints"> <label class="textInput">{{\'stipend.averageMark\' | translate}}</label> <hois-value value="application.averageMark"></hois-value> </md-input-container> <md-input-container flex="45" ng-if="application.useSaisPoints"> <label class="textInput">{{\'stipend.saisPoints\' | translate}}</label> <hois-value value="application.saisPoints"></hois-value> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label>{{\'stipend.lastPeriodMark\' | translate}}</label> <hois-value value="application.lastPeriodMark"></hois-value> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.curriculumCompletion\' | translate}}</label> <hois-value value="application.curriculumCompletion"></hois-value> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label class="textInput">{{\'stipend.credits\' | translate}}</label> <hois-value value="application.credits"></hois-value> </md-input-container> </div> </div> <div class="form-readonly ois-form-layout-padding"> <div layout="row" flex> <md-input-container flex="45" flex-md="100" flex-sm="100" flex-xs="100"> <label>{{\'stipend.student.bankAccount\' | translate}}</label> <hois-value value="application.bankAccount"></hois-value> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="100" flex-md="100" flex-sm="100" flex-xs="100"> <label>{{\'stipend.student.professionalAchievements\' | translate}}</label> <hois-value value="application.addInfo"></hois-value> </md-input-container> </div> <br> <div ng-include="\'scholarship/scholarship.relatedFiles.edit.html\'"></div> <br> <div layout="row"> <md-button class="md-raised md-primary" ng-if="canManage" ng-click="accept()">{{\'main.button.accept\' | translate}}</md-button> <md-button class="md-raised" ng-click="back(isStudent() ? \'#/scholarships/myData/scholarships\' : \'#/scholarships/applications/grants\')">{{\'main.button.back\' | translate}}</md-button> </div> </div> </fieldset> </div>'),
a.put("scholarship/student/scholarship.application.soidu.edit.html",'<div class="ois-form-layout-padding" ng-cloak> <fieldset tabindex="1"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'stipend.student.grantTerms\' | translate}}</legend> <div class="form-readonly ois-form-layout-padding"> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.grantType\' | translate}}</label> <hois-classifier-value ng-model="stipend.type" main-classifier-code="STIPTOETUS"></hois-classifier-value> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.studyPeriod\' | translate}}</label> <hois-value value="currentLanguageNameField(stipend.studyPeriod)"></hois-value> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label>{{\'stipend.amountPaid\' | translate}}</label> <hois-value value="stipend.amountPaid"></hois-value> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.studyForm\' | translate}}</label> <hois-classifier-value ng-model="stipend.studyForms" main-classifier-code="OPPEVORM" multiple></hois-classifier-value> </md-input-container> <div flex="50" flex-offset="5"> <md-checkbox ng-model="stipend.isTeacherConfirm" disabled aria-label="Is teacher confirm"> {{\'stipend.isTeacherConfirm\' | translate}} </md-checkbox> </div> </div> <div layout="row" flex> <md-input-container flex="100"> <label class="textInput">{{\'stipend.addInfo\' | translate}}</label> <hois-value value="stipend.addInfo"></hois-value> </md-input-container> </div> <div layout="row"> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100"> <label>{{\'stipend.studyPeriodDates\' | translate}}</label> <input type="hidden"> </md-input-container> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'main.from\' | translate}}</label> <hois-value value="stipend.studyStartPeriodStart | hoisDate"></hois-value> </md-input-container> <md-input-container flex="50" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'main.thru\' | translate}}</label> <hois-value value="stipend.studyStartPeriodEnd | hoisDate"></hois-value> </md-input-container> </div> <div layout="row"> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100"> <label>{{\'stipend.paymentPeriod\' | translate}}</label> <input type="hidden"> </md-input-container> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'main.from\' | translate}}</label> <hois-value value="stipend.paymentStart | hoisDate"></hois-value> </md-input-container> <md-input-container flex="50" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'main.thru\' | translate}}</label> <hois-value value="stipend.paymentEnd | hoisDate"></hois-value> </md-input-container> </div> </div> </fieldset> <br> <fieldset tabindex="1" ng-if="termCompliance && !termCompliance.fullyComplies"> <legend md-colors="{color: \'default-warn\'}" class="md-title-small">{{\'stipend.messages.error.studentDoesntComply\' | translate}}</legend> <div flex ng-include="\'scholarship/templates/scholarship.term.compliance.list.html\'"></div> </fieldset> <br> <fieldset tabindex="1"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'stipend.student.myData\' | translate}}</legend> <div class="form-readonly ois-form-layout-padding"> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.student.studentGroup\' | translate}}</label> <hois-value value="application.studentGroupCode"></hois-value> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label class="textInput">{{\'main.contactNumber\' | translate}}</label> <input ng-model="application.phone" type="text" md-maxlength="100" ng-disabled="!application.canApply"> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.student.address\' | translate}}</label> <hois-value value="application.address"></hois-value> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label class="textInput">{{\'main.email\' | translate}}</label> <input ng-model="application.email" type="email" md-maxlength="100" ng-disabled="!application.canApply"> </md-input-container> </div> </div> <div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <form name="applicationForm"> <div layout="row" flex> <md-input-container flex="45" flex-md="100" flex-sm="100" flex-xs="100"> <label>{{\'stipend.student.bankAccount\' | translate}}</label> <input type="text" ng-model="application.bankAccount" name="bankAccount" required md-maxlength="50" ng-disabled="!application.canApply"> </md-input-container> <md-input-container flex="50" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'stipend.student.bankAccountOwnerName\' | translate}}</label> <input type="text" ng-model="application.bankAccountOwnerName" name="bankAccountOwnerName" required md-maxlength="100" ng-disabled="!application.canApply"> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="45" flex-md="100" flex-sm="100" flex-xs="100"> <label>{{\'stipend.student.bankAccountOwnerIdcode\' | translate}}</label> <input type="text" ng-model="application.bankAccountOwnerIdcode" name="bankAccountOwnerIdcode" required md-maxlength="20" ng-disabled="!application.canApply"> </md-input-container> </div> <div layout="row"> <div layout="column" flex="45"> <div layout="row" flex> <md-input-container flex> <label class="textInput">{{\'stipend.compensationReason\' | translate}}</label> <hois-classifier-select required ng-model="application.compensationReason" name="type" model-value-attr="code" main-classifier-code="STIPTOETUS_HYVITAMINE_POHJUS" ng-disabled="!application.canApply"></hois-classifier-select> </md-input-container> </div> <div layout="row" ng-if="application.compensationReason === \'STIPTOETUS_HYVITAMINE_POHJUS_I\'"> <md-input-container flex> <label>{{\'stipend.routeKm\' | translate}}</label> <input ng-model="application.routeKm" type="number" aria-label="routeKm" min="0" ng-disabled="!application.canApply"> </md-input-container> </div> </div> <div layout="column" flex="50" flex-offset="5"> <fieldset flex="100" layout="column"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'stipend.compensationFrequency\' | translate}}</legend> <md-input-container> <md-radio-group layout="column" ng-model="application.compensationFrequency" ng-disabled="!application.canApply" required> <md-radio-button flex layout="row" ng-repeat="frequency in compensationFrequencies" value="{{frequency.code}}" aria-label="passedSubject"> {{currentLanguageNameField(frequency)}} </md-radio-button> </md-radio-group> </md-input-container> </fieldset> </div> </div> <div layout="row" flex ng-if="application.compensationReason === \'STIPTOETUS_HYVITAMINE_POHJUS_M\'"> <md-input-container flex="100" flex-md="100" flex-sm="100" flex-xs="100"> <label>{{\'stipend.student.specificReason\' | translate}}</label> <textarea required ng-model="application.addInfo" name="addInfo" md-maxlength="4000" ng-disabled="!application.canApply"></textarea> </md-input-container> </div> <br> <div ng-include="\'scholarship/scholarship.relatedFiles.edit.html\'"></div> <br> <div layout="row"> <md-button class="md-raised md-primary" ng-if="application.canApply" ng-click="update(applicationForm)">{{\'main.button.save\' | translate}}</md-button> <md-button class="md-raised" ng-if="application.canApply" ng-click="apply(applicationForm)">{{\'stipend.student.apply\' | translate}}</md-button> <md-button class="md-raised" ng-click="back(\'#/scholarships/myData/grants\', applicationForm)">{{\'main.button.back\' | translate}}</md-button> </div> </form> </div> </div> </fieldset> </div>'),a.put("scholarship/student/scholarship.application.soidu.view.html",'<div class="ois-form-layout-padding" ng-cloak> <fieldset tabindex="1"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'stipend.student.grantTerms\' | translate}}</legend> <div class="form-readonly ois-form-layout-padding"> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.grantType\' | translate}}</label> <hois-classifier-value ng-model="stipend.type" main-classifier-code="STIPTOETUS"></hois-classifier-value> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.studyPeriod\' | translate}}</label> <hois-value value="currentLanguageNameField(stipend.studyPeriod)"></hois-value> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label>{{\'stipend.amountPaid\' | translate}}</label> <hois-value value="stipend.amountPaid"></hois-value> </md-input-container> </div> <div layout="row" layout-xs="column" flex> <md-input-container flex="45" flex-xs="100"> <label class="textInput">{{\'stipend.studyForm\' | translate}}</label> <hois-classifier-value ng-model="stipend.studyForms" main-classifier-code="OPPEVORM" multiple></hois-classifier-value> </md-input-container> <div flex="50" flex-xs="100" flex-offset-xs="0" flex-offset="5"> <md-checkbox ng-model="stipend.isTeacherConfirm" disabled aria-label="Is teacher confirm"> {{\'stipend.isTeacherConfirm\' | translate}} </md-checkbox> </div> </div> <div layout="row" flex> <md-input-container flex="100"> <label class="textInput">{{\'stipend.addInfo\' | translate}}</label> <hois-value value="stipend.addInfo"></hois-value> </md-input-container> </div> <div layout="row"> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100"> <label>{{\'stipend.studyPeriodDates\' | translate}}</label> <input type="hidden"> </md-input-container> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'main.from\' | translate}}</label> <hois-value value="stipend.studyStartPeriodStart | hoisDate"></hois-value> </md-input-container> <md-input-container flex="50" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'main.thru\' | translate}}</label> <hois-value value="stipend.studyStartPeriodEnd | hoisDate"></hois-value> </md-input-container> </div> <div layout="row"> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100"> <label>{{\'stipend.paymentPeriod\' | translate}}</label> <input type="hidden"> </md-input-container> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'main.from\' | translate}}</label> <hois-value value="stipend.paymentStart | hoisDate"></hois-value> </md-input-container> <md-input-container flex="50" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'main.thru\' | translate}}</label> <hois-value value="stipend.paymentEnd | hoisDate"></hois-value> </md-input-container> </div> </div> </fieldset> <br> <fieldset tabindex="1"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{isStudent() ? \'stipend.student.myData\' : \'stipend.student.studentData\' | translate}}</legend> <div class="form-readonly ois-form-layout-padding"> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.student.studentGroup\' | translate}}</label> <hois-value value="application.studentGroupCode"></hois-value> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label class="textInput">{{\'main.contactNumber\' | translate}}</label> <hois-value value="application.phone"></hois-value> </md-input-container> </div> <div layout="row" layout-xs="column" flex> <md-input-container flex="45" flex-xs="100"> <label class="textInput">{{\'stipend.student.address\' | translate}}</label> <hois-value value="application.address"></hois-value> </md-input-container> <md-input-container flex="50" flex-xs="100" flex-offset-xs="0" flex-offset="5"> <label class="textInput">{{\'main.email\' | translate}}</label> <hois-value value="application.email"></hois-value> </md-input-container> </div> </div> <div class="form-readonly ois-form-layout-padding"> <div flex> <div layout="row" flex> <md-input-container flex="45" flex-md="100" flex-sm="100" flex-xs="100"> <label>{{\'stipend.student.bankAccount\' | translate}}</label> <hois-value value="application.bankAccount"></hois-value> </md-input-container> <md-input-container flex="50" flex-md="100" flex-sm="100" flex-xs="100" flex-offset-xs="0" flex-offset="5"> <label>{{\'stipend.student.bankAccountOwnerName\' | translate}}</label> <hois-value value="application.bankAccountOwnerName"></hois-value> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="45" flex-md="100" flex-sm="100" flex-xs="100"> <label>{{\'stipend.student.bankAccountOwnerIdcode\' | translate}}</label> <hois-value value="application.bankAccountOwnerIdcode"></hois-value> </md-input-container> </div> <div layout="row" layout-xs="column"> <div layout="column" flex="45" flex-xs="100"> <div layout="row" flex> <md-input-container flex> <label class="textInput">{{\'stipend.compensationReason\' | translate}}</label> <hois-classifier-value ng-model="application.compensationReason" main-classifier-code="STIPTOETUS_HYVITAMINE_POHJUS"></hois-classifier-value> </md-input-container> </div> <div layout="row" ng-if="application.compensationReason === \'STIPTOETUS_HYVITAMINE_POHJUS_I\'"> <md-input-container flex> <label>{{\'stipend.routeKm\' | translate}}</label> <hois-value value="application.routeKm"></hois-value> </md-input-container> </div> </div> <div layout="column" layout-xs="row" flex-xs="100" flex-offset-xs="0" flex="50" flex-offset="5"> <fieldset flex="100" layout="column"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'stipend.compensationFrequency\' | translate}}</legend> <div style="overflow:auto"> <md-input-container> <md-radio-group layout="column" ng-model="application.compensationFrequency" required> <md-radio-button flex layout="row" disabled ng-repeat="frequency in compensationFrequencies" value="{{frequency.code}}" aria-label="passedSubject"> {{currentLanguageNameField(frequency)}} </md-radio-button> </md-radio-group> </md-input-container> </div> </fieldset> </div> </div> <div layout="row" flex ng-if="application.compensationReason === \'STIPTOETUS_HYVITAMINE_POHJUS_M\'"> <md-input-container flex="100" flex-md="100" flex-sm="100" flex-xs="100"> <label>{{\'stipend.student.specificReason\' | translate}}</label> <hois-value value="application.addInfo"></hois-value> </md-input-container> </div> <br> <div ng-include="\'scholarship/scholarship.relatedFiles.edit.html\'"></div> <br> <div layout="row"> <md-button class="md-raised md-primary" ng-if="canManage" ng-click="accept()">{{\'main.button.accept\' | translate}}</md-button> <md-button class="md-raised" ng-click="back(isStudent() ? \'#/scholarships/myData/grants\' : \'#/scholarships/applications/grants\')">{{\'main.button.back\' | translate}}</md-button> </div> </div> </div> </fieldset> </div>'),a.put("scholarship/student/scholarship.drGrants.student.html",'<div class="ois-form-layout-padding" ng-cloak> <fieldset tabindex="1"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'stipend.student.grants\' | translate}}</legend> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'stipend.type\' | translate}}</th> <th md-column>{{\'stipend.applicationPeriod\' | translate}}</th> <th md-column>{{\'stipend.places\' | translate}}</th> <th md-column>&nbsp;</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="stipend in possibleStipends" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{currentLanguageNameField(stipend.type)}}</td> <td md-cell> <span ng-if="stipend.applicationStart && stipend.applicationEnd">{{stipend.applicationStart | hoisDate}}-{{stipend.applicationEnd | hoisDate}}</span> <span ng-if="stipend.applicationStart && !stipend.applicationEnd">{{\'main.from\' | translate}} {{stipend.applicationStart | hoisDate}}</span> <span ng-if="!stipend.applicationStart && stipend.applicationEnd">{{\'main.thru\' | translate}} {{stipend.applicationEnd | hoisDate}}</span> <span ng-if="!stipend.applicationStart && !stipend.applicationEnd">-</span> </td> <td md-cell>{{stipend.places ? stipend.places : \'-\'}}</td> <td md-cell> <span ng-if="stipend.canApply"> <a href="#/scholarships/{{stipend.id}}/application">{{\'stipend.student.apply\' | translate}}</a> </span> </td> </tr> </tbody> </table> </fieldset> <br> <fieldset tabindex="1"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'stipend.student.applications\' | translate}}</legend> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'stipend.type\' | translate}}</th> <th md-column>{{\'stipend.student.status\' | translate}}</th> <th md-column>{{\'stipend.student.decisionDate\' | translate}}</th> <th md-column>&nbsp;</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="stipend in studentStipends" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell> <a href="#/scholarships/applications/{{stipend.id}}">{{currentLanguageNameField(stipend.type)}}</a> </td> <td md-cell>{{currentLanguageNameField(stipend.status)}} <md-tooltip ng-if="[\'STIPTOETUS_STAATUS_L\', \'STIPTOETUS_STAATUS_T\'].indexOf(stipend.status.code) !== -1  && stipend.rejectComment">{{stipend.rejectComment}}</md-tooltip> </td> <td md-cell>{{stipend.decisionDate ? (stipend.decisionDate | hoisDate) : \'-\'}}</td> <td md-cell> <span ng-if="stipend.canApply"> <a href="#/scholarships/{{stipend.termId}}/application">{{\'stipend.student.edit\' | translate}}</a> </span> </td> </tr> </tbody> </table> </fieldset> </div>'),a.put("scholarship/student/scholarship.family.addMember.html",'<md-dialog aria-label="add enterprise dialog" flex="30"> <form name="dialogForm" ng-submit="dialogForm.$valid && submit()" novalidate ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2 flex>{{\'stipend.student.addFamilyMember\' | translate}}</h2> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <span flex></span> <div class="ois-form-layout" layout="column" layout-margin ng-cloak> <md-input-container flex> <label>{{\'stipend.family.name\' | translate}}</label> <input type="text" ng-model="member.name" name="name" required md-maxlength="100"> </md-input-container> <md-input-container flex> <label>{{\'stipend.family.netSalary\' | translate}}</label> <input ng-model="member.netSalary" type="number" aria-label="places" min="0"> </md-input-container> <md-input-container flex> <label>{{\'stipend.family.pension\' | translate}}</label> <input ng-model="member.pension" type="number" aria-label="places" min="0"> </md-input-container> <md-input-container flex> <label>{{\'stipend.family.stateBenefit\' | translate}}</label> <input ng-model="member.stateBenefit" type="number" aria-label="places" min="0"> </md-input-container> <md-input-container flex> <label>{{\'stipend.family.otherIncome\' | translate}}</label> <input ng-model="member.otherIncome" type="number" aria-label="places" min="0"> </md-input-container> <md-input-container flex> <label>{{\'stipend.family.unemployedBenefit\' | translate}}</label> <input ng-model="member.unemployedBenefit" type="number" aria-label="places" min="0"> </md-input-container> </div> </md-dialog-content> <md-dialog-actions layout="row" layout-align="start start"> <md-button class="md-raised md-primary" type="submit">{{\'main.button.add\' | translate}}</md-button> <md-button class="md-raised" ng-click="cancel()">{{"main.button.close" | translate}}</md-button> </md-dialog-actions> </form> </md-dialog>'),a.put("scholarship/student/scholarship.family.table.edit.html",'<fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small"> {{\'stipend.student.familyIncome\' | translate}}</legend> <div layout="row" flex> <md-input-container flex="45"> <label>{{\'stipend.student.familyMembers\' | translate}}</label> <input ng-model="application.familyMembers" type="number" autofocus aria-label="familyMembers" min="0" ng-disabled="!application.canApply"> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label>{{\'stipend.student.familyMembersAdult\' | translate}}</label> <input ng-model="application.familyMembersAdult" type="number" autofocus aria-label="familyMembersAdult" min="0" max="{{application.familyMembers ? application.familyMembers : 0}}" ng-disabled="!application.canApply"> </md-input-container> </div> <md-button class="md-raised" ng-click="addFamilyMember()" ng-if="editable && application.canApply">{{\'stipend.student.addFamilyMember\' | translate}}</md-button> <md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'stipend.family.name\' | translate}}</th> <th md-column>{{\'stipend.family.netSalary\' | translate}}</th> <th md-column>{{\'stipend.family.pension\' | translate}}</th> <th md-column>{{\'stipend.family.stateBenefit\' | translate}}</th> <th md-column>{{\'stipend.family.otherIncome\' | translate}}</th> <th md-column>{{\'stipend.family.unemployedBenefit\' | translate}}</th> <th md-column>{{\'main.sum\' | translate}}</th> <th md-column ng-if="editable && application.canApply"></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="member in application.family" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{member.name}}</td> <td md-cell>{{member.netSalary ? member.netSalary : \'-\'}}</td> <td md-cell>{{member.pension ? member.pension : \'-\'}}</td> <td md-cell>{{member.stateBenefit ? member.stateBenefit : \'-\'}}</td> <td md-cell>{{member.otherIncome ? member.otherIncome : \'-\'}}</td> <td md-cell>{{member.unemployedBenefit ? member.unemployedBenefit : \'-\'}}</td> <td md-cell>{{member.sum ? member.sum : \'-\'}}</td> <td md-cell ng-if="editable && application.canApply"> <md-button class="remove nomargin" ng-click="removeFromArray(application.family, member)">&times;</md-button> </td> </tr> </tbody> </table> </md-table-container> </fieldset>'),a.put("scholarship/student/scholarship.family.table.view.html","<fieldset> <legend md-colors=\"{color: 'primary-800'}\" class=\"md-title-small\"> {{'stipend.student.familyIncome' | translate}}</legend> <div class=\"form-readonly ois-form-layout-padding\"> <div layout=\"row\" layout-xs=\"column\" flex> <md-input-container flex=\"45\" flex-xs=\"100\"> <label>{{'stipend.student.familyMembers' | translate}}</label> <hois-value value=\"application.familyMembers\"> </hois-value></md-input-container> <md-input-container flex=\"50\" flex-xs=\"100\" flex-offset-xs=\"0\" flex-offset=\"5\"> <label>{{'stipend.student.familyMembersAdult' | translate}}</label> <hois-value value=\"application.familyMembersAdult\"> </hois-value></md-input-container> </div> </div> <md-table-container> <table md-table class=\"secondary-table\"> <thead md-head> <tr md-row> <th md-column>{{'stipend.family.name' | translate}}</th> <th md-column>{{'stipend.family.netSalary' | translate}}</th> <th md-column>{{'stipend.family.pension' | translate}}</th> <th md-column>{{'stipend.family.stateBenefit' | translate}}</th> <th md-column>{{'stipend.family.otherIncome' | translate}}</th> <th md-column>{{'stipend.family.unemployedBenefit' | translate}}</th> <th md-column>{{'main.sum' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat=\"member in application.family\" ng-class-odd=\"'odd'\" ng-class-even=\"'even'\"> <td md-cell>{{member.name}}</td> <td md-cell>{{member.netSalary ? member.netSalary : '-'}}</td> <td md-cell>{{member.pension ? member.pension : '-'}}</td> <td md-cell>{{member.stateBenefit ? member.stateBenefit : '-'}}</td> <td md-cell>{{member.otherIncome ? member.otherIncome : '-'}}</td> <td md-cell>{{member.unemployedBenefit ? member.unemployedBenefit : '-'}}</td> <td md-cell>{{member.sum ? member.sum : '-'}}</td> </tr> </tbody> </table> </md-table-container> </fieldset>"),a.put("scholarship/student/scholarship.grants.student.html",'<div class="ois-form-layout-padding" ng-cloak> <fieldset tabindex="1"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'stipend.student.grants\' | translate}}</legend> <md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'stipend.type\' | translate}}</th> <th md-column>{{\'stipend.nameEt\' | translate}}</th> <th md-column>{{\'stipend.applicationPeriod\' | translate}}</th> <th md-column>{{\'stipend.places\' | translate}}</th> <th md-column>{{\'stipend.addInfo\' | translate}}</th> <th md-column>{{\'stipend.student.needsConfirm\' | translate}}</th> <th md-column>&nbsp;</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="stipend in possibleStipends" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell> <a ng-click="scholarshipTerms(stipend)">{{currentLanguageNameField(stipend.type)}}</a> </td> <td md-cell>{{stipend.nameEt | translate}}</td> <td md-cell> <span ng-if="stipend.applicationStart && stipend.applicationEnd">{{stipend.applicationStart | hoisDate}}-{{stipend.applicationEnd | hoisDate}}</span> <span ng-if="stipend.applicationStart && !stipend.applicationEnd">{{\'main.from\' | translate}} {{stipend.applicationStart | hoisDate}}</span> <span ng-if="!stipend.applicationStart && stipend.applicationEnd">{{\'main.thru\' | translate}} {{stipend.applicationEnd | hoisDate}}</span> <span ng-if="!stipend.applicationStart && !stipend.applicationEnd">-</span> </td> <td md-cell>{{stipend.places ? stipend.places : \'-\'}}</td> <td md-cell> <span>{{stipend.addInfo ? (stipend.addInfo | hoisLimitTo: 100:!stipend.showAddInfo) : \'-\'}}</span> <span class="custom-tooltip" ng-if="!stipend.showAddInfo && stipend.addInfo.length > 100" ng-click="stipend.showAddInfo = true">{{\'stipend.student.showMore\' | translate}}</span> <span class="custom-tooltip" ng-if="stipend.showAddInfo" ng-click="stipend.showAddInfo = false"> {{\'stipend.student.showLess\' | translate}}</span> </td> <td md-cell>{{stipend.isTeacherConfirm ? (\'main.yes\' | translate) : (\'main.no\' | translate)}}</td> <td md-cell> <span ng-if="stipend.canApply"> <a href="#/scholarships/{{stipend.id}}/application">{{\'stipend.student.apply\' | translate}}</a> </span> <md-button ng-if="!stipend.canApply && !stipend.alreadyApplied" flex class="md-icon-button" ng-click="scholarshipTermCompliances(stipend)"> <md-icon md-colors="{color: \'default-warn\'}" md-font-set="material-icons">warning</md-icon> <md-tooltip>{{\'stipend.messages.error.studentDoesntComply\' | translate}}</md-tooltip> </md-button> <span ng-if="stipend.alreadyApplied">{{\'stipend.student.alreadyApplied\' | translate}}</span> </td> </tr> </tbody> </table> </md-table-container> </fieldset> <br> <fieldset tabindex="1"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'stipend.student.applications\' | translate}}</legend> <md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'stipend.type\' | translate}}</th> <th md-column>{{\'stipend.nameEt\' | translate}}</th> <th md-column>{{\'stipend.student.isTeacherConfirm\' | translate}}</th> <th md-column>{{\'stipend.student.status\' | translate}}</th> <th md-column>{{\'stipend.student.additionDate\' | translate}}</th> <th md-column>{{\'stipend.student.decisionDate\' | translate}}</th> <th md-column>&nbsp;</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="stipend in studentStipends | orderBy: \'-inserted\'" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell> <a href="#/scholarships/applications/{{stipend.id}}">{{currentLanguageNameField(stipend.type)}}</a> </td> <td md-cell>{{stipend.termName | translate}}</td> <td md-cell>{{stipend.isTeacherConfirm === null && stipend.needsConfirm ? (\'stipend.needsConfirm\' | translate) : stipend.isTeacherConfirm ? ("main.confirm" | translate) : stipend.needsConfirm ? ("main.noConfirm" | translate) : "-"}}</td> <td md-cell>{{currentLanguageNameField(stipend.status)}} <md-tooltip ng-if="[\'STIPTOETUS_STAATUS_L\', \'STIPTOETUS_STAATUS_T\'].indexOf(stipend.status.code) !== -1 && stipend.rejectComment">{{stipend.rejectComment}}</md-tooltip> </td> <td md-cell>{{stipend.inserted | hoisDate}}</td> <td md-cell>{{stipend.decisionDate ? (stipend.decisionDate | hoisDate) : \'-\'}}</td> <td md-cell> <span ng-if="stipend.canApply"> <a href="#/scholarships/{{stipend.termId}}/application">{{\'stipend.student.edit\' | translate}}</a> </span> </td> </tr> </tbody> </table> </md-table-container> </fieldset> </div>'),a.put("scholarship/student/scholarship.scholarship.student.html","<div class=\"ois-form-layout-padding\" ng-cloak> <fieldset tabindex=\"1\"> <legend md-colors=\"{color: 'primary-800'}\" class=\"md-title-small\">{{'stipend.student.scholarships' | translate}}</legend> <md-table-container> <table md-table class=\"secondary-table\"> <thead md-head> <tr md-row> <th md-column>{{'stipend.type' | translate}}</th> <th md-column>{{'stipend.applicationPeriod' | translate}}</th> <th md-column>{{'stipend.places' | translate}}</th> <th md-column>{{'stipend.student.averageMark' | translate}}</th> <th md-column>{{'stipend.student.lastPeriodMark' | translate}}</th> <th md-column>{{'stipend.student.curriculumCompletion' | translate}}</th> <th md-column>&nbsp;</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat=\"stipend in possibleStipends\" ng-class-odd=\"'odd'\" ng-class-even=\"'even'\"> <td md-cell>{{currentLanguageNameField(stipend.type)}}</td> <td md-cell> <span ng-if=\"stipend.applicationStart && stipend.applicationEnd\">{{stipend.applicationStart | hoisDate}}-{{stipend.applicationEnd | hoisDate}}</span> <span ng-if=\"stipend.applicationStart && !stipend.applicationEnd\">{{'main.from' | translate}} {{stipend.applicationStart | hoisDate}}</span> <span ng-if=\"!stipend.applicationStart && stipend.applicationEnd\">{{'main.thru' | translate}} {{stipend.applicationEnd | hoisDate}}</span> <span ng-if=\"!stipend.applicationStart && !stipend.applicationEnd\">-</span> </td> <td md-cell>{{stipend.places ? stipend.places : '-'}}</td> <td md-cell>{{stipend.averageMark ? stipend.averageMark : '-'}}</td> <td md-cell>{{stipend.lastPeriodMark ? stipend.lastPeriodMark : '-'}}</td> <td md-cell>{{stipend.curriculumCompletion ? stipend.curriculumCompletion : '-'}}</td> <td md-cell> <span ng-if=\"stipend.canApply\"> <a href=\"#/scholarships/{{stipend.id}}/application\">{{'stipend.student.apply' | translate}}</a> </span> </td> </tr> </tbody> </table> </md-table-container> </fieldset> <br> <fieldset tabindex=\"1\"> <legend md-colors=\"{color: 'primary-800'}\" class=\"md-title-small\">{{'stipend.student.applications' | translate}}</legend> <md-table-container> <table md-table class=\"secondary-table\"> <thead md-head> <tr md-row> <th md-column>{{'stipend.type' | translate}}</th> <th md-column>{{'stipend.student.averageMark' | translate}}</th> <th md-column>{{'stipend.student.lastPeriodMark' | translate}}</th> <th md-column>{{'stipend.student.curriculumCompletion' | translate}}</th> <th md-column>{{'stipend.student.status' | translate}}</th> <th md-column>{{'stipend.student.decisionDate' | translate}}</th> <th md-column>&nbsp;</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat=\"stipend in studentStipends\" ng-class-odd=\"'odd'\" ng-class-even=\"'even'\"> <td md-cell> <a href=\"#/scholarships/applications/{{stipend.id}}\">{{currentLanguageNameField(stipend.type)}}</a> </td> <td md-cell>{{stipend.averageMark ? stipend.averageMark : '-'}}</td> <td md-cell>{{stipend.lastPeriodMark ? stipend.lastPeriodMark : '-'}}</td> <td md-cell>{{stipend.curriculumCompletion ? stipend.curriculumCompletion : '-'}}</td> <td md-cell>{{currentLanguageNameField(stipend.status)}} <md-tooltip ng-if=\"['STIPTOETUS_STAATUS_L', 'STIPTOETUS_STAATUS_T'].indexOf(stipend.status.code) !== -1  && stipend.rejectComment\">{{stipend.rejectComment}}</md-tooltip> </td> <td md-cell>{{stipend.decisionDate ? (stipend.decisionDate | hoisDate) : '-'}}</td> <td md-cell> <span ng-if=\"stipend.canApply\"> <a href=\"#/scholarships/{{stipend.termId}}/application\">{{'stipend.student.edit' | translate}}</a> </span> </td> </tr> </tbody> </table> </md-table-container> </fieldset> </div>"),
a.put("scholarship/templates/scholarship.applications.drGrants.html","<md-table-container> <table md-table class=\"secondary-table\" ng-if=\"submittedType\"> <thead md-head> <tr md-row> <th md-column ng-if=\"applicationsTable.showSelect\"> <md-input-container> <md-checkbox ng-model=\"selectAllApplications\" aria-label=\"mySchool\" ng-change=\"updateAllApplicationCheckBoxes(selectAllApplications)\"> </md-checkbox> </md-input-container> </th> <th md-column>{{'stipend.nr' | translate}}</th> <th md-column>{{'stipend.type' | translate}}</th> <th md-column>{{'stipend.grantName' | translate}}</th> <th md-column>{{'stipend.curriculum' | translate}}</th> <th md-column>{{'stipend.applicant' | translate}}</th> <th md-column>{{'stipend.student.idCode' | translate}}</th> <th md-column>{{'stipend.hasDirective' | translate}}</th> <th md-column>{{'stipend.decision.label' | translate}}</th> <th md-column>{{'stipend.status' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat=\"application in applications track by $index\" ng-class-odd=\"'odd'\" ng-class-even=\"'even'\" ng-class=\"{'scholarship-bottom-border': $index + 1 === allowedCount}\"> <td md-cell ng-if=\"applicationsTable.showSelect\"> <md-input-container> <md-checkbox ng-model=\"selected[application.id]\" aria-label=\"mySchool\"> </md-checkbox> </md-input-container> </td> <td md-cell>{{$index + 1}}</td> <td md-cell>{{currentLanguageNameField(application.type)}}</td> <td md-cell> <a href=\"#/scholarships/applications/{{application.id}}\">{{application.termNameEt}}</a> </td> <td md-cell>{{application.curriculumCode ? application.curriculumCode : '-'}}</td> <td md-cell> <a href=\"#/students/{{application.studentId}}/main\">{{application.studentName ? application.studentName : '-'}}</a> </td> <td md-cell>{{application.idcode ? application.idcode : '-'}}</td> <td md-cell>{{application.hasDirective ? ('main.yes' | translate) : ('main.no' | translate)}}</td> <td md-cell> <a ng-href=\"#/scholarships/decision/{{scholarshipType}}/{{application.decisionId}}\">{{application.decisionDecided | hoisDate}}</a> </td> <td md-cell>{{currentLanguageNameField(application.status)}} <md-tooltip ng-if=\"['STIPTOETUS_STAATUS_L', 'STIPTOETUS_STAATUS_T'].indexOf(application.status.code) !== -1  && application.rejectComment\">{{application.rejectComment}}</md-tooltip> </td> </tr> </tbody> </table> </md-table-container>"),a.put("scholarship/templates/scholarship.applications.grants.html","<div ng-if=\"applications.length > 0\" layout=\"row\" layout-md=\"column\" layout-sm=\"column\" layout-xs=\"column\" flex> <i class=\"material-icons\">*</i> <span class=\"capacity-type-legend\" md-colors=\"{background: 'deep-orange-100'}\">{{'stipend.bankIdcodeNotMatchingPerson' | translate}}</span> </div> <md-table-container> <table md-table class=\"secondary-table\" ng-if=\"submittedType\"> <thead md-head> <tr md-row> <th md-column ng-if=\"applicationsTable.showSelect\"> <md-input-container> <md-checkbox ng-model=\"selectAllApplications\" aria-label=\"mySchool\" ng-change=\"updateAllApplicationCheckBoxes(selectAllApplications)\"> </md-checkbox> </md-input-container> </th> <th md-column>{{'stipend.nr' | translate}}</th> <th md-column>{{'stipend.type' | translate}}</th> <th md-column>{{'stipend.grantName' | translate}}</th> <th md-column>{{'stipend.curriculum' | translate}}</th> <th md-column>{{'stipend.applicant' | translate}}</th> <th md-column>{{'stipend.student.idCode' | translate}}</th> <th md-column>{{'stipend.studentGroup' | translate}}</th> <!-- only for pohi and eri--> <th md-column ng-if=\"submittedType !== 'STIPTOETUS_SOIDU'\">{{'stipend.averageMarkShort' | translate}}</th> <th md-column ng-if=\"submittedType !== 'STIPTOETUS_SOIDU'\">{{'stipend.student.lastPeriodMark' | translate}}</th> <th md-column ng-if=\"submittedType !== 'STIPTOETUS_SOIDU'\">{{'stipend.student.curriculumCompletion' | translate}}</th> <!-- only for pohi--> <th md-column ng-if=\"submittedType === 'STIPTOETUS_POHI'\">{{'stipend.student.absences' | translate}}</th> <!-- only for soidu --> <th md-column ng-if=\"submittedType === 'STIPTOETUS_SOIDU'\">{{'stipend.compensationReason' | translate}}</th> <th md-column ng-if=\"submittedType === 'STIPTOETUS_SOIDU'\">{{'stipend.compensationFrequency' | translate}}</th> <th md-column>{{'stipend.student.isTeacherConfirm' | translate}}</th> <th md-column>{{'stipend.hasDirective' | translate}}</th> <th md-column>{{'stipend.decision.label' | translate}}</th> <th md-column>{{'stipend.status' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat=\"application in applications track by $index\" ng-class-odd=\"'odd'\" ng-class-even=\"'even'\" ng-class=\"{'scholarship-bottom-border': $index + 1 === allowedCount, 'scholarship-warning': application.bankAccountOwnerIdcode && application.idcode !== application.bankAccountOwnerIdcode}\"> <td md-cell ng-if=\"applicationsTable.showSelect\"> <md-input-container> <md-checkbox ng-model=\"selected[application.id]\" ng-hide=\"application.hasDirective\" ng-disabled=\"!application.needsConfirm && auth.isTeacher()\" aria-label=\"mySchool\"> </md-checkbox> </md-input-container> </td> <td md-cell>{{$index + 1}}</td> <td md-cell>{{currentLanguageNameField(application.type)}}</td> <td md-cell> <a href=\"#/scholarships/applications/{{application.id}}\">{{application.termNameEt}}</a> </td> <td md-cell>{{application.curriculumCode ? application.curriculumCode : '-'}}</td> <td md-cell class=\"one-row\"> <div layout=\"row\" layout-align=\"start center\" flex> <a href=\"#/students/{{application.studentId}}/main\" ng-style=\"application.nonCompliant && !application.hasDirective ? {color: 'red'} : {}\"> {{application.studentName ? application.studentName : '-'}} </a> <md-button ng-if=\"application.nonCompliant && !application.hasDirective\" flex class=\"md-icon-button\" ng-click=\"scholarshipTermCompliances(application)\"> <md-icon md-colors=\"{color: 'default-warn'}\" md-font-set=\"material-icons\">warning</md-icon> </md-button> </div> </td> <td md-cell>{{application.idcode ? application.idcode : '-'}}</td> <td md-cell>{{application.studentGroup ? application.studentGroup : '-'}}</td> <!-- only for pohi and eri--> <td md-cell ng-if=\"submittedType !== 'STIPTOETUS_SOIDU'\">{{application.averageMark ? application.averageMark : '-'}}</td> <td md-cell ng-if=\"submittedType !== 'STIPTOETUS_SOIDU'\">{{application.lastPeriodMark ? application.lastPeriodMark : '-'}}</td> <td md-cell ng-if=\"submittedType !== 'STIPTOETUS_SOIDU'\">{{isNumber(application.curriculumCompletion) ? application.curriculumCompletion : '-'}}</td> <!-- only for pohi--> <td md-cell ng-if=\"submittedType === 'STIPTOETUS_POHI'\">{{isNumber(application.absences) ? application.absences : '-'}}</td> <!-- only for soidu --> <td md-cell ng-if=\"submittedType === 'STIPTOETUS_SOIDU'\">{{application.compensationReason ? currentLanguageNameField(application.compensationReason) : '-'}}</td> <td md-cell ng-if=\"submittedType === 'STIPTOETUS_SOIDU'\">{{application.compensationFrequency ? currentLanguageNameField(application.compensationFrequency) : '-'}}</td> <td md-cell>{{application.isTeacherConfirm === null && application.needsConfirm ? ('stipend.needsConfirm' | translate) : application.isTeacherConfirm ? (\"main.confirm\" | translate) : application.needsConfirm ? (\"main.noConfirm\" | translate) : \"-\"}}</td> <td md-cell>{{application.hasDirective ? ('main.yes' | translate) : ('main.no' | translate)}}</td> <td md-cell> <a ng-href=\"#/scholarships/decision/{{scholarshipType}}/{{application.decisionId}}\">{{application.decisionDecided | hoisDate}}</a> </td> <td md-cell>{{currentLanguageNameField(application.status)}} <md-tooltip ng-if=\"['STIPTOETUS_STAATUS_L', 'STIPTOETUS_STAATUS_T'].indexOf(application.status.code) !== -1  && application.rejectComment\">{{application.rejectComment}}</md-tooltip> </td> </tr> </tbody> </table> </md-table-container>"),a.put("scholarship/templates/scholarship.applications.scholarships.html",'<md-table-container> <table md-table class="secondary-table" ng-if="submittedType"> <thead md-head> <tr md-row> <th md-column ng-if="applicationsTable.showSelect"> <md-input-container> <md-checkbox ng-model="selectAllApplications" aria-label="mySchool" ng-change="updateAllApplicationCheckBoxes(selectAllApplications)"> </md-checkbox> </md-input-container> </th> <th md-column>{{\'stipend.nr\' | translate}}</th> <th md-column>{{\'stipend.type\' | translate}}</th> <th md-column>{{\'stipend.scholarshipName\' | translate}}</th> <th md-column>{{\'stipend.curriculum\' | translate}}</th> <th md-column>{{\'stipend.applicant\' | translate}}</th> <th md-column>{{\'stipend.student.idCode\' | translate}}</th> <th md-column>{{\'stipend.student.averageMark\' | translate}}</th> <th md-column>{{\'stipend.student.lastPeriodMark\' | translate}}</th> <th md-column>{{\'stipend.student.credits\' | translate}}</th> <th md-column>{{\'stipend.hasDirective\' | translate}}</th> <th md-column>{{\'stipend.decision.label\' | translate}}</th> <th md-column>{{\'stipend.student.status\' | translate}}</th> <th md-column>&nbsp;</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="application in applications" ng-class-odd="\'odd\'" ng-class-even="\'even\'" ng-class="{\'scholarship-bottom-border\': $index + 1 === allowedCount}"> <td md-cell ng-if="applicationsTable.showSelect"> <md-input-container> <md-checkbox ng-model="selected[application.id]" aria-label="mySchool"> </md-checkbox> </md-input-container> </td> <td md-cell>{{$index + 1}}</td> <td md-cell>{{currentLanguageNameField(application.type)}}</td> <td md-cell> <a href="#/scholarships/applications/{{application.id}}">{{application.termNameEt}}</a> </td> <td md-cell>{{application.curriculumCode ? application.curriculumCode : \'-\'}}</td> <td md-cell class="one-row"> <div layout="row" layout-align="start center" flex> <a href="#/students/{{application.studentId}}/main" ng-style="application.nonCompliant ? {color: \'red\'} : {}"> {{application.studentName ? application.studentName : \'-\'}} </a> <md-button ng-if="application.nonCompliant && !application.hasDirective" flex class="md-icon-button" ng-click="scholarshipTermCompliances(application)"> <md-icon md-colors="{color: \'default-warn\'}" md-font-set="material-icons">warning</md-icon> </md-button> </div> </td> <td md-cell>{{application.idcode ? application.idcode : \'-\'}}</td> <td md-cell> {{isNumber(application.saisPoints) ? application.saisPoints : application.averageMark ? application.averageMark : \'-\'}} <span class="scholarship-sais" ng-show="isNumber(application.saisPoints)"> S</span> </td> <td md-cell>{{application.lastPeriodMark ? application.lastPeriodMark : \'-\'}}</td> <td md-cell>{{isNumber(application.credits) ? application.credits : \'-\'}}</td> <td md-cell>{{application.hasDirective ? (\'main.yes\' | translate) : (\'main.no\' | translate)}}</td> <td md-cell> <a ng-href="#/scholarships/decision/{{scholarshipType}}/{{application.decisionId}}">{{application.decisionDecided | hoisDate}}</a> </td> <td md-cell>{{currentLanguageNameField(application.status)}} <md-tooltip ng-if="[\'STIPTOETUS_STAATUS_L\', \'STIPTOETUS_STAATUS_T\'].indexOf(application.status.code) !== -1  && application.rejectComment">{{application.rejectComment}}</md-tooltip> </td> <td md-cell>&nbsp;</td> </tr> </tbody> </table> </md-table-container>'),a.put("scholarship/templates/scholarship.term.compliance.dialog.html",'<md-dialog aria-label="scholarship term compliance dialog" flex="50" flex-xs="100" ng-cloak> <form name="dialogForm" novalidate ng-cloak> <md-toolbar class="md-warn"> <div class="md-toolbar-tools"> <h2>{{\'stipend.messages.error.studentDoesntComply\' | translate}}</h2> <span flex></span> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <div class="md-dialog-content"> <div class="form-readonly"> <div layout="row" flex> <md-input-container flex> <label class="textInput">{{formState.typeIsScholarship ? \'stipend.scholarshipType\' : \'stipend.grantType\' | translate}}</label> <hois-classifier-value ng-model="stipend.type" main-classifier-code="STIPTOETUS"></hois-classifier-value> </md-input-container> </div> <div layout="row" flex> <md-input-container flex> <label class="textInput">{{formState.typeIsScholarship ? \'stipend.scholarshipName\' : \'stipend.grantName\' | translate}}</label> <hois-value value="stipend.nameEt"></hois-value> </md-input-container> </div> </div> <div flex ng-include="\'scholarship/templates/scholarship.term.compliance.list.html\'" ng-init="termCompliance = stipend.termCompliance"></div> </div> </md-dialog-content> <md-dialog-actions layout="row" layout-align="start center"> <md-button class="md-raised" ng-click="cancel()">{{\'main.button.close\' | translate}}</md-button> </md-dialog-actions> </form> </md-dialog>'),a.put("scholarship/templates/scholarship.term.compliance.list.html","<ul> <li ng-if=\"termCompliance.onAcademicLeave\">{{'stipend.termCompliances.onAcademicLeave' | translate}}</li> <li ng-if=\"termCompliance.studentGroup\">{{'stipend.termCompliances.noStudentGroup' | translate}}</li> <li ng-if=\"termCompliance.isCourse && !termCompliance.studentGroup\">{{'stipend.termCompliances.invalidCourse' | translate}}</li> <li ng-if=\"termCompliance.academicLeaveDirectives\">{{'stipend.termCompliances.existsAcademicLeaveDirective' | translate}}</li> <li ng-if=\"termCompliance.exmatriculationDirectives\">{{'stipend.termCompliances.existsExmatriculationDirective' | translate}}</li> <li ng-if=\"termCompliance.isStudyLoad\">{{'stipend.termCompliances.invalidStudyLoad' | translate}}</li> <li ng-if=\"termCompliance.isStudyForm\">{{'stipend.termCompliances.invalidStudyForm' | translate}}</li> <li ng-if=\"termCompliance.isCurriculum\">{{'stipend.termCompliances.invalidCurriculum' | translate}}</li> <li ng-if=\"termCompliance.isStudyStartPeriod\">{{'stipend.termCompliances.invalidStudyStartPeriod' | translate}}</li> <li ng-if=\"termCompliance.isNominalStudyEnd\">{{'stipend.termCompliances.invalidNominalStudyEnd' | translate}}</li> <li ng-if=\"termCompliance.studyBacklog\">{{'stipend.termCompliances.existsStudyBacklog' | translate}}</li> <li ng-if=\"termCompliance.averageMark\">{{'stipend.termCompliances.invalidAverageMark' | translate}}</li> <li ng-if=\"termCompliance.isLastPeriodMark\">{{'stipend.termCompliances.invalidLastPeriodMark' | translate}}</li> <li ng-if=\"termCompliance.isCurriculumCompletion\">{{'stipend.termCompliances.invalidCurriculumCompletion' | translate}}</li> <li ng-if=\"termCompliance.isAbsences\">{{'stipend.termCompliances.invalidAbsences' | translate}}</li> </ul>"),a.put("scholarship/templates/scholarship.term.dialog.html",'<md-dialog aria-label="scholarship term compliance dialog" flex="50" flex-xs="100" ng-cloak> <form name="dialogForm" novalidate ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2>{{stipend.nameEt}}</h2> <span flex></span> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content class="fixed-border-size"> <div class="md-dialog-content"> <div class="form-readonly"> <div layout="row" flex> <md-input-container flex> <label class="textInput">{{formState.typeIsScholarship ? \'stipend.scholarshipType\' : \'stipend.grantType\' | translate}}</label> <hois-classifier-value ng-model="stipend.type" main-classifier-code="STIPTOETUS"></hois-classifier-value> </md-input-container> </div> <div ng-if="stipend.studyStartPeriodStart || stipend.studyStartPeriodEnd" layout="row"> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100"> <label>{{\'stipend.studyPeriodDates\' | translate}}</label> <input type="hidden"> </md-input-container> <md-input-container flex="35" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'main.from\' | translate}}</label> <hois-value value="stipend.studyStartPeriodStart | hoisDate"></hois-value> </md-input-container> <md-input-container flex="35" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'main.thru\' | translate}}</label> <hois-value value="stipend.studyStartPeriodEnd | hoisDate"></hois-value> </md-input-container> </div> <div ng-if="stipend.paymentStart || stipend.paymentEnd" layout="row"> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100"> <label>{{\'stipend.paymentPeriod\' | translate}}</label> <input type="hidden"> </md-input-container> <md-input-container flex="35" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'main.from\' | translate}}</label> <hois-value value="stipend.paymentStart | hoisDate"></hois-value> </md-input-container> <md-input-container flex="35" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'main.thru\' | translate}}</label> <hois-value value="stipend.paymentEnd | hoisDate"></hois-value> </md-input-container> </div> <div ng-if="stipend.studyForms && stipend.studyForms.length > 0" layout="row" flex> <md-input-container flex> <label class="textInput">{{\'stipend.studyForm\' | translate}}</label> <hois-classifier-value ng-model="stipend.studyForms" main-classifier-code="OPPEVORM" multiple></hois-classifier-value> </md-input-container> </div> <div ng-if="stipend.courses" layout="row" flex> <md-input-container flex> <label class="textInput">{{\'stipend.courses\' | translate}}</label> <hois-classifier-value ng-model="stipend.courses" main-classifier-code="KURSUS" multiple></hois-classifier-value> </md-input-container> </div> <div ng-if="stipend.averageMark" layout="row" flex> <md-input-container flex> <label class="textInput">{{\'stipend.averageMark\' | translate}}</label> <hois-value value="stipend.averageMark"></hois-value> </md-input-container> </div> <div ng-if="stipend.lastPeriodMark" layout="row" flex> <md-input-container flex> <label class="textInput">{{\'stipend.lastPeriodMark\' | translate}}</label> <hois-value value="stipend.lastPeriodMark"></hois-value> </md-input-container> </div> <div ng-if="stipend.curriculumCompletion" layout="row" flex> <md-input-container flex> <label class="textInput">{{\'stipend.curriculumCompletion\' | translate}}</label> <hois-value value="stipend.curriculumCompletion"></hois-value> </md-input-container> </div> <div ng-if="stipend.maxAbsences" layout="row" flex> <md-input-container flex> <label>{{\'stipend.maxAbsences\' | translate}}</label> <hois-value value="application.maxAbsences"></hois-value> </md-input-container> </div> <div ng-if="stipend.type.code !== \'STIPTOETUS_SOIDU\'" layout="row"> <md-checkbox ng-model="stipend.isStudyBacklog" disabled aria-label="is study backlog"> {{\'stipend.isStudyBacklog\' | translate}} </md-checkbox> </div> </div> </div> </md-dialog-content> <md-dialog-actions layout="row" layout-align="start center"> <md-button class="md-raised" ng-click="cancel()">{{\'main.button.close\' | translate}}</md-button> </md-dialog-actions> </form> </md-dialog>'),a.put("scholarship/term/scholarship.doktor.edit.html",'<div layout="row" flex> <md-input-container flex> <label class="textInput">{{\'stipend.grantName\' | translate}}</label> <input type="text" ng-model="stipend.nameEt" name="nameEt" required md-maxlength="500"> </md-input-container> </div> <div layout="row" flex> <md-input-container flex> <label class="textInput">{{\'stipend.studyPeriod\' | translate}}</label> <hois-select required ng-model="stipend.studyPeriod" type="studyperiodyear" sorted-query="true" preselect-current></hois-select> </md-input-container> </div> <div layout="row"> <div flex="20" flex-md="100" flex-sm="100" flex-xs="100"> <label class="date-period-label">{{\'stipend.applicationPeriod\' | translate}} *</label> </div> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <md-datepicker required ng-model="stipend.applicationStart" md-max-date="stipend.applicationEnd" md-placeholder="{{\'main.from\' | translate}}" ng-change="applicationEndChanged()"></md-datepicker> </md-input-container> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <md-datepicker required ng-model="stipend.applicationEnd" md-min-date="stipend.applicationStart" md-placeholder="{{\'main.thru\' | translate}}"></md-datepicker> </md-input-container> </div> <div layout="row"> <div flex="20" flex-md="100" flex-sm="100" flex-xs="100"> <label class="date-period-label">{{\'stipend.paymentPeriod\' | translate}} *</label> </div> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <md-datepicker required ng-model="stipend.paymentStart" md-max-date="stipend.paymentEnd" md-placeholder="{{\'main.from\' | translate}}"></md-datepicker> </md-input-container> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <md-datepicker required ng-model="stipend.paymentEnd" md-min-date="stipend.paymentStart" md-placeholder="{{\'main.thru\' | translate}}"></md-datepicker> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="45"> <label>{{\'stipend.places\' | translate}}</label> <input ng-model="stipend.places" type="number" autofocus aria-label="places" min="0" max="99999"> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label>{{\'stipend.amountPaid\' | translate}}</label> <input required ng-model="stipend.amountPaid" type="number" autofocus aria-label="amountPaid" min="0" max="9999"> </md-input-container> </div> <div> <div layout="row" flex="100"> <hois-autocomplete flex ng-model="formState.curriculum" method="curriculums" label="stipend.curriculums" ng-required="missingCurriculums" additional-query-params="{higher: true, closed: false, studyLevel: \'HARIDUSTASE_D\'}"></hois-autocomplete> <md-button ng-click="addAllCurriculums({higher: true, closed: false, studyLevel: \'HARIDUSTASE_D\'})" class="md-raised">{{\'stipend.addAllCurriculums\' | translate}}</md-button> </div> <div layout="column" class="common-label" flex="95" ng-repeat="curriculum in stipend.curriculums | orderBy: [\'curriculum.\' + currentLanguageNameField(), \'code\']"> <div layout="row" flex layout-align="start center"> <div flex="5">&nbsp;</div> <div flex="50">{{curriculum.nameEt}}</div> <div> <a ng-click="deleteCurriculum(curriculum)" class="remove">&times;</a> </div> </div> </div> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.studyLoad\' | translate}}</label> <hois-classifier-select required ng-model="stipend.studyLoads" name="type" model-value-attr="code" main-classifier-code="OPPEKOORMUS" criteria="{higher: true}" multiple></hois-classifier-select> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label class="textInput">{{\'stipend.courses\' | translate}}</label> <hois-classifier-select required ng-model="stipend.courses" name="type" model-value-attr="code" main-classifier-code="KURSUS" multiple></hois-classifier-select> </md-input-container> </div> <div layout="row"> <div flex="20" flex-md="100" flex-sm="100" flex-xs="100"> <label class="date-period-label">{{\'stipend.studyPeriodDates\' | translate}}</label> </div> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <md-datepicker ng-model="stipend.studyStartPeriodStart" md-max-date="stipend.studyStartPeriodEnd" md-placeholder="{{\'main.from\' | translate}}"></md-datepicker> </md-input-container> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <md-datepicker ng-model="stipend.studyStartPeriodEnd" md-min-date="stipend.studyStartPeriodStart" md-placeholder="{{\'main.thru\' | translate}}"></md-datepicker> </md-input-container> </div> </div> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.committee\' | translate}}</label> <hois-select ng-model="stipend.committee" values="formState.committees"></hois-select> </md-input-container> </div> <div layout="row"> <md-button class="md-raised md-primary" ng-click="update()">{{\'main.button.save\' | translate}}</md-button> <md-button class="md-raised" ng-if="!stipend.isOpen && stipend.id" ng-click="publish()">{{\'main.button.publishtoStudents\' | translate}}</md-button> <md-button class="md-raised" ng-if="stipend.id && !stipend.isOpen" ng-click="delete()">{{\'main.button.delete\' | translate}}</md-button> <md-button class="md-raised" ng-click="back(\'#/scholarships/grants\', stipendForm)">{{\'main.button.back\' | translate}}</md-button> </div>'),a.put("scholarship/term/scholarship.doktor.view.html",'<div class="ois-form-layout-padding" ng-cloak> <div flex> <form name="stipendForm"> <div class="form-readonly"> <div layout="row" flex> <md-input-container flex> <label class="textInput">{{formState.typeIsScholarship ? \'stipend.scholarshipType\' : \'stipend.grantType\' | translate}}</label> <hois-classifier-value ng-model="stipend.type" main-classifier-code="STIPTOETUS"></hois-classifier-value> </md-input-container> </div> <div layout="row" flex> <md-input-container flex> <label class="textInput">{{formState.typeIsScholarship ? \'stipend.scholarshipName\' : \'stipend.grantName\' | translate}}</label> <hois-value value="stipend.nameEt"></hois-value> </md-input-container> </div> <div layout="row" flex> <md-input-container flex> <label class="textInput">{{\'stipend.studyPeriod\' | translate}}</label> <hois-value value="formState.readonlyStudyPeriod | hoisStudyPeriod"></hois-value> </md-input-container> </div> <div layout="row"> <div flex="20" flex-md="100" flex-sm="100" flex-xs="100"> <label class="date-period-label">{{\'stipend.applicationPeriod\' | translate}} *</label> </div> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'main.from\' | translate}}</label> <hois-value value="stipend.applicationStart | hoisDate"></hois-value> </md-input-container> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'main.thru\' | translate}}</label> <hois-value value="stipend.applicationEnd | hoisDate"></hois-value> </md-input-container> </div> <div layout="row"> <div flex="20" flex-md="100" flex-sm="100" flex-xs="100"> <label class="date-period-label">{{\'stipend.paymentPeriod\' | translate}} *</label> </div> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'main.from\' | translate}}</label> <hois-value value="stipend.paymentStart | hoisDate"></hois-value> </md-input-container> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'main.thru\' | translate}}</label> <hois-value value="stipend.paymentEnd | hoisDate"></hois-value> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="45"> <label>{{\'stipend.places\' | translate}}</label> <hois-value value="stipend.places"></hois-value> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label>{{\'stipend.amountPaid\' | translate}}</label> <hois-value value="stipend.amountPaid"></hois-value> </md-input-container> </div> <div> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'stipend.curriculums\' | translate}}</legend> <md-table-container> <table md-table class="secondary-table"> <tbody md-body> <tr md-row ng-repeat="curriculum in stipend.curriculums | orderBy: [\'curriculum.\' + currentLanguageNameField(), \'code\']" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{currentLanguageNameField(curriculum)}}</td> </tr> </tbody> </table> </md-table-container> </fieldset> <div>&nbsp;</div> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.studyLoad\' | translate}}</label> <hois-classifier-value ng-model="stipend.studyLoads" main-classifier-code="OPPEKOORMUS" multiple></hois-classifier-value> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label class="textInput">{{\'stipend.courses\' | translate}}</label> <hois-classifier-value ng-model="stipend.courses" main-classifier-code="KURSUS" multiple></hois-classifier-value> </md-input-container> </div> <div layout="row"> <div flex="20" flex-md="100" flex-sm="100" flex-xs="100"> <label class="date-period-label">{{\'stipend.studyPeriodDates\' | translate}} *</label> </div> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'main.from\' | translate}}</label> <hois-value value="stipend.studyStartPeriodStart | hoisDate"></hois-value> </md-input-container> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'main.thru\' | translate}}</label> <hois-value value="stipend.studyStartPeriodEnd | hoisDate"></hois-value> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="45"> <label>{{\'stipend.committee\' | translate}}</label> <hois-value value="currentLanguageNameField(formState.committee)"></hois-value> </md-input-container> </div> <div layout="row"> <div layout="row"> <md-button class="md-raised md-primary" ng-if="canEdit" ng-click="changeStipend(stipend)">{{\'main.button.edit\' | translate}}</md-button> <md-button class="md-raised" ng-if="!stipend.isOpen && stipend.id && canEdit" ng-click="publish()">{{\'main.button.publishtoStudents\' | translate}}</md-button> <md-button class="md-raised" ng-click="back(\'#/scholarships/\', stipendForm)">{{\'main.button.back\' | translate}}</md-button> </div> </div> </div> </div> </form> </div> </div>'),a.put("scholarship/term/scholarship.eri.edit.html",'<div layout="row" flex> <md-input-container flex> <label class="textInput">{{\'stipend.grantName\' | translate}}</label> <input type="text" ng-model="stipend.nameEt" name="nameEt" required md-maxlength="500"> </md-input-container> </div> <div layout="row" flex> <md-input-container flex> <label class="textInput">{{\'stipend.studyPeriod\' | translate}}</label> <hois-select required ng-model="stipend.studyPeriod" type="studyperiodyear" sorted-query="true" preselect-current></hois-select> </md-input-container> </div> <div layout="row"> <div flex="20" flex-md="100" flex-sm="100" flex-xs="100"> <label class="date-period-label">{{\'stipend.applicationPeriod\' | translate}}</label> </div> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <md-datepicker ng-model="stipend.applicationStart" md-max-date="stipend.applicationEnd" md-placeholder="{{\'main.from\' | translate}}"></md-datepicker> </md-input-container> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <md-datepicker ng-model="stipend.applicationEnd" md-min-date="stipend.applicationStart" md-placeholder="{{\'main.thru\' | translate}}" ng-change="applicationEndChanged()"></md-datepicker> </md-input-container> </div> <div layout="row"> <div flex="20" flex-md="100" flex-sm="100" flex-xs="100"> <label class="date-period-label">{{\'stipend.paymentPeriod\' | translate}}</label> </div> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <md-datepicker ng-model="stipend.paymentStart" md-max-date="stipend.paymentEnd" md-placeholder="{{\'main.from\' | translate}}"></md-datepicker> </md-input-container> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <md-datepicker ng-model="stipend.paymentEnd" md-min-date="stipend.paymentStart" md-placeholder="{{\'main.thru\' | translate}}"></md-datepicker> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="45"> <label>{{\'stipend.places\' | translate}}</label> <input ng-model="stipend.places" type="number" autofocus aria-label="places" min="0" max="99999"> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label>{{\'stipend.amountPaid\' | translate}}</label> <input ng-model="stipend.amountPaid" type="number" autofocus aria-label="amountPaid" min="0" max="9999"> </md-input-container> </div> <div> <div layout="row" flex="100"> <hois-autocomplete flex ng-model="formState.curriculum" method="curriculums" label="stipend.curriculums" ng-required="missingCurriculums" additional-query-params="{higher: false, closed: false}"></hois-autocomplete> <md-button ng-click="addAllCurriculums({higher: false, closed: false})" class="md-raised">{{\'stipend.addAllCurriculums\' | translate}}</md-button> </div> <div layout="column" class="common-label" flex="95" ng-repeat="curriculum in stipend.curriculums | orderBy: [\'curriculum.\' + currentLanguageNameField(), \'code\']"> <div layout="row" flex layout-align="start center"> <div flex="5">&nbsp;</div> <div flex="50">{{curriculum.nameEt}}</div> <div> <a ng-click="deleteCurriculum(curriculum)" class="remove">&times;</a> </div> </div> </div> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.studyForm\' | translate}}</label> <hois-classifier-select ng-model="stipend.studyForms" name="type" model-value-attr="code" main-classifier-code="OPPEVORM" criteria="{vocational: true}" multiple></hois-classifier-select> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label class="textInput">{{\'stipend.courses\' | translate}}</label> <hois-classifier-select required ng-model="stipend.courses" name="type" model-value-attr="code" main-classifier-code="KURSUS" multiple></hois-classifier-select> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="100"> <label class="textInput">{{\'stipend.addInfoForStudent\' | translate}}</label> <textarea ng-model="stipend.addInfo" md-maxlength="4000" max-rows="10"></textarea> </md-input-container> </div> <div>&nbsp;</div> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'stipend.generalCriteria\' | translate}}</legend> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.averageMark\' | translate}}</label> <input ng-model="stipend.averageMark" type="number" autofocus aria-label="averageMark" min="0" max="5"> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label class="textInput">{{\'stipend.priority\' | translate}}</label> <hois-select ng-model="stipend.averageMarkPriority" values="formState.priorities | filter: averageMarkPriorityFilter" show-property="value" value-property="code"></hois-select> </md-input-container> </div> <h3>{{\'stipend.considerFollowing\' | translate}}</h3> <div layout="row" flex> <md-checkbox ng-model="stipend.isOutcomes" flex="50"> {{\'stipend.isOutcomes\' | translate}} </md-checkbox> <md-checkbox ng-model="stipend.isModuleGrade" flex="50"> {{\'stipend.isModuleGrade\' | translate}} </md-checkbox> </div> <div layout="row" flex> <md-checkbox ng-model="stipend.isPeriodGrade" flex="50"> {{\'stipend.isPeriodGrade\' | translate}} </md-checkbox> <md-checkbox ng-model="stipend.isApelGrade" flex="50"> {{\'stipend.isApelGrade\' | translate}} </md-checkbox> </div> <div layout="row" flex> <md-checkbox ng-model="stipend.isJournalFinalGrade" flex="50"> {{\'stipend.isJournalFinalGrade\' | translate}} </md-checkbox> <md-checkbox ng-model="stipend.isJournalGrade" flex="50"> {{\'stipend.isJournalGrade\' | translate}} </md-checkbox> </div> </fieldset> <div>&nbsp;</div> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'stipend.previousPeriodCriteria\' | translate}}</legend> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.lastPeriodMark\' | translate}}</label> <input ng-model="stipend.lastPeriodMark" type="number" autofocus aria-label="averageMark" min="0" max="5"> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label class="textInput">{{\'stipend.priority\' | translate}}</label> <hois-select ng-model="stipend.lastPeriodMarkPriority" values="formState.priorities | filter: lastPeriodMarkPriorityFilter" show-property="value" value-property="code"></hois-select> </md-input-container> </div> <h3>{{\'stipend.considerFollowing\' | translate}}</h3> <div layout="row" flex> <md-checkbox ng-model="stipend.isLastPeriodOutcomes" flex="50"> {{\'stipend.isOutcomes\' | translate}} </md-checkbox> <md-checkbox ng-model="stipend.isLastPeriodModuleGrade" flex="50"> {{\'stipend.isModuleGrade\' | translate}} </md-checkbox> </div> <div layout="row" flex> <md-checkbox ng-model="stipend.isLastPeriodPeriodGrade" flex="50"> {{\'stipend.isPeriodGrade\' | translate}} </md-checkbox> <md-checkbox ng-model="stipend.isLastPeriodApelGrade" flex="50"> {{\'stipend.isApelGrade\' | translate}} </md-checkbox> </div> <div layout="row" flex> <md-checkbox ng-model="stipend.isLastPeriodJournalFinalGrade" flex="50"> {{\'stipend.isJournalFinalGrade\' | translate}} </md-checkbox> <md-checkbox ng-model="stipend.isLastPeriodJournalGrade" flex="50"> {{\'stipend.isJournalGrade\' | translate}} </md-checkbox> </div> <div layout="row"> <div flex="20" flex-md="100" flex-sm="100" flex-xs="100"> <label class="date-period-label">{{\'stipend.lastPeriodGrade\' | translate}}</label> </div> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <md-datepicker ng-model="stipend.lastPeriodGradeFrom" md-max-date="stipend.lastPeriodGradeThru" md-placeholder="{{\'main.from\' | translate}}"></md-datepicker> </md-input-container> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <md-datepicker ng-model="stipend.lastPeriodGradeThru" md-min-date="stipend.lastPeriodGradeFrom" md-placeholder="{{\'main.thru\' | translate}}"></md-datepicker> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.curriculumCompletion\' | translate}}</label> <input ng-model="stipend.curriculumCompletion" type="number" autofocus aria-label="curriculumCompletion" min="0"> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label class="textInput">{{\'stipend.priority\' | translate}}</label> <hois-select ng-model="stipend.curriculumCompletionPriority" values="formState.priorities | filter: curriculumCompletionPriorityFilter" show-property="value" value-property="code"></hois-select> </md-input-container> </div> <div layout="row" flex> <md-checkbox ng-model="stipend.isStudyBacklog" aria-label="Is study backlog" flex="50"> {{\'stipend.isStudyBacklog\' | translate}} </md-checkbox> </div> </fieldset> <div>&nbsp;</div> <div layout="row"> <div flex="20" flex-md="100" flex-sm="100" flex-xs="100"> <label class="date-period-label">{{\'stipend.studyPeriodDates\' | translate}}</label> </div> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <md-datepicker ng-model="stipend.studyStartPeriodStart" md-max-date="stipend.studyStartPeriodEnd" md-placeholder="{{\'main.from\' | translate}}"></md-datepicker> </md-input-container> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <md-datepicker ng-model="stipend.studyStartPeriodEnd" md-min-date="stipend.studyStartPeriodStart" md-placeholder="{{\'main.thru\' | translate}}"></md-datepicker> </md-input-container> </div> <div layout="row" flex> <md-checkbox ng-model="stipend.isTeacherConfirm" aria-label="Is teache confirm" flex="50"> {{\'stipend.isTeacherConfirm\' | translate}} </md-checkbox> </div> <div layout="row"> <md-checkbox ng-model="stipend.isFamilyIncomes" aria-label="Is family incomes" flex="50"> {{\'stipend.isFamilyIncomes\' | translate}} </md-checkbox> </div> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.committee\' | translate}}</label> <hois-select ng-model="stipend.committee" values="formState.committees"></hois-select> </md-input-container> </div> </div> <div layout="row"> <md-button class="md-raised md-primary" ng-click="update()">{{\'main.button.save\' | translate}}</md-button> <md-button class="md-raised" ng-if="!stipend.isOpen && stipend.id" ng-click="publish()">{{\'main.button.publishtoStudents\' | translate}}</md-button> <md-button class="md-raised" ng-if="stipend.id && !stipend.isOpen" ng-click="delete()">{{\'main.button.delete\' | translate}}</md-button> <md-button class="md-raised" ng-click="back(\'#/scholarships/grants\', stipendForm)">{{\'main.button.back\' | translate}}</md-button> </div>'),
a.put("scholarship/term/scholarship.eri.view.html",'<div class="ois-form-layout-padding" ng-cloak> <div flex> <form name="stipendForm"> <div class="form-readonly"> <div layout="row" flex> <md-input-container flex> <label class="textInput">{{formState.typeIsScholarship ? \'stipend.scholarshipType\' : \'stipend.grantType\' | translate}}</label> <hois-classifier-value ng-model="stipend.type" main-classifier-code="STIPTOETUS"></hois-classifier-value> </md-input-container> </div> <div layout="row" flex> <md-input-container flex> <label class="textInput">{{formState.typeIsScholarship ? \'stipend.scholarshipName\' : \'stipend.grantName\' | translate}}</label> <hois-value value="stipend.nameEt"></hois-value> </md-input-container> </div> <div layout="row" flex> <md-input-container flex> <label class="textInput">{{\'stipend.studyPeriod\' | translate}}</label> <hois-value value="formState.readonlyStudyPeriod | hoisStudyPeriod"></hois-value> </md-input-container> </div> <div layout="row"> <div flex="20" flex-md="100" flex-sm="100" flex-xs="100"> <label class="date-period-label">{{\'stipend.applicationPeriod\' | translate}}</label> </div> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'main.from\' | translate}}</label> <hois-value value="stipend.applicationStart | hoisDate"></hois-value> </md-input-container> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'main.thru\' | translate}}</label> <hois-value value="stipend.applicationEnd | hoisDate"></hois-value> </md-input-container> </div> <div layout="row"> <div flex="20" flex-md="100" flex-sm="100" flex-xs="100"> <label class="date-period-label">{{\'stipend.paymentPeriod\' | translate}}</label> </div> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'main.from\' | translate}}</label> <hois-value value="stipend.paymentStart | hoisDate"></hois-value> </md-input-container> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'main.thru\' | translate}}</label> <hois-value value="stipend.paymentEnd | hoisDate"></hois-value> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="45"> <label>{{\'stipend.places\' | translate}}</label> <hois-value value="stipend.places"></hois-value> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label>{{\'stipend.amountPaid\' | translate}}</label> <hois-value value="stipend.amountPaid"></hois-value> </md-input-container> </div> <div> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'stipend.curriculums\' | translate}}</legend> <md-table-container> <table md-table class="secondary-table"> <tbody md-body> <tr md-row ng-repeat="curriculum in stipend.curriculums | orderBy: [\'curriculum.\' + currentLanguageNameField(), \'code\']" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{currentLanguageNameField(curriculum)}}</td> </tr> </tbody> </table> </md-table-container> </fieldset> <div>&nbsp;</div> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.studyForm\' | translate}}</label> <hois-classifier-value ng-model="stipend.studyForms" main-classifier-code="OPPEVORM" multiple></hois-classifier-value> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label class="textInput">{{\'stipend.courses\' | translate}}</label> <hois-classifier-value ng-model="stipend.courses" main-classifier-code="KURSUS" multiple></hois-classifier-value> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="100"> <label class="textInput">{{\'stipend.addInfoForStudent\' | translate}}</label> <hois-value value="stipend.addInfo"></hois-value> </md-input-container> </div> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'stipend.generalCriteria\' | translate}}</legend> <div>&nbsp;</div> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.averageMark\' | translate}}</label> <hois-value value="stipend.averageMark"></hois-value> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label class="textInput">{{\'stipend.priority\' | translate}}</label> <hois-classifier-value ng-model="stipend.averageMarkPriority" main-classifier-code="PRIORITEET"></hois-classifier-value> </md-input-container> </div> <h3>{{\'stipend.considerFollowing\' | translate}}</h3> <div layout="row" flex> <md-checkbox ng-model="stipend.isOutcomes" disabled flex="50"> {{\'stipend.isOutcomes\' | translate}} </md-checkbox> <md-checkbox ng-model="stipend.isModuleGrade" disabled flex="50"> {{\'stipend.isModuleGrade\' | translate}} </md-checkbox> </div> <div layout="row" flex> <md-checkbox ng-model="stipend.isPeriodGrade" disabled flex="50"> {{\'stipend.isPeriodGrade\' | translate}} </md-checkbox> <md-checkbox ng-model="stipend.isApelGrade" disabled flex="50"> {{\'stipend.isApelGrade\' | translate}} </md-checkbox> </div> <div layout="row" flex> <md-checkbox ng-model="stipend.isJournalFinalGrade" disabled flex="50"> {{\'stipend.isJournalFinalGrade\' | translate}} </md-checkbox> <md-checkbox ng-model="stipend.isJournalGrade" disabled flex="50"> {{\'stipend.isJournalGrade\' | translate}} </md-checkbox> </div> </fieldset> <div>&nbsp;</div> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'stipend.previousPeriodCriteria\' | translate}}</legend> <div>&nbsp;</div> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.lastPeriodMark\' | translate}}</label> <hois-value value="stipend.lastPeriodMark"></hois-value> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label class="textInput">{{\'stipend.priority\' | translate}}</label> <hois-classifier-value ng-model="stipend.lastPeriodMarkPriority" main-classifier-code="PRIORITEET"></hois-classifier-value> </md-input-container> </div> <h3>{{\'stipend.considerFollowing\' | translate}}</h3> <div layout="row" flex> <md-checkbox ng-model="stipend.isLastPeriodOutcomes" disabled flex="50"> {{\'stipend.isOutcomes\' | translate}} </md-checkbox> <md-checkbox ng-model="stipend.isLastPeriodModuleGrade" disabled flex="50"> {{\'stipend.isModuleGrade\' | translate}} </md-checkbox> </div> <div layout="row" flex> <md-checkbox ng-model="stipend.isLastPeriodPeriodGrade" disabled flex="50"> {{\'stipend.isPeriodGrade\' | translate}} </md-checkbox> <md-checkbox ng-model="stipend.isLastPeriodApelGrade" disabled flex="50"> {{\'stipend.isApelGrade\' | translate}} </md-checkbox> </div> <div layout="row" flex> <md-checkbox ng-model="stipend.isLastPeriodJournalFinalGrade" disabled flex="50"> {{\'stipend.isJournalFinalGrade\' | translate}} </md-checkbox> <md-checkbox ng-model="stipend.isLastPeriodJournalGrade" disabled flex="50"> {{\'stipend.isJournalGrade\' | translate}} </md-checkbox> </div> <div>&nbsp;</div> <div layout="row"> <div flex="20" flex-md="100" flex-sm="100" flex-xs="100"> <label class="date-period-label">{{\'stipend.lastPeriodGrade\' | translate}}</label> </div> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'main.from\' | translate}}</label> <hois-value value="stipend.lastPeriodGradeFrom | hoisDate"></hois-value> </md-input-container> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'main.thru\' | translate}}</label> <hois-value value="stipend.lastPeriodGradeThru | hoisDate"></hois-value> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.curriculumCompletion\' | translate}}</label> <hois-value value="stipend.curriculumCompletion"></hois-value> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label class="textInput">{{\'stipend.priority\' | translate}}</label> <hois-classifier-value ng-model="stipend.curriculumCompletionPriority" main-classifier-code="PRIORITEET"></hois-classifier-value> </md-input-container> </div> <div layout="row"> <md-checkbox ng-model="stipend.isStudyBacklog" disabled aria-label="Is academic leave"> {{\'stipend.isStudyBacklog\' | translate}} </md-checkbox> </div> </fieldset> <div>&nbsp;</div> <div>&nbsp;</div> <div layout="row"> <div flex="20" flex-md="100" flex-sm="100" flex-xs="100"> <label class="date-period-label">{{\'stipend.studyPeriodDates\' | translate}}</label> </div> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'main.from\' | translate}}</label> <hois-value value="stipend.studyStartPeriodStart | hoisDate"></hois-value> </md-input-container> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'main.thru\' | translate}}</label> <hois-value value="stipend.studyStartPeriodEnd | hoisDate"></hois-value> </md-input-container> </div> <div layout="row"> <md-checkbox ng-model="stipend.isTeacherConfirm" disabled aria-label="Is academic leave"> {{\'stipend.isTeacherConfirm\' | translate}} </md-checkbox> </div> <div layout="row"> <md-checkbox ng-model="stipend.isFamilyIncomes" disabled aria-label="Is family incomes"> {{\'stipend.isFamilyIncomes\' | translate}} </md-checkbox> </div> <div layout="row" flex> <md-input-container flex="45"> <label>{{\'stipend.committee\' | translate}}</label> <hois-value value="currentLanguageNameField(formState.committee)"></hois-value> </md-input-container> </div> <div layout="row"> <div layout="row"> <md-button class="md-raised md-primary" ng-if="canEdit" ng-click="changeStipend(stipend)">{{\'main.button.edit\' | translate}}</md-button> <md-button class="md-raised" ng-if="!stipend.isOpen && stipend.id && canEdit" ng-click="publish()">{{\'main.button.publishtoStudents\' | translate}}</md-button> <md-button class="md-raised" ng-click="back(\'#/scholarships/\', stipendForm)">{{\'main.button.back\' | translate}}</md-button> </div> </div> </div> </div> </form> </div> </div>'),a.put("scholarship/term/scholarship.pohi.edit.html",'<div layout="row" flex> <md-input-container flex> <label class="textInput">{{\'stipend.grantName\' | translate}}</label> <input type="text" ng-model="stipend.nameEt" name="nameEt" required md-maxlength="255"> </md-input-container> </div> <div layout="row" flex> <md-input-container flex> <label class="textInput">{{\'stipend.studyPeriod\' | translate}}</label> <hois-select required ng-model="stipend.studyPeriod" type="studyperiodyear" sorted-query="true" preselect-current></hois-select> </md-input-container> </div> <div layout="row"> <div flex="20" flex-md="100" flex-sm="100" flex-xs="100"> <label class="date-period-label">{{\'stipend.applicationPeriod\' | translate}} *</label> </div> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <md-datepicker required ng-model="stipend.applicationStart" md-max-date="stipend.applicationEnd" md-placeholder="{{\'main.from\' | translate}}"></md-datepicker> </md-input-container> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <md-datepicker required ng-model="stipend.applicationEnd" md-min-date="stipend.applicationStart" md-placeholder="{{\'main.thru\' | translate}}" ng-change="applicationEndChanged()"></md-datepicker> </md-input-container> </div> <div layout="row"> <div flex="20" flex-md="100" flex-sm="100" flex-xs="100"> <label class="date-period-label">{{\'stipend.paymentPeriod\' | translate}} *</label> </div> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <md-datepicker required ng-model="stipend.paymentStart" md-max-date="stipend.paymentEnd" md-placeholder="{{\'main.from\' | translate}}"></md-datepicker> </md-input-container> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <md-datepicker required ng-model="stipend.paymentEnd" md-min-date="stipend.paymentStart" md-placeholder="{{\'main.thru\' | translate}}"></md-datepicker> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="45"> <label>{{\'stipend.places\' | translate}}</label> <input ng-model="stipend.places" type="number" autofocus aria-label="places" min="0" max="32767"> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label>{{\'stipend.amountPaid\' | translate}}</label> <input required ng-model="stipend.amountPaid" type="number" autofocus aria-label="amountPaid" min="0" max="9999"> </md-input-container> </div> <div> <div layout="row" flex="100"> <hois-autocomplete flex ng-model="formState.curriculum" method="curriculums" label="stipend.curriculums" ng-required="missingCurriculums" additional-query-params="{higher: false, closed: false}"></hois-autocomplete> <md-button ng-click="addAllCurriculums({higher: false, closed: false})" class="md-raised">{{\'stipend.addAllCurriculums\' | translate}}</md-button> </div> <div layout="column" class="common-label" flex="95" ng-repeat="curriculum in stipend.curriculums | orderBy: [\'curriculum.\' + currentLanguageNameField(), \'code\']"> <div layout="row" flex layout-align="start center"> <div flex="5">&nbsp;</div> <div flex="50">{{curriculum.nameEt}}</div> <div> <a ng-click="deleteCurriculum(curriculum)" class="remove">&times;</a> </div> </div> </div> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.studyForm\' | translate}}</label> <hois-classifier-select required ng-model="stipend.studyForms" name="type" model-value-attr="code" main-classifier-code="OPPEVORM" multiple filter-values="filteredStudyForm" criteria="{vocational: true}"></hois-classifier-select> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label class="textInput">{{\'stipend.courses\' | translate}}</label> <hois-classifier-select required ng-model="stipend.courses" name="type" model-value-attr="code" main-classifier-code="KURSUS" multiple></hois-classifier-select> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="100"> <label class="textInput">{{\'stipend.addInfoForStudent\' | translate}}</label> <textarea ng-model="stipend.addInfo" md-maxlength="4000" max-rows="10"></textarea> </md-input-container> </div> <div>&nbsp;</div> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'stipend.generalCriteria\' | translate}}</legend> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.averageMark\' | translate}}</label> <input ng-model="stipend.averageMark" type="number" autofocus aria-label="averageMark" min="0" max="5"> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label class="textInput">{{\'stipend.priority\' | translate}}</label> <hois-select ng-model="stipend.averageMarkPriority" values="formState.priorities | filter: averageMarkPriorityFilter" show-property="value" value-property="code"></hois-select> </md-input-container> </div> <h3>{{\'stipend.considerFollowing\' | translate}}</h3> <div layout="row" flex> <md-checkbox ng-model="stipend.isOutcomes" flex="50"> {{\'stipend.isOutcomes\' | translate}} </md-checkbox> <md-checkbox ng-model="stipend.isModuleGrade" flex="50"> {{\'stipend.isModuleGrade\' | translate}} </md-checkbox> </div> <div layout="row" flex> <md-checkbox ng-model="stipend.isPeriodGrade" flex="50"> {{\'stipend.isPeriodGrade\' | translate}} </md-checkbox> <md-checkbox ng-model="stipend.isApelGrade" flex="50"> {{\'stipend.isApelGrade\' | translate}} </md-checkbox> </div> <div layout="row" flex> <md-checkbox ng-model="stipend.isJournalFinalGrade" flex="50"> {{\'stipend.isJournalFinalGrade\' | translate}} </md-checkbox> <md-checkbox ng-model="stipend.isJournalGrade" flex="50"> {{\'stipend.isJournalGrade\' | translate}} </md-checkbox> </div> </fieldset> <div>&nbsp;</div> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'stipend.previousPeriodCriteria\' | translate}}</legend> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.lastPeriodMark\' | translate}}</label> <input ng-model="stipend.lastPeriodMark" type="number" autofocus aria-label="averageMark" min="0" max="5"> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label class="textInput">{{\'stipend.priority\' | translate}}</label> <hois-select ng-model="stipend.lastPeriodMarkPriority" values="formState.priorities | filter: lastPeriodMarkPriorityFilter" model-value-attr="code" show-property="value" value-property="code"></hois-select> </md-input-container> </div> <h3>{{\'stipend.considerFollowing\' | translate}}</h3> <div layout="row" flex> <md-checkbox ng-model="stipend.isLastPeriodOutcomes" flex="50"> {{\'stipend.isOutcomes\' | translate}} </md-checkbox> <md-checkbox ng-model="stipend.isLastPeriodModuleGrade" flex="50"> {{\'stipend.isModuleGrade\' | translate}} </md-checkbox> </div> <div layout="row" flex> <md-checkbox ng-model="stipend.isLastPeriodPeriodGrade" flex="50"> {{\'stipend.isPeriodGrade\' | translate}} </md-checkbox> <md-checkbox ng-model="stipend.isLastPeriodApelGrade" flex="50"> {{\'stipend.isApelGrade\' | translate}} </md-checkbox> </div> <div layout="row" flex> <md-checkbox ng-model="stipend.isLastPeriodJournalFinalGrade" flex="50"> {{\'stipend.isJournalFinalGrade\' | translate}} </md-checkbox> <md-checkbox ng-model="stipend.isLastPeriodJournalGrade" flex="50"> {{\'stipend.isJournalGrade\' | translate}} </md-checkbox> </div> <div layout="row"> <div flex="20" flex-md="100" flex-sm="100" flex-xs="100"> <label class="date-period-label">{{\'stipend.lastPeriodGrade\' | translate}}</label> </div> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <md-datepicker ng-model="stipend.lastPeriodGradeFrom" md-max-date="stipend.lastPeriodGradeThru" md-placeholder="{{\'main.from\' | translate}}"></md-datepicker> </md-input-container> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <md-datepicker ng-model="stipend.lastPeriodGradeThru" md-min-date="stipend.lastPeriodGradeFrom" md-placeholder="{{\'main.thru\' | translate}}"></md-datepicker> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.curriculumCompletion\' | translate}}</label> <input ng-model="stipend.curriculumCompletion" type="number" autofocus aria-label="curriculumCompletion" min="0" max="999"> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label class="textInput">{{\'stipend.priority\' | translate}}</label> <hois-select ng-model="stipend.curriculumCompletionPriority" values="formState.priorities | filter: curriculumCompletionPriorityFilter" model-value-attr="code" show-property="value" value-property="code"></hois-select> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.maxAbsences\' | translate}}</label> <input ng-model="stipend.maxAbsences" type="number" autofocus aria-label="curriculumCompletion" min="0" max="9999"> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label class="textInput">{{\'stipend.priority\' | translate}}</label> <hois-select ng-model="stipend.maxAbsencesPriority" values="formState.priorities | filter: maxAbsencesPriorityFilter" model-value-attr="code" show-property="value" value-property="code"></hois-select> </md-input-container> </div> <div layout="row" flex> <md-checkbox ng-model="stipend.isStudyBacklog" aria-label="Is study backlog" ng-disabled="display.isStudyBacklogRead" flex="50"> {{\'stipend.isStudyBacklog\' | translate}} </md-checkbox> </div> </fieldset> <div>&nbsp;</div> <div layout="row"> <div flex="20" flex-md="100" flex-sm="100" flex-xs="100"> <label class="date-period-label">{{\'stipend.studyPeriodDates\' | translate}}</label> </div> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <md-datepicker ng-model="stipend.studyStartPeriodStart" md-max-date="stipend.studyStartPeriodEnd" md-placeholder="{{\'main.from\' | translate}}"></md-datepicker> </md-input-container> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <md-datepicker ng-model="stipend.studyStartPeriodEnd" md-min-date="stipend.studyStartPeriodStart" md-placeholder="{{\'main.thru\' | translate}}"></md-datepicker> </md-input-container> </div> <div layout="row" flex> <md-checkbox ng-model="stipend.isTeacherConfirm" aria-label="Is teache confir" ng-disabled="display.isTeacherConfirmRead" flex="50"> {{\'stipend.isTeacherConfirm\' | translate}} </md-checkbox> </div> </div> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.committee\' | translate}}</label> <hois-select ng-model="stipend.committee" values="formState.committees"></hois-select> </md-input-container> </div> <div layout="row"> <md-button class="md-raised md-primary" ng-click="update()">{{\'main.button.save\' | translate}}</md-button> <md-button class="md-raised" ng-if="!stipend.isOpen && stipend.id" ng-click="publish()">{{\'main.button.publishtoStudents\' | translate}}</md-button> <md-button class="md-raised" ng-if="stipend.id && !stipend.isOpen" ng-click="delete()">{{\'main.button.delete\' | translate}}</md-button> <md-button class="md-raised" ng-click="back(\'#/scholarships/grants\', stipendForm)">{{\'main.button.back\' | translate}}</md-button> </div>'),a.put("scholarship/term/scholarship.pohi.view.html",'<div class="ois-form-layout-padding" ng-cloak> <div flex> <form name="stipendForm"> <div class="form-readonly"> <div layout="row" flex> <md-input-container flex> <label class="textInput">{{formState.typeIsScholarship ? \'stipend.scholarshipType\' : \'stipend.grantType\' | translate}}</label> <hois-classifier-value ng-model="stipend.type" main-classifier-code="STIPTOETUS"></hois-classifier-value> </md-input-container> </div> <div layout="row" flex> <md-input-container flex> <label class="textInput">{{formState.typeIsScholarship ? \'stipend.scholarshipName\' : \'stipend.grantName\' | translate}}</label> <hois-value value="stipend.nameEt"></hois-value> </md-input-container> </div> <div layout="row" flex> <md-input-container flex> <label class="textInput">{{\'stipend.studyPeriod\' | translate}}</label> <hois-value value="formState.readonlyStudyPeriod | hoisStudyPeriod"></hois-value> </md-input-container> </div> <div layout="row"> <div flex="20" flex-md="100" flex-sm="100" flex-xs="100"> <label class="date-period-label">{{\'stipend.applicationPeriod\' | translate}}</label> </div> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'main.from\' | translate}}</label> <hois-value value="stipend.applicationStart | hoisDate"></hois-value> </md-input-container> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'main.thru\' | translate}}</label> <hois-value value="stipend.applicationEnd | hoisDate"></hois-value> </md-input-container> </div> <div layout="row"> <div flex="20" flex-md="100" flex-sm="100" flex-xs="100"> <label class="date-period-label">{{\'stipend.paymentPeriod\' | translate}}</label> </div> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'main.from\' | translate}}</label> <hois-value value="stipend.paymentStart | hoisDate"></hois-value> </md-input-container> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'main.thru\' | translate}}</label> <hois-value value="stipend.paymentEnd | hoisDate"></hois-value> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="45"> <label>{{\'stipend.places\' | translate}}</label> <hois-value value="stipend.places"></hois-value> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label>{{\'stipend.amountPaid\' | translate}}</label> <hois-value value="stipend.amountPaid"></hois-value> </md-input-container> </div> <div> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'stipend.curriculums\' | translate}}</legend> <md-table-container> <table md-table class="secondary-table"> <tbody md-body> <tr md-row ng-repeat="curriculum in stipend.curriculums | orderBy: [\'curriculum.\' + currentLanguageNameField(), \'code\']" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{currentLanguageNameField(curriculum)}}</td> </tr> </tbody> </table> </md-table-container> </fieldset> <div>&nbsp;</div> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.studyForm\' | translate}}</label> <hois-classifier-value ng-model="stipend.studyForms" main-classifier-code="OPPEVORM" multiple></hois-classifier-value> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label class="textInput">{{\'stipend.courses\' | translate}}</label> <hois-classifier-value ng-model="stipend.courses" main-classifier-code="KURSUS" multiple></hois-classifier-value> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="100"> <label class="textInput">{{\'stipend.addInfoForStudent\' | translate}}</label> <hois-value value="stipend.addInfo"></hois-value> </md-input-container> </div> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'stipend.generalCriteria\' | translate}}</legend> <div>&nbsp;</div> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.averageMark\' | translate}}</label> <hois-value value="stipend.averageMark"></hois-value> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label class="textInput">{{\'stipend.priority\' | translate}}</label> <hois-classifier-value ng-model="stipend.averageMarkPriority" main-classifier-code="PRIORITEET"></hois-classifier-value> </md-input-container> </div> <h3>{{\'stipend.considerFollowing\' | translate}}</h3> <div layout="row" flex> <md-checkbox ng-model="stipend.isOutcomes" disabled flex="50"> {{\'stipend.isOutcomes\' | translate}} </md-checkbox> <md-checkbox ng-model="stipend.isModuleGrade" disabled flex="50"> {{\'stipend.isModuleGrade\' | translate}} </md-checkbox> </div> <div layout="row" flex> <md-checkbox ng-model="stipend.isPeriodGrade" disabled flex="50"> {{\'stipend.isPeriodGrade\' | translate}} </md-checkbox> <md-checkbox ng-model="stipend.isApelGrade" disabled flex="50"> {{\'stipend.isApelGrade\' | translate}} </md-checkbox> </div> <div layout="row" flex> <md-checkbox ng-model="stipend.isJournalFinalGrade" disabled flex="50"> {{\'stipend.isJournalFinalGrade\' | translate}} </md-checkbox> <md-checkbox ng-model="stipend.isJournalGrade" disabled flex="50"> {{\'stipend.isJournalGrade\' | translate}} </md-checkbox> </div> </fieldset> <div>&nbsp;</div> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'stipend.previousPeriodCriteria\' | translate}}</legend> <div>&nbsp;</div> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.lastPeriodMark\' | translate}}</label> <hois-value value="stipend.lastPeriodMark"></hois-value> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label class="textInput">{{\'stipend.priority\' | translate}}</label> <hois-classifier-value ng-model="stipend.lastPeriodMarkPriority" main-classifier-code="PRIORITEET"></hois-classifier-value> </md-input-container> </div> <h3>{{\'stipend.considerFollowing\' | translate}}</h3> <div layout="row" flex> <md-checkbox ng-model="stipend.isLastPeriodOutcomes" disabled flex="50"> {{\'stipend.isOutcomes\' | translate}} </md-checkbox> <md-checkbox ng-model="stipend.isLastPeriodModuleGrade" disabled flex="50"> {{\'stipend.isModuleGrade\' | translate}} </md-checkbox> </div> <div layout="row" flex> <md-checkbox ng-model="stipend.isLastPeriodPeriodGrade" disabled flex="50"> {{\'stipend.isPeriodGrade\' | translate}} </md-checkbox> <md-checkbox ng-model="stipend.isLastPeriodApelGrade" disabled flex="50"> {{\'stipend.isApelGrade\' | translate}} </md-checkbox> </div> <div layout="row" flex> <md-checkbox ng-model="stipend.isLastPeriodJournalFinalGrade" disabled flex="50"> {{\'stipend.isJournalFinalGrade\' | translate}} </md-checkbox> <md-checkbox ng-model="stipend.isLastPeriodJournalGrade" disabled flex="50"> {{\'stipend.isJournalGrade\' | translate}} </md-checkbox> </div> <div>&nbsp;</div> <div layout="row"> <div flex="20" flex-md="100" flex-sm="100" flex-xs="100"> <label class="date-period-label">{{\'stipend.lastPeriodGrade\' | translate}}</label> </div> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'main.from\' | translate}}</label> <hois-value value="stipend.lastPeriodGradeFrom | hoisDate"></hois-value> </md-input-container> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'main.thru\' | translate}}</label> <hois-value value="stipend.lastPeriodGradeThru | hoisDate"></hois-value> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.curriculumCompletion\' | translate}}</label> <hois-value value="stipend.curriculumCompletion"></hois-value> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label class="textInput">{{\'stipend.priority\' | translate}}</label> <hois-classifier-value ng-model="stipend.curriculumCompletionPriority" main-classifier-code="PRIORITEET"></hois-classifier-value> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.maxAbsences\' | translate}}</label> <hois-value value="stipend.maxAbsences"></hois-value> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label class="textInput">{{\'stipend.priority\' | translate}}</label> <hois-classifier-value ng-model="stipend.maxAbsencesPriority" main-classifier-code="PRIORITEET"></hois-classifier-value> </md-input-container> </div> <div layout="row"> <md-checkbox ng-model="stipend.isStudyBacklog" disabled aria-label="Is academic leave"> {{\'stipend.isStudyBacklog\' | translate}} </md-checkbox> </div> </fieldset> <div>&nbsp;</div> <div>&nbsp;</div> <div layout="row"> <div flex="20" flex-md="100" flex-sm="100" flex-xs="100"> <label class="date-period-label">{{\'stipend.studyPeriodDates\' | translate}}</label> </div> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'main.from\' | translate}}</label> <hois-value value="stipend.studyStartPeriodStart | hoisDate"></hois-value> </md-input-container> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'main.thru\' | translate}}</label> <hois-value value="stipend.studyStartPeriodEnd | hoisDate"></hois-value> </md-input-container> </div> <div layout="row"> <md-checkbox ng-model="stipend.isTeacherConfirm" disabled aria-label="Is academic leave"> {{\'stipend.isTeacherConfirm\' | translate}} </md-checkbox> </div> <div layout="row" flex> <md-input-container flex="45"> <label>{{\'stipend.committee\' | translate}}</label> <hois-value value="currentLanguageNameField(formState.committee)"></hois-value> </md-input-container> </div> <div layout="row"> <div layout="row"> <md-button class="md-raised md-primary" ng-if="canEdit" ng-click="changeStipend(stipend)">{{\'main.button.edit\' | translate}}</md-button> <md-button class="md-raised" ng-if="!stipend.isOpen && stipend.id && canEdit" ng-click="publish()">{{\'main.button.publishtoStudents\' | translate}}</md-button> <md-button class="md-raised" ng-click="back(\'#/scholarships/\', stipendForm)">{{\'main.button.back\' | translate}}</md-button> </div> </div> </div> </div> </form> </div> </div>'),a.put("scholarship/term/scholarship.scho.edit.html",'<div layout="row" flex> <md-input-container flex> <label class="textInput">{{\'stipend.scholarshipName\' | translate}}</label> <input type="text" ng-model="stipend.nameEt" name="nameEt" required md-maxlength="500"> </md-input-container> </div> <div layout="row" flex> <md-input-container flex> <label class="textInput">{{\'stipend.studyPeriod\' | translate}}</label> <hois-select required ng-model="stipend.studyPeriod" type="studyperiodyear" sorted-query="true" preselect-current></hois-select> </md-input-container> </div> <div layout="row"> <div flex="20" flex-md="100" flex-sm="100" flex-xs="100"> <label class="date-period-label">{{\'stipend.applicationPeriod\' | translate}} *</label> </div> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <md-datepicker required ng-model="stipend.applicationStart" md-max-date="stipend.applicationEnd" md-placeholder="{{\'main.from\' | translate}}"></md-datepicker> </md-input-container> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <md-datepicker required ng-model="stipend.applicationEnd" md-min-date="stipend.applicationStart" md-placeholder="{{\'main.thru\' | translate}}" ng-change="applicationEndChanged()"></md-datepicker> </md-input-container> </div> <div layout="row"> <div flex="20" flex-md="100" flex-sm="100" flex-xs="100"> <label class="date-period-label">{{\'stipend.paymentPeriod\' | translate}} *</label> </div> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <md-datepicker required ng-model="stipend.paymentStart" md-max-date="stipend.paymentEnd" md-placeholder="{{\'main.from\' | translate}}"></md-datepicker> </md-input-container> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <md-datepicker required ng-model="stipend.paymentEnd" md-min-date="stipend.paymentStart" md-placeholder="{{\'main.thru\' | translate}}"></md-datepicker> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="45"> <label>{{\'stipend.places\' | translate}}</label> <input ng-model="stipend.places" type="number" autofocus aria-label="places" min="0" max="99999"> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label>{{\'stipend.amountPaid\' | translate}}</label> <input required ng-model="stipend.amountPaid" type="number" autofocus aria-label="amountPaid" min="0" max="9999"> </md-input-container> </div> <div> <div layout="row" flex="100"> <hois-autocomplete flex ng-model="formState.curriculum" method="curriculums" label="stipend.curriculums" ng-required="missingCurriculums" additional-query-params="{higher: true, closed: false}"></hois-autocomplete> <md-button ng-click="addAllCurriculums({higher: true, closed: false})" class="md-raised">{{\'stipend.addAllCurriculums\' | translate}}</md-button> </div> <div layout="column" class="common-label" flex="95" ng-repeat="curriculum in stipend.curriculums | orderBy: [\'curriculum.\' + currentLanguageNameField(), \'code\']"> <div layout="row" flex layout-align="start center"> <div flex="5">&nbsp;</div> <div flex="50">{{curriculum.nameEt}}</div> <div> <a ng-click="deleteCurriculum(curriculum)" class="remove">&times;</a> </div> </div> </div> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.studyLoad\' | translate}}</label> <hois-classifier-select required ng-model="stipend.studyLoads" name="type" model-value-attr="code" main-classifier-code="OPPEKOORMUS" criteria="{higher: true}" multiple></hois-classifier-select> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label class="textInput">{{\'stipend.courses\' | translate}}</label> <hois-classifier-select required ng-model="stipend.courses" name="type" model-value-attr="code" main-classifier-code="KURSUS" multiple></hois-classifier-select> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.averageMark\' | translate}}</label> <input ng-model="stipend.averageMark" type="number" autofocus aria-label="averageMark" min="0" max="5"> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label class="textInput">{{\'stipend.priority\' | translate}}</label> <hois-select ng-model="stipend.averageMarkPriority" values="formState.priorities | filter: averageMarkPriorityFilter" show-property="value" value-property="code"></hois-select> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.lastPeriodMark\' | translate}}</label> <input ng-model="stipend.lastPeriodMark" type="number" autofocus aria-label="averageMark" min="0" max="5"> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label class="textInput">{{\'stipend.priority\' | translate}}</label> <hois-select ng-model="stipend.lastPeriodMarkPriority" values="formState.priorities | filter: lastPeriodMarkPriorityFilter" show-property="value" value-property="code"></hois-select> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.curriculumCompletion\' | translate}}</label> <input ng-model="stipend.curriculumCompletion" type="number" autofocus aria-label="curriculumCompletion" min="0"> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label class="textInput">{{\'stipend.priority\' | translate}}</label> <hois-select ng-model="stipend.curriculumCompletionPriority" values="formState.priorities | filter: curriculumCompletionPriorityFilter" show-property="value" value-property="code"></hois-select> </md-input-container> </div> <div layout="row"> <div flex="20" flex-md="100" flex-sm="100" flex-xs="100"> <label class="date-period-label">{{\'stipend.studyPeriodDates\' | translate}}</label> </div> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <md-datepicker ng-model="stipend.studyStartPeriodStart" md-max-date="stipend.studyStartPeriodEnd" md-placeholder="{{\'main.from\' | translate}}"></md-datepicker> </md-input-container> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <md-datepicker ng-model="stipend.studyStartPeriodEnd" md-min-date="stipend.studyStartPeriodStart" md-placeholder="{{\'main.thru\' | translate}}"></md-datepicker> </md-input-container> </div> <div layout="row" flex> <md-checkbox ng-model="stipend.isAcademicLeave" aria-label="Is academic leave" flex="50"> {{\'stipend.isAcademicLeave\' | translate}} </md-checkbox> </div> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.committee\' | translate}}</label> <hois-select ng-model="stipend.committee" values="formState.committees"></hois-select> </md-input-container> </div> </div> <div layout="row"> <md-button class="md-raised md-primary" ng-click="update()">{{\'main.button.save\' | translate}}</md-button> <md-button class="md-raised" ng-if="!stipend.isOpen && stipend.id" ng-click="publish()">{{\'main.button.publishtoStudents\' | translate}}</md-button> <md-button class="md-raised" ng-if="stipend.id && !stipend.isOpen" ng-click="delete()">{{\'main.button.delete\' | translate}}</md-button> <md-button class="md-raised" ng-click="back(\'#/scholarships/scholarships\', stipendForm)">{{\'main.button.back\' | translate}}</md-button> </div>'),
a.put("scholarship/term/scholarship.scho.view.html",'<div class="ois-form-layout-padding" ng-cloak> <div flex> <form name="stipendForm"> <div class="form-readonly"> <div layout="row" flex> <md-input-container flex> <label class="textInput">{{formState.typeIsScholarship ? \'stipend.scholarshipType\' : \'stipend.grantType\' | translate}}</label> <hois-classifier-value ng-model="stipend.type" main-classifier-code="STIPTOETUS"></hois-classifier-value> </md-input-container> </div> <div layout="row" flex> <md-input-container flex> <label class="textInput">{{formState.typeIsScholarship ? \'stipend.scholarshipName\' : \'stipend.grantName\' | translate}}</label> <hois-value value="stipend.nameEt"></hois-value> </md-input-container> </div> <div layout="row" flex> <md-input-container flex> <label class="textInput">{{\'stipend.studyPeriod\' | translate}}</label> <hois-value value="formState.readonlyStudyPeriod | hoisStudyPeriod"></hois-value> </md-input-container> </div> <div layout="row"> <div flex="20" flex-md="100" flex-sm="100" flex-xs="100"> <label class="date-period-label">{{\'stipend.applicationPeriod\' | translate}}</label> </div> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'main.from\' | translate}}</label> <hois-value value="stipend.applicationStart | hoisDate"></hois-value> </md-input-container> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'main.thru\' | translate}}</label> <hois-value value="stipend.applicationEnd | hoisDate"></hois-value> </md-input-container> </div> <div layout="row"> <div flex="20" flex-md="100" flex-sm="100" flex-xs="100"> <label class="date-period-label">{{\'stipend.paymentPeriod\' | translate}}</label> </div> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'main.from\' | translate}}</label> <hois-value value="stipend.paymentStart | hoisDate"></hois-value> </md-input-container> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'main.thru\' | translate}}</label> <hois-value value="stipend.paymentEnd | hoisDate"></hois-value> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="45"> <label>{{\'stipend.places\' | translate}}</label> <hois-value value="stipend.places"></hois-value> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label>{{\'stipend.amountPaid\' | translate}}</label> <hois-value value="stipend.amountPaid"></hois-value> </md-input-container> </div> <div> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'stipend.curriculums\' | translate}}</legend> <md-table-container> <table md-table class="secondary-table"> <tbody md-body> <tr md-row ng-repeat="curriculum in stipend.curriculums | orderBy: [\'curriculum.\' + currentLanguageNameField(), \'code\']" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{currentLanguageNameField(curriculum)}}</td> </tr> </tbody> </table> </md-table-container> </fieldset> <div>&nbsp;</div> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.studyLoad\' | translate}}</label> <hois-classifier-value ng-model="stipend.studyLoads" main-classifier-code="OPPEKOORMUS" multiple></hois-classifier-value> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label class="textInput">{{\'stipend.courses\' | translate}}</label> <hois-classifier-value ng-model="stipend.courses" main-classifier-code="KURSUS" multiple></hois-classifier-value> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.averageMark\' | translate}}</label> <hois-value value="stipend.averageMark"></hois-value> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label class="textInput">{{\'stipend.priority\' | translate}}</label> <hois-classifier-value ng-model="stipend.averageMarkPriority" main-classifier-code="PRIORITEET"></hois-classifier-value> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.lastPeriodMark\' | translate}}</label> <hois-value value="stipend.lastPeriodMark"></hois-value> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label class="textInput">{{\'stipend.priority\' | translate}}</label> <hois-classifier-value ng-model="stipend.lastPeriodMarkPriority" main-classifier-code="PRIORITEET"></hois-classifier-value> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.curriculumCompletion\' | translate}}</label> <hois-value value="stipend.curriculumCompletion"></hois-value> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label class="textInput">{{\'stipend.priority\' | translate}}</label> <hois-classifier-value ng-model="stipend.curriculumCompletionPriority" main-classifier-code="PRIORITEET"></hois-classifier-value> </md-input-container> </div> <div layout="row"> <div flex="20" flex-md="100" flex-sm="100" flex-xs="100"> <label class="date-period-label">{{\'stipend.studyPeriodDates\' | translate}}</label> </div> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'main.from\' | translate}}</label> <hois-value value="stipend.studyStartPeriodStart | hoisDate"></hois-value> </md-input-container> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'main.thru\' | translate}}</label> <hois-value value="stipend.studyStartPeriodEnd | hoisDate"></hois-value> </md-input-container> </div> <div layout="row" flex> <md-checkbox ng-model="stipend.isAcademicLeave" aria-label="Is academic leave" disabled flex="50"> {{\'stipend.isAcademicLeave\' | translate}} </md-checkbox> </div> <div layout="row" flex> <md-input-container flex="45"> <label>{{\'stipend.committee\' | translate}}</label> <hois-value value="currentLanguageNameField(formState.committee)"></hois-value> </md-input-container> </div> <div layout="row"> <div layout="row"> <md-button class="md-raised md-primary" ng-if="canEdit" ng-click="changeStipend(stipend)">{{\'main.button.edit\' | translate}}</md-button> <md-button class="md-raised" ng-if="!stipend.isOpen && stipend.id && canEdit" ng-click="publish()">{{\'main.button.publishtoStudents\' | translate}}</md-button> <md-button class="md-raised" ng-click="back(\'#/scholarships/\', stipendForm)">{{\'main.button.back\' | translate}}</md-button> </div> </div> </div> </div> </form> </div> </div>'),a.put("scholarship/term/scholarship.soidu.edit.html",'<div layout="row" flex> <md-input-container flex> <label class="textInput">{{\'stipend.grantName\' | translate}}</label> <input type="text" ng-model="stipend.nameEt" name="nameEt" required md-maxlength="500"> </md-input-container> </div> <div layout="row" flex> <md-input-container flex> <label class="textInput">{{\'stipend.studyPeriod\' | translate}}</label> <hois-select required ng-model="stipend.studyPeriod" type="studyperiodyear" sorted-query="true" preselect-current></hois-select> </md-input-container> </div> <div layout="row"> <div flex="20" flex-md="100" flex-sm="100" flex-xs="100"> <label class="date-period-label">{{\'stipend.applicationPeriod\' | translate}}</label> </div> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <md-datepicker ng-model="stipend.applicationStart" md-max-date="stipend.applicationEnd" md-placeholder="{{\'main.from\' | translate}}"></md-datepicker> </md-input-container> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <md-datepicker ng-model="stipend.applicationEnd" md-min-date="stipend.applicationStart" md-placeholder="{{\'main.thru\' | translate}}" ng-change="applicationEndChanged()"></md-datepicker> </md-input-container> </div> <div layout="row"> <div flex="20" flex-md="100" flex-sm="100" flex-xs="100"> <label class="date-period-label">{{\'stipend.paymentPeriod\' | translate}}</label> </div> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <md-datepicker ng-model="stipend.paymentStart" md-max-date="stipend.paymentEnd" md-placeholder="{{\'main.from\' | translate}}"></md-datepicker> </md-input-container> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <md-datepicker ng-model="stipend.paymentEnd" md-min-date="stipend.paymentStart" md-placeholder="{{\'main.thru\' | translate}}"></md-datepicker> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="100"> <label>{{\'stipend.amountPaid\' | translate}}</label> <input ng-model="stipend.amountPaid" type="number" autofocus aria-label="amountPaid" min="0" max="9999"> </md-input-container> </div> <div> <div layout="row" flex="100"> <hois-autocomplete flex ng-model="formState.curriculum" method="curriculums" label="stipend.curriculums" ng-required="missingCurriculums" additional-query-params="{higher: false, closed: false}"></hois-autocomplete> <md-button ng-click="addAllCurriculums({higher: false, closed: false})" class="md-raised">{{\'stipend.addAllCurriculums\' | translate}}</md-button> </div> <div layout="column" class="common-label" flex="95" ng-repeat="curriculum in stipend.curriculums | orderBy: [\'curriculum.\' + currentLanguageNameField(), \'code\']"> <div layout="row" flex layout-align="start center"> <div flex="5">&nbsp;</div> <div flex="50">{{curriculum.nameEt}}</div> <div> <a ng-click="deleteCurriculum(curriculum)" class="remove">&times;</a> </div> </div> </div> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.studyForm\' | translate}}</label> <hois-classifier-select required ng-model="stipend.studyForms" name="type" model-value-attr="code" main-classifier-code="OPPEVORM" criteria="{vocational: true}" multiple filter-values="filteredStudyForm"></hois-classifier-select> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label class="textInput">{{\'stipend.courses\' | translate}}</label> <hois-classifier-select required ng-model="stipend.courses" name="type" model-value-attr="code" main-classifier-code="KURSUS" multiple></hois-classifier-select> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="100"> <label class="textInput">{{\'stipend.addInfoForStudent\' | translate}}</label> <textarea ng-model="stipend.addInfo" md-maxlength="4000" max-rows="10"></textarea> </md-input-container> </div> <div layout="row"> <div flex="20" flex-md="100" flex-sm="100" flex-xs="100"> <label class="date-period-label">{{\'stipend.studyPeriodDates\' | translate}}</label> </div> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <md-datepicker ng-model="stipend.studyStartPeriodStart" md-max-date="stipend.studyStartPeriodEnd" md-placeholder="{{\'main.from\' | translate}}"></md-datepicker> </md-input-container> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <md-datepicker ng-model="stipend.studyStartPeriodEnd" md-min-date="stipend.studyStartPeriodStart" md-placeholder="{{\'main.thru\' | translate}}"></md-datepicker> </md-input-container> </div> <div layout="row" flex> <md-checkbox ng-model="stipend.isTeacherConfirm" aria-label="Is teache confir" ng-disabled="display.isTeacherConfirmRead" flex="50"> {{\'stipend.isTeacherConfirm\' | translate}} </md-checkbox> </div> </div> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.committee\' | translate}}</label> <hois-select ng-model="stipend.committee" values="formState.committees"></hois-select> </md-input-container> </div> <div layout="row"> <md-button class="md-raised md-primary" ng-click="update()">{{\'main.button.save\' | translate}}</md-button> <md-button class="md-raised" ng-if="!stipend.isOpen && stipend.id" ng-click="publish()">{{\'main.button.publishtoStudents\' | translate}}</md-button> <md-button class="md-raised" ng-if="stipend.id && !stipend.isOpen" ng-click="delete()">{{\'main.button.delete\' | translate}}</md-button> <md-button class="md-raised" ng-click="back(\'#/scholarships?grants\', stipendForm)">{{\'main.button.back\' | translate}}</md-button> </div>'),a.put("scholarship/term/scholarship.soidu.view.html",'<div class="ois-form-layout-padding" ng-cloak> <div flex> <form name="stipendForm"> <div class="form-readonly"> <div layout="row" flex> <md-input-container flex> <label class="textInput">{{formState.typeIsScholarship ? \'stipend.scholarshipType\' : \'stipend.grantType\' | translate}}</label> <hois-classifier-value ng-model="stipend.type" main-classifier-code="STIPTOETUS"></hois-classifier-value> </md-input-container> </div> <div layout="row" flex> <md-input-container flex> <label class="textInput">{{formState.typeIsScholarship ? \'stipend.scholarshipName\' : \'stipend.grantName\' | translate}}</label> <hois-value value="stipend.nameEt"></hois-value> </md-input-container> </div> <div layout="row" flex> <md-input-container flex> <label class="textInput">{{\'stipend.studyPeriod\' | translate}}</label> <hois-value value="formState.readonlyStudyPeriod | hoisStudyPeriod"></hois-value> </md-input-container> </div> <div layout="row"> <div flex="20" flex-md="100" flex-sm="100" flex-xs="100"> <label class="date-period-label">{{\'stipend.applicationPeriod\' | translate}}</label> </div> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'main.from\' | translate}}</label> <hois-value value="stipend.applicationStart | hoisDate"></hois-value> </md-input-container> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'main.thru\' | translate}}</label> <hois-value value="stipend.applicationEnd | hoisDate"></hois-value> </md-input-container> </div> <div layout="row"> <div flex="20" flex-md="100" flex-sm="100" flex-xs="100"> <label class="date-period-label">{{\'stipend.paymentPeriod\' | translate}}</label> </div> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'main.from\' | translate}}</label> <hois-value value="stipend.paymentStart | hoisDate"></hois-value> </md-input-container> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'main.thru\' | translate}}</label> <hois-value value="stipend.paymentEnd | hoisDate"></hois-value> </md-input-container> </div> <div layout="row" flex> <md-input-container flex> <label>{{\'stipend.amountPaid\' | translate}}</label> <hois-value value="stipend.amountPaid"></hois-value> </md-input-container> </div> <div> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'stipend.curriculums\' | translate}}</legend> <md-table-container> <table md-table class="secondary-table"> <tbody md-body> <tr md-row ng-repeat="curriculum in stipend.curriculums | orderBy: [\'curriculum.\' + currentLanguageNameField(), \'code\']" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{currentLanguageNameField(curriculum)}}</td> </tr> </tbody> </table> </md-table-container> </fieldset> <div>&nbsp;</div> <div layout="row" flex> <md-input-container flex="45"> <label class="textInput">{{\'stipend.studyForm\' | translate}}</label> <hois-classifier-value ng-model="stipend.studyForms" main-classifier-code="OPPEVORM" multiple></hois-classifier-value> </md-input-container> <md-input-container flex="50" flex-offset="5"> <label class="textInput">{{\'stipend.courses\' | translate}}</label> <hois-classifier-value ng-model="stipend.courses" main-classifier-code="KURSUS" multiple></hois-classifier-value> </md-input-container> </div> <div layout="row" flex> <md-input-container flex="100"> <label class="textInput">{{\'stipend.addInfoForStudent\' | translate}}</label> <hois-value value="stipend.addInfo"></hois-value> </md-input-container> </div> <div layout="row"> <div flex="20" flex-md="100" flex-sm="100" flex-xs="100"> <label class="date-period-label">{{\'stipend.studyPeriodDates\' | translate}}</label> </div> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'main.from\' | translate}}</label> <hois-value value="stipend.studyStartPeriodStart | hoisDate"></hois-value> </md-input-container> <md-input-container flex="20" flex-md="100" flex-sm="100" flex-xs="100" flex-offset="5"> <label>{{\'main.thru\' | translate}}</label> <hois-value value="stipend.studyStartPeriodEnd | hoisDate"></hois-value> </md-input-container> </div> <div layout="row"> <md-checkbox ng-model="stipend.isTeacherConfirm" disabled aria-label="Is academic leave"> {{\'stipend.isTeacherConfirm\' | translate}} </md-checkbox> </div> <div layout="row" flex> <md-input-container flex="45"> <label>{{\'stipend.committee\' | translate}}</label> <hois-value value="currentLanguageNameField(formState.committee)"></hois-value> </md-input-container> </div> <div layout="row"> <div layout="row"> <md-button class="md-raised md-primary" ng-if="canEdit" ng-click="changeStipend(stipend)">{{\'main.button.edit\' | translate}}</md-button> <md-button class="md-raised" ng-if="!stipend.isOpen && stipend.id && canEdit" ng-click="publish()">{{\'main.button.publishtoStudents\' | translate}}</md-button> <md-button class="md-raised" ng-click="back(\'#/scholarships/\', stipendForm)">{{\'main.button.back\' | translate}}</md-button> </div> </div> </div> </div> </form> </div> </div>'),a.put("student/speciality/student.speciality.list.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <form name="searchForm" ng-submit="loadData()" novalidate> <div layout="column"> <hois-autocomplete flex="100" ng-model="criteria.curriculum" ha-attribute="id" ha-controller="autocompletes" method="curriculumsauto" no-paging="true" additional-query-params="{higher: true, closed: false, minSpecialities:2}" label="student.curriculum" required></hois-autocomplete> <md-input-container flex="100" ng-show="filteredVersions.length > 0"> <label>{{\'student.curriculumVersion\' | translate}}</label> <md-select ng-model="criteria.curriculumVersion" required> <md-option ng-value="opt.id" ng-repeat="opt in filteredVersions">{{currentLanguageNameField(opt)}}</md-option> </md-select> </md-input-container> <div ng-show="criteria.curriculum && filteredVersions.length === 0" class="md-body-1" md-colors="{color: \'warn\'}"> {{\'student.speciality.error.notNeeded\' | translate}} </div> <md-input-container flex="100"> <md-checkbox ng-model="criteria.woSpeciality"> {{\'student.speciality.showWithoutSpec\' | translate}} </md-checkbox> </md-input-container> </div> <div layout="row"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> <md-button class="md-raised" ng-click="back(\'#/students?_menu\')">{{\'main.button.back\' | translate}}</md-button> </div> </form> </fieldset> </div> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column>{{\'student.name\' | translate}}</th> <th md-column>{{\'student.idcode\' | translate}}</th> <th md-column>{{\'student.studentGroup\' | translate}}</th> <th md-column>{{\'student.curriculumSpeciality\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{row.name}}</td> <td md-cell>{{row.idcode}}</td> <td md-cell>{{currentLanguageNameField(row.group)}}</td> <td md-cell> <md-input-container style="width: 100%"> <md-select ng-model="row.speciality.id"> <md-option md-option-empty></md-option> <md-option ng-value="spec.id" ng-repeat="spec in availableSpecialities">{{currentLanguageNameField(spec)}}</md-option> </md-select> </md-input-container> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> <div layout="row" style="margin-top: -1.5em" ng-if="tabledata.totalElements > 0"> <md-button class="md-raised md-primary" ng-click="save()">{{\'main.button.save\' | translate}}</md-button> </div> </div>'),a.put("student/templates/change.modules.tmpl.html",'<md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'student.result.higher.subject\' | translate}}</th> <th md-column>{{\'student.result.higher.subjectCode\' | translate}}</th> <th md-column>{{\'student.result.higher.credits\' | translate}}</th> <th md-column>{{\'student.result.grade\' | translate}}</th> <th md-column>{{\'student.result.date\' | translate}}</th> <th md-column>{{\'student.result.oldModule\' | translate}}</th> <th md-column>{{\'student.result.higher.isOptional\' | translate}}</th> <th md-column>{{\'student.result.newModule\' | translate}}</th> <th md-column>{{\'student.result.higher.isOptional\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="subject in changeableModules | orderBy: currentLanguageNameField()" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{currentLanguageNameField(subject)}}</td> <td md-cell>{{subject.subjectCode}}</td> <td md-cell>{{subject.credits}}</td> <td md-cell>{{subject.grade}}</td> <td md-cell>{{subject.gradeDate | hoisDate}}</td> <td md-cell>{{currentLanguageNameField(subject.curriculumVersionModule)}}</td> <td md-cell> <md-checkbox ng-model="subject.oldIsOptional" aria-label="old is optional" disabled></md-checkbox> </td> <td md-cell> <md-select ng-model="subject.curriculumVersionModuleId" aria-label="new module select"> <md-option ng-repeat="val in higherCurriculumModules" ng-value="val.id">{{currentLanguageNameField(val)}}</md-option> </md-select> </td> <td md-cell> <md-checkbox ng-model="subject.isOptional" aria-label="is optional" ng-disabled="!subject.curriculumVersionModuleId"></md-checkbox> </td> </tr> </tbody> </table> </md-table-container> <br> <div layout="row" layout-margin> <md-button ng-if="changeableModules.length > 0" class="md-raised md-primary" ng-click="saveChangedModules()">{{\'main.button.save\' | translate}}</md-button> </div>'),a.put("student/templates/edit.service.dialog.html",'<md-dialog aria-label="{{\'student.supportService.operation.\' + (service.id ? \'editService\' : \'addService\') + \'.label\' | translate}}" flex="60" flex-sm="100" flex-xs="100"> <form name="dialogForm" ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2>{{\'student.supportService.operation.\' + (service.id ? \'editService\' : \'addService\') + \'.label\' | translate}}</h2> <span flex></span> <md-button class="md-icon-button" ng-click="close()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <div class="ois-form-layout" layout="column" style="margin: 8px 16px" ng-cloak> <md-input-container> <label>{{\'student.supportService.entryDate\' | translate}}</label> <md-datepicker ng-model="service.entryDate" name="entryDate" required></md-datepicker> </md-input-container> <md-input-container> <label>{{\'student.supportService.title\' | translate}}</label> <input ng-model="service.nameEt" name="title" type="text" md-maxlength="255" required> </md-input-container> <md-input-container> <label>{{\'student.supportService.content\' | translate}}</label> <textarea ng-model="service.content" name="content" max-rows="5" md-maxlength="4000" required></textarea> </md-input-container> <md-input-container style="width: 150px"> <label>{{\'student.supportService.validity\' | translate}}</label> <hois-classifier-select ng-model="service.validity" model-value-attr="code" main-classifier-code="TUGIKEHTIV" required></hois-classifier-select> </md-input-container> <md-input-container> <md-checkbox ng-model="service.isPublic" name="public">{{\'student.supportService.public\' | translate}}</md-checkbox> </md-input-container> <md-table-container ng-show="service.file"> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column><span>{{\'file.nameAndFile\' | translate}}</span></th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row> <td md-cell> <div layout="row" flex> <div flex="60"> {{service.file.fname}} </div> <div flex> <a ng-href="{{getUrl(service.file, \'supportservice\')}}" download target="_blank" rel="noopener noreferrer"> <md-icon md-font-set="material-icons">file_download</md-icon> </a> </div> </div> </td> <td md-cell> <md-button class="remove nomargin" ng-click="service.file = undefined">&times;</md-button> </td> </tr> </tbody> </table> </md-table-container> <md-input-container ng-show="!service.file"> <lf-ng-md-file-input name="file" lf-files="data.file" lf-browse-label="{{\'main.addFile\' | translate}}" lf-remove-label="{{\'main.button.delete\' | translate}}" lf-placeholder="{{\'student.supportService.file\' | translate}}" lf-filesize="5MB"></lf-ng-md-file-input> </md-input-container> <div ng-messages="dialogForm.file.$error" ng-show="!service.file"> <div class="invalid" ng-message="required">{{\'main.messages.error.selectFile\' | translate}}</div> <div class="invalid" ng-message="filesize">{{\'main.messages.error.fileTooLarge\' | translate}} 5MB!</div> </div> <md-input-container class="readonly readonly-reverse-margin"> <label>{{\'student.supportService.entrySubmitter\' | translate}}</label> <hois-value value="service.entrySubmitter"></hois-value> </md-input-container> </div> </md-dialog-content> <span flex></span> <md-dialog-actions layout="row" layout-align="start center"> <md-button class="md-raised md-primary" ng-click="submit()">{{"main.button.save" | translate}}</md-button> <md-button ng-if="service.id" class="md-raised md-primary" ng-click="delete()">{{"main.button.delete" | translate}}</md-button> <md-button class="md-raised" ng-click="close()">{{"main.button.close" | translate}}</md-button> </md-dialog-actions> </form> </md-dialog>'),a.put("student/templates/journals.and.protocols.tmpl.html",'<md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'student.result.name\' | translate}}</th> <th md-column>{{\'student.result.studyYear\' | translate}}</th> <th md-column>{{\'student.result.protocolNr\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="entity in studentConnectedEntities" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell> <a ng-if="entity.type === \'journal\'" ng-href="#/journal/{{entity.entityId}}/view">{{currentLanguageNameField(entity)}}</a> <a ng-if="entity.type === \'practice\'" ng-href="#/practiceJournals/{{entity.entityId}}/view">{{currentLanguageNameField(entity)}}</a> <a ng-if="entity.type === \'protocol\'" ng-href="#/moduleProtocols/{{entity.entityId}}/view"><b>{{currentLanguageNameField(entity)}}</b></a> <a ng-if="entity.type === \'apel\' && auth.isAdmin()" ng-href="#/apelApplication/{{entity.entityId}}/view">{{currentLanguageNameField(entity)}}</a> <span ng-if="entity.type === \'apel\' && auth.isTeacher()">{{currentLanguageNameField(entity)}}</span> </td> <td md-cell> <hois-classifier-value ng-if="entity.type !== \'apel\'" ng-model="entity.yearCode" main-classifier-code="OPPEAASTA"></hois-classifier-value> <span ng-if="entity.type === \'apel\'">{{entity.date | hoisDate}}</span> </td> <td md-cell>{{entity.protocolNr}}</td> </tr> </tbody> </table> </md-table-container>'),a.put("student/templates/print.services.dialog.html",'<md-dialog aria-label="{{\'student.supportService.operation.printServices.label\' | translate}}" flex="40" flex-sm="60" flex-xs="100"> <form name="dialogForm" ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2>{{\'student.supportService.operation.printServices.label\' | translate}}</h2> <span flex></span> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <div class="ois-form-layout" layout="column" style="margin: 8px 16px" ng-cloak> <p class="md-body-2">{{\'student.supportService.operation.printServices.message\' | translate}}</p> <div layout="row"> <md-input-container> <label>{{\'main.from\' | translate}}</label> <md-datepicker ng-model="from" name="from" md-max-date="thru" required></md-datepicker> </md-input-container> <md-input-container> <label>{{\'main.thru\' | translate}}</label> <md-datepicker ng-model="thru" name="thru" md-min-date="from" required></md-datepicker> </md-input-container> </div> </div> </md-dialog-content> <span flex></span> <md-dialog-actions layout="row" layout-align="start center"> <md-button class="md-primary md-raised" ng-disabled="!from || !thru || dialogForm.$invalid" ng-href="{{pdfUrl()}}" ng-click="!(!from || !thru || dialogForm.$invalid) && cancel()" target="_blank">{{\'main.button.printPdf\' | translate}}</md-button> <md-button class="md-raised" ng-click="cancel()">{{"main.button.close" | translate}}</md-button> </md-dialog-actions> </form> </md-dialog>'),a.put("student/templates/view.navbar.higher.tmpl.html",'<md-content hide-xs> <md-nav-bar md-selected-nav-item="currentNavItem" nav-bar-aria-label="main selection" hois-navbar-overflowed ng-cloak> <md-nav-item md-nav-href="#/students/{{::studentId}}/main?_noback" name="student.main">{{\'student.main\' | translate}}</md-nav-item> <md-nav-item ng-if="student.userCanViewStudentSpecificData" md-nav-href="#/students/{{::studentId}}/results?_noback" name="student.results">{{\'student.results\' | translate}}</md-nav-item> <md-nav-item ng-if="student.userCanViewStudentSpecificData" md-nav-href="#/students/{{::studentId}}/documents?_noback" name="student.documents">{{\'student.documents\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && student.status && student.status !== \'OPPURSTAATUS_L\' && student.status !== \'OPPURSTAATUS_K\'" md-nav-href="#/students/{{::studentId}}/timetable?_noback" name="student.timetable">{{\'student.studentTimetable\' | translate}}</md-nav-item> <md-nav-item ng-if="student.userCanViewStudentSpecificData" md-nav-href="#/students/{{::studentId}}/rr?_noback" name="student.rr">{{\'rr.student.tabLabel\' | translate}}</md-nav-item> </md-nav-bar> </md-content> <div hide-gt-xs layout="column"> <md-button class="md-raised" flex ng-href="#/students/{{::studentId}}/main?_noback" name="student.main" ng-class="{\'md-accent\': currentNavItem === \'student.main\'}" name="student.main">{{\'student.main\' | translate}}</md-button> <md-button class="md-raised" ng-if="student.userCanViewStudentSpecificData" ng-href="#/students/{{::studentId}}/results?_noback" ng-class="{\'md-accent\': currentNavItem === \'student.results\'}" name="student.results">{{\'student.results\' | translate}}</md-button> <md-button class="md-raised" ng-if="student.userCanViewStudentSpecificData" ng-href="#/students/{{::studentId}}/documents?_noback" ng-class="{\'md-accent\': currentNavItem === \'student.documents\'}" name="student.documents">{{\'student.documents\' | translate}}</md-button> <md-button class="md-raised" ng-if="auth.isAdmin() && student.status !== \'OPPURSTAATUS_L\' && student.status !== \'OPPURSTAATUS_K\'" ng-class="{\'md-accent\': currentNavItem === \'student.timetable\'}" ng-href="#/students/{{::studentId}}/timetable?_noback" name="student.timetable">{{\'student.studentTimetable\' | translate}}</md-button> <md-button class="md-raised" ng-if="student.userCanViewStudentSpecificData" ng-class="{\'md-accent\': currentNavItem === \'student.rr\'}" ng-href="#/students/{{::studentId}}/rr?_noback" name="student.rr">{{\'rr.student.tabLabel\' | translate}}</md-button> </div>'),
a.put("student/templates/view.navbar.vocational.tmpl.html",'<md-content hide-xs> <md-nav-bar md-selected-nav-item="currentNavItem" nav-bar-aria-label="main selection" hois-navbar-overflowed> <md-nav-item md-nav-href="#/students/{{::studentId}}/main?_noback" name="student.main">{{\'student.main\' | translate}}</md-nav-item> <md-nav-item ng-if="student.userCanViewStudentSpecificData" md-nav-href="#/students/{{::studentId}}/results?_noback" name="student.results">{{\'student.results\' | translate}}</md-nav-item> <md-nav-item ng-if="student.userCanViewStudentSpecificData" md-nav-href="#/students/{{::studentId}}/absences?_noback" name="student.absences">{{\'student.absences\' | translate}}</md-nav-item> <md-nav-item ng-if="student.userCanViewStudentSpecificData" md-nav-href="#/students/{{::studentId}}/documents?_noback" name="student.documents">{{\'student.documents\' | translate}}</md-nav-item> <md-nav-item ng-if="student.userCanViewStudentSpecificData" md-nav-href="#/students/{{::studentId}}/remarks?_noback" name="student.remarks" ng-class="{\'highlighted-nav-item\': student.hasRemarksPastSevenDays}">{{\'student.remarks\' | translate}}</md-nav-item> <md-nav-item ng-if="auth.isAdmin() && student.status && student.status !== \'OPPURSTAATUS_L\' && student.status !== \'OPPURSTAATUS_K\'" md-nav-href="#/students/{{::studentId}}/timetable?_noback" name="student.timetable">{{\'student.studentTimetable\' | translate}}</md-nav-item> <md-nav-item ng-if="student.userCanViewStudentSpecificData" md-nav-href="#/students/{{::studentId}}/rr?_noback" name="student.rr">{{\'rr.student.tabLabel\' | translate}}</md-nav-item> <md-nav-item ng-if="student.userCanViewStudentSupportServices" md-nav-href="#/students/{{::studentId}}/supportService?_noback" name="student.supportService">{{\'student.supportService.label\' | translate}}</md-nav-item> </md-nav-bar> </md-content> <!-- <md-tabs hide-xs class="horizontal-menu" md-border-bottom md-stretch-tabs="never">\r\n  <md-tab>\r\n    <a ng-href="#/students/{{::studentId}}/main?_noback" md-active="currentNavItem === \'student.main\'">\r\n      <div>\r\n        <span>{{\'student.main\' | translate}}</span>\r\n      </div>\r\n    </a>\r\n  </md-tab>\r\n  <md-tab ng-if="student.userCanViewStudentSpecificData" md-active="currentNavItem === \'student.results\'">\r\n    <a ng-href="#/students/{{::studentId}}/results?_noback">\r\n      <div>\r\n        <span>{{\'student.results\' | translate}}</span>\r\n      </div>\r\n    </a>\r\n  </md-tab>\r\n  <md-tab ng-if="student.userCanViewStudentSpecificData" md-active="currentNavItem === \'student.absences\'">\r\n    <a ng-href="#/students/{{::studentId}}/absences?_noback">\r\n      <div>\r\n        <span>{{\'student.absences\' | translate}}</span>\r\n      </div>\r\n    </a>\r\n  </md-tab>\r\n  <md-tab ng-if="student.userCanViewStudentSpecificData" md-active="currentNavItem === \'student.documents\'">\r\n    <a ng-href="#/students/{{::studentId}}/documents?_noback">\r\n      <div>\r\n        <span>{{\'student.documents\' | translate}}</span>\r\n      </div>\r\n    </a>\r\n  </md-tab>\r\n  <md-tab ng-if="student.userCanViewStudentSpecificData" md-active="currentNavItem === \'student.remarks\'">\r\n    <a ng-href="#/students/{{::studentId}}/remarks?_noback">\r\n      <div>\r\n        <span ng-style="student.hasRemarksPastSevenDays && currentNavItem !== \'student.remarks\' ? {\'color\': \'red\'} : \'\'">{{\'student.remarks\' | translate}}</span>\r\n      </div>\r\n    </a>\r\n  </md-tab>\r\n  <md-tab ng-if="auth.isAdmin() && student.status && student.status !== \'OPPURSTAATUS_L\' && student.status !== \'OPPURSTAATUS_K\'" md-active="currentNavItem === \'student.timetable\'">\r\n    <a ng-href="#/students/{{::studentId}}/timetable?_noback">\r\n      <div>\r\n        <span>{{\'student.studentTimetable\' | translate}}</span>\r\n      </div>\r\n    </a>\r\n  </md-tab>\r\n  <md-tab ng-if="student.userCanViewStudentSpecificData" md-active="currentNavItem === \'student.rr\'">\r\n    <a ng-href="#/students/{{::studentId}}/rr?_noback">\r\n      <div>\r\n        <span>{{\'rr.student.tabLabel\' | translate}}</span>\r\n      </div>\r\n    </a>\r\n  </md-tab>\r\n  <md-tab ng-if="student.userCanViewStudentSupportServices" md-active="currentNavItem === \'student.supportService\'">\r\n    <a ng-href="#/students/{{::studentId}}/supportService?_noback">\r\n      <div>\r\n        <span>{{\'student.supportService.label\' | translate}}</span>\r\n      </div>\r\n    </a>\r\n  </md-tab>\r\n</md-tabs> --> <div hide-gt-xs layout="column"> <md-button class="md-raised" flex ng-href="#/students/{{::studentId}}/main?_noback" ng-class="{\'md-accent\': currentNavItem === \'student.main\'}" name="student.main">{{\'student.main\' | translate}}</md-button> <md-button class="md-raised" ng-if="student.userCanViewStudentSpecificData" ng-href="#/students/{{::studentId}}/results?_noback" ng-class="{\'md-accent\': currentNavItem === \'student.results\'}" name="student.results">{{\'student.results\' | translate}}</md-button> <md-button class="md-raised" ng-if="student.userCanViewStudentSpecificData" ng-href="#/students/{{::studentId}}/absences?_noback" ng-class="{\'md-accent\': currentNavItem === \'student.absences\'}" name="student.absences">{{\'student.absences\' | translate}}</md-button> <md-button class="md-raised" ng-if="student.userCanViewStudentSpecificData" ng-href="#/students/{{::studentId}}/documents?_noback" ng-class="{\'md-accent\': currentNavItem === \'student.documents\'}" name="student.documents">{{\'student.documents\' | translate}}</md-button> <md-button class="md-raised" ng-if="student.userCanViewStudentSpecificData" ng-href="#/students/{{::studentId}}/remarks?_noback" ng-class="{\'md-accent\': currentNavItem === \'student.remarks\', \'highlighted-nav-item\': student.hasRemarksPastSevenDays && currentNavItem !== \'student.remarks\'}" name="student.remarks">{{\'student.remarks\' | translate}}</md-button> <md-button class="md-raised" ng-if="auth.isAdmin() && student.status !== \'OPPURSTAATUS_L\' && student.status !== \'OPPURSTAATUS_K\'" ng-class="{\'md-accent\': currentNavItem === \'student.timetable\'}" ng-href="#/students/{{::studentId}}/timetable?_noback" name="student.timetable">{{\'student.studentTimetable\' | translate}}</md-button> <md-button class="md-raised" ng-if="student.userCanViewStudentSpecificData" ng-class="{\'md-accent\': currentNavItem === \'student.rr\'}" ng-href="#/students/{{::studentId}}/rr?_noback" name="student.rr">{{\'rr.student.tabLabel\' | translate}}</md-button> <md-button class="md-raised" ng-if="student.userCanViewStudentSupportServices" ng-class="{\'md-accent\': currentNavItem === \'student.supportService\'}" ng-href="#/students/{{::studentId}}/supportService?_noback" name="student.supportService">{{\'student.supportService.label\' | translate}}</md-button> </div> <!-- <style>\r\n  md-tabs.horizontal-menu md-tab-item a,\r\n  md-tabs.horizontal-menu md-tab-item a:hover,\r\n  md-tabs.horizontal-menu md-tab-item a:visited {\r\n    text-decoration: none !important;\r\n  }\r\n\r\n  md-tabs.horizontal-menu md-tab-item:not(.md-active) span {\r\n    color: grey;\r\n  }\r\n\r\n  md-tabs.horizontal-menu md-tab-item {\r\n    padding: 0 !important;\r\n  }\r\n\r\n  md-tabs.horizontal-menu md-tab-item a > div {\r\n    padding: 12px 24px;\r\n  }\r\n</style> -->'),a.put("student/templates/view.results.higher.curriculumfulfillment.tmpl.html",'<hois-collapsable ng-repeat="module in higherResults.modules" expanded="false"> <!-- if there is no extra curriculum subjects module(KORGMOODUL_V) then module.id is set to -1 --> <hois-collapsable-header ng-if="module.id > -1"> <div layout="row"> <div flex="30"> <span>{{currentLanguageNameField(module)}} {{module.totalCredits}} EAP</span> <span ng-if="module.type !== \'KORGMOODUL_M\'">(<hois-classifier-value class="inline" ng-model="module.type" main-classifier-code="KORGMOODUL"></hois-classifier-value>)</span> <span ng-if="module.type === \'KORGMOODUL_M\'">({{currentLanguage()==\'et\' ? module.typeNameEt : module.typeNameEn}})</span> </div> <b ng-if="!module.isOk" flex-offset="10" md-colors="{color: \'accent\'}">&nbsp;{{ module.totalDifference }}</b> <i class="material-icons" flex-offset="10" md-colors="{color: \'green-600\'}" ng-if="module.isOk">done</i> </div> </hois-collapsable-header> <hois-collapsable-header ng-if="module.id === -1"> <div layout="row"> <div flex="30"> <hois-classifier-value class="inline" ng-model="module.type" main-classifier-code="KORGMOODUL"></hois-classifier-value> </div> <i class="material-icons" flex-offset="10" md-colors="{color: \'green-600\'}" ng-if="module.isOk">done</i> </div> </hois-collapsable-header> <md-table-container> <table md-table> <tbody md-body> <tr md-row ng-if="hasMandatorySubjects(module)"> <td colspan="7" class="sub-header1"> &nbsp;{{\'subject.mandatory\' | translate}} <i class="material-icons green" ng-if="module.mandatoryDifference >= 0">done</i> </td> </tr> <tr md-row class="secondary-table-header" ng-if="hasMandatorySubjects(module)"> <td md-cell>{{\'student.result.higher.subject\' | translate}}</td> <td md-cell>{{\'student.result.higher.subjectCode\' | translate}}</td> <td md-cell>{{\'student.result.higher.credits\' | translate}}</td> <td md-cell>{{\'student.result.higher.grade\' | translate}}</td> <td md-cell>{{\'student.result.higher.date\' | translate}}</td> <td md-cell>{{\'student.result.higher.teacher\' | translate}}</td> <td md-cell>{{\'student.result.isOk\' | translate}}</td> </tr> <tr md-row ng-repeat-start="subjectResult in higherResults.subjectResults | filter: filterSubjectResultsByModule(module) \r\n          | filter: {isOptional: false} | orderBy: \'subject.\' + currentLanguageNameVariable()"> <td md-cell> <span ng-if="subjectResult.isApelTransfer" class="apelAsterisk">*</span> <span>{{currentLanguageNameField(subjectResult.subject)}}</span> <span ng-if="!subjectResult.isFormalLearning && subjectResult.isApelTransfer"> - {{\'student.result.informal\' | translate}}</span> </td> <td md-cell>{{subjectResult.subject.code}}</td> <td md-cell>{{subjectResult.subject.credits}}</td> <td md-cell> <table> <tr class="one-row"> <td ng-repeat="grade in subjectResult.grades | orderBy: [\'isActive\', \'gradeDate\']"> <span ng-if="$index !== 0">/</span> <span ng-class="{badResult: !gradeUtil.isPositive(grade.grade)}">{{grade.gradeValue}}</span> </td> </tr> </table> </td> <td md-cell>{{subjectResult.lastGrade.gradeDate | hoisDate}}</td> <td md-cell> <table> <tr ng-repeat="teacher in subjectResult.lastGrade.teachers | orderBy"> <td>{{teacher}}</td> </tr> </table> </td> <td md-cell>{{subjectResult.isOk ? \'main.yes\' : \'main.no\' | translate}}</td> </tr> <tr md-row ng-repeat="replacedSubject in subjectResult.replacedSubjects | orderBy: currentLanguageNameField(subject)" ng-repeat-end class="replaced-subject-row"> <td md-cell>{{currentLanguageNameField(replacedSubject.subject)}}</td> <td md-cell>{{replacedSubject.subject.code}}</td> <td md-cell>{{replacedSubject.subject.credits}}</td> <td md-cell colspan="4"></td> </tr> <tr md-row class="secondary-table-header" ng-if="hasMandatorySubjects(module)"> <td colspan="2">{{\'student.result.totalRequired\' | translate}}: {{module.compulsoryStudyCredits}}</td> <td colspan="2">{{\'student.result.totalSubmitted\' | translate}}: {{module.mandatoryCreditsSubmitted}}</td> <td colspan="3"> {{\'student.result.difference\' | translate}}: <span ng-class="{\'red\': module.mandatoryDifference < 0}">{{module.mandatoryDifference}}</span> </td> </tr> <tr md-row ng-if="hasOptionalSubjects(module)"> <td colspan="7" class="sub-header1"> {{\'subject.optional\' | translate}} <i class="material-icons green" ng-if="module.optionalDifference >= 0">done</i> </td> </tr> <tr md-row class="secondary-table-header" ng-if="hasOptionalSubjects(module)"> <td md-cell>{{\'student.result.higher.subject\' | translate}}</td> <td md-cell>{{\'student.result.higher.subjectCode\' | translate}}</td> <td md-cell>{{\'student.result.higher.credits\' | translate}}</td> <td md-cell>{{\'student.result.higher.grade\' | translate}}</td> <td md-cell>{{\'student.result.higher.date\' | translate}}</td> <td md-cell>{{\'student.result.higher.teacher\' | translate}}</td> <td md-cell>{{\'student.result.isOk\' | translate}}</td> </tr> <tr md-row ng-repeat-start="subjectResult in higherResults.subjectResults\r\n          | filter: filterSubjectResultsByModule(module) | filter: {isOptional: true} | filter: {electiveModule: \'!\'}\r\n          | orderBy: \'subject.\' + currentLanguageNameVariable()"> <td md-cell> <span ng-if="subjectResult.isApelTransfer" class="apelAsterisk">*</span> <span>{{currentLanguageNameField(subjectResult.subject)}}</span> <span ng-if="!subjectResult.isFormalLearning && subjectResult.isApelTransfer"> - {{\'student.result.informal\' | translate}}</span> </td> <td md-cell>{{subjectResult.subject.code}}</td> <td md-cell>{{subjectResult.subject.credits}}</td> <td md-cell> <table> <tr> <td ng-repeat="grade in subjectResult.grades | orderBy: [\'isActive\', \'gradeDate\']"> <span ng-if="$index !== 0">/</span> <span ng-class="{badResult: !gradeUtil.isPositive(grade.grade)}">{{grade.gradeValue}}</span> </td> </tr> </table> </td> <td md-cell>{{subjectResult.lastGrade.gradeDate | hoisDate}}</td> <td md-cell> <table> <tr ng-repeat="teacher in subjectResult.lastGrade.teachers | orderBy"> <td>{{teacher}}</td> </tr> </table> </td> <td md-cell>{{subjectResult.isOk ? \'main.yes\' : \'main.no\' | translate}}</td> </tr> <tr md-row ng-repeat="replacedSubject in subjectResult.replacedSubjects | orderBy: currentLanguageNameField(subject)" ng-repeat-end class="replaced-subject-row"> <td md-cell>{{currentLanguageNameField(replacedSubject.subject)}}</td> <td md-cell>{{replacedSubject.subject.code}}</td> <td md-cell>{{replacedSubject.subject.credits}}</td> <td md-cell colspan="4"></td> </tr> <tr md-row ng-if="module.electiveModulesResults.length > 0"> <td colspan="1" class="sub-header2"> {{\'student.result.higher.electiveModules\' | translate}} <i class="material-icons green" ng-if="module.electiveModulesNumber <= module.electiveModulesCompleted">done</i> </td> <td colspan="2" class="sub-header2">{{\'student.result.higher.electiveModulesRequired\' | translate}}: {{module.electiveModulesNumber}}</td> <td colspan="4" class="sub-header2">{{\'student.result.higher.electiveModulesCompleted\' | translate}}: {{module.electiveModulesCompleted}}</td> </tr> <tr md-row ng-repeat-start="electiveModule in module.electiveModulesResults | orderBy: currentLanguageNameField()"> <td md-cell colspan="7" class="sub-header2"> {{\'module.optional\' | translate}}: {{currentLanguageNameField(electiveModule)}} <i class="material-icons green" ng-if="electiveModule.isOk">done</i> </td> </tr> <tr md-row ng-repeat="subjectResult in higherResults.subjectResults | filter: filterSubjectResultsByModule(module) | filter: {isOptional: true} |\r\n                                filter: {electiveModule: electiveModule.referenceNumber} | orderBy: \'subject.\' + currentLanguageNameVariable()"> <td md-cell>{{currentLanguageNameField(subjectResult.subject)}}</td> <td md-cell>{{subjectResult.subject.code}}</td> <td md-cell>{{subjectResult.subject.credits}}</td> <td md-cell> <table> <tr> <td ng-repeat="grade in subjectResult.grades | orderBy: [\'isActive\', \'gradeDate\']"> <span ng-if="$index !== 0">/</span> <span ng-class="{badResult: !gradeUtil.isPositive(grade.grade)}">{{grade.gradeValue}}</span> </td> </tr> </table> </td> <td md-cell>{{subjectResult.lastGrade.gradeDate | hoisDate}}</td> <td md-cell> <table> <tr ng-repeat="teacher in subjectResult.lastGrade.teachers | orderBy"> <td>{{teacher}}</td> </tr> </table> </td> <td md-cell>{{subjectResult.isOk ? \'main.yes\' : \'main.no\' | translate}}</td> </tr> <tr ng-repeat-end></tr> <tr md-row class="secondary-table-header" ng-if="hasOptionalSubjects(module)"> <td colspan="2">{{\'student.result.totalRequired\' | translate}}: {{module.optionalStudyCredits}}</td> <td colspan="2">{{\'student.result.totalSubmitted\' | translate}}: {{module.optionalCreditsSubmitted}}</td> <td colspan="3"> {{\'student.result.difference\' | translate}}: <span ng-class="{\'red\': optionalDifference < 0}">{{module.optionalDifference}}</span> </td> </tr> </tbody> </table> </md-table-container> </hois-collapsable> <style>.inline {\r\n    display: inline;\r\n  }\r\n\r\n  .red {\r\n    color: red;\r\n  }</style>'),a.put("student/templates/view.results.higher.orderofpassing.tmpl.html","<md-table-container> <table md-table class=\"secondary-table\"> <thead md-head> <tr md-row> <th md-column>{{'student.result.higher.subject' | translate}}</th> <th md-column>{{'student.result.higher.subjectCode' | translate}}</th> <th md-column>{{'student.result.higher.module' | translate}}</th> <th md-column>{{'student.result.higher.required' | translate}}</th> <th md-column>{{'student.result.higher.credits' | translate}}</th> <th md-column>{{'student.result.higher.grade' | translate}}</th> <th md-column>{{'student.result.higher.date' | translate}}</th> <th md-column>{{'student.result.higher.teacher' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat=\"subjectResult in higherResults.subjectResults | orderBy: 'lastGrade.gradeDate'\" ng-if=\"subjectResult.lastGrade !== null && subjectResult.lastGrade.gradeValue !== null\"> <td md-cell> <span ng-if=\"subjectResult.isApelTransfer\" class=\"apelAsterisk\">*</span> <span>{{currentLanguageNameField(subjectResult.subject)}}</span> <span ng-if=\"!subjectResult.isFormalLearning && subjectResult.isApelTransfer\"> - {{'student.result.informal' | translate}}</span> </td> <td md-cell>{{subjectResult.subject.code}}</td> <td md-cell>{{currentLanguageNameField(subjectResult.higherModule)}}</td> <td md-cell>{{subjectResult.isOptional ? 'main.no' : 'main.yes' | translate}}</td> <td md-cell>{{subjectResult.subject.credits}}</td> <td md-cell> <table> <tr class=\"one-row\"> <td ng-repeat=\"grade in subjectResult.grades | orderBy: ['isActive', 'gradeDate']\"> <span ng-if=\"$index !== 0\">/</span> <span ng-class=\"{badResult: !gradeUtil.isPositive(grade.grade)}\">{{grade.gradeValue}}</span> </td> </tr> </table> </td> <td md-cell>{{subjectResult.lastGrade.gradeDate | hoisDate}}</td> <td md-cell> <table> <tr ng-repeat=\"teacher in subjectResult.lastGrade.teachers | orderBy\"> <td>{{teacher}}</td> </tr> </table> </td> </tr> </tbody> </table> </md-table-container>"),a.put("student/templates/view.results.higher.orderofstudyperiod.tmpl.html","<div ng-repeat=\"studyPeriodResult in higherResults.studyPeriodResults | orderBy: 'studyPeriod.endDate'\"> <hois-collapsable label=\"currentLanguageNameField(studyPeriodResult.studyPeriod)\" expanded=\"false\"> <md-table-container> <table md-table> <tbody md-body> <tr md-row class=\"secondary-table-header hideable\"> <td md-cell>{{'student.result.higher.subject' | translate}}</td> <td md-cell>{{'student.result.higher.subjectCode' | translate}}</td> <td md-cell>{{'student.result.higher.module' | translate}}</td> <td md-cell>{{'student.result.higher.required' | translate}}</td> <td md-cell>{{'student.result.higher.credits' | translate}}</td> <td md-cell>{{'student.result.higher.grade' | translate}}</td> <td md-cell>{{'student.result.higher.date' | translate}}</td> <td md-cell>{{'student.result.higher.teacher' | translate}}</td> </tr> <tr md-row ng-repeat=\"subjectResult in higherResults.subjectResults | filter: filterSubjectResultsByStudyPeriod(studyPeriodResult.studyPeriod) | orderBy: 'lastGrade.gradeDate'\"> <td md-cell> <span ng-if=\"subjectResult.isApelTransfer\" class=\"apelAsterisk\">*</span> <span>{{currentLanguageNameField(subjectResult.subject)}}</span> <span ng-if=\"!subjectResult.isFormalLearning && subjectResult.isApelTransfer\"> - {{'student.result.informal' | translate}}</span> </td> <td md-cell>{{subjectResult.subject.code}}</td> <td md-cell>{{currentLanguageNameField(subjectResult.higherModule)}}</td> <td md-cell>{{subjectResult.isOptional ? 'main.no' : 'main.yes' | translate}}</td> <td md-cell>{{subjectResult.subject.credits}}</td> <td md-cell> <table> <tr class=\"one-row\"> <td ng-repeat=\"grade in subjectResult.grades | orderBy: ['isActive', 'gradeDate']\"> <span ng-if=\"$index !== 0\">/</span> <span ng-class=\"{badResult: !gradeUtil.isPositive(grade.grade)}\">{{grade.gradeValue}}</span> </td> </tr> </table> </td> <td md-cell>{{subjectResult.lastGrade.gradeDate | hoisDate}}</td> <td md-cell> <table> <tr ng-repeat=\"teacher in subjectResult.lastGrade.teachers | orderBy\"> <td>{{teacher}}</td> </tr> </table> </td> </tr> <tr md-row class=\"secondary-table-header\"> <td md-cell>{{'student.result.higher.overallCredits' | translate}}: {{studyPeriodResult.total}}</td> <td md-cell colspan=\"7\">{{'student.result.kkh' | translate}}: {{studyPeriodResult.averageGrade}}</td> </tr> </tbody> </table> </md-table-container> </hois-collapsable> </div> <div ng-if=\"higherResults.studyPeriodResults && higherResults.studyPeriodResults.length==0\"> <span>{{'student.result.missing' | translate}}</span> </div>"),a.put("student/templates/view.results.higher.tmpl.html",'<div layout-padding ng-cloak class="form-readonly"> <div flex> <div layout="row" layout-xs="column" flex> <div flex="90"> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="20" flex-sm="100" flex-xs="100"> <label>{{\'student.label\' | translate}}</label> <hois-value value="student.person.firstname + \' \' + student.person.lastname"></hois-value> </md-input-container> <md-input-container flex="15" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'student.idcode\' | translate}}</label> <hois-value value="student.person.idcode"></hois-value> </md-input-container> <md-input-container flex="15" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'student.studyForm\' | translate}}</label> <hois-classifier-value ng-model="student.studyForm" main-classifier-code="OPPEVORM"></hois-classifier-value> </md-input-container> <md-input-container flex="35" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'student.result.higher.consideredCredits\' | translate}}</label> <hois-value value="student.higherResults.creditsSubmitted.toString() + \' / \' + student.higherResults.creditsSubmittedConsidered.toString()"></hois-value> </md-input-container> </div> </div> </div> <div layout="row" layout-xs="column" flex> <div flex="90"> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="20" flex-sm="100" flex-xs="100"> <label>{{\'student.result.higher.curriculumVersion\' | translate}}</label> <hois-value value="currentLanguageNameField(student.curriculumVersion)"></hois-value> </md-input-container> <md-input-container flex="15" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'student.result.curriculumCredits\' | translate}}</label> <hois-value value="student.curriculumCredits != null ? student.curriculumCredits + \' EAP\' : \'\'"></hois-value> </md-input-container> <md-input-container flex="15" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'student.result.studyLoad\' | translate}}</label> <hois-classifier-value ng-model="student.studyLoad" main-classifier-code="OPPEKOORMUS"></hois-classifier-value> </md-input-container> <md-input-container flex="15" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'student.result.kkh\' | translate}}</label> <hois-value value="student.higherResults.averageGrade.toString()"></hois-value> </md-input-container> <md-input-container flex="15" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'student.result.curriculumFulfilled\' | translate}}</label> <hois-value value="student.higherResults.isCurriculumFulfilled ? (\'student.result.fulfilled\' | translate) : (\'student.result.notFulfilled\' | translate)"></hois-value> </md-input-container> </div> </div> </div> <div layout="row" layout-xs="column" flex> <div flex="90"> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="20" flex-sm="100" flex-xs="100" ng-if="student.curriculumSpeciality"> <label>{{\'student.curriculumSpeciality\' | translate}}</label> <hois-value value="currentLanguageNameField(student.curriculumSpeciality)"></hois-value> </md-input-container> </div> </div> </div> <div ng-controller="StudentViewResultsHigherController as controller" flex="90" ng-cloak> <md-content> <md-nav-bar md-selected-nav-item="resultsCurrentNavItem" nav-bar-aria-label="results selection"> <md-nav-item md-nav-click="changeResultsCurrentNavItem(\'student.curriculumFulfillment\')" name="student.curriculumFulfillment"> {{\'student.result.curriculumFulfillment\' | translate}} </md-nav-item> <md-nav-item md-nav-click="changeResultsCurrentNavItem(\'student.inOrderOfStudyPeriod\')" name="student.inOrderOfStudyPeriod"> {{\'student.result.inOrderOfStudyPeriod\' | translate}} </md-nav-item> <md-nav-item md-nav-click="changeResultsCurrentNavItem(\'student.inOrderOfPassing\')" name="student.inOrderOfPassing"> {{\'student.result.inOrderOfPassing\' | translate}} </md-nav-item> <md-nav-item ng-if="canChangeStudentModules" md-nav-click="changeResultsCurrentNavItem(\'student.changeModules\')" name="student.changeModules"> {{\'student.result.changeModules\' | translate}} </md-nav-item> </md-nav-bar> <div layout-margin> <div ng-show="resultsCurrentNavItem === \'student.curriculumFulfillment\'"> <div ng-include="\'student/templates/view.results.higher.curriculumfulfillment.tmpl.html\'"></div> </div> <div ng-show="resultsCurrentNavItem === \'student.inOrderOfStudyPeriod\'"> <div ng-include="\'student/templates/view.results.higher.orderofstudyperiod.tmpl.html\'"></div> </div> <div ng-show="resultsCurrentNavItem === \'student.inOrderOfPassing\'"> <div ng-include="\'student/templates/view.results.higher.orderofpassing.tmpl.html\'"></div> </div> <div ng-if="canChangeStudentModules" ng-show="resultsCurrentNavItem === \'student.changeModules\'"> <div ng-include="\'student/templates/change.modules.tmpl.html\'"></div> </div> </div> </md-content> </div> <div layout="row"> <a ng-href="{{supplementPreviewPdfUrl}}?isHigher=true" ng-if="supplementPreviewPdfUrl" target="_blank" class="md-button md-raised">{{\'student.result.higher.supplementPreview\' | translate}}</a> <a ng-href="{{supplementPreviewPdfUrl}}?isHigher=true&lang=EN" ng-if="supplementPreviewPdfUrl" target="_blank" class="md-button md-raised">{{\'student.result.higher.supplementPreviewEn\' | translate}}</a> </div> </div> </div>'),a.put("student/templates/view.results.vocational.curriculumfulfillment.formallearning.tmpl.html",'<hois-collapsable expanded="false" hide-collapse-button="true"> <hois-collapsable-header> <div layout="column" layout-gt-sm="row" class="curriculum-fulfillment-result"> <div> <span class="apelAsterisk">*</span> <span>{{currentLanguageNameField(result.module)}}</span> </div> <div flex-offset-gt-sm="5"> <div ng-if="positiveGrade(result.grade.code)" class="bold" md-colors="{color: \'green-600\'}">{{result.grade.value}} ({{result.credits}} {{\'student.result.ekap\' | translate}})</div> <div ng-if="!positiveGrade(result.grade.code)" class="bold" md-colors="{color: \'red-500\'}">{{result.grade.value}} ({{result.credits}} {{\'student.result.ekap\' | translate}})</div> </div> </div> </hois-collapsable-header> </hois-collapsable>'),a.put("student/templates/view.results.vocational.curriculumfulfillment.list.tmpl.html",'<hois-collapsable expanded="false"> <hois-collapsable-header> <div layout="column" layout-gt-sm="row" class="curriculum-fulfillment-result"> <div> <span ng-if="moduleResultById[module.curriculumModule.id].isApelTransfer" class="apelAsterisk">*</span> <span>{{currentLanguageNameField(module.curriculumModule) + \' (\' + currentLanguageNameField(module.curriculumModule.module) + \')\'}}</span> <span ng-if="moduleResultById[module.curriculumModule.id].isApelTransfer && !moduleResultById[module.curriculumModule.id].isFormalLearning"> - {{\'student.result.informal\' | translate}}</span> </div> <div flex-offset-gt-sm="5"> <div ng-if="moduleResultById[module.curriculumModule.id] && moduleResultById[module.curriculumModule.id].grade \r\n            && positiveGrade(moduleResultById[module.curriculumModule.id].grade.code)" class="bold" md-colors="{color: \'green-600\'}">{{moduleResultById[module.curriculumModule.id].grade.value}} ({{moduleResultById[module.curriculumModule.id].credits}} {{\'student.result.ekap\' | translate}})</div> <div ng-if="moduleResultById[module.curriculumModule.id] && moduleResultById[module.curriculumModule.id].grade && \r\n            !positiveGrade(moduleResultById[module.curriculumModule.id].grade.code)" class="bold" md-colors="{color: \'red-500\'}">{{moduleResultById[module.curriculumModule.id].grade.value}} ({{moduleResultById[module.curriculumModule.id].credits}} {{\'student.result.ekap\' | translate}})</div> <div ng-if="(!moduleResultById[module.curriculumModule.id] || !moduleResultById[module.curriculumModule.id].grade) \r\n            && moduleBacklog(module) < 0" md-colors="{color: \'accent\'}"> {{moduleBacklog(module) | number: 1}} {{\'student.result.ekap\' | translate}}</div> <div ng-if="(!moduleResultById[module.curriculumModule.id] || (moduleResultById[module.curriculumModule.id] && !moduleResultById[module.curriculumModule.id].grade))\r\n            && moduleBacklog(module) >= 0" md-colors="{color: \'accent\'}"> {{\'student.result.moduleNotGraded\' | translate}}</div> </div> </div> </hois-collapsable-header> <md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'student.result.theme\' | translate}}</th> <th md-column>{{\'student.result.ekap\' | translate}}</th> <th md-column>{{\'student.result.grade\' | translate}}</th> <th md-column>{{\'student.result.date\' | translate}}</th> <th md-column>{{auth.higher ? (\'student.result.teacherHigher\' | translate) : (\'student.result.teacherVocational\' | translate)}}</th> <th md-column>{{\'student.result.isOk\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-class-odd="\'odd\'" ng-class-even="\'even\'" ng-repeat="row in module.themes | filter: filterReplacedThemes(module)" ng-include="\'student/templates/view.results.vocational.curriculumfulfillment.theme.tmpl.html\'"></tr> <tr md-row ng-class-odd="\'odd\'" ng-class-even="\'even\'" ng-repeat="row in module.otherCurriculumVersionModuleThemes" ng-include="\'student/templates/view.results.vocational.curriculumfulfillment.theme.tmpl.html\'"></tr> </tbody> </table> </md-table-container> <div class="md-body-2 bold" layout="row"> <div>{{\'student.result.totalRequired\' | translate}}: {{module.curriculumModule.credits}}</div> <div flex-offset="10">{{\'student.result.totalSubmitted\' | translate}}: {{moduleResultById[module.curriculumModule.id] ? moduleResultById[module.curriculumModule.id].totalSubmitted : 0}}</div> <div ng-if="!moduleResultById[module.curriculumModule.id] || module.curriculumModule.credits > moduleResultById[module.curriculumModule.id].totalSubmitted" flex-offset="10">{{\'student.result.difference\' | translate}}: <span md-colors="{color: \'warn-A400\'}">-{{(module.curriculumModule.credits - (moduleResultById[module.curriculumModule.id] ? moduleResultById[module.curriculumModule.id].totalSubmitted : 0)) | number: 1}}</span></div> <div ng-if="module.curriculumModule.credits <= moduleResultById[module.curriculumModule.id].totalSubmitted" flex-offset="10">{{\'student.result.difference\' | translate}}: {{(moduleResultById[module.curriculumModule.id] ? moduleResultById[module.curriculumModule.id].totalSubmitted : 0) - module.curriculumModule.credits}}</div> </div> <br><br> </hois-collapsable>'),a.put("student/templates/view.results.vocational.curriculumfulfillment.theme.tmpl.html","<td md-cell> <span ng-style=\"{'font-style': row.otherCurriculumVersionModuleTheme ? 'italic' : 'normal'}\"> <span ng-if=\"moduleResultById[module.curriculumModule.id].themeResultById[row.id].isApelTransfer\" class=\"apelAsterisk\">*</span> <span>{{row.nameEt}}</span> <span ng-if=\"moduleResultById[module.curriculumModule.id].themeResultById[row.id].isApelTransfer \r\n        && !moduleResultById[module.curriculumModule.id].themeResultById[row.id].isFormalLearning\"> - {{'student.result.informal' | translate}}</span> </span> </td> <td md-cell>{{row.credits}}</td> <td md-cell> <span ng-class=\"{badResult: !gradeUtil.isPositive(moduleResultById[module.curriculumModule.id].themeResultById[row.id].grade.code)}\"> {{moduleResultById[module.curriculumModule.id].themeResultById[row.id].grade.value}} </span> </td> <td md-cell>{{moduleResultById[module.curriculumModule.id].themeResultById[row.id].date | hoisDate}}</td> <td md-cell>{{displayTeachers(moduleResultById[module.curriculumModule.id].themeResultById[row.id].teachers)}}</td> <td md-cell>{{positiveThemeResult(moduleResultById[module.curriculumModule.id].themeResultById[row.id]) ? 'main.yes' : 'main.no' | translate}}</td>"),
a.put("student/templates/view.results.vocational.curriculumfulfillment.tmpl.html",'<div ng-repeat="module in ::vocationalResultsCurriculum.vocationalResultsModules"> <div ng-include="\'student/templates/view.results.vocational.curriculumfulfillment.list.tmpl.html\'"></div> </div> <div ng-repeat="result in ::vocationalResultsCurriculum.replacedModuleResults"> <div ng-include="\'student/templates/view.results.vocational.curriculumfulfillment.formallearning.tmpl.html\'"></div> </div> <div ng-if="vocationalResultsCurriculum.extraCurriculaVocationalResultsModules && vocationalResultsCurriculum.extraCurriculaVocationalResultsModules.length !== 0"> <h3>{{\'student.result.otherModuleResults\' | translate}}</h3> <div ng-repeat="module in ::vocationalResultsCurriculum.extraCurriculaVocationalResultsModules"> <div ng-include="\'student/templates/view.results.vocational.curriculumfulfillment.list.tmpl.html\'"></div> </div> </div> <div ng-repeat="result in ::vocationalResultsCurriculum.replacedExtraCurriculaModuleResults"> <div ng-include="\'student/templates/view.results.vocational.curriculumfulfillment.formallearning.tmpl.html\'"></div> </div> <div ng-if="vocationalResultsCurriculum.vocationalResultsModules && vocationalResultsCurriculum.vocationalResultsModules.length==0 && vocationalResultsCurriculum.extraCurriculaVocationalResultsModules && vocationalResultsCurriculum.extraCurriculaVocationalResultsModules.length === 0"> <span>{{\'student.result.missing\' | translate}}</span> </div>'),a.put("student/templates/view.results.vocational.orderofpassing.tmpl.html","<div ng-if=\"vocationalResultsPassing && vocationalResultsPassing.length!=0\"> <md-table-container> <table md-table class=\"secondary-table\"> <thead md-head> <tr md-row> <th md-column>{{'student.result.moduleTheme' | translate}}</th> <th md-column></th> <th md-column>{{'student.result.grade' | translate}}</th> <th md-column>{{'student.result.date' | translate}}</th> <th md-column>{{auth.higher ? ('student.result.teacherHigher' | translate) : ('student.result.teacherVocational' | translate)}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat=\"row in vocationalResultsPassing | orderBy: '-date'\" ng-class-odd=\"'odd'\" ng-class-even=\"'even'\"> <td md-cell> <span ng-if=\"row.isApel\" class=\"apelAsterisk\">*</span> <span ng-class=\"row.isModule ? 'md-body-2 bold' : ''\"> <span ng-if=\"row.isModule\">M: </span> <span>{{currentLanguageNameField(row.name)}}</span> </span> <span ng-if=\"row.isInformal\"> - {{'student.result.informal' | translate}}</span> </td> <td md-cell> <span ng-if=\"row.entryType\">{{currentLanguageNameField(row.entryType)}}</span> <span ng-if=\"row.isPractice\">{{'student.result.practice' | translate}}</span> </td> <td md-cell> <span ng-class=\"row.isModule ? 'md-body-2 bold' : ''\"> <span ng-class=\"{badResult: !gradeUtil.isPositive(row.grade.code)}\">{{row.grade.value}}</span> </span> </td> <td md-cell>{{row.date | hoisDate}}</td> <td md-cell>{{row.teachers}}</td> </tr> </tbody> </table> </md-table-container> </div> <div ng-if=\"vocationalResultsPassing && vocationalResultsPassing.length==0\"> <span>{{'student.result.missing' | translate}}</span> </div>"),a.put("student/templates/view.results.vocational.orderofstudyyear.tmpl.html",'<div ng-repeat="studyYearResult in vocationalResultsStudyYear"> <hois-collapsable label="currentLanguageNameField(studyYearResult.studyYear) + \' \' + (\'studyYear.label\' | translate)" expanded="false"> <md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'student.result.name\' | translate}}</th> <th md-column></th> <th md-column>{{\'student.result.grade\' | translate}}</th> <th md-column>{{\'student.result.date\' | translate}}</th> <th md-column>{{auth.higher ? (\'student.result.teacherHigher\' | translate) : (\'student.result.teacherVocational\' | translate)}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in studyYearResult.results" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell> <span ng-if="row.isApel" class="apelAsterisk">*</span> <span ng-class="row.isModule ? \'md-body-2 bold\' : \'\'"> <span ng-if="row.isModule">M: </span> <span>{{currentLanguageNameField(row.name)}}</span> </span> <span ng-if="row.isInformal"> - {{\'student.result.informal\' | translate}}</span> </td> <td md-cell> <span ng-if="row.entryType">{{currentLanguageNameField(row.entryType)}}</span> <span ng-if="row.isPractice">{{\'student.result.practice\' | translate}}</span> </td> <td md-cell> <span ng-class="row.isModule ? \'md-body-2 bold\' : \'\'"> <span ng-class="{badResult: !gradeUtil.isPositive(row.grade.code)}">{{row.grade.value}}</span> </span> </td> <td md-cell>{{row.date | hoisDate}}</td> <td md-cell>{{row.teachers}}</td> </tr> </tbody> </table> </md-table-container> <!-- \r\n    <div class="md-body-2 bold" layout="row">\r\n      <div>{{\'student.result.totalCredits\' | translate}}: {{studyYearResult.credits}}</div>\r\n      <div>{{\'student.result.kkh\' | translate}}: {{studyYearResult.kkh.toFixed(2)}}</div>\r\n    </div>\r\n    --> <br><br> </hois-collapsable> </div> <div ng-if="vocationalResultsStudyYear && vocationalResultsStudyYear.length==0"> <span>{{\'student.result.missing\' | translate}}</span> </div>'),a.put("student/templates/view.results.vocational.tmpl.html",'<div layout-padding ng-cloak class="form-readonly"> <div> <div layout="row" layout-xs="column" flex> <div flex="90"> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex> <label>{{\'student.label\' | translate}}</label> <hois-value value="student.person.firstname + \' \' + student.person.lastname"></hois-value> </md-input-container> <md-input-container flex flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'student.idcode\' | translate}}</label> <hois-value value="student.person.idcode"></hois-value> </md-input-container> <md-input-container flex flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'student.studyForm\' | translate}}</label> <hois-classifier-value ng-model="student.studyForm" main-classifier-code="OPPEVORM"></hois-classifier-value> </md-input-container> <md-input-container flex flex-offset="5" flex-offset-xs="0" flex-offset-sm="0" ng-if="student.speciality"> <label>{{\'studentGroup.speciality\' | translate}}</label> <hois-classifier-value ng-model="student.speciality" main-classifier-code="SPETSKUTSE"></hois-classifier-value> </md-input-container> </div> </div> </div> <div layout="row" layout-xs="column" flex> <div flex="90"> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex> <label>{{\'student.curriculum\' | translate}}</label> <hois-value value="currentLanguageNameField(student.curriculumVersion)"></hois-value> </md-input-container> <md-input-container flex flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'student.result.curriculumCredits\' | translate}}</label> <hois-value value="student.curriculumCredits != null ? student.curriculumCredits + \' EKAP\' : \'\'"></hois-value> </md-input-container> <md-input-container flex flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'student.result.totalCredits\' | translate}}</label> <hois-value value="student.credits != null ? student.credits + \' EKAP\' : \'\'"></hois-value> </md-input-container> <md-input-container flex flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'student.result.kkh\' | translate}}</label> <hois-value value="student.kkh"></hois-value> </md-input-container> <md-input-container flex flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <label>{{\'student.result.curriculumFulfilled\' | translate}}</label> <hois-value value="student.isCurriculumFulfilled ? (\'student.result.fulfilled\' | translate) : (\'student.result.notFulfilled\' | translate)"></hois-value> </md-input-container> </div> </div> </div> <div ng-controller="StudentViewResultsVocationalController as controller" ng-cloak> <md-content style="overflow: visible"> <md-table-container> <md-nav-bar md-selected-nav-item="resultsCurrentNavItem" nav-bar-aria-label="results selection" layout-margin> <md-nav-item md-nav-click="changeResultsCurrentNavItem(\'student.curriculumFulfillment\')" name="student.curriculumFulfillment"> {{\'student.result.curriculumFulfillment\' | translate}} </md-nav-item> <md-nav-item md-nav-click="changeResultsCurrentNavItem(\'student.inOrderOfStudyYear\')" name="student.inOrderOfStudyYear"> {{\'student.result.inOrderOfStudyYear\' | translate}} </md-nav-item> <md-nav-item md-nav-click="changeResultsCurrentNavItem(\'student.inOrderOfPassing\')" name="student.inOrderOfPassing"> {{\'student.result.inOrderOfPassing\' | translate}} </md-nav-item> <md-nav-item ng-if="canWatchStudentConnectedEntities" md-nav-click="changeResultsCurrentNavItem(\'student.journalsAndProtocols\')" name="student.journalsAndProtocols"> {{\'student.result.journalsAndProtocols\' | translate}} </md-nav-item> </md-nav-bar> </md-table-container> <div layout-margin> <div ng-show="resultsCurrentNavItem === \'student.curriculumFulfillment\'"> <div ng-include="\'student/templates/view.results.vocational.curriculumfulfillment.tmpl.html\'"></div> </div> <div ng-show="resultsCurrentNavItem === \'student.inOrderOfStudyYear\'"> <div ng-include="\'student/templates/view.results.vocational.orderofstudyyear.tmpl.html\'"></div> </div> <div ng-show="resultsCurrentNavItem === \'student.inOrderOfPassing\'"> <div ng-include="\'student/templates/view.results.vocational.orderofpassing.tmpl.html\'"></div> </div> <div ng-if="canWatchStudentConnectedEntities" ng-show="resultsCurrentNavItem === \'student.journalsAndProtocols\'"> <div ng-include="\'student/templates/journals.and.protocols.tmpl.html\'"></div> </div> </div> </md-content> </div> <div layout="row"> <a ng-href="{{supplementPreviewPdfUrl}}?isHigher=false" ng-if="supplementPreviewPdfUrl" target="_blank" class="md-button md-raised">{{\'student.result.supplementPreview\' | translate}}</a> </div> </div> </div>'),a.put("studyMaterial/templates/journal.material.edit.tmpl.html",'<fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'studyMaterial.label\' | translate}}</legend> <div layout="row" style="overflow: auto" layout-xs="column"> <md-button class="md-button md-raised" ng-href="/#/studyMaterial/vocational/{{journal.id}}/new">{{\'main.button.create\' | translate}}</md-button> <div class="middle-text">{{\'studyMaterial.orChooseExisting\' | translate}}</div> <hois-autocomplete flex ng-model="$parent.$parent.existingMaterial" method="studyMaterials" ha-controller="hAutocomplete" name="existingMaterial" label="studyMaterial.name" additional-query-params="{teacher: auth.teacher, journal: journal.id}" no-paging="true"></hois-autocomplete> <md-button class="md-button md-raised" ng-click="addExisting()" ng-disabled="!existingMaterial">{{\'main.button.add\' | translate}}</md-button> </div> <md-table-container> <table md-table class="secondary-table wide-table"> <thead md-head> <tr md-row> <th md-column>{{\'studyMaterial.type\' | translate}}</th> <th md-column>{{\'studyMaterial.name\' | translate}}</th> <th md-column>{{\'studyMaterial.fileorlink\' | translate}}</th> <th md-column>{{\'studyMaterial.isVisibleToStudents\' | translate}}</th> <th md-column>{{\'studyMaterial.isPublic\' | translate}}</th> <th md-column>{{\'studyMaterial.journalCount\' | translate}}</th> <th md-column></th> <th md-column ng-if="(auth.isAdmin() || auth.isTeacher()) && isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_OPPEMATERJAL\')"></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="material in materials | orderBy: \'id\'" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{currentLanguageNameField(material.typeCode)}}</td> <td md-cell> <a ng-href="/#/studyMaterial/vocational/{{journal.id}}/edit/{{material.id}}">{{currentLanguageNameField(material)}}</a> </td> <td md-cell ng-if="material.typeCode.code === \'OPPEMATERJAL_F\'"> <div layout="row" flex> <div>{{material.oisFile.fname}}</div> <div flex> <a ng-href="{{getFileUrl(material.oisFile, \'studymaterial\')}}" target="_blank" rel="noopener noreferrer"> <md-icon md-font-set="material-icons">file_download</md-icon> </a> </div> </div> </td> <td md-cell ng-if="material.typeCode.code === \'OPPEMATERJAL_L\'"> <a ng-href="{{material.url | hoisUrl}}" target="_blank" rel="noopener noreferrer">{{material.url}}</a> </td> <td md-cell> <md-checkbox ng-model="material.isVisibleToStudents" aria-label="isVisibleToStudents" disabled></md-checkbox> </td> <td md-cell> <md-checkbox ng-model="material.isPublic" aria-label="isVisibleToStudents" disabled></md-checkbox> </td> <td md-cell>{{material.journalCount}}</td> <td md-cell> <a class="remove nomargin" ng-click="deleteConnection(material.connect, material.journalCount)">&times;</a> </td> <td md-cell ng-if="(auth.isAdmin() || auth.isTeacher()) && isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_OPPEMATERJAL\')" style="white-space: nowrap"> <a ng-href="https://e-koolikott.ee/" target="_blank">{{\'studyMaterial.addESchoolBag\' | translate}}</a> </td> </tr> </tbody> </table> </md-table-container> </fieldset> <style>table.md-table.wide-table:not(.md-row-select) td.md-cell:nth-child(n+2):nth-last-child(n+2),\r\n  table.md-table.wide-table:not(.md-row-select) th.md-column:nth-child(n+2):nth-last-child(n+2) {\r\n    padding: 0 28px 0 0;\r\n  }\r\n\r\n  table.md-table.wide-table:not(.md-row-select) td.md-cell:last-child,\r\n  table.md-table.wide-table:not(.md-row-select) th.md-column:last-child {\r\n    padding: 0 8px 0 0;\r\n    width: 1%;\r\n  }</style>'),a.put("studyMaterial/templates/journal.material.view.tmpl.html",'<fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'studyMaterial.label\' | translate}}</legend> <md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'studyMaterial.type\' | translate}}</th> <th md-column>{{\'studyMaterial.name\' | translate}}</th> <th md-column>{{\'studyMaterial.fileorlink\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="material in materials | orderBy: \'id\'" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{currentLanguageNameField(material.typeCode)}}</td> <td md-cell>{{currentLanguageNameField(material)}}</td> <td md-cell ng-if="material.typeCode.code === \'OPPEMATERJAL_F\'"> <div layout="row" flex> <div>{{material.oisFile.fname}}</div> <div flex> <a ng-href="{{getFileUrl(material.oisFile, \'studymaterial\')}}" target="_blank" rel="noopener noreferrer"> <md-icon md-font-set="material-icons">file_download</md-icon> </a> </div> </div> </td> <td md-cell ng-if="material.typeCode.code === \'OPPEMATERJAL_L\'"> <a ng-href="{{material.url | hoisUrl}}" target="_blank" rel="noopener noreferrer">{{material.url}}</a> </td> </tr> </tbody> </table> </md-table-container> </fieldset>'),a.put("studyMaterial/templates/subjectStudyPeriod.material.edit.tmpl.html",'<fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'studyMaterial.label\' | translate}}</legend> <div layout="row"> <md-button class="md-button md-raised" ng-href="/#/studyMaterial/higher/{{subjectStudyPeriod.id}}/new">{{\'main.button.create\' | translate}}</md-button> <div class="middle-text">{{\'studyMaterial.orChooseExisting\' | translate}}</div> <hois-autocomplete flex ng-model="$parent.existingMaterial" method="studyMaterials" ha-controller="hAutocomplete" name="existingMaterial" label="studyMaterial.name" additional-query-params="{teacher: auth.teacher, subjectStudyPeriod: subjectStudyPeriod.id}" no-paging="true"></hois-autocomplete> <md-button class="md-button md-raised" ng-click="addExisting()" ng-disabled="!existingMaterial">{{\'main.button.add\' | translate}}</md-button> </div> <md-table-container> <table md-table class="secondary-table wide-table"> <thead md-head> <tr md-row> <th md-column>{{\'studyMaterial.type\' | translate}}</th> <th md-column>{{\'studyMaterial.name\' | translate}}</th> <th md-column>{{\'studyMaterial.fileorlink\' | translate}}</th> <th md-column>{{\'studyMaterial.isVisibleToStudents\' | translate}}</th> <th md-column>{{\'studyMaterial.isPublic\' | translate}}</th> <th md-column>{{\'studyMaterial.journalCount\' | translate}}</th> <th md-column></th> <th md-column ng-if="(auth.isAdmin() || auth.isTeacher()) && isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_OPPEMATERJAL\')"></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="material in materials | orderBy: \'id\'" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{currentLanguageNameField(material.typeCode)}}</td> <td md-cell> <a ng-href="/#/studyMaterial/higher/{{subjectStudyPeriod.id}}/edit/{{material.id}}">{{currentLanguageNameField(material)}}</a> </td> <td md-cell ng-if="material.typeCode.code === \'OPPEMATERJAL_F\'"> <div layout="row" flex> <div>{{material.oisFile.fname}}</div> <div flex> <a ng-href="{{getFileUrl(material.oisFile, \'studymaterial\')}}" target="_blank" rel="noopener noreferrer"> <md-icon md-font-set="material-icons">file_download</md-icon> </a> </div> </div> </td> <td md-cell ng-if="material.typeCode.code === \'OPPEMATERJAL_L\'"> <a ng-href="{{material.url | hoisUrl}}" target="_blank" rel="noopener noreferrer">{{material.url}}</a> </td> <td md-cell> <md-checkbox ng-model="material.isVisibleToStudents" aria-label="isVisibleToStudents" disabled></md-checkbox> </td> <td md-cell> <md-checkbox ng-model="material.isPublic" aria-label="isVisibleToStudents" disabled></md-checkbox> </td> <td md-cell>{{material.journalCount}}</td> <td md-cell> <a class="remove nomargin" ng-click="deleteConnection(material.connect, material.journalCount)">&times;</a> </td> <td md-cell ng-if="(auth.isAdmin() || auth.isTeacher()) && isAuthorized(\'ROLE_OIGUS_M_TEEMAOIGUS_OPPEMATERJAL\')" style="white-space: nowrap"> <a ng-href="https://e-koolikott.ee/" target="_blank">{{\'studyMaterial.addESchoolBag\' | translate}}</a> </td> </tr> </tbody> </table> </md-table-container> </fieldset> <style>table.md-table.wide-table:not(.md-row-select) td.md-cell:nth-child(n+2):nth-last-child(n+2),\r\n  table.md-table.wide-table:not(.md-row-select) th.md-column:nth-child(n+2):nth-last-child(n+2) {\r\n    padding: 0 28px 0 0;\r\n  }\r\n  \r\n  table.md-table.wide-table:not(.md-row-select) td.md-cell:last-child,\r\n  table.md-table.wide-table:not(.md-row-select) th.md-column:last-child {\r\n    padding: 0 8px 0 0;\r\n    width: 1%;\r\n  }</style>'),a.put("studyMaterial/templates/subjectStudyPeriod.material.view.tmpl.html",'<fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'studyMaterial.label\' | translate}}</legend> <md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'studyMaterial.type\' | translate}}</th> <th md-column>{{\'studyMaterial.name\' | translate}}</th> <th md-column>{{\'studyMaterial.fileorlink\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="material in materials | orderBy: \'id\'" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{currentLanguageNameField(material.typeCode)}}</td> <td md-cell>{{currentLanguageNameField(material)}}</td> <td md-cell ng-if="material.typeCode.code === \'OPPEMATERJAL_F\'"> <div layout="row" flex> <div>{{material.oisFile.fname}}</div> <div flex> <a ng-href="{{getFileUrl(material.oisFile, \'studymaterial\')}}" target="_blank" rel="noopener noreferrer"> <md-icon md-font-set="material-icons">file_download</md-icon> </a> </div> </div> </td> <td md-cell ng-if="material.typeCode.code === \'OPPEMATERJAL_L\'"> <a ng-href="{{material.url | hoisUrl}}" target="_blank" rel="noopener noreferrer">{{material.url}}</a> </td> </tr> </tbody> </table> </md-table-container> </fieldset>'),a.put("subjectProgram/dialog/subject.program.reject.dialog.html",'<md-dialog aria-label="reject dialog" flex="60" flex-xs="100"> <form name="dialogForm" ng-cloak> <md-dialog-content> <div class="ois-form-layout-padding nomargin" layout="column" ng-cloak> <p class="md-body-1">{{\'subjectProgram.operation.reject.message\' | translate}}</p> <md-input-container flex> <label>{{\'subjectProgram.rejectInfo\' | translate}}</label> <textarea ng-model="rejectInfo" md-maxlength="4000" max-rows="10" required></textarea> </md-input-container> </div> </md-dialog-content> <span flex></span> <md-dialog-actions layout="row" layout-align="start center"> <md-button class="md-raised md-primary" ng-click="rejectProgram()">{{"subjectProgram.operation.reject.label" | translate}}</md-button> <md-button class="md-raised" ng-click="cancel()">{{"main.button.close" | translate}}</md-button> </md-dialog-actions> </form> </md-dialog>'),a.put("subjectStudyPeriod/studentGroup/subject.study.period.student.group.edit.html",'<div class="ois-form-layout-padding" ng-cloak> <form name="subjectStudyPeriodStudentGroupEditForm"> <div layout="column"> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container ng-if="!isEditing" flex="25" flex-sm="100" flex-xs="100" class="readonly top-margin"> <label>{{\'subjectStudyPeriod.studyPeriod\' | translate}}</label> <hois-value value="currentLanguageNameField(studyPeriod)"></hois-value> </md-input-container> <md-input-container ng-if="isEditing" flex="25" flex-sm="100" flex-xs="100"> <label>{{\'subjectStudyPeriod.studyPeriod\' | translate}}</label> <hois-select ng-model="record.studyPeriod" values="studyPeriods" required sorted-query="true"></hois-select> </md-input-container> <md-input-container ng-if="isEditing" flex="25" flex-sm="100" flex-xs="100" flex-offset-xs="0" flex-offset-sm="0" flex-offset="5"> <label>{{\'subjectStudyPeriod.studentGroup\' | translate}}</label> <md-select ng-model="record.studentGroup" required> <md-option ng-value="option.id" ng-repeat="option in studentGroups"> {{ option.code }} </md-option> </md-select> </md-input-container> <md-input-container ng-if="!isEditing" flex="25" flex-sm="100" flex-xs="100" flex-offset-xs="0" flex-offset-sm="0" flex-offset="5" class="readonly top-margin"> <label>{{\'subjectStudyPeriod.studentGroup\' | translate}}</label> <hois-value value="studentGroup.code"></hois-value> </md-input-container> <md-input-container class="readonly top-margin" flex="25" flex-sm="100" flex-xs="100" flex-offset-xs="0" flex-offset-sm="0" flex-offset="5"> <label>{{\'subjectStudyPeriod.course\' | translate}}</label> <hois-value value="course"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column" class="form-readonly"> <md-input-container flex="25" flex-sm="100" flex-xs="100"> <label>{{\'subjectStudyPeriod.curriculum\' | translate}}</label> <hois-value value="curriculum.code + \' - \' + currentLanguageNameField(curriculum)"></hois-value> </md-input-container> <md-input-container flex="25" flex-sm="100" flex-xs="100" flex-offset-xs="0" flex-offset-sm="0" flex-offset="5"> <label>{{\'subjectStudyPeriod.curriculumStudyPeriod.label\' | translate}}</label> <hois-value value="\'subjectStudyPeriod.curriculumStudyPeriod.value\' | translate:curriculumStudyPeriod"></hois-value> </md-input-container> </div> <div flex="70" layout="row" class="common-label" md-colors="{color: \'background-400\'}"> <span ng-repeat="capacity in capacityTypes"> <span ng-if="!$first">|</span> {{capacity.value.toUpperCase()}} - {{currentLanguageNameField(capacity)}} </span> </div> <div>&nbsp;</div> <md-table-container> <table class="subject-study-period"> <thead> <tr> <th> <span>{{\'subjectStudyPeriod.subjects\' | translate}}</span> <a ng-href="#/subjectStudyPeriod/new?studentGroupId={{record.studentGroup}}&studyPeriodId={{record.studyPeriod}}" ng-if="record.studentGroup">{{\'subjectStudyPeriod.addSubjects\' | translate}}</a> </th> <th ng-repeat="capacityType in capacityTypes">{{capacityType.value.toUpperCase()}}</th> <th>{{\'subjectStudyPeriod.overall\' | translate}}</th> </tr> </thead> <tbody ng-repeat="subject in record.subjects"> <tr class="bold-top-line"> <td> <span class="bold">{{currentLanguageNameField(subject)}}</span> <a ng-href="#/subjectStudyPeriod/new?subjectId={{subject.id}}&studentGroupId={{record.studentGroup}}&studyPeriodId={{record.studyPeriod}}">{{\'subjectStudyPeriod.addTeachers\' | translate}}</a> </td> <td ng-repeat="type in capacityTypes">{{capacitiesUtil.getSubjectsCapacityByType(subject.id, type.code)}}</td> <td class="bold">{{capacitiesUtil.getSubjectsTotalCapacity(subject.id, capacityTypes)}}</td> </tr> <tr ng-repeat="ssp in record.subjectStudyPeriodDtos | filter:{ subject: subject.id }"> <td> <span ng-repeat="teacher in ssp.teachers" ng-class="{\'invalid\': !capacitiesUtil.teachersLoadOk(ssp)}"> <span ng-if="$index > 0">, </span> <span title="{{\'subjectStudyPeriod.teacherLoad\' | translate : teacherPlannedLoad(teacher) }}">{{teacher.name}}</span> </span> <i ng-if="ssp.capacityDiff || ssp.teachers.length > 1" class="material-icons pointer" title="{{\'subjectStudyPeriod.teacherSpecificLoads\' | translate}}" ng-click="teacherCapacities(ssp)">*</i> <span ng-if="ssp.groupProportion !== \'PAEVIK_GRUPI_JAOTUS_1\'"> <span class="subject-study-period-proportion">{{\'subjectStudyPeriod.proportion\' | translate | lowercase}}: <hois-classifier-value ng-model="ssp.groupProportion" main-classifier-code="PAEVIK_GRUPI_JAOTUS"></hois-classifier-value> </span> </span> <a ng-href="#/subjectStudyPeriod/{{ssp.id}}/edit?studentGroupId={{record.studentGroup}}">{{\'main.button.change\' | translate}}</a> </td> <td ng-repeat="type in capacityTypes"> <span ng-repeat="capacity in ssp.capacities | filter:{ capacityType: type.code } : true"> <input type="number" ng-model="capacity.hours" min="0" max="1000" aria-label="{{\'subjectStudyPeriod.changeLoad\' | translate}}" pattern="^\\d+$"> </span> </td> <td class="bold">{{capacitiesUtil.capacitiesSumBySsp(ssp)}}</td> </tr> <tr class="bold"> <td>{{\'subjectStudyPeriod.overall\' | translate}}</td> <td ng-repeat="type in capacityTypes">{{capacitiesUtil.capacitiesSumBySubjectAndType(subject.id, type.code)}}</td> <td class="bold">{{capacitiesUtil.capacitiesSumBySubject(subject.id)}}</td> </tr> </tbody> <tr class="bold bold-top-line" md-colors="{background: \'background-200\'}"> <td>{{\'subjectStudyPeriod.overall\' | translate | uppercase}}</td> <td ng-repeat="type in capacityTypes">{{capacitiesUtil.capacitiesSumByType(type.code)}}</td> <td>{{capacitiesUtil.capacitiesSumOverall()}}</td> </tr> </table> </md-table-container> <br> </div> <div layout="row"> <md-button class="md-raised md-primary" ng-click="save()">{{\'main.button.save\' | translate}}</md-button> <a ng-if="!isEditing" ng-href="{{excel(formState.xlsUrl, container)}}" target="_blank" class="md-button md-raised">{{\'main.button.printXls\' | translate}}</a> <md-button class="md-raised" ng-click="back(\'#/subjectStudyPeriods/studentGroups\', subjectStudyPeriodStudentGroupEditForm)">{{\'main.button.back\' | translate}}</md-button> </div> </form> </div> <style>tr.bold-top-line,\r\n    tr.bold-top-line td {\r\n        border-top: #525252 2px solid !important;\r\n    }\r\n    .subject-study-period td,\r\n    .subject-study-period th {\r\n        border-bottom: none !important;\r\n    }</style>'),a.put("subjectStudyPeriod/studentGroup/subject.study.period.student.group.search.html",'<md-nav-bar md-selected-nav-item="currentNavItem" aria-label="{{\'subjectStudyPeriod.label.options\' | translate}}"> <md-nav-item md-nav-href="#/subjectStudyPeriods/studentGroups?_menu" name="studentGroups">{{\'subjectStudyPeriod.label.studentGroups\' | translate}}</md-nav-item> <md-nav-item md-nav-href="#/subjectStudyPeriods/teachers?_menu" name="teachers">{{\'subjectStudyPeriod.label.teachers\' | translate}}</md-nav-item> <md-nav-item md-nav-href="#/subjectStudyPeriods/subjects?_menu" name="subjects">{{\'subjectStudyPeriod.label.subjects\' | translate}}</md-nav-item> </md-nav-bar> <div class="ois-form-layout-padding ois-form-layout" ng-cloak> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <form name="searchForm" ng-submit="load()" layout="column" novalidate> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="50" flex-sm="100" flex-xs="100"> <label>{{\'subjectStudyPeriod.studyPeriod\' | translate}}</label> <hois-select ng-model="criteria.studyPeriod" values="studyPeriods" required sorted-query="true"></hois-select> </md-input-container> <md-input-container flex="50" flex-sm="100" flex-xs="100" flex-offset-xs="0" flex-offset-sm="0" flex-offset="5"> <label>{{\'subjectStudyPeriod.department\' | translate}}</label> <hois-school-department-select ng-model="criteria.department"></hois-school-department-select> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <hois-autocomplete flex="50" flex-sm="100" flex-xs="100" ng-model="criteria.curriculum" display="display" ha-controller="directiveControllers" ha-search="searchCurriculums" label="subjectStudyPeriod.curriculum"></hois-autocomplete> <hois-autocomplete flex="50" flex-sm="100" flex-xs="100" flex-offset-xs="0" flex-offset-sm="0" flex-offset="5" ng-model="criteria.studentGroup" ha-attribute="id" ha-controller="directiveControllers" method="studentgroups" name="studentGroup" label="{{\'subjectStudyPeriod.studentGroup\'}}" additional-query-params="{higher: true, valid: true, curriculumId: criteria.curriculum}"></hois-autocomplete> </div> <div layout="row"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> <md-button class="md-raised" ng-if="canEdit" href="#/subjectStudyPeriods/studentGroups/new">{{\'main.button.create\' | translate}}</md-button> <a ng-href="{{excel(formState.xlsUrl, criteria)}}" target="_blank" class="md-button md-raised">{{\'main.button.printXls\' | translate}}</a> </div> </form> </fieldset> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="code">{{\'subjectStudyPeriod.studentGroupCode\' | translate}}</th> <th md-column md-order-by="curriculum.{{currentLanguageNameField()}}">{{\'subjectStudyPeriod.curriculum\' | translate}}</th> <th md-column>{{\'subjectStudyPeriod.hoursTotal\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell><a ng-href="#/subjectStudyPeriods/studentGroups/{{row.id}}/{{criteria.studyPeriod}}/view">{{row.code}}</a></td> <td md-cell>{{currentLanguageNameField(row.curriculum)}}</td> <td md-cell>{{row.hours}}</td> <td md-cell> <md-button md-no-ink class="md-primary change-button" ng-if="canEdit" ng-href="#/subjectStudyPeriods/studentGroups/{{row.id}}/{{criteria.studyPeriod}}/edit">{{\'main.button.change\' | translate}} </md-button> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> </div>'),a.put("subjectStudyPeriod/studentGroup/subject.study.period.student.group.view.html",'<div layout="column" layout-padding> <form name="subjectStudyPeriodPlanStudentGroupEditForm"> <div layout="column" class="form-readonly"> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="25" flex-sm="100" flex-xs="100"> <label>{{\'subjectStudyPeriod.studyPeriod\' | translate}}</label> <hois-value value="currentLanguageNameField(studyPeriod)"></hois-value> </md-input-container> <md-input-container ng-if="isEditing" flex="25" flex-sm="100" flex-xs="100" flex-offset-xs="0" flex-offset-sm="0" flex-offset="5"> <label>{{\'subjectStudyPeriod.studentGroup\' | translate}}</label> <md-select ng-model="record.studentGroup" required ng-disabled="studentGroupDisabled"> <md-option ng-value="option.id" ng-repeat="option in studentGroups"> {{ option.code }} </md-option> </md-select> </md-input-container> <md-input-container ng-if="!isEditing" flex="25" flex-sm="100" flex-xs="100" flex-offset-xs="0" flex-offset-sm="0" flex-offset="5"> <label>{{\'subjectStudyPeriod.studentGroup\' | translate}}</label> <hois-value value="studentGroup.code"></hois-value> </md-input-container> <md-input-container flex="25" flex-sm="100" flex-xs="100" flex-offset-xs="0" flex-offset-sm="0" flex-offset="5"> <label>{{\'subjectStudyPeriod.course\' | translate}}</label> <hois-value value="course"></hois-value> </md-input-container> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="25" flex-sm="100" flex-xs="100"> <label>{{\'subjectStudyPeriod.curriculum\' | translate}}</label> <hois-value value="curriculum.code + \' - \' + currentLanguageNameField(curriculum)"></hois-value> </md-input-container> <md-input-container flex="25" flex-sm="100" flex-xs="100" flex-offset-xs="0" flex-offset-sm="0" flex-offset="5"> <label>{{\'subjectStudyPeriod.curriculumStudyPeriod.label\' | translate}}</label> <hois-value value="\'subjectStudyPeriod.curriculumStudyPeriod.value\' | translate:curriculumStudyPeriod"></hois-value> </md-input-container> </div> <div flex="70" layout="row" class="common-label" md-colors="{color: \'background-400\'}"> <span ng-repeat="capacity in capacityTypes"> <span ng-if="!$first">|</span> {{capacity.value.toUpperCase()}} - {{currentLanguageNameField(capacity)}} </span> </div> <div>&nbsp;</div> <md-table-container> <table class="subject-study-period"> <thead> <tr> <th> <span>{{\'subjectStudyPeriod.subjects\' | translate}}</span> </th> <th ng-repeat="capacityType in capacityTypes">{{capacityType.value.toUpperCase()}}</th> <th>{{\'subjectStudyPeriod.overall\' | translate}}</th> </tr> </thead> <tbody ng-repeat="subject in record.subjects"> <tr class="bold-top-line"> <td class="bold"> <span>{{currentLanguageNameField(subject)}}</span> </td> <td ng-repeat="type in capacityTypes">{{capacitiesUtil.getSubjectsCapacityByType(subject.id, type.code)}}</td> <td>{{capacitiesUtil.getSubjectsTotalCapacity(subject.id, capacityTypes)}}</td> </tr> <tr ng-repeat="ssp in record.subjectStudyPeriodDtos | filter:{ subject: subject.id }"> <td> <span ng-repeat="teacher in ssp.teachers"> <span ng-if="$index > 0">, </span> <span title="{{\'subjectStudyPeriod.teacherLoad\' | translate : teacherPlannedLoad(teacher) }}">{{teacher.name}}</span> </span> <span ng-if="ssp.groupProportion !== \'PAEVIK_GRUPI_JAOTUS_1\'"> <span class="subject-study-period-proportion">{{\'subjectStudyPeriod.proportion\' | translate | lowercase}}: <hois-classifier-value ng-model="ssp.groupProportion" main-classifier-code="PAEVIK_GRUPI_JAOTUS"></hois-classifier-value> </span> </span> </td> <td ng-repeat="type in capacityTypes"> <span ng-repeat="capacity in ssp.capacities | filter:{ capacityType: type.code } : true"> <span>{{capacity.hours}}</span> </span> </td> <td>{{capacitiesUtil.capacitiesSumBySsp(ssp)}}</td> </tr> <tr class="bold"> <td>{{\'subjectStudyPeriod.overall\' | translate}}</td> <td ng-repeat="type in capacityTypes">{{capacitiesUtil.capacitiesSumBySubjectAndType(subject.id, type.code)}}</td> <td>{{capacitiesUtil.capacitiesSumBySubject(subject.id)}}</td> </tr> </tbody> <tr class="bold bold-top-line" md-colors="{background: \'background-200\'}"> <td>{{\'subjectStudyPeriod.overall\' | translate | uppercase}}</td> <td ng-repeat="type in capacityTypes">{{capacitiesUtil.capacitiesSumByType(type.code)}}</td> <td>{{capacitiesUtil.capacitiesSumOverall()}}</td> </tr> </table> </md-table-container> <br> </div> <div layout="row"> <md-button ng-if="!readOnly && canEdit" class="md-raised md-primary" ng-href="#/subjectStudyPeriods/studentGroups/{{record.studentGroup}}/{{studyPeriod.id}}/edit?_noback">{{\'main.button.change\' | translate}}</md-button> <a ng-if="auth.isAdmin() || auth.isTeacher()" ng-href="{{excel(formState.xlsUrl, container)}}" target="_blank" class="md-button md-raised">{{\'main.button.printXls\' | translate}}</a> <md-button class="md-raised" ng-click="back(\'#/subjectStudyPeriods/studentGroups\')">{{\'main.button.back\' | translate}}</md-button> </div> </form> </div> <style>tr.bold-top-line,\r\n    tr.bold-top-line td {\r\n        border-top: #525252 2px solid !important;\r\n    }\r\n    .subject-study-period td,\r\n    .subject-study-period th {\r\n        border-bottom: none !important;\r\n    }</style>'),
a.put("subjectStudyPeriod/subject/subject.study.period.subject.edit.html",'<div layout="column" layout-padding> <form name="subjectStudyPeriodSubjectEditForm"> <div layout="column" class="form-readonly"> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container ng-if="isNew" flex="25" flex-sm="100" flex-xs="100"> <label>{{\'subjectStudyPeriod.studyPeriod\' | translate}}</label> <hois-select ng-model="record.studyPeriod" values="studyPeriods" required sorted-query="true"></hois-select> </md-input-container> <md-input-container ng-if="!isNew" flex="25" flex-sm="100" flex-xs="100"> <label>{{\'subjectStudyPeriod.studyPeriod\' | translate}}</label> <hois-value value="currentLanguageNameField(studyPeriod)"></hois-value> </md-input-container> <md-input-container ng-if="isNew" flex="25" flex-sm="100" flex-xs="100" flex-offset-xs="0" flex-offset-sm="0" flex-offset="5"> <label>{{\'subjectStudyPeriod.subject\' | translate}}</label> <hois-select ng-model="record.subject" values="subjects" required></hois-select> </md-input-container> <md-input-container ng-if="!isNew" flex="25" flex-sm="100" flex-xs="100" flex-offset-xs="0" flex-offset-sm="0" flex-offset="5"> <label>{{\'subjectStudyPeriod.subject\' | translate}}</label> <hois-value value="subject.nameEt"></hois-value> </md-input-container> </div> <div flex="70" layout="row" class="common-label" md-colors="{color: \'background-400\'}"> <span ng-repeat="capacity in capacityTypes"> <span ng-if="!$first">|</span> {{capacity.value.toUpperCase()}} - {{currentLanguageNameField(capacity)}} </span> </div> <div>&nbsp;</div> <md-table-container> <table class="subject-study-period"> <thead> <tr> <th> <span>{{\'subjectStudyPeriod.teacher\' | translate}}</span> <a ng-href="#/subjectStudyPeriod/new?subjectId={{record.subject}}&studyPeriodId={{record.studyPeriod}}" ng-if="record.subject">{{\'subjectStudyPeriod.addTeachers\' | translate}}</a> </th> <th ng-repeat="capacityType in capacityTypes">{{capacityType.value.toUpperCase()}}</th> <th>{{\'subjectStudyPeriod.overall\' | translate}}</th> </tr> </thead> <tbody> <tr ng-repeat="ssp in record.subjectStudyPeriodDtos | filter:{ subject: subject.id }" ng-class="{\'bold-top-line\': $first}"> <td> <span ng-repeat="teacher in ssp.teachers" ng-class="{\'invalid\': !capacitiesUtil.teachersLoadOk(ssp)}"> <span ng-if="$index > 0">, </span> <span title="{{\'subjectStudyPeriod.teacherLoad\' | translate : teacherPlannedLoad(teacher) }}">{{teacher.name}}</span> </span> <i ng-if="ssp.capacityDiff || ssp.teachers.length > 1" class="material-icons pointer" title="{{\'subjectStudyPeriod.teacherSpecificLoads\' | translate}}" ng-click="teacherCapacities(ssp)">*</i> <span ng-show="ssp.studentGroupObjects && ssp.studentGroupObjects.length > 0"> ( <span ng-repeat="sg in ssp.studentGroupObjects"> <span ng-if="$index > 0">, </span> {{sg.nameEt}} </span> ) </span> <span ng-if="ssp.groupProportion !== \'PAEVIK_GRUPI_JAOTUS_1\'"> <span class="subject-study-period-proportion">{{\'subjectStudyPeriod.proportion\' | translate | lowercase}}: <hois-classifier-value ng-model="ssp.groupProportion" main-classifier-code="PAEVIK_GRUPI_JAOTUS"></hois-classifier-value> </span> </span> <a ng-href="#/subjectStudyPeriod/{{ssp.id}}/edit?subjectId={{record.subject}}">{{\'main.button.change\' | translate}}</a> </td> <td ng-repeat="type in capacityTypes"> <span ng-repeat="capacity in ssp.capacities | filter:{ capacityType: type.code } : true"> <input type="number" ng-model="capacity.hours" min="0" max="1000" aria-label="{{\'subjectStudyPeriod.changeLoad\' | translate}}" pattern="^\\d+$"> </span> </td> <td>{{capacitiesUtil.capacitiesSumBySsp(ssp)}}</td> </tr> </tbody> <tr class="bold bold-top-line" md-colors="{background: \'background-200\'}"> <td>{{\'subjectStudyPeriod.overall\' | translate | uppercase}}</td> <td ng-repeat="type in capacityTypes">{{capacitiesUtil.capacitiesSumByType(type.code)}}</td> <td>{{capacitiesUtil.capacitiesSumOverall()}}</td> </tr> </table> </md-table-container> <div>&nbsp;</div> </div> <div layout="row"> <md-button class="md-raised md-primary" ng-click="save()">{{\'main.button.save\' | translate}}</md-button> <a ng-if="!isNew" ng-href="{{excel(formState.xlsUrl, container)}}" target="_blank" class="md-button md-raised">{{\'main.button.printXls\' | translate}}</a> <md-button class="md-raised" ng-click="back(\'#/subjectStudyPeriods/subjects\', subjectStudyPeriodSubjectEditForm)">{{\'main.button.back\' | translate}}</md-button> </div> </form> </div> <style>tr.bold-top-line,\r\n    tr.bold-top-line td {\r\n        border-top: #525252 2px solid !important;\r\n    }\r\n    .subject-study-period td,\r\n    .subject-study-period th {\r\n        border-bottom: none !important;\r\n    }</style>'),a.put("subjectStudyPeriod/subject/subject.study.period.subject.search.html",'<md-nav-bar md-selected-nav-item="currentNavItem" aria-label="{{\'subjectStudyPeriod.label.options\' | translate}}"> <md-nav-item md-nav-href="#/subjectStudyPeriods/studentGroups?_menu" name="studentGroups">{{\'subjectStudyPeriod.label.studentGroups\' | translate}}</md-nav-item> <md-nav-item md-nav-href="#/subjectStudyPeriods/teachers?_menu" name="teachers">{{\'subjectStudyPeriod.label.teachers\' | translate}}</md-nav-item> <md-nav-item md-nav-href="#/subjectStudyPeriods/subjects?_menu" name="subjects">{{\'subjectStudyPeriod.label.subjects\' | translate}}</md-nav-item> </md-nav-bar> <div class="ois-form-layout-padding ois-form-layout" ng-cloak> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <form name="searchForm" ng-submit="load()" layout="column" novalidate> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="25" flex-sm="100" flex-xs="100"> <label>{{\'subjectStudyPeriod.studyPeriod\' | translate}}</label> <hois-select ng-model="criteria.studyPeriod" values="studyPeriods" required sorted-query="true"></hois-select> </md-input-container> <hois-autocomplete flex="25" flex-sm="100" flex-xs="100" flex-offset-xs="0" flex-offset-sm="0" flex-offset="5" ha-controller="directiveControllers" ng-model="criteria.teacherObject" url="/subjectStudyPeriods/teachers/page" name="teacher" label="subjectStudyPeriod.teacher"></hois-autocomplete> <hois-autocomplete flex="25" flex-sm="100" flex-xs="100" flex-offset-xs="0" flex-offset-sm="0" flex-offset="5" ha-controller="directiveControllers" ng-model="criteria.subjectObject" url="/autocomplete/subjects" name="subject" label="subjectStudyPeriod.subject"></hois-autocomplete> </div> <div layout="row"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> <md-button class="md-raised" ng-if="canEdit" href="#/subjectStudyPeriods/subjects/new">{{\'main.button.create\' | translate}}</md-button> <a ng-href="{{excel(formState.xlsUrl, criteria)}}" target="_blank" class="md-button md-raised">{{\'main.button.printXls\' | translate}}</a> </div> </form> </fieldset> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="code,{{currentLanguageNameField()}}">{{\'subjectStudyPeriod.nameCode\' | translate}}</th> <th md-column>{{\'subjectStudyPeriod.hoursTotal\' | translate}}</th> <th md-column>{{\'subjectStudyPeriod.teacher\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell><a ng-href="#/subjectStudyPeriods/subjects/{{row.subject.id}}/{{criteria.studyPeriod}}/view">{{currentLanguageNameField(row.subject)}}</a></td> <td md-cell>{{row.hours}}</td> <td md-cell> <table> <tr ng-repeat="teacher in row.teachers | orderBy"> <td>{{teacher}}</td> </tr> </table> </td> <td md-cell> <md-button md-no-ink class="md-primary change-button" ng-if="canEdit" ng-href="#/subjectStudyPeriods/subjects/{{row.subject.id}}/{{criteria.studyPeriod}}/edit">{{\'main.button.change\' | translate}} </md-button> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> </div>'),a.put("subjectStudyPeriod/subject/subject.study.period.subject.view.html",'<div layout="column" layout-padding> <form name="subjectStudyPeriodSubjectEditForm"> <div layout="column" class="form-readonly"> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="25" flex-sm="100" flex-xs="100"> <label>{{\'subjectStudyPeriod.studyPeriod\' | translate}}</label> <hois-value value="currentLanguageNameField(studyPeriod)"></hois-value> </md-input-container> <md-input-container flex="25" flex-sm="100" flex-xs="100" flex-offset-xs="0" flex-offset-sm="0" flex-offset="5"> <label>{{\'subjectStudyPeriod.subject\' | translate}}</label> <hois-value value="subject.nameEt"></hois-value> </md-input-container> </div> <div flex="70" layout="row" class="common-label" md-colors="{color: \'background-400\'}"> <span ng-repeat="capacity in capacityTypes"> <span ng-if="!$first">|</span> {{capacity.value.toUpperCase()}} - {{currentLanguageNameField(capacity)}} </span> </div> <div>&nbsp;</div> <md-table-container> <table class="subject-study-period"> <thead> <tr> <th> <span>{{\'subjectStudyPeriod.teacher\' | translate}}</span> </th> <th ng-repeat="capacityType in capacityTypes">{{capacityType.value.toUpperCase()}}</th> <th>{{\'subjectStudyPeriod.overall\' | translate}}</th> </tr> </thead> <tbody> <tr ng-repeat="ssp in record.subjectStudyPeriodDtos | filter:{ subject: subject.id }" ng-class="{\'bold-top-line\': $first}"> <td> <span ng-repeat="teacher in ssp.teachers" ng-class="{\'invalid\': !capacitiesUtil.teachersLoadOk(ssp)}"> <span ng-if="$index > 0">, </span> <span title="{{\'subjectStudyPeriod.teacherLoad\' | translate : teacherPlannedLoad(teacher) }}">{{teacher.name}}</span> </span> <span ng-show="ssp.studentGroupObjects && ssp.studentGroupObjects.length > 0"> ( <span ng-repeat="sg in ssp.studentGroupObjects"> <span ng-if="$index > 0">, </span> {{sg.nameEt}} </span> ) </span> <span ng-if="ssp.groupProportion !== \'PAEVIK_GRUPI_JAOTUS_1\'"> <span class="subject-study-period-proportion">{{\'subjectStudyPeriod.proportion\' | translate | lowercase}}: <hois-classifier-value ng-model="ssp.groupProportion" main-classifier-code="PAEVIK_GRUPI_JAOTUS"></hois-classifier-value> </span> </span> </td> <td ng-repeat="type in capacityTypes"> <span ng-repeat="capacity in ssp.capacities | filter:{ capacityType: type.code } : true"> <span>{{capacity.hours}}</span> </span> </td> <td>{{capacitiesUtil.capacitiesSumBySsp(ssp)}}</td> </tr> </tbody> <tr class="bold bold-top-line" md-colors="{background: \'background-200\'}"> <td>{{\'subjectStudyPeriod.overall\' | translate | uppercase}}</td> <td ng-repeat="type in capacityTypes">{{capacitiesUtil.capacitiesSumByType(type.code)}}</td> <td>{{capacitiesUtil.capacitiesSumOverall()}}</td> </tr> </table> </md-table-container> <div>&nbsp;</div> </div> <div layout="row"> <md-button ng-if="!readOnly && canEdit" class="md-raised md-primary" ng-href="#/subjectStudyPeriods/subjects/{{subject.id}}/{{studyPeriod.id}}/edit?_noback">{{\'main.button.change\' | translate}}</md-button> <a ng-if="auth.isAdmin() || auth.isTeacher()" ng-href="{{excel(formState.xlsUrl, container)}}" target="_blank" class="md-button md-raised">{{\'main.button.printXls\' | translate}}</a> <md-button class="md-raised" ng-click="back(\'#/subjectStudyPeriods/subjects\')">{{\'main.button.back\' | translate}}</md-button> </div> </form> </div> <style>tr.bold-top-line,\r\n    tr.bold-top-line td {\r\n        border-top: #525252 2px solid !important;\r\n    }\r\n    .subject-study-period td,\r\n    .subject-study-period th {\r\n        border-bottom: none !important;\r\n    }</style>'),a.put("subjectStudyPeriod/teacher/subject.study.period.teacher.edit.html",'<div layout="column" layout-padding> <form name="subjectStudyPeriodTeacherEditForm"> <div layout="column"> <div ng-if="isNew" layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="25" flex-sm="100" flex-xs="100"> <label>{{\'subjectStudyPeriod.studyPeriod\' | translate}}</label> <hois-select ng-model="record.studyPeriod" values="studyPeriods" required sorted-query="true"></hois-select> </md-input-container> <md-input-container flex="25" flex-sm="100" flex-xs="100" flex-offset-xs="0" flex-offset-sm="0" flex-offset="5"> <label>{{\'subjectStudyPeriod.teacher\' | translate}}</label> <hois-select ng-model="record.teacher" values="teachers" required></hois-select> </md-input-container> </div> <div ng-if="!isNew" layout="row" layout-sm="column" layout-xs="column" class="form-readonly"> <md-input-container flex="25" flex-sm="100" flex-xs="100"> <label>{{\'subjectStudyPeriod.studyPeriod\' | translate}}</label> <hois-value value="currentLanguageNameField(studyPeriod)"></hois-value> </md-input-container> <md-input-container flex="25" flex-sm="100" flex-xs="100" flex-offset-xs="0" flex-offset-sm="0" flex-offset="5"> <label>{{\'subjectStudyPeriod.teacher\' | translate}}</label> <hois-value value="teacher.nameEt"></hois-value> </md-input-container> </div> <div flex layout="row" layout-align="start start" class="common-label" md-colors="{color: \'background-400\'}"> <span ng-repeat="capacity in capacityTypes"> <span ng-if="$index !== 0">|</span> {{capacity.value.toUpperCase()}} - {{currentLanguageNameField(capacity)}} </span> </div> <div>&nbsp;</div> <md-table-container> <table class="subject-study-period"> <thead> <tr> <th> <span>{{\'subjectStudyPeriod.subjects\' | translate}}</span> <a ng-href="#/subjectStudyPeriod/new?teacherId={{record.teacher}}&studyPeriodId={{record.studyPeriod}}" ng-if="record.teacher">{{\'subjectStudyPeriod.addSubjects\' | translate}}</a> </th> <th ng-repeat="capacityType in capacityTypes">{{capacityType.value.toUpperCase()}}</th> <th>{{\'subjectStudyPeriod.overall\' | translate}}</th> </tr> </thead> <tbody ng-repeat="subject in record.subjects"> <tr class="bold-top-line"> <td class="bold"> <span>{{currentLanguageNameField(subject)}}</span> </td> <td ng-repeat="type in capacityTypes">{{capacitiesUtil.getSubjectsCapacityByType(subject.id, type.code)}}</td> <td>{{capacitiesUtil.getSubjectsTotalCapacity(subject.id, capacityTypes)}}</td> </tr> <tr ng-repeat="ssp in record.subjectStudyPeriodDtos | filter:{ subject: subject.id }"> <td> <div> <span ng-repeat="studentGroup in ssp.studentGroupObjects"> <span ng-if="$index > 0">, </span> {{studentGroup.nameEt}} </span> <i ng-if="ssp.capacityDiff"> <span>{{\'subjectStudyPeriod.teacherLoadDiffersFromPair\' | translate}}</span> </i> <span ng-if="ssp.groupProportion !== \'PAEVIK_GRUPI_JAOTUS_1\'"> <span class="subject-study-period-proportion">{{\'subjectStudyPeriod.proportion\' | translate | lowercase}}: <hois-classifier-value ng-model="ssp.groupProportion" main-classifier-code="PAEVIK_GRUPI_JAOTUS"></hois-classifier-value> </span> </span> <a ng-href="#/subjectStudyPeriod/{{ssp.id}}/edit?teacherId={{record.teacher}}">{{\'main.button.change\' | translate}}</a> </div> <div ng-if="ssp.capacityDiff" class="subject-study-period-period-total-label">{{\'subjectStudyPeriod.subjectTeacherPairTotal\' | translate}}</div> </td> <td ng-repeat="type in capacityTypes"> <span ng-if="!ssp.capacityDiff" ng-repeat="capacity in ssp.capacities | filter:{ capacityType: type.code } : true"> <input type="number" ng-model="capacity.hours" min="0" max="1000" aria-label="{{\'subjectStudyPeriod.changeLoad\' | translate}}" pattern="^\\d+$"> </span> <span ng-if="ssp.capacityDiff" ng-repeat="capacity in sspTeacherCapacities(ssp) | filter:{ capacityType: type.code } : true"> <input type="number" ng-model="capacity.hours" min="0" max="1000" aria-label="{{\'subjectStudyPeriod.changeLoad\' | translate}}" pattern="^\\d+$"> </span> <div ng-if="ssp.capacityDiff" ng-repeat="capacity in ssp.capacities | filter:{ capacityType: type.code } : true" class="subject-study-period-period-total">{{capacity.hours ? capacity.hours : 0}}</div> </td> <td> <div ng-if="ssp.capacityDiff">{{capacitiesUtil.capacitiesSumBySsp(ssp.teachers[0])}}</div> <div ng-class="{\'subject-study-period-period-total\': ssp.capacityDiff}">{{capacitiesUtil.capacitiesSumBySsp(ssp)}}</div> </td> </tr> <tr class="bold"> <td>{{\'subjectStudyPeriod.overall\' | translate}}</td> <td ng-repeat="type in capacityTypes">{{capacitiesUtil.capacitiesSumBySubjectAndType(subject.id, type.code, teacher.id)}}</td> <td>{{capacitiesUtil.capacitiesSumBySubject(subject.id, teacher.id)}}</td> </tr> </tbody> <tr class="bold bold-top-line" md-colors="{background: \'background-200\'}"> <td>{{\'subjectStudyPeriod.overall\' | translate | uppercase}}</td> <td ng-repeat="type in capacityTypes">{{capacitiesUtil.capacitiesSumByType(type.code, teacher.id)}}</td> <td>{{capacitiesUtil.capacitiesSumOverall(teacher.id)}}</td> </tr> </table> </md-table-container> <div>&nbsp;</div> </div> <div layout="row"> <md-button class="md-raised md-primary" ng-click="save()">{{\'main.button.save\' | translate}}</md-button> <a ng-if="!isNew" ng-href="{{excel(formState.xlsUrl, container)}}" target="_blank" class="md-button md-raised">{{\'main.button.printXls\' | translate}}</a> <md-button class="md-raised" ng-click="back(\'#/subjectStudyPeriods/teachers\', subjectStudyPeriodTeacherEditForm)">{{\'main.button.back\' | translate}}</md-button> </div> </form> </div> <style>tr.bold-top-line,\r\n    tr.bold-top-line td {\r\n        border-top: #525252 2px solid !important;\r\n    }\r\n    .subject-study-period td,\r\n    .subject-study-period th {\r\n        border-bottom: none !important;\r\n    }</style>'),a.put("subjectStudyPeriod/teacher/subject.study.period.teacher.search.html",'<md-nav-bar md-selected-nav-item="currentNavItem" aria-label="{{\'subjectStudyPeriod.label.options\' | translate}}"> <md-nav-item md-nav-href="#/subjectStudyPeriods/studentGroups?_menu" name="studentGroups">{{\'subjectStudyPeriod.label.studentGroups\' | translate}}</md-nav-item> <md-nav-item md-nav-href="#/subjectStudyPeriods/teachers?_menu" name="teachers">{{\'subjectStudyPeriod.label.teachers\' | translate}}</md-nav-item> <md-nav-item md-nav-href="#/subjectStudyPeriods/subjects?_menu" name="subjects">{{\'subjectStudyPeriod.label.subjects\' | translate}}</md-nav-item> </md-nav-bar> <div class="ois-form-layout-padding ois-form-layout" ng-cloak> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <form name="searchForm" ng-submit="load()" layout="column" novalidate> <div layout="row" layout-sm="column" layout-xs="column"> <md-input-container flex="50" flex-sm="100" flex-xs="100"> <label>{{\'subjectStudyPeriod.studyPeriod\' | translate}}</label> <hois-select ng-model="criteria.studyPeriod" values="studyPeriods" required sorted-query="true"></hois-select> </md-input-container> <hois-autocomplete flex="50" flex-sm="100" flex-xs="100" flex-offset-xs="0" flex-offset-sm="0" flex-offset="5" ha-controller="directiveControllers" ng-model="criteria.teacherObject" url="/subjectStudyPeriods/teachers/page" name="teacher" label="subjectStudyPeriod.teacher"></hois-autocomplete> </div> <div layout="row"> <md-button type="submit" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearCriteria()">{{\'main.button.clear\' | translate}}</md-button> <md-button class="md-raised" ng-if="canEdit" href="#/subjectStudyPeriods/teachers/new">{{\'main.button.create\' | translate}}</md-button> <a ng-href="{{excel(formState.xlsUrl, criteria)}}" target="_blank" class="md-button md-raised">{{\'main.button.printXls\' | translate}}</a> </div> </form> </fieldset> </div> <div layout-padding> <div flex> <md-table-container> <table md-table md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="person.lastname,person.firstname">{{\'subjectStudyPeriod.teacher\' | translate}}</th> <th md-column>{{\'subjectStudyPeriod.hoursTotal\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell><a ng-href="#/subjectStudyPeriods/teachers/{{row.id}}/{{criteria.studyPeriod}}/view">{{row.name}}</a></td> <td md-cell>{{row.hours}}</td> <td md-cell> <md-button md-no-ink class="md-primary change-button" ng-if="canEdit" ng-href="#/subjectStudyPeriods/teachers/{{row.id}}/{{criteria.studyPeriod}}/edit"> {{\'main.button.change\' | translate}} </md-button> </td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\'}" md-page-select></md-table-pagination> </div> </div>'),a.put("subjectStudyPeriod/teacher/subject.study.period.teacher.view.html",'<div layout="column" layout-padding> <form name="subjectStudyPeriodTeacherEditForm"> <div layout="column"> <div layout="row" layout-sm="column" layout-xs="column" class="form-readonly"> <md-input-container flex="25" flex-sm="100" flex-xs="100"> <label>{{\'subjectStudyPeriod.studyPeriod\' | translate}}</label> <hois-value value="currentLanguageNameField(studyPeriod)"></hois-value> </md-input-container> <md-input-container flex="25" flex-sm="100" flex-xs="100" flex-offset-xs="0" flex-offset-sm="0" flex-offset="5"> <label>{{\'subjectStudyPeriod.teacher\' | translate}}</label> <hois-value value="teacher.nameEt"></hois-value> </md-input-container> </div> <div flex="70" layout="row" class="common-label" md-colors="{color: \'background-400\'}"> <span ng-repeat="capacity in capacityTypes"> <span ng-if="!$first">|</span> {{capacity.value.toUpperCase()}} - {{currentLanguageNameField(capacity)}} </span> </div> <div>&nbsp;</div> <md-table-container> <table class="subject-study-period"> <thead> <tr> <th> <span>{{\'subjectStudyPeriod.subjects\' | translate}}</span> </th> <th ng-repeat="capacityType in capacityTypes">{{capacityType.value.toUpperCase()}}</th> <th>{{\'subjectStudyPeriod.overall\' | translate}}</th> </tr> </thead> <tbody ng-repeat="subject in record.subjects"> <tr class="bold-top-line"> <td class="bold"> <span>{{currentLanguageNameField(subject)}}</span> </td> <td ng-repeat="type in capacityTypes">{{capacitiesUtil.getSubjectsCapacityByType(subject.id, type.code)}}</td> <td>{{capacitiesUtil.getSubjectsTotalCapacity(subject.id, capacityTypes)}}</td> </tr> <tr ng-repeat="ssp in record.subjectStudyPeriodDtos | filter:{ subject: subject.id }"> <td> <div> <span ng-repeat="studentGroup in ssp.studentGroupObjects"> <span ng-if="$index > 0">, </span> {{studentGroup.nameEt}} </span> <i ng-if="ssp.capacityDiff"> <span>{{\'subjectStudyPeriod.teacherLoadDiffersFromPair\' | translate}}</span> </i> <span ng-if="ssp.groupProportion !== \'PAEVIK_GRUPI_JAOTUS_1\'"> <span class="subject-study-period-proportion">{{\'subjectStudyPeriod.proportion\' | translate | lowercase}}: <hois-classifier-value ng-model="ssp.groupProportion" main-classifier-code="PAEVIK_GRUPI_JAOTUS"></hois-classifier-value> </span> </span> </div> <div ng-if="ssp.capacityDiff" class="subject-study-period-period-total-label">{{\'subjectStudyPeriod.subjectTeacherPairTotal\' | translate}}</div> </td> <td ng-repeat="type in capacityTypes"> <div> <span ng-if="!ssp.capacityDiff" ng-repeat="capacity in ssp.capacities | filter:{ capacityType: type.code } : true"> <span>{{capacity.hours}}</span> </span> <span ng-if="ssp.capacityDiff" ng-repeat="capacity in sspTeacherCapacities(ssp) | filter:{ capacityType: type.code } : true"> <span>{{capacity.hours ? capacity.hours : \'&nbsp;\'}}</span> </span> </div> <div ng-if="ssp.capacityDiff" ng-repeat="capacity in ssp.capacities | filter:{ capacityType: type.code } : true" class="subject-study-period-period-total">{{capacity.hours ? capacity.hours : 0}}</div> </td> <td> <div ng-if="ssp.capacityDiff">{{capacitiesUtil.capacitiesSumBySsp(ssp.teachers[0])}}</div> <div ng-class="{\'subject-study-period-period-total\': ssp.capacityDiff}">{{capacitiesUtil.capacitiesSumBySsp(ssp)}}</div> </td> </tr> <tr class="bold"> <td>{{\'subjectStudyPeriod.overall\' | translate}}</td> <td ng-repeat="type in capacityTypes">{{capacitiesUtil.capacitiesSumBySubjectAndType(subject.id, type.code, teacher.id)}}</td> <td>{{capacitiesUtil.capacitiesSumBySubject(subject.id, teacher.id)}}</td> </tr> </tbody> <tr class="bold bold-top-line" md-colors="{background: \'background-200\'}"> <td>{{\'subjectStudyPeriod.overall\' | translate | uppercase}}</td> <td ng-repeat="type in capacityTypes">{{capacitiesUtil.capacitiesSumByType(type.code, teacher.id)}}</td> <td>{{capacitiesUtil.capacitiesSumOverall(teacher.id)}}</td> </tr> </table> </md-table-container> <div>&nbsp;</div> </div> <div layout="row"> <md-button ng-if="canEdit" class="md-raised md-primary" ng-href="#/subjectStudyPeriods/teachers/{{teacher.id}}/{{studyPeriod.id}}/edit?_noback">{{\'main.button.change\' | translate}}</md-button> <a ng-if="auth.isAdmin() || auth.isTeacher()" ng-href="{{excel(formState.xlsUrl, container)}}" target="_blank" class="md-button md-raised">{{\'main.button.printXls\' | translate}}</a> <md-button class="md-raised" ng-click="back(\'#/subjectStudyPeriods/teachers\')">{{\'main.button.back\' | translate}}</md-button> </div> </form> </div> <style>tr.bold-top-line,\r\n    tr.bold-top-line td {\r\n        border-top: #525252 2px solid !important;\r\n    }\r\n    .subject-study-period td,\r\n    .subject-study-period th {\r\n        border-bottom: none !important;\r\n    }</style>'),a.put("timetable/dialog/export.result.dialog.html",'<md-dialog aria-label="add enterprise dialog" flex="50"> <md-dialog-content> <div class="ois-form-layout" layout="column" layout-margin ng-cloak> <div layout="row"> <p md-colors="{color: \'red\'}" class="md-title-small" style="margin-bottom: 0px">{{"timetable.exportDialog.error" | translate}}</p> </div> <div ng-if="timetable.teachers !== null && timetable.teachers.length !== 0"> <p md-colors="{color: \'red\'}" class="md-title-small">{{\'timetable.exportDialog.missingJournalTeacherCodes\' | translate}}:</p> <md-table-container style="max-height: 400px"> <table md-table> <tbody md-body> <tr md-row ng-repeat="row in timetable.teachers" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell width="10%">{{$index + 1}}.</td> <td md-cell>{{row ? row : \'-\'}}</td> </tr> </tbody> </table> </md-table-container> </div> <div ng-if="timetable.journals !== null && timetable.journals.length !== 0"> <p md-colors="{color: \'red\'}" class="md-title-small">{{\'timetable.exportDialog.missingJournalCodes\' | translate}}:</p> <md-table-container style="max-height: 400px"> <table md-table> <tbody md-body> <tr md-row ng-repeat="row in timetable.journals" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell width="10%">{{$index + 1}}.</td> <td md-cell>{{row ? row : \'-\'}}</td> </tr> </tbody> </table> </md-table-container> </div> </div> </md-dialog-content> <md-dialog-actions layout="row" layout-align="start start"> <md-button class="md-raised md-primary" ng-click="cancel()">{{"main.button.close" | translate}}</md-button> </md-dialog-actions> </md-dialog>'),a.put("timetable/dialog/file.import.dialog.html",'<md-dialog aria-label="file add dialog" flex="40" flex-xs="100"> <form name="dialogForm" ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2>{{\'timetable.management.importXml\' | translate}}</h2> <span flex></span> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <span flex></span> <div class="ois-form-layout" layout="column" layout-margin ng-cloak> <div layout="column"> <md-input-container flex> <lf-ng-md-file-input name="file" lf-files="data.file" lf-browse-label="{{\'main.addFile\' | translate}}" lf-remove-label="{{\'main.button.delete\' | translate}}" lf-placeholder="" lf-required lf-filesize="10MB"> </lf-ng-md-file-input> </md-input-container> <div ng-messages="dialogForm.file.$error"> <div class="invalid" ng-message="required">{{\'main.messages.error.selectFile\' | translate}}</div> <div ng-message="filesize" class="invalid">{{\'curriculum.error.fileSize\' | translate}}</div> </div> </div> </div> </md-dialog-content> <span flex></span> <md-dialog-actions layout="row" layout-align="start center"> <md-button class="md-raised md-primary" ng-click="submit()">{{"main.button.save" | translate}}</md-button> <md-button class="md-raised" ng-click="cancel()">{{"main.button.close" | translate}}</md-button> </md-dialog-actions> </form> </md-dialog>'),a.put("timetable/dialog/import.result.dialog.html",'<md-dialog aria-label="add enterprise dialog" flex="50"> <md-toolbar> <div class="md-toolbar-tools"> <h2 flex>{{"timetable.importDialog.label" | translate}}</h2> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <div class="ois-form-layout" layout="column" layout-margin ng-cloak> <div ng-if="timetable.errors !== null && timetable.errors.length !== 0"> <md-table-container style="max-height: 400px"> <table md-table> <thead md-head> <tr md-row> <th md-column>{{\'journal.label\' | translate}}</th> <th md-column>{{\'enterprise.csv.note\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="row in timetable.errors" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{row.name ? row.name : \'-\'}}</td> <td md-cell>{{row.code ? (row.code | translate) : \'-\'}}</td> </tr> </tbody> </table> </md-table-container> </div> </div> </md-dialog-content> <md-dialog-actions layout="row" layout-align="start start"> <md-button class="md-raised md-primary" ng-click="cancel()">{{"main.button.close" | translate}}</md-button> </md-dialog-actions> </md-dialog>'),a.put("timetable/generalTimetable/timetable.generalTimetable.html",'<div ng-include="\'timetable/generalTimetable/timetable.generalTimetable.navbar.html\'"></div> <div> <div ng-show="studyYears"> <div layout="row" layout-sm="column" layout-xs="column" layout-margin> <md-autocomplete ng-if="currentNavItem === \'group\'" flex="45" flex-sm="100" flex-xs="100" md-search-text="searchText" md-min-length="1" md-items="item in getStudentGroups(searchText)" md-item-text="item.groupCode" md-selected-item="criteria.selectedTimetable" md-selected-item-change="showTypeWeek(item.groupId)" md-floating-label="{{\'timetable.search.studentGroup\' | translate}}" md-require-match md-no-cache> <md-item-template> <span md-highlight-text="searchText">{{item.groupCode}}</span> </md-item-template> </md-autocomplete> <md-autocomplete ng-if="currentNavItem === \'teacher\'" flex="45" flex-sm="100" flex-xs="100" md-search-text="searchText" md-min-length="1" md-items="item in getTeachers(searchText)" md-item-text="item.firstname + \' \' + item.lastname" md-selected-item="criteria.selectedTimetable" md-selected-item-change="showTypeWeek(item.teacherId)" md-floating-label="{{auth.higher ? (\'timetable.search.teacherHigher\' | translate) : (\'timetable.search.teacherVocational\' | translate)}}" md-require-match md-no-cache> <md-item-template> <span md-highlight-text="searchText">{{item.firstname}} {{item.lastname}}</span> </md-item-template> </md-autocomplete> <md-autocomplete ng-if="currentNavItem === \'room\'" flex="45" flex-sm="100" flex-xs="100" md-search-text="searchText" md-min-length="1" md-items="item in getRooms(searchText)" md-item-text="item.code" md-selected-item="criteria.selectedTimetable" md-selected-item-change="showTypeWeek(item.roomId)" md-floating-label="{{\'timetable.search.room\' | translate}}" md-require-match md-no-cache> <md-item-template> <span md-highlight-text="searchText">{{item.code}}</span> </md-item-template> </md-autocomplete> <div layout="column" class="form-readonly" flex="50" flex-sm="100" flex-offset="5" flex-offset-xs="0" flex-offset-sm="0"> <div>&nbsp;</div> <md-input-container> <label class="textInput">{{\'timetable.search.studyYear\' | translate}}</label> <div class="md-body-1 hois-value"> <span ng-repeat="sy in studyYears | orderBy: \'startDate\'"> <a ng-click="changeStudyYear(sy)" ng-style="{\'font-weight\': criteria.studyYearId === sy.id ? \'bold\' : \'normal\'}">{{currentLanguageNameField(sy)}}</a> <span>&nbsp;</span> </span> </div> </md-input-container> </div> </div> </div> <div ng-controller="TimetableWeekViewController"> <div ng-include="\'timetable/generalTimetable/timetable.week.view.html\'"></div> </div> </div>'),
a.put("timetable/generalTimetable/timetable.generalTimetable.navbar.html","<md-nav-bar hide-xs md-selected-nav-item=\"currentNavItem\" aria-label=\"{{auth.higher ? ('timetable.optionsHigher' | translate) : ('timetable.optionsVocational' | translate)}}\"> <md-nav-item ng-if=\"auth && (auth.isStudent() || auth.isTeacher())\" md-nav-href=\"#/timetable/personalGeneralTimetable?_menu\" name=\"personal\"> {{'timetable.myTimetable' | translate}}</md-nav-item> <md-nav-item ng-if=\"auth && auth.isParent()\" md-nav-href=\"#/timetable/personalGeneralTimetable?_menu\" name=\"personal\"> {{'timetable.parentTimetable' | translate}}</md-nav-item> <md-nav-item md-nav-href=\"{{'#/timetable/' + (schoolParam = auth && auth.schoolId ? '' : schoolId + '/') + 'generalTimetable/group?_menu'}}\" name=\"group\">{{'timetable.studentGroups' | translate}}</md-nav-item> <md-nav-item md-nav-href=\"{{'#/timetable/' + schoolParam + 'generalTimetable/teacher'}}\" name=\"teacher\"> {{auth.higher ? ('timetable.teachersHigher' | translate) : ('timetable.teachersVocational' | translate)}} </md-nav-item> <md-nav-item md-nav-href=\"{{'#/timetable/' + schoolParam + 'generalTimetable/room'}}\" name=\"room\">{{'timetable.rooms' | translate}}</md-nav-item> <md-nav-item md-nav-href=\"{{'#/timetable/' + schoolParam + 'searchGeneralTimetable'}}\" name=\"search\"> <md-icon md-font-set=\"material-icons\" ng-style=\"currentNavItem === 'search' ? {'color': 'rgb(13,71,161)'} : {'color': 'rgba(0,0,0,0.54)'}\">search</md-icon> </md-nav-item> </md-nav-bar> <div hide-gt-xs layout=\"column\"> <md-button ng-if=\"auth && (auth.isStudent() || auth.isTeacher())\" class=\"md-raised\" flex ng-href=\"#/timetable/personalGeneralTimetable?_menu\" ng-class=\"{'md-accent': currentNavItem === 'personal'}\" name=\"personal\">{{'timetable.myTimetable' | translate}}</md-button> <md-button class=\"md-raised\" ng-if=\"auth && auth.isParent()\" ng-href=\"#/timetable/personalGeneralTimetable?_menu\" ng-class=\"{'md-accent': currentNavItem === 'personal'}\" name=\"personal\">{{'timetable.parentTimetable' | translate}}</md-button> <md-button class=\"md-raised\" ng-href=\"{{'#/timetable/' + (schoolParam = auth && auth.schoolId ? '' : schoolId + '/') + 'generalTimetable/group?_menu'}}\" ng-class=\"{'md-accent': currentNavItem === 'studentGroup'}\" name=\"group\">{{'timetable.studentGroups' | translate}}</md-button> <md-button class=\"md-raised\" ng-href=\"{{'#/timetable/' + schoolParam + 'generalTimetable/teacher'}}\" ng-class=\"{'md-accent': currentNavItem === 'teacher'}\" name=\"teacher\"> {{auth.higher ? ('timetable.teachersHigher' | translate) : ('timetable.teachersVocational' | translate)}} </md-button> <md-button class=\"md-raised\" ng-href=\"{{'#/timetable/' + schoolParam + 'generalTimetable/room'}}\" ng-class=\"{'md-accent': currentNavItem === 'room'}\" name=\"room\">{{'timetable.rooms' | translate}}</md-button> <md-button class=\"md-raised\" ng-class=\"{'md-accent': currentNavItem === 'search'}\" ng-href=\"{{'#/timetable/' + schoolParam + 'searchGeneralTimetable'}}\" name=\"student.timetable\"> <md-icon md-font-set=\"material-icons\">search</md-icon> </md-button> </div>"),a.put("timetable/generalTimetable/timetable.generalTimetable.personal.html",'<div ng-include="\'timetable/generalTimetable/timetable.generalTimetable.navbar.html\'"></div> <div> <div layout="row" layout-sm="column" layout-xs="column" layout-margin> <div layout="column" class="form-readonly" flex="50" flex-sm="100" flex-offset="50" flex-offset-xs="0" flex-offset-sm="0"> <div>&nbsp;</div> <md-input-container> <label class="textInput">{{\'timetable.search.studyYear\' | translate}}</label> <div class="md-body-1 hois-value"> <span ng-repeat="sy in studyYears | orderBy: \'startDate\'"> <a ng-click="changeStudyYear(sy)" ng-style="{\'font-weight\': criteria.studyYearId === sy.id ? \'bold\' : \'normal\'}"> {{currentLanguageNameField(sy)}}</a> <span>&nbsp;</span> </span> </div> </md-input-container> </div> </div> <div ng-if="auth.isStudent() || auth.isParent()" ng-controller="TimetableWeekViewController"> <div ng-include="\'timetable/generalTimetable/timetable.week.view.html\'"></div> </div> <div ng-if="auth.isTeacher()" ng-controller="TimetableWeekViewController"> <div ng-include="\'timetable/generalTimetable/timetable.week.view.html\'"></div> </div> </div>'),a.put("timetable/generalTimetable/timetable.generalTimetable.school.list.html",'<div layout-padding class="schoolList"> <md-grid-list md-cols="1" md-cols-sm="2" md-cols-md="3" md-cols-gt-md="6" md-row-height-gt-md="1:1" md-row-height="4:3" md-gutter="24px" md-gutter-gt-sm="24px"> <md-grid-tile ng-repeat="school in schools" md-colspan="1"> <button class="schoolTileButton" ng-click="openSchoolGeneralTimetable(school.id)"> <img class="schoolTileImage" ng-src="data:image/JPEG;base64,{{school.logo}}" on-error-src="images/HITSA_innov_logo_03.4e2f45c0.png"> <md-grid-tile-footer class="schoolTileFooter"> <span>{{currentLanguageNameField(school)}}</span> </md-grid-tile-footer> </button> </md-grid-tile> </md-grid-list> </div>'),a.put("timetable/generalTimetable/timetable.generalTimetable.search.html",'<div ng-include="\'timetable/generalTimetable/timetable.generalTimetable.navbar.html\'"></div> <div class="ois-form-layout-padding ois-form-layout" ng-cloak> <div flex> <fieldset> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'main.searchlabel\' | translate}}</legend> <form name="timetableSearchForm" ng-submit="loadData()" novalidate class="nomargin"> <div layout="row" layout-sm="column" layout-xs="column"> <div layout="column" class="form-readonly" flex="45" flex-sm="100" flex-xs="100"> <div>&nbsp;</div> <md-input-container> <label class="textInput">{{\'timetable.search.studyYear\' | translate}}</label> <div class="md-body-1 hois-value"> <span ng-repeat="sy in studyYears | orderBy: \'startDate\'"> <a ng-style="{\'font-weight\': criteria.studyYearId === sy.id ? \'bold\' : \'normal\'}" ng-click="changeStudyYear(sy)">{{currentLanguageNameField(sy)}}</a> <span>&nbsp;</span> </span> </div> </md-input-container> </div> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-autocomplete flex="45" flex-sm="100" flex-xs="100" md-search-text="teacherSearchText" md-selected-item="criteria.teacherObject" md-items="item in parameterSearch(teacherSearchText, formState.teachers)" md-item-text="currentLanguageNameField(item)" md-selected-item-change="selectedTeacherChanged(item)" md-min-length="1" md-floating-label="{{auth.higher ? (\'timetable.search.teacherHigher\' | translate) : (\'timetable.search.teacherVocational\' | translate)}}" md-require-match md-no-cache> <md-item-template> <span md-highlight-text="teacherSearchText">{{currentLanguageNameField(item)}}</span> </md-item-template> </md-autocomplete> <md-autocomplete flex="50" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-sm="0" flex-offset-xs="0" md-search-text="studentGroupSearchText" md-selected-item="criteria.studentGroupObject" md-items="item in parameterSearch(studentGroupSearchText, formState.studentGroups)" md-item-text="currentLanguageNameField(item)" md-selected-item-change="selectedStudentGroupChanged(item)" md-min-length="1" md-floating-label="{{\'timetable.search.studentGroup\' | translate}}" md-require-match md-no-cache> <md-item-template> <span md-highlight-text="studentGroupSearchText">{{currentLanguageNameField(item)}}</span> </md-item-template> </md-autocomplete> </div> <div layout="row" layout-sm="column" layout-xs="column"> <md-autocomplete flex="45" flex-sm="100" flex-xs="100" md-search-text="roomSearchText" md-selected-item="criteria.roomObject" md-items="item in parameterSearch(roomSearchText, formState.rooms)" md-item-text="currentLanguageNameField(item)" md-selected-item-change="selectedRoomChanged(item)" md-min-length="1" md-floating-label="{{\'timetable.search.room\' | translate}}" md-require-match md-no-cache> <md-item-template> <span md-highlight-text="roomSearchText">{{currentLanguageNameField(item)}}</span> </md-item-template> </md-autocomplete> <md-autocomplete flex="50" flex-sm="100" flex-xs="100" flex-offset="5" flex-offset-sm="0" flex-offset-xs="0" md-search-text="subjectSearchText" md-selected-item="criteria.subjectObject" md-items="item in parameterSearch(subjectSearchText, formState.subjects)" md-item-text="currentLanguageNameField(item)" md-selected-item-change="selectedSubjectChanged(item)" md-min-length="1" md-floating-label="{{\'timetable.search.subject\' | translate}}" md-require-match md-no-cache> <md-item-template> <span md-highlight-text="subjectSearchText">{{currentLanguageNameField(item)}}</span> </md-item-template> </md-autocomplete> </div> <div layout="row"> <md-button ng-click="search()" class="md-raised md-primary">{{\'main.button.search\' | translate}}</md-button> <md-button class="md-raised" ng-click="clearSearchParameters()">{{\'main.button.clear\' | translate}}</md-button> </div> </form> </fieldset> </div> <div ng-controller="TimetableWeekViewController"> <div ng-include="\'timetable/generalTimetable/timetable.week.view.html\'"></div> </div> </div>'),a.put("timetable/generalTimetable/timetable.week.view.html",'<div layout-padding ng-if="shownWeek && timetableEvents"> <div layout="row" layout-align="center" style="padding: 0px"> <a ng-if="shownTimetableCurriculum || shownTeacher || shownRoom" ng-href="#/timetable/{{::schoolId}}/{{timetableType}}/{{typeId}}/{{studyYearId}}/{{weekIndex}}"> <span ng-if="shownTimetableCurriculum">{{shownTimetableCurriculum.studentGroupCode}}, {{currentLanguageNameField(shownTimetableCurriculum)}}</span> <span ng-if="shownTeacher">{{shownTeacher.lastname}}, {{shownTeacher.firstname}}</span> <span ng-if="shownRoom">{{shownRoom.buildingCode}}, {{shownRoom.roomCode}}</span> </a> </div> <div layout="row" layout-align="center" style="padding: 0px"> <md-button ng-if="previousWeekIndex !== undefined && directRoute" class="md-icon-button md-primary" ng-href="#/timetable/{{::schoolId}}/{{timetableType}}/{{typeId}}/{{studyYearId}}/{{previousWeekIndex}}"> <md-icon>arrow_back</md-icon> </md-button> <md-button ng-if="previousWeekIndex !== undefined && !directRoute" class="md-icon-button md-primary" ng-click="previousWeek(previousWeekIndex)"> <md-icon>arrow_back</md-icon> </md-button> <h2 ng-if="shownStudyPeriods" style="display:inline-block">{{shownStudyPeriods}}.&nbsp;</h2> <select class="timetableWeekSelect" ng-model="shownWeek" ng-change="weekSelectChange(shownWeek)" required ng-options="((week.start | hoisDate) + \' - \' + (week.end | hoisDate)) for week in weeks"></select> <md-button ng-if="nextWeekIndex && directRoute" class="md-icon-button md-primary" ng-href="#/timetable/{{::schoolId}}/{{timetableType}}/{{typeId}}/{{studyYearId}}/{{nextWeekIndex}}"> <md-icon>arrow_forward</md-icon> </md-button> <md-button ng-if="nextWeekIndex && !directRoute" class="md-icon-button md-primary" ng-click="nextWeek(nextWeekIndex)"> <md-icon>arrow_forward</md-icon> </md-button> </div> <div ng-if="!timetableSearch" layout="column" layout-align="center center"> <span ng-if="!(timetableEvents.length > 0)">{{\'timetable.error.noWeekTimetable\' | translate}}</span> <span ng-if="shownStudent.isHigher && shownWeek.connectedSubjects === false">{{\'timetable.error.noDeclaredSubjects\' | translate}}</span> <span ng-if="!shownStudent.isHigher && shownWeek.connectedSubjects === false">{{\'timetable.error.noConnectedModules\' | translate}}</span> </div> <div ng-if="timetableSearch && !(timetableEvents.length > 0)" layout="row" layout-align="center">{{\'timetable.error.noSearchResults\' | translate}}</div> <div hide-xs ng-if="timetableEvents && timetableEvents.length > 0" layout="column" flex="90" style="border: 1px solid #ccc; margin-left: auto; margin-right: auto" id="vTimetable"> <div layout="row" style="position:relative"> <div layout="column" flex style="position:absolute;width:100%"> <div style="height:20px;text-align:center">&nbsp;</div> <div ng-repeat="time in timeColumn track by $index" style="height:15px;border-bottom:1px dotted #ccc;border-collapse: collapse" ng-show="$index > 0">&nbsp;</div> </div> <div flex="10" layout="column"> <div style="height:20px;text-align:center">&nbsp;</div> <div ng-repeat="time in timeColumn" style="height:16px"> <span ng-show="($index % 2 != 0)">{{time}}</span> </div> </div> <div ng-repeat="day in weekColumns" flex="20" layout="column" style="position:relative; border-left: 1px solid #ccc;border-collapse: collapse"> <div style="height:32px;text-align:center" md-colors="day.today ? {background: \'accent-400\'}:{}">{{\'timetable.timetablePlan.\' + day.name | translate}}<br>{{day.date | hoisDate}}</div> <div layout="row"> <div flex ng-repeat="event in day.events track by $index" ng-style="{\'height\': event.rowHeight + \'px\', \'top\': event.top + \'px\', \'z-index\': $index, \'left\': event.left+\'%\',\'width\': \'calc(\'+event.width +\'% - 2px)\'}" md-colors="event.public ? {background: getEventColor(event.capacityType)} : {background: \'accent-100-0.8\'}" style="padding: 0; border: 1px solid; position:absolute; overflow: hidden; border-color: rgba(0,0,0, 0.3)" class="timetableEvent"> <md-tooltip md-direction="bottom" style="margin: -18px; height: auto"> <div ng-if="event.public">{{event.timeStart}}-{{event.timeEnd}} {{currentLanguageNameField(event)}}</div> <div ng-if="!event.public">{{event.timeStart}}-{{event.timeEnd}} {{\'timetable.timetableEvent.occupied\' | translate}}</div> <div ng-repeat="room in event.rooms track by $index"> <span ng-if="room.buildingCode">{{room.buildingCode}}-{{room.roomCode}}</span> <span ng-if="!room.buildingCode">{{room.roomCode}}</span> </div> <div ng-repeat="teacher in event.teachers track by $index">{{teacher.name}}</div> <div ng-repeat="studentGroup in event.studentGroups track by $index">{{studentGroup.code}}</div> <div>{{event.studentGroup}}</div> </md-tooltip> <div> <div> <span>{{event.timeStart}}-{{event.timeEnd}}</span> <span ng-if="event.public">{{currentLanguageNameField(event)}}</span> <span ng-if="!event.public">{{\'timetable.timetableEvent.occupied\' | translate}}</span> </div> <md-button ng-if="auth != null && event.showStudyMaterials && event.public && event.journalId" ng-href="/#/studyMaterial/vocational/{{event.journalId}}/view" class="studyMaterialsIcon md-icon-button" aria-label="materials"> <md-icon md-font-set="material-icons">folder</md-icon> </md-button> <md-button ng-if="auth != null && event.showStudyMaterials && event.public && event.subjectStudyPeriodId" ng-href="/#/studyMaterial/higher/{{event.subjectStudyPeriodId}}/view" class="studyMaterialsIcon md-icon-button" aria-label="materials"> <md-icon md-font-set="material-icons">folder</md-icon> </md-button> <md-button ng-if="auth == null && event.showStudyMaterials && event.public && event.journalId" ng-href="/#/studyMaterial/{{::schoolId}}/vocational/{{event.journalId}}/view" class="studyMaterialsIcon md-icon-button" aria-label="materials"> <md-icon md-font-set="material-icons">folder</md-icon> </md-button> <md-button ng-if="auth == null && event.showStudyMaterials && event.public && event.subjectStudyPeriodId" ng-href="/#/studyMaterial/{{::schoolId}}/higher/{{event.subjectStudyPeriodId}}/view" class="studyMaterialsIcon md-icon-button" aria-label="materials"> <md-icon md-font-set="material-icons">folder</md-icon> </md-button> </div> <div ng-if="event.person">{{\'timetable.timetableEvent.person\' | translate}}: {{currentLanguageNameField(event.person)}}</div> <div> <span ng-repeat="teacher in event.teachers track by $index"> <a ng-if="teacher.id" ng-href="/#/timetable/{{::schoolId}}/teacher/{{teacher.id}}/{{studyYearId}}/{{weekIndex}}">{{teacher.name}}</a> <span ng-if="!teacher.id">{{teacher.name}}</span> {{$last ? \'\' : \', \'}} </span> </div> <div> <span ng-repeat="room in event.rooms track by $index"> <a ng-if="room.id" ng-href="/#/timetable/{{::schoolId}}/room/{{room.id}}/{{studyYearId}}/{{weekIndex}}">{{room.buildingCode}}-{{room.roomCode}}</a> <span ng-if="!room.id">{{room.roomCode}}</span> {{$last ? \'\' : \', \'}} </span> </div> <div> <span ng-repeat="studentGroup in event.studentGroups track by $index"> <a ng-href="/#/timetable/{{::schoolId}}/group/{{studentGroup.id}}/{{studyYearId}}/{{weekIndex}}">{{studentGroup.code}}</a> {{$last ? \'\' : \', \'}} </span> </div> </div> </div> </div> </div> </div> <div hide-gt-xs ng-if="timetableEvents && timetableEvents.length > 0"> <span> <hois-collapsable ng-repeat="day in weekColumns" expanded="day.today" header-background-color="day.today ? \'rgb(236, 64, 122)\' : none"> <hois-collapsable-header> <span ng-style="{color: day.today ? \'white\' : none}">{{\'timetable.timetablePlan.\' + day.name | translate}} {{day.date | hoisDate}}</span> </hois-collapsable-header> <div layout="column"> <div flex ng-repeat="event in day.events track by $index"> <div md-colors="event.public ? {background: getEventColor(event.capacityType)} : {background: \'accent-100-0.8\'}" style="border: 1px solid rgba(0,0,0, 0.3); min-height: 80px"> <div> <span style="font-weight: bold">{{event.timeStart}}-{{event.timeEnd}}</span> <span ng-if="event.public">{{currentLanguageNameField(event)}}</span> <span ng-if="!event.public">{{\'timetable.timetableEvent.occupied\' | translate}}</span> </div> <div> {{event.teachers.length &gt; 0 ? (auth.higher ? (\'student.result.teacherHigher\' | translate) : (\'student.result.teacherVocational\' | translate)) : ""}} <span ng-repeat="teacher in event.teachers track by $index"> <a ng-if="teacher.id" ng-href="/#/timetable/{{::schoolId}}/teacher/{{teacher.id}}/{{studyYearId}}/{{weekIndex}}">{{teacher.name}}</a> <span ng-if="!teacher.id">{{teacher.name}}</span> {{$last ? \'\' : \', \'}} </span> </div> <div> {{event.rooms.length &gt; 0 ? (\'lessonplan.event.room\' | translate) : ""}} <span ng-repeat="room in event.rooms track by $index"> <a ng-if="room.id" ng-href="/#/timetable/{{::schoolId}}/room/{{room.id}}/{{studyYearId}}/{{weekIndex}}">{{room.buildingCode}}-{{room.roomCode}}</a> <span ng-if="!room.id">{{room.roomCode}}</span> {{$last ? \'\' : \', \'}} </span> </div> <div> {{event.studentGroups.length &gt; 0 ? (\'directive.student.studentGroup\' | translate) : ""}} <span ng-repeat="studentGroup in event.studentGroups track by $index"> <a ng-href="/#/timetable/{{::schoolId}}/group/{{studentGroup.id}}/{{studyYearId}}/{{weekIndex}}">{{studentGroup.code}}</a> {{$last ? \'\' : \', \'}} </span> </div> </div> </div> </div> </hois-collapsable> </span> </div> <div ng-if="shownWeek && timetableEvents" layout="row" flex> <div layout="row" layout-align="end end" layout-align-sm="start start" layout-align-xs="start start" layout-sm="column" layout-xs="column" flex="90" class="timetable-capacities"> <div ng-repeat="c in capacityTypes" flex-offset="5" class="capacity-type-legend" md-colors="{background: c.color}"> <span>{{currentLanguageNameField(c)}}</span> </div> <div flex-offset="5" class="capacity-type-legend" md-colors="{background: \'primary-100-0.8\'}"> <span>{{\'timetable.timetableEvent.singleEvent\' | translate}}</span> </div> <div flex-offset="5" class="capacity-type-legend" md-colors="{background: \'accent-100-0.8\'}"> <span>{{\'timetable.timetableEvent.occupied\' | translate}}</span> </div> </div> </div> <div> <md-button class="md-icon-button timetableIconButton" ng-click="generateCalendar()"> <md-tooltip md-direction="top">{{\'timetable.saveToCalendar\' | translate}}</md-tooltip> <md-icon md-font-set="material-icons md-primary md-48">event</md-icon> </md-button> <md-button ng-if="directRoute && auth != null" ng-click="back(\'#/timetable/generalTimetableByGroup\');" class="md-raised">{{\'main.button.back\' | translate}}</md-button> <md-button ng-if="directRoute && auth == null" ng-click="back(\'#/timetable/\' + schoolId + \'generalTimetableByGroup/\')" class="md-raised">{{\'main.button.back\' | translate}}</md-button> </div> </div> <style>.hois-collapse {\r\n        margin-bottom: 1px;\r\n    }</style>'),a.put("vocationalCurriculum/dialog/occupation.add.dialog.html",'<md-dialog aria-label="occupation add dialog" flex="40" flex-xs="100"> <form name="dialogForm" ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2>{{formState.readOnly ? "occupation.viewAquiredOccupation" : "occupation.addAquiredOccupation" | translate}}</h2> <span flex></span> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <span flex></span> <div class="ois-form-layout" layout="column" layout-margin ng-cloak> <div layout="row"> <md-input-container flex> <label>{{\'occupation.aquiredOccupation\' | translate}}</label> <hois-classifier-select ng-model="occupation" main-classifier-code="KUTSE" required ng-disabled="formState.readOnly" only-valid ignore-code-validation="occupation.code"></hois-classifier-select> </md-input-container> </div> <div class="occupation-header align-center">{{\'occupation.specialities\' | translate}}</div> <div ng-repeat="occupationSpeciality in specialities" flex layout="row" class="nomargin"> <div flex="5">&nbsp;</div> <md-checkbox ng-model="selectedSpecialities[occupationSpeciality.code]" aria-label="{{currentLanguageNameField(occupationSpeciality)}}" ng-disabled="formState.readOnly"> {{ occupationSpeciality | hoisValidDates }} </md-checkbox> </div> <div class="occupation-header align-center">{{\'occupation.partOccupations\' | translate}}</div> <div ng-repeat="partOccupation in partOccupations" class="common-label" flex layout="row"> <div flex="5">&nbsp;</div> <div>{{ partOccupation | hoisValidDates }}</div> </div> <div>&nbsp;</div> <div layout="row"> <md-checkbox ng-model="occupationGrant" aria-label="occupationGrant" ng-disabled="formState.readOnly"> {{\'occupation.schoolHasOccupationGrant\' | translate}} </md-checkbox> </div> </div> </md-dialog-content> <span flex></span> <md-dialog-actions layout="row" layout-align="start center"> <md-button class="md-raised md-primary" ng-click="submit()" ng-if="!formState.readOnly">{{"main.button.save" | translate}}</md-button> <md-button class="md-raised" ng-click="cancel()">{{"main.button.close" | translate}}</md-button> </md-dialog-actions> </form> </md-dialog>'),a.put("vocationalCurriculum/dialog/partOccupation.add.dialog.html",'<md-dialog aria-label="occupation add dialog" flex="40" flex-xs="100"> <form name="dialogForm" ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2>{{formState.readOnly ? "occupation.viewAquiredPartOccupation" : "occupation.addAquiredPartOccupation" | translate}}</h2> <span flex></span> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <span flex></span> <div class="ois-form-layout" layout="column" layout-margin ng-cloak> <div layout="column"> <md-input-container flex> <label>{{\'occupation.occupationStandard\' | translate}}</label> <!--<hois-classifier-select ng-model="occupation" main-classifier-code="KUTSE" required ng-disabled="formState.readOnly"></hois-classifier-select>--> <md-select ng-model="occupation" required ng-disabled="formState.readOnly"> <md-option ng-value="option" ng-repeat="option in occupations | orderBy: currentLanguageNameField()"> {{ option | hoisValidDates }} </md-option> </md-select> </md-input-container> <md-input-container flex> <label>{{\'occupation.aquiredPartOccupation\' | translate}}</label> <!--<hois-classifier-select ng-model="partOccupationAquired" main-classifier-code="OSAKUTSE" watch-model="occupation"\r\n                        connect-main-classifier-code="KUTSE" search-from-connect required ng-disabled="formState.readOnly"></hois-classifier-select>--> <md-select ng-model="partOccupationAquired" required ng-disabled="formState.readOnly"> <md-option ng-value="option" ng-repeat="option in partOccupations | filter: filterPartOccupations | orderBy: currentLanguageNameField()"> {{ option | hoisValidDates }} </md-option> </md-select> </md-input-container> </div> </div> </md-dialog-content> <span flex></span> <md-dialog-actions layout="row" layout-align="start center"> <md-button class="md-raised md-primary" ng-click="submit()" ng-if="!formState.readOnly">{{"main.button.save" | translate}}</md-button> <md-button class="md-raised" ng-click="cancel()">{{"main.button.close" | translate}}</md-button> </md-dialog-actions> </form> </md-dialog>'),a.put("vocationalCurriculum/dialog/school.curriculum.selection.dialog.html",'<md-dialog aria-label="state curriculum selection dialog"> <form name="dialogForm" ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2>{{"curriculum.selectSchoolCurriculum" | translate}}</h2> <span flex></span> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <md-table-container flex> <table md-table md-row-select="true" ng-model="curriculumSelected" md-progress="tabledata.$promise"> <thead md-head md-order="criteria.order" md-on-reorder="loadData"> <tr md-row> <th md-column md-order-by="{{currentLanguageNameField()}}">{{\'curriculum.name\' | translate}}</th> <th md-column md-order-by="code">{{\'curriculum.code\' | translate}}</th> <th md-column md-order-by="merCode">{{\'curriculum.merCode\' | translate}}</th> <th md-column md-order-by="credits">{{\'stateCurriculum.credits\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row md-select="curriculum" md-select-id="curriculum.id" ng-repeat="curriculum in tabledata.content" ng-class-odd="\'odd\'" ng-class-even="\'even\'"> <td md-cell>{{currentLanguageNameField(curriculum)}}</td> <td md-cell>{{curriculum.code}}</td> <td md-cell>{{curriculum.merCode}}</td> <td md-cell>{{curriculum.credits}}</td> </tr> </tbody> </table> </md-table-container> <md-table-pagination md-limit="criteria.size" md-limit-options="[10, 20, 50]" md-page="criteria.page" md-total="{{tabledata.totalElements}}" md-on-paginate="loadData" md-label="{page: \'{{\'main.page\' | translate}}:\', rowsPerPage: \'{{\'main.rowPerPage\' | translate}}:\', of: \'{{\'main.of\' | translate}}\' }" md-page-select></md-table-pagination> </md-dialog-content> <md-dialog-actions layout="row" layout-align="start center"> <md-button class="md-primary md-raised" ng-disabled="curriculumSelected.length !== 1" ng-click="submit()">{{"main.button.choose" | translate}}</md-button> <md-button class="md-raised" ng-click="cancel()">{{"main.button.close" | translate}}</md-button> </md-dialog-actions> </form> </md-dialog>'),a.put("vocationalCurriculum/dialog/state.curriculum.selection.dialog.html",'<md-dialog aria-label="state curriculum selection dialog" flex="40" flex-xs="100"> <form name="dialogForm" ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2>{{"stateCurriculum.select" | translate}}</h2> <span flex></span> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <span flex></span> <div class="ois-form-layout" layout="column" layout-margin ng-cloak> <md-input-container flex> <label>{{\'stateCurriculum.name\' | translate}}</label> <md-select ng-model="stateCurriculumSelect" aria-label="state curriculum selection" ng-change="stateCurriculumSelected(stateCurriculumSelect)" required> <md-option ng-repeat="option in stateCurriculums" ng-value="option.id"> {{option[$root.currentLanguageNameField()]}} </md-option> </md-select> </md-input-container> <div ng-show="stateCurriculumSelect"> <md-input-container> <input style="display:none" readonly ng-model="occupationsAndPartOccupationsCount" name="occupationsAndPartOccupationsCount" type="number" min="1"> <div ng-messages="dialogForm.occupationsAndPartOccupationsCount.$error"> <div ng-if="dialogForm.$submitted" ng-message="min">{{\'curriculum.error.occupationNotSelected\' | translate}}</div> </div> </md-input-container> </div> <div style="height: 100%"> <div layout="column"> <div ng-repeat="item in stateCurriculumOccupations"> <md-checkbox ng-model="selectedStateCurriculumOccupations[item.occupation.code]" ng-change="occupationSelected(item.occupation.code)" aria-label="{{currentLanguageNameField(item.occupation)}}" ng-disabled="occupationsCount === 0 && partOccupationsCount !== 0"> {{currentLanguageNameField(item.occupation)}} </md-checkbox> <div layout="column"> <!--span ng-show="item.partOccupations.length!=0">\r\n                    {{\'occupation.partOccupations\' | translate}}\r\n                  </span--> <div ng-show="item.partOccupations.length!=0" class="occupation-header align-center">{{\'occupation.partOccupations\' | translate}}</div> <md-input-container style="height: 100%"> <div layout="column"> <div ng-repeat="partOccupation in item.partOccupations" flex layout="row"> <div flex="5">&nbsp;</div> <md-checkbox ng-model="selectedStateCurriculumPartOccupations[partOccupation.code]" aria-label="{{currentLanguageNameField(partOccupation)}}" ng-disabled="selectedStateCurriculumOccupations[item.occupation.code] || occupationsCount !== 0" ng-change="countOccupationsAndPartOccupationsSelected()"> {{currentLanguageNameField(partOccupation)}} </md-checkbox> </div> </div> </md-input-container> </div> <div layout="column"> <div ng-show="item.specialities.length!=0" class="occupation-header align-center">{{\'occupation.specialities\' | translate}}</div> <div ng-show="item.specialities.length!=0"> <input style="display:none" type="number" readonly name="{{\'selectedSpecialitiesCount_\'+item.occupation.code}}" ng-model="selectedSpecialitiesCount[item.occupation.code]" min="1"> <div class="invalid" ng-messages="dialogForm[\'selectedSpecialitiesCount_\'+item.occupation.code].$error"> <div ng-if="dialogForm.$submitted" ng-message="min">{{\'main.messages.error.atLeastOneMustBeSelected\' | translate}}</div> </div> </div> <md-input-container style="height: 100%"> <div layout="column"> <div ng-repeat="speciality in item.specialities" flex layout="row"> <div flex="5">&nbsp;</div> <md-checkbox ng-model="selectedStateCurriculumSpecialities[speciality.code]" ng-change="specialitySelected(item.occupation.code, speciality.code)" aria-label="{{currentLanguageNameField(speciality)}}" ng-disabled="!selectedStateCurriculumOccupations[item.occupation.code]"> {{currentLanguageNameField(speciality)}} </md-checkbox> </div> </div> </md-input-container> </div> </div> </div> </div> <!--        <div ng-repeat="stateCurriculumOccupation in stateCurriculumOccupations" flex>\r\n          <md-checkbox ng-model="selectedStateCurriculumOccupation[stateCurriculumOccupation.occupation.code]"\r\n            aria-label="{{stateCurriculumOccupation.occupation[$root.currentLanguageNameField()]}}">\r\n            {{stateCurriculumOccupation.occupation[$root.currentLanguageNameField()]}}\r\n          </md-checkbox>\r\n        </div>--> </div> </md-dialog-content> <md-dialog-actions layout="row" layout-align="start center"> <md-button class="md-primary md-raised" ng-click="submit()">{{"main.button.choose" | translate}}</md-button> <md-button class="md-raised" ng-click="cancel()">{{"main.button.close" | translate}}</md-button> </md-dialog-actions> </form> </md-dialog>'),a.put("vocationalCurriculum/implementationPlan/implementation.plan.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <form name="vocationalCurriculumModuleImplementationPlanForm" layout="column"> <fieldset tabindex="1"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'module.implementationPlan.subTitle\' | translate}}</legend> <div layout="column"> <md-input-container flex> <label>{{\'module.implementationPlan.codeOrName\' | translate}}</label> <input ng-model="implementationPlan.code" name="code" type="text" md-maxlength="255" required ng-readonly="formState.readOnly" unique="curriculumVersionCodeUniqueQuery" ng-model-options="{ debounce: 250 }"> <div ng-messages="vocationalCurriculumModuleImplementationPlanForm.code.$error"> <div ng-message="notUnique"> {{\'main.messages.error.mustBeUnique\' | translate}} </div> </div> </md-input-container> <div layout="row"> <md-input-container flex="45" flex-xs="100"> <label>{{\'module.implementationPlan.studyForm\' | translate}}</label> <hois-classifier-select ng-model="implementationPlan.curriculumStudyForm" show-only-values="curriculumStudyForms" model-value-attr="code" main-classifier-code="OPPEVORM" required ng-disabled="formState.readOnly"></hois-classifier-select> </md-input-container> <md-input-container flex="20" flex-offset="5"> <label>{{\'module.implementationPlan.admissionYear\' | translate}}</label> <md-select ng-model="implementationPlan.admissionYear" ng-disabled="formState.readOnly"> <md-option ng-repeat="year in ::admissionYears" ng-value="year" aria-label="{{year}}">{{year}}</md-option> </md-select> </md-input-container> <md-input-container flex="25" flex-offset="5"> <label>{{\'module.implementationPlan.type\' | translate}}</label> <hois-classifier-select ng-model="implementationPlan.type" model-value-attr="code" main-classifier-code="OPPEKAVA_VERSIOON_LIIK" required ng-disabled="formState.readOnly"></hois-classifier-select> </md-input-container> </div> <md-input-container flex> <label>{{\'module.implementationPlan.targetGroup\' | translate}}</label> <input ng-model="implementationPlan.targetGroup" type="text" md-maxlength="1000" required ng-readonly="formState.readOnly"> </md-input-container> <md-input-container flex> <label>{{auth.higher ? (\'module.implementationPlan.teachersHigher\' | translate) : (\'module.implementationPlan.teachersVocational\' | translate)}}</label> <input ng-model="implementationPlan.teachers" type="text" md-maxlength="1000" required ng-readonly="formState.readOnly"> </md-input-container> <!-- Cannot use hois-school-department-select here as options may be not only from user\'s school,\r\n        but also must be limited to curriculum school departments --> <md-input-container flex> <label>{{\'module.implementationPlan.teachingDepartment\' | translate}}</label> <hois-select ng-model="implementationPlan.schoolDepartment" values="schoolDepartments" ng-disabled="formState.readOnly"></hois-select> </md-input-container> <md-input-container flex> <label>{{\'main.notes\' | translate}}</label> <textarea ng-model="implementationPlan.description" md-maxlength="20000" dfs max-rows="10" ng-readonly="formState.readOnly"></textarea> </md-input-container> <div layout="row" layout-xs="column"> <md-input-container flex-xs="100"> <div layout="row" layout-align="end" flex> <md-checkbox ng-model="implementationPlan.individual" aria-label="individual" ng-disabled="formState.readOnly">{{\'module.implementationPlan.individualCurriculum\' | translate}}</md-checkbox> </div> </md-input-container> </div> </div> </fieldset> <div>&nbsp;</div> <fieldset tabindex="2"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'module.modules\' | translate}}</legend> <div layout="row" flex class="secondary-table-header"> <div flex="50"> {{\'module.implementationPlan.moduleName\' | translate}} </div> <div flex="30"> {{\'module.implementationPlan.moduleCapacity\' | translate}} </div> <div flex="15"> {{\'module.implementationPlan.moduleOK\' | translate}} </div> </div> <!--MODULES WITHOUT OCCUPATIONS--> <div class="occupation-header align-center">{{\'module.modulesWithoutPartOccupationOccuaptionSpecialization\' | translate}} </div> <div layout="column" ng-repeat="type in moduleTypes | filter: filterTypesWithoutEmptyModules" class="lowerBorder"> <div layout="row" flex="100" class="occupation-row align-center border-bottom odd"> <div flex="5">&nbsp;</div> <div flex="15" style="word-wrap: break-word">{{currentLanguageNameField(type)}} ({{getTotalCredits(modules | filter: filterEmptyModulesByType(type.code))}} EKAP)</div> <div layout="column" flex="75"> <div flex="100" ng-repeat="module in modules | filter: filterEmptyModulesByType(type.code) | orderBy: \'nameEt\'" layout="row" class="align-center"> <a flex="50" style="word-wrap: break-word" ng-click="openViewModuleDialog(module)" href="">{{occupationModuleHasBaseModule(module) ? \'* \' : \'\'}}{{currentLanguageNameField(module)}}</a> <span flex="15">{{module.credits}}&nbsp; EKAP</span> <div flex="30"> <a class="md-primary" style="word-wrap: break-word" ng-click="openAddModuleDataDialog(module)" ng-if="!formState.readOnly  && implementationPlan.id && implementationPlan.canChange"> {{isOccupationModuleDataSaved(module) ? \'module.implementationPlan.viewUpdateModuleData\' : \'module.implementationPlan.insertModuleData\' | translate}} </a> <a class="md-primary" style="word-wrap: break-word" ng-click="openAddModuleDataDialog(module)" ng-if="formState.readOnly && isOccupationModuleDataSaved(module) "> {{\'module.implementationPlan.viewModuleData\' | translate}} </a> </div> <div flex="15" ng-class="{invalid: !isModuleValid(module)}"> {{isOccupationModuleDataSaved(module) ? \'main.yes\' : \'main.no\' | translate}} </div> </div> </div> </div> </div> <!--KUTSETE/OSAKUTSETE MOODULID--> <div ng-repeat="occupation in occupations | orderBy: [\'occupation\', \'-occupation.validThru\', \'-occupation.validFrom\']:false:compareUsingLanguage" layout="column"> <div class="occupation-header align-center"> <span ng-show="isOccupation">{{\'stateCurriculum.enter.occupation.occupation\' | translate}} {{$index + 1}}:&nbsp; {{occupation.occupation | hoisValidDates }}</span> <span ng-show="!isOccupation">{{\'stateCurriculum.enter.occupation.partial\' | translate}} {{$index + 1}}:&nbsp; {{occupation.occupation | hoisValidDates }}</span> </div> <div layout="column" ng-repeat="type in moduleTypes | filter: filterTypesWithoutModules(occupation.occupation.code, modules)" class="lowerBorder"> <div layout="row" flex="100" class="occupation-row align-center border-bottom odd"> <div flex="5">&nbsp;</div> <div flex="15" style="word-wrap: break-word">{{currentLanguageNameField(type)}} ({{getTotalCredits(modules | filter: filterModulesByType(type.code, occupation.occupation.code))}} EKAP)</div> <div layout="column" flex="75"> <div flex="100" ng-repeat="module in modules | filter: filterModulesByType(type.code, occupation.occupation.code) | orderBy: \'nameEt\'" layout="row" class="align-center"> <a flex="50" style="word-wrap: break-word" ng-click="openViewModuleDialog(module)" href="">{{occupationModuleHasBaseModule(module) ? \'* \' : \'\'}}{{currentLanguageNameField(module)}}</a> <span flex="15">{{module.credits}}&nbsp; EKAP</span> <div flex="30"> <a class="md-primary" style="word-wrap: break-word" ng-click="openAddModuleDataDialog(module)" ng-if="!formState.readOnly && implementationPlan.id && implementationPlan.canChange"> {{isOccupationModuleDataSaved(module) ? \'module.implementationPlan.viewUpdateModuleData\' : \'module.implementationPlan.insertModuleData\' | translate}} </a> <a class="md-primary" style="word-wrap: break-word" ng-click="openAddModuleDataDialog(module)" ng-if="formState.readOnly && isOccupationModuleDataSaved(module)"> {{\'module.implementationPlan.viewModuleData\' | translate}} </a> </div> <div flex="15" ng-class="{invalid: !isModuleValid(module)}"> {{isOccupationModuleDataSaved(module) ? \'main.yes\' : \'main.no\' | translate}} </div> </div> </div> </div> </div> <!--OSAKUTSETE MOODULID--> <div ng-repeat="partOccupation in occupation.partOccupations | orderBy: [partOccupation, \'-validThru\', \'-validFrom\']:false:compareUsingLanguage" layout="column"> <div class="occupation-header2 align-center">{{\'stateCurriculum.enter.occupation.partial\' | translate}} {{$index + 1}}:&nbsp; <hois-classifier-value ng-model="partOccupation" main-classifier-code="OSAKUTSE" show-date></hois-classifier-value> </div> <div layout="column" ng-repeat="type in moduleTypes | filter: filterTypesWithoutModules(partOccupation, modules)" class="lowerBorder"> <div layout="row" flex="100" class="occupation-row align-center border-bottom odd"> <div flex="5">&nbsp;</div> <div flex="15" style="word-wrap: break-word">{{currentLanguageNameField(type)}} ({{getTotalCredits(modules | filter: filterModulesByType(type.code, partOccupation))}} EKAP)</div> <div layout="column" flex="75"> <div flex="100" ng-repeat="module in modules | filter: filterModulesByType(type.code, partOccupation) | orderBy: \'nameEt\'" layout="row" class="align-center"> <a flex="50" style="word-wrap: break-word" ng-click="openViewModuleDialog(module)" href="">{{occupationModuleHasBaseModule(module) ? \'* \' : \'\'}}{{currentLanguageNameField(module)}}</a> <span flex="15">{{module.credits}}&nbsp; EKAP</span> <div flex="30"> <a class="md-primary" style="word-wrap: break-word" ng-click="openAddModuleDataDialog(module)" ng-if="!formState.readOnly && implementationPlan.id && implementationPlan.canChange"> {{isOccupationModuleDataSaved(module) ? \'module.implementationPlan.viewUpdateModuleData\' : \'module.implementationPlan.insertModuleData\' | translate}} </a> <a class="md-primary" style="word-wrap: break-word" ng-click="openAddModuleDataDialog(module)" ng-if="formState.readOnly && isOccupationModuleDataSaved(module) "> {{\'module.implementationPlan.viewModuleData\' | translate}} </a> </div> <div flex="15" ng-class="{invalid: !isModuleValid(module)}"> {{isOccupationModuleDataSaved(module) ? \'main.yes\' : \'main.no\' | translate}} </div> </div> </div> </div> </div> </div> <!--SPETSKUTSETE MOODULID--> <div ng-repeat="speciality in occupation.specialities | orderBy: [speciality, \'-validThru\', \'-validFrom\']:false:compareUsingLanguage" layout="column"> <div class="occupation-header2 align-center">{{\'stateCurriculum.enter.occupation.specialty\' | translate}} {{$index + 1}}: &nbsp; <hois-classifier-value ng-model="speciality" main-classifier-code="SPETSKUTSE" show-date></hois-classifier-value> </div> <div layout="column" ng-repeat="type in moduleTypes | filter: filterTypesWithoutModules(speciality, modules)" class="lowerBorder"> <div layout="row" flex="100" class="occupation-row align-center border-bottom odd"> <div flex="5">&nbsp;</div> <div flex="15" style="word-wrap: break-word">{{currentLanguageNameField(type)}} ({{getTotalCredits(modules | filter: filterModulesByType(type.code, speciality))}} EKAP)</div> <div layout="column" flex="75"> <div flex="100" ng-repeat="module in modules | filter: filterModulesByType(type.code, speciality) | orderBy: \'nameEt\'" layout="row" class="align-center"> <a flex="50" style="word-wrap: break-word" ng-click="openViewModuleDialog(module)" href="">{{occupationModuleHasBaseModule(module) ? \'* \' : \'\'}}{{currentLanguageNameField(module)}}</a> <span flex="15">{{module.credits}}&nbsp; EKAP</span> <div flex="30"> <a class="md-primary" style="word-wrap: break-word" ng-click="openAddModuleDataDialog(module)" ng-if="!formState.readOnly && implementationPlan.id && implementationPlan.canChange"> {{isOccupationModuleDataSaved(module) ? \'module.implementationPlan.viewUpdateModuleData\' : \'module.implementationPlan.insertModuleData\' | translate}} </a> <a class="md-primary" style="word-wrap: break-word" ng-click="openAddModuleDataDialog(module)" ng-if="formState.readOnly && isOccupationModuleDataSaved(module) "> {{\'module.implementationPlan.viewModuleData\' | translate}} </a> </div> <div flex="15" ng-class="{invalid: !isModuleValid(module)}"> {{isOccupationModuleDataSaved(module) ? \'main.yes\' : \'main.no\' | translate}} </div> </div> </div> </div> </div> </div> </div> </fieldset> <div>&nbsp;</div> <fieldset tabindex="10"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'curriculum.yearCapacitiesTable\' | translate}}</legend> <md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column ng-repeat="yc in implementationPlan.yearCapacities track by $index">{{$index+1}}.&nbsp;{{\'module.studyYearLowercase\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row> <td md-cell ng-repeat="yc in implementationPlan.yearCapacities track by $index">{{yc}}</td> </tr> </tbody> </table> </md-table-container> </fieldset> <div>&nbsp;</div> <fieldset tabindex="11"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'curriculum.implementationPlanStatus\' | translate}}</legend> <div layout="row" flex="100"> <md-input-container flex="30" flex-sm="100" flex-xs="100"> <label>{{\'main.validFrom\' | translate}}</label> <md-datepicker ng-model="implementationPlan.validFrom" md-open-on-focus required ng-disabled="formState.readOnly"></md-datepicker> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-xs="100" flex-offset-xs="0" flex-offset-sm="0" flex-offset="4"> <label>{{\'main.validTo\' | translate}}</label> <md-datepicker ng-model="implementationPlan.validThru" md-min-date="implementationPlan.validFrom" md-open-on-focus ng-disabled="formState.readOnly"></md-datepicker> </md-input-container> </div> <div layout="row" class="top-margin form-readonly"> <md-input-container flex="30" flex-sm="100"> <label>{{\'main.status\' | translate}}</label> <hois-classifier-value ng-model="implementationPlan.status" main-classifier-code="OPPEKAVA_VERSIOON_STAATUS"></hois-classifier-value> </md-input-container> </div> </fieldset> <hois-created-modified object="implementationPlan"></hois-created-modified> </form> <div layout="row"> <div flex layout-xs="column"> <span ng-show="implementationPlan.status === VERSION_STATUS.S" layout-xs="column"> <span ng-show="!implementationPlan.id" layout-xs="column"> <md-button class="md-raised md-primary" ng-click="save()">{{\'main.button.save\' | translate}}</md-button> </span> <span ng-show="!formState.readOnly && implementationPlan.id" layout-xs="column"> <md-button class="md-raised md-primary" ng-click="save()" ng-if="implementationPlan.canChange">{{\'main.button.save\' | translate}}</md-button> <md-button ng-click="saveAndConfirm()" class="md-raised" ng-if="implementationPlan.canChange && implementationPlan.canConfirm">{{\'curriculum.statuschange.implementationPlan.button.verify\' | translate}}</md-button> <md-button ng-click="setStatusClosed()" class="md-raised" ng-if="implementationPlan.canChange && implementationPlan.canClose">{{\'curriculum.statuschange.implementationPlan.button.close\' | translate}}</md-button> <md-button class="md-raised md-default" ng-if="implementationPlan.canChange" ng-click="copy()">{{\'main.button.copy\' | translate}}</md-button> <md-button class="md-raised md-default" ng-click="delete()" ng-if="implementationPlan.canDelete">{{\'main.button.delete\' | translate}}</md-button> </span> <span ng-show="formState.readOnly" layout-xs="column"> <md-button class="md-raised md-primary" ng-click="goToEditForm()" ng-if="implementationPlan.canChange">{{\'main.button.change\' | translate}}</md-button> <md-button ng-click="confirm()" class="md-raised" ng-if="implementationPlan.canConfirm">{{\'curriculum.statuschange.implementationPlan.button.verify\' | translate}}</md-button> <md-button ng-click="setStatusClosed()" class="md-raised" ng-if="implementationPlan.canClose">{{\'curriculum.statuschange.implementationPlan.button.close\' | translate}}</md-button> <md-button class="md-raised md-default" ng-click="copy()" ng-if="implementationPlan.canChange">{{\'main.button.copy\' | translate}}</md-button> </span> </span> <span ng-show="implementationPlan.status === VERSION_STATUS.K" layout-xs="column"> <span ng-show="!formState.readOnly" layout-xs="column"> <md-button class="md-raised md-primary" ng-click="save()" ng-if="implementationPlan.canChange">{{\'main.button.save\' | translate}}</md-button> <md-button class="md-raised md-default" ng-click="changeStatusUnderRevision()" ng-if="implementationPlan.canChange && implementationPlan.canSetUnderRevision">{{\'curriculum.statuschange.implementationPlan.button.changeStatusUnderRevision\' | translate}}</md-button> </span> <span ng-show="formState.readOnly" layout-xs="column"> <md-button class="md-raised md-primary" ng-click="goToEditForm()" ng-if="implementationPlan.canChange">{{\'main.button.change\' | translate}}</md-button> <md-button class="md-raised md-default" ng-click="changeStatusUnderRevision()" ng-if="implementationPlan.canChange && implementationPlan.canSetUnderRevision">{{\'curriculum.statuschange.implementationPlan.button.changeStatusUnderRevision\' | translate}}</md-button> <md-button ng-click="setStatusClosed()" class="md-raised" ng-if="implementationPlan.canClose">{{\'curriculum.statuschange.implementationPlan.button.close\' | translate}}</md-button> <md-button class="md-raised md-default" ng-click="copy()" ng-if="implementationPlan.canChange">{{\'main.button.copy\' | translate}}</md-button> </span> </span> <span ng-show="implementationPlan.status === VERSION_STATUS.C" layout-xs="column"> <md-button class="md-raised md-default" ng-click="copy()" ng-if="implementationPlan.canChange">{{\'main.button.copy\' | translate}}</md-button> </span> <a href="{{curriculumVersionPdfUrl}}" target="_blank" class="md-button md-raised" ng-if="showPrintButton()">{{\'module.implementationPlan.print\' | translate}}</a> <a href="{{curriculumVersionModulesPdfUrl}}" target="_blank" class="md-button md-raised" ng-if="showPrintButton()">{{\'module.implementationPlan.printModules\' | translate}}</a> <md-button class="md-raised md-default" ng-click="back(\'#/vocationalCurriculum/\' + curriculumId + \'/view\', vocationalCurriculumModuleImplementationPlanForm)">{{\'main.button.back\' | translate}}</md-button> </div> </div> </div> <style>.lowerBorder {\r\n    border-bottom: solid 1px #E0E0E0;\r\n  }</style>'),
a.put("vocationalCurriculum/implementationPlan/implementation.plan.view.html",'<div class="ois-form-layout-padding ois-form-layout" ng-cloak> <form name="vocationalCurriculumModuleImplementationPlanForm" layout="column"> <fieldset tabindex="1"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'module.implementationPlan.subTitle\' | translate}}</legend> <div layout="column"> <md-input-container flex> <label>{{\'module.implementationPlan.codeOrName\' | translate}}</label> <input ng-model="implementationPlan.code" name="code" type="text" readonly> </md-input-container> <div layout="row" layout-xs="column"> <md-input-container flex="45" flex-xs="100"> <label>{{\'module.implementationPlan.studyForm\' | translate}}</label> <hois-classifier-select ng-model="implementationPlan.curriculumStudyForm" show-only-values="curriculumStudyForms" model-value-attr="code" main-classifier-code="OPPEVORM" disabled></hois-classifier-select> </md-input-container> <md-input-container flex="20" flex-offset="5" flex-offset-xs="0" flex-xs="100"> <label>{{\'module.implementationPlan.admissionYear\' | translate}}</label> <md-select ng-model="implementationPlan.admissionYear" disabled> <md-option ng-repeat="year in ::admissionYears" ng-value="year" aria-label="{{year}}">{{year}}</md-option> </md-select> </md-input-container> <md-input-container flex="25" flex-offset="5" flex-offset-xs="0" flex-xs="100"> <label>{{\'module.implementationPlan.type\' | translate}}</label> <hois-classifier-select ng-model="implementationPlan.type" model-value-attr="code" main-classifier-code="OPPEKAVA_VERSIOON_LIIK" disabled></hois-classifier-select> </md-input-container> </div> <md-input-container flex> <label>{{\'module.implementationPlan.targetGroup\' | translate}}</label> <input ng-model="implementationPlan.targetGroup" type="text" readonly> </md-input-container> <md-input-container flex> <label>{{auth.higher ? (\'module.implementationPlan.teachersHigher\' | translate) : (\'module.implementationPlan.teachersVocational\' | translate)}}</label> <input ng-model="implementationPlan.teachers" type="text" readonly> </md-input-container> <!-- Cannot use hois-school-department-select here as options may be not only from user\'s school,\r\n        but also must be limited to curriculum school departments --> <md-input-container flex> <label>{{\'module.implementationPlan.teachingDepartment\' | translate}}</label> <hois-select ng-model="implementationPlan.schoolDepartment" values="schoolDepartments" disabled></hois-select> </md-input-container> <md-input-container flex> <label>{{\'main.notes\' | translate}}</label> <textarea ng-model="implementationPlan.description" max-rows="10" readonly></textarea> </md-input-container> <md-input-container flex ng-if="implementationPlan.status === VERSION_STATUS.K"> <label>{{\'public.url\' | translate}}</label> <input ng-model="publicUrl" type="text" readonly> </md-input-container> <div layout="row"> <md-input-container> <div layout="row" layout-align="end" flex> <md-checkbox ng-model="implementationPlan.individual" aria-label="individual" disabled>{{\'module.implementationPlan.individualCurriculum\' | translate}}</md-checkbox> </div> </md-input-container> </div> </div> </fieldset> <div>&nbsp;</div> <fieldset tabindex="2"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'module.modules\' | translate}}</legend> <div layout="row" flex class="secondary-table-header"> <div flex="50" flex-xs="45"> {{\'module.implementationPlan.moduleName\' | translate}} </div> <div flex="33"> &nbsp;&nbsp; {{\'module.implementationPlan.moduleCapacity\' | translate}} </div> <div flex="15"> {{\'module.implementationPlan.moduleOK\' | translate}} </div> </div> <!--MODULES WITHOUT OCCUPATIONS--> <div class="occupation-header align-center">{{\'module.modulesWithoutPartOccupationOccuaptionSpecialization\' | translate}} </div> <div layout="column" ng-repeat="type in moduleTypes | filter: filterTypesWithoutEmptyModules" class="lowerBorder"> <div layout="row" flex="100" class="occupation-row align-center border-bottom odd"> <div flex="5" flex-xs="0">&nbsp;</div> <div flex="15" style="word-wrap: break-word">{{currentLanguageNameField(type)}} ({{getTotalCredits(modules | filter: filterEmptyModulesByType(type.code))}} EKAP)</div> <div layout="column" flex="75"> <div flex="100" ng-repeat="module in modules | filter: filterEmptyModulesByType(type.code) | orderBy: \'nameEt\'" layout="row" class="align-center"> <a flex="50" flex-xs="45" style="word-wrap: break-word" ng-click="openViewModuleDialog(module)" href="">{{occupationModuleHasBaseModule(module) ? \'* \' : \'\'}}{{currentLanguageNameField(module)}}</a> <span flex="15" style="word-wrap: break-word">{{module.credits}}&nbsp; EKAP</span> <div flex="30"> <a class="md-primary" ng-click="openAddModuleDataDialog(module)" ng-if="isOccupationModuleDataSaved(module) "> {{\'module.implementationPlan.viewModuleData\' | translate}} </a> </div> <div flex="15" flex-xs="10"> {{isOccupationModuleDataSaved(module) ? \'main.yes\' : \'main.no\' | translate}} </div> </div> </div> </div> </div> <!--KUTSETE/OSAKUTSETE MOODULID--> <div ng-repeat="occupation in occupations | orderBy: [\'occupation\', \'-occupation.validThru\', \'-occupation.validFrom\']:false:compareUsingLanguage" layout="column"> <div class="occupation-header align-center"> <span ng-show="isOccupation">{{\'stateCurriculum.enter.occupation.occupation\' | translate}} {{$index + 1}}:&nbsp; {{occupation.occupation | hoisValidDates }}</span> <span ng-show="!isOccupation">{{\'stateCurriculum.enter.occupation.partial\' | translate}} {{$index + 1}}:&nbsp; {{occupation.occupation | hoisValidDates }}</span> </div> <div layout="column" ng-repeat="type in moduleTypes | filter: filterTypesWithoutModules(occupation.occupation.code, modules)" class="lowerBorder"> <div layout="row" flex="100" class="occupation-row align-center border-bottom odd"> <div flex="5" flex-xs="0">&nbsp;</div> <div flex="15" style="word-wrap: break-word">{{currentLanguageNameField(type)}} ({{getTotalCredits(modules | filter: filterModulesByType(type.code, occupation.occupation.code))}} EKAP)</div> <div layout="column" flex="75"> <div flex="100" ng-repeat="module in modules | filter: filterModulesByType(type.code, occupation.occupation.code) | orderBy: \'nameEt\'" layout="row" class="align-center"> <a flex="40" flex-xs="45" style="word-wrap: break-word" ng-click="openViewModuleDialog(module)" href="">{{occupationModuleHasBaseModule(module) ? \'* \' : \'\'}}{{currentLanguageNameField(module)}}</a> <span flex="15" style="word-wrap: break-word">{{module.credits}}&nbsp; EKAP</span> <div flex="30"> <a class="md-primary" ng-click="openAddModuleDataDialog(module)" ng-if="isOccupationModuleDataSaved(module)"> {{\'module.implementationPlan.viewModuleData\' | translate}} </a> </div> <div flex="15" flex-xs="10"> {{isOccupationModuleDataSaved(module) ? \'main.yes\' : \'main.no\' | translate}} </div> </div> </div> </div> </div> <!--OSAKUTSETE MOODULID--> <div ng-repeat="partOccupation in occupation.partOccupations | orderBy: [partOccupation, \'-validThru\', \'-validFrom\']:false:compareUsingLanguage" layout="column"> <div class="occupation-header2 align-center">{{\'stateCurriculum.enter.occupation.partial\' | translate}} {{$index + 1}}:&nbsp; <hois-classifier-value ng-model="partOccupation" main-classifier-code="OSAKUTSE" show-date></hois-classifier-value> </div> <div layout="column" ng-repeat="type in moduleTypes | filter: filterTypesWithoutModules(partOccupation, modules)" class="lowerBorder"> <div layout="row" flex="100" class="occupation-row align-center border-bottom odd"> <div flex="5" flex-xs="0">&nbsp;</div> <div flex="15" style="word-wrap: break-word">{{currentLanguageNameField(type)}} ({{getTotalCredits(modules | filter: filterModulesByType(type.code, partOccupation))}} EKAP)</div> <div layout="column" flex="75"> <div flex="100" ng-repeat="module in modules | filter: filterModulesByType(type.code, partOccupation) | orderBy: \'nameEt\'" layout="row" class="align-center"> <a flex="50" flex-xs="45" style="word-wrap: break-word" ng-click="openViewModuleDialog(module)" href="">{{occupationModuleHasBaseModule(module) ? \'* \' : \'\'}}{{currentLanguageNameField(module)}}</a> <span flex="15" style="word-wrap: break-word">{{module.credits}}&nbsp; EKAP</span> <div flex="30"> <a class="md-primary" ng-click="openAddModuleDataDialog(module)" ng-if="isOccupationModuleDataSaved(module) "> {{\'module.implementationPlan.viewModuleData\' | translate}} </a> </div> <div flex="15" flex-xs="10"> {{isOccupationModuleDataSaved(module) ? \'main.yes\' : \'main.no\' | translate}} </div> </div> </div> </div> </div> </div> <!--SPETSKUTSETE MOODULID--> <div ng-repeat="speciality in occupation.specialities | orderBy: [speciality, \'-validThru\', \'-validFrom\']:false:compareUsingLanguage" layout="column"> <div class="occupation-header2 align-center">{{\'stateCurriculum.enter.occupation.specialty\' | translate}} {{$index + 1}}: &nbsp; <hois-classifier-value ng-model="speciality" main-classifier-code="SPETSKUTSE" show-date></hois-classifier-value> </div> <div layout="column" ng-repeat="type in moduleTypes | filter: filterTypesWithoutModules(speciality, modules)" class="lowerBorder"> <div layout="row" flex="100" class="occupation-row align-center border-bottom odd"> <div flex="5" flex-xs="0">&nbsp;</div> <div flex="15" style="word-wrap: break-word">{{currentLanguageNameField(type)}} ({{getTotalCredits(modules | filter: filterModulesByType(type.code, speciality))}} EKAP)</div> <div layout="column" flex="75"> <div flex="100" ng-repeat="module in modules | filter: filterModulesByType(type.code, speciality) | orderBy: \'nameEt\'" layout="row" class="align-center"> <a flex="50" flex-xs="45" style="word-wrap: break-word" ng-click="openViewModuleDialog(module)" href="">{{occupationModuleHasBaseModule(module) ? \'* \' : \'\'}}{{currentLanguageNameField(module)}}</a> <span flex="15">{{module.credits}}&nbsp; EKAP</span> <div flex="30"> <a class="md-primary" ng-click="openAddModuleDataDialog(module)" ng-if="isOccupationModuleDataSaved(module) "> {{\'module.implementationPlan.viewModuleData\' | translate}} </a> </div> <div flex="15" flex-xs="10"> {{isOccupationModuleDataSaved(module) ? \'main.yes\' : \'main.no\' | translate}} </div> </div> </div> </div> </div> </div> </div> </fieldset> <div>&nbsp;</div> <fieldset tabindex="10"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'curriculum.yearCapacitiesTable\' | translate}}</legend> <md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column ng-repeat="yc in implementationPlan.yearCapacities track by $index">{{$index+1}}.&nbsp;{{\'module.studyYearLowercase\' | translate}}</th> </tr> </thead> <tbody md-body> <tr md-row> <td md-cell ng-repeat="yc in implementationPlan.yearCapacities track by $index">{{yc}}</td> </tr> </tbody> </table> </md-table-container> </fieldset> <div>&nbsp;</div> <fieldset tabindex="11"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'curriculum.implementationPlanStatus\' | translate}}</legend> <div style="overflow: auto"> <div layout="row" flex="100"> <md-input-container flex="30" flex-sm="100" flex-xs="100"> <label>{{\'main.validFrom\' | translate}}</label> <md-datepicker ng-model="implementationPlan.validFrom" md-open-on-focus disabled></md-datepicker> </md-input-container> <md-input-container flex="20" flex-sm="100" flex-xs="100" flex-offset-xs="0" flex-offset-sm="0" flex-offset="4"> <label>{{\'main.validTo\' | translate}}</label> <md-datepicker ng-model="implementationPlan.validThru" md-min-date="implementationPlan.validFrom" md-open-on-focus disabled></md-datepicker> </md-input-container> </div> <div layout="row" class="top-margin form-readonly"> <md-input-container flex="30" flex-sm="100"> <label>{{\'main.status\' | translate}}</label> <hois-classifier-value ng-model="implementationPlan.status" main-classifier-code="OPPEKAVA_VERSIOON_STAATUS"></hois-classifier-value> </md-input-container> </div> </div> </fieldset> <hois-created-modified object="implementationPlan"></hois-created-modified> </form> <div layout="row"> <div flex layout-xs="column"> <span ng-show="implementationPlan.status === VERSION_STATUS.S" layout-xs="column"> <md-button class="md-raised md-primary" ng-click="goToEditForm()" ng-if="implementationPlan.canChange">{{\'main.button.change\' | translate}}</md-button> <md-button ng-click="confirm()" class="md-raised" ng-if="implementationPlan.canConfirm">{{\'curriculum.statuschange.implementationPlan.button.verify\' | translate}}</md-button> <md-button ng-click="setStatusClosed()" class="md-raised" ng-if="implementationPlan.canClose">{{\'curriculum.statuschange.implementationPlan.button.close\' | translate}}</md-button> <md-button class="md-raised md-default" ng-click="copy()" ng-if="implementationPlan.canChange">{{\'main.button.copy\' | translate}}</md-button> </span> <span ng-show="implementationPlan.status === VERSION_STATUS.K" layout-xs="column"> <md-button class="md-raised md-primary" ng-click="goToEditForm()" ng-if="implementationPlan.canChange">{{\'main.button.change\' | translate}}</md-button> <md-button class="md-raised md-default" ng-click="changeStatusUnderRevision()" ng-if="implementationPlan.canChange && implementationPlan.canSetUnderRevision">{{\'curriculum.statuschange.implementationPlan.button.changeStatusUnderRevision\' | translate}}</md-button> <md-button ng-click="setStatusClosed()" class="md-raised" ng-if="implementationPlan.canClose">{{\'curriculum.statuschange.implementationPlan.button.close\' | translate}}</md-button> <md-button class="md-raised md-default" ng-click="copy()" ng-if="implementationPlan.canChange">{{\'main.button.copy\' | translate}}</md-button> </span> <span ng-show="implementationPlan.status === VERSION_STATUS.C" layout-xs="column"> <md-button class="md-raised md-default" ng-click="copy()" ng-if="implementationPlan.canChange">{{\'main.button.copy\' | translate}}</md-button> </span> <!--\r\n      <a href="{{implementationPlanPdfUrl}}" target="_blank" class="md-button md-raised" ng-if="implementationPlan.id">{{\'main.button.print\' | translate}}</a>\r\n      --> <a href="{{curriculumVersionPdfUrl}}" target="_blank" class="md-button md-raised" ng-if="showPrintButton()">{{\'module.implementationPlan.print\' | translate}}</a> <a href="{{curriculumVersionModulesPdfUrl}}" target="_blank" class="md-button md-raised" ng-if="showPrintButton()">{{\'module.implementationPlan.printModules\' | translate}}</a> <md-button class="md-raised md-default" ng-click="back(\'#/vocationalCurriculum/\' + curriculumId + \'/view\')">{{\'main.button.back\' | translate}}</md-button> </div> </div> </div> <style>.lowerBorder {\r\n    border-bottom: solid 1px #E0E0E0;\r\n  }</style>'),a.put("vocationalCurriculum/implementationPlan/module.view.dialog.html",'<md-dialog aria-label="module add dialog" flex="60" flex-xs="100" class="form-readonly"> <form ng-cloak name="dialogForm"> <md-toolbar> <div class="md-toolbar-tools"> <h2 flex>{{"module.viewToughtModule" | translate}}</h2> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <span flex></span> <div class="ois-form-layout" layout="column" layout-margin ng-cloak> <fieldset tabindex="1" ng-if="module.canHaveOccupations"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small"> {{module.occupation ? \'module.occupationPartOccupationSpecialize\' : \'module.partOccupation\' | translate}} </legend> <div layout="column"> <div ng-repeat="speciality in item.specialities" layout="row"> <div flex="5">&nbsp;</div> <md-checkbox ng-model="specialitiesSelected[speciality.code]" aria-label="{{currentLanguageNameField(speciality)}}" disabled> {{currentLanguageNameField(speciality)}} </md-checkbox> </div> </div> <div layout="column"> <div ng-repeat="item in module.curriculumOccupations | orderBy: \'occupation\'"> <md-checkbox ng-model="occupationsSelected[item.occupation]" disabled> <hois-classifier-value ng-model="item.occupation" main-classifier-codes="KUTSE,OSAKUTSE" class="inline" show-date></hois-classifier-value> </md-checkbox> <div layout="column"> <div ng-repeat="partOccupation in item.partOccupations | orderBy" flex layout="row"> <div flex="5">&nbsp;</div> <md-checkbox ng-model="occupationsSelected[partOccupation]" disabled> <hois-classifier-value ng-model="partOccupation" main-classifier-code="OSAKUTSE" class="inline" show-date></hois-classifier-value> ({{\'stateCurriculum.enter.occupation.partial\' | translate}}) </md-checkbox> </div> </div> <div layout="column"> <div ng-repeat="speciality in item.specialities | orderBy" layout="row"> <div flex="5">&nbsp;</div> <md-checkbox ng-model="specialitiesSelected[speciality]" disabled> <hois-classifier-value ng-model="speciality" main-classifier-code="SPETSKUTSE" class="inline" show-date></hois-classifier-value> ({{\'stateCurriculum.enter.occupation.specialty\' | translate}}) </md-checkbox> </div> </div> </div> </div> </fieldset> <div>&nbsp;</div> <div layout="row" flex> <md-input-container flex="45"> <label>{{\'module.type\' | translate}}</label> <hois-classifier-value name="module" ng-model="module.module" main-classifier-code="KUTSEMOODUL"></hois-classifier-value> </md-input-container> <md-input-container flex="10" flex-offset="5"> <label>{{\'module.credits\' | translate}}</label> <hois-value value="module.credits.toString()"></hois-value> </md-input-container> </div> <md-input-container flex> <label>{{\'module.nameEt\' | translate}}</label> <hois-value value="module.nameEt"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'module.nameEn\' | translate}}</label> <hois-value value="module.nameEn"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'module.objectivesEt\' | translate}}</label> <hois-value value="module.objectivesEt" class="scrollable"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'module.objectivesEn\' | translate}}</label> <hois-value value="module.objectivesEt" class="scrollable"></hois-value> </md-input-container> <fieldset tabindex="1"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'module.studyOutcome\' | translate}}</legend> <div layout="column"> <div ng-repeat="item in module.outcomes | orderBy: \'orderNr\'" class="occupation-row align-center" layout="row" flex> <div flex="45"> <p class="scrollable">{{item.outcomeEt}}</p> </div> <div flex="50" flex-offset="5"> <p class="scrollable">{{item.outcomeEn}}</p> </div> </div> </div> </fieldset> <div>&nbsp;</div> <md-input-container flex> <label>{{\'stateCurriculum.enter.module.criteriaEt\' | translate}}</label> <hois-value value="module.assessmentsEt" class="scrollable"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'stateCurriculum.enter.module.criteriaEn\' | translate}}</label> <hois-value value="module.assessmentsEn" class="scrollable"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'module.competencesAquired\' | translate}}</label> <hois-classifier-value ng-model="module.competences" main-classifier-code="KOMPETENTS"></hois-classifier-value> </md-input-container> <md-input-container flex> <md-checkbox ng-model="module.practice" disabled>{{\'module.practice\' | translate}}</md-checkbox> </md-input-container> <md-input-container> <md-checkbox ng-model="module.isAdditional" aria-label="{{\'stateCurriculum.enter.module.isAdditional\' | translate}}" disabled> {{\'stateCurriculum.enter.module.isAdditional\' | translate}} </md-checkbox> </md-input-container> </div> </md-dialog-content> <span flex></span> <md-dialog-actions layout="row" layout-align="start center"> <md-button class="md-raised" ng-click="cancel()">{{"main.button.close" | translate}}</md-button> </md-dialog-actions> </form> </md-dialog>'),a.put("vocationalCurriculum/implementationPlan/occupation.module.edit.html",'<div class="ois-form-layout-padding nomargin"> <div layout="column" flex ng-show="viewMode === viewModes.NEW"> <div> <h2 translate="module.occupationalModuleDataInsertion" translate-values="{{curriculumModule}}"></h2> </div> <div layout="column" flex layout-gt-sm="row"> <md-radio-group class="md-primary base-module-menu" ng-model="startMode" layout="row" layout-align-gt-sm="center center"> <md-radio-button ng-value="startModes.BASE_MODULE" aria-label="Baasmoodul"> {{\'basemodule.label\' | translate}} </md-radio-button> <md-radio-button ng-value="startModes.COPY_MODULE" aria-label="Kopeeri kõik andmed baasmodulist"> {{\'basemodule.copyModule\' | translate}} </md-radio-button> <md-radio-button ng-value="startModes.INDEPENDENT" aria-label="Sistestan ise"> {{\'basemodule.enterYourself\' | translate}} </md-radio-button> </md-radio-group> <div layout="row" flex> <md-button class="md-primary md-raised" ng-click="continue()">Jätka</md-button> </div> </div> </div> <md-button class="md-raised" ng-show="hasBaseModuleRight && occupationModule.id && curriculumModule.id && !curriculumModule.baseModule" ng-click="createBaseModule()">{{\'basemodule.operation.createNewBaseModule.label\' | translate}}</md-button> <div layout="column" flex layout-gt-sm="row" ng-show="occupationModule.id && !occupationModule.baseModule && curriculumModule.baseModule"> <div layout="row" flex ng-show="viewMode !== viewModes.REPLACE"> <md-button class="md-raised" ng-click="viewMode = viewModes.REPLACE" ng-disabled="!replaceForm.themes[occupationModule.id]">{{\'basemodule.operation.replace.label\' | translate}}</md-button> <p class="md-body-1" style="color: #dd2c00" ng-show="!replaceForm.themes[occupationModule.id]">{{\'basemodule.warning.tooManyThemes\' | translate}}</p> </div> <form name="replaceModuleForm" ng-cloak ng-show="viewMode === viewModes.REPLACE" layout="column" flex> <div class="form-readonly" layout="column"> <md-input-container flex> <label>{{\'basemodule.curriculumVersion\' | translate}}</label> <hois-value class="textInput" value="currentLanguageNameField(curriculumVersion)"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'module.\' + currentLanguageNameVariable() | translate}}</label> <hois-value class="textInput" value="currentLanguageNameField(curriculumModule)"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'module.credits\' | translate}}</label> <hois-value class="textInput" value="curriculumModule.credits"></hois-value> </md-input-container> </div> <md-input-container flex> <label>{{\'basemodule.label\' | translate}}</label> <input ng-value="currentLanguageNameField(replaceForm.baseModule)" type="text" disabled> </md-input-container> <div ng-show="replaceForm.themes[occupationModule.id].length > 0"> <fieldset tabindex="0"> <legend md-colors="{color: \'default-primary-800\'}" class="md-title-small">{{\'basemodule.themes\' | translate}}</legend> <p class="md-body-1" style="color: #dd2c00; margin: 3px" ng-if="replaceForm.showOneToOneThemeError">{{\'basemodule.warning.oneToOneTheme\' | translate}}</p> <div layout="column" ng-repeat="oModule in replaceForm.occupationModules"> <div flex> <div layout="row" ng-repeat="theme in replaceForm.themes[oModule.id] | orderBy: \'+id\'"> <p class="md-body-1" flex flex-offset="0" flex-offset-gt-sm="20">{{currentLanguageNameField(theme)}}</p> <md-input-container flex="50" flex-offset="10"> <label>{{\'basemodule.baseModuleTheme\' | translate}}</label> <md-select ng-model="replaceForm.connections[theme.id]" required ng-change="selectChange(oModule.id, theme.id, replaceForm.connections[theme.id])" ng-model-options="{trackBy: \'$value.id\'}"> <md-option ng-value="bTheme" ng-repeat="bTheme in replaceForm.baseModuleThemes | orderBy: \'+id\'">{{currentLanguageNameField(bTheme)}}</md-option> </md-select> </md-input-container> </div> </div> </div> </fieldset> </div> <br> <div layout="row" flex> <md-button class="md-primary md-raised" ng-click="replace()">{{\'main.button.replace\' | translate}}</md-button> <md-button class="md-raised" ng-click="viewMode = viewModes.MAIN">{{\'main.button.back\' | translate}}</md-button> </div> </form> </div> <div layout="row" flex ng-show="occupationModule.id && occupationModule.baseModule"> <md-button class="md-raised" ng-click="release()">{{\'basemodule.operation.release.label\' | translate}}</md-button> </div> <form name="occupationModuleForm" ng-cloak ng-show="viewMode === viewModes.MAIN"> <div> <h2 translate="module.occupationalModuleDataInsertion" translate-values="{{curriculumModule}}"></h2> </div> <div layout="column"> <fieldset tabindex="1"> <legend md-colors="{color: \'default-primary-800\'}" class="md-title-small">{{\'module.capacityDistribution\' | translate}}</legend> <div layout="row" style="padding-bottom:1em" flex class="secondary-table-header"> <div flex="30">&nbsp;</div> <div flex="30">{{\'module.capacity\' | translate}}</div> <div flex="40" layout="row">{{\'module.contactStudy\' | translate}}</div> </div> <div ng-repeat="item in occupationModule.capacities | orderBy: \'nameEt\' track by item.capacityType" layout="row" class="occupation-module-capacity-row"> <div flex="30" class="occupation-module-capacity">{{currentLanguageNameField(item)}}</div> <div flex="30"> <md-input-container flex> <input ng-model="item.hours" type="number" min="0" max="9999" pattern="^\\d+$" aria-label="capacity hours" class="small-input" ng-readonly="hasThemes()" ng-required="item.contact"> </md-input-container> </div> <div flex="40" layout="row"> <md-checkbox ng-model="item.contact" aria-label="capacity contact" ng-disabled="hasThemes()" class="occupation-module-capacity-contact"></md-checkbox> </div> </div> </fieldset> <div>&nbsp;</div> <md-input-container flex> <label>{{\'module.requirements\' | translate}}</label> <textarea ng-model="occupationModule.requirementsEt" md-maxlength="20000" max-rows="10" required ng-readonly="occupationModule.baseModule"></textarea> </md-input-container> <md-input-container flex> <label>{{\'module.assessments\' | translate}}</label> <textarea ng-model="occupationModule.assessmentsEt" md-maxlength="20000" max-rows="10" required ng-readonly="occupationModule.baseModule"></textarea> </md-input-container> <md-input-container flex> <label>{{\'module.learningMethods\' | translate}}</label> <textarea ng-model="occupationModule.learningMethodsEt" md-maxlength="20000" max-rows="10" ng-readonly="occupationModule.baseModule"></textarea> </md-input-container> <md-input-container flex> <label>{{\'module.assessmentMethodsAndTasks\' | translate}}</label> <textarea ng-model="occupationModule.assessmentMethodsEt" md-maxlength="20000" max-rows="10" ng-readonly="occupationModule.baseModule"></textarea> </md-input-container> <md-input-container flex> <label>{{\'module.independentStudyDescription\' | translate}}</label> <textarea ng-model="occupationModule.independentStudyEt" md-maxlength="20000" max-rows="2" ng-readonly="occupationModule.baseModule"></textarea> </md-input-container> <md-input-container flex> <label>{{\'module.studyMaterials\' | translate}}</label> <textarea ng-model="occupationModule.studyMaterials" md-maxlength="20000" max-rows="2" ng-readonly="occupationModule.baseModule"></textarea> </md-input-container> <div>&nbsp;</div> <fieldset tabindex="2" layout="column"> <legend md-colors="{color: \'default-primary-800\'}" class="md-title-small">{{\'module.gradeFormation\' | translate}}</legend> <div flex layout="row"> <span flex="30" class="common-label">{{\'module.assessmentType\' | translate}}</span> <hois-classifier-radio layout="row" ng-model="occupationModule.assessment" model-value-attr="code" main-classifier-code="KUTSEHINDAMISVIIS" required class="md-primary" ng-disabled="occupationModule.baseModule"></hois-classifier-radio> </div> <div>&nbsp;</div> <md-input-container flex> <label>{{\'module.totalGradeDescription\' | translate}}</label> <textarea ng-model="occupationModule.totalGradeDescription" md-maxlength="20000" max-rows="2" required ng-readonly="occupationModule.baseModule"></textarea> </md-input-container> <div>&nbsp;</div> <div ng-show="occupationModule.assessment === \'KUTSEHINDAMISVIIS_E\'" layout="column"> <md-input-container flex> <label>{{\'module.grade3Description\' | translate}}</label> <textarea ng-model="occupationModule.grade3Description" md-maxlength="20000" max-rows="2" ng-required="occupationModule.assessment === \'KUTSEHINDAMISVIIS_E\'" ng-readonly="occupationModule.baseModule"></textarea> </md-input-container> <md-input-container flex> <label>{{\'module.grade4Description\' | translate}}</label> <textarea ng-model="occupationModule.grade4Description" md-maxlength="20000" max-rows="2" ng-required="occupationModule.assessment === \'KUTSEHINDAMISVIIS_E\'" ng-readonly="occupationModule.baseModule"></textarea> </md-input-container> <md-input-container flex> <label>{{\'module.grade5Description\' | translate}}</label> <textarea ng-model="occupationModule.grade5Description" md-maxlength="20000" max-rows="2" ng-required="occupationModule.assessment === \'KUTSEHINDAMISVIIS_E\'" ng-readonly="occupationModule.baseModule"></textarea> </md-input-container> </div> <div ng-show="occupationModule.assessment === \'KUTSEHINDAMISVIIS_M\'" layout="column" flex> <md-input-container flex> <label>{{\'module.gradeADescription\' | translate}}</label> <textarea ng-model="occupationModule.passDescription" md-maxlength="20000" max-rows="10" ng-required="occupationModule.assessment === \'KUTSEHINDAMISVIIS_M\'" ng-readonly="occupationModule.baseModule"></textarea> </md-input-container> </div> </fieldset> <div>&nbsp;</div> <fieldset tabindex="3"> <legend md-colors="{color: \'default-primary-800\'}" class="md-title-small">{{\'module.themes\' | translate}}</legend> <div layout="column"> <div flex="10"> <md-button class="md-raised" ng-click="openAddThemeDialog()" ng-if="occupationModule.id && !occupationModule.baseModule">{{\'main.button.add\' | translate}}</md-button> </div> <div flex> <md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'module.themeName\' | translate}}</th> <th md-column>{{\'module.capacityEkapPerHour\' | translate}}</th> <th md-column>{{\'module.subthemes\' | translate}}</th> <th md-column>{{\'module.studyYear\' | translate}}</th> <th md-column ng-if="!occupationModule.baseModule"></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="theme in occupationModule.themes | orderBy: currentLanguageNameField()"> <td md-cell> <a class="md-primary one-row" ng-click="openAddThemeDialog(theme)">{{currentLanguageNameField(theme)}}</a> </td> <td md-cell> {{theme.credits}}/{{theme.hours}} </td> <td md-cell> <p class="scrollable">{{theme.subthemes}}</p> </td> <td md-cell> {{theme.studyYearNumber}} </td> <td md-cell ng-if="!occupationModule.baseModule"> <a class="remove" ng-click="deleteTheme(theme)"> &times; </a> </td> </tr> </tbody> </table> </md-table-container> </div> </div> </fieldset> <div flex>&nbsp;</div> <fieldset tabindex="4" layout="column"> <legend md-colors="{color: \'default-primary-800\'}" class="md-title-small">{{\'module.proportionPerStudyYear\' | translate}}</legend> <div layout="row"> <md-input-container flex ng-repeat="yc in studyYears track by $index"> <label>{{$index+1}}.&nbsp;{{\'module.studyYearLowercase\' | translate}}</label> <input ng-disabled="occupationModule.themes.length > 0" ng-model="occupationModule.yearCapacities[$index].credits" type="number" min="0" max="999" pattern="^\\d+(\\.\\d{1})?$" aria-label="year capacity credits" name="yearCapacities{{$index}}" required> <div ng-messages="dialogForm[\'yearCapacities\'+$index].$error" ng-show="dialogForm[\'yearCapacities\'+$index].$dirty"> <div ng-message="min"> {{\'main.messages.error.positive\' | translate}} </div> <div ng-message="max"> {{\'curriculum.error.max999\' | translate}} </div> <div ng-message="pattern"> {{\'stateCurriculum.error.decimalPresision\' | translate}} </div> </div> </md-input-container> </div> </fieldset> <div flex>&nbsp;</div> <md-autocomplete name="teacher" md-selected-item="occupationModule.teacher" md-search-text="occupationModule.supervisor" md-items="teacher in searchTeacher(occupationModule.supervisor)" md-item-text="currentLanguageNameField(teacher)" md-min-length="1" md-floating-label="{{\'module.supervisor\' | translate}}" md-no-cache class="small-margin" required md-require-match ng-disabled="occupationModule.baseModule" flex> <md-item-template> <span md-highlight-text="occupationModule.supervisor" md-highlight-flags="^i">{{currentLanguageNameField(teacher)}}</span> </md-item-template> <md-not-found> {{\'main.messages.error.notFound\' | translate}} </md-not-found> </md-autocomplete> </div> <span flex></span> <md-button class="md-raised md-primary" ng-click="save()">{{"main.button.save" | translate}}</md-button> <md-button ng-if="occupationModule.id" class="md-raised md-default" ng-click="delete()">{{\'main.button.delete\' | translate}}</md-button> <md-button class="md-raised" ng-click="back(backToEditForm, occupationModuleForm)">{{"main.button.back" | translate}}</md-button> </form> </div> <style>.base-module-menu {\r\n    padding-right: 20px;\r\n  }\r\n\r\n  @media screen and (max-width: 840px) {\r\n    .base-module-menu {\r\n      padding-right: 0;\r\n    }\r\n  }\r\n  \r\n  .form-readonly > md-input-container {\r\n    margin-bottom: 18px !important;\r\n  }\r\n\r\n  .md-select-menu-container {\r\n    max-width: -moz-calc(100vw - 1em);\r\n    max-width: -webkit-calc(100vw - 1em);\r\n    max-width: calc(100vw - 1em);\r\n  }</style>'),
a.put("vocationalCurriculum/implementationPlan/occupation.module.theme.edit.dialog.html",'<md-dialog aria-label="vocational curriculum implementation plan module theme add dialog" flex="60" flex-xs="100"> <form name="dialogForm" ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2>{{"module.addingTheme" | translate}}</h2> <span flex></span> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <div class="ois-form-layout-padding nomargin" layout="column" ng-cloak> <md-input-container> <label>{{\'theme.name\' | translate}}</label> <input ng-model="occupationModuleTheme.nameEt" type="text" required md-maxlength="255" ng-readonly="hasBaseModule"> </md-input-container> <div layout="column" layout-gt-md="row"> <div layout="column" layout-gt-sm="row" flex-gt-md="50" flex="100"> <md-input-container flex-gt-sm="40" flex="100"> <label>{{\'theme.capacityAndUnit\' | translate}}</label> </md-input-container> <br><br> <div layout="row" flex-gt-sm="60" flex="100"> <md-input-container flex-gt-sm="50" flex="100"> <label>EKAP</label> <input ng-model="occupationModuleTheme.credits" name="credits" type="number" min="0" max="999" pattern="^\\d+(\\.\\d{1})?$" ng-change="setDefaultHours()" required ng-readonly="hasBaseModule"> <div ng-messages="dialogForm.credits.$error" ng-show="dialogForm.credits.$dirty"> <div ng-message="min"> {{\'main.messages.error.positive\' | translate}} </div> <div ng-message="max"> {{\'curriculum.error.max999\' | translate}} </div> <div ng-message="pattern"> {{\'stateCurriculum.error.decimalPresision\' | translate}} </div> </div> </md-input-container> <md-input-container flex-gt-sm="50" flex="100"> <label>{{\'main.hour\' | translate}}</label> <input ng-model="occupationModuleTheme.hours" name="hours" type="number" min="0" max="9999" pattern="^\\d+$" required ng-change="setDefaultCredits()" ng-readonly="hasBaseModule"> <div ng-messages="dialogForm.hours.$error" ng-show="dialogForm.hours.$dirty"> <div ng-message="min"> {{\'main.messages.error.positive\' | translate}} </div> <div ng-message="max"> {{\'curriculum.error.max9999\' | translate}} </div> <div ng-message="pattern"> {{\'stateCurriculum.enter.credits.integer\' | translate}} </div> </div> </md-input-container> </div> </div> <div layout="row" flex-gt-md="50" flex="100"> <md-input-container flex-gt-sm="50" flex="100"> <label>{{\'theme.proportionInModule\' | translate}}</label> <input ng-model="occupationModuleTheme.proportion" type="number" name="proportion" min="0" max="999" pattern="^\\d+(\\.\\d{1})?$"> <div ng-messages="dialogForm.proportion.$error" ng-show="dialogForm.proportion.$dirty"> <div ng-message="min"> {{\'main.messages.error.positive\' | translate}} </div> <div ng-message="max"> {{\'curriculum.error.max999\' | translate}} </div> <div ng-message="pattern"> {{\'stateCurriculum.error.decimalPresision\' | translate}} </div> </div> </md-input-container> <md-input-container flex-gt-sm="50" flex="100"> <label>{{\'module.studyYear\' | translate}}</label> <md-select ng-model="occupationModuleTheme.studyYearNumber"> <md-option ng-value="null"></md-option> <md-option ng-repeat="studyYearNumber in studyYears" ng-value="studyYearNumber" aria-label="{{studyYearNumber}}">{{studyYearNumber}}</md-option> </md-select> </md-input-container> </div> </div> <div flex> <fieldset tabindex="1"> <legend md-colors="{color: \'default-primary-800\'}" class="md-title-small">{{\'theme.capacityDistribution\' | translate}}</legend> <div layout="row" style="padding-bottom:1em" flex class="secondary-table-header"> <div flex="30">&nbsp;</div> <div flex="30">{{\'module.capacity\' | translate}}</div> <div flex="40" layout="row">{{\'module.contactStudy\' | translate}}</div> </div> <div ng-repeat="item in occupationModuleTheme.capacities | orderBy: \'nameEt\' track by item.capacityType" layout="row" class="secondary-table-row"> <div flex="30" class="occupation-module-capacity">{{currentLanguageNameField(item)}}</div> <div flex="30"> <md-input-container flex> <input ng-model="item.hours" type="number" min="0" max="9999" pattern="^\\d+$" aria-label="capacity hours" class="small-input" ng-required="item.contact"> </md-input-container> </div> <div flex="40" layout="row"> <md-checkbox ng-model="item.contact" aria-label="capacity contact" class="occupation-module-capacity-contact"></md-checkbox> </div> </div> </fieldset> </div> <div>&nbsp;</div> <md-input-container flex> <label>{{\'module.subthemes\' | translate}}</label> <textarea ng-model="occupationModuleTheme.subthemes" md-maxlength="10000" max-rows="10" ng-readonly="hasBaseModule"></textarea> </md-input-container> <md-input-container flex> <label>{{\'theme.connectionToStudyOutcome\' | translate}}</label> <md-select ng-model="occupationModuleTheme.outcomes" multiple ng-disabled="hasBaseModule"> <md-option ng-repeat="outcome in outcomes" ng-value="outcome.id" aria-label="{{currentLanguage() === \'en\' ? outcome.outcomeEn : outcome.outcomeEt}}">{{currentLanguage() === \'en\' ? outcome.outcomeEn : outcome.outcomeEt}}</md-option> </md-select> </md-input-container> <div>&nbsp;</div> <div flex> <fieldset tabindex="2"> <legend md-colors="{color: \'default-primary-800\'}" class="md-title-small">{{\'module.themeGradeFormation\' | translate}}</legend> <div layout="column"> <div flex layout="row"> <span flex="30" class="common-label">{{\'theme.assessmentType\' | translate}}</span> <md-radio-group ng-model="occupationModuleTheme.assessment" layout="row" ng-disabled="hasBaseModule"> <md-radio-button ng-repeat="option in assessments | orderBy: \'nameEt\' track by option.code" ng-value="option.code" aria-label="{{ currentLanguageNameField(option) }}"> {{ currentLanguageNameField(option) }} </md-radio-button> <md-radio-button ng-value="null" aria-label="{{\'module.noAssessment\' | translate}}"> {{\'module.noAssessment\' | translate}} </md-radio-button> </md-radio-group> </div> <div>&nbsp;</div> <md-input-container flex ng-show="occupationModuleTheme.assessment"> <label>{{\'module.totalGradeDescription\' | translate}}</label> <textarea ng-model="occupationModuleTheme.totalGradeDescription" md-maxlength="10000" max-rows="10" ng-required="occupationModuleTheme.assessment" ng-readonly="hasBaseModule"></textarea> </md-input-container> <div ng-show="occupationModuleTheme.assessment === \'KUTSEHINDAMISVIIS_E\'" layout="column" flex> <md-input-container flex> <label>{{\'module.grade3Description\' | translate}}</label> <textarea ng-model="occupationModuleTheme.grade3Description" md-maxlength="10000" max-rows="10" ng-required="occupationModuleTheme.assessment === \'KUTSEHINDAMISVIIS_E\'" ng-readonly="hasBaseModule"></textarea> </md-input-container> <md-input-container flex> <label>{{\'module.grade4Description\' | translate}}</label> <textarea ng-model="occupationModuleTheme.grade4Description" md-maxlength="10000" max-rows="10" ng-required="occupationModuleTheme.assessment === \'KUTSEHINDAMISVIIS_E\'" ng-readonly="hasBaseModule"></textarea> </md-input-container> <md-input-container flex> <label>{{\'module.grade5Description\' | translate}}</label> <textarea ng-model="occupationModuleTheme.grade5Description" md-maxlength="10000" max-rows="10" ng-required="occupationModuleTheme.assessment === \'KUTSEHINDAMISVIIS_E\'" ng-readonly="hasBaseModule"></textarea> </md-input-container> </div> <div ng-show="occupationModuleTheme.assessment === \'KUTSEHINDAMISVIIS_M\'" layout="column" flex> <md-input-container flex> <label>{{\'module.gradeADescription\' | translate}}</label> <textarea ng-model="occupationModuleTheme.passDescription" md-maxlength="10000" max-rows="2" ng-required="occupationModuleTheme.assessment === \'KUTSEHINDAMISVIIS_M\'" ng-readonly="hasBaseModule"></textarea> </md-input-container> </div> </div> </fieldset> </div> <div>&nbsp;</div> </div> </md-dialog-content> <span flex></span> <md-dialog-actions layout="row" layout-align="start center"> <md-button class="md-raised md-primary" ng-click="saveTheme()">{{"main.button.save" | translate}}</md-button> <md-button class="md-raised" ng-click="cancel()">{{"main.button.close" | translate}}</md-button> </md-dialog-actions> </form> </md-dialog>'),a.put("vocationalCurriculum/implementationPlan/occupation.module.theme.view.dialog.html",'<md-dialog aria-label="vocational curriculum implementation plan module theme add dialog" flex="60" flex-xs="100"> <form name="dialogForm" ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2>{{"module.viewingTheme" | translate}}</h2> <span flex></span> <md-button class="md-icon-button" ng-click="cancel()"> <md-icon md-font-set="material-icons">close</md-icon> </md-button> </div> </md-toolbar> <md-dialog-content> <div class="ois-form-layout-padding nomargin" layout="column" ng-cloak> <md-input-container> <label>{{\'theme.name\' | translate}}</label> <input ng-model="occupationModuleTheme.nameEt" type="text" readonly> </md-input-container> <div layout="column" layout-gt-md="row"> <div layout="column" layout-gt-sm="row" flex-gt-md="50" flex="100"> <md-input-container flex-gt-sm="40" flex="100"> <label>{{\'theme.capacityAndUnit\' | translate}}</label> </md-input-container> <br><br> <div layout="row" flex-gt-sm="60" flex="100"> <md-input-container flex-gt-sm="50" flex="100"> <label>EKAP</label> <input ng-model="occupationModuleTheme.credits" name="credits" type="number" readonly> </md-input-container> <md-input-container flex-gt-sm="50" flex="100"> <label>{{\'main.hour\' | translate}}</label> <input ng-model="occupationModuleTheme.hours" name="hours" type="number" readonly> </md-input-container> </div> </div> <div layout="row" flex-gt-md="50" flex="100"> <md-input-container flex-gt-sm="50" flex="100"> <label>{{\'theme.proportionInModule\' | translate}}</label> <input ng-model="occupationModuleTheme.proportion" type="number" name="proportion" readonly> </md-input-container> <md-input-container flex-gt-sm="50" flex="100"> <label>{{\'module.studyYear\' | translate}}</label> <input ng-model="occupationModuleTheme.studyYearNumber" readonly> </md-input-container> </div> </div> <div flex> <fieldset tabindex="1"> <legend md-colors="{color: \'default-primary-800\'}" class="md-title-small">{{\'theme.capacityDistribution\' | translate}}</legend> <table flex class="module-capacities"> <tr style="padding-bottom:1em" flex class="secondary-table-header"> <td> </td><td>{{\'module.capacity\' | translate}} </td><td>{{\'module.contactStudy\' | translate}} </td></tr> <tr ng-repeat="item in occupationModuleTheme.capacities | orderBy: \'nameEt\' track by item.capacityType" class="secondary-table-row"> <td>{{currentLanguageNameField(item)}}</td> <td>{{item.hours}}</td> <td>{{item.contact ? \'main.yes\' : \'main.no\' | translate}}</td> </tr> </table> </fieldset> </div> <div>&nbsp;</div> <md-input-container flex> <label>{{\'module.subthemes\' | translate}}</label> <textarea ng-model="occupationModuleTheme.subthemes" max-rows="10" readonly></textarea> </md-input-container> <md-input-container flex> <label>{{\'theme.connectionToStudyOutcome\' | translate}}</label> <textarea ng-value="joinOutcomes(getOutcomesByIds(occupationModuleTheme.outcomes), \'\\n\')" max-rows="10" readonly></textarea> </md-input-container> <div>&nbsp;</div> <div flex> <fieldset tabindex="2"> <legend md-colors="{color: \'default-primary-800\'}" class="md-title-small">{{\'module.themeGradeFormation\' | translate}}</legend> <div layout="column" style="overflow: auto"> <div flex layout="row"> <span flex="30" class="common-label">{{\'theme.assessmentType\' | translate}}</span> <md-radio-group ng-model="occupationModuleTheme.assessment" layout="row" disabled> <md-radio-button ng-repeat="option in assessments | orderBy: \'nameEt\' track by option.code" ng-value="option.code" aria-label="{{ currentLanguageNameField(option) }}"> {{ currentLanguageNameField(option) }} </md-radio-button> <md-radio-button ng-value="null" aria-label="{{\'module.noAssessment\' | translate}}"> {{\'module.noAssessment\' | translate}} </md-radio-button> </md-radio-group> </div> <div>&nbsp;</div> <md-input-container flex ng-show="occupationModuleTheme.assessment"> <label>{{\'module.totalGradeDescription\' | translate}}</label> <textarea ng-model="occupationModuleTheme.totalGradeDescription" max-rows="10" readonly></textarea> </md-input-container> <div ng-show="occupationModuleTheme.assessment === \'KUTSEHINDAMISVIIS_E\'" layout="column" flex> <md-input-container flex> <label>{{\'module.grade3Description\' | translate}}</label> <textarea ng-model="occupationModuleTheme.grade3Description" max-rows="10" readonly></textarea> </md-input-container> <md-input-container flex> <label>{{\'module.grade4Description\' | translate}}</label> <textarea ng-model="occupationModuleTheme.grade4Description" max-rows="10" readonly></textarea> </md-input-container> <md-input-container flex> <label>{{\'module.grade5Description\' | translate}}</label> <textarea ng-model="occupationModuleTheme.grade5Description" max-rows="10" readonly></textarea> </md-input-container> </div> <div ng-show="occupationModuleTheme.assessment === \'KUTSEHINDAMISVIIS_M\'" layout="column" flex> <md-input-container flex> <label>{{\'module.gradeADescription\' | translate}}</label> <textarea ng-model="occupationModuleTheme.passDescription" max-rows="2" readonly></textarea> </md-input-container> </div> </div> </fieldset> </div> <div>&nbsp;</div> </div> </md-dialog-content> <span flex></span> <md-dialog-actions layout="row" layout-align="start center"> <md-button class="md-raised" ng-click="cancel()">{{"main.button.close" | translate}}</md-button> </md-dialog-actions> </form> </md-dialog>'),a.put("vocationalCurriculum/implementationPlan/occupation.module.view.html",'<div class="ois-form-layout-padding nomargin"> <form name="occupationModuleForm" ng-cloak> <div> <h2 translate="module.occupationalModuleDataView" translate-values="{{curriculumModule}}"></h2> </div> <div layout="column"> <fieldset tabindex="1"> <legend md-colors="{color: \'default-primary-800\'}" class="md-title-small">{{\'module.capacityDistribution\' | translate}}</legend> <div layout="row" style="padding-bottom:1em" flex class="secondary-table-header"> <div flex="30">&nbsp;</div> <div flex="30">{{\'module.capacity\' | translate}}</div> <div flex="40" layout="row">{{\'module.contactStudy\' | translate}}</div> </div> <div ng-repeat="item in occupationModule.capacities | orderBy: \'nameEt\' track by item.capacityType" layout="row" class="occupation-module-capacity-row"> <div flex="30" class="occupation-module-capacity">{{currentLanguageNameField(item)}}</div> <div flex="30"> <md-input-container flex> <input ng-model="item.hours" type="number" aria-label="capacity hours" class="small-input" readonly> </md-input-container> </div> <div flex="40" layout="row"> <md-checkbox ng-model="item.contact" aria-label="capacity contact" disabled class="occupation-module-capacity-contact"></md-checkbox> </div> </div> </fieldset> <div>&nbsp;</div> <md-input-container flex> <label>{{\'module.requirements\' | translate}}</label> <textarea ng-model="occupationModule.requirementsEt" max-rows="10" readonly></textarea> </md-input-container> <md-input-container flex> <label>{{\'module.assessments\' | translate}}</label> <textarea ng-model="occupationModule.assessmentsEt" max-rows="10" readonly></textarea> </md-input-container> <md-input-container flex> <label>{{\'module.learningMethods\' | translate}}</label> <textarea ng-model="occupationModule.learningMethodsEt" max-rows="10" readonly></textarea> </md-input-container> <md-input-container flex> <label>{{\'module.assessmentMethodsAndTasks\' | translate}}</label> <textarea ng-model="occupationModule.assessmentMethodsEt" max-rows="10" readonly></textarea> </md-input-container> <md-input-container flex> <label>{{\'module.independentStudyDescription\' | translate}}</label> <textarea ng-model="occupationModule.independentStudyEt" max-rows="2" readonly></textarea> </md-input-container> <md-input-container flex> <label>{{\'module.studyMaterials\' | translate}}</label> <textarea ng-model="occupationModule.studyMaterials" max-rows="2" readonly></textarea> </md-input-container> <div>&nbsp;</div> <fieldset tabindex="2" layout="column" style="overflow:auto"> <legend md-colors="{color: \'default-primary-800\'}" class="md-title-small">{{\'module.gradeFormation\' | translate}}</legend> <div flex layout="row"> <span flex="30" class="common-label">{{\'module.assessmentType\' | translate}}</span> <hois-classifier-radio layout="row" ng-model="occupationModule.assessment" model-value-attr="code" main-classifier-code="KUTSEHINDAMISVIIS" disabled class="md-primary"></hois-classifier-radio> </div> <div>&nbsp;</div> <md-input-container flex> <label>{{\'module.totalGradeDescription\' | translate}}</label> <textarea ng-model="occupationModule.totalGradeDescription" max-rows="2" readonly></textarea> </md-input-container> <div>&nbsp;</div> <div ng-show="occupationModule.assessment === \'KUTSEHINDAMISVIIS_E\'" layout="column"> <md-input-container flex> <label>{{\'module.grade3Description\' | translate}}</label> <textarea ng-model="occupationModule.grade3Description" max-rows="2" readonly></textarea> </md-input-container> <md-input-container flex> <label>{{\'module.grade4Description\' | translate}}</label> <textarea ng-model="occupationModule.grade4Description" max-rows="2" readonly></textarea> </md-input-container> <md-input-container flex> <label>{{\'module.grade5Description\' | translate}}</label> <textarea ng-model="occupationModule.grade5Description" max-rows="2" readonly></textarea> </md-input-container> </div> <div ng-show="occupationModule.assessment === \'KUTSEHINDAMISVIIS_M\'" layout="column" flex> <md-input-container flex> <label>{{\'module.gradeADescription\' | translate}}</label> <textarea ng-model="occupationModule.passDescription" max-rows="10" readonly></textarea> </md-input-container> </div> </fieldset> <div>&nbsp;</div> <fieldset tabindex="3"> <legend md-colors="{color: \'default-primary-800\'}" class="md-title-small">{{\'module.themes\' | translate}}</legend> <div layout="column"> <div flex="10"> </div> <div flex> <md-table-container> <table md-table class="secondary-table"> <thead md-head> <tr md-row> <th md-column>{{\'module.themeName\' | translate}}</th> <th md-column>{{\'module.capacityEkapPerHour\' | translate}}</th> <th md-column>{{\'module.subthemes\' | translate}}</th> <th md-column>{{\'module.studyYear\' | translate}}</th> <th md-column></th> </tr> </thead> <tbody md-body> <tr md-row ng-repeat="theme in occupationModule.themes | orderBy: currentLanguageNameField()"> <td md-cell> <a class="md-primary one-row" ng-click="openAddThemeDialog(theme)">{{currentLanguageNameField(theme)}}</a> </td> <td md-cell> {{theme.credits}}/{{theme.hours}} </td> <td md-cell> <p class="scrollable">{{theme.subthemes}}</p> </td> <td md-cell> {{theme.studyYearNumber}} </td> <td md-cell></td> </tr> </tbody> </table> </md-table-container> </div> </div> </fieldset> <div flex>&nbsp;</div> <fieldset tabindex="4" layout="column"> <legend md-colors="{color: \'default-primary-800\'}" class="md-title-small">{{\'module.proportionPerStudyYear\' | translate}}</legend> <div layout="row" style="overflow:auto"> <md-input-container flex ng-repeat="yc in occupationModule.yearCapacities track by $index"> <label>{{$index+1}}.&nbsp;{{\'module.studyYearLowercase\' | translate}}</label> <input disabled ng-model="yc.credits" type="number"> </md-input-container> </div> </fieldset> <div flex>&nbsp;</div> <md-input-container flex ng-if="occupationModule.teacher"> <label>{{\'module.supervisor\' | translate}}</label> <input ng-value="currentLanguageNameField(occupationModule.teacher)" type="text" readonly> </md-input-container> <md-input-container flex ng-if="!occupationModule.teacher"> <label>{{\'module.supervisor\' | translate}}</label> <input ng-model="occupationModule.supervisor" type="text" readonly> </md-input-container> </div> <span flex></span> <md-button class="md-raised" ng-click="back(backToViewForm)">{{"main.button.back" | translate}}</md-button> </form> </div>'),a.put("vocationalCurriculum/module/vocational.curriculum.module.edit.html",'<div class="ois-form-layout-padding nomargin"> <form name="replaceModuleForm" layout="column" ng-show="showReplaceMenu"> <div class="form-readonly" layout="column"> <md-input-container flex> <label>{{\'basemodule.curriculum\' | translate}}</label> <hois-value class="textInput" value="currentLanguageNameField(curriculum)"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'module.\' + currentLanguageNameVariable() | translate}}</label> <hois-value class="textInput" value="currentLanguageNameField(module)"></hois-value> </md-input-container> <md-input-container flex> <label>{{\'module.credits\' | translate}}</label> <hois-value class="textInput" value="module.credits"></hois-value> </md-input-container> </div> <div flex> <md-autocomplete name="baseModuleTemplate" md-selected-item-change="getReplaceForm(bModule)" md-selected-item="baseModuleTemplate" md-search-text="baseModuleNameTemplate" md-items="bModule in searchBaseModule(baseModuleNameTemplate)" md-item-text="currentLanguageNameField(bModule)" md-min-length="1" md-floating-label="{{\'basemodule.label\' | translate}}" md-no-cache required md-require-match class="small-margin" flex> <md-item-template> <span md-highlight-text="bModule" md-highlight-flags="^i">{{currentLanguageNameField(bModule)}}</span> </md-item-template> <md-not-found> {{\'main.messages.error.notFound\' | translate}} </md-not-found> </md-autocomplete> </div> <p class="md-body-1" ng-show="replaceModuleForm.showNotEnoughOutcomesError" style="color: #dd2c00; margin: 3px">{{\'basemodule.warning.notEnoughOutcomes\' | translate}}</p> <div flex ng-show="replaceBaseModuleForm.outcomes"> <fieldset tabindex="0"> <legend md-colors="{color: \'default-primary-800\'}" class="md-title-small">{{\'basemodule.studyOutcome\' | translate}}</legend> <p class="md-body-1" ng-show="replaceModuleForm.showOneToOneOutcomeError" style="color: #dd2c00; margin: 3px">{{\'basemodule.warning.oneToOneOutcome\' | translate}}</p> <div layout="column"> <div layout="row" ng-repeat="outcome in replaceBaseModuleForm.outcomes | orderBy: \'+id\'"> <p class="md-body-1" flex style="text-align: end; overflow-wrap: break-word; word-wrap: break-word">{{currentLanguageNameField(outcome)}}</p> <md-input-container flex="50" flex-offset="10"> <label>{{\'basemodule.baseModuleOutcome\' | translate}}</label> <md-select ng-model="replaceBaseModuleForm.connectionsOutcome[outcome.id]" required ng-change="selectChangeOutcome(outcome.id, replaceBaseModuleForm.connectionsOutcome[outcome.id])" ng-model-options="{trackBy: \'$value.id\'}"> <md-option ng-value="bOutcome" ng-repeat="bOutcome in replaceBaseModuleForm.baseModuleOutcomes | orderBy: \'+id\'">{{currentLanguageNameField(bOutcome)}}</md-option> </md-select> </md-input-container> </div> </div> </fieldset> </div> <div flex ng-show="replaceBaseModuleForm.themes && replaceBaseModuleForm.outcomes"> <fieldset tabindex="1"> <legend md-colors="{color: \'default-primary-800\'}" class="md-title-small">{{\'basemodule.themes\' | translate}}</legend> <p class="md-body-1" ng-show="replaceModuleForm.showOneToOneThemeError" style="color: #dd2c00; margin: 3px">{{\'basemodule.warning.oneToOneTheme\' | translate}}</p> <div layout="column" ng-repeat="oModule in replaceBaseModuleForm.occupationModules | orderBy: \'+id\'"> <md-checkbox ng-model="oModule.enabled" aria-label="Enabled?" ng-disabled="!replaceBaseModuleForm.themes[oModule.id]">{{currentLanguageNameField(oModule)}}</md-checkbox> <p class="md-body-1" style="color: #dd2c00; margin-top: 0px" ng-if="!replaceBaseModuleForm.themes[oModule.id]">{{\'basemodule.warning.tooManyThemes\' | translate}}</p> <div ng-if="oModule.enabled" flex> <div layout="row" ng-repeat="theme in replaceBaseModuleForm.themes[oModule.id] | orderBy: \'+id\'"> <p class="md-body-1" flex style="text-align: end; overflow-wrap: break-word; word-wrap: break-word">{{currentLanguageNameField(theme)}}</p> <md-input-container flex="50" flex-offset="10"> <label>{{\'basemodule.baseModuleTheme\' | translate}}</label> <md-select ng-model="replaceBaseModuleForm.connections[theme.id]" required ng-change="selectChange(oModule.id, theme.id, replaceBaseModuleForm.connections[theme.id])" ng-model-options="{trackBy: \'$value.id\'}"> <md-option ng-value="bTheme" ng-repeat="bTheme in replaceBaseModuleForm.baseModuleThemes | orderBy: \'+id\'">{{currentLanguageNameField(bTheme)}}</md-option> </md-select> </md-input-container> </div> </div> </div> </fieldset> </div> <div layout="row" flex> <md-button class="md-primary md-raised" ng-click="replace()">{{\'main.button.replace\' | translate}}</md-button> <md-button class="md-raised" ng-click="switchView(false)">{{\'main.button.back\' | translate}}</md-button> </div> </form> <form ng-cloak name="vocationalCurriculumModuleForm" ng-show="!showReplaceMenu"> <div layout="column" ng-cloak> <div layout="column" flex layout-gt-sm="row"> <md-radio-group class="md-primary base-module-menu" ng-model="moduleType" ng-change="radioChange()" layout="row" layout-align-gt-sm="center center" ng-disabled="baseModuleUsed || module.id"> <md-radio-button ng-value="moduleTypes.NEW_MODULE" aria-label="Uus moodul"> {{\'basemodule.newModule\' | translate}} </md-radio-button> <md-radio-button ng-value="moduleTypes.BASE_MODULE" aria-label="Baasmoodul"> {{\'basemodule.label\' | translate}} </md-radio-button> </md-radio-group> <div layout="row" flex ng-show="moduleType === moduleTypes.NEW_MODULE"> <md-button class="md-raised" ng-show="module.id && !baseModuleUsed" ng-click="switchView(true)">{{\'basemodule.operation.replace.label\' | translate}}</md-button> </div> <div layout="row" flex ng-show="baseModuleUsed"> <md-button class="md-raised" ng-click="releaseModule()">{{\'basemodule.operation.release.label\' | translate}}</md-button> </div> </div> <div flex ng-show="moduleType === moduleTypes.BASE_MODULE"> <md-autocomplete name="baseModule" md-selected-item-change="getBaseModule(bModule)" md-selected-item="baseModule" md-search-text="baseModuleName" md-items="bModule in searchBaseModule(baseModuleName)" md-item-text="currentLanguageNameField(bModule)" md-min-length="3" md-floating-label="{{\'basemodule.label\' | translate}}" md-no-cache class="small-margin" ng-required="moduleType === moduleTypes.BASE_MODULE" md-require-match="moduleType === moduleTypes.BASE_MODULE" ng-disabled="baseModuleUsed" flex> <md-item-template> <span md-highlight-text="bModule" md-highlight-flags="^i">{{currentLanguageNameField(bModule)}}</span> </md-item-template> <md-not-found> {{\'main.messages.error.notFound\' | translate}} </md-not-found> </md-autocomplete> </div> <fieldset tabindex="1" ng-if="module.canHaveOccupations"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{module.occupation ? \'module.occupationPartOccupationSpecialize\' : \'module.partOccupation\' | translate}}</legend> <div layout="column"> <div ng-repeat="item in module.curriculumOccupations | orderBy: \'occupation\'"> <md-checkbox ng-model="occupationsSelected[item.occupation]" ng-change="validateOccupations()"> <hois-classifier-value ng-model="item.occupation" main-classifier-codes="KUTSE,OSAKUTSE" class="inline" show-date></hois-classifier-value> </md-checkbox> <div layout="column"> <div ng-repeat="partOccupation in item.partOccupations | orderBy" flex layout="row"> <div flex="5">&nbsp;</div> <md-checkbox ng-model="occupationsSelected[partOccupation]" ng-change="validateOccupations()"> <hois-classifier-value ng-model="partOccupation" main-classifier-code="OSAKUTSE" class="inline" show-date></hois-classifier-value> ({{\'stateCurriculum.enter.occupation.partial\' | translate}}) </md-checkbox> </div> </div> <div layout="column"> <div ng-repeat="speciality in item.specialities | orderBy" layout="row"> <div flex="5">&nbsp;</div> <md-checkbox ng-model="specialitiesSelected[speciality]" ng-change="validateOccupations()"> <hois-classifier-value ng-model="speciality" main-classifier-code="SPETSKUTSE" class="inline" show-date></hois-classifier-value> ({{\'stateCurriculum.enter.occupation.specialty\' | translate}}) </md-checkbox> </div> </div> </div> </div> <md-input-container hide> <input ng-model="occupationsValid" type="text" required> </md-input-container> <p ng-show="vocationalCurriculumModuleForm.$submitted && !occupationsValid" class="invalid">{{\'curriculum.error.moduleOccupations\' | translate}}</p> </fieldset> <div>&nbsp;</div> <div layout="row" flex> <md-input-container flex="45"> <label>{{\'module.type\' | translate}}</label> <hois-classifier-select name="module" ng-model="module.module" show-only-values="possibleTypes" main-classifier-code="KUTSEMOODUL" criteria="{vocational: true}" required ng-disabled="module.id && !module.basicDataCanBeEdited" only-valid ignore-preselected model-value-attr="code"></hois-classifier-select> </md-input-container> <md-input-container flex="10" flex-sm="50" flex-xs="50" flex-offset="5"> <label>{{\'module.credits\' | translate}}</label> <input ng-model="module.credits" type="number" name="credits" min="0" max="999" pattern="^\\d+(\\.\\d{1})?$" required ng-readonly="module.baseModule || moduleType === moduleTypes.BASE_MODULE"> <div ng-messages="vocationalCurriculumModuleForm.credits.$error" ng-show="vocationalCurriculumModuleForm.credits.$dirty"> <div ng-message="min"> {{\'main.messages.error.positive\' | translate}} </div> <div ng-message="max"> {{\'curriculum.error.max999\' | translate}} </div> <div ng-message="pattern"> {{\'stateCurriculum.error.decimalPresision\' | translate}} </div> </div> </md-input-container> </div> <md-input-container flex> <label>{{\'module.nameEt\' | translate}}</label> <input ng-model="module.nameEt" type="text" md-maxlength="255" required ng-readonly="module.baseModule || moduleType === moduleTypes.BASE_MODULE"> </md-input-container> <md-input-container flex> <label>{{\'module.nameEn\' | translate}}</label> <input ng-model="module.nameEn" type="text" md-maxlength="255" ng-readonly="module.baseModule || moduleType === moduleTypes.BASE_MODULE"> </md-input-container> <md-input-container flex> <label>{{\'module.objectivesEt\' | translate}}</label> <textarea ng-model="module.objectivesEt" md-maxlength="10000" max-rows="10" required ng-readonly="module.baseModule || moduleType === moduleTypes.BASE_MODULE"></textarea> </md-input-container> <md-input-container flex> <label>{{\'module.objectivesEn\' | translate}}</label> <textarea ng-model="module.objectivesEn" md-maxlength="10000" max-rows="10" ng-readonly="module.baseModule || moduleType === moduleTypes.BASE_MODULE"></textarea> </md-input-container> <fieldset tabindex="4"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'module.studyOutcome\' | translate}} *</legend> <input style="display:none" type="number" readonly name="outcomesLength" ng-model="module.outcomes.length" min="1"> <div class="invalid" ng-if="vocationalCurriculumModuleForm.$submitted" ng-messages="vocationalCurriculumModuleForm.outcomesLength.$error"> <div ng-message="min">{{\'main.messages.error.atLeastOneShouldBeAdded\' | translate}}</div> </div> <div layout="row" flex ng-show="!(module.baseModule || moduleType === moduleTypes.BASE_MODULE)"> <md-input-container flex="45"> <label>{{\'studyOutcome.nameEt\' | translate}} *</label> <textarea ng-model="outcomeEt" md-maxlength="1000" max-rows="10"></textarea> </md-input-container> <md-input-container flex="40" flex-offset="5"> <label>{{\'studyOutcome.nameEn\' | translate}}</label> <textarea ng-model="outcomeEn" md-maxlength="1000" max-rows="10"></textarea> </md-input-container> <md-button class="md-primary" ng-click="addOutcome()" ng-if="!isEditingOutcome">{{\'main.button.add\' | translate}}</md-button> <md-button class="md-primary" ng-click="saveOutcome()" ng-if="isEditingOutcome">{{\'main.button.change\' | translate}}</md-button> </div> <div layout="column"> <div ng-repeat="item in module.outcomes track by $index" class="occupation-row align-center" layout="row" flex> <div flex="45"> <a ng-click="editOutcome(item)" ng-show="!(module.baseModule || moduleType === moduleTypes.BASE_MODULE)"> <p class="scrollable">{{item.outcomeEt}}</p> </a> <p class="scrollable" ng-show="module.baseModule || moduleType === moduleTypes.BASE_MODULE">{{item.outcomeEt}}</p> </div> <div flex="40" flex-offset="5"> <a ng-click="editOutcome(item)" ng-show="!(module.baseModule || moduleType === moduleTypes.BASE_MODULE)"> <p class="scrollable">{{item.outcomeEn}}</p> </a> <p class="scrollable" ng-show="module.baseModule || moduleType === moduleTypes.BASE_MODULE">{{item.outcomeEn}}</p> </div> <div ng-show="!(module.baseModule || moduleType === moduleTypes.BASE_MODULE)" layout="row" layout-align="center center"> <div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div> <div> <a class="remove" ng-click="removeFromArray(module.outcomes, item)">&times;&nbsp;&nbsp;</a> </div> <div> <p ng-if="$first" class="link-disabled">&#9650;&nbsp;</p> <a ng-if="!$first" class="link-no-underline" ng-click="swap($index, $index - 1)">&#9650;&nbsp;</a> </div> <div> <p ng-if="$last" class="link-disabled">&#9660;&nbsp;</p> <a ng-if="!$last" class="link-no-underline" ng-click="swap($index, $index + 1)">&#9660;&nbsp;</a> </div> </div> </div> </div> </fieldset> <div>&nbsp;</div> <md-input-container flex> <label>{{\'stateCurriculum.enter.module.criteriaEt\' | translate}}</label> <textarea ng-model="module.assessmentsEt" required md-maxlength="20000" max-rows="10" ng-readonly="module.baseModule || moduleType === moduleTypes.BASE_MODULE"></textarea> </md-input-container> <md-input-container flex> <label>{{\'stateCurriculum.enter.module.criteriaEn\' | translate}}</label> <textarea ng-model="module.assessmentsEn" md-maxlength="20000" max-rows="10" ng-readonly="module.baseModule || moduleType === moduleTypes.BASE_MODULE"></textarea> </md-input-container> <md-input-container flex> <label>{{\'module.competencesAquired\' | translate}}</label> <md-select multiple ng-model="module.competences" ng-disabled="module.module !== \'KUTSEMOODUL_P\' || competences.length === 0"> <md-option ng-repeat="option in competences | orderBy: currentLanguageNameField() track by $index" ng-value="option.code" aria-label="{{currentLanguageNameField(option)}}"> {{currentLanguageNameField(option)}}</md-option> </md-select> </md-input-container> <!-- <md-input-container flex>\r\n        <label>{{\'module.competencesAquired\' | translate}}</label>\r\n        <hois-select ng-model="module.competences" values="studyPeriods"\r\n        ng-disabled="module.module !== \'KUTSEMOODUL_P\' || competences.length === 0"\r\n        valueProperty="code"></hois-select>\r\n      </md-input-container> --> <!-- <md-input-container flex>\r\n          <label>{{\'module.competencesAquired\' | translate}}</label>\r\n          <hois-classifier-select  ng-model="module.competences" show-only-values="competences" main-classifier-code="KOMPETENTS"\r\n          ng-disabled="module.module !== \'KUTSEMOODUL_P\' || competences.length === 0" model-value-attr="code"></hois-classifier-select>\r\n        </md-input-container> --> <br> <md-input-container flex> <md-checkbox ng-model="module.practice" ng-disabled="module.module === \'KUTSEMOODUL_L\'">{{\'module.practice\' | translate}}</md-checkbox> </md-input-container> <md-input-container> <md-checkbox ng-model="module.isAdditional" aria-label="{{\'stateCurriculum.enter.module.isAdditional\' | translate}}"> {{\'stateCurriculum.enter.module.isAdditional\' | translate}} </md-checkbox> </md-input-container> </div> <span flex></span> <md-button class="md-raised md-primary" ng-click="save()">{{"main.button.save" | translate}}</md-button> <md-button class="md-raised" ng-click="delete()" ng-if="module.id && !module.addedToImplementationPlan">{{"main.button.delete" | translate}}</md-button> <md-button class="md-raised" ng-click="back(\'#/vocationalCurriculum/\' + curriculumId + \'/edit\', vocationalCurriculumModuleForm)">{{"main.button.back" | translate}}</md-button> </form> </div> <style>.link-no-underline {\r\n    text-decoration: none;\r\n  }\r\n\r\n  .link-disabled {\r\n    color: #d7dde5;\r\n  }\r\n  .base-module-menu {\r\n    padding-right: 10px;\r\n    padding-bottom: 5px;\r\n    margin-top: 6px;\r\n    margin-bottom: 6px;\r\n  }\r\n  @media screen and (min-width: 960px) {\r\n    .base-module-menu {\r\n      height: 36px;\r\n    }\r\n  }\r\n  .form-readonly > md-input-container {\r\n    margin-bottom: 18px !important;\r\n  }\r\n  .md-select-menu-container {\r\n    max-width: -moz-calc(100vw - 1em);\r\n    max-width: -webkit-calc(100vw - 1em);\r\n    max-width: calc(100vw - 1em);\r\n  }</style>'),
a.put("vocationalCurriculum/module/vocational.curriculum.module.view.html",'<div class="ois-form-layout-padding nomargin"> <div layout="column" ng-cloak> <fieldset tabindex="1" ng-if="module.canHaveOccupations"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{module.occupation ? \'module.occupationPartOccupationSpecialize\' : \'module.partOccupation\' | translate}}</legend> <div layout="column"> <div ng-repeat="item in module.curriculumOccupations | orderBy: \'occupation\'"> <md-checkbox ng-model="occupationsSelected[item.occupation]" disabled> <hois-classifier-value ng-model="item.occupation" main-classifier-codes="KUTSE,OSAKUTSE" class="inline" show-date></hois-classifier-value> </md-checkbox> <div layout="column"> <div ng-repeat="partOccupation in item.partOccupations | orderBy" flex layout="row"> <div flex="5">&nbsp;</div> <md-checkbox ng-model="occupationsSelected[partOccupation]" disabled> <hois-classifier-value ng-model="partOccupation" main-classifier-code="OSAKUTSE" class="inline" show-date></hois-classifier-value> ({{\'stateCurriculum.enter.occupation.partial\' | translate}}) </md-checkbox> </div> </div> <div layout="column"> <div ng-repeat="speciality in item.specialities | orderBy" layout="row"> <div flex="5">&nbsp;</div> <md-checkbox ng-model="specialitiesSelected[speciality]" disabled> <hois-classifier-value ng-model="speciality" main-classifier-code="SPETSKUTSE" class="inline" show-date></hois-classifier-value> ({{\'stateCurriculum.enter.occupation.specialty\' | translate}}) </md-checkbox> </div> </div> </div> </div> <md-input-container hide> <input ng-model="occupationsValid" readonly> </md-input-container> </fieldset> <div>&nbsp;</div> <div layout="row" flex> <md-input-container flex="45"> <label>{{\'module.type\' | translate}}</label> <hois-classifier-select name="module" ng-model="module.module" show-only-values="possibleTypes" main-classifier-code="KUTSEMOODUL" disabled model-value-attr="code"></hois-classifier-select> </md-input-container> <md-input-container flex="10" flex-sm="50" flex-xs="50" flex-offset="5"> <label>{{\'module.credits\' | translate}}</label> <input ng-model="module.credits" type="number" name="credits" readonly> </md-input-container> </div> <md-input-container flex> <label>{{\'module.nameEt\' | translate}}</label> <input ng-model="module.nameEt" type="text" readonly> </md-input-container> <md-input-container flex> <label>{{\'module.nameEn\' | translate}}</label> <input ng-model="module.nameEn" type="text" readonly> </md-input-container> <md-input-container flex> <label>{{\'module.objectivesEt\' | translate}}</label> <textarea ng-model="module.objectivesEt" max-rows="10" readonly></textarea> </md-input-container> <md-input-container flex> <label>{{\'module.objectivesEn\' | translate}}</label> <textarea ng-model="module.objectivesEn" max-rows="10" readonly></textarea> </md-input-container> <fieldset tabindex="4"> <legend md-colors="{color: \'primary-800\'}" class="md-title-small">{{\'module.studyOutcome\' | translate}}</legend> <div layout="column"> <div ng-repeat="item in module.outcomes track by $index" class="occupation-row align-center" layout="row" flex> <div flex="45"> <p class="scrollable">{{item.outcomeEt}}</p> </div> <div flex="40" flex-offset="5"> <p class="scrollable">{{item.outcomeEn}}</p> </div> </div> </div> </fieldset> <div>&nbsp;</div> <md-input-container flex> <label>{{\'stateCurriculum.enter.module.criteriaEt\' | translate}}</label> <textarea ng-model="module.assessmentsEt" readonly max-rows="10"></textarea> </md-input-container> <md-input-container flex> <label>{{\'stateCurriculum.enter.module.criteriaEn\' | translate}}</label> <textarea ng-model="module.assessmentsEn" readonly max-rows="10"></textarea> </md-input-container> <md-input-container flex> <label>{{\'module.competencesAquired\' | translate}}</label> <md-select multiple ng-model="module.competences" disabled> <md-option ng-repeat="option in competences | orderBy: currentLanguageNameField() track by $index" ng-value="option.code" aria-label="{{currentLanguageNameField(option)}}"> {{currentLanguageNameField(option)}}</md-option> </md-select> </md-input-container> <br> <md-input-container flex> <md-checkbox ng-model="module.practice" disabled>{{\'module.practice\' | translate}}</md-checkbox> </md-input-container> <md-input-container> <md-checkbox ng-model="module.isAdditional" aria-label="{{\'stateCurriculum.enter.module.isAdditional\' | translate}}" disabled> {{\'stateCurriculum.enter.module.isAdditional\' | translate}} </md-checkbox> </md-input-container> </div> <span flex></span> <div> <md-button class="md-raised" ng-click="back(\'#/vocationalCurriculum/\' + curriculumId + \'/view\')">{{"main.button.back" | translate}}</md-button> </div> </div> <style>.link-no-underline {\r\n      text-decoration: none;\r\n    }\r\n\r\n    .link-disabled {\r\n      color: #d7dde5;\r\n    }</style>')}]);