<div class="ois-form-layout-padding" ng-cloak>
  <div flex>
    <form ng-submit="finalExamProtocolForm.$valid && save()" novalidate layout="column" name="finalExamProtocolForm">
      <div ng-include="'finalExamProtocol/templates/final.exam.vocational.protocol.header.tmpl.html'"></div>

      <div ng-if="!protocol.finalExam.date && !protocol.finalExam.committee" layout="row" layout-sm="column" layout-xs="column">
        <md-input-container flex="20" flex-sm="100" flex-xs="100">
          <label>{{'finalExamProtocol.finalExamDate' | translate}}</label>
          <md-datepicker ng-model="protocol.finalExamDate" ng-change="selectedFinalExamDateChanged()"></md-datepicker>
        </md-input-container>
        <md-input-container flex="30" flex-offset-gt-lg="10" flex-sm="100" flex-xs="100">
          <label>{{'finalExamProtocol.committee' | translate}}</label>
          <md-select ng-model="protocol.committee" aria-label="committee" ng-change="selectedCommitteeChanged()">
            <md-option ng-repeat="val in committees" ng-value="val">{{val.members}}</md-option>
          </md-select>
        </md-input-container>
      </div>

      <div ng-if="committeeMembers">
        <md-table-container>
          <table md-table md-progress="protocol.$promise">
            <thead md-head>
              <tr md-row>
                <th md-column>{{'finalExamProtocol.name' | translate}}</th>
                <th md-column>{{'finalExamProtocol.role' | translate}}</th>
                <th md-column>{{'finalExamProtocol.present' | translate}}</th>
              </tr>
            </thead>
            <tbody md-body>
              <tr md-row ng-repeat="row in committeeMembers | orderBy: 'memberName'" ng-class-odd="'odd'" ng-class-even="'even'">
                <td md-cell>{{row.memberName}}</td>
                <td md-cell ng-if="row.isChairman">{{'finalExamProtocol.chairman' | translate}}</td>
                <td md-cell ng-if="!row.isChairman">{{'finalExamProtocol.member' | translate}}</td>
                <td md-cell>
                  <md-checkbox aria-label="module" ng-model="row.isPresent"></md-checkbox>
                </td>
              </tr>
            </tbody>
          </table>
        </md-table-container>
      </div>

      <br/>

      <div>
        <div flex>
          <md-table-container>
            <table md-table md-progress="protocol.$promise" multiple="true">
              <thead md-head>
                <tr md-row>
                  <th md-column>{{'finalExamProtocol.id' | translate}}</th>
                  <th md-column>{{'student.label' | translate}}</th>
                  <th md-column>{{'finalExamProtocol.finalGrade' | translate}}</th>
                  <th md-column></th>
                  <th md-column></th>
                  <th md-column></th>
                  <th md-column></th>
                </tr>
              </thead>
              <tbody md-body>
                <tr md-row ng-repeat="row in protocol.protocolStudents | orderBy: 'fullname'" ng-class-odd="'odd'" ng-class-even="'even'"
                  md-select="row.id" md-select-id="row.id">
                  <td md-cell>{{row.id}}</td>
                  <td md-cell>{{row.fullname}}</td>
                  <td md-cell>
                  <td md-cell>
                    <md-button class="md-raised md-primary" type="submit">{{'main.button.calculate' | translate}}</md-button>
                  </td>
                  <td md-cell>
                    <a ng-if="row.canBeDeleted && protocol.canBeEdited" ng-click="deleteProtocolStudent(row)" class="remove">&times;</a>
                  </td>
                </tr>
              </tbody>
            </table>
          </md-table-container>
        </div>
      </div>

      <br/>

      <div layout="row">
        <md-button class="md-raised md-primary" type="submit">{{'main.button.save' | translate}}</md-button>
        <md-button class="md-raised md-primary" ng-click="confirm()">{{'main.button.confirm' | translate}}</md-button>
        <md-button class="md-raised" ng-click="back('#/finalExamVocationalProtocol/')">{{'main.button.back' | translate}}</md-button>
      </div>
    </form>
  </div>
</div>
